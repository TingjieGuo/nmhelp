<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML>
<HEAD>
<TITLE></TITLE>
</HEAD>
<BODY>
<A name=1></a>NONMEM Users Guide - Part VIII<br>
Help Guide<br>
January 2018<br>
by<br>
Alison J. Boeckmann<br>
Lewis B. Sheiner<br>
Stuart L. Beal<br>
ICON plc<br>Gaithersburg, Maryland<br>
Copyright by the Regents of the University of California<br>1996, 1998, 2006, 2009<br>Copyright by ICON plc<br>2011, 2012, 2013, 2014, 2015, 2016, 2017,2018<br>All rights reserved<br>
<hr>
<A name=2></a><b>Contents</b><br>
INTRODUCTION iv<br>
HOW TO USE THIS GUIDE<br>
v<br>
RESERVED WORDS 1<br>
MISCELLANEOUS TOPICS 65<br>
DETAILED DESCRIPTIONS<br>
117<br>
EXAMPLES 649<br>
EXAMPLES<br>Abbreviated Function Example<br>
EX-1<br>
Bayes Example 1<br>
EX-3<br>
Bayes Example 1B<br>
EX-7<br>
Bayes Example 2<br>
EX-11<br>
Bayes Example 3<br>
EX-15<br>
Bayes Example 4<br>
EX-18<br>
Bayes Example 5<br>
EX-20<br>
Bayes Example 6<br>
EX-22<br>
Bayes Example 6s<br>
EX-25<br>
Bayes Example 6sB<br>
EX-28<br>
Bayes Example 7r<br>
EX-31<br>
Bayes Example 8<br>
EX-33<br>
Bayes Example 9<br>
EX-35<br>
Bayes Example 10<br>
EX-37<br>
Bayes Example 10l<br>
EX-39<br>
Bind example EX-41<br>BIVARIATE FUNCTION<br>
EX-43<br>
CCONTR example EX-51<br>Control3 example EX-53<br>Control4 example EX-54<br>Control5 example EX-55<br>Control6 example EX-56<br>Control7 example EX-57<br>Data average example EX-58<br>Enterhepatic circulation examples EX-60<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
EX-62<br>
Exogenous supplementation example EX-67<br>Expectation example EX-69<br>Finalization example ($PRED and $INFN)<br>
EX-72<br>
Finedata example EX-74<br>FOCE PARALLEL example EX-74<br>Ignore accept example EX-76<br>Infn interpolation example 1<br>
EX-79<br>
Infn interpolation example 2<br>
EX-82<br>
Initial Steady State example EX-85<br>Interoccasion variability example EX-88<br>
<hr>
<A name=3></a>INTERPOLATION IN $DES<br>
EX-90<br>
Logistic regression example EX-93<br>Michaelis Menten example EX-94<br>Mixture model example EX-95<br>Model Time examples EX-96<br>Moving Area Under the Curve Example EX-98<br>Multiple dose example EX-102<br>Nonparametric example EX-104<br>NWPRI examples EX-106<br>Objective Function Value Individual example EX-110<br>Phenobarb example EX-112<br>PK PD sequential 1 example EX-113<br>PK PD sequential 2 example EX-114<br>PK PD simultaneous 1 example EX-115<br>PK PD simultaneous 2 example EX-116<br>PK PD simultaneous 3 example EX-117<br>PK PD simultaneous 4 example EX-118<br>Plasma urine example EX-119<br>RECORDS=ID Example<br>
EX-123<br>
RECORDS=ID Example 2<br>
EX-125<br>
Repetition 1 example EX-127<br>Repetition 2 example EX-130<br>Simulation 1 example EX-132<br>Simulation 2 example EX-134<br>Simulation 3 example EX-135<br>Stieltjes example EX-137<br>Stochastic Differential Equation examples EX-138<br>Superproblem 1 example EX-139<br>Superproblem 2 example EX-142<br>TDM example EX-144<br>Three compartment example EX-145<br>Time After Dose (TAD) Example<br>
EX-146<br>
TNPRI examples EX-149<br>Transit Compartment Examples<br>
EX-153<br>
User-deﬁned Reserved Function Example<br>
EX-155<br>
YLO example EX-157<br>
<hr>
<A name=4></a><b>INTRODUCTION</b><br>
This guide is intended to provide experienced users of the NONMEM system with a fast way to locate<br>information on a given reserved word or topic.<br>
There are four sections:<br>
Reserved Words<br>Miscellaneous Topics<br>Detailed Descriptions<br>Examples<br>
The reserved words and miscellaneous topics appear in the left column of their respective sections, with<br>titles of corresponding and relevant detailed descriptions and examples in the right column. The detailed<br>descriptions provide brief summaries of the subject matter and are not intended to replace the other NON-<br>MEM guides, which should be consulted if more information is needed.<br>
Descriptions of NM-TRAN control records have a special syntax that is described fully in Guide IV, sec-<br>tion III.A. Please note that square brackets are used to surround an option or group of options, none of<br>which need actually appear in the record. If they surround a group of options, a vertical line is used to<br>separate these options in the description, and at most one of the options may be selected to actually appear<br>in the record. If none are selected to appear, then the default option, listed ﬁrst and indicated in boldface<br>(if there is an option so indicated), is understood to apply.<br>
Some of the examples are drawn from other NONMEM guides and sources, and some are new to this<br>guide.<br>
All sections are arranged in alphabetic order.<br>
The help and html directories of the NONMEM 7.4 distribution media contain essentially the same con-<br>tent as this printed guide, enabling the contents of this guide to be searched and displayed on-line.<br>
iv<br>
<hr>
<A name=5></a><b>HOW TO USE THIS GUIDE</b><br>
Suppose one wishes to learn more about (say) nonlinear kinetics with PREDPP. The term &quot;nonlinear&quot; is<br>listed among the miscellaneous topics in the second section:<br>
nonlinear_kinetics_model ADVAN10<br>
ADVAN6 ADVAN8<br>ADVAN9<br>Michaelis Menten example<br>
One may then look at the detailed descriptions entitled &quot;ADVAN6-ADVAN8&quot;, &quot;ADVAN9&quot;, &quot;ADVAN10&quot;<br>in the third section, or at the Michaelis Menten example in the fourth section.<br>
Some of these titles also happen to be reserved words, and are therefore also listed in the ﬁrst section.<br>
ADVAN6, ADVAN8 $DES<br>
ADVAN6 ADVAN8<br>DES<br>PRCOMG<br>SS6 SS9<br>Control7 example<br>Michaelis Menten example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_4 example<br>
Again, some of these titles ($DES and DES, for example) are also listed in the ﬁrst section, and titles of<br>additional detailed descriptions and examples of interest may be found.<br>
The detailed descriptions themselves contain references to other detailed descriptions and examples in<br>this guide, and to other NONMEM guides in which more complete information can be found. At the end<br>of the detailed description for $DES, for example, is:<br>
See also <b>des</b>, <b>advan6 advan8</b>, <b>advan9</b>.<br>
REFERENCES: Guide IV, section V.C.7<br>REFERENCES: Guide VI, section VI.C<br>
5<br>
<hr>
<A name=6></a>Help Guide<br>
RESERVED WORDS<br>
;<br>
Abbreviated code<br>
@<br>
$DAT A<br>
*<br>
$DAT A<br>
#<br>
$DAT A<br>
:<br>
II data item<br>TIME data item<br>
@<br>
Verbatim code<br>
-2LL<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
-2LOGLIKELIHOOD, -2LLIKELIHOOD<br>
$ESTIMATION, $ESTM<br>
A_0<br>
Initial Steady State: I_SS, ISSMOD<br>
A_0FLG<br>
$PK<br>
A_0FLG, A_0, A_INITIAL<br>
Compartment Initialization: A_0<br>Compartment Initialization: A_0FLG<br>Compartment Initialization Block<br>
A_0(n)<br>
Initial Steady State: I_SS, ISSMOD<br>$PK<br>PK<br>
$ABBREVIATED<br>
$ABBREVIATED<br>Abbreviated Function Examples<br>BIVARIATE FUNCTION<br>Infn_interpolation example 2<br>
ABORT<br>
Abbreviated code<br>$ESTIMATION, $ESTM<br>Interoccasion_variability example<br>$THETA<br>
ABS<br>
Abbreviated code<br>
ABS0, ABSZERO<br>
$SCATTERPLOT<br>
ACCEPT<br>
$DAT A<br>Ignore_accept example<br>
ACOS<br>
Abbreviated code<br>
ADDITIONAL<br>
Calling protocol phrase<br>
ADDL<br>
Absorption lag parameter<br>ADDL data item<br>$BIND<br>Bind example<br>Dose event record<br>$INPUT<br>SS dose event record<br>TDM example<br>
ADVAN1<br>
ADVAN1<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 7r<br>
1<br>
<hr>
<A name=7></a>RESERVED WORDS Help Guide<br>
Phenobarb example<br>
ADVAN10<br>
ADVAN10<br>Michaelis_Menten example<br>SS6 SS9<br>
ADVAN11<br>
ADVAN11<br>
ADVAN12<br>
ADVAN12<br>
ADVAN13<br>
Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>DES<br>Diff Eq Solver Settings<br>MXSTEP<br>SS6 SS9<br>
ADVAN14<br>
DES<br>Diff Eq Solver Settings<br>MXSTEP<br>SS6 SS9<br>
ADVAN15<br>
ADVAN9_15<br>$AES<br>AES<br>$AESINITIAL<br>CALL data item<br>DES<br>Diff Eq Solver Settings<br>MXSTEP<br>SS6 SS9<br>
ADVAN2<br>
ADVAN2<br>Bayes Example 10<br>Bayes Example 10l<br>Control3 example<br>Control5 example<br>Interoccasion_variability example<br>
ADVAN3<br>
ADVAN3<br>Bayes Example 1<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 8<br>Bayes Example 9<br>FOCE_PARALLEL example<br>Multiple_dose example<br>
ADVAN4<br>
ADVAN4<br>
ADVAN5<br>
ADVAN5 ADVAN7<br>PK_PD_simultaneous_3 example<br>Three_compartment example<br>
ADVAN6, ADVAN8<br>
Control7 example<br>$DES<br>DES<br>Diff Eq Solver Settings<br>
2<br>
<hr>
<A name=8></a>Help Guide<br>
RESERVED WORDS<br>
INTERPOLATION IN $DES<br>Michaelis_Menten example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_4 example<br>SS6 SS9<br>
ADVAN6, ADVAN8, ADVAN13, ADVAN14, P(n)<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN7<br>
ADVAN5 ADVAN7<br>ADVAN7: FACTOR<br>Control6 example<br>PK_PD_simultaneous_3 example<br>Three_compartment example<br>
ADVAN9<br>
ADVAN9_15<br>$AES<br>AES<br>$AESINITIAL<br>CALL data item<br>$DES<br>DES<br>Diff Eq Solver Settings<br>MXSTEP<br>SS6 SS9<br>
ADVAN, ADVAN1-ADVAN10<br>
ADVAN (general)<br>
ADVAN, ADVAN1-ADVAN12<br>
$SUBROUTINES<br>
AES<br>
ADVAN9_15<br>$AES<br>AES<br>CALL data item<br>CALLFL<br>Calling protocol phrase<br>DES AES: ICALL, IDEFD, IDEFA<br>$SUBROUTINES<br>
$AES<br>
$AES<br>
AES<br>
AES<br>
AESINITIAL, AES0<br>
ADVAN9_15<br>
$AESINITIAL, $AES0<br>
$AESINITIAL<br>
AESINITIAL, AES0<br>
$AESINITIAL<br>
AGH<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>
ALAG<br>
Moving Area Under the Curve Example<br>
ALAG1<br>
Absorption lag parameter<br>Bind example<br>PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>
ALAG1-ALAG9<br>
$BIND<br>Dose event record<br>$PK<br>
ALAGN<br>
Dose event record<br>
3<br>
<hr>
<A name=9></a>RESERVED WORDS Help Guide<br>
$PK<br>PK<br>
ALPHA<br>
Exogenous supplementation example<br>$PK<br>TRANS5<br>TRANS6<br>
AMT<br>
AMT data item<br>Control5 example<br>Dose event record<br>Exogenous supplementation example<br>$INPUT<br>SS dose event record<br>
A(n)<br>
$AES<br>AES<br>$AESINITIAL<br>$DES<br>DES<br>$ERROR<br>ERROR<br>Initial Steady State example<br>$PK<br>PK_PD_simultaneous_4 example<br>State Vector: A<br>State Vector Time: TSTATE<br>
AND<br>
$MODEL<br>
$ANNEAL<br>
$ANNEAL<br>CONSTRAINT<br>
Annnnn<br>
$TABLE<br>
ANRD<br>
$TOL<br>TOL<br>
ANRDC<br>
$TOL<br>TOL<br>
AOB<br>
Exogenous supplementation example<br>$PK<br>TRANS5<br>
APPEND<br>
$TABLE<br>
ASIN<br>
Abbreviated code<br>
ATAN<br>
Abbreviated code<br>
ATOL<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>ADVAN9_15<br>$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$SUBROUTINES<br>$TOL<br>TOL<br>
ATOLC<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
4<br>
<hr>
<A name=10></a>Help Guide<br>
RESERVED WORDS<br>
AUTO<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
AXIS<br>
FINEDAT A<br>NMTEMPLATE<br>
BACKGROUND, BACKGROUND<br>
nmfe utility program<br>
BAYES<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
BAYES, BAYESIAN<br>
Aneal<br>$ESTIMATION, $ESTM<br>
BETA<br>
Exogenous supplementation example<br>$PK<br>TRANS5<br>TRANS6<br>
BIND<br>
$BIND<br>Dose Time Non-Event: DOSTIM<br>$PK<br>
$BIND<br>
$BIND<br>
BIND<br>
Bind example<br>
BLANKOK<br>
$DAT A<br>
BLOCK<br>
Control4 example<br>Interoccasion_variability example<br>Mixture_model example<br>$OMEGA<br>$OMEGAP, $OMEGAPD<br>$SIGMA<br>
BOOTSTRAP<br>
$NONPARAMETRIC<br>$SIMULATION<br>
BY<br>
$MODEL<br>Phenobarb example<br>$SCATTERPLOT<br>$TABLE<br>
C<br>
Correlation Across L2 Records<br>Simulation: SIMEPS Error Code<br>
5<br>
<hr>
<A name=11></a>RESERVED WORDS Help Guide<br>
CALL<br>
CALL data item<br>CALLFL<br>Calling protocol phrase<br>$ERROR<br>Expectation block<br>Initialization-Finalization block<br>$INPUT<br>$PK<br>Simulation block<br>
CALLFL<br>
$AESINITIAL<br>$BIND<br>Bind example<br>CALL data item<br>CALLFL<br>Calling protocol phrase<br>Control3 example<br>Control5 example<br>Control6 example<br>Control7 example<br>$ERROR<br>$PK<br>TDM example<br>
CALPHA<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 7r<br>Bayes Example 9<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
CCONTR<br>
CCONTR<br>CCONTR example<br>$CONTR<br>MIX CONTR: THETA<br>Stubs<br>$SUBROUTINES<br>
CDATA<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>
CELS<br>
CELS<br>
CENTERING<br>
$ESTIMATION record options<br>
CENTERING, NOCENTERING<br>
$ESTIMATION, $ESTM<br>
CHAIN<br>
$CHAIN<br>$ESTIMATION, $ESTM<br>
$CHAIN<br>
$CHAIN<br>
CHECKMU<br>
$ABBREVIATED<br>
CHECKOUT, CHECKDATA<br>
$DAT A<br>
6<br>
<hr>
<A name=12></a>Help Guide<br>
RESERVED WORDS<br>
CHOL<br>
CHOL<br>
CHOLESKY<br>
$OMEGA<br>$SIGMA<br>
CHOLROFF<br>
$COVARIANCE, $COVR<br>
CINTERVAL<br>
Bayes Example 8<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
CIPRED<br>
$TABLE<br>
CIPREDI<br>
$TABLE<br>
CIRES<br>
$TABLE<br>
CIRESI<br>
$TABLE<br>
CITER<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 7r<br>Bayes Example 9<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
CIWRES<br>
$SCATTERPLOT<br>$TABLE<br>
CIWRESI<br>
$TABLE<br>
CL<br>
$PK<br>TRANS2<br>TRANS3<br>TRANS4<br>
CLOSE<br>
Write print<br>
CLT<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
CM38<br>
CONTR<br>SPTWO<br>
CMT<br>
CMT PCMT data item<br>Default compartment<br>$INPUT<br>
Cnnnnn<br>
$TABLE<br>
CNSAMP<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
CNT<br>
CONTR<br>NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>SPTWO<br>
7<br>
<hr>
<A name=13></a>RESERVED WORDS Help Guide<br>
TNPRI<br>TNPRI examples<br>
CNTID<br>
Objective Function Value Individual<br>Objective Function Value Individual example<br>Write print<br>
CNV<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
COI<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
COMACT<br>
$ABBREVIATED<br>COMACT, COMSAV<br>COM COMACT COMSAV COMRES<br>Copying block<br>DES AES: ISFINL<br>Displayed PRED-Deﬁned Items<br>
COM(n)<br>
Abbreviated code<br>COM COMACT COMSAV COMRES<br>Copying block<br>PRED-Deﬁned Variables<br>$TABLE<br>
COMPACT<br>
$ABBREVIATED<br>DES<br>DES AES: ICALL, IDEFD, IDEFA<br>
COMPARTMENT, COMP<br>
$MODEL<br>
COMPRESS<br>
$COVARIANCE, $COVR<br>
COMRES<br>
$ABBREVIATED<br>Abbreviated code<br>COM COMACT COMSAV COMRES<br>Copying block<br>PRED-Deﬁned Variables<br>
COMSAV<br>
$ABBREVIATED<br>COMACT, COMSAV<br>COM COMACT COMSAV COMRES<br>Copying block<br>Displayed PRED-Deﬁned Items<br>
CONDITIONAL<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$NONPARAMETRIC<br>$SCATTERPLOT<br>$TABLE<br>
CONDITIONAL, UNCONDITIONAL<br>
$COVARIANCE, $COVR<br>
CONSTRAIN<br>
$ESTIMATION record options<br>
CONSTRAIN, CONSTRAINT<br>
$ESTIMATION, $ESTM<br>
CONSTRAINT<br>
CONSTRAINT<br>Aneal<br>
8<br>
<hr>
<A name=14></a>Help Guide<br>
RESERVED WORDS<br>
$ANNEAL<br>
CONT<br>
CONT data item<br>$INPUT<br>
CONTR<br>
CCONTR example<br>CCONTR: Y, DAT A, N1, N2, DIM<br>$CONTR<br>CONTR<br>CONTR: KCALL<br>CONTR: Y DAT A NOBS<br>MIX CONTR: THETA<br>Stubs<br>$SUBROUTINES<br>
$CONTR<br>
$CONTR<br>
CONTR<br>
CONTR<br>
COR<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
CORRELATION<br>
$OMEGA<br>$SIGMA<br>
CORRL2<br>
Correlation Across L2 Records<br>NONMEM modules<br>Simulation: SIMEPS Error Code<br>variables in modules<br>
COS<br>
Abbreviated code<br>
COV<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
COVARIANCE<br>
$OMEGA<br>$SIGMA<br>
$COVARIANCE<br>
Control3 example<br>
COVARIANCE, COVR<br>
$COVARIANCE, $COVR<br>Phenobarb example<br>
$COVARIANCE, $COVR<br>
$COVARIANCE, $COVR<br>Phenobarb example<br>
COVARIANCE, COVR<br>
Phenobarb example<br>
CPRED<br>
$SCATTERPLOT<br>$TABLE<br>
CPREDI<br>
$SCATTERPLOT<br>$TABLE<br>
CPU<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>
CRES<br>
$SCATTERPLOT<br>$TABLE<br>
CRESI<br>
$SCATTERPLOT<br>$TABLE<br>
CRIT<br>
CRIT<br>
9<br>
<hr>
<A name=15></a>RESERVED WORDS Help Guide<br>
Stubs<br>$SUBROUTINES<br>
CTYPE<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>$CHAIN<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
CWRES<br>
$SCATTERPLOT<br>$TABLE<br>
CWRESI<br>
$SCATTERPLOT<br>$TABLE<br>
D1<br>
Multiple_dose example<br>
D1-D9<br>
Dose event record<br>Duration parameter<br>$PK<br>
DA<br>
AES<br>DES<br>
DA_0, D2A_0<br>
Compartment Initialization: A_0<br>
DADT(n)<br>
Control7 example<br>$DES<br>DES<br>
DAETA, D2AETA<br>
State Vector: A<br>
DATA<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>$CONTR<br>CONTR: Y DAT A NOBS<br>$DAT A<br>FINISH<br>
$DATA<br>
FINISH<br>
DATA<br>
$MIX<br>MIX: DAT A<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>
$DATA<br>
Control3 example<br>$DAT A<br>RECORDS=ID Example<br>
10<br>
<hr>
<A name=16></a>Help Guide<br>
RESERVED WORDS<br>
RECORDS=ID Example 2<br>
DATAMAXIMUM, DMAX<br>
$WARNINGS<br>
DATE, DAT1, DAT2, DAT3<br>
DATE data item<br>$INPUT<br>
DATREC<br>
Finalization example ($PRED and $INFN)<br>INFN<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>PRED<br>
DDEXPAND<br>
DDEXPAND<br>
DDOST, D2DOST<br>
Dose Time Non-Event: DOSTIM<br>
DEFAULT<br>
$DEFAULT<br>
$DEFAULT<br>
$DEFAULT<br>
DEFDOSE, DEFOBS, DEFOBSERVATION<br>
$MODEL<br>Three_compartment example<br>
DELIM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>FINEDAT A<br>NMTEMPLATE<br>
DEN_, CDEN_<br>
Nonparametric Density: DEN_, CDEN_<br>Nonparametric example<br>
DERCONT<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
DERIV1<br>
$ABBREVIATED<br>
DERIV2<br>
$ABBREVIATED<br>
DES<br>
$ABBREVIATED<br>ADVAN10<br>ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>ADVAN9_15<br>Control7 example<br>$DES<br>DES<br>DES AES: ICALL, IDEFD, IDEFA<br>INTERPOLATION IN $DES<br>Michaelis_Menten example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_4 example<br>SS6 SS9<br>$SUBROUTINES<br>
$DES<br>
Control7 example<br>$DES<br>
DES<br>
DES<br>
DF<br>
Bayes Example 10<br>Bayes Example 10l<br>$ESTIMATION record options<br>
DF, DFS<br>
$CHAIN<br>$ESTIMATION, $ESTM<br>
11<br>
<hr>
<A name=17></a>RESERVED WORDS Help Guide<br>
DFS<br>
$ESTIMATION record options<br>
DIAGONAL<br>
$OMEGA<br>$SIGMA<br>
DIM<br>
CONTR: III, DIM<br>
DIMCNS<br>
SIZES FSIZES prsizes<br>
DIMFN<br>
SIZES FSIZES prsizes<br>
DIMNEW<br>
SIZES FSIZES prsizes<br>
DIMQ<br>
SIZES FSIZES prsizes<br>
DIMTMP<br>
SIZES FSIZES prsizes<br>
DIMTOK<br>
SIZES FSIZES prsizes<br>
DIMVRB<br>
SIZES FSIZES prsizes<br>
DIRECT<br>
Bayes Example 1B<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
DISPLAY<br>
$PRIOR<br>
DN<br>
Dose event record<br>Duration parameter<br>$PK<br>PK<br>
Dnnnnn<br>
$TABLE<br>
DO<br>
Abbreviated code<br>SIMETA<br>Transit Compartment Examples<br>
DOE<br>
DOEXPAND<br>
DOEXPAND<br>
DOEXPAND<br>
DOSE<br>
$BIND<br>Bind example<br>TDM example<br>
DOSREC<br>
$AES<br>AES<br>$BIND<br>$DES<br>DES<br>Dose Record: DOSREC<br>Dose Time Non-Event: DOSTIM<br>$PK<br>
DOSTIM<br>
$AES<br>AES<br>$BIND<br>$DES<br>DES<br>Dose Record: DOSREC<br>Dose Time Non-Event: DOSTIM<br>$PK<br>
DOUBLE, DP, D<br>
SUBROUTINE<br>$SUBROUTINES<br>
12<br>
<hr>
<A name=18></a>Help Guide<br>
RESERVED WORDS<br>
DOWHILE<br>
$ABBREVIATED<br>Abbreviated code<br>
DO-WHILE<br>
Abbreviated code<br>
DOWHILE<br>
SIMETA<br>
DO-WHILE<br>
SIMETA<br>
DOWHILE<br>
Transit Compartment Examples<br>
DO-WHILE<br>
Transit Compartment Examples<br>
DOWHILE, ENDDO<br>
Data_Average block<br>Expectation block<br>Initialization-Finalization block<br>PASS<br>SIMETA<br>Simulation block<br>
DP<br>
AES<br>DES<br>
DPSIZE<br>
SIZES FSIZES prsizes<br>
DROP<br>
$BIND<br>$DAT A<br>DATE data item<br>$INPUT<br>Simulation_1 example<br>
DT<br>
AES<br>DES<br>
DV<br>
Control5 example<br>DATA_SET<br>DV and MDV data items<br>INDIVIDUALS<br>$INPUT<br>OBSERVA TION RECORDS<br>
DV_ITM<br>
CONTR: Y DAT A NOBS<br>
DV_ITM2<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>
DV_LOQ<br>
NPD, NPDE, NPDE_MODE, DV_LOQ<br>
E<br>
$COVARIANCE, $COVR<br>
ECWRES<br>
$SCATTERPLOT<br>$TABLE<br>
EFIRSTDOS<br>
Additional_Record_Counters<br>
EFIRSTOBS<br>
Additional_Record_Counters<br>
EFIRSTREC<br>
Additional_Record_Counters<br>
EIPRED<br>
$TABLE<br>
EIRESA<br>
$TABLE<br>
EIWRES<br>
$TABLE<br>
ELASTDOS<br>
Additional_Record_Counters<br>
ELASTOBS<br>
Additional_Record_Counters<br>
ELASTREC<br>
Additional_Record_Counters<br>
ELS<br>
ELS<br>
13<br>
<hr>
<A name=19></a>RESERVED WORDS Help Guide<br>
EM<br>
Aneal<br>$ESTIMATION, $ESTM<br>
EMPTY<br>
SIZES FSIZES prsizes<br>
E(n)<br>
ADVAN9_15<br>$AES<br>AES<br>
ENDDOE<br>
DOEXPAND<br>
Ennnnn<br>
$TABLE<br>
EONLY<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 7r<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
EPRED<br>
$SCATTERPLOT<br>$TABLE<br>
EPS<br>
Simulation: ETA, EPS<br>
EPS(n)<br>
$ERROR<br>ERROR<br>Intra and inter-individual<br>$PRED<br>PRED<br>Random models<br>$SIGMA<br>
EQN<br>
$DAT A<br>
EQUILIBRIUM<br>
$MODEL<br>
ERES<br>
$SCATTERPLOT<br>$TABLE<br>
ERR(n)<br>
$ERROR<br>Intra and inter-individual<br>$PRED<br>Random models<br>
ERROR<br>
CALL data item<br>CALLFL<br>Calling protocol phrase<br>$ERROR<br>ERROR<br>PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>
14<br>
<hr>
<A name=20></a>Help Guide<br>
RESERVED WORDS<br>
PK_PD_simultaneous_4 example<br>State Vector: A<br>State Vector Time: TSTATE<br>$SUBROUTINES<br>
$ERROR<br>
Control3 example<br>$ERROR<br>
ERROR<br>
ERROR<br>
ERRORMAXIMUM, EMAX<br>
$WARNINGS<br>
ESAMPLE<br>
$TABLE<br>
ESTIMATION, ESTM<br>
$CHAIN<br>$ESTIMATION, $ESTM<br>Phenobarb example<br>
$ESTIMATION, $ESTM<br>
$CHAIN<br>
ESTIMATION, ESTM<br>
$CHAIN<br>
$ESTIMATION, $ESTM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>Phenobarb example<br>
ESTIMATION, ESTM<br>
Phenobarb example<br>
ETA<br>
Non-active ETA list for PRED<br>Simulation: ETA, EPS<br>Write print<br>
ETA1-ETA9, ET10-ET70<br>
$TABLE<br>
ETABARCHECK<br>
$ESTIMATION record options<br>ETABAR<br>
ETABARCHECK, NOETABARCHECK<br>
$ESTIMATION, $ESTM<br>
ETADER<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
ETA, ETAS<br>
$TABLE<br>
ETA(n)<br>
$ERROR<br>ERROR<br>$ETAS, $PHIS<br>Intra and inter-individual<br>$OMEGA<br>$PK<br>PK<br>$PRED<br>PRED<br>Random models<br>
ETAn<br>
$TABLE<br>
ETA(n)<br>
$TABLE<br>
ETAS<br>
$NONPARAMETRIC<br>Nonparametric example<br>
$ETAS<br>
$ETAS, $PHIS<br>
ETASAMPLES<br>
$ESTIMATION, $ESTM<br>
ETASTYPE<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
15<br>
<hr>
<A name=21></a>RESERVED WORDS Help Guide<br>
ETASXI<br>
ETASXI<br>
$ESTIMATION, $ESTM<br>ETASXI<br>NONMEM modules<br>variables in modules<br>
ETC<br>
additional_output_ﬁles<br>$ETAS, $PHIS<br>
ETEXT<br>
PRED Error Message<br>
ETS<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>
EVENT<br>
Calling protocol phrase<br>
EVERY<br>
Calling protocol phrase<br>
EVID<br>
EVID data item<br>$INPUT<br>Interoccasion_variability example<br>
EVTREC<br>
Dose Time Non-Event: DOSTIM<br>ERROR<br>EVENT RECORD: EVTREC<br>PK<br>
EWRES<br>
$SCATTERPLOT<br>$TABLE<br>
EXAMPLE2.CTL<br>
Bayes Example 2<br>
EXCLUDE<br>
$MODEL<br>
EXCLUDE_BY<br>
Ignore_accept example<br>$TABLE<br>
EXIT<br>
Abbreviated code<br>$ESTIMATION, $ESTM<br>Interoccasion_variability example<br>$THETA<br>
EXP<br>
Abbreviated code<br>
EXPAND<br>
$NONPARAMETRIC<br>
EXPECTATION-MAXIMIZATION<br>
Aneal<br>$ESTIMATION, $ESTM<br>
EXTRADOSE<br>
FINEDAT A<br>
F<br>
CCONTR: F, G, H<br>CONTR: F, G, H<br>$ERROR<br>ERROR<br>PRED<br>
F0, FO<br>
Output fraction parameter<br>$PK<br>PK<br>Plasma urine example<br>
F1<br>
Bind example<br>TDM example<br>
F1-F9<br>
Dose event record<br>
16<br>
<hr>
<A name=22></a>Help Guide<br>
RESERVED WORDS<br>
$PK<br>
FACTOR<br>
ADVAN7: FACTOR<br>
FACTORIAL<br>
Abbreviated code<br>
FAST<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>
FASTDER<br>
$ABBREVIATED<br>
F_FLAG<br>
Bayes Example 10<br>Bayes Example 10l<br>F_FLAG<br>MDVRES<br>
FGH<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>
FILE<br>
$CHAIN<br>$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>FINEDAT A<br>NMTEMPLATE<br>$TABLE<br>
filename<br>
$DAT A<br>$ESTIMATION, $ESTM<br>$ETAS, $PHIS<br>INCLUDE<br>$MSFI<br>$NONPARAMETRIC<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>$TABLE<br>
FILES<br>
FILES<br>
FIN<br>
FINISH<br>
FINAL<br>
Nonparametric example<br>$SIMULATION<br>
FINEDATA<br>
DDEXPAND<br>Finedata example<br>
FIRST<br>
Calling protocol phrase<br>Superproblem_2 example<br>
FIRSTDOS<br>
Additional_Record_Counters<br>
FIRSTEM<br>
Partial Derivative Indicators<br>
FIRSTEM, IFIRSTEM<br>
$SIMULATION<br>
&quot;, &quot;FIRST, &quot;LAST, &quot;MAIN<br>
Finalization example ($PRED and $INFN)<br>
FIRST, LAST, MAIN<br>
Finalization example ($PRED and $INFN)<br>
&quot;, &quot;FIRST, &quot;LAST, &quot;MAIN<br>
Verbatim code<br>
FIRST, LAST, MAIN<br>
Verbatim code<br>
FIRSTLASTONLY<br>
$TABLE<br>
FIRSTOBS<br>
Additional_Record_Counters<br>
FIRSTONLY, FIRSTRECORDONLY<br>
$SCATTERPLOT<br>
17<br>
<hr>
<A name=23></a>RESERVED WORDS Help Guide<br>
$TABLE<br>
FIRSTREC<br>
Additional_Record_Counters<br>
FIXED<br>
INITIAL ESTIMATE (INITIAL EST)<br>$OMEGA<br>$OMEGAP, $OMEGAPD<br>PK_PD_sequential_2 example<br>$SIGMA<br>$SIGMAP, $SIGMAPD<br>Simulation_3 example<br>$THETA<br>$THETAP, $THETAPV<br>
FIXEDETAS<br>
$TABLE<br>
FL<br>
SIZES FSIZES prsizes<br>
FL1<br>
CONTR: F, G, H<br>
FL2<br>
CCONTR: F, G, H<br>
FLIBR<br>
SIZES FSIZES prsizes<br>
FLU<br>
FLU<br>
FMT<br>
WRITE Formats<br>
FN<br>
Bioavailability fraction parameter<br>Dose event record<br>$PK<br>PK<br>
FNLETA<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>FNLETA<br>
Fnnnnn<br>
$TABLE<br>
FO, NOFO<br>
$ESTIMATION, $ESTM<br>
FOR<br>
Non-active ETA list for PRED<br>
FORMAT<br>
$CHAIN<br>$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$TABLE<br>
FORWARD<br>
Superproblem_1 example<br>Superproblem_2 example<br>$TABLE<br>
FPARAFILE<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
FPOSDEF<br>
$COVARIANCE, $COVR<br>
FROM<br>
$SCATTERPLOT<br>$TABLE<br>
FSD<br>
SIZES FSIZES prsizes<br>
FSD1<br>
SIZES FSIZES prsizes<br>
FTL<br>
DDEXPAND<br>FINEDAT A<br>
FULL<br>
$ABBREVIATED<br>
18<br>
<hr>
<A name=24></a>Help Guide<br>
RESERVED WORDS<br>
DES<br>DES AES: ICALL, IDEFD, IDEFA<br>
FUNC<br>
Abbreviated Function<br>Abbreviated Function Examples<br>Transit Compartment Examples<br>
FUNC, FUNCA-FUNCI<br>
Abbreviated Function<br>Abbreviated Function Examples<br>PHI<br>Stubs<br>Transit Compartment Examples<br>
FUNC, FUNCA-FUNCZ<br>
Abbreviated code<br>
FUNCTION<br>
$ABBREVIATED<br>BIVARIATE FUNCTION<br>
G<br>
CCONTR: F, G, H<br>CONTR: F, G, H<br>ERROR<br>PRED<br>
G11, G21, G31<br>
$TABLE<br>
G2<br>
CCONTR: F, G, H<br>CONTR: F, G, H<br>
GAMLN<br>
Abbreviated code<br>
GAMLN, GAMLND1, GAMLND2<br>
GAMLN<br>
GAMMA<br>
Abbreviated code<br>$PK<br>TRANS6<br>
GETETA<br>
ERROR<br>Finalization example ($PRED and $INFN)<br>GETETA<br>INFN<br>PASS<br>PK<br>PRED<br>
GG<br>
PK<br>TRANS (subroutine)<br>
GGL1<br>
CONTR: F, G, H<br>
GGL2<br>
CCONTR: F, G, H<br>
GK1, HK1<br>
$TABLE<br>
GL1<br>
CONTR: F, G, H<br>
GL2<br>
CCONTR: F, G, H<br>
GRD<br>
additional_output_ﬁles<br>Bayes Example 2<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>NONMEM output ﬁles<br>
GRDQ<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
19<br>
<hr>
<A name=25></a>RESERVED WORDS Help Guide<br>
GRID<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>Stieltjes example<br>
H<br>
CCONTR: F, G, H<br>CONTR: F, G, H<br>ERROR<br>PRED<br>
H11, H21<br>
$TABLE<br>
HL1<br>
CONTR: F, G, H<br>
HL2<br>
CCONTR: F, G, H<br>
HYBRID<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
IACCEPT<br>
Bayes Example 10<br>Bayes Example 10l<br>$CHAIN<br>$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
IACCEPTL<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
IATT<br>
MODEL<br>
ICALL<br>
Abbreviated code<br>CONTR<br>Data_Average block<br>DES AES: ICALL, IDEFD, IDEFA<br>Displayed PRED-Deﬁned Items<br>$ERROR<br>ERROR<br>Expectation block<br>Finalization example ($PRED and $INFN)<br>INFN<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>Initialization-Finalization block<br>Mixture_model example<br>PASS NEWIND: NWIND<br>PASS: PASSRC<br>$PK<br>PK<br>$PRED<br>PRED<br>Simulation_3 example<br>Simulation block<br>SPTWO<br>
ICMAX<br>
$PRIOR<br>PRIOR Simulation: ICMAX<br>
ID<br>
Control5 example<br>
20<br>
<hr>
<A name=26></a>Help Guide<br>
RESERVED WORDS<br>
DATA_SET<br>ID .ID. and L1 data items<br>INDIVIDUALS<br>$INPUT<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>SIMETA<br>
IDEF<br>
ERROR<br>PK<br>
IDEFA<br>
AES<br>DES AES: ICALL, IDEFD, IDEFA<br>
IDEFD<br>
DES AES: ICALL, IDEFD, IDEFA<br>
IDNO<br>
MODEL<br>
IERC, IERE<br>
Estim Covar Error Codes<br>Finalization example ($PRED and $INFN)<br>Initialization-Finalization block<br>
IERPRD<br>
PRED Error Message<br>PRED Exit Code<br>
IERSQ<br>
Simulation: SIMEPS Error Code<br>
IETAOL, IEPSOL<br>
Simulation: IETAOL IEPSOL<br>
IF<br>
Abbreviated code<br>
IFIRSTEM<br>
Partial Derivative Indicators<br>
IFND<br>
$PRIOR<br>TNPRI<br>TNPRI examples<br>
IGNORE<br>
$DAT A<br>Ignore_accept example<br>Simulation_1 example<br>Simulation_2 example<br>
II<br>
Bind example<br>Dose event record<br>Exogenous supplementation example<br>II data item<br>$INPUT<br>Interoccasion_variability example<br>SS dose event record<br>TDM example<br>
IIDX<br>
Objective Function Value Individual<br>Objective Function Value Individual example<br>
IIDX, CNTID<br>
Write print<br>
III<br>
CONTR: III, DIM<br>
IKAPPA<br>
$ESTIMATION record options<br>
IMAX<br>
Diff Eq Solver Settings<br>
IMP<br>
additional_output_ﬁles<br>Bayes Example 1<br>Bayes Example 10<br>
21<br>
<hr>
<A name=27></a>RESERVED WORDS Help Guide<br>
Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
IMPMAP<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
INCLUDE<br>
$DAT A<br>INCLUDE<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>User-deﬁned Reserved Function Example<br>
$INDEX, $INDXS<br>
$INDEX, $INDXS<br>
INDEX, INDXS, INDEXES<br>
ERROR<br>$INDEX, $INDXS<br>INFN<br>PK<br>PRED<br>
INDIVIDUAL<br>
Calling protocol phrase<br>
INDR1<br>
NINDR INDR1 INDR2<br>
INDR2<br>
NINDR INDR1 INDR2<br>
INFILE<br>
$DAT A<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>
$INFILE<br>
$DAT A<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>
INF, INFINITY<br>
$THETA<br>
INFN<br>
$INFN<br>INFN<br>PASS<br>PASS NEWIND: NWIND<br>Stubs<br>$SUBROUTINES<br>SUPP<br>
$INFN<br>
$INFN<br>
INFN<br>
Finalization example ($PRED and $INFN)<br>Finedata example<br>$INFN<br>INFN<br>Infn_interpolation example 1<br>
22<br>
<hr>
<A name=28></a>Help Guide<br>
RESERVED WORDS<br>
Infn_interpolation example 2<br>Initialization-Finalization block<br>
INFNP<br>
INFN-deﬁned Variables<br>
INIT<br>
AES<br>
INITIAL<br>
$SIMULATION<br>
INITIALOFF, INITIALON<br>
$MODEL<br>Three_compartment example<br>
INPUT<br>
$BIND<br>$INPUT<br>$OMIT<br>
$INPUT<br>
$BIND<br>
INPUT<br>
Bind example<br>
$INPUT<br>
Control3 example<br>DATA_ITEMS<br>DATA_RECORDS<br>DATA_SET<br>$INPUT<br>
INT<br>
Abbreviated code<br>
INTEGER<br>
$ABBREVIATED<br>
INTERACTION<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
INTFLG<br>
Diff Eq Solver Settings<br>
IPRD<br>
$TABLE<br>
IPREDI<br>
$TABLE<br>
IPRNV<br>
Super Problem Print Control<br>
IPROB<br>
Problem Iteration Counters<br>
IPS<br>
Population single-Subject Indicator<br>
IR<br>
AES<br>Calling protocol phrase<br>DES<br>MODEL<br>
I_REC<br>
Recursive PRED Indicator<br>
23<br>
<hr>
<A name=29></a>RESERVED WORDS Help Guide<br>
IRECIDX<br>
Additional_Record_Counters<br>Moving Area Under the Curve Example<br>
IREP<br>
Simulation: NREP, IREP<br>
IRESI<br>
$TABLE<br>
IREV<br>
ERROR<br>PK<br>
IRGG<br>
PK<br>TRANS (subroutine)<br>
IRS<br>
$TABLE<br>
ISAMPEND<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
ISAMPLE<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>$CHAIN<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
ISAMPLE_M1<br>
$ESTIMATION record options<br>
ISAMPLE_M1A<br>
$ESTIMATION record options<br>
ISAMPLE_M1B<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
ISAMPLE_M1, ISAMPLE_M1A<br>
$ESTIMATION, $ESTM<br>
ISAMPLE_M2<br>
$ESTIMATION record options<br>
ISAMPLE_M2, ISAMPLE_M3<br>
$ESTIMATION, $ESTM<br>
ISAMPLE_M3<br>
$ESTIMATION record options<br>
ISAMPLEMAX<br>
SIZES FSIZES prsizes<br>
ISCALE_MAX<br>
$ESTIMATION record options<br>
ISCALE_MIN<br>
$ESTIMATION record options<br>
ISCALE_MIN, ISCALE_MAX, IKAPPA<br>
$ESTIMATION, $ESTM<br>
ISFINL<br>
$AES<br>$DES<br>DES AES: ISFINL<br>
ISIZE<br>
SIZES FSIZES prsizes<br>
I_SS<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>ADVAN9_15<br>
ISS<br>
Initial Steady State example<br>
I_SS<br>
Initial Steady State example<br>
24<br>
<hr>
<A name=30></a>Help Guide<br>
RESERVED WORDS<br>
Initial Steady State: I_SS, ISSMOD<br>$MODEL<br>
ISS<br>
NWPRI<br>NWPRI examples<br>
I_SS<br>
$PK<br>
ISS<br>
$PRIOR<br>PRIOR<br>TNPRI<br>TNPRI examples<br>
ISSMOD<br>
Initial Steady State: I_SS, ISSMOD<br>
ISTFLG<br>
Diff Eq Solver Settings<br>
ITERATIONS<br>
Problem Iteration Counters<br>$SUPER<br>Superproblem_1 example<br>Superproblem_2 example<br>
ITRANS<br>
TRANS (subroutine)<br>
ITS<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
ITYP<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>TNPRI<br>TNPRI examples<br>
IVAR<br>
$PRIOR<br>TNPRI<br>TNPRI examples<br>
IWRB<br>
SIZES FSIZES prsizes<br>
IWRE<br>
SIZES FSIZES prsizes<br>
IWRESI<br>
$TABLE<br>
IWRS<br>
$TABLE<br>
K<br>
ADVAN1<br>ADVAN11<br>ADVAN12<br>ADVAN2<br>
25<br>
<hr>
<A name=31></a>RESERVED WORDS Help Guide<br>
ADVAN3<br>ADVAN4<br>$PK<br>
K12, K21<br>
ADVAN11<br>ADVAN3<br>$PK<br>
K13, K31<br>
ADVAN11<br>$PK<br>
K21, K31, K32, K42<br>
TRANS6<br>
K23, K32<br>
ADVAN12<br>ADVAN4<br>$PK<br>
K24, K42<br>
ADVAN12<br>$PK<br>
KA<br>
ADVAN12<br>ADVAN2<br>ADVAN4<br>Exogenous supplementation example<br>$PK<br>TRANS2<br>TRANS3<br>TRANS4<br>TRANS5<br>TRANS6<br>
KAPPA<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
KCALL<br>
CONTR: KCALL<br>
KM<br>
ADVAN10<br>
KM0, KMN<br>
ADVAN5 ADVAN7<br>$PK<br>
KNUTHSUMOFF<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
L1<br>
ID .ID. and L1 data items<br>$INPUT<br>SIMETA<br>
L1, L2<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>
L2<br>
CCONTR: F, G, H<br>CONTR: III, DIM<br>Correlation Across L2 Records<br>$INPUT<br>L2 data item<br>Plasma urine example<br>SIMEPS<br>
L2CR_DIM<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>
L2NO<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>
LADD<br>
SIZES FSIZES prsizes<br>
26<br>
<hr>
<A name=32></a>Help Guide<br>
RESERVED WORDS<br>
LAGGED<br>
Calling protocol phrase<br>
LAPLACE<br>
$ESTIMATION record options<br>
LAPLACIAN, LAPLACEAN<br>
$ABBREVIATED<br>Bayes Example 10<br>Bayes Example 10l<br>ERROR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>Logistic regression example<br>PRED<br>
LAST<br>
$BIND<br>$TABLE<br>
LAST20<br>
$DAT A<br>
LASTDOS<br>
Additional_Record_Counters<br>
LASTOBS<br>
Additional_Record_Counters<br>
LASTONLY<br>
$TABLE<br>
LASTREC<br>
Additional_Record_Counters<br>
LBSIZE<br>
SIZES FSIZES prsizes<br>
LCM110<br>
SIZES FSIZES prsizes<br>
LEVEL<br>
$LEVEL<br>
$LEVEL<br>
$LEVEL<br>
LEVWT<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
LFORMAT<br>
$TABLE<br>
LICFILE, LICFILE<br>
nmfe utility program<br>
LIKE<br>
$ESTIMATION record options<br>
LIKELIHOOD<br>
Expectation example<br>Logistic regression example<br>NCONTR<br>PRED<br>PRED_RES_WRES<br>
LIM1<br>
SIZES FSIZES prsizes<br>
LIM10<br>
SIZES FSIZES prsizes<br>
LIM11<br>
SIZES FSIZES prsizes<br>
LIM13<br>
SIZES FSIZES prsizes<br>
LIM15<br>
SIZES FSIZES prsizes<br>
LIM16<br>
SIZES FSIZES prsizes<br>
LIM2<br>
SIZES FSIZES prsizes<br>
LIM3<br>
SIZES FSIZES prsizes<br>
LIM4<br>
SIZES FSIZES prsizes<br>
LIM5<br>
SIZES FSIZES prsizes<br>
LIM6<br>
SIZES FSIZES prsizes<br>
LIM7<br>
SIZES FSIZES prsizes<br>
LIM8<br>
SIZES FSIZES prsizes<br>
LINK<br>
$MODEL<br>
27<br>
<hr>
<A name=33></a>RESERVED WORDS Help Guide<br>
MODEL<br>
LIREC<br>
Moving Area Under the Curve Example<br>Size of Individual Record<br>
LIST<br>
Non-active ETA list for PRED<br>$WARNINGS<br>
LL, LOGLIKELIHOOD<br>
$ESTIMATION, $ESTM<br>Logistic regression example<br>
LNP4<br>
PRED-Deﬁned Variables<br>SIZES FSIZES prsizes<br>
LNTWOPI<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
LOCFILE<br>
nmfe utility program<br>
LOG, LOG10<br>
Abbreviated code<br>
LPAR<br>
SIZES FSIZES prsizes<br>
LPAR2<br>
SIZES FSIZES prsizes<br>
LPAR3<br>
SIZES FSIZES prsizes<br>
LRECL<br>
$DAT A<br>
LS_ALLOC1<br>
SIZES FSIZES prsizes<br>
LS_ALLOC2<br>
SIZES FSIZES prsizes<br>
LS_DIM<br>
CONTR: III, DIM<br>
LSTEXT<br>
SIZES FSIZES prsizes<br>
LSUPP<br>
$NONPARAMETRIC<br>SIZES FSIZES prsizes<br>
LTH<br>
SIZES FSIZES prsizes<br>
LVOUT<br>
Non-active ETA list for PRED<br>
LVR<br>
SIZES FSIZES prsizes<br>
LVR2<br>
SIZES FSIZES prsizes<br>
LVRM<br>
SIZES FSIZES prsizes<br>
LWS1<br>
SIZES FSIZES prsizes<br>
LWS2<br>
SIZES FSIZES prsizes<br>
LWS3<br>
SIZES FSIZES prsizes<br>
M<br>
Active ETA list for PREDPP<br>
M1<br>
$ESTIMATION, $ESTM<br>
M1A<br>
$ESTIMATION, $ESTM<br>
M1B<br>
$ESTIMATION, $ESTM<br>
M2<br>
$ESTIMATION, $ESTM<br>
M3<br>
$ESTIMATION, $ESTM<br>
MADAPT<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
MAP<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
MAPCOV<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
MAPINTER<br>
$ESTIMATION record options<br>
28<br>
<hr>
<A name=34></a>Help Guide<br>
RESERVED WORDS<br>
MAPINTER, MAPITER<br>
$ESTIMATION, $ESTM<br>
MAPITER<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 7r<br>$ESTIMATION record options<br>
MARGINAL<br>
$NONPARAMETRIC<br>Nonparametric Density: DEN_, CDEN_<br>Nonparametric example<br>
MASSRESET<br>
$ESTIMATION record options<br>
MATRIX<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>$COVARIANCE, $COVR<br>
MAX<br>
Abbreviated code<br>
MAXDIMM<br>
SIZES FSIZES prsizes<br>
MAXDIMZ<br>
SIZES FSIZES prsizes<br>
MAXETAI<br>
SIZES FSIZES prsizes<br>
MAXEVAL<br>
$ESTIMATION record options<br>
MAXEVALS<br>
Control3 example<br>$ESTIMATION, $ESTM<br>MONITORING OF SEARCH<br>
MAXEXTRA<br>
SIZES FSIZES prsizes<br>
MAX_EXTRA<br>
SIZES FSIZES prsizes<br>
MAXFCN<br>
Diff Eq Solver Settings<br>SIZES FSIZES prsizes<br>
MAXFTEXT<br>
SIZES FSIZES prsizes<br>
MAXIC<br>
SIZES FSIZES prsizes<br>
MAXIDS<br>
Objective Function Value Individual<br>Objective Function Value Individual example<br>SIZES FSIZES prsizes<br>
29<br>
<hr>
<A name=35></a>RESERVED WORDS Help Guide<br>
MAXITER<br>
SIZES FSIZES prsizes<br>
MAXLIM<br>
nmfe utility program<br>
MAXNSP<br>
SIZES FSIZES prsizes<br>
MAXOMEG<br>
SIZES FSIZES prsizes<br>
MAXOMEGL<br>
SIZES FSIZES prsizes<br>
MAXOTHER<br>
SIZES FSIZES prsizes<br>
MAXPARW<br>
SIZES FSIZES prsizes<br>
MAXPHICOVI<br>
SIZES FSIZES prsizes<br>
MAXPTHETA<br>
SIZES FSIZES prsizes<br>
MAXRECID<br>
SIZES FSIZES prsizes<br>
MAXSIDL<br>
SIZES FSIZES prsizes<br>
MAXSIDS<br>
SIZES FSIZES prsizes<br>
MAXVRESN<br>
SIZES FSIZES prsizes<br>
MAXVRESWRES<br>
SIZES FSIZES prsizes<br>
MAXXNAME<br>
SIZES FSIZES prsizes<br>
MCETA<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
MDV<br>
DV and MDV data items<br>$INPUT<br>Multiple_dose example<br>OBSERVA TION RECORDS<br>Phenobarb example<br>
MDVI1<br>
DV and MDV data items<br>
MDVI2<br>
DV and MDV data items<br>
MDVI3<br>
DV and MDV data items<br>
MDVRES<br>
MDVRES<br>NONMEM modules<br>variables in modules<br>
METH<br>
Diff Eq Solver Settings<br>
METHOD<br>
$ABBREVIATED<br>$ESTIMATION, $ESTM<br>
MFIRST<br>
Partial Derivative Indicators<br>
MIN<br>
Abbreviated code<br>
MISDAT<br>
$DAT A<br>
MISSING<br>
FINEDAT A<br>Finedata example<br>NMTEMPLATE<br>
MITER<br>
Diff Eq Solver Settings<br>
MIX<br>
$CONTR<br>$MIX<br>MIX<br>MIX CONTR: THETA<br>MIX: DAT A<br>MIXNUM_MIXEST_MIXP<br>Mixture_model example<br>
30<br>
<hr>
<A name=36></a>Help Guide<br>
RESERVED WORDS<br>
Stubs<br>$SUBROUTINES<br>
$MIX<br>
$MIX<br>
MIX<br>
$MIX<br>MIX<br>MIXNUM_MIXEST_MIXP<br>
MIXNUM, MIXEST, MIXP<br>
MIXNUM_MIXEST_MIXP<br>Mixture_model example<br>Mixture model: MIXNUM, MIXEST<br>Mixture model: MIXP<br>
MIXP<br>
$MIX<br>
MIXPT<br>
Mixture model: MIXPT<br>
MMX<br>
SIZES FSIZES prsizes<br>
MNEXT<br>
Enterhepatic circulation examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>Model Event Time: MNOW, MPAST, MNEXT<br>Model Time examples<br>MTIME MNEXT MPAST MNOW MTDIFF<br>
MNOW<br>
Enterhepatic circulation examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>Model Event Time: MNOW, MPAST, MNEXT<br>Model Time examples<br>MTIME MNEXT MPAST MNOW MTDIFF<br>
MOD<br>
Abbreviated code<br>
MODE<br>
Finalization example ($PRED and $INFN)<br>INFN<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>Initialization-Finalization block<br>PASS<br>$PRIOR<br>TNPRI<br>TNPRI examples<br>
MODEL<br>
ADVAN5 ADVAN7<br>ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>ADVAN9_15<br>ADVAN (general)<br>Control6 example<br>Control7 example<br>$MODEL<br>MODEL<br>$SUBROUTINES<br>
$MODEL<br>
Control6 example<br>
MODEL<br>
Control7 example<br>
$MODEL<br>
Control7 example<br>$MODEL<br>
MODEL<br>
MODEL<br>
31<br>
<hr>
<A name=37></a>RESERVED WORDS Help Guide<br>
MPAST<br>
Enterhepatic circulation examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>Model Event Time: MNOW, MPAST, MNEXT<br>Model Time examples<br>MTIME MNEXT MPAST MNOW MTDIFF<br>
MRG_<br>
Displayed PRED-Deﬁned Items<br>Expectation block<br>Expectation example<br>$INPUT<br>MRG_ data item<br>
MSEC<br>
Partial Derivative Indicators<br>
MSFI<br>
Model Speciﬁcation ﬁle<br>$MSFI<br>Nonparametric example<br>
$MSFI<br>
$MSFI<br>
MSFO<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>Model Speciﬁcation ﬁle<br>Multiple_dose example<br>$NONPARAMETRIC<br>
MSFTEST<br>
$MSFI<br>
MTDIFF<br>
Enterhepatic circulation examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>Model Event Time: MNOW, MPAST, MNEXT<br>Model Event Time: MTDIFF<br>Model Time examples<br>MTIME MNEXT MPAST MNOW MTDIFF<br>
MTHVR<br>
SIZES FSIZES prsizes<br>
MTIME<br>
Enterhepatic circulation examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>MINIMUM VALUE OF OBJ. FUNCTION<br>Model Event Time: MNOW, MPAST, MNEXT<br>Model Event Time: MTIME<br>Model Time examples<br>Moving Area Under the Curve Example<br>MTIME MNEXT MPAST MNOW MTDIFF<br>$PK<br>
MU_<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>
32<br>
<hr>
<A name=38></a>Help Guide<br>
RESERVED WORDS<br>
Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>
MULT<br>
MULT<br>
MUM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
MXNAME<br>
SIZES FSIZES prsizes<br>
MXSTEP<br>
MXSTEP<br>
NACTIV<br>
Active ETA list for PREDPP<br>
NAETA<br>
Non-active ETA list for PRED<br>
NBURN<br>
Aneal<br>Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NCM<br>
MODEL<br>
NCM1<br>
$AES<br>$AESINITIAL<br>
NCM, NCOMPS, NCOMPARTMENTS<br>
$MODEL<br>
NCONTR<br>
NCONTR<br>
NDREC<br>
Additional_Record_Counters<br>Record Counters: NIREC, NDREC<br>
NEN<br>
$DAT A<br>
NEPP<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>
NEPS<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>
NEQUILIBRIUM<br>
$MODEL<br>
NETA<br>
Bayes Example 1B<br>NWPRI<br>NWPRI examples<br>
33<br>
<hr>
<A name=39></a>RESERVED WORDS Help Guide<br>
$PRIOR<br>PRIOR<br>
NETAS<br>
PK<br>TRANS (subroutine)<br>
NETEXT<br>
PRED Error Message<br>PRED Exit Code<br>
NETP<br>
Bayes Example 1B<br>Bayes Example 6s<br>Bayes Example 6sb<br>NWPRI<br>NWPRI examples<br>$OMEGAP, $OMEGAPD<br>$PRIOR<br>PRIOR<br>
NEVAL<br>
FINEDAT A<br>Finedata example<br>NMTEMPLATE<br>
NEW<br>
Calling protocol phrase<br>SIMEPS<br>SIMETA<br>$SIMULATION<br>Verbatim code<br>
NEWBIO<br>
Bioavailability Behavior<br>
NEWIND<br>
$ERROR<br>Finalization example ($PRED and $INFN)<br>INFN<br>Initialization-Finalization block<br>New Individual Indicator: NEWIND<br>PASS NEWIND: NWIND<br>$PK<br>$PRED<br>PRED<br>
NEWL2<br>
$ERROR<br>PASS New L2 record: NEWL2<br>$PRED<br>
NEWND<br>
PASS<br>
NEXT<br>
$BIND<br>Bind example<br>
NFSIZES<br>
SIZES FSIZES prsizes<br>
NFUNCX<br>
SIZES FSIZES prsizes<br>
NINDR<br>
NINDR INDR1 INDR2<br>Objective Function Value Individual example<br>
NIREC<br>
Additional_Record_Counters<br>Record Counters: NIREC, NDREC<br>
NITER<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>
34<br>
<hr>
<A name=40></a>Help Guide<br>
RESERVED WORDS<br>
Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NIWRES<br>
$TABLE<br>
NL2_OBS<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>
NL2_RECS<br>
CONTR: III, DIM<br>
NLUSER<br>
SIZES FSIZES prsizes<br>
NMPR1<br>
Repetition_1 example<br>Repetition_2 example<br>
NMPR10<br>
Repetition Variables<br>Simulation: ETA, EPS<br>
NMPR11<br>
Simulation: IETAOL IEPSOL<br>
NMPR12<br>
YLO example<br>
NMPR12, YLO, YUP<br>
YLO YUP<br>YLO YUP Probability: PR_Y<br>
NMPR13, NMPR14, CTLO, CTUP<br>
CTLO<br>CTLO CTUP Probability: PR_CT<br>CTUP<br>
NMPR15<br>
SKIP<br>
NMPR16<br>
NWPRI<br>NWPRI examples<br>PRIOR<br>PRIOR Simulation: Parameters<br>TNPRI<br>
NMPR17<br>
F_FLAG<br>
NMPR50<br>
PRIOR Simulation: ICMAX<br>
NMPRD10<br>
Abbreviated code<br>
NMPRD15<br>
Abbreviated code<br>
NMPRD1, NMPRD2<br>
PRED Error Message<br>PRED Exit Code<br>
NMPRD3<br>
$ABBREVIATED<br>COMACT, COMSAV<br>COM COMACT COMSAV COMRES<br>
NMPRD4<br>
$ABBREVIATED<br>Abbreviated code<br>COMACT, COMSAV<br>
35<br>
<hr>
<A name=41></a>RESERVED WORDS Help Guide<br>
COM COMACT COMSAV COMRES<br>Displayed PRED-Deﬁned Items<br>$PRED<br>PRED-Deﬁned Variables<br>
NMPRD5<br>
Correlation Across L2 Records<br>
NMPRD5, NMPR6<br>
Simulation: SIMEPS Error Code<br>
NMPRD7<br>
Abbreviated code<br>ERROR<br>Simulation: ETA, EPS<br>
NMPRD8<br>
Recursive PRED Indicator<br>
NMPRD9<br>
PASS<br>PASS: PASSRC<br>
:nnn<br>
$TABLE<br>
NO<br>
$ABBREVIATED<br>SIZES FSIZES prsizes<br>
NOABORT<br>
Abbreviated code<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>Interoccasion_variability example<br>$THETA<br>
NOABORTFIRST<br>
$THETA<br>
NOABS0, NOABSZERO<br>
$SCATTERPLOT<br>
NOAPPEND<br>
$TABLE<br>
NOBS<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>CONTR: Y DAT A NOBS<br>
NOBSIND2<br>
CONTR: Y DAT A NOBS<br>
NOBUILD<br>
nmfe utility program<br>
NOCHECKMU<br>
$ABBREVIATED<br>
NOCOMMON<br>
$ABBREVIATED<br>
NOCOV<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NOFASTDER<br>
$ABBREVIATED<br>Partial Derivative Indicators<br>
NOFCOV<br>
$COVARIANCE, $COVR<br>
NOFIRSTDERCODE<br>
$ABBREVIATED<br>
NOFORWARD<br>
Superproblem_1 example<br>Superproblem_2 example<br>$TABLE<br>
NOHABORT<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NOHEADER<br>
Simulation_1 example<br>Simulation_2 example<br>$TABLE<br>
NOINTERACTION<br>
$ESTIMATION, $ESTM<br>
NOLABEL<br>
$CHAIN<br>
36<br>
<hr>
<A name=42></a>Help Guide<br>
RESERVED WORDS<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$TABLE<br>
NOLAPLACIAN, NOLAPLACEAN<br>
$ESTIMATION, $ESTM<br>
NOMSFTEST<br>
$MSFI<br>
NON-ACTIVE<br>
Non-active ETA list for PRED<br>
NONE<br>
$WARNINGS<br>
NON-EVENT<br>
Calling protocol phrase<br>
NONINFETA<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NONPARAMETRIC<br>
RANDOM<br>$SIMULATION<br>
NONPARAMETRIC, NONP<br>
COMACT, COMSAV<br>Displayed PRED-Deﬁned Items<br>$NONPARAMETRIC<br>Nonparametric Density: DEN_, CDEN_<br>Nonparametric example<br>
$NONPARAMETRIC, NONP<br>
$NONPARAMETRIC<br>Nonparametric Density: DEN_, CDEN_<br>Nonparametric example<br>
NOOFF<br>
$MODEL<br>
NOOPEN<br>
$DAT A<br>Superproblem_1 example<br>Superproblem_2 example<br>
NOORD0, NOORDZERO<br>
$SCATTERPLOT<br>
NOPOSTHOC<br>
$ESTIMATION, $ESTM<br>
NOPREDICTION<br>
$SIMULATION<br>
NOPRINT<br>
Phenobarb example<br>Simulation_1 example<br>Simulation_2 example<br>$SUPER<br>Superproblem_1 example<br>Superproblem_2 example<br>$TABLE<br>
NOPRIOR<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
37<br>
<hr>
<A name=43></a>RESERVED WORDS Help Guide<br>
NOREPEAT, NOREPEAT1, NOREPEAT2<br>
$ESTIMATION, $ESTM<br>
NOREPLACE<br>
$SIMULATION<br>
NORESCALE<br>
$MSFI<br>
NORESET<br>
$WARNINGS<br>
NOREWIND<br>
$DAT A<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>$SIMULATION<br>
NORMAL<br>
RANDOM<br>$SIMULATION<br>Simulation_2 example<br>
NOSLOW<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>
NOSUB<br>
$ABBREVIATED<br>$DEFAULT<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$SCATTERPLOT<br>$TABLE<br>
NOSUPRESET<br>
$SIMULATION<br>
NOTITLE<br>
$CHAIN<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$TABLE<br>
NOUTURN<br>
$ESTIMATION, $ESTM<br>
NO-U-TURN<br>
$ESTIMATION, $ESTM<br>
NOWIDE<br>
$DAT A<br>
NPAR<br>
MODEL<br>
NPARAMETERS, NPARAMS<br>
$MODEL<br>
NPATSMAX<br>
SIZES FSIZES prsizes<br>
NPD<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>$SCATTERPLOT<br>$TABLE<br>
NPDE<br>
$SCATTERPLOT<br>$TABLE<br>
NPD, NPDE, NPDE_MODE<br>
NPD, NPDE, NPDE_MODE, DV_LOQ<br>
NPDTYPE<br>
$TABLE<br>
NPE<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>
NPEXP<br>
Bayes Example 6s<br>Bayes Example 6sb<br>NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>
38<br>
<hr>
<A name=44></a>Help Guide<br>
RESERVED WORDS<br>
NPI<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>
NPL<br>
additional_output_ﬁles<br>NONMEM output ﬁles<br>
NPOPETAS, POPETAS<br>
$MSFI<br>
NPOPEXTRA<br>
SIZES FSIZES prsizes<br>
NPOP_EXTSIZE<br>
SIZES FSIZES prsizes<br>
NPOP_EXTSIZE2<br>
SIZES FSIZES prsizes<br>
NPOPMIXMAX<br>
SIZES FSIZES prsizes<br>
NPRED<br>
$SCATTERPLOT<br>$TABLE<br>
NPROB<br>
Problem Iteration Counters<br>
NPRSIZES<br>
SIZES FSIZES prsizes<br>
NPSUPP<br>
$NONPARAMETRIC<br>
NPSUPPE<br>
$NONPARAMETRIC<br>
NRD<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$SUBROUTINES<br>$TOL<br>TOL<br>
NRDC<br>
$TOL<br>TOL<br>
NREC<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>
NRECORDS, NRECS, RECORDS, RECS<br>
$DAT A<br>FINISH<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>
NREP<br>
Simulation: NREP, IREP<br>
NRES<br>
$SCATTERPLOT<br>$TABLE<br>
NRETA<br>
Active ETA list for PREDPP<br>
NSAM<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>TNPRI<br>TNPRI examples<br>
NSAMPLE<br>
$CHAIN<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NSIG<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>
39<br>
<hr>
<A name=45></a>RESERVED WORDS Help Guide<br>
Bayes Example 4<br>Bayes Example 5<br>Bayes Example 7r<br>$ESTIMATION record options<br>Signiﬁcant Digits from Est. Step<br>
NSIGDIGITS, SIGDIGITS<br>
$ESTIMATION, $ESTM<br>
NSPOP<br>
$MIX<br>MIX<br>Mixture_model example<br>
NSTORE<br>
SIZES FSIZES prsizes<br>
NSUBS<br>
CONTR: KCALL<br>Simulation: NREP, IREP<br>
NSUBS, NSUBPROBLEMS<br>
$SIMULATION<br>Simulation_2 example<br>Simulation_3 example<br>
NTHES_, NETAS_, NEPSS_<br>
Parameter Dimensions<br>
NTHETA<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>$THETAI<br>$THETAR<br>
NTHP<br>
Bayes Example 1B<br>Bayes Example 6s<br>Bayes Example 6sb<br>NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>$THETAI<br>$THETAR<br>
NULL<br>
$DAT A<br>Multiple_dose example<br>
NUMBERPOINTS, NUMPTS<br>
$THETA<br>
NUMDER<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUMERICAL<br>
$ESTIMATION record options<br>
NUMERICAL, NONUMERICAL<br>
$ABBREVIATED<br>$ESTIMATION, $ESTM<br>
NUTS<br>
$ESTIMATION, $ESTM<br>
NUTS_BASE<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_DELTA<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_EPARAM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_GAMMA<br>
$ESTIMATION, $ESTM<br>
40<br>
<hr>
<A name=46></a>Help Guide<br>
RESERVED WORDS<br>
$ESTIMATION record options<br>
NUTS_INIT<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_MASS<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_MAXDEPTH<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_OPARAM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_REG<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_SPARAM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_STEPINTER<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_STEPITER<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_TERM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_TEST<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NUTS_TRANSFORM<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
NVECX<br>
SIZES FSIZES prsizes<br>
NVNT<br>
ERROR<br>
NWIND<br>
INFN<br>PASS NEWIND: NWIND<br>
NWPRI<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>PRIOR<br>PRIOR Simulation: Parameters<br>NWPRI<br>NWPRI examples<br>$PRIOR<br>
NWRES<br>
$SCATTERPLOT<br>$TABLE<br>
41<br>
<hr>
<A name=47></a>RESERVED WORDS Help Guide<br>
OACCEPT<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
OBJ<br>
OBJ<br>
OBJECT<br>
Finalization example ($PRED and $INFN)<br>Objective Function Value<br>Objective Function Value Individual<br>Objective Function Value Individual example<br>
OBJI<br>
$SCATTERPLOT<br>$TABLE<br>
OBSERVATION<br>
Calling protocol phrase<br>
OBSONLY<br>
$SCATTERPLOT<br>
OCC<br>
FINEDAT A<br>NMTEMPLATE<br>
OLKJDF<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
OLNTWOPI<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
OMEGA<br>
FINAL PARAMETER ESTIMATE<br>INITIAL ESTIMATE (INITIAL EST)<br>Intra and inter-individual<br>$OMEGA<br>$OMEGAP, $OMEGAPD<br>Parameters OMEGA SIGMA: Current<br>Write print<br>
$OMEGA<br>
Control4 example<br>$OMEGA<br>
OMEGAF<br>
Finalization example ($PRED and $INFN)<br>Parameter Values: Initial and Final<br>
OMEGAP<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 6<br>Bayes Example 7r<br>Bayes Example 8<br>NWPRI<br>$OMEGAP, $OMEGAPD<br>
$OMEGAP<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>
42<br>
<hr>
<A name=48></a>Help Guide<br>
RESERVED WORDS<br>
Bayes Example 6<br>Bayes Example 7r<br>Bayes Example 8<br>NWPRI<br>$OMEGAP, $OMEGAPD<br>
OMEGAPD<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 6<br>Bayes Example 7r<br>Bayes Example 8<br>NWPRI<br>$OMEGAP, $OMEGAPD<br>
$OMEGAPD<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 6<br>Bayes Example 7r<br>Bayes Example 8<br>NWPRI<br>$OMEGAP, $OMEGAPD<br>
OMIT<br>
Data_average example<br>$OMIT<br>
$OMIT<br>
$OMIT<br>RAW_ data item<br>
OMITTED<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$SCATTERPLOT<br>$TABLE<br>
OMSIMP<br>
NWPRI<br>NWPRI examples<br>PRIOR<br>PRIOR Simulation: Parameters<br>TNPRI<br>Write print<br>
ONCE<br>
Calling protocol phrase<br>
ONEHEADER<br>
Phenobarb example<br>
ONEHEADERALL<br>
$TABLE<br>
ONEHEADERPERFILE<br>
$TABLE<br>
43<br>
<hr>
<A name=49></a>RESERVED WORDS Help Guide<br>
ONLYREAD<br>
$MSFI<br>
ONLYSIMULATION, ONLY<br>
Displayed PRED-Deﬁned Items<br>Plasma urine example<br>$SIMULATION<br>Simulation_1 example<br>Simulation_2 example<br>Simulation: ETA, EPS<br>
OPEN<br>
Superproblem_1 example<br>Superproblem_2 example<br>Write print<br>
OPSCRS<br>
CONTR<br>SPTWO<br>
OPTMAP<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
ORD0, ORDZERO<br>
Phenobarb example<br>$SCATTERPLOT<br>
ORDER<br>
$CHAIN<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
OSAMPLE_M1<br>
$ESTIMATION record options<br>
OSAMPLE_M2<br>
$ESTIMATION record options<br>
OSAMPLE, OSAMPLE_M1, OSAMPLE_M2<br>
$ESTIMATION, $ESTM<br>
OTHER<br>
Abbreviated Function<br>Abbreviated Function Examples<br>BIVARIATE FUNCTION<br>$SUBROUTINES<br>
OVARF<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
P<br>
$MIX<br>MIX<br>Mixture_model example<br>
PACCEPT<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
PAL<br>
SIZES FSIZES prsizes<br>
PARAFILE<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$NONPARAMETRIC<br>$SIMULATION<br>$TABLE<br>
PARAFILE, PARAFILE.PNM<br>
FOCE_PARALLEL example<br>parallel computing<br>
PARAFILE, PARAFILE.PNM, PARAFILE<br>
nmfe utility program<br>
PARAFPRINT<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>nmfe utility program<br>
44<br>
<hr>
<A name=50></a>Help Guide<br>
RESERVED WORDS<br>
PASS<br>
Finalization example ($PRED and $INFN)<br>INFN<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>PASS<br>PASS NEWIND: NWIND<br>PASS: PASSRC<br>Initialization-Finalization block<br>
PASSRC<br>
PASS<br>PASS: PASSRC<br>
PC<br>
SIZES FSIZES prsizes<br>
PCMT<br>
CMT PCMT data item<br>$INPUT<br>
PCT<br>
SIZES FSIZES prsizes<br>
PCT_BIG<br>
SIZES FSIZES prsizes<br>
PD<br>
SIZES FSIZES prsizes<br>
PDZ<br>
PROTECT functions<br>
PEXP<br>
PROTECT functions<br>
PFCOND<br>
$COVARIANCE, $COVR<br>
PHC<br>
additional_output_ﬁles<br>$ETAS, $PHIS<br>
PHE<br>
PROTECT functions<br>
PHI<br>
Abbreviated code<br>additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>NPD, NPDE, NPDE_MODE, DV_LOQ<br>Objective Function Value Individual<br>Objective Function Value Individual example<br>
PHI(n)<br>
$ETAS, $PHIS<br>
$PHIS<br>
$ETAS, $PHIS<br>
PHM<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
PIR<br>
SIZES FSIZES prsizes<br>
PK<br>
CALL data item<br>CALLFL<br>Calling protocol phrase<br>$PK<br>PK<br>State Vector: A<br>State Vector Time: TSTATE<br>$SUBROUTINES<br>
$PK<br>
Control3 example<br>$PK<br>
PK<br>
PK<br>
45<br>
<hr>
<A name=51></a>RESERVED WORDS Help Guide<br>
PL<br>
SIZES FSIZES prsizes<br>
PLEV<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>TNPRI<br>TNPRI examples<br>
PLOG<br>
PROTECT functions<br>
PLOG10<br>
PROTECT functions<br>
P(n)<br>
ADVAN9_15<br>$AES<br>AES<br>$AESINITIAL<br>$DES<br>DES<br>$PK<br>
PNG<br>
PROTECT functions<br>
Pnnnnn<br>
$TABLE<br>
PNP<br>
PROTECT functions<br>
POPETAS, NPOPETAS<br>
$MSFI<br>
POSTHOC<br>
CCONTR<br>Displayed PRED-Deﬁned Items<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>Finalization example ($PRED and $INFN)<br>FNLETA<br>Interoccasion_variability example<br>Phenobarb example<br>$TABLE<br>
PPR<br>
SIZES FSIZES prsizes<br>
PRCOMG<br>
Diff Eq Solver Settings<br>PREDPP modules<br>
PRCOMU<br>
Bioavailability Behavior<br>PREDPP modules<br>
PRCOMW<br>
ADVAN7: FACTOR<br>PREDPP modules<br>
PR_CT<br>
CTLO<br>CTLO CTUP Probability: PR_CT<br>CTUP<br>
PRDDE1<br>
DES AES: ICALL, IDEFD, IDEFA<br>
PRDDE1, PRDPK1, PRDPK2, PRDPK3, PRINFN<br>
PREDPP modules<br>
PRDFL<br>
Abbreviated code<br>Repetition_2 example<br>
PRDPK1<br>
Model Event Time: MTIME<br>MTIME MNEXT MPAST MNOW MTDIFF<br>
PRDPK2<br>
Model Event Time: MTDIFF<br>
46<br>
<hr>
<A name=52></a>Help Guide<br>
RESERVED WORDS<br>
MTIME MNEXT MPAST MNOW MTDIFF<br>
PRDPK3<br>
Compartment Initialization: A_0<br>Compartment Initialization: A_0FLG<br>Compartment Initialization Block<br>
PRDPK4<br>
Initial Steady State: I_SS, ISSMOD<br>
PRDPK4, I_SS<br>
PK<br>
PRECOND<br>
$COVARIANCE, $COVR<br>
PRECONDS<br>
$COVARIANCE, $COVR<br>
PRED<br>
Displayed PRED-Deﬁned Items<br>Non-active ETA list for PRED<br>$PRED<br>PRED<br>PRED_RES_WRES<br>$SCATTERPLOT<br>$SUBROUTINES<br>$TABLE<br>Control4 example<br>
$PRED<br>
Control4 example<br>$PRED<br>
PRED<br>
PRED<br>
PREDI<br>
$SCATTERPLOT<br>$TABLE<br>
PREDICTION<br>
$ESTIMATION record options<br>$SIMULATION<br>
PRETYPE<br>
$COVARIANCE, $COVR<br>
PRINFN<br>
INFN-deﬁned Variables<br>
PRINT<br>
Abbreviated code<br>Control3 example<br>$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>MONITORING OF SEARCH<br>$SUPER<br>Superproblem_1 example<br>Superproblem_2 example<br>$TABLE<br>Write print<br>
PRIOR<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>
47<br>
<hr>
<A name=53></a>RESERVED WORDS Help Guide<br>
Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>PRIOR<br>PRIOR Simulation: Parameters<br>$SIMULATION<br>Stubs<br>$SUBROUTINES<br>
$PRIOR<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>TNPRI<br>TNPRI examples<br>
PRIOR<br>
NWPRI<br>NWPRI examples<br>$PRIOR<br>PRIOR<br>TNPRI<br>TNPRI examples<br>
PRIORC<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
PROBLEM<br>
$PROBLEM<br>$SIZES<br>$WARNINGS<br>
$PROBLEM<br>
Control3 example<br>$PROBLEM<br>
PROCM1<br>
New Individual Indicator: NEWIND<br>
PROCM1-PROCM13, PROCMA-PROCMC<br>
PREDPP modules<br>
PROCM2<br>
Dose Time Non-Event: DOSTIM<br>
PROCM3<br>
Dose Record: DOSREC<br>
PROCM4<br>
State Vector: A<br>State Vector Time: TSTATE<br>
PROCM5<br>
Active ETA list for PREDPP<br>
PROCM6<br>
DES AES: THETA<br>
PROCM7<br>
EVENT RECORD: EVTREC<br>
PROCM8<br>
WRITE Formats<br>
PROCM9<br>
State Vector: A<br>State Vector Time: TSTATE<br>
PROCMA<br>
Model Event Time: MNOW, MPAST, MNEXT<br>MTIME MNEXT MPAST MNOW MTDIFF<br>
PROCMB<br>
DES AES: ISFINL<br>
PROCMC<br>
Compartment Initialization: A_0<br>Compartment Initialization: A_0FLG<br>Compartment Initialization Block<br>
PROTECT<br>
$ABBREVIATED<br>PROTECT functions<br>
48<br>
<hr>
<A name=54></a>Help Guide<br>
RESERVED WORDS<br>
PRRES<br>
PRRES<br>
PR_Y<br>
YLO example<br>YLO YUP<br>YLO YUP Probability: PR_Y<br>
PSAMPLE_M1<br>
Bayes Example 6s<br>$ESTIMATION record options<br>
PSAMPLE_M2<br>
Bayes Example 6s<br>$ESTIMATION record options<br>
PSAMPLE_M3<br>
Bayes Example 6s<br>$ESTIMATION record options<br>
PSAMPLE, PSAMPLE_M1, PSAMPLE_M2, PSAMPLE_M3<br>
$ESTIMATION, $ESTM<br>
PSCALE_MAX<br>
$ESTIMATION record options<br>
PSCALE_MIN<br>
$ESTIMATION record options<br>
PSCALE_MIN, PSCALE_MAX<br>
$ESTIMATION, $ESTM<br>
PSQRT<br>
PROTECT functions<br>
PW<br>
SIZES FSIZES prsizes<br>
PZR<br>
PROTECT functions<br>
Q<br>
$PK<br>TRANS3<br>
Q2, Q3, Q4<br>
$PK<br>
Q, Q2, Q3, Q4<br>
TRANS4<br>
R<br>
$COVARIANCE, $COVR<br>Expectation block<br>Simulation block<br>
R1-R9<br>
Dose event record<br>$PK<br>Rate parameter<br>
RANDOM<br>
RANDOM<br>$SIMULATION<br>Simulation_2 example<br>Expectation block<br>Initialization-Finalization block<br>Simulation block<br>
RANMETHOD<br>
$CHAIN<br>$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$SIMULATION<br>$TABLE<br>
RATE<br>
Dose event record<br>Exogenous supplementation example<br>$INPUT<br>Multiple_dose example<br>RATE data item<br>Rate parameter<br>SS dose event record<br>
49<br>
<hr>
<A name=55></a>RESERVED WORDS Help Guide<br>
RAW_<br>
Data_Average block<br>Data_average example<br>Displayed PRED-Deﬁned Items<br>Expectation example<br>$INPUT<br>$OMIT<br>RAW_ data item<br>
RDATA<br>
CONTR: Y DAT A NOBS<br>MIX: DAT A<br>
RECOMPUTE<br>
$NONPARAMETRIC<br>
RECORDS=ID<br>
$DAT A<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>
RECORDS, RECS, NRECORDS, NRECS<br>
$DAT A<br>FINISH<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>
REPEAT<br>
$ESTIMATION record options<br>
REPEAT1<br>
$ESTIMATION record options<br>
REPEAT2<br>
$ESTIMATION record options<br>
REPEAT, REPEAT1, REPEAT2<br>
$ESTIMATION, $ESTM<br>
REPLACE<br>
Bayes Example 7r<br>$SIMULATION<br>
REPLACE, REPLACEMENT<br>
$ABBREVIATED<br>Abbreviated Function Examples<br>Infn_interpolation example 2<br>
REPS<br>
DOEXPAND<br>
REQUESTFIRST<br>
$SIMULATION<br>
REQUESTSECOND<br>
$SIMULATION<br>
RES<br>
Data_average example<br>Displayed PRED-Deﬁned Items<br>Expectation example<br>PRED_RES_WRES<br>$SCATTERPLOT<br>$TABLE<br>
RESCALE<br>
$MSFI<br>
RESET<br>
$WARNINGS<br>
RESI<br>
$SCATTERPLOT<br>$TABLE<br>
RESUME<br>
$COVARIANCE, $COVR<br>
RETURN<br>
Data_Average block<br>Expectation block<br>Initialization-Finalization block<br>Simulation block<br>
REWIND<br>
$DAT A<br>RECORDS=ID Example<br>
50<br>
<hr>
<A name=56></a>Help Guide<br>
RESERVED WORDS<br>
RECORDS=ID Example 2<br>$SIMULATION<br>Write print<br>
RFORMAT<br>
$TABLE<br>
R-MATRIX<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>
RMT<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
RN<br>
Dose event record<br>$PK<br>PK<br>Rate parameter<br>
ROCM0<br>
MIX<br>MIX CONTR: THETA<br>
ROCM1<br>
$CONTR<br>CONTR<br>CONTR: Y DAT A NOBS<br>MIX<br>MIX: DAT A<br>SPTWO<br>
ROCM10<br>
Initialization-Finalization block<br>Simulation: NREP, IREP<br>
ROCM11<br>
Mixture model: MIXNUM, MIXEST<br>
ROCM12<br>
Partial Derivative Indicators<br>
ROCM13<br>
CONTR: KCALL<br>
ROCM14<br>
Initialization-Finalization block<br>Problem Iteration Counters<br>
ROCM15<br>
Non-active ETA list for PRED<br>
ROCM16<br>
Signiﬁcant Digits from Est. Step<br>
ROCM17<br>
Initialization-Finalization block<br>PASS New L2 record: NEWL2<br>
ROCM18<br>
Nonparametric Density: DEN_, CDEN_<br>Nonparametric example<br>
ROCM1C<br>
CONTR: Y DAT A NOBS<br>
51<br>
<hr>
<A name=57></a>RESERVED WORDS Help Guide<br>
ROCM2<br>
CONTR: III, DIM<br>
ROCM22<br>
Parameters OMEGA SIGMA: Current<br>
ROCM25<br>
Mixture model: MIXP<br>
ROCM28<br>
Super Problem Print Control<br>
ROCM29<br>
Population single-Subject Indicator<br>
ROCM3<br>
CONTR: F, G, H<br>
ROCM31<br>
Data_Average block<br>MIX CONTR: TEMPLT<br>
ROCM32<br>
Initialization-Finalization block<br>Record Counters: NIREC, NDREC<br>
ROCM34<br>
Initialization-Finalization block<br>PASS<br>PASS NEWIND: NWIND<br>
ROCM35<br>
Parameter Dimensions<br>Parameters OMEGA SIGMA: Current<br>
ROCM4<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>$CONTR<br>CONTR<br>SPTWO<br>
ROCM44<br>
YLO example<br>YLO YUP<br>YLO YUP Probability: PR_Y<br>
ROCM45<br>
CTLO<br>CTLO CTUP Probability: PR_CT<br>CTUP<br>
ROCM46<br>
Initialization-Finalization block<br>NINDR INDR1 INDR2<br>
ROCM47<br>
Mixture model: MIXPT<br>
ROCM48<br>
Initialization-Finalization block<br>Size of Individual Record<br>
ROCM49<br>
Initialization-Finalization block<br>PRED, RES, WRES<br>
ROCM5<br>
CCONTR: F, G, H<br>
ROCM50<br>
Objective Function Value Individual<br>Objective Function Value Individual example<br>
ROCM6<br>
Finalization example ($PRED and $INFN)<br>Initialization-Finalization block<br>Parameters OMEGA SIGMA: Current<br>Parameter Values: Initial and Final<br>
ROCM7<br>
Finalization example ($PRED and $INFN)<br>Initialization-Finalization block<br>Standard Errors<br>
ROCM8<br>
Finalization example ($PRED and $INFN)<br>Initialization-Finalization block<br>Objective Function Value<br>
ROCM9<br>
Estim Covar Error Codes<br>
52<br>
<hr>
<A name=58></a>Help Guide<br>
RESERVED WORDS<br>
Finalization example ($PRED and $INFN)<br>Initialization-Finalization block<br>
RPT_<br>
$INPUT<br>Repetition_1 example<br>Repetition Variables<br>RPT_ data item<br>
RPTI<br>
Repetition_2 example<br>
RPTI, RPTO, RPTON, PRDFL<br>
Repetition Variables<br>
RPTO<br>
Abbreviated code<br>Repetition_2 example<br>
RPTON<br>
Abbreviated code<br>Repetition_1 example<br>
RPTO, RPTI<br>
Repetition_1 example<br>
RS_ALLOC1<br>
SIZES FSIZES prsizes<br>
RS_ALLOC2<br>
SIZES FSIZES prsizes<br>
RUNDIR, RUNPDIR, NMEXEC<br>
nmfe utility program<br>
RV_ALLOC1<br>
SIZES FSIZES prsizes<br>
RV_ALLOC2<br>
SIZES FSIZES prsizes<br>
S<br>
$COVARIANCE, $COVR<br>
S0<br>
Scaling parameter<br>
S0, S1-S10, SC<br>
$PK<br>
S1NUM, S2NUM, S1NIT, S2NIT, S1IT, S2IT<br>
Problem Iteration Counters<br>
SADDLE_HESS<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
SADDLE_RESET<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
SAEM<br>
Aneal<br>Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 7r<br>Bayes Example 9<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
SAME<br>
Interoccasion_variability example<br>Mixture_model example<br>$OMEGA<br>$SIGMA<br>
SAME(m)<br>
$OMEGA<br>$SIGMA<br>
SCATTERPLOTS<br>
COMACT, COMSAV<br>
53<br>
<hr>
<A name=59></a>RESERVED WORDS Help Guide<br>
COM COMACT COMSAV COMRES<br>Displayed PRED-Deﬁned Items<br>Phenobarb example<br>PRED-Deﬁned Variables<br>$SCATTERPLOT<br>
$SCATTERPLOTS<br>
Control3 example<br>$SCATTERPLOT<br>
SCO<br>
SIZES FSIZES prsizes<br>
SCOPE<br>
Problem Iteration Counters<br>$SUPER<br>Superproblem_1 example<br>Superproblem_2 example<br>
SD<br>
$OMEGA<br>$SIGMA<br>SIZES FSIZES prsizes<br>
SDF<br>
SIZES FSIZES prsizes<br>
SEED<br>
Bayes Example 1<br>Bayes Example 1B<br>Bayes Example 2<br>$CHAIN<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>$TABLE<br>
SELECT<br>
$CHAIN<br>$ESTIMATION, $ESTM<br>
SEOMEG<br>
Write print<br>
SEOMEG, SESIGM, SETHET, SETHETR<br>
Standard Errors<br>
SEOM, SESIG, SETH<br>
Finalization example ($PRED and $INFN)<br>
SESIGM<br>
Write print<br>
SETHET<br>
Write print<br>
SETHETR<br>
Write print<br>
SETHR<br>
Finalization example ($PRED and $INFN)<br>
SGSIMP<br>
NWPRI<br>NWPRI examples<br>PRIOR<br>PRIOR Simulation: Parameters<br>Write print<br>
SGSIMP, THSIMPR<br>
TNPRI<br>
SHK<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
SHM<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>ETASXI<br>NONMEM output ﬁles<br>
SIGDIGITS<br>
$ESTIMATION record options<br>
54<br>
<hr>
<A name=60></a>Help Guide<br>
RESERVED WORDS<br>
SIGDIGITS, NSIGDIGITS<br>
$ESTIMATION, $ESTM<br>Phenobarb example<br>
SIGL<br>
Bayes Example 1<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 9<br>$COVARIANCE, $COVR<br>$ESTIMATION record options<br>
SIGLO<br>
$COVARIANCE, $COVR<br>$ESTIMATION record options<br>
SIGL, SIGLO<br>
$ESTIMATION, $ESTM<br>
SIGMA<br>
FINAL PARAMETER ESTIMATE<br>INITIAL ESTIMATE (INITIAL EST)<br>Intra and inter-individual<br>Parameters OMEGA SIGMA: Current<br>$SIGMA<br>$SIGMAP, $SIGMAPD<br>Write print<br>
$SIGMA<br>
Control4 example<br>$SIGMA<br>
SIGMAF<br>
Finalization example ($PRED and $INFN)<br>Parameter Values: Initial and Final<br>
SIGMAP<br>
Bayes Example 1<br>NWPRI<br>$SIGMAP, $SIGMAPD<br>
$SIGMAP<br>
Bayes Example 1<br>NWPRI<br>$SIGMAP, $SIGMAPD<br>
SIGMAPD<br>
Bayes Example 1<br>NWPRI<br>$SIGMAP, $SIGMAPD<br>
$SIGMAPD<br>
Bayes Example 1<br>NWPRI<br>$SIGMAP, $SIGMAPD<br>
SIGNAL<br>
SIGNAL<br>
SIMEPS<br>
Correlation Across L2 Records<br>ERROR<br>PRED<br>
55<br>
<hr>
<A name=61></a>RESERVED WORDS Help Guide<br>
SIMEPS<br>$SIMULATION<br>Simulation: ETA, EPS<br>Simulation: IETAOL IEPSOL<br>Simulation: SIMEPS Error Code<br>Simulation block<br>
SIMETA<br>
ERROR<br>PK<br>PRED<br>SIMETA<br>$SIMULATION<br>Simulation: ETA, EPS<br>Simulation: IETAOL IEPSOL<br>Simulation block<br>
SIMPARON<br>
nmfe utility program<br>
SIMULATION<br>
Simulation: IETAOL IEPSOL<br>
SIMULATION, SIMULATE<br>
Compartment Initialization Block<br>CONTR: KCALL<br>Logistic regression example<br>Nonparametric example<br>Plasma urine example<br>RANDOM<br>SIMEPS<br>SIMETA<br>$SIMULATION<br>Simulation_1 example<br>Simulation_2 example<br>Simulation_3 example<br>Simulation: ETA, EPS<br>Simulation: NREP, IREP<br>Superproblem_1 example<br>Superproblem_2 example<br>Verbatim code<br>
$SIMULATION, $SIMULATE<br>
Nonparametric example<br>Plasma urine example<br>
SIMULATION, SIMULATE<br>
Plasma urine example<br>
$SIMULATION, $SIMULATE<br>
$SIMULATION<br>Simulation_1 example<br>
SIMULATION, SIMULATE<br>
Simulation_1 example<br>
$SIMULATION, $SIMULATE<br>
Simulation_2 example<br>
SIMULATION, SIMULATE<br>
Simulation_2 example<br>
$SIMULATION, $SIMULATE<br>
Simulation_3 example<br>
SIMULATION, SIMULATE<br>
Simulation_3 example<br>
SIN<br>
Abbreviated code<br>
SIRCENTER<br>
$COVARIANCE, $COVR<br>
SIRDF<br>
$COVARIANCE, $COVR<br>
SIRNITER<br>
$COVARIANCE, $COVR<br>
56<br>
<hr>
<A name=62></a>Help Guide<br>
RESERVED WORDS<br>
SIRPRINT<br>
$COVARIANCE, $COVR<br>
SIRSAMPLE<br>
$COVARIANCE, $COVR<br>
SIRTHBND<br>
$COVARIANCE, $COVR<br>
SIZES<br>
$PROBLEM<br>$SIZES<br>$WARNINGS<br>
$SIZES<br>
$SIZES<br>
SKIP<br>
Abbreviated code<br>$BIND<br>$DAT A<br>DATE data item<br>$INPUT<br>SKIP<br>
SLKJDF<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
SLOW<br>
$COVARIANCE, $COVR<br>$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
SMT<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
SN<br>
$PK<br>PK<br>Scaling parameter<br>
SORT<br>
$ESTIMATION record options<br>
SORT, NOSORT<br>
$ESTIMATION, $ESTM<br>
SPECIAL<br>
$COVARIANCE, $COVR<br>
SPTWO<br>
PRED_RES_WRES<br>SPTWO<br>Stubs<br>$SUBROUTINES<br>
SQRT<br>
Abbreviated code<br>
SS<br>
Absorption lag parameter<br>Dose event record<br>Exogenous supplementation example<br>$INPUT<br>Interoccasion_variability example<br>SS data item<br>SS dose event record<br>
SS6, SS9<br>
SS6 SS9<br>
SSATOL<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>$SUBROUTINES<br>$TOL<br>TOL<br>
SSATOLC<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
SS, SS1-SS7, SS9<br>
$SUBROUTINES<br>
57<br>
<hr>
<A name=63></a>RESERVED WORDS Help Guide<br>
SS, SS1-SS7, SS9, SS11-12<br>
SS option<br>
SSS, SSS0<br>
SS option<br>
SSTOL<br>
$SUBROUTINES<br>$TOL<br>TOL<br>
STANDARD<br>
$OMEGA<br>$SIGMA<br>
STDOBJ<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
STEP<br>
DOEXPAND<br>
STIELTJES<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>Stieltjes example<br>
STIELTJ_SIZE<br>
SIZES FSIZES prsizes<br>
STRAT, STRATF<br>
$NONPARAMETRIC<br>$SIMULATION<br>
SUBPROBLEMS<br>
$SIMULATION<br>Simulation_2 example<br>Simulation_3 example<br>
SUBROUTINE<br>
Simulation: IETAOL IEPSOL<br>$SUBROUTINES<br>
$SUBROUTINES<br>
Control3 example<br>$SUBROUTINES<br>
SUBS, SUBROUTINES<br>
SUBROUTINE<br>$SUBROUTINES<br>
SUPER<br>
$PROBLEM<br>$SIZES<br>$WARNINGS<br>
$SUPER<br>
Problem Iteration Counters<br>$SUPER<br>Superproblem_1 example<br>Superproblem_2 example<br>
SUPP<br>
SUPP<br>Initialization-Finalization block<br>
SUPRESET<br>
$SIMULATION<br>
SVARF<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
T<br>
$AES<br>AES<br>$AESINITIAL<br>$DES<br>DES<br>
TABLE<br>
COMACT, COMSAV<br>COM COMACT COMSAV COMRES<br>Displayed PRED-Deﬁned Items<br>Phenobarb example<br>
58<br>
<hr>
<A name=64></a>Help Guide<br>
RESERVED WORDS<br>
PRED-Deﬁned Variables<br>Simulation_1 example<br>Simulation_2 example<br>$TABLE<br>
$TABLE<br>
Control3 example<br>
TABLE<br>
Phenobarb example<br>
$TABLE<br>
Phenobarb example<br>
TABLE<br>
Simulation_1 example<br>
$TABLE<br>
Simulation_1 example<br>
TABLE<br>
Simulation_2 example<br>
$TABLE<br>
Simulation_2 example<br>$TABLE<br>
TAN<br>
Abbreviated code<br>
TDELTA<br>
FINEDAT A<br>NMTEMPLATE<br>
TEMPLT<br>
Data_Average block<br>MIX CONTR: TEMPLT<br>Mixture model: MIXPT<br>$OMIT<br>
THBND<br>
$COVARIANCE, $COVR<br>
THETA<br>
$AES<br>AES<br>$DES<br>DES<br>DES AES: ICALL, IDEFD, IDEFA<br>DES AES: THETA<br>FINAL PARAMETER ESTIMATE<br>INITIAL ESTIMATE (INITIAL EST)<br>MIX CONTR: THETA<br>$THETA<br>$THETAI<br>$THETAP, $THETAPV<br>$THETAR<br>
$THETA<br>
Control3 example<br>Control4 example<br>INITIAL ESTIMATE (INITIAL EST)<br>$THETA<br>
THETAC<br>
MIX CONTR: THETA<br>
THETAF<br>
Finalization example ($PRED and $INFN)<br>Parameter Values: Initial and Final<br>
THETAFR<br>
Finalization example ($PRED and $INFN)<br>Parameter Values: Initial and Final<br>
THETAI<br>
Stubs<br>$THETAI<br>
$THETAI<br>
$THETAI<br>
THETA(n)<br>
$ERROR<br>
59<br>
<hr>
<A name=65></a>RESERVED WORDS Help Guide<br>
ERROR<br>INFN<br>$PK<br>PK<br>$PRED<br>PRED<br>
THETAP<br>
Bayes Example 1<br>Bayes Example 1B<br>Bayes Example 8<br>NWPRI<br>$THETAI<br>$THETAP, $THETAPV<br>$THETAR<br>
$THETAP<br>
Bayes Example 1<br>Bayes Example 1B<br>Bayes Example 8<br>NWPRI<br>$THETAP, $THETAPV<br>
THETAPI<br>
$THETAI<br>$THETAR<br>
THETAPV<br>
Bayes Example 1<br>Bayes Example 1B<br>Bayes Example 8<br>NWPRI<br>$THETAP, $THETAPV<br>
$THETAPV<br>
Bayes Example 1<br>Bayes Example 1B<br>Bayes Example 8<br>NWPRI<br>$THETAP, $THETAPV<br>
THETAR<br>
Stubs<br>$THETAR<br>
$THETAR<br>
$THETAR<br>
THIN<br>
$ESTIMATION record options<br>
THSIMP<br>
NWPRI<br>NWPRI examples<br>PRIOR<br>PRIOR Simulation: Parameters<br>TNPRI<br>Write print<br>
THSIMPR<br>
NWPRI<br>NWPRI examples<br>PRIOR<br>PRIOR Simulation: Parameters<br>Write print<br>
TIME<br>
Calling protocol phrase<br>Control5 example<br>DATE data item<br>
60<br>
<hr>
<A name=66></a>Help Guide<br>
RESERVED WORDS<br>
$INPUT<br>TIME data item<br>
TNPRI<br>
PRIOR<br>PRIOR Simulation: Parameters<br>$PRIOR<br>TNPRI<br>TNPRI examples<br>
TO<br>
$MODEL<br>$SCATTERPLOT<br>$TABLE<br>
TOL<br>
ADVAN10<br>ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>ADVAN9_15<br>ADVAN (general)<br>Control7 example<br>$COVARIANCE, $COVR<br>$SUBROUTINES<br>$TOL<br>TOL<br>
$TOL<br>
$TOL<br>
TOL<br>
$TOL<br>TOL<br>
TOLC<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
TOS<br>
$COVARIANCE, $COVR<br>
TPRDEFAULT<br>
nmfe utility program<br>
TRANS<br>
TRANS (subroutine)<br>
TRANS1<br>
Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>TRANS1<br>
TRANS2<br>
ADVAN1<br>ADVAN2<br>Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 7r<br>Interoccasion_variability example<br>Phenobarb example<br>TRANS2<br>
TRANS3<br>
ADVAN3<br>ADVAN4<br>TRANS3<br>
TRANS4<br>
ADVAN11<br>ADVAN12<br>ADVAN3<br>
61<br>
<hr>
<A name=67></a>RESERVED WORDS Help Guide<br>
ADVAN4<br>Bayes Example 1<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 8<br>Bayes Example 9<br>FOCE_PARALLEL example<br>Multiple_dose example<br>TRANS4<br>
TRANS5<br>
ADVAN3<br>ADVAN4<br>Exogenous supplementation example<br>TRANS5<br>
TRANS6<br>
ADVAN11<br>ADVAN12<br>ADVAN3<br>ADVAN4<br>TRANS6<br>
TRANSLATE<br>
$DAT A<br>
TRANS, TRANS1-TRANS6<br>
$SUBROUTINES<br>TRANS (option)<br>
TRSKIP, PRSAME, PRDEFAULT, PRCOMPILE<br>
nmfe utility program<br>
TRUE<br>
Nonparametric example<br>$SIMULATION<br>
TSCALE, XSCALE<br>
$PK<br>PK<br>Time scale parameter<br>
TSTART<br>
FINEDAT A<br>NMTEMPLATE<br>
TSTATE<br>
$PK<br>State Vector: A<br>State Vector Time: TSTATE<br>
TSTOP<br>
FINEDAT A<br>NMTEMPLATE<br>
TTDF<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
UNCONDITIONAL<br>
$NONPARAMETRIC<br>$SCATTERPLOT<br>$TABLE<br>
UNIFORM<br>
RANDOM<br>$SIMULATION<br>
UNIT<br>
Control3 example<br>$SCATTERPLOT<br>
USMETA<br>
$SUBROUTINES<br>
UTURN<br>
$ESTIMATION, $ESTM<br>
U-TURN<br>
$ESTIMATION, $ESTM<br>
V<br>
$PK<br>
62<br>
<hr>
<A name=68></a>Help Guide<br>
RESERVED WORDS<br>
TRANS2<br>TRANS3<br>
V1, V2, V3, V4<br>
$PK<br>TRANS4<br>
VALUES<br>
$OMEGA<br>$OMEGAP, $OMEGAPD<br>$SIGMA<br>
VARCALC<br>
$TABLE<br>
VARIANCE<br>
$OMEGA<br>$SIGMA<br>
VECTOR<br>
$ABBREVIATED<br>
VECTR<br>
$TABLE<br>
VECTR, VECTRA, VECTRB, VECTRC<br>
Abbreviated Function<br>Abbreviated Function Examples<br>Transit Compartment Examples<br>
VECTR, VECTRA, VECTRB, VECTRC, VECTRA-VECTRZ<br>
Abbreviated code<br>
VERSION<br>
$MSFI<br>
VM<br>
ADVAN10<br>
VPD<br>
additional_output_ﬁles<br>$ESTIMATION, $ESTM<br>NONMEM output ﬁles<br>
VRBL<br>
PRED-Deﬁned Variables<br>
VS<br>
$SCATTERPLOT<br>
VSS<br>
$PK<br>TRANS3<br>
WARNINGMAXIMUM, WMAX<br>
$WARNINGS<br>
WARNINGS<br>
$WARNINGS<br>
WHILE<br>
Abbreviated code<br>SIMETA<br>Transit Compartment Examples<br>
WIDE<br>
$DAT A<br>
WRES<br>
Displayed PRED-Deﬁned Items<br>PRED_RES_WRES<br>$SCATTERPLOT<br>$TABLE<br>
WRESCHOL<br>
$TABLE<br>
WRESI<br>
$SCATTERPLOT<br>$TABLE<br>
WRITE<br>
Abbreviated code<br>Write print<br>
XMLOFF, XMLOFF, FLUSHTIME<br>
nmfe utility program<br>
XN<br>
$OMEGA<br>$SIGMA<br>$THETA<br>
XSCALE, TSCALE<br>
$PK<br>
63<br>
<hr>
<A name=69></a>RESERVED WORDS Help Guide<br>
PK<br>Time scale parameter<br>
XVID1-XVID5<br>
EVID data item<br>$INPUT<br>
Y<br>
CCONTR: Y, DAT A, N1, N2, DIM<br>CONTR: Y DAT A NOBS<br>$ERROR<br>$PRED<br>
YLO<br>
YLO example<br>
ZERO<br>
$ESTIMATION, $ESTM<br>$ESTIMATION record options<br>
64<br>
<hr>
<A name=70></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
**** NONMEM ﬁle control stream<br>
1000000000 raw_output_ﬁle<br>
-1000000000 raw_output_ﬁle<br>
1000000001 raw_output_ﬁle<br>
-1000000001 raw_output_ﬁle<br>
1000000002 raw_output_ﬁle<br>
-1000000002 raw_output_ﬁle<br>
1000000003 raw_output_ﬁle<br>
-1000000003 raw_output_ﬁle<br>
1000000004 raw_output_ﬁle<br>
-1000000004 raw_output_ﬁle<br>
1000000005 raw_output_ﬁle<br>
-1000000005 raw_output_ﬁle<br>
1000000006 raw_output_ﬁle<br>
-1000000006 raw_output_ﬁle<br>
1000000007 raw_output_ﬁle<br>
-1000000007 raw_output_ﬁle<br>
1000000008 raw_output_ﬁle<br>
-1000000008 raw_output_ﬁle<br>
1.0E+06 $ESTIMATION,$ESTM<br>
INDIVIDUALS<br>$OMEGA<br>RECORDS=ID Example<br>RECORDS=ID Example 2<br>
160 $INPUT<br>
2000 $DAT A<br>
2000000000 raw_output_ﬁle<br>
2000000001 raw_output_ﬁle<br>
2000000002 raw_output_ﬁle<br>
2000000003 raw_output_ﬁle<br>
-2ll F_FLAG<br>
MDVRES<br>
-2loglikelihood,-2llikelihood F_FLAG<br>
MDVRES<br>
48 $DES<br>
67000 $INPUT<br>
nmfe utility program<br>
68 Enterhepatic circulation examples<br>
MINIMUM VALUE OF OBJ. FUNCTION<br>
80 $INPUT<br>
a<br>
TRANS5<br>
abbreviated_code,abbreviated $ABBREVIATED<br>
Abbreviated code<br>
65<br>
<hr>
<A name=71></a>MISCELLANEOUS TOPICS Help Guide<br>
Control3 example<br>DOWHILE block<br>Indicator variables<br>Partial Derivative Indicators<br>Verbatim code<br>Write print<br>
abbreviated_function Abbreviated code<br>
Abbreviated Function<br>Abbreviated Function Examples<br>Probability Density Functions<br>Transit Compartment Examples<br>User-deﬁned Reserved Function Example<br>
abscissa $SCATTERPLOT<br>
absolute XML_COMPARE<br>
absorption_lag Bind example<br>
Dose event record<br>$PK<br>PK<br>PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>SS dose event record<br>
additional $PK<br>
PK<br>
additional_dose Absorption lag parameter<br>
ADDL data item<br>$BIND<br>$PK<br>PK<br>
additional_output_ﬁle additional_output_ﬁles<br>
nmfe utility program<br>Order_option<br>raw_output_ﬁle<br>
additional_pk_parameter $PK<br>
PK<br>
additive Control3 example<br>
Control4 example<br>Random models<br>
advan15 CALLFL<br>
advan3 PK_PD_sequential_1 example<br>
PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>
advan9 CALLFL<br>
AGH<br>
additional_output_ﬁles<br>
algebraic_expression,algebraic ADVAN9_15<br>
$AES<br>AES<br>
amount AMT data item<br>
66<br>
<hr>
<A name=72></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
Dose event record<br>ERROR<br>PK<br>SS dose event record<br>State Vector: A<br>State Vector Time: TSTATE<br>
ANEAL Aneal<br>
$ANNEAL<br>CONSTRAINT<br>
aneal Bayes Example 9<br>
anneal,annealing Aneal<br>
$ANNEAL<br>CONSTRAINT<br>$ESTIMATION,$ESTM<br>
ANNL NONMEM control stream<br>
area_under_the_curve<br>
Moving Area Under the Curve Example<br>
argument_vector_name $ABBREVIATED<br>
array $ABBREVIATED<br>
Abbreviated code<br>Transit Compartment Examples<br>
array_size nmfe utility program<br>
$SIZES<br>
ascii $TABLE<br>
atol NONMEM error messages<br>
auc Moving Area Under the Curve Example<br>
aucdelay Moving Area Under the Curve Example<br>
auto-correlation,autocorrelation Correlation Across L2 Records<br>
av erage,raw<br>
Data_Average block<br>Data_average example<br>ICALL<br>MIX CONTR: TEMPLT<br>Mixture model: MIXPT<br>$OMIT<br>RAW_ data item<br>
axis $SCATTERPLOT<br>
b<br>
TRANS5<br>
band $OMEGA<br>
$SIGMA<br>
band_symmetric $OMEGA<br>
$SIGMA<br>
baseline Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
Exogenous supplementation example<br>
BASE_STEP TOL<br>
basic_pk_parameter $PK<br>
PK<br>
bayes9.exa Aneal<br>
67<br>
<hr>
<A name=73></a>MISCELLANEOUS TOPICS Help Guide<br>
BAYES_EXTRA_REQUEST,BAYES_EXTRA Bayes Example 8<br>
variables in modules<br>
bayesian Bayes Example 1<br>
Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>
BDLM NONMEM control stream<br>
beolaunch parallel computing<br>
BERNOULLI Probability Density Functions<br>
BERNOULLILOGIT Probability Density Functions<br>
BEST NONMEM control stream<br>
BETA<br>
Probability Density Functions<br>
BETABINOMIAL Probability Density Functions<br>
BFIL NONMEM control stream<br>
BGRD NONMEM control stream<br>
bias Superproblem_1 example<br>
BINOMIAL Probability Density Functions<br>
BINOMIALLOGIT Probability Density Functions<br>
bioavailability,bio-availability Bind example<br>
Bioavailability Behavior<br>Bioavailability fraction parameter<br>$PK<br>PK<br>TDM example<br>
bivariate $ABBREVIATED<br>
BIVARIATE FUNCTION<br>Correlation Across L2 Records<br>
block_of_abbreviated_code Abbreviated code<br>
Compartment Initialization Block<br>Copying block<br>Data_Average block<br>Expectation block<br>Initialization-Finalization block<br>Simulation block<br>
block_set_record NONMEM control stream<br>
BLST NONMEM control stream<br>
68<br>
<hr>
<A name=74></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
BMUM NONMEM control stream<br>
bolus_dose Dose ev ent record<br>
SS dose event record<br>
bounds,boundary,boundaries INFERENTIAL STATISTICS<br>
INITIAL ESTIMATE (INITIAL EST)<br>Interoccasion_variability example<br>MONITORING OF SEARCH<br>$THETA<br>
BQL NPD,NPDE,NPDE_MODE,DV_LOQ<br>
YLO example<br>
calendar_date DATE data item<br>
calling_protocol_phrase $AESINITIAL<br>
CALL data item<br>CALLFL<br>Calling protocol phrase<br>$ERROR<br>$PK<br>
case Abbreviated code<br>
$INPUT<br>nmfe utility program<br>variables in modules<br>Verbatim code<br>
categorical Bayes Example 10<br>
Bayes Example 10l<br>Data_average example<br>
CATEGORICAL Probability Density Functions<br>
CATEGORICALLOGIT Probability Density Functions<br>
category $LEVEL<br>
ccontr CELS<br>
NONMEM error messages<br>
CCONTR:_F,G,H CCONTR<br>
CCONTR: F,G,H<br>
CCONTR:_Y,DAT A,N1,N2,DIM CCONTR<br>
CCONTR:_Y_DAT A_N1_N2_DIM CCONTR: Y,DATA,N1,N2,DIM<br>
ccv Multiple_dose example<br>
Phenobarb example<br>Random models<br>
cdf Probability Density Functions<br>
CDLM NONMEM control stream<br>
cels CCONTR<br>
NONMEM error messages<br>
central_to_peripheral_rate ADVAN11<br>
ADVAN12<br>ADVAN3<br>ADVAN4<br>
CFIL NONMEM control stream<br>
69<br>
<hr>
<A name=75></a>MISCELLANEOUS TOPICS Help Guide<br>
characters $INPUT<br>
checkmu MU_Model<br>
CHFL NONMEM control stream<br>
chi-square MINIMUM VALUE OF OBJ. FUNCTION<br>
CHISQUARE Probability Density Functions<br>
CHN NONMEM control stream<br>
cholesky<br>
CHOL<br>
cid $LEVEL<br>
circad.csv Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
circadian Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
Classical $ESTIMATION record options<br>
clock_time TIME data item<br>
close FILES<br>
CLT<br>
additional_output_ﬁles<br>$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
cnpe COMACT,COMSAV<br>
Displayed PRED-Deﬁned Items<br>$NONPARAMETRIC<br>Nonparametric Density: DEN_,CDEN_<br>Nonparametric example<br>
cntid additional_output_ﬁles<br>
CNV additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
COI additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
colon II data item<br>
TIME data item<br>
combined_additive_and_ccv Exogenous supplementation example<br>
Random models<br>
comma $DAT A<br>
$COMMANDS parallel computing<br>
comment_record $DAT A<br>
commitqq FLU<br>
common NONMEM modules<br>
commons Finalization example ($PRED and $INFN)<br>
compartment CMT PCMT data item<br>
Default compartment<br>MODEL<br>
compartment_amount $AES<br>
$AESINITIAL<br>$DES<br>$ERROR<br>
70<br>
<hr>
<A name=76></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
ERROR<br>Initial Steady State example<br>PK<br>State Vector: A<br>State Vector Time: TSTATE<br>
compartment_initialization ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Compartment Initialization: A_0<br>Compartment Initialization: A_0FLG<br>Compartment Initialization Block<br>Initial Steady State example<br>Initial Steady State: I_SS,ISSMOD<br>MODEL<br>$PK<br>PK<br>
compartment_number $PK<br>
compartment_scale $PK<br>
PK<br>Scaling parameter<br>
computername.exe parallel computing<br>
concomitant $BIND<br>
$INPUT<br>$PK<br>
conditional_contribution CCONTR<br>
CELS<br>
conditional_estimate HESSIAN<br>
conditional_estimation_method $ESTIMATION,$ESTM<br>
GETETA<br>
conditional_statement Abbreviated code<br>
Compartment Initialization Block<br>Data_Average block<br>Expectation block<br>Indicator variables<br>Initialization-Finalization block<br>Simulation block<br>
conditional_value Displayed PRED-Deﬁned Items<br>
conﬁdence_interval INFERENTIAL STATISTICS<br>
constant $ABBREVIATED<br>
constant_coefﬁcient_of_variation Multiple_dose example<br>
Phenobarb example<br>Random models<br>
constraint,constrained INITIAL ESTIMATE (INITIAL EST)<br>
Interoccasion_variability example<br>MONITORING OF SEARCH<br>$OMEGA<br>$SIGMA<br>$THETA<br>
71<br>
<hr>
<A name=77></a>MISCELLANEOUS TOPICS Help Guide<br>
constraint,constraint Aneal<br>
$ANNEAL<br>CONSTRAINT<br>
continuation Abbreviated code<br>
CONT data item<br>$INPUT<br>nmfe utility program<br>
contr CCONTR<br>
ELS<br>$MIX<br>MIX<br>
CONTR:_F_G_H CONTR: F,G,H<br>
contribution CCONTR<br>
CELS<br>CONTR<br>CRIT<br>HESSIAN<br>MULT<br>SPTWO<br>
CONTR:_III_DIM CONTR: III,DIM<br>
$CONTROL parallel computing<br>
control5 Finedata example<br>
Infn_interpolation example 1<br>Infn_interpolation example 2<br>
control_stream NONMEM control stream<br>
control_stream.log parallel computing<br>
CONTR:_Y_DAT A_NOBS CONTR: Y DAT A NOBS<br>
copying_block Copying block<br>
copying_pass COMACT,COMSAV<br>
COM COMACT COMSAV COMRES<br>
COR additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
core parallel computing<br>
correlation BIVARIATE FUNCTION<br>
CORRELATION MATRIX OF ESTIMATE<br>$COVARIANCE,$COVR<br>INFERENTIAL STATISTICS<br>
correlation_matrix FINAL PARAMETER ESTIMATE<br>
correlation_matrix_of_estimate CORRELATION MATRIX OF ESTIMATE<br>
Order_option<br>SUPP<br>
cosine,sine Abbreviated code<br>
COV<br>
additional_output_ﬁles<br>$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
72<br>
<hr>
<A name=78></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
covariance additional_output_ﬁles<br>
CORRELATION MATRIX OF ESTIMATE<br>COVARIANCE MATRIX OF ESTIMATE<br>$OMEGA<br>Order_option<br>raw_output_ﬁle<br>Recursive PRED Indicator<br>$SIGMA<br>Variance-covariance<br>
covariance_matrix FINAL PARAMETER ESTIMATE<br>
covariance_matrix_of_estimate COVARIANCE MATRIX OF ESTIMATE<br>
Order_option<br>SUPP<br>
covariance_record NONMEM control stream<br>
covariance_step parallel computing<br>
NONMEM steps<br>
covariate Interoccasion_variability example<br>
Simulation_2 example<br>Simulation_3 example<br>
COVR NONMEM control stream<br>
COV_STEP TOL<br>
COVT NONMEM control stream<br>
cp Control5 example<br>
Indicator variables<br>$INPUT<br>PK_PD_simultaneous_1 example<br>
CPAR NONMEM control stream<br>
cpe Displayed PRED-Deﬁned Items<br>
$ESTIMATION,$ESTM<br>$NONPARAMETRIC<br>
CPU additional_output_ﬁles<br>
NONMEM output ﬁles<br>
cpu parallel computing<br>
#CPUT NONMEM output ﬁles<br>
crit CELS<br>
cross-product_gradient $COVARIANCE,$COVR<br>
ctrl SIGNAL<br>
ctrl,ctrl-j,ctrl-k,ctlr-e parallel computing<br>
ctrl,ctrl-j,ctrl-k,ctlr-e,ctrl-t nmfe utility program<br>
cumulative Probability Density Functions<br>
cumulative_density Nonparametric Density: DEN_,CDEN_<br>
cumulative_distribution NPD,NPDE,NPDE_MODE,DV_LOQ<br>
PHI<br>
dadt Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
DATA NONMEM ﬁle control stream<br>
73<br>
<hr>
<A name=79></a>MISCELLANEOUS TOPICS Help Guide<br>
NONMEM control stream<br>
data DAT A_ITEMS<br>
DATA_RECORDS<br>DATA_SET<br>Ignore_accept example<br>
data˜average Data_Average block<br>
Data_average example<br>$ERROR<br>ICALL<br>MIX CONTR: TEMPLT<br>Mixture model: MIXPT<br>$OMIT<br>$PK<br>$PRED<br>RAW_ data item<br>
data_item $BIND<br>
DATA_ITEMS<br>DATA_RECORDS<br>DATA_SET<br>$INPUT<br>$LEVEL<br>OBSERVA TION RECORDS<br>
data_record $INPUT<br>
NONMEM control stream<br>NONMEM ﬁle control stream<br>
data_recs,data_records DAT A_ITEMS<br>
DATA_RECORDS<br>DATA_SET<br>OBSERVA TION RECORDS<br>
data_set DAT A_SET<br>
days $DAT A<br>
day-time $DAT A<br>
declare DOWHILE block<br>
declare,declared $ABBREVIATED<br>
Abbreviated code<br>Infn_interpolation example 2<br>Transit Compartment Examples<br>
default_compartment Default compartment<br>
default_compartment_for_doses CMT PCMT data item<br>
Default compartment<br>
default_compartment_for_observations CMT PCMT data item<br>
Default compartment<br>
defaults.pnm parallel computing<br>
degrees˜of˜freedom $OMEGAP,$OMEGAPD<br>
delaydata Moving Area Under the Curve Example<br>
delimiter $DAT A<br>
TABLE_COMPARE<br>
74<br>
<hr>
<A name=80></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
TABLE_QUANT<br>TABLE_RESAMPLE<br>XML_COMPARE<br>
delimiter_record NONMEM ﬁle control stream<br>
density Nonparametric Density: DEN_,CDEN_<br>
Probability Density Functions<br>
densitycdf Probability Density Functions<br>
density_cdf Probability Density Functions<br>
densityrng Probability Density Functions<br>
density_rng Probability Density Functions<br>
dependent_variable,dv_data_item DV and MDV data items<br>
deriv2 $ESTIMATION,$ESTM<br>
derivative ERROR<br>
PRED<br>
des Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
dextromethorphan Plasma urine example<br>
DFLT<br>
NONMEM control stream<br>
DIAG<br>
NONMEM control stream<br>
diag,odiag $OMEGA<br>
$SIGMA<br>
dichotomous_response Bayes Example 10<br>
Bayes Example 10l<br>Logistic regression example<br>
differential_equation,differential ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Control7 example<br>$DES<br>DES<br>INTERPOLATION IN $DES<br>Michaelis_Menten example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_4 example<br>SS6 SS9<br>
differential_equations SDE<br>
Stochastic Differential Equation examples<br>
digits $DAT A<br>
dimension $ABBREVIATED<br>
direction MONITORING OF SEARCH<br>
$DIRECTORIES parallel computing<br>
DIRICHLET Probability Density Functions<br>
discontinuous Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
discontinuous,discontinuity Abbreviated code<br>
$DES<br>Enterhepatic circulation examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>MINIMUM VALUE OF OBJ. FUNCTION<br>
75<br>
<hr>
<A name=81></a>MISCELLANEOUS TOPICS Help Guide<br>
Model Time examples<br>MTIME MNEXT MPAST MNOW MTDIFF<br>
dispersion˜factor $OMEGAP,$OMEGAPD<br>
displayed_values $DES<br>
Displayed PRED-Deﬁned Items<br>$SCATTERPLOT<br>Simulation_1 example<br>Simulation_2 example<br>$TABLE<br>
distributed_computing $COVARIANCE,$COVR<br>
$ESTIMATION,$ESTM<br>FOCE_PARALLEL example<br>nmfe utility program<br>parallel computing<br>
distribution NPD,NPDE,NPDE_MODE,DV_LOQ<br>
PHI<br>Probability Density Functions<br>
dll parallel computing<br>
dose AMT data item<br>
Dose event record<br>Multiple_dose example<br>
dose_amount AMT data item<br>
Dose event record<br>SS dose event record<br>
dose_compartment CMT PCMT data item<br>
Default compartment<br>Dose event record<br>Duration parameter<br>Rate parameter<br>
dose_event Dose ev ent record<br>
dose_event,dose EVID data item<br>
dose_rate Duration parameter<br>
RATE data item<br>Rate parameter<br>
DOUBLEEXPONENTIAL Probability Density Functions<br>
double-precision SUBROUTINE<br>
$SUBROUTINES<br>
drive_letter parallel computing<br>
dropped_record $DAT A<br>
Ignore_accept example<br>
drug_effect,effect $ERROR<br>
Indicator variables<br>PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>
76<br>
<hr>
<A name=82></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
PK_PD_simultaneous_4 example<br>
DTD additional_output_ﬁles<br>
TABLE_TO_XML<br>
dtd TABLE_TO_XML<br>
dummy CCONTR<br>
CONTR<br>CRIT<br>INFN<br>$MIX<br>MIX<br>PRIOR<br>SPTWO<br>Stubs<br>
duplicate_system Moving Area Under the Curve Example<br>
duration_of_infusion Dose ev ent record<br>
Multiple_dose example<br>$PK<br>PK<br>RATE data item<br>
dynamic_allocation nmfe utility program<br>
$SIZES<br>
ebcdic $TABLE<br>
ebvshrink additional_output_ﬁles<br>
SHRINKAGE<br>
ebvshrinksd SHRINKAGE<br>
ebvshrinkvr SHRINKAGE<br>
effect,drug_effect $ERROR<br>
Indicator variables<br>
effects NONMEM model<br>
efﬁcacy<br>
Moving Area Under the Curve Example<br>
EHC,enterohepatic_recycling Enterhepatic circulation examples<br>
Model Time examples<br>
eigenvalues ADVAN5 ADVAN7<br>
$COVARIANCE,$COVR<br>INFERENTIAL STATISTICS<br>
els CONTR<br>
NONMEM error messages<br>SPTWO<br>
emax Enterhepatic circulation examples<br>
Indicator variables<br>PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
empirical_bayes_variance additional_output_ﬁles<br>
77<br>
<hr>
<A name=83></a>MISCELLANEOUS TOPICS Help Guide<br>
end_of_data FINISH<br>
endogenous ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>$DES<br>Exogenous supplementation example<br>Initial Steady State example<br>Initial Steady State: I_SS,ISSMOD<br>SS dose event record<br>
eps-eta_interaction $ESTIMATION,$ESTM<br>
epshrink SHRINKAGE<br>
epsilon ERROR<br>
PRED<br>
epsshrinksd SHRINKAGE<br>
epsshrinkvr SHRINKAGE<br>
equations DES<br>
equilibrium ADVAN9_15<br>
$AES<br>$AESINITIAL<br>MODEL<br>
error-deﬁned-items Displayed PRED-Deﬁned Items<br>
$ERROR<br>PRED-Deﬁned Variables<br>Simulation_1 example<br>Simulation_2 example<br>Simulation_3 example<br>
error_in_log_y CALLFL<br>
Calling protocol phrase<br>ERROR<br>
error_return_code Estim Covar Error Codes<br>
estimation $ESTIMATION record options<br>
$PRIOR<br>
estimation,estm $ESTIMATION record options<br>
estimation_record additional_output_ﬁles<br>
$CHAIN<br>NONMEM control stream<br>Order_option<br>raw_output_ﬁle<br>
estimation_record_options $ESTIMATION,$ESTM<br>
estimation_step $ESTIMATION,$ESTM<br>
parallel computing<br>NONMEM steps<br>
Estim_Covar_Error_Codes Estim Covar Error Codes<br>
ESTM NONMEM control stream<br>
EST_STEP TOL<br>
ETA<br>
NONMEM control stream<br>
etabar ETABAR<br>
78<br>
<hr>
<A name=84></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
eta-derivative Partial Derivative Indicators<br>
ETAS Model Speciﬁcation ﬁle<br>
_ETAS Model Speciﬁcation ﬁle<br>
etas Nonparametric Density: DEN_,CDEN_<br>
etashrink SHRINKAGE<br>
etashrinksd SHRINKAGE<br>
etashrinkvr SHRINKAGE<br>
etas_shrinkage $ESTIMATION,$ESTM<br>
ETS $ESTIMATION,$ESTM<br>
evaluations $ESTIMATION,$ESTM<br>
MONITORING OF SEARCH<br>
ev ent_identiﬁcation_data_item,evid EVID data item<br>
ev ent_record $BIND<br>
CONT data item<br>Dose Time Non-Event: DOSTIM<br>$LEVEL<br>
ev ent_time CALLFL<br>
Calling protocol phrase<br>Dose event record<br>Dose Time Non-Event: DOSTIM<br>SS dose event record<br>TIME data item<br>
example10.ctl Bayes Example 10<br>
example10l.ctl Bayes Example 10l<br>
example1B.ctl Bayes Example 1B<br>
example1.ctl Bayes Example 1<br>
example3.ctl Bayes Example 3<br>
example4.ctl Bayes Example 4<br>
example5.ctl Bayes Example 5<br>
example6.ctl Bayes Example 6<br>
example6sb.ctl Bayes Example 6sb<br>
example6s.ctl Bayes Example 6s<br>
example7r.ctl Bayes Example 7r<br>
example8.ctl Bayes Example 8<br>
example9.ctl Aneal<br>
Bayes Example 9<br>
$EXCLUDE parallel computing<br>
exclusion $TABLE<br>
executable_ﬁle $SUBROUTINES<br>
exit_code,error_return_code Abbreviated code<br>
$ESTIMATION,$ESTM<br>Interoccasion_variability example<br>PRED Exit Code<br>$THETA<br>
exit_status,status,regular nmfe utility program<br>
79<br>
<hr>
<A name=85></a>MISCELLANEOUS TOPICS Help Guide<br>
exogenous ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>$DES<br>Exogenous supplementation example<br>Initial Steady State example<br>Initial Steady State: I_SS,ISSMOD<br>SS dose event record<br>
expectation $ERROR<br>
Expectation block<br>Expectation example<br>ICALL<br>MRG_ data item<br>$PK<br>$PRED<br>
explicit ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Copying block<br>$PK<br>
EXPMODNORMAL Probability Density Functions<br>
exponential Abbreviated code<br>
EXPONENTIAL Probability Density Functions<br>
exponential Random models<br>
exportfs parallel computing<br>
EXT additional_output_ﬁles<br>
raw_output_ﬁle<br>
ext<br>
raw_output_ﬁle<br>
extra Model Speciﬁcation ﬁle<br>
extra_evid EVID data item<br>
extra_msf_ﬁle&quot; Model Speciﬁcation ﬁle<br>
factor $DAT A<br>
factorial GAMLN<br>
family $SCATTERPLOT<br>
FCON NM-TRAN output ﬁles<br>
fcon NONMEM control stream<br>
FDAT A<br>
NM-TRAN output ﬁles<br>
FFIL NONMEM control stream<br>
fﬂag F_FLAG<br>
MDVRES<br>
FGH additional_output_ﬁles<br>
ﬁeld_delimiter $DAT A<br>
FILE NONMEM control stream<br>
ﬁle FILES<br>
Write print<br>
ﬁle_control_stream,ﬁle_stream NONMEM ﬁle control stream<br>
ﬁlename $CHAIN<br>
80<br>
<hr>
<A name=86></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
Write print<br>
ﬁle_passing_interface parallel computing<br>
ﬁle_passing_interface,ﬁle_transfer,transfer nmfe utility program<br>
ﬁle_record NONMEM control stream<br>
NONMEM ﬁle control stream<br>
ﬁnal FINAL PARAMETER ESTIMATE<br>
ﬁnal_estimate Finalization example ($PRED and $INFN)<br>
INFN<br>Objective Function Value<br>Parameter Values: Initial and Final<br>Standard Errors<br>
ﬁnalization Finalization example ($PRED and $INFN)<br>
INFN<br>INFN-deﬁned Variables<br>Initialization-Finalization block<br>NWPRI examples<br>PASS<br>$PRED<br>PRED-Deﬁned Variables<br>PRED,RES,WRES<br>
ﬁnalization_step NONMEM steps<br>
ﬁnal_parameter_estimate FINAL PARAMETER ESTIMATE<br>
SUPP<br>$THETAR<br>
FIND NONMEM control stream<br>
ﬁnd_record NONMEM control stream<br>
ﬁnish_record,ﬁnish $DAT A<br>
FINISH<br>
ﬁrst_derivative Partial Derivative Indicators<br>
ﬁrst_order_absorption ADVAN12<br>
ADVAN2<br>ADVAN4<br>
ﬁrst_order_conditional_estimation_method $ESTIMATION,$ESTM<br>
ﬁrst_order_method $ESTIMATION,$ESTM<br>
ﬁxed_effects INITIAL ESTIMATE (INITIAL EST)<br>
NONMEM model<br>
ﬁzesr $ABBREVIATED<br>
ﬂexible_infusion_rate Model Time examples<br>
FLIB NM-TRAN output ﬁles<br>
SUBROUTINE<br>
ﬂush FLU<br>
fnleta NONMEM steps<br>
fnlmod $ESTIMATION,$ESTM<br>
NONMEM steps<br>
foce FOCE_PARALLEL example<br>
foce_parallel FOCE_PARALLEL example<br>
81<br>
<hr>
<A name=87></a>MISCELLANEOUS TOPICS Help Guide<br>
parallel computing<br>
fo,foce $ESTIMATION,$ESTM<br>
FOCE_PARALLEL example<br>
FORIG $ABBREVIATED<br>
NM-TRAN output ﬁles<br>
FORM NONMEM control stream<br>
format Write print<br>
format_record NONMEM control stream<br>
format_speciﬁcation,format $DAT A<br>
$ETAS,$PHIS<br>FINISH<br>Multiple_dose example<br>
FORTRAN Abbreviated code<br>
Verbatim code<br>Write print<br>
fpi nmfe utility program<br>
parallel computing<br>
fpilinux8.pnm parallel computing<br>
fpilinux_onecomputer.pnm parallel computing<br>
fpilinux_twocomputers.pnm parallel computing<br>
fpiwini8.pnm parallel computing<br>
fpiwin_onecomputer.pnm parallel computing<br>
fpiwin_twocomputers.pnm parallel computing<br>
fraction Output fraction parameter<br>
$PK<br>PK<br>
FRECHET Probability Density Functions<br>
FREPL $ABBREVIATED<br>
NM-TRAN output ﬁles<br>
FREPORT<br>
ADVAN (general)<br>NM-TRAN output ﬁles<br>SUBROUTINE<br>$SUBROUTINES<br>
FRML NONMEM control stream<br>
FRMR NONMEM control stream<br>
fsd $INPUT<br>
nmfe utility program<br>
FSIZES NM-TRAN output ﬁles<br>
fsizes $ABBREVIATED<br>
FSIZES nmfe utility program<br>
FSIZESR nmfe utility program<br>
FSTREAM NM-TRAN output ﬁles<br>
FSUBS NM-TRAN output ﬁles<br>
SUBROUTINE<br>$SUBROUTINES<br>
82<br>
<hr>
<A name=88></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
fsubs $ABBREVIATED<br>
Partial Derivative Indicators<br>
fsubs,fsubs_mu nmfe utility program<br>
full $OMEGA<br>
$SIGMA<br>
function $ABBREVIATED<br>
Abbreviated code<br>Abbreviated Function<br>Abbreviated Function Examples<br>Probability Density Functions<br>Transit Compartment Examples<br>User-deﬁned Reserved Function Example<br>
function_evaluations $ESTIMATION,$ESTM<br>
MONITORING OF SEARCH<br>
functions Stubs<br>
funcx9.ctl BIVARIATE FUNCTION<br>
FWORK NM-TRAN output ﬁles<br>
gamma GAMLN<br>
GAMMA Probability Density Functions<br>
general parallel computing<br>
$GENERAL parallel computing<br>
general_linear_kinetics_model ADVAN5 ADVAN7<br>
general_nonlinear_kinetics_model ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>
generated_subroutine SUBROUTINE<br>
gibbs $ESTIMATION,$ESTM<br>
MU_Model<br>
global $ABBREVIATED<br>
Abbreviated code<br>$AES<br>$AESINITIAL<br>$DES<br>$ERROR<br>Initialization-Finalization block<br>$PK<br>$PRED<br>
glucose Initial Steady State example<br>
Goal_Function raw_output_ﬁle<br>
goodness_of_ﬁt CORRELATION MATRIX OF ESTIMATE<br>
goodness˜of˜ﬁt Data_average example<br>
Expectation example<br>
gradient additional_output_ﬁles<br>
MONITORING OF SEARCH<br>
GRD additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
83<br>
<hr>
<A name=89></a>MISCELLANEOUS TOPICS Help Guide<br>
GRID NONMEM control stream<br>
guide USERS GUIDE<br>
GUMBEL Probability Density Functions<br>
header $TABLE<br>
hessian $COVARIANCE,$COVR<br>
HESSIAN<br>
hill_parameter Enterhepatic circulation examples<br>
Initial Steady State example<br>
hillss.ctl Enterhepatic circulation examples<br>
hours $DAT A<br>
hybrid_estimation_method $ESTIMATION,$ESTM<br>
hydrochlorothiazide Interoccasion_variability example<br>
hyperbolic_model PK_PD_simultaneous_4 example<br>
HYPERGEOMETRIC Probability Density Functions<br>
hypothesis_test INFERENTIAL STATISTICS<br>
MINIMUM VALUE OF OBJ. FUNCTION<br>
icall ICALL<br>
NONMEM steps<br>
icu Indicator variables<br>
identiﬁcation,id_data_item ID .ID. and L1 data items<br>
idr Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
$IDRANGES parallel computing<br>
idr_circexa.ctl Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
ii $DAT A<br>
im_dose,iv_dose Multiple_dose example<br>
IMP additional_output_ﬁles<br>
implicit ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Copying block<br>$PK<br>
importance,importance_sampling Bayes Example 1<br>
Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>$ESTIMATION,$ESTM<br>MU_Model<br>
$INCLUDE parallel computing<br>
index<br>
parallel computing<br>
index_record NONMEM control stream<br>
indicator_variables Indicator variables<br>
PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
indirect Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
84<br>
<hr>
<A name=90></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
indirect_dynamics PK_PD_simultaneous_4 example<br>
individual_contribution Objective Function Value Individual<br>
Objective Function Value Individual example<br>
individual_data Control3 example<br>
RECORDS=ID Example 2<br>
individual_prediction Displayed PRED-Deﬁned Items<br>
individual_record CCONTR: Y,DATA,N1,N2,DIM<br>
CONTR: F,G,H<br>CONTR: III,DIM<br>CONTR: Y DAT A NOBS<br>MIX: DAT A<br>
individual_residual Displayed PRED-Deﬁned Items<br>
Parameters OMEGA SIGMA: Current<br>
individuals,individual_record ID .ID. and L1 data items<br>
INDIVIDUALS<br>SIMETA<br>Simulation_2 example<br>
individual-speciﬁc,individual-eta $ESTIMATION,$ESTM<br>
individual_weighted-residual Displayed PRED-Deﬁned Items<br>
Parameters OMEGA SIGMA: Current<br>
INDX NONMEM control stream<br>
INE_STEP TOL<br>
inferential_statistics INFERENTIAL STATISTICS<br>
infn-deﬁned-items INFN-deﬁned Variables<br>
informative˜form˜of˜$OMEGA $OMEGAP,$OMEGAPD<br>
informative˜record˜name $OMEGAP,$OMEGAPD<br>
infusion_dose Dose ev ent record<br>
Duration parameter<br>Multiple_dose example<br>RATE data item<br>Rate parameter<br>SS dose event record<br>
infusion_rate Dose ev ent record<br>
Duration parameter<br>Exogenous supplementation example<br>$PK<br>PK<br>RATE data item<br>Rate parameter<br>SS dose event record<br>
initial $AESINITIAL<br>
initial_condition ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Initial Steady State example<br>Initial Steady State: I_SS,ISSMOD<br>MODEL<br>PK<br>
85<br>
<hr>
<A name=91></a>MISCELLANEOUS TOPICS Help Guide<br>
PK_PD_simultaneous_4 example<br>SS dose event record<br>
initial_estimate INFN<br>
Parameter Values: Initial and Final<br>INITIAL ESTIMATE (INITIAL EST)<br>
initial_estimate,initial_parameter_estimate Variance-covariance<br>
initial_estimate_step NONMEM steps<br>
initial,initial_estimate,initial_parameter_estimate INITIAL ESTIMATE (INITIAL EST)<br>
MONITORING OF SEARCH<br>$OMEGA<br>$SIGMA<br>$THETA<br>$THETAI<br>
initialization ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Compartment Initialization: A_0<br>Compartment Initialization: A_0FLG<br>Compartment Initialization Block<br>INFN<br>INFN-deﬁned Variables<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>Initialization-Finalization block<br>Initial Steady State example<br>Initial Steady State: I_SS,ISSMOD<br>MODEL<br>PASS<br>$PK<br>PK<br>$PRED<br>PRED-Deﬁned Variables<br>
initial_steady_state MODEL<br>
PK<br>PREDPP modules<br>
initial_value Displayed PRED-Deﬁned Items<br>
initiating_dose_record Bind example<br>
TDM example<br>
initl NONMEM steps<br>
input_model_speciﬁcation_record NONMEM ﬁle control stream<br>
input_vector_name $ABBREVIATED<br>
installation_routine FLU<br>
insulin Initial Steady State example<br>
integer $ABBREVIATED<br>
integer,integer_expression Abbreviated code<br>
INTER $ESTIMATION,$ESTM<br>
MONITORING OF SEARCH<br>raw_output_ﬁle<br>
86<br>
<hr>
<A name=92></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
inter Model Speciﬁcation ﬁle<br>
interdose_interval,interval II data item<br>
inter-individual,interindividual Intra and inter-individual<br>
$LEVEL<br>Random models<br>
intermediate_output MONITORING OF SEARCH<br>
interoccasion_variability Interoccasion_variability example<br>
interpolation INFN<br>
Infn_interpolation example 2<br>
interpolation,interpolate Finedata example<br>
Infn_interpolation example 1<br>Infn_interpolation example 2<br>INTERPOLATION IN $DES<br>
inter-record Abbreviated code<br>
interval Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
intra-individual,intraindividual $ERROR<br>
Intra and inter-individual<br>$LEVEL<br>Random models<br>
intranet,internet parallel computing<br>
intra-record Abbreviated code<br>
INVCHISQUARE Probability Density Functions<br>
inverse $COVARIANCE,$COVR<br>
INFERENTIAL STATISTICS<br>
INVGAMMA Probability Density Functions<br>
iov<br>
Interoccasion_variability example<br>
IP_address parallel computing<br>
ipred,ires,iwres Displayed PRED-Deﬁned Items<br>
Parameters OMEGA SIGMA: Current<br>Phenobarb example<br>
IPROB raw_output_ﬁle<br>
iprob TOL<br>
IREP raw_output_ﬁle<br>
istate NONMEM error messages<br>
ITEM NONMEM control stream<br>
item $BIND<br>
DATA_ITEMS<br>DATA_RECORDS<br>DATA_SET<br>$INPUT<br>$LEVEL<br>
item_record NONMEM control stream<br>
iteration additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>raw_output_ﬁle<br>
87<br>
<hr>
<A name=93></a>MISCELLANEOUS TOPICS Help Guide<br>
MONITORING OF SEARCH<br>
iteration_number Aneal<br>
iter_no Aneal<br>
iter_report Bayes Example 8<br>
variables in modules<br>
ITER_REPORT,BAYES_EXTRA_REQUEST,BAYES_EXTRA Abbreviated code<br>
kernel $ESTIMATION,$ESTM<br>
l1_data_item,l1_record CONTR<br>
ID .ID. and L1 data items<br>INDIVIDUALS<br>SIMETA<br>SPTWO<br>
l2_data_item,l2_record CCONTR<br>
L2 data item<br>SIMEPS<br>
label Abbreviated code<br>
DATA_ITEMS<br>Displayed PRED-Deﬁned Items<br>$INPUT<br>
label_record NONMEM control stream<br>
label_substitution,substitution $ABBREVIATED<br>
LABL NONMEM control stream<br>
lag,lag_time,lagged_dose $BIND<br>
Bind example<br>Dose event record<br>$PK<br>PK<br>PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>SS dose event record<br>
launch parallel computing<br>
LBW1 NONMEM control stream<br>
LD_LIBRARY_PATH<br>
parallel computing<br>
LEPS NONMEM control stream<br>
LETA<br>
NONMEM control stream<br>
level1,level_one CONTR<br>
ID .ID. and L1 data items<br>SIMETA<br>SPTWO<br>
level2,level_two<br>
CCONTR<br>CCONTR: F,G,H<br>CONTR: III,DIM<br>L2 data item<br>SIMEPS<br>
level2,level_two,levell1,level-one CCONTR: Y,DATA,N1,N2,DIM<br>
library_subroutine SUBROUTINE<br>
88<br>
<hr>
<A name=94></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
LICENSE,LICFILE,NONMEM.LIC nmfe utility program<br>
parallel computing<br>
licﬁle parallel computing<br>
likelihood Bayes Example 10<br>
Bayes Example 10l<br>CONTR<br>$ESTIMATION,$ESTM<br>MINIMUM VALUE OF OBJ. FUNCTION<br>SPTWO<br>Stubs<br>
limit_of_quantiﬁcation,quantiﬁcation NPD,NPDE,NPDE_MODE,DV_LOQ<br>
YLO example<br>
linear_kinetics_model ADVAN5 ADVAN7<br>
link.lnk nmfe utility program<br>
linux parallel computing<br>
list1,list2 $SCATTERPLOT<br>
list1,list2,list3 $TABLE<br>
literal Verbatim code<br>
loaded $ETAS,$PHIS<br>
load_module $SUBROUTINES<br>
local Abbreviated code<br>
$AESINITIAL<br>Initialization-Finalization block<br>
logarithm Abbreviated code<br>
LOGISTIC Probability Density Functions<br>
logistic_regression,logit Bayes Example 10<br>
Bayes Example 10l<br>Logistic regression example<br>
LOGNORMAL Probability Density Functions<br>
loop DOWHILE block<br>
LOQ NPD,NPDE,NPDE_MODE,DV_LOQ<br>
YLO example<br>
loss PK_PD_simultaneous_4 example<br>
lower_bound_record NONMEM control stream<br>
lower_case Abbreviated code<br>
$INPUT<br>nmfe utility program<br>variables in modules<br>Verbatim code<br>
lower-triangular MONITORING OF SEARCH<br>
low,lower,lower_bound INITIAL ESTIMATE (INITIAL EST)<br>
MONITORING OF SEARCH<br>$THETA<br>
LOWR NONMEM control stream<br>
lsoda NONMEM error messages<br>
89<br>
<hr>
<A name=95></a>MISCELLANEOUS TOPICS Help Guide<br>
LTHT NONMEM control stream<br>
manager parallel computing<br>
marginal Expectation block<br>
Expectation example<br>MRG_ data item<br>
marginal_cumulative_value Nonparametric Density: DEN_,CDEN_<br>
matrix COVARIANCE MATRIX OF ESTIMATE<br>
$OMEGA<br>$SIGMA<br>
maxdrec nmfe utility program<br>
maxevals $NONPARAMETRIC<br>
MAXRECID nmfe utility program<br>
mcmc Bayes Example 1<br>
Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>$ESTIMATION,$ESTM<br>
message_passing_interface nmfe utility program<br>
parallel computing<br>
metabolite Plasma urine example<br>
METH additional_output_ﬁles<br>
#METH additional_output_ﬁles<br>
METH NONMEM output ﬁles<br>
#METH NONMEM output ﬁles<br>
METH raw_output_ﬁle<br>
#METH raw_output_ﬁle<br>
method $NONPARAMETRIC<br>
Metropolis-Hasting $ESTIMATION,$ESTM<br>
MU_Model<br>
michaelis_menten_elimination ADVAN10<br>
Michaelis_Menten example<br>
micro-constant $PK<br>
PK<br>
minimization $ESTIMATION,$ESTM<br>
MONITORING OF SEARCH<br>$THETA<br>
minimum,minimum_value_of_objective_function MINIMUM VALUE OF OBJ. FUNCTION<br>
MONITORING OF SEARCH<br>
minimum_value_of_objective_function SUPP<br>
MISES Probability Density Functions<br>
missing_dependent_variable DV and MDV data items<br>
missing_independent_variable Finedata example<br>
Infn_interpolation example 1<br>Infn_interpolation example 2<br>
90<br>
<hr>
<A name=96></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
MIX_CONTR:_TEMPLT<br>
MIX CONTR: TEMPLT<br>
MIX_CONTR:_THETA<br>
CCONTR<br>MIX CONTR: THETA<br>
MIX:_DAT A<br>
MIX: DAT A<br>
mixing_dimension MIX<br>
MIXNUM_MIXEST_MIXP<br>
mixture_model:_MIXNUM_MIXEST Mixture model: MIXNUM,MIXEST<br>
Mixture_model:_MIXP Mixture model: MIXP<br>
Mixture_model:_MIXPT Mixture model: MIXPT<br>
mixture_model,mixture MIX<br>
MIXNUM_MIXEST_MIXP<br>Mixture_model example<br>Mixture model: MIXNUM,MIXEST<br>PRED_RES_WRES<br>
mixture_model,mixture,mixture_probabilities Mixture model: MIXP<br>
Mixture model: MIXPT<br>
mixture_model,mixture_probabilities $MIX<br>
mode parallel computing<br>
modeled_as_log PK<br>
$THETAI<br>$THETAR<br>TRANS (subroutine)<br>
modeled_duration Dose ev ent record<br>
Duration parameter<br>Multiple_dose example<br>$PK<br>PK<br>RATE data item<br>SS dose event record<br>
modeled_rate Dose ev ent record<br>
Exogenous supplementation example<br>$PK<br>PK<br>RATE data item<br>Rate parameter<br>SS dose event record<br>
model_estimate Mixture model: MIXNUM,MIXEST<br>
Mixture model: MIXP<br>
model_speciﬁcation_ﬁle $NONPARAMETRIC<br>
model_speciﬁcation_ﬁle,msf $ESTIMATION,$ESTM<br>
Model Speciﬁcation ﬁle<br>$MSFI<br>Multiple_dose example<br>Nonparametric example<br>
model_speciﬁcation_record NONMEM ﬁle control stream<br>
model_subroutine $MODEL<br>
MODEL<br>
91<br>
<hr>
<A name=97></a>MISCELLANEOUS TOPICS Help Guide<br>
model_time,model_event_time Calling protocol phrase<br>
Enterhepatic circulation examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>MINIMUM VALUE OF OBJ. FUNCTION<br>Model Event Time: MNOW,MPAST,MNEXT<br>Model Event Time: MTDIFF<br>Model Event Time: MTIME<br>Model Time examples<br>MTIME MNEXT MPAST MNOW MTDIFF<br>$PK<br>
modules NONMEM modules<br>
PREDPP modules<br>variables in modules<br>
monitoring_of_search MONITORING OF SEARCH<br>
SUPP<br>
monte-carlo additional_output_ﬁles<br>
Bayes Example 1<br>Bayes Example 1B<br>
monte_carlo $ESTIMATION,$ESTM<br>
monte-carlo PRED,RES,WRES<br>
$SCATTERPLOT<br>$TABLE<br>
moving_average Moving Area Under the Curve Example<br>
mpd parallel computing<br>
mpdallexit parallel computing<br>
Mpdboot parallel computing<br>
mpi nmfe utility program<br>
parallel computing<br>
mpich2 nmfe utility program<br>
parallel computing<br>
Mpiexec<br>
parallel computing<br>
mpilinux parallel computing<br>
mpilinux8.pnm parallel computing<br>
mpilinux_onecomputer.pnm parallel computing<br>
mpilinux_twocomputers.pnm parallel computing<br>
mpiwin parallel computing<br>
MPI_WING parallel computing<br>
MPI_WINI parallel computing<br>
mpiwini8.pnm parallel computing<br>
mpiwin_onecomputer.pnm parallel computing<br>
mpiwin_twocomputers.pnm parallel computing<br>
msf $NONPARAMETRIC<br>
MSFI NONMEM ﬁle control stream<br>
msf,model_speciﬁcation_ﬁle $ESTIMATION,$ESTM<br>
Model Speciﬁcation ﬁle<br>
92<br>
<hr>
<A name=98></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
$MSFI<br>Nonparametric example<br>
MSFO NONMEM ﬁle control stream<br>
msfo_record,msﬁ_record NONMEM ﬁle control stream<br>
MSFV NONMEM control stream<br>
MSLEEP parallel computing<br>
mtime Abbreviated code<br>
mtimess.ctl Enterhepatic circulation examples<br>
MTOUCH parallel computing<br>
muﬁrstrec $ESTIMATION,$ESTM<br>
multi_mode parallel computing<br>
MULTINOMIAL Probability Density Functions<br>
multiple_core parallel computing<br>
multiple_dose Multiple_dose example<br>
Phenobarb example<br>
multiple-problem Problem Iteration Counters<br>
SUBROUTINE<br>Superproblem_1 example<br>
mu_model Bayes Example 1<br>
Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 2<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 5<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>MU_Model<br>
MUMODEL2 nmfe utility program<br>
mu,mu_model additional_output_ﬁles<br>
Indicator variables<br>nmfe utility program<br>
mu_referencing MU_Model<br>
mu_warning MU_Model<br>
myfuncs User-deﬁned Reserved Function Example<br>
mymin,mymax User-deﬁned Reserved Function Example<br>
$NAMES parallel computing<br>
ncontr CCONTR<br>
CELS<br>CONTR<br>SPTWO<br>
93<br>
<hr>
<A name=99></a>MISCELLANEOUS TOPICS Help Guide<br>
NEGBINOMIAL Probability Density Functions<br>
NEGBINOMIAL2 Probability Density Functions<br>
NEGBINOMIAL2LOG Probability Density Functions<br>
nested DOWHILE block<br>
$LEVEL<br>
netilmicin Multiple_dose example<br>
network parallel computing<br>
network_drive parallel computing<br>
nfs parallel computing<br>
nindr_indr1_indr2 NINDR INDR1 INDR2<br>
nmbayes additional_output_ﬁles<br>
raw_output_ﬁle<br>
nmfe,nmfe.bat additional_output_ﬁles<br>
ADVAN (general)<br>$COVARIANCE,$COVR<br>$ESTIMATION,$ESTM<br>nmfe utility program<br>NONMEM output ﬁles<br>NONMEM program<br>parallel computing<br>raw_output_ﬁle<br>
nmlink7 nmfe utility program<br>
nmprd3 Copying block<br>
nmprd4 Copying block<br>
$ERROR<br>Initialization-Finalization block<br>
NM_STEP TOL<br>
nmtran_library,nm-tran_library SUBROUTINE<br>
nm-tran,nmtran NM-TRAN output ﬁles<br>
NONMEM program<br>
nocheckmu MU_Model<br>
node parallel computing<br>
nodes parallel computing<br>
nonequilibrium ADVAN9_15<br>
$AES<br>$AESINITIAL<br>
nonevent_dose_time Bind example<br>
Dose Time Non-Event: DOSTIM<br>TDM example<br>
nonlinear_kinetics_model ADVAN10<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>ADVAN9_15<br>Michaelis_Menten example<br>
nonmem NONMEM output ﬁles<br>
nonmem_common NONMEM modules<br>
94<br>
<hr>
<A name=100></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
nonmem.commons Finalization example ($PRED and $INFN)<br>
nonmem_control_records NONMEM control stream<br>
nonmem.exe parallel computing<br>
nonmem_model NONMEM model<br>
NONMEM program<br>
nonmem_modules NONMEM modules<br>
variables in modules<br>
nonmem,nonlinear_mixed_effects_model NONMEM model<br>
NONMEM program<br>
NONMEM_problem INFN<br>
PASS<br>
nonmem_reserved Abbreviated code<br>
Additional_Record_Counters<br>DV and MDV data items<br>User-deﬁned Reserved Function Example<br>variables in modules<br>
nonmem_reserved_general Abbreviated code<br>
Additional_Record_Counters<br>DV and MDV data items<br>variables in modules<br>
nonmem_user_guide USERS GUIDE<br>
NONP NONMEM control stream<br>
nonpar NONMEM steps<br>
Nonparametric_density:_DEN__CDEN_ Nonparametric Density: DEN_,CDEN_<br>
nonparametric_record NONMEM control stream<br>
Nonparametric Density: DEN_,CDEN_<br>Nonparametric example<br>
nonparametric_step NONMEM steps<br>
NONP_STEP TOL<br>
non_random_variable Abbreviated code<br>
NORMAL Probability Density Functions<br>
np4f NONMEM steps<br>
nparametr Order_option<br>
MONITORING OF SEARCH<br>
NPD additional_output_ﬁles<br>
NPE additional_output_ﬁles<br>
NPI additional_output_ﬁles<br>
NPL additional_output_ﬁles<br>
null_sss_routine SS option<br>
numder additional_output_ﬁles<br>
obj NONMEM error messages<br>
objective_function CCONTR<br>
CELS<br>CONTR<br>CRIT<br>
95<br>
<hr>
<A name=101></a>MISCELLANEOUS TOPICS Help Guide<br>
ELS<br>$ESTIMATION,$ESTM<br>MULT<br>NCONTR<br>NWPRI<br>OBJ<br>Objective Function Value<br>Objective Function Value Individual<br>Objective Function Value Individual example<br>parallel computing<br>PRIOR<br>SPTWO<br>TNPRI<br>MINIMUM VALUE OF OBJ. FUNCTION<br>MONITORING OF SEARCH<br>
Objective_function_value_individual Objective Function Value Individual<br>
OBJN NONMEM output ﬁles<br>
#OBJN NONMEM output ﬁles<br>
objquick $ESTIMATION,$ESTM<br>
OBJS NONMEM output ﬁles<br>
#OBJS NONMEM output ﬁles<br>
OBJT NONMEM output ﬁles<br>
#OBJT NONMEM output ﬁles<br>
OBJT raw_output_ﬁle<br>
#OBJT raw_output_ﬁle<br>
OBJV NONMEM output ﬁles<br>
#OBJV NONMEM output ﬁles<br>
observation_compartment CMT PCMT data item<br>
Default compartment<br>
observation_event,observation EVID data item<br>
observed_value,observation DV and MDV data items<br>
INDIVIDUALS<br>
obs_recs,observation_record,observations OBSERVA TION RECORDS<br>
occasion Interoccasion_variability example<br>
odd-type_data ERROR<br>
$ESTIMATION,$ESTM<br>Logistic regression example<br>PRED<br>PRED_RES_WRES<br>$SIMULATION<br>
off,on CMT PCMT data item<br>
$MODEL<br>MODEL<br>
OLEV NONMEM control stream<br>
omega $ANNEAL<br>
OMEGANNL $ANNEAL<br>
96<br>
<hr>
<A name=102></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
CONSTRAINT<br>
OMIT NONMEM control stream<br>
omit_record NONMEM control stream<br>
omitted_entry CORRELATION MATRIX OF ESTIMATE<br>
COVARIANCE MATRIX OF ESTIMATE<br>STANDARD ERROR OF ESTIMATE<br>
one_compartment_linear_model ADVAN1<br>
ADVAN2<br>
one_compartment_model ADVAN10<br>
open FILES<br>
ORDEREDLOGISTIC Probability Density Functions<br>
order_option $CHAIN<br>
$ESTIMATION,$ESTM<br>
ordinate $SCATTERPLOT<br>
ORDR NONMEM control stream<br>
other-type_event,other-type EVID data item<br>
output_compartment CMT PCMT data item<br>
$DES<br>$MODEL<br>Plasma urine example<br>
output_ﬁle additional_output_ﬁles<br>
nmfe utility program<br>parallel computing<br>
output_fraction Output fraction parameter<br>
$PK<br>PK<br>
output_model_speciﬁcation_record NONMEM ﬁle control stream<br>
output-type CMT PCMT data item<br>
$MODEL<br>Plasma urine example<br>
overstriking $SCATTERPLOT<br>
pacos $ABBREVIATED<br>
PARA NONMEM output ﬁles<br>
#PARA NONMEM output ﬁles<br>
paraﬁle.pnm nmfe utility program<br>
parallel FOCE_PARALLEL example<br>
parallel_ﬁle nmfe utility program<br>
parallel computing<br>
parallelization $COVARIANCE,$COVR<br>
$ESTIMATION,$ESTM<br>FOCE_PARALLEL example<br>nmfe utility program<br>parallel computing<br>
parameter $PK<br>
PK<br>
97<br>
<hr>
<A name=103></a>MISCELLANEOUS TOPICS Help Guide<br>
TRANS (subroutine)<br>MONITORING OF SEARCH<br>
Parameter_dimensions Parameter Dimensions<br>
parameter_estimate CORRELATION MATRIX OF ESTIMATE<br>
$COVARIANCE,$COVR<br>COVARIANCE MATRIX OF ESTIMATE<br>FINAL PARAMETER ESTIMATE<br>INFERENTIAL STATISTICS<br>INITIAL ESTIMATE (INITIAL EST)<br>MINIMUM VALUE OF OBJ. FUNCTION<br>$THETAI<br>$THETAR<br>
paraprint parallel computing<br>
parent Plasma urine example<br>
PARETO<br>
Probability Density Functions<br>
PARETO2 Probability Density Functions<br>
parse_num parallel computing<br>
parse_type parallel computing<br>
Partial_Derivative_Indicators Partial Derivative Indicators<br>
pasin $ABBREVIATED<br>
PASS_New_L2_record:_NEWL2 PASS New L2 record: NEWL2<br>
pass_through_the_data Finalization example ($PRED and $INFN)<br>
ICALL<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>
patan $ABBREVIATED<br>
PD $ERROR<br>
PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
pdz $ABBREVIATED<br>
peripheral Three_compartment example<br>
peripheral_to_central_rate ADVAN11<br>
ADVAN12<br>ADVAN3<br>ADVAN4<br>
permissions parallel computing<br>
pexp $ABBREVIATED<br>
PFIL NONMEM control stream<br>
pharmacodynamic $ERROR<br>
PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>
98<br>
<hr>
<A name=104></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
phe $ABBREVIATED<br>
pheno,phenobarbital Phenobarb example<br>
PHI additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>$ETAS,$PHIS<br>NONMEM output ﬁles<br>NONMEM control stream<br>
phi additional_output_ﬁles<br>
MU_Model<br>Objective Function Value Individual<br>
PHM additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>$ETAS,$PHIS<br>NONMEM output ﬁles<br>
pk-deﬁned-items Displayed PRED-Deﬁned Items<br>
$PK<br>PRED-Deﬁned Variables<br>Simulation_1 example<br>Simulation_2 example<br>
pk_parameter $PK<br>
PK<br>TRANS (subroutine)<br>
pk_parameter_is_modeled_as_log PK<br>
$THETAI<br>$THETAR<br>TRANS (subroutine)<br>
pkpd PK_PD_sequential_1 example<br>
PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
plasma CMT PCMT data item<br>
Output fraction parameter<br>Plasma urine example<br>Scaling parameter<br>
plog $ABBREVIATED<br>
plog10 $ABBREVIATED<br>
png $ABBREVIATED<br>
pnm parallel computing<br>
pnp $ABBREVIATED<br>
points_of_support $NONPARAMETRIC<br>
POISSON Probability Density Functions<br>
POISSONLOG Probability Density Functions<br>
99<br>
<hr>
<A name=105></a>MISCELLANEOUS TOPICS Help Guide<br>
pooled $OMEGA<br>
population $OMEGA<br>
population_data Control5 example<br>
Control6 example<br>Control7 example<br>ID .ID. and L1 data items<br>INDIVIDUALS<br>$MSFI<br>Population single-Subject Indicator<br>
Population_single-subject_indicator Population single-Subject Indicator<br>
positive,positive_deﬁnite HESSIAN<br>
NONMEM error messages<br>$OMEGA<br>$SIGMA<br>Variance-covariance<br>
post_hoc Displayed PRED-Deﬁned Items<br>
$ESTIMATION,$ESTM<br>
posthoc Finalization example ($PRED and $INFN)<br>
post_hoc $TABLE<br>
power_function Random models<br>
PPAR NONMEM control stream<br>
prazosin Interoccasion_variability example<br>
precision CORRELATION MATRIX OF ESTIMATE<br>
$COVARIANCE,$COVR<br>COVARIANCE MATRIX OF ESTIMATE<br>STANDARD ERROR OF ESTIMATE<br>SUBROUTINE<br>$SUBROUTINES<br>TABLE_COMPARE<br>TABLE_QUANT<br>TABLE_RESAMPLE<br>XML_COMPARE<br>
precision_of_parameter_estimate INFERENTIAL STATISTICS<br>
pred Recursive PRED Indicator<br>
pred-deﬁned-items Displayed PRED-Deﬁned Items<br>
$PRED<br>PRED-Deﬁned Variables<br>Simulation_1 example<br>Simulation_2 example<br>
pred_exit_code,pred_error_return_code Abbreviated code<br>
$ESTIMATION,$ESTM<br>Interoccasion_variability example<br>PRED Exit Code<br>$THETA<br>
prediction CMT PCMT data item<br>
$ESTIMATION,$ESTM<br>$PRED<br>
100<br>
<hr>
<A name=106></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
PRED<br>PRED_RES_WRES<br>PRED,RES,WRES<br>
prediction_compartment CMT PCMT data item<br>
predpp ADVAN (general)<br>
NONMEM program<br>
predpp_modules PREDPP modules<br>
pre-existing Exogenous supplementation example<br>
preparation Bind example<br>
prior Bayes Example 1<br>
Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>Bayes Example 3<br>Bayes Example 4<br>Bayes Example 6<br>Bayes Example 6s<br>Bayes Example 6sb<br>Bayes Example 7r<br>Bayes Example 8<br>Bayes Example 9<br>$SIMULATION<br>
prior_dose Exogenous supplementation example<br>
prior,prior˜information $OMEGAP,$OMEGAPD<br>
PRIOR_Simulation:_Parameters NWPRI<br>
PRIOR<br>TNPRI<br>
privilege parallel computing<br>
PROB NONMEM control stream<br>
probabilities $MIX<br>
probability Probability Density Functions<br>
probability_density Probability Density Functions<br>
problem additional_output_ﬁles<br>
raw_output_ﬁle<br>
problem_delimiter NONMEM ﬁle control stream<br>
Problem_iteration_counters Problem Iteration Counters<br>
problem_record NONMEM control stream<br>
process parallel computing<br>
proportional Multiple_dose example<br>
Phenobarb example<br>Random models<br>
proposal Bayes Example 1<br>
Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>
proposal_density Bayes Example 1<br>
101<br>
<hr>
<A name=107></a>MISCELLANEOUS TOPICS Help Guide<br>
Bayes Example 10<br>Bayes Example 10l<br>Bayes Example 1B<br>
pro-time PK_PD_simultaneous_4 example<br>
protocol $AESINITIAL<br>
CALL data item<br>CALLFL<br>Calling protocol phrase<br>$ERROR<br>$PK<br>
prres NONMEM steps<br>
PRSIZES NM-TRAN output ﬁles<br>
pseudo-assignment $ERROR<br>
$PK<br>
pseudo-normal,pseudo-uniform $SIMULATION<br>
pseudo-statement $ABBREVIATED<br>
$BIND<br>
psexec<br>
parallel computing<br>
psqrt $ABBREVIATED<br>
ptan $ABBREVIATED<br>
p_value,p-value ETABAR<br>
pzr $ABBREVIATED<br>
QNT TABLE_QUANT<br>
TABLE_RESAMPLE<br>
qnt TABLE_QUANT<br>
qnt TABLE_RESAMPLE<br>
quantiﬁcation,limit_of_quantiﬁcation NPD,NPDE,NPDE_MODE,DV_LOQ<br>
YLO example<br>
r<br>
COVARIANCE MATRIX OF ESTIMATE<br>
random Probability Density Functions<br>
random_effects NONMEM model<br>
random-inter-individual-variability Intra and inter-individual<br>
random-intra-individual-variability Intra and inter-individual<br>
random_number_generating Probability Density Functions<br>
random_seed $SIMULATION<br>
random_source RANDOM<br>
SIMEPS<br>SIMETA<br>$SIMULATION<br>
random_source_record NONMEM control stream<br>
random_variable Abbreviated code<br>
rate_constant $PK<br>
PK<br>
rate,r1 Model Time examples<br>
raw-data Data_average example<br>
102<br>
<hr>
<A name=108></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
$OMIT<br>RAW_ data item<br>
raw_output_ﬁle additional_output_ﬁles<br>
nmfe utility program<br>Order_option<br>raw_output_ﬁle<br>
raw,raw˜data˜average Data_Average block<br>
Data_average example<br>ICALL<br>MIX CONTR: TEMPLT<br>Mixture model: MIXPT<br>$OMIT<br>RAW_ data item<br>
RAYLEIGH Probability Density Functions<br>
real_eigenvalues ADVAN5 ADVAN7<br>
record_length $DAT A<br>
recursive Recursive PRED Indicator<br>
recursive,recursion Abbreviated code<br>
$COVARIANCE,$COVR<br>DOWHILE block<br>
redgreen Abbreviated Function Examples<br>
relative XML_COMPARE<br>
repeated_observation_record EVID data item<br>
repeated_value $THETA<br>
repeated_value,repeat $OMEGA<br>
$SIGMA<br>
repeat,repetition Repetition_1 example<br>
Repetition_2 example<br>Repetition Variables<br>RPT_ data item<br>SIMEPS<br>SIMETA<br>
replication Simulation: NREP,IREP<br>
report_ﬁle SUPP<br>
res SPTWO<br>
resample TABLE_RESAMPLE<br>
reserved_label DAT A_ITEMS<br>
$INPUT<br>
reserved_position $ABBREVIATED<br>
reserved_variable Abbreviated code<br>
reset-dose_event,reset-dose EVID data item<br>
reset_event,reset EVID data item<br>
Interoccasion_variability example<br>
reset_hessian HESSIAN<br>
residual Data_average example<br>
Expectation example<br>
103<br>
<hr>
<A name=109></a>MISCELLANEOUS TOPICS Help Guide<br>
Intra and inter-individual<br>PRED_RES_WRES<br>PRED,RES,WRES<br>Random models<br>
return_code Estim Covar Error Codes<br>
reweighting MULT<br>
rewind,rewound DAT A_SET<br>
RMAT<br>
Model Speciﬁcation ﬁle<br>
_RMAT<br>
Model Speciﬁcation ﬁle<br>
r_matrix $COVARIANCE,$COVR<br>
COVARIANCE MATRIX OF ESTIMATE<br>HESSIAN<br>Variance-covariance<br>
RMT additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
rng Probability Density Functions<br>
rocm31 Data_Average block<br>
root additional_output_ﬁles<br>
raw_output_ﬁle<br>
rounding_errors_dominating MONITORING OF SEARCH<br>
rsr $COVARIANCE,$COVR<br>
rtol NONMEM error messages<br>
s<br>
COVARIANCE MATRIX OF ESTIMATE<br>
S1IT raw_output_ﬁle<br>
S1NUM raw_output_ﬁle<br>
save_region $ABBREVIATED<br>
COMACT,COMSAV<br>COM COMACT COMSAV COMRES<br>Displayed PRED-Deﬁned Items<br>PRED-Deﬁned Variables<br>
save_variable Displayed PRED-Deﬁned Items<br>
save_variables Copying block<br>
scale $PK<br>
PK<br>Scaling parameter<br>
SCALEDINVCHISQUARE Probability Density Functions<br>
SCAT<br>
NONMEM control stream<br>
scatterplot_record NONMEM control stream<br>
scatterplot_step NONMEM steps<br>
schema TABLE_TO_XML<br>
sco Abbreviated code<br>
sd, Abbreviated code<br>
sde SDE<br>
Stochastic Differential Equation examples<br>
104<br>
<hr>
<A name=110></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
sde10.ctl Stochastic Differential Equation examples<br>
sde2.ctl Stochastic Differential Equation examples<br>
sde3.ctl Stochastic Differential Equation examples<br>
sde4.ctl Stochastic Differential Equation examples<br>
sde5.ctl Stochastic Differential Equation examples<br>
sde6.ctl Stochastic Differential Equation examples<br>
sde7.ctl Stochastic Differential Equation examples<br>
sde8.ctl Stochastic Differential Equation examples<br>
sde9b.ctl SDE<br>
Stochastic Differential Equation examples<br>
sde9.ctl SDE<br>
Stochastic Differential Equation examples<br>
sde.ctl SDE<br>
Stochastic Differential Equation examples<br>
sde_examples SDE<br>
Stochastic Differential Equation examples<br>
sde.f90 Stochastic Differential Equation examples<br>
sdf $INPUT<br>
search $ESTIMATION,$ESTM<br>
$MSFI<br>
second_derivative $ABBREVIATED<br>
ERROR<br>$ESTIMATION,$ESTM<br>Partial Derivative Indicators<br>PK<br>PRED<br>
seed,seed1,seed2 $SIMULATION<br>
segment $TABLE<br>
selection $ABBREVIATED<br>
sequential_pk_pd PK_PD_sequential_1 example<br>
PK_PD_sequential_2 example<br>
sequential_simultaneous_pk_pd PK_PD_sequential_1 example<br>
PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
SFIL NONMEM control stream<br>
share parallel computing<br>
shift,diagonal_shift $OMEGA<br>
$SIGMA<br>Variance-covariance<br>
SHK additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
105<br>
<hr>
<A name=111></a>MISCELLANEOUS TOPICS Help Guide<br>
SHM additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>ETASXI<br>NONMEM output ﬁles<br>
short-hand $ABBREVIATED<br>
shrinkage additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>ETASXI<br>SHRINKAGE<br>
sid $LEVEL<br>
sig parallel computing<br>
sigmoid_emax Enterhepatic circulation examples<br>
PK_PD_sequential_1 example<br>PK_PD_sequential_2 example<br>PK_PD_simultaneous_1 example<br>PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
signal,sig nmfe utility program<br>
Signiﬁcant_Digits_from_Est._Step Signiﬁcant Digits from Est. Step<br>
signiﬁcant_digits,sig_digits $ESTIMATION,$ESTM<br>
MONITORING OF SEARCH<br>
signiﬁcant_ﬁgures,sig_ﬁgures MONITORING OF SEARCH<br>
SIML NONMEM control stream<br>
siml $SIMULATION<br>
SIML_STEP TOL<br>
simulated Correlation Across L2 Records<br>
simulated_value Displayed PRED-Deﬁned Items<br>
Plasma urine example<br>Simulation_1 example<br>Simulation_2 example<br>Simulation_3 example<br>Simulation: ETA,EPS<br>
simulation Correlation Across L2 Records<br>
ICALL<br>NWPRI examples<br>$PRIOR<br>
simulation_record NONMEM control stream<br>
simulation,simulate $ERROR<br>
Nonparametric example<br>$PK<br>$PRED<br>Simulation block<br>SUPP<br>
simulation_step NONMEM steps<br>
simultaneous_pk_pd PK_PD_simultaneous_1 example<br>
106<br>
<hr>
<A name=112></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
PK_PD_simultaneous_2 example<br>PK_PD_simultaneous_3 example<br>PK_PD_simultaneous_4 example<br>
sine,cosine Abbreviated code<br>
single_node parallel computing<br>
single-precision $SUBROUTINES<br>
single-subject Control3 example<br>
Correlation Across L2 Records<br>ID .ID. and L1 data items<br>INDIVIDUALS<br>Population single-Subject Indicator<br>RECORDS=ID Example 2<br>
single_system Moving Area Under the Curve Example<br>
singular NONMEM error messages<br>
sinusoidal Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
sizes $ABBREVIATED<br>
SIZES nmfe utility program<br>
SKEWNORMAL Probability Density Functions<br>
SMAT<br>
Model Speciﬁcation ﬁle<br>
_SMAT<br>
Model Speciﬁcation ﬁle<br>
s_matrix $COVARIANCE,$COVR<br>
COVARIANCE MATRIX OF ESTIMATE<br>Variance-covariance<br>
smooth_step Enterhepatic circulation examples<br>
smpd.exe parallel computing<br>
SMT additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
sobol $ESTIMATION,$ESTM<br>
$TABLE<br>
SORC NONMEM control stream<br>
sort $TABLE<br>
source RANDOM<br>
SIMEPS<br>SIMETA<br>$SIMULATION<br>
source_record NONMEM control stream<br>
space $DAT A<br>
special_computation $COVARIANCE,$COVR<br>
Recursive PRED Indicator<br>
special_data_item PRED_RES_WRES<br>
sptwo<br>
ELS<br>
square_root Abbreviated code<br>
CHOL<br>
ss Enterhepatic circulation examples<br>
107<br>
<hr>
<A name=113></a>MISCELLANEOUS TOPICS Help Guide<br>
Transit Compartment Examples<br>
SS_dose_event ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Initial Steady State: I_SS,ISSMOD<br>SS dose event record<br>
ssh parallel computing<br>
ss_routine Initial Steady State example<br>
SS6 SS9<br>SS option<br>
standard_error $COVARIANCE,$COVR<br>
INFERENTIAL STATISTICS<br>
standard_error_of_estimate CORRELATION MATRIX OF ESTIMATE<br>
Standard Errors<br>STANDARD ERROR OF ESTIMATE<br>SUPP<br>
Standard_errors Standard Errors<br>
state_time Dose ev ent record<br>
state_vector State Vector: A<br>
State Vector Time: TSTATE<br>
static_allocation,static_array nmfe utility program<br>
$SIZES<br>
statistics,inferential INFERENTIAL STATISTICS<br>
steady-state ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
ADVAN9_15<br>Dose event record<br>Enterhepatic circulation examples<br>Exogenous supplementation example<br>Initial Steady State example<br>Initial Steady State: I_SS,ISSMOD<br>Interoccasion_variability example<br>
steady_state MODEL<br>
PK<br>PREDPP modules<br>
steady-state SS6 SS9<br>
SS data item<br>SS dose event record<br>SS option<br>Transit Compartment Examples<br>
step_circexa.ctl Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
step,step-function Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
stiff<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
stochastic_differential_equations SDE<br>
Stochastic Differential Equation examples<br>
storage nmfe utility program<br>
$SIZES<br>
STRC NONMEM control stream<br>
108<br>
<hr>
<A name=114></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
structure_record NONMEM control stream<br>
stub Abbreviated Function<br>
CCONTR<br>CONTR<br>CRIT<br>INFN<br>$MIX<br>MIX<br>PRIOR<br>SPTWO<br>Stubs<br>
STUDENTT Probability Density Functions<br>
subject parallel computing<br>
subject-speciﬁc Displayed PRED-Deﬁned Items<br>
GETETA<br>INFN<br>PASS<br>TRANS (subroutine)<br>
submodel,subpopulation Mixture model: MIXNUM,MIXEST<br>
Mixture model: MIXP<br>PRED_RES_WRES<br>
subproblem additional_output_ﬁles<br>
Initialization-Finalization block<br>raw_output_ﬁle<br>Simulation block<br>SKIP<br>
subroutine_option Abbreviated Function<br>
Abbreviated Function Examples<br>BIVARIATE FUNCTION<br>SUBROUTINE<br>
subroutines ADVAN (general)<br>
SS6 SS9<br>SS option<br>Stubs<br>
subscript $ABBREVIATED<br>
Write print<br>
subscript,subscripted Abbreviated code<br>
DOWHILE block<br>Infn_interpolation example 2<br>Transit Compartment Examples<br>
sudo parallel computing<br>
super-id $LEVEL<br>
superimpose,superimposition SS data item<br>
SS dose event record<br>
superimposition,superposition Transit Compartment Examples<br>
superproblem additional_output_ﬁles<br>
Initialization-Finalization block<br>
109<br>
<hr>
<A name=115></a>MISCELLANEOUS TOPICS Help Guide<br>
Problem Iteration Counters<br>raw_output_ﬁle<br>SKIP<br>$SUPER<br>Superproblem_1 example<br>Superproblem_2 example<br>
super_problem_record NONMEM control stream<br>
supervisor_of_steady_state SS option<br>
support $NONPARAMETRIC<br>
support_point $NONPARAMETRIC<br>
support,support_utility nmfe utility program<br>
parallel computing<br>
suppress SUPP<br>
SUPR NONMEM control stream<br>
synonym DAT A_ITEMS<br>
$INPUT<br>PRED_RES_WRES<br>$SCATTERPLOT<br>$TABLE<br>
synthesis PK_PD_simultaneous_4 example<br>
t<br>
COVARIANCE MATRIX OF ESTIMATE<br>
t24 Examples Using MTIME to Model Periodic Discontinuities in $DES<br>
tab $DAT A<br>
tab_character $DAT A<br>
TABL NONMEM ﬁle control stream<br>
NONMEM control stream<br>
table additional_output_ﬁles<br>
FINEDAT A<br>NMTEMPLATE<br>PRED,RES,WRES<br>raw_output_ﬁle<br>TABLE_COMPARE<br>TABLE_QUANT<br>TABLE_RESAMPLE<br>XML_COMPARE<br>
table_ﬁle $DAT A<br>
Phenobarb example<br>Simulation_1 example<br>Simulation_2 example<br>$TABLE<br>
table_quant $COVARIANCE,$COVR<br>
table_record NONMEM control stream<br>
NONMEM ﬁle control stream<br>
table_resample $COVARIANCE,$COVR<br>
TABLE_STEP TOL<br>
table_step NONMEM steps<br>
110<br>
<hr>
<A name=116></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
tad,time_after_dose Time After Dose (TAD) Example<br>
tag NONMEM output ﬁles<br>
task_speciﬁcation_record NONMEM control stream<br>
TBLN NONMEM output ﬁles<br>
#TBLN NONMEM output ﬁles<br>
t-distribution MU_Model<br>
tdm TDM example<br>
tdy Moving Area Under the Curve Example<br>
temp_dir nmfe utility program<br>
template Data_Average block<br>
Data_average example<br>MIX CONTR: TEMPLT<br>Mixture model: MIXPT<br>$OMIT<br>$SIMULATION<br>
templt $MIX<br>
MIX<br>
TERE additional_output_ﬁles<br>
#TERE additional_output_ﬁles<br>
TERE NONMEM output ﬁles<br>
#TERE NONMEM output ﬁles<br>
TERM additional_output_ﬁles<br>
#TERM additional_output_ﬁles<br>
TERM NONMEM output ﬁles<br>
#TERM NONMEM output ﬁles<br>
tﬁ,tfd Abbreviated code<br>
THCN NONMEM control stream<br>
theophylline Control3 example<br>
Control4 example<br>Control5 example<br>Control6 example<br>Control7 example<br>Finedata example<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>
theopp Finedata example<br>
Infn_interpolation example 1<br>Infn_interpolation example 2<br>
theta_constraint_record NONMEM control stream<br>
theta_record NONMEM control stream<br>
theta_recovery $ESTIMATION,$ESTM<br>
Interoccasion_variability example<br>
three_compartment_linear_model ADVAN11<br>
ADVAN12<br>Three_compartment example<br>
111<br>
<hr>
<A name=117></a>MISCELLANEOUS TOPICS Help Guide<br>
THTA<br>
NONMEM control stream<br>
time $DAT A<br>
timeout parallel computing<br>
timeouti parallel computing<br>
time_scale $PK<br>
PK<br>Time scale parameter<br>
time_translation DATE data item<br>
TIME data item<br>
time-varying_wt INTERPOLATION IN $DES<br>
tip3 Time After Dose (TAD) Example<br>
tip4 Time After Dose (TAD) Example<br>
t_matrix COVARIANCE MATRIX OF ESTIMATE<br>
tol NONMEM error messages<br>
tolerance PK_PD_simultaneous_2 example<br>
XML_COMPARE<br>
TOSU,TSOL additional_output_ﬁles<br>
raw_output_ﬁle<br>
transfer_type parallel computing<br>
TRANSFER_TYPE parallel computing<br>
transgeneration,transgenerate Abbreviated code<br>
Finalization example ($PRED and $INFN)<br>INFN<br>Infn_interpolation example 1<br>Infn_interpolation example 2<br>Initialization-Finalization block<br>PASS<br>PASS: PASSRC<br>$SIMULATION<br>Simulation_3 example<br>Simulation block<br>Verbatim code<br>
transit Transit Compartment Examples<br>
translation,time-translation $DAT A<br>
translator,translation $PK<br>
PK<br>TRANS (option)<br>TRANS (subroutine)<br>
two_compartment_linear_model ADVAN3<br>
ADVAN4<br>
two-stage Superproblem_2 example<br>
typical_value Displayed PRED-Deﬁned Items<br>
Simulation_1 example<br>
ucp $ESTIMATION,$ESTM<br>
$MSFI<br>Order_option<br>
112<br>
<hr>
<A name=118></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
UCP MONITORING OF SEARCH<br>
unconstrained INITIAL ESTIMATE (INITIAL EST)<br>
Interoccasion_variability example<br>MONITORING OF SEARCH<br>$OMEGA<br>$SIGMA<br>$THETA<br>
unconstrained_etas INDIVIDUALS<br>
unconstrained_parameter MONITORING OF SEARCH<br>
unit FILES<br>
unit_slope_line $SCATTERPLOT<br>
univariate Correlation Across L2 Records<br>
unix parallel computing<br>
upper_bound_record NONMEM control stream<br>
upper_case Abbreviated code<br>
$INPUT<br>nmfe utility program<br>variables in modules<br>Verbatim code<br>
upper-triangular MONITORING OF SEARCH<br>
UPPR NONMEM control stream<br>
up,upper,upper_bound INITIAL ESTIMATE (INITIAL EST)<br>
MONITORING OF SEARCH<br>$THETA<br>
urine CMT PCMT data item<br>
Output fraction parameter<br>Plasma urine example<br>Scaling parameter<br>
useful_variables Abbreviated code<br>
user_function User-deﬁned Reserved Function Example<br>
user-installation_routine FLU<br>
user_message Abbreviated code<br>
PRED Error Message<br>
users_guide USERS GUIDE<br>
user_supplied_routine CCONTR<br>
CONTR<br>CRIT<br>INFN<br>$MIX<br>MIX<br>NONMEM modules<br>PREDPP modules<br>PRIOR<br>SPTWO<br>Stubs<br>variables in modules<br>
113<br>
<hr>
<A name=119></a>MISCELLANEOUS TOPICS Help Guide<br>
utility_routine Abbreviated Function<br>
Abbreviated Function Examples<br>CELS<br>CHOL<br>CONSTRAINT<br>DDEXPAND<br>DOEXPAND<br>ELS<br>FILES<br>FINEDAT A<br>Finedata example<br>FLU<br>GAMLN<br>GETETA<br>MULT<br>NCONTR<br>NEFF,NEFFI<br>nmfe utility program<br>NMTEMPLATE<br>NWPRI<br>PASS<br>PHI<br>Probability Density Functions<br>RANDOM<br>SIGNAL<br>SIMEPS<br>SIMETA<br>SUPP<br>TABLE_COMPARE<br>TABLE_QUANT<br>TABLE_RESAMPLE<br>TABLE_TO_XML<br>TNPRI<br>XML_COMPARE<br>
values $DES<br>
Displayed PRED-Deﬁned Items<br>Simulation_1 example<br>Simulation_2 example<br>
var-cov<br>
NONMEM error messages<br>Variance-covariance<br>
variability COVARIANCE MATRIX OF ESTIMATE<br>
Interoccasion_variability example<br>Intra and inter-individual<br>Random models<br>
variables Copying block<br>
$DES<br>Displayed PRED-Deﬁned Items<br>Indicator variables<br>Simulation_1 example<br>
114<br>
<hr>
<A name=120></a>Help Guide<br>
MISCELLANEOUS TOPICS<br>
Simulation_2 example<br>
variables_in_modules variables in modules<br>
variance-covariance additional_output_ﬁles<br>
CORRELATION MATRIX OF ESTIMATE<br>COVARIANCE MATRIX OF ESTIMATE<br>INFERENTIAL STATISTICS<br>$OMEGA<br>Order_option<br>raw_output_ﬁle<br>$SIGMA<br>SIMEPS<br>SIMETA<br>STANDARD ERROR OF ESTIMATE<br>Variance-covariance<br>
vector $ABBREVIATED<br>
Abbreviated code<br>Abbreviated Function<br>Abbreviated Function Examples<br>Transit Compartment Examples<br>
verbatim Abbreviated code<br>
Displayed PRED-Deﬁned Items<br>RANDOM<br>SIMEPS<br>SIMETA<br>variables in modules<br>Verbatim code<br>
volume_of_disribution INTERPOLATION IN $DES<br>
VON<br>
Probability Density Functions<br>
VPD additional_output_ﬁles<br>
$ESTIMATION,$ESTM<br>NONMEM output ﬁles<br>
w<br>
parallel computing<br>
w: parallel computing<br>
warfarin PK_PD_simultaneous_4 example<br>
WEIBULL Probability Density Functions<br>
weighted-residual,weight PRED_RES_WRES<br>
PRED,RES,WRES<br>
windows parallel computing<br>
worker parallel computing<br>
wres SPTWO<br>
WSLEEP parallel computing<br>
wt INTERPOLATION IN $DES<br>
WTOUCH parallel computing<br>
XML additional_output_ﬁles<br>
TABLE_TO_XML<br>XML_COMPARE<br>
115<br>
<hr>
<A name=121></a>MISCELLANEOUS TOPICS Help Guide<br>
xml TABLE_TO_XML<br>
XML_COMPARE<br>
XSD additional_output_ﬁles<br>
TABLE_TO_XML<br>
xsd TABLE_TO_XML<br>
XTL TABLE_COMPARE<br>
XML_COMPARE<br>
xtl TABLE_COMPARE<br>
xtl XML_COMPARE<br>
XVID NONMEM control stream<br>
ZERO<br>
NONMEM control stream<br>
zero_line,zero CONTR<br>
$SCATTERPLOT<br>SPTWO<br>
zero_record NONMEM control stream<br>
116<br>
<hr>
<A name=122></a>Help Guide<br>
RESERVED WORDS<br>
$ABBREVIATED<br>
MEANING: Provides instructions about abbreviated code<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$ABBREVIATED [COMRES=<i>n</i>1] [COMSAV=<i>n</i>2]<br>
[DERIV2=NO] [DERIV2=NOCOMMON] [DERIV1=NO]<br>[FASTDER | NOFASTDER]<br>[CHECKMU | NOCHECKMU]<br>[DES=COMPACT|DES=FULL]<br>[REPLACE left_string = right_string ] ...<br>[DECLARE [type] [DOWHILE] name [(dimension [,dimension])] ...<br>[PROTECT]<br>[FUNCTION function_name(input_vector_name,dimension[,usage])]<br>[VECTOR input_vector_name(dimension)]<br>
SAMPLE:<br>$ABBREVIATED COMRES=2<br>
DISCUSSION:<br>Optional. May be used when $PK, $ERROR, or $PRED abbreviated code is present.<br>Must precede all blocks of abbreviated code. With NONMEM 7.4, may also be used<br>when there is no abbreviated code. For example, $ABBR REPLACE may be used for<br>label substitution in NONMEM report ﬁles.<br>
OPTIONS:<br>
COMRES=<i>n</i>1 (’common reserve’)<br>
COMRES gives instructions to NM-TRAN.<br>Values of <i>n</i>1:<br>
-1 Do not store any variables in the global variable array, VRBL, in the NMPRD4<br>
module.<br>
0<br>
Store variables in NMPRD4 with no reserved positions (the default)<br>
<i>n</i>1<br>
Store variables in NMPRD4, but reserve the ﬁrst n1 positions<br>
With abbreviated code, the Ith position in NMPRD4 is referenced by COM(I).<br>
This option is intended for advanced users of NONMEM, e.g., when abbreviated<br>code is combined with user-supplied subroutines or verbatim code. A user-sup-<br>plied subroutine may reserve the ﬁrst <i>n</i>1 positions in NMPRD4 for its use, in which<br>case the option COMRES should be set to <i>n</i>1 to instruct NM-TRAN to skip these<br>positions; the ﬁrst position used by NM-TRAN for storing variables deﬁned in<br>abbreviated code will be position <i>n </i>+<br>
1<br>
1.<br>
$TABLE and $SCATTER may explicitly reference variables in reserved positions 1<br>through <i>n</i>1 by COM(1) through COM(<i>n</i>1), respectively, in addition to listing vari-<br>ables deﬁned in abbreviated code by name.<br>
An individual block of abbreviated code (e.g. $PK) may include the pseudo-state-<br>ment COMRES=-1, which prevents any variable deﬁned in that particular block<br>from being stored in NMPRD4.<br>
COMSAV= <i>n</i>2 (’common save’)<br>
Values of variables displayed in tables and scatterplots are obtained from<br>
117<br>
<hr>
<A name=123></a>$ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
NMPRD4. There are particular times when data records are passed to PRED for<br>the purpose of obtaining these values; these are called copying passes. The SAVE<br>region of NMPRD4 is the initial part of this array. If a variable is stored in the<br>SAVE region, then the value of the variable computed with a given data record dur-<br>ing a copying pass will be found in NMPRD4 when the same record is passed dur-<br>ing the next copying pass, i.e. it will have been saved from the previous copying<br>pass. This is in contrast to the usual behaviour, where with a given data record, the<br>value in NMPRD4 is the value computed with the previous data record.<br><i>n</i>2 is the initial size of the SAVE region, i.e. the number of positions in this region.<br><i>n </i>=<br>
2<br>
0 is the default value. <i>n</i>2 may not exceed <i>n</i>1.<br>
The SAVE region has size <i>n</i>2 initially, but NM-TRAN may extend it if SAVE vari-<br>ables are used. However, if <i>n </i>= −<br>
2<br>
1, the SAVE region is not to be extended, and<br>
there is to be no SAVE region altogether.<br>(See <b>copying block</b>).<br>
When PREDPP is used, and a $PK block is present, NM-TRAN inserts code into<br>the PK routine that stores the value of COMSAV at ICALL=1. If no $PK block is<br>present, and a $ERROR block is present, the code is inserted into the ERROR rou-<br>tine. When PREDPP is not used, and a $PRED block is present, the generated or<br>library PRED routine stores the value of COMSAV at ICALL&lt;=1.<br>
DERIV1=NO (NM74)<br>
Prevents the computation of ﬁrst derivatives. For example, may be used when only<br>SAEM or BAYES is performed, or IMPMAP/ITS/FOCE are performed using<br>OPTMAP&gt;0 and ETADER&gt;0. The global variable NOFIRSTDERCODE is set to<br>1.<br>
DERIV2=NO<br>
Prevents the computation of second derivatives, which are needed only for the<br>Laplacian method.<br>
DERIV2=NOCOMMON<br>
Permits the computation of these derivatives, but prevents them from being stored<br>in the global variable NMPRD4.<br>$ESTIMATION METHOD=COND LAPLACIAN may be speciﬁed, but variables<br>representing second derivatives are not stored in NMPRD4. Therefore, they cannot<br>be displayed in tables and scatterplots. In addition, no variables computed in the<br>$PK block may be referenced in the $ERROR block. This is true whether or not<br>these variables happen to have second derivatives, and whether or not the Laplacian<br>method is used.<br>
FASTDER, NOFASTDER<br>
With NONMEM 7.2 and higher, NM-TRAN collects statements that compute ﬁrst-<br>partial eta-derivatives together in FSUBS, and they are performed only when NON-<br>MEM sets IFIRSTEM=1. NOFASTDER prevents NM-TRAN from doing this, and<br>restores the order of statements in FSUBS to what it was in previous versions.<br>
FASTDER requests that the statements be collected, and is the default.<br>(See <b>Partial Derivative Indicators</b>).<br>
CHECKMU, NOCHECKMU<br>
With NONMEM 7.2 and higher, NM-TRAN checks the MU model statements in<br>abbreviated code and issues warning messages if they appear to contain mistakes.<br>This can take a long time for large control streams. Also, in the examples direc-<br>tory, there are control streams for which the check is too difﬁcult for NMTRAN<br>
118<br>
<hr>
<A name=124></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ABBREVIATED<br>
(tdist6_sim.ctl and tdist7.ctl), and some for which the warnings are inappropriate<br>(the &quot;superid&quot; control streams that use $LEVEL). NOCHECKMU can be used to pre-<br>vent NM-TRAN from attempting to check the MU model statements.<br>
CHECKMU requests that MU model statements be checked, and is the default. Nei-<br>ther option affects the generated code.<br>
DES=FULL<br>
Arrays of the DES routine are stored in non-compact form.<br>With $ESTIMATION METHOD=COND LAPLACIAN, the option NUMERICAL is<br>also required.<br>DES=FULL is the default with ADVAN9 and ADVAN15. (Prior to NONMEM 7.4,<br>FULL was required with ADVAN13.)<br>
DES=COMPACT<br>
Arrays of the DES routine are stored in compact form.<br>Required with Laplacian method; optional otherwise. This is the default, except<br>with ADVAN9 and ADVAN15.<br>
REPLACE left_string = right_string<br>
There are several different forms of the REPLACE option. They do not affect ver-<br>batim code. Case is ignored.<br>
(1) Simple replacement<br>
REPLACE left_string = right_string<br>
May be used in all blocks of abbreviated code and $TABLE and $SCATTER<br>records. Left_string is replaced by right_string. The search is &quot;anchored&quot; by a For-<br>tran identiﬁer. That is, left_string is parsed for the ﬁrst Fortran identiﬁer and the<br>abbreviated code is searched for the same identiﬁer. Following the identiﬁer, the<br>entire left_string must match the abbreviated code. Single or double quotes around<br>a string are optional. They are necessary if the string contains punctuation such as<br>a comma. A given line of abbreviated code may have multiple replacements; they<br>are applied in the order that they appear in the NM-TRAN control stream.<br>
Examples:<br>
$ABBR REPLACE PI=3.14159265<br>
$ABBR REPLACE THETA(CL)=THETA(4)<br>
$ABBR REPLACE ETA(CL)=ETA(5)<br>
$ABBR REPLACE K34=&quot;3,4&quot;<br>
...<br>
CL=PI*THETA(CL)*EXP(ETA(CL))<br>
PRINT *,OMEGA(K34)<br>
The post-replacement code is<br>CL=3.14159265*THETA(4)*EXP(ETA(5))<br>
PRINT *,OMEGA(3,4)<br>
With this feature, subscripts of THETA, ETA, and EPS and ERR may be given<br>symbolic names in abbreviated code, and $ABBR REPLACE is used to replace<br>them with integer subscripts. With NONMEM 7.4, this feature also requests <i>label<br>substitution </i>in NONMEM report ﬁles and table ﬁles. For example, the following<br>will cause all appearances of &quot;ETA(CL)&quot; to be replaced by &quot;ETA(3)&quot; in the gener-<br>ated subroutine, and will cause &quot;ETA(3)&quot; to be replaced by &quot;ETA(CL)&quot; in the<br>NONMEM report and any table ﬁle in which &quot;ETA(3)&quot; is listed.<br>
119<br>
<hr>
<A name=125></a>$ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ABBR REPLACE ETA(CL)=ETA(3)<br>
Label substitution can be turned off for an entire problem with NOSUB=1 option of<br>the $DEFAULT record. Label substitution can be turned off for a speciﬁc NON-<br>MEM task (and all subsequent tasks) with the NOSUB=1 option of $TABLE,<br>$SCAT, and $ESTIMATION.<br>
Substitutions will never be made in the additional output ﬁles *.ext, ,phi, etc., to<br>maintain their third party software readability.<br>
(2) Replacement with selection by data item<br>
$ABBR REPLACE VAR(d)=VAR(<i>n</i>1,<i>n</i>2,..,<i>nk</i>)<br>May be used in $PK, $ERROR, $PRED blocks only. VAR must one of ETA, EPS,<br>THETA. (ERR is not permitted.) d must be a data item. The integer value of d<br>(i.e., INT(d)) is used to select one of <i>n</i>1,<i>n</i>2,..,<i>nk</i>. If any of the <i>ni </i>is 0, that position<br>is skipped. The effective code is:<br>IF (d.eq.1) VAR(d)=VAR(<i>n</i>1)<br>IF (d.eq.2) VAR(d)=VAR(<i>n</i>2)<br>
...<br>
The actual generated code uses Q-type indicator variables, and variables such as<br>THETA_OCC_ in place of THETA(OCC).<br>
Example: Suppose OCC is a data item that takes values 1 and 2.<br>$ABBR REPLACE THETA(OCC)=THETA(4,7)<br>
...<br>
$PK<br>
TVCL=THETA(OCC)<br>The effective code after replacement is<br>IF (OCC==1) TVCL=THETA(4)<br>
IF (OCC==2) TVCL=THETA(7)<br>
A user-deﬁned variable can be given a default value in case the implied selection is<br>not satisﬁed. E.g., suppose there are 3 doses per subject (DOSN=1,2,3) and the<br>model is:<br>$PK ...<br>
IF(DOSN.EQ.1) F1=1<br>
IF(DOSN.EQ.2) F1=1*EXP(ETA(2))<br>
IF(DOSN.EQ.3) F1=1*EXP(ETA(3))<br>
The model can be implemented using implied selection as follows:<br>$ABBR REPLACE ETA(DOSN)=ETA(0,2,3)<br>
$PK ....<br>
F1=1<br>
IF (DOSN&gt;1) F1=1*EXP(ETA(DOSN))<br>
(3) Replacement with selection by data item and parameter<br>
$ABBR REPLACE VAR(p_d)=VAR(<i>n</i>1,<i>n</i>2,..,<i>nk</i>)<br>p is a user-deﬁned variable in the abbreviated code. The order may be p_d or d_p<br>This allows a given data item d to be used as a selection variable for more than one<br>parameter, with a different choice of elements of VAR.<br>
Example 1:<br>$ABBR REPLACE THETA(SID_KA)=THETA(4,6)<br>
$ABBR REPLACE THETA(SID_CL)=THETA(5,7)<br>
...<br>
$PK<br>
120<br>
<hr>
<A name=126></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ABBREVIATED<br>
KA=THETA(SID_KA)<br>
CL=THETA(SID_CL)<br>which is equivalent to<br>$PK<br>
IF (SID==1) KA=THETA(4)<br>
IF (SID==2) KA=THETA(6)<br>
IF (SID==1) CL=THETA(5)<br>
IF (SID==2) CL=THETA(7)<br>
Example 2:<br>$ABBR REPLACE ETA(OCC_CL)=ETA(5,3)<br>
$ABBR REPLACE ETA(OCC_V) =ETA(6,4)<br>
...<br>
$PK<br>
CL=TVCL*EXP(ETA(1)+ETA(OCC_CL))<br>
V =TVV *EXP(ETA(2)+ETA(OCC_V))<br>which is equivalent to<br>$PK<br>
IF (OCC==1) CL=TVCL(EXP(ETA(1)+ETA(5))<br>
IF (OCC==2) CL=TVCL(EXP(ETA(1)+ETA(3))<br>
IF (OCC==1) V=TVV(EXP(ETA(2)+ETA(6))<br>
IF (OCC==2) V=TVV(EXP(ETA(1)+ETA(4))<br>
The number of values speciﬁed for the selection data item must be consistent for all<br>parameters in which it is used.<br>
(4) Replacement for multiple variables<br>
$ABBR REPLACE VAR( <i>p</i>1, <i>p</i>2,..., <i>pk</i>)=VAR(<i>n</i>1,<i>n</i>2,...,<i>nk</i>)<br>This form is new to NONMEM 7.4.<br>
The<br>
<i>pi </i>are character<br>
strings separated by commas.<br>
A<br>
character string may<br>
not contain an embedded space.<br>
The lists on both left<br>
and right sides must be of the same length.<br>
VAR( <i>pi</i>) is<br>
replaced by VAR(<i>ni</i>). For example,<br>
$ABBR REPLACE THETA(CL,V1,Q,V2)=THETA(1,2,3,4)<br>
This is equivalent to:<br>$ABBR REPLACE THETA(CL)=THETA(1)<br>
$ABBR REPLACE THETA(V1)=THETA(2)<br>
$ABBR REPLACE THETA(Q)=THETA(3)<br>
$ABBR REPLACE THETA(V2)=THETA(4)<br>
Label substition occurs with this form, as with Simple replacement (1).<br>
Short-hand notation<br>
A short-hand notation may be used to describe a series of values of <i>ni</i>. An ascend-<br>ing sequence of <i>ni </i>can be described as<br>
,start TO end [BY interval]<br>
BY is optional and must be &gt; 0. Default is 1. TO is required. If end &lt; start, the<br>sequence is ignored. At least one comma must appear, so NMTRAN knows it is a<br>number list, not a variable name. With NONMEM 7.4, the character : may be used<br>instead of TO, and the value of BY may be negative.<br>
EXAMPLES:<br>$ABBR REPLACE THETA(SID_KA)=THETA(10:4 by 3) ; order: 10,7,4<br>
$ABBR REPLACE THETA(SID_KA)=THETA(4 to 10 by -3) ; order: 10,7,4<br>
121<br>
<hr>
<A name=127></a>$ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ABBR REPLACE THETA(SID_KA)=THETA(10 to 4) ; order: 10,9,8,7,6,5,4<br>
$ABBR REPLACE THETA(SID_KA)=THETA(,4 to 13 by 3,25 to 37 by 4)<br>is identical to<br>$ABBR REPLACE THETA(SID_KA)=THETA(4,7,10,13,25,29,33,37)<br>
Files FORIG and FREPL<br>
When $ABBR REPLACE is coded, NM-TRAN produces two ﬁles:<br>FORIG Contains the original (pre-replacement) abbreviated code,<br>and task speciﬁcation records $TABLE and $SCATTER.<br>FREPL Contains the new (post-replacement) abbreviated code<br>and task speciﬁcation records.<br>These may be helpful for debugging.<br>
DECLARE [INTEGER] [DOWHILE] name [(dimension [,dimension])] ...<br>
One or names may be coded. They are referred to as &quot;declared variables.&quot; IF<br>INTEGER or DOWHILE is coded, the type of the variable is integer. Otherwise,<br>the type of the variable is double precision. If one or two dimensions are declared,<br>the variable being declared is an array. Each dimension may be a number or a vari-<br>able or an expression. Constants deﬁned in SIZES (e.g., NO, LVR) may be used.<br>Multiple DECLARE options may be coded. The characters &quot;DECLARE&quot; are<br>optional after the ﬁrst. Commas are ignored, and type and dimensions must be<br>respeciﬁed as needed.<br>
No other options of $ABBR may appear after the<br>
DECLARE option(s). Declared variables are global, i.e., are deﬁned in all blocks<br>of abbreviated code. The number of subscripts must agree with the number of<br>dimensions in the declaration. Declared variables that are not INTEGER or<br>DOWHILE will be random variables if they are assigned in a statement whose<br>right-side involves ETA’ s or EPS’s.<br>
EXAMPLE:<br>
$ABBR DECLARE A,B(10),C(1,NO-1),INTEGER I J<br>
Only I is INTEGER.<br>
Variables may be declared as INTEGER or DOWHILE for use as subscripts of<br>declared arrays or reserved variables that are arrays (but not of ETA, ERR, or EPS).<br>
Variables used as looping indices in DOWHILE statements must be declared as<br>DOWHILE variables.<br>
Declared variables are automatically initialized to 0.<br>
Elements of a declared array may be displayed in WRITE/PRINT statement, but<br>not the entire array. E.g., the following is permitted<br>PRINT *,B(1),B(2)<br>but not<br>PRINT *,B<br>
Neither individual elements nor the entire array may be listed in $TABLE. The<br>workaround is to code, e.g.,<br>
... code assigning values to B(1) etc. ...<br>
B1=B(1)<br>
$TABLE B1<br>
(See <b>dowhile block</b>).<br>
PROTECT<br>
With NONMEM 7.4, a series of routines are available that protect against domain<br>
122<br>
<hr>
<A name=128></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ABBREVIATED<br>
violations, divide by zero, and ﬂoating point overﬂows. Each of these routines start<br>with the letter P, followed by the name of the mathematical operation they are to<br>perform. For example, PLOG is the protective code routine that performs the LOG<br>operation. With $ABBR PROTECT, NMTRAN will automatically replace all rele-<br>vant function names with the P name.<br>
(See <b>protect functions</b>).<br>
FUNCTION function_name(input_vector_name,dimension[,usage])<br>
With all versions of NONMEM since NONMEM VI, user-supplied functions are<br>permitted in abbreviated code with reserved names such as FUNCA, FUNCB, ...,<br>and argument vectors with reserved names such as VECTRA, VECTRB, ..... With<br>NONMEM 7.4, extended reserved names are recognized. These are FUNCxy and<br>FUNCxyz, where each of x, y, z stands for an alphabetic character A-Z, e.g., FUN-<br>CAB or FUNCABC. Similar extended reserved names for vectors are also recog-<br>nized: e.g, VECTRAB or VECTRABC. Reserved argument vectors and arrays have<br>dimension 9 and each reserved function may appear in abbreviated code at most 9<br>times.<br>(See <b>Abbreviated Function</b>).<br>
In NONMEM 7.4 the $ABBR FUNCTION option allows user-deﬁned function<br>names and user-deﬁned argument vector names. The dimensions of the argument<br>vector and the maximum number of times a given function name may appear in<br>abbreviated code is user-speciﬁed.<br>
A user-deﬁned function may be declared as follows:<br>$ABBR FUNCTION function_name(input_vector_name,dimension,usage)<br>
function_name<br>
is the name of the function.<br>
input_vector_name<br>
is the name of an input vector that may be used to pass arguments to the function.<br>
dimension<br>
speciﬁes how many input arguments function_name will use, and deﬁnes input_vec-<br>tor_name as a vector with this length. &quot;Dimension&quot; is a property of both the func-<br>tion and of the input vector.<br>
usage<br>
is the maximum number of times the function may appear in the abbreviated code,<br>that is, the maximum number of occurances of function_name. It is not an error if<br>there are fewer occurances. If usage is omitted, NMTRAN will supply the exact<br>number. If usage is coded, NMTRAN will generate an error message if func-<br>tion_name appears in abbreviated code more than &quot;usage&quot; number of times.<br>
A vector and its length may be declared independently of a function,<br>$ABBR VECTOR input_vector_name (dimension)<br>
input_vector_name<br>
is the name of an input vector.<br>
dimension<br>
The length of the vector. The dimension of a vector should be no less than the<br>dimension of all the functions which which it is used.<br>
Example:<br>
123<br>
<hr>
<A name=129></a>$ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ABBR FUNCTION BIVARIATE(VBI,5,3)<br>
A vector VBI is deﬁned of length 5. There is a function called BIVARIATE. When<br>BIVARIATE is used, the value 5 is passed to it as argument NDIM. BIVARIATE<br>uses 5 elements from the input vector. Function BIVARIATE may appear in abbre-<br>viated code at most 3 times. BIVARIATE should be present in a source code ﬁle<br>listed in the $SUBROUTINES record:<br>
$SUBROUTINES OTHER=filename<br>
Instructions for coding both reserved functions and user_deﬁned functions are in<br><b>Abbreviated Function</b>.<br>
Here is an example of abbreviated code that uses BVI and BIVARIATE:<br>$PK ...<br>
VBI(1)=RHO<br>
VBI(2)=5<br>
VBI(3)=6<br>
VBI(4)=1 ;***0 = Upper tail as in Drezner &amp; Wesolowsky; 1 = Bottom tail***;<br>
VBI(5)=1 ;***0 = 3 pt approximation; 1 = 5 point approximation***;<br>
BV=BIVARIATE(VBI)<br>
There is a fully worked out example.<br>(See <b>bivariate function</b>).<br>Files are in the examples directory: bivariate.ctl, bivariate.csv, bivariate.f90.<br>
By default, there may be up to 100 different user-deﬁned functions, which includes<br>functions with reserved names and user-deﬁned names. There may also be up to 100<br>different vectors of input arguments, which includes vectors with reserved names<br>and user-deﬁned names. Constants NFUNCX and NVECX in SIZES may be used<br>to change these numbers.<br>
It is preferable that a unique vector should be associated each function to assure that<br>each vector-function pair are set up with comparable dimensions. This is not neces-<br>sary. Any user-deﬁned vector or function may be used with any reserved vector or<br>reserved function, subject to the same restriction. For example:<br>
$ABBR FUNCTION BIVARIATE(VBI,5)<br>
$ABBR FUNCTION BIVARIATEQ(VQI,10)<br>
In abbreviated code, any of the following are permitted:<br>BVI=BIVARIATE(VBI)<br>
BVQ=BIVARIATE(VQI)<br>
BVQI=BIVARIATEQ(VBI)<br>
BVQQ=BIVARIATEQ(VQI)<br>
NM-TRAN gives a warning:<br>(WARNING 133) DIMENSION OF VECTOR IS LESS THAN WHAT IS EXPECTED BY FUNCTION<br>
BVQI=BIVARIATEQ(VBI(001),FNC002_1(1,001),FNC002_2(1,1,001),10)<br>
This is because vector VBI has dimension 5 and function BIVARIATEQ was<br>declared with dimension 10. Note that the results will be correct if BIVARIATEQ<br>does not use more than 5 positions in the argument vector.<br>
A vector and its length may be declared independently of a function, and vice versa. The<br>asterisk is used as a placeholder, e.g.,<br>
$ABBR FUNCTION BIVARIATE(*,5) ; when BIVARIATE is called, NDIM will be 5<br>
$ABBR FUNCTION BIVARIATEQ(*,10) ; when BIVARIATEQ is called, NDIM will be 10<br>
$ABBR VECTOR VQI(15)<br>
124<br>
<hr>
<A name=130></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ABBREVIATED<br>
The $ABBREV FUNCTION record may be used to override the default settings for any<br>of the reserved function or vectors. For example,<br>
$ABBR FUNCTION FUNCA(VECTRA,25,5)<br>
VECTRA will be deﬁned with length 25, not 9 as for a reserved function. The code<br>for the function should have NDIM as an argument:<br>FUNCTION VECTRA(X,X1,X2,NDIM)<br>
NDIM should be used instead of 9 for vector and array dimensions, as shown in the<br><b>Abbreviated Function </b>help item.<br>
REFERENCES: Guide IV, section III.B.7 , IV<br>REFERENCES: Guide Introduction_7<br>
125<br>
<hr>
<A name=131></a>$AES DETAILED DESCRIPTIONS<br>
Help Guide<br>
$AES<br>
MEANING: Marks the beginning of abbreviated code for the AES routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$AES<br>abbreviated code<br>
DISCUSSION:<br>The $AES record is used to compute algebraic expressions which can be regarded as<br>specifying equilibrium kinetics. It is used with PREDPP’s ADVAN9 and ADVAN15.<br>(See <b>$AESINITIAL</b>).<br>General rules for abbreviated code are documented elsewhere<br>(See <b>abbreviated code</b>).<br>Speciﬁc rules follow.<br>
ASSIGNMENT AND CONDITIONAL STATEMENTS<br>
Left-hand quantities in assignment statements:<br>
E(ncm1+1), E(ncm1+2), ... (Required. Expressions which, when set to 0, consti-<br>tute the system of algebraic expressions describing the equilibrium kinetics. ncm1 is<br>the number of nonequilibrium compartments.) The indices &quot;(...)&quot; may be omitted, in<br>which case NM-TRAN will supply them according to the order in which the expres-<br>sions appear. Indices are required when the expressions are deﬁned conditionally<br>(i.e., using an IF statement).<br>
AES-deﬁned (i.e., PRED-deﬁned) items.<br>
Right-hand quantities in assignment statement and in conditions:<br>
A(1), A(2), ... (Current compartment amounts; may be random variables.)<br>
P(1), P(2), ... (Post-translation basic PK parameters; may be random variables.)<br>
PK-deﬁned items (Implicit basic PK parameters; may be random variables.)<br>
T (Time; may be random variable. T takes values continuously over an integration<br>interval.)<br>
AES-deﬁned variables that appeared earlier as left-hand quantities in $AES, and<br>similarly from the $AESINITIAL record. (Caution: AESINITIAL-deﬁned variables<br>that depend on compartment amounts will depend on the initial values of these com-<br>partment amounts, not the current values.)<br>
Data item labels speciﬁed on the $INPUT statement.<br>
THETA(n).<br>
Global Variables in Modules<br>
Certain variables in FORTRAN modules can be used.<br>
126<br>
<hr>
<A name=132></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$AES<br>
(See <b>Variables_in_Modules</b>)<br>The following are of particular interest.<br>
DOSTIM<br>
DOSTIM is the time of a lagged dose or additional dose to which the system is<br>being advanced. Abbreviated code in $AES may test DOSTIM. It may use<br>DOSTIM on the right, unless DOSTIM is a random variable. However, it may<br>be used on the right in a $PK block to deﬁne a random variable which may in<br>turn be used on the right in the $AES block.<br>
DOSREC<br>
DOSREC is the dose record corresponding to the dose entering at DOSTIM.<br>Abbreviated code in $AES may test items in DOSREC in a logical condition,<br>and DOSREC may always be used on the right.<br>
ISFINL<br>
During simulation or a copying pass, and during the advance to a particular<br>time (event or non-event time), ISFINL=1 at a ﬁnal call to AES at that time.<br>Otherwise, ISFINL=0.<br>
Forbidden Variable Names:<br>
IR DA DP DT ETA(n) EPS(n) ERR(n)<br>
RECORD ORDER:<br>
Follows $SUBROUTINES $INPUT $MODEL $PK<br>Follows $AESINITIAL<br>
(See <b>aes</b>, <b>advan9_15</b>).<br>
REFERENCES: Guide IV, section V.C.9<br>REFERENCES: Guide VI, section VI.E<br>
127<br>
<hr>
<A name=133></a>$AESINITIAL DETAILED DESCRIPTIONS<br>
Help Guide<br>
$AESINITIAL<br>
MEANING: Marks the beginning of abbreviated code for the AES routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$AESINITIAL<br>abbreviated code<br>
DISCUSSION:<br>The $AESINITIAL record is used to compute the amounts in the equilibrium compart-<br>ments at the beginning of an integration interval. It is used with PREDPP’s ADVAN9<br>and ADVAN15. May also be coded $AES0.<br>(See <b>$AES</b>).<br>General rules for abbreviated code are documented elsewhere<br>(See <b>abbreviated code</b>).<br>Speciﬁc rules follow.<br>
ASSIGNMENT AND CONDITIONAL STATEMENTS<br>
Left-hand quantities in assignment statements:<br>
A(ncm1+1), A(ncm1+2), ... (Required. The amounts in the equilibrium compartments<br>at the beginning of the integration interval. ncm1 is the number of nonequilibrium com-<br>partments.)<br>
INIT (Initialization ﬂag.)<br>
INIT=0: The A(n) are approximate.<br>INIT=1: The A(n) are exact (the default).<br>
AESINITIAL-deﬁned (i.e., PRED-deﬁned) items.<br>
Right-hand quantities in assignment statement and in conditions:<br>
A(1), A(2), ... (Current compartment amounts; may be random variables.)<br>
P(1), P(2), ... (Post-translation basic PK parameters; may be random variables.)<br>
PK-deﬁned items (Implicit basic PK parameters; may be random variables.)<br>
T (Time at the beginning of the integration interval; may be random variables.)<br>
AESINITIAL-deﬁned items that appeared earlier as left-hand quantities.<br>
Data item labels speciﬁed on the $INPUT statement.<br>
THETA(n).<br>
Global Variables in Modules<br>
Certain variables in FORTRAN Modules can be used.<br>(See <b>Variables_in_modules</b>)<br>
128<br>
<hr>
<A name=134></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$AESINITIAL<br>
Forbidden Variable Names:<br>
IR DA DP DT E(n) ETA(n) EPS(n) ERR(n)<br>
PSEUDO ASSIGNMENT STATEMENTS<br>
COMRES=-1<br>
CALLFL=-1: Call ADVAN and AES with every event record (default).<br>CALLFL=1: Call ADVAN and AES once per individual record.<br>
(CALLFL may be used only when the TIME data item is not deﬁned.) The pseudo<br>assignments statements may be enclosed in parentheses. If both are present within the<br>same set of parentheses, separate them with a semicolon. Within parentheses, a calling<br>protocol phrase may be used instead of CALLFL, and either upper or lower case may be<br>used. E.g.,<br>$AESINIT (ONCE PER IR)<br>
; same as CALLFL=1<br>
$AESINIT (EVERY EVENT)<br>
; same as CALLFL=-1 (default)<br>
(See <b>calling protocol</b>).<br>
RECORD ORDER:<br>
Follows $SUBROUTINES $INPUT $MODEL $PK<br>Precedes $AES<br>
REFERENCES: Guide IV, section V.C.8<br>REFERENCES: Guide VI, section VI.E<br>
129<br>
<hr>
<A name=135></a>$ANNEAL DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ANNEAL<br>
MEANING: Sets starting diagonal Omega values to facilitate EM search methods<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$ANNEAL number-list1:value1 number-list2:value2 ...<br>
SAMPLE:<br>$ANNEAL 1-3,5:0.3 6,7:1.0<br>
DISCUSSION:<br>
Sets starting diagonal Omega values for purposes of simulated annealing by NONMEM<br>subroutine CONSTRAINT.<br>
In the above example, initial values of OMEGA(1,1), OMEGA(2,2), OMEGA(3,3), and<br>OMEGA(5,5) are set to 0.3, while initial OMEGA(6,6) and OMEGA(7,7) are set to 1.0.<br>
A number-list may contain a single integer, a range of integers (with -), or a series of inte-<br>gers and ranges separated by comma. Required.<br>
A value may be any numeric value. Optional; default is 0.<br>
When $EST CONSTRAIN&gt;=4, an algorithm in subroutine CONSTRAINT will initially<br>set the omegas to these values, and then shrink these OMEGA values more and more with<br>each iteration, and eventually shrinks the OMEGA’s to 0, the intended target value for<br>that Omega. This is a technique that may be used especially with SAEM, to provide an<br>annealing method for moving thetas that have 0 omega values associated with them. The<br>default is the use of gradient methods, which are good for problems starting near the solu-<br>tion, whereas the annealing method is more suitable for problems starting far from the<br>solution.<br>
Subroutine CONSTRAINT obtains values entered via $ANNEAL record in the array<br>OMEGANNL. Any value that is set to 0 in $ANNEAL is given the default value of .3.<br>
This record is optional. If omitted, the starting values of Omega are those speciﬁed in the<br>$OMEGA record.<br>
NONMEM’s default CONSTRAINT.f90 is identical to Subroutine source/CON-<br>STRAINT.f90.<br>
See <b>INTRODUCTION TO NONMEM 7: $ANNEAL to facilitate EM search meth-<br>ods</b><br>
REFERENCES: Guide Introduction_7<br>
130<br>
<hr>
<A name=136></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$BIND<br>
$BIND<br>
MEANING: Deﬁne data values used by $PK, $DES, and $AES<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$BIND [<i>value</i>1] [<i>value</i>2] ...<br>DISCUSSION:<br>$BIND is optional. It may be used when $PK abbreviated code is present <i>and </i>this code<br>requests that the PK subroutine be called at additional or lagged dose times<br>(CALLFL=-2). It is used to override the default values of user-deﬁned variables used in<br>the code when the PK routine is called at these particular dose times. It is also used to<br>override the default values of user-deﬁned variables used in $DES and $AES abbreviated<br>code during an advance to an additional or lagged dose time.<br>
$BIND has no effect when PK is called at a model event time (MTIME).<br>
Let t be a time at which an additional or lagged dose enters the system. If t1 is the great-<br>est event time not exceeding the time t, then the &quot;last event record&quot; is the last event record<br>with event time t1, and the &quot;next event record&quot; is the event record following the last event<br>record.<br>(The term &quot;last&quot; is similar to the word &quot;previous&quot; in this context.)<br>The event time on the next event record will exceed time t.<br>
OPTIONS:<br>
The positions of the values correspond to the positions of data items in the $INPUT<br>record in a 1-to-1 manner. Each value is one of:<br>
DOSE (Use the value from the dose record.)<br>NEXT (Use the value from the next event record.)<br>LAST (Use the value from the last event record.)<br>SKIP (Ignore this data item.)<br>DROP (Ignore this data item.)<br>- (Default.)<br>
For user (concomitant) data items, the default is NEXT but any of DOSE, NEXT, LAST<br>may be speciﬁed.<br>
For the PREDPP data item TIME, the default is NEXT. Only - or NEXT may be speci-<br>ﬁed.<br>
For all other PREDPP or NONMEM data items, the default is DOSE. Only - or DOSE<br>may be speciﬁed.<br>
Option DROP in the $BIND record is optional. It is ignored by NM-TRAN, but helps the<br>user maintain a 1-to-1 relationship between positions in $BIND and positions in $INPUT.<br>
A $BIND record with all defaults speciﬁed, such as<br>$BIND - - - - - - -<br>has the same effect as if no $BIND record were present.<br>
EXAMPLE:<br>
$INPUT ID TIME DATE=DROP AMT DV WGT<br>
PREP X<br>
HGT<br>
$BIND - -<br>
DROP -<br>
- NEXT DOSE LAST<br>
-<br>
ID, AMT, DV hav e the values from the initiating dose record.<br>TIME has the value from the next event record.<br>
131<br>
<hr>
<A name=137></a>$BIND DETAILED DESCRIPTIONS<br>
Help Guide<br>
WGT and HGT have values from the next event record.<br>PREP has the value from the initiating dose record.<br>X has the value from the last event record. This record will be the dose record<br>if there is no other event record between the dose record and the next event<br>record.<br>
$INPUT and $BIND records can be interleaved to help maintain a visual relationship.<br>The above example could have been coded:<br>
$INPUT ID TIME DATE=DROP<br>
$BIND - -<br>
DROP<br>
$INPUT AMT DV<br>
WGT PREP X<br>
HGT<br>
$BIND -<br>
-<br>
NEXT DOSE LAST<br>
-<br>
$BIND may not specify a position beyond the last position deﬁned via $INPUT. It may<br>specify fewer positions, in which case defaults apply to the remaining data items.<br>
Changes to $BIND, like changes to $INPUT, cause changes to generated code. Thus, an<br>existing NONMEM executable cannot be re-used when the $BIND and/or $INPUT<br>records are changed.<br>
The $BIND record only applies under the following circumstances:<br>
(1) There exists a dose that is either one or both of the two following types of doses:<br>
a) An additional dose, subsequent to the initiating dose (ADDL&gt;0, II&gt;0 in the<br>
dose event record). Such a dose enters the system at the &quot;additional dose time.&quot;<br>
b) A lagged dose. (with the corresponding dose event record, PK speciﬁes<br>
ALAGi&gt;0, where i is the index of the dose compartment). Such a dose enters<br>the system at the &quot;lagged dose time.&quot;<br>
(2) The PK subroutine computes parameters that depend on values in the data record<br>
which are not constant for the individual, i.e., parameters depend on time-varying<br>data items.<br>
(3) The PK subroutine is called when the dose enters the system.<br>
That is, $PK contains the pseudo-statement CALLFL=-2, requesting that the PK<br>routine be called to compute values of the PK parameters at additional and lagged<br>dose times. When $PK does not contain this pseudo-statement, there is no such call,<br>and at an additional or lagged dose time, the PK parameters have those values com-<br>puted with the next event record.<br>
When the $PK code is implemented with an event record, the variable DOSTIM is 0.<br>When it is implemented at an additional or lagged dose time, the value of this variable is<br>the time in question. By default, data items used in abbreviated code have values from<br>either the initiating dose record (DOSREC) or the next event record (EVTREC), accord-<br>ing to this rule:<br>
NONMEM data items and PREDPP data items (other than TIME) have values from the<br>original dose event record (DOSREC). These are:<br>
DV MDV ID L2 MRG_ RAW_ EVID AMT RATE SS II CMT PCMT CALL CONT<br>ADDL DATE DAT1 DAT2 DAT3<br>
TIME and all user-deﬁned data items have the values from the next event record<br>(EVTREC). This default can be overridden using the $BIND record.<br>
132<br>
<hr>
<A name=138></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$BIND<br>
EXAMPLE:<br>
The $BIND record is a convenience; it does nothing that cannot be accomplished with<br>abbreviated code. Suppose X is a user-deﬁned data item. The following three fragments<br>of code create a variable XB with the same values at calls with additional and lagged<br>doses that X would have if there were a $BIND record specifying the following for X.<br>
DOSE:<br>
IF (DOSTIM.EQ.0) THEN<br>
XB=X<br>
ELSE<br>
XB=DOSREC(X)<br>
ENDIF<br>
NEXT:<br>
XB=X<br>
LAST:<br>
IF (DOSTIM.EQ.0) THEN<br>
XB=X<br>
ENDIF<br>
In this case, when DOSTIM&gt;0, XB retains its value from the previous<br>call to PK.<br>
(See <b>bind example</b>).<br>
REFERENCES: Guide IV, section V.C.2 , V.C.5<br>
133<br>
<hr>
<A name=139></a>$CHAIN DETAILED DESCRIPTIONS<br>
Help Guide<br>
$CHAIN<br>
MEANING: Supplies initial estimates for an entire problem<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$CHAIN [FILE=ﬁlename]<br>
[FORMAT=<i>s</i>1] [ORDER=xxxf]<br>[NOTITLE=[0|1]] [NOLABEL=[0|1]]<br>[ISAMPLE=<i>n</i>][NSAMPLE=<i>n</i>]<br>[SEED=<i>n</i>]<br>[SELECT=<i>n</i>]<br>[RANMETHOD=[n|S|m] ]<br>[CTYPE=[0|1|2|3|4]]<br>[DF=<i>n</i>]<br>[DFS=<i>n</i>]<br>[IACCEPT=<i>n</i>]<br>
SAMPLE:<br>$CHAIN FILE=example1_previous.txt NSAMPLE=0 ISAMPLE=-1000000000<br>
DISCUSSION:<br>Option METHOD=CHAIN of the $ESTIMATION record will only set thetas, omegas,<br>and sigmas for initial values of the estimation process. Its scope is therefore limited in<br>that it will not impact the parameters used in simulating data for the Simulation step. To<br>introduce initial THETAs omegas and sigmas that will cover the entire scope of a given<br>problem, use the $CHAIN record.<br>
The options have the same meanings as for the $ESTIMATION record. Setting SEED or<br>RANMETHOD in a $CHAIN record does not propagate to $EST METHOD=CHAIN or<br>any other $EST record.<br>(See <b>$ESTIMATION_record_options</b>).<br>(See <b>$ESTIMATION_record</b>).<br>
REFERENCES: Guide Introduction_7<br>
134<br>
<hr>
<A name=140></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$CONTR<br>
$CONTR<br>
MEANING: Deﬁnes values for certain user-supplied routines<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$CONTR DATA=([<i>label</i>1|0] [<i>label</i>2|0] [<i>label</i>3|0])<br>The data item with the Jth label (J=1,2,3) and from the Ith observation record of an indi-<br>vidual record is available in DAT A(I,J). If 0 is used instead of a label, then a zero appears<br>in DAT A(I,J).<br>
SAMPLE:<br>$CONTR DATA=(0,TYPE)<br>
DISCUSSION:<br>Optional. Used only with user-supplied routines such as MIX and CONTR and<br>CCONTR that use data items stored in the DAT A array. This record gives labels (or syn-<br>onyms) deﬁned in the $INPUT record of one to three types of data items to be made<br>available to the subroutine(s) in the DAT A array. These routines are called with individ-<br>ual records. An array DAT A is available in NONMEM module ROCM_REAL and<br>changes value with each individual record.<br>
With the above sample $CONTR record, the following code might be present in a double<br>precision MIX routine. The code loops through the observation records of the NREC’th<br>individual record. For each of the NOBS observation records, the local variable TYPE is<br>given the value of the TYPE data item from that data record. The 0 in the sample is a<br>place-holder which causes the ﬁrst column in the DAT A array to be skipped. The value<br>of TYPE for the Ith observation record is therefore available in DAT A(I,2). The DATA<br>array is found in ROCM_REAL. NO is a constant giving the maximum number of obser-<br>vations per individual record. NOBS is the number of observations in the current indi-<br>vidual record. (See <b>sizes</b>).<br>
USE SIZES, ONLY: NO,DPSIZE<br>
USE ROCM_REAL, ONLY: DATA=&gt;RDATA<br>
USE ROCM_INT, ONLY: NOBS=&gt;NOBSIND2<br>
...<br>
INTEGER I<br>
REAL(KIND=DPSIZE) :: TYPE<br>
...<br>
DO 100 I=1,NOBS<br>
TYPE=DATA(I,2)<br>
...<br>
100 CONTINUE<br>
...<br>
REFERENCES: Guide IV, section III.B.4<br>
135<br>
<hr>
<A name=141></a>$COVARIANCE,$COVR DETAILED DESCRIPTIONS<br>
Help Guide<br>
$COVARIANCE,$COVR<br>
MEANING: Instructions for NONMEM Covariance Step<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$COVARIANCE [SPECIAL] [MATRIX=] [PRINT=[E][R][S]<br>
[COMPRESS]<br>[SLOW|<b>NOSLOW</b>|FAST]<br>[TOL=<i>n</i>] [ATOL=<i>n</i>]<br>[SIGL=<i>n</i>] [SIGLO=<i>n</i>]<br>[NOFCOV]<br>[PARAFILE=[ﬁlename|ON|OFF] [PARAFPRINT=<i>n</i>]<br>[THBND=<i>n</i>]<br>[SIRSAMPLE=<i>n</i>] [SIRNITER=<i>n</i>] [SIRCENTER=<i>n</i>]<br>[IACCEPT=<i>n</i>] [IACCEPTL=<i>n</i>]<br>[SIRDF=<i>n</i>] [RANMETHOD=[n|S|m|P] ]<br>[SIRPRINT=<i>n</i>] [FILE=ﬁlename] [FORMAT=s]<br>[SIRTHBND=<i>n</i>]<br>[PRECOND=<i>n</i>] [PRECONDS=TOS] [PFCOND=<i>n</i>] [PRETYPE=<i>n</i>]<br>[FPOSDEF=<i>n</i>]<br>[CHOLROFF=<i>n</i>] [KNUTHSUMOFF=<i>n</i>]<br>[RESUME]<br>[CONDITIONAL|UNCONDITIONAL]<br>[OMITTED]<br>
SAMPLE:<br>$COVARIANCE<br>
DISCUSSION:<br>Optional. Requests that the NONMEM Covariance Step be implemented. This step out-<br>puts: standard errors, covariance matrix, inverse covariance matrix, and the correlation<br>form of the covariance matrix. May also be coded $COVR.<br>
If $COV is speciﬁed, then for IMP, IMPMAP, and ITS methods, standard error informa-<br>tion will be supplied for every $EST statement. Standard error information for the classi-<br>cal methods (METHOD=0, METHOD=1) will be given only if they are the last estima-<br>tion method, and only if NOFCOV is not speciﬁed.<br>
OPTIONS:<br>
SPECIAL<br>
The special computation will be used in the Covariance Step with a recursive PRED<br>subroutine. A recursive PRED subroutine is such that, with single-subject data, the<br>PRED computation with a data record depends on information passed to it with <i>any<br></i>of the previous data records. This is the default when PREDPP is used.<br>
MATRIX=c<br>
Speciﬁes that the covariance matrix will be different from the default (<i>R</i>−1<i>SR</i>−1).<br>MATRIX=R requests that 2 times the inverse R matrix be used. MATRIX=S<br>requests that 4 times the inverse S matrix be used. (R and S are two matrices from<br>statistical theory, the Hessian and Cross-Product Gradient matrices, respectively.)<br>With MATRIX=R the standard errors will be more consistent with other nonlinear<br>regression software implementations. MATRIX=R should not be used with option<br>
136<br>
<hr>
<A name=142></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$COVARIANCE,$COVR<br>
SPECIAL.<br>MATRIX has no relevance to the Covariance step results for a BAYES method.<br>
PRINT=[E][R][S]<br>
Additional outputs will be printed besides the defaults. E: print the eigenvalues of<br>the correlation matrix. R: print the matrix .5*R. S: print the matrix .25*S.<br>PRINT=R (or S) is not needed with MATRIX=R (or S).<br>
COMPRESS<br>
Covariance Step arrays are printed in compressed format, even if their size is such<br>that NONMEM would normally print them in the usual format.<br>
SLOW<br>
Requests a slower method of computation. Required when either a mixture model<br>was used along with CENTERING on the $ESTIMATION record, or NUMERICAL<br>was used on the $ESTIMATION record. If not present, the option will be automati-<br>cally supplied in these two cases.<br>
<b>NOSLOW</b><br>
Requests a faster method of computation. This is the default (but see SLOW).<br>
FAST (NM74)<br>
This is equivalent to FAST for the $EST record. record. If $EST FAST is set, then<br>$COV will be set to FAST, unless SLOW or NOSLOW is speciﬁed.<br>
TOL=<i>n </i>(NM72)<br>
Tolerance. Used only with General Nonlinear (differential equation solver)<br>ADVAN’s. Sets NRD=TOL. By default, the value set on $SUBROUTINES record<br>(or $TOL or TOL subroutine) is used. If TOL is coded on $COVARIANCE, it<br>overides the default. With NONMEM 74, this feature is deprecated. A user-sup-<br>plied TOL subroutine should test NM_STEP and set NRD accordingly.<br>TOL has no relevance to the Covariance step results for a BAYES method.<br>
ATOL=<i>n </i>(NM72)<br>
Absolute tolerance. Used only with ADVAN9, ADVAN13, ADVAN14, and<br>ADVAN15, for which TOL is a relative tolerance. Sets ANRD=ATOL. The default<br>is 12 (that is, accuracy is 10**(-12)). Usually the problem runs quickly when using<br>this setting. On occasion, however, you may want to reduce ATOL (usually set it<br>equal to that of TOL), and improve speeds of up to 3 to 4 fold.<br>
By default, the value set on $SUBROUTINES record (or $TOL or TOL subroutine)<br>is used. If ATOL is coded on $ESTIMATION, it overrides the default for that step.<br>If ATOL is coded on $COVARIANCE, it overrides $ESTIMATION and/or the<br>default for that step. With NONMEM 74, this feature is deprecated. A user-sup-<br>plied TOL subroutine should test NM_STEP and set ANRD accordingly.<br>
SIGL=<i>n </i>SIGLO=<i>n </i>(NM72)<br>
These options may be used to specify different values for the Covariance step. The<br>step size for evaluating the R matrix (central difference second derivative) is set to<br>SIGL/4. If only the S matrix is evaluated (central difference ﬁrst derivative), the step<br>size is set to SIGL/3. SIGLO is the precision to which individual etas are optimized.<br>Classical NONMEM methods in particular often require a different signiﬁcant digits<br>level of evaluation (usually more stringent) during the Covariance step than during<br>Estimation Step. For example, during the Estimation step, NSIG=2, SIGL=6,<br>TOL=6 may be sufﬁcient, but during the Covariance step, you may need SIGL=12<br>TOL=12 to avoid positive deﬁniteness issues.<br>By default, values speciﬁed on the $ESTIMATION record are used.<br>
137<br>
<hr>
<A name=143></a>$COVARIANCE,$COVR DETAILED DESCRIPTIONS<br>
Help Guide<br>
(See <b>$ESTIMATION</b>).<br>SIGL and SIGLO have no relevance to the Covariance step results for a BAYES<br>method.<br>
NOFCOV (NM72)<br>
No $COV step for any classical estimation steps. This would be useful if you<br>wanted EM estimation analyses performed, and a ﬁnal FOCE analysis performed,<br>but did not want the program to spend time on standard error assessments for FOCE,<br>which can take a long time relative to the other methods.<br>
PARAFILE=ﬁlename<br>
Name of the &quot;parallel ﬁle&quot; (the parallelization proﬁle) that controls parallelization<br>(distributed computing). Default ﬁle name if not speciﬁed: parallel.pnm or paraﬁle<br>name speciﬁed on nmfe command.<br>PARAFILE=ON turns on parallelization for this $COVARIANCE record.<br>PARAFILE=OFF turns off parallelization for this $COVARIANCE record.<br>
PARAFPRINT=<i>n </i>(NM74)<br>
The print iteration intervals to the parallelization log ﬁle can be controlled by this<br>option during parallelization of the $COV step. See also $ESTIMATION record and<br>nmfe74 command. Default is PARAFPRINT=1.<br>
THBND=<i>n </i>(NM74)<br>
By default (THBND=0), any theta boundaries speciﬁed in the $THETA record<br>causes NONMEM to impose a non-linear transformation of the theta parameters so<br>that the transformed parameters may vary from -inﬁnity to inﬁnity. It does this with<br>logistic transformations. This is suitable during the estimation step, but it may be<br>desirable to turn this off for covariance assessment, and assess partial derivatives of<br>the objective function with respect to the thetas themselves, or some linear transfor-<br>mation of these thetas. Set THBND=1 to do this. If no lower or upper bounds are<br>given to thetas in $THETA record, this option has no impact.<br>
SIRSAMPLE=<i>n </i>(NM74)<br>
Option SIRSAMPLE requests the Sampling-Importance-Resampling algorithm<br>(SIR) (See NONMEM 74 Guide, &quot;Importance Sampling of the Variance-Covariance<br>of the Parameter Estimates&quot;). By default SIRSAMPLE=-1, so SIR process does not<br>occur. SIRSAMPLE should be set between 300 and 10000, to indicate the number<br>of random samples to be generated. This will produce SIRSAMPLE importance<br>samples, each of which will be placed in the raw output ﬁle. Utility programs ta-<br>ble_quant (frequency and quantile sorting) and table_resample (resampling) may be<br>used to analyze $COV Sampling-Importance-Resampling data.<br>
SIRNITER=<i>n </i>(NM74)<br>
The number of times SIR sampling should occur. Default is 1.<br>
SIRCENTER=<i>n </i>(NM74)<br>
Where the sampling (proposal) density is to be centered. On the ﬁrst iteration, the<br>mean of the sampling density is at the estimate. On subsequent iterations, the mean<br>of the sampling density is at the estimate (SIRCENTER=0) or at the mean of the<br>(transformed) samples of the previous iteration (SIRSAMPLE=1). Default is 0.<br>
IACCEPT=<i>n </i>(NM74)<br>
The acceptance ratio acts similarly to importance sampling in EM analysis. Default<br>is 1.<br>
IACCEPTL=<i>n </i>(NM74)<br>
IACCEPTL=0 (NM74) Default is 1. The IACCEPTL option performs the same as<br>
138<br>
<hr>
<A name=144></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$COVARIANCE,$COVR<br>
listed for IACCEPTL in &quot;Monte Carlo Importance Sampling EM&quot;. Default is 0.<br>
SIRDF=<i>n </i>(NM74)<br>
The proposal density is to be a t distribution with n degrees of freedom. Default is 0,<br>a normal density.<br>
RANMETHOD=[n|S|m|P] (NM74)<br>
See the corresponding option of the $ESTIMATION record for importance sampling<br>in EM analysis.<br>
SIRPRINT=<i>n </i>(NM74)<br>
Set the console print iterations interval. This does not impact the iterations listed in<br>the raw output ﬁle. Default SIRPRINT=0.<br>
FILE=ﬁlename (NM74)<br>
By default, the raw output ﬁle is whatever was listed in the $EST step, or root.ext,<br>where root is the root name of the control stream ﬁle. You can re-direct SIR sample<br>listings to an alternative ﬁle with this option.<br>
FORMAT=s (NM74)<br>
By default, the raw output ﬁle format is whatever was listed in the $EST step, or<br>s1PE12.5. You can change its format with the above option.<br>
SIRTHBND=<i>n </i>(NM74)<br>
As with the deterministic covariance assessment step, by default the transformed<br>parameters are sampled, so that no sample is below the $THETA lower bound speci-<br>ﬁcation, and no higher than the $THETA upper bound speciﬁcation. To allow a<br>boundariless search in the original theta domain, set SIRTHBND=1. You should also<br>set THBND=1, so that the deterministc covariance matrix used as the proposal den-<br>sity is also not hindered or contorted by the boundaries. Default is the value of<br>THBND, which in turn is 0 by default.<br>
PRECOND=<i>n </i>(NM74)<br>
Options PRECOND through PRETYPE affect the preconditioning of the R Matrix<br>(See the NONMEM 74 Guide, &quot;Preconditioning the R Matrix to Improve Precision<br>and Success Rate of $COV Step&quot;). By default, PRECOND (Preconditioning<br>cycles&quot;) is 0, and no preconditioning of the R matrix is performed. When PRE-<br>COND=n, then up to n preconditioning cycles are performed. This is used in combi-<br>nation with the PFCOND setting.<br>
PRECONDS=TOS (NM74)<br>
By default, if preconditioning is performed, it is done on Thetas (T), Omegas (O),<br>and Sigmas(S). Specify PRECONDS (Preconditioning types)=T to do only thetas,<br>PRECONDS=TO to do only thetas and omegas, etc.<br>
PFCON=<i>n </i>(NM74)<br>
PFCOND means ’forced’ precondition cycles. Preconditioning occurs exactly<br>PFCOND times, without testing if the R matrix is positive deﬁnite or not on each<br>preconditioning cycle. On the remaining PRECOND-PFCOND cycles, the R matrix<br>is tested for positive deﬁniteness, and upon success, will terminate the precondition-<br>ing cycles. Default is PFCOND=0.<br>
PRETYPE=<i>n </i>(NM74)<br>
By default PRETYPE(preconditioning type)=0 and the R matrix corrector is<br>V*square_root(eigenvalue). If you set PRETYPE=1, then the corrector is<br>V*square_root(eigenvalue)*Vtranspose. If you set PRETYPE=2, then the corrector<br>is the correlation version of PRETYPE=1.<br>
139<br>
<hr>
<A name=145></a>$COVARIANCE,$COVR DETAILED DESCRIPTIONS<br>
Help Guide<br>
FPOSDEF=<i>n </i>(NM74)<br>
By default FPOSDEF(forced positive deﬁnite)=0. If FPOSDEF=1, then if the Rma-<br>trix is not positive deﬁnite, it will be forced positive deﬁnite. If PRECOND&gt;0, this<br>will occur after the PRECONDth try.<br>
CHOLROFF=<i>n </i>(NM74)<br>
If CHOLROFF is set to 1, then one part of the R matrix evaluation will be evaluated<br>in the manner of earlier versions of NONMEM. This is strictly for comparison with<br>earlier versions for diagnostic purposes. Default is 0.<br>
KNUTHSUMOFF=<i>n </i>(NM74)<br>
In NONMEM 7.4, the Knuth summing method is used to allow the most accurate<br>summation of individual objective function values, even with large variations in val-<br>ues of the individual objective function. To turn this off, and allow a standard sum-<br>mation (not recommended except for comparison purposes from earlier versions),<br>set KNUTHSUMOFF=1. If KNUTHSUMOFF was set in the $EST step, but not in<br>the $COV step, the KNUTHSUMOFF value of the last $EST record will be used.<br>Default is 0.<br>
CONDITIONAL<br>
The Covariance Step is implemented, but only when the Estimation Step terminates<br>successfully (in this run or in a run continued via $MSFI). This is the default.<br>
UNCONDITIONAL<br>
The Covariance Step is implemented regardless of how the Estimation Step termi-<br>nates (in this run or in a run continued via $MSFI).<br>
RESUME (NM73)<br>
If MSFO=msﬁle was speciﬁed in the Estimation Step for the FO/FOCE/Laplace<br>method and analysis was interrupted during the Covariance Step, then the Covari-<br>ance Step may be resumed where it was interrupted in a subsequent problem. Use<br>the $MSFI record to specify the MSFO ﬁle of the interrupted analysis, and the<br>RESUME option of the $COV record:<br>
$MSFI=msfile<br>
...<br>
$COV RESUME<br>
OMITTED<br>
The Covariance Step is not implemented.<br>
EXAMPLE:<br>$COV UNCONDITIONAL TOL=10 SIGL=10 SIGLO=11<br>
REFERENCES: Guide IV, section III.B.15<br>REFERENCES: Guide V, section 9.4.2 , 10.6<br>
140<br>
<hr>
<A name=146></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$DAT A<br>
$DAT A<br>
MEANING: Describes the NM-TRAN data set<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$DATA [ﬁlename|*] [(format)] [IGNORE=<i>c</i>1] [NULL=<i>c</i>2]<br>
[IGNORE=(list)...|ACCEPT=(list)...]<br>[<b>NOWIDE</b>|WIDE] [CHECKOUT]<br>[RECORDS=<i>n</i>1|RECORDS=label]<br>[LRECL=<i>n</i>2] [<b>NOREWIND</b>|REWIND]<br>[NOOPEN] [LAST20=<i>n</i>3] [TRANSLATE=(list)]<br>[BLANKOK]<br>[MISDAT=@r@...]<br>
SAMPLE:<br>$DATA DATAFILE<br>
DISCUSSION:<br>This record speciﬁes the data set to be used. It is required with the ﬁrst problem speciﬁ-<br>cation. It must precede any other NM-TRAN control record that refers to speciﬁc data<br>item types. May also be coded $INFILE.<br>
Optional with the second or subsequent problem speciﬁcations. If omitted, NONMEM<br>re-uses the data set from the previous problem (which will include any modiﬁcations<br>made via transgeneration, e.g., via use of NONMEM’s PASS, or via simulation).<br>
OPTIONS:<br>
filename<br>
Name of the ﬁle containing the data set. Must be the ﬁrst option. If it contains com-<br>mas, semicolons, or parentheses, then it must be surrounded by single quotes ’ or<br>double quotes &quot;. Filename may also contain equal signs if it is enclosed in quotes.<br>If the ﬁle is opened by NM-TRAN, ﬁlename may contain embedded spaces if it is<br>enclosed in quotes, and may contain at most 80 characters. If the ﬁle is opened by<br>NONMEM, the ﬁlename may not contain embedded spaces, and may contain at<br>most 71 characters. If ﬁlename is the same as any option of the $DAT A record, it<br>must be enclosed in quotes.<br>
<b>* </b>may be coded in a problem subsequent to the ﬁrst. This has the same effect as<br>omitting the $DAT A record (NONMEM is told to re-use the previous data set), but<br>allows the CHECKOUT option to be included. With <b>*</b>, no other option may be<br>included.<br>
(format)<br>
FORTRAN format speciﬁcation to be used to read the data. Format codes F, E, and<br>X may be used, but not I. When a format is provided, the label DROP cannot be<br>used on the $INPUT record and options WIDE and NULL may not be coded. If<br>omitted, NM-TRAN will generate a suitable FORMAT speciﬁcation.<br>
RECORDS=<i>n</i>1<br>
The number of records to be read from the NM-TRAN data set. Comment records<br>are not counted. If NM-TRAN does not drop any records from its data set (see<br>IGNORE list and ACCEPT list), then <i>n</i>1 is also the number of records written to the<br>
141<br>
<hr>
<A name=147></a>$DAT A<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
NONMEM data set. If NM-TRAN drops records, then the total number of records<br>written to the NONMEM data set is <i>n</i>1 minus the number of dropped records. If<br>omitted, the records written to the NONMEM data set are all the records in the NM-<br>TRAN data set up to the end-of-ﬁle (or up to a NONMEM FINISH record) minus<br>the number of comment and dropped records. May also be coded NRECORDS,<br>RECS, or NRECS.<br>
If the option is coded as RECORDS=label, where label is a data item label, NM-<br>TRAN understands the data records for the problem to start with the ﬁrst data record<br>of the NM-TRAN data set (at the place where the ﬁle is positioned before data<br>records are read; see the NOREWIND option), and to include as well, those and<br>only those subsequent contiguous data records having the same value of the data<br>item as does the ﬁrst record. It counts the total number of these data records, minus<br>any comment or dropped records, and puts this number in the NONMEM control<br>ﬁle.<br>
In particular, the ID label may be used (or alternatively, the option may be coded<br>RECORDS=IR, RECORDS=INDREC, or RECORDS=INDIVIDUALRECORD). If a<br>label other than ID is used, the $INPUT record must precede the $DAT A record. If<br>the data are single-subject data, the ID data items used to determine the data records<br>for the problem are those labeled ID (not .ID.).<br>
If there is more than one problem speciﬁcation with a $DAT A record that includes<br>an option of the form RECORDS=label, then either none of these $DAT A records<br>may also include a format speciﬁcation, or all of them must include the same format<br>speciﬁcation. (See records=id).<br>
LRECL=<i>n</i>2<br>
The number of characters in a logical record. Needed for certain operating systems<br>(e.g., IBM/CMS).<br>
IGNORE=<i>c</i>1<br>
Speciﬁes that any data record having the character <i>c</i>1 in column 1 should be ignored,<br>i.e., these records are not included in the NONMEM data set. This allows comment<br>records to be included in the NM-TRAN data set. In general, records having the<br>character <i>c</i>1 in column 1 will be called &quot;comment records&quot;.<br>Also permitted: IGNORE=’c’ or IGNORE=&quot;c&quot;, where c may be any character<br>except space. IGNORE=# is the default. That is, in the absence of IGNORE option,<br>any record whose ﬁrst character is # is treated as a comment record.<br>
IGNORE=@ signiﬁes that any data record having an alphabetic character or @ as its<br>ﬁrst non-blank character (not just in column 1) should be ignored. Alphabetic char-<br>acters are the letters A-Z and a-z. This permits a table ﬁle having header lines to be<br>used as an NM-TRAN data set.<br>
IGNORE=(list)<br>
&quot;List&quot; is a list of one or more data item labels, with logical operators and values, of<br>the form &quot;label=value&quot;, &quot;label.EQ.value&quot;, &quot;label.NE.value&quot;, &quot;label.GT.value&quot;,<br>&quot;label.GE.value&quot;, &quot;label.LT.value&quot;, and &quot;label.LE.value&quot;. (Fortran 90 logical opera-<br>tors such as ’==’ ’/=’ ’&lt;’ ’&lt;=’ ’&gt;’ ’&gt;=’ &quot; may also be used.) Thus, the following are<br>identical: &quot;label=value&quot;,&quot;label==value&quot;,&quot;label.EQ.value&quot;. With NONMEM 7.3,<br>&quot;label.NEN.value&quot; and &quot;label.EQN.value&quot; are permitted. (There is no Fortran 90<br>operator for this comparison.) If the logical operator is omitted, the default is &quot;=&quot;.<br>With each data record, the value of the data item with the given label and the value<br>in the list are compared according to the logical operator, and if result is &quot;true&quot;, the<br>
142<br>
<hr>
<A name=148></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$DAT A<br>
record is ignored, i.e. it is not included in the NONMEM data set (see example<br>below). Such records are called &quot;dropped records&quot;. With &quot;=&quot;, &quot;==&quot;, &quot;/=’, &quot;.EQ.&quot; and<br>&quot;.NE.&quot;, the value in the data record and the value in the list are compared as charac-<br>ter strings. Otherwise, they are converted to numeric and compared numerically.<br>(This is the case with .NEN. and .EQN.) This comparison is made prior to time<br>translation. Hence, the TIME item cannot be compared numerically if it contains<br>non-numeric characters such as &quot;:&quot;.<br>
Note: if the data ﬁle is a table ﬁle from a previous NONMEM run, values that had<br>been integers (0,1,..) in the original data ﬁle will be real values (0.000E+00,<br>1.000E+00, ...) in the table ﬁle. A comparison for equality or inequality should now<br>be for the real value. E.g.<br>IGNORE=(OCC==1.000E+00).<br>
A data item label along with a logical operator and value is called a condition. A list<br>may contain several conditions; these should be separated by commas, and the list<br>should be enclosed in parentheses. Up to 100 different conditions altogether can be<br>speciﬁed. Multiple IGNORE options with different lists may be used. A list may<br>span one or more NM-TRAN records. The use of &quot;=&quot; after IGNORE is optional, but<br>parentheses are required with this form of IGNORE. Values may be alphabetic or<br>numeric, and may optionally be surrounded by single quotes ’ or double quotes &quot;.<br>Quotes are required if a value contains special characters such as =. However, a<br>value may not contain spaces or commas. No format speciﬁcation is permitted with<br>this form of IGNORE.<br>
A data item type may be dropped from the NONMEM data set by means of the<br>DROP or SKIP synonym on the $INPUT record, after records are dropped due to a<br>condition based on the data item type. E.g.,<br>
$INPUT ... GEN=SKIP ...<br>
$DATA file IGNORE=(GEN=’M’)<br>
Records having GEN equal to ’M’ will be dropped, and the GEN data item type will<br>then be omitted from the NONMEM data set. A dropped data item may be any<br>alphanumeric string (without a data item delimiter - a blank or a comma).<br>
If there is more than one condition, then records satisfying at least one of these con-<br>ditions will be dropped. In effect, the conditions for dropping a record are con-<br>nected by the implied conjunction &quot;.OR.&quot;. E.g.<br>
IGNORE=(GEN.EQ.1,AGE.GT.60).<br>
Records having GEN equal to 1 or AGE greater than 60 are dropped. All others are<br>accepted.<br>
ACCEPT=(list)<br>
The ACCEPT list option is identical to the IGNORE list option, except that it speci-<br>ﬁes conditions for acceptance of records. An ACCEPT list cannot be used together<br>with an IGNORE list. E.g.<br>
ACCEPT=(GEN.EQ.1,AGE.GT.60).<br>
Records having GEN equal to 1 or AGE greater than 60 are accepted. All others are<br>dropped.<br>
Suppose it is desired that records be dropped that satisfy the logical &quot;.AND.&quot; of sev-<br>eral conditions. This can be implemented by using an ACCEPT list with the nega-<br>tions of the conditions. For example, suppose that records to be ignored are those<br>having GEN=1 .AND. AGE &gt; 60. This may be done as follows:<br>ACCEPT=(GEN.NE.1,AGE.LE.60)<br>
143<br>
<hr>
<A name=149></a>$DAT A<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
NULL=<i>c</i>2<br>
Speciﬁes that null data items in the NM-TRAN data set are to be replaced in the<br>NONMEM data set by the character <i>c</i>2. E.g., NULL=0 or NULL=<b>.</b>.<br>Null data items consist of a single dot (.) or consecutive commas or consecutive tab<br>characters. <i>c</i>2 may be any character except space (&quot; &quot;) or semicolon (&quot;;&quot;).<br>Also permitted: NULL=’c’ or NULL=&quot;c&quot;, where c may be any character.<br>If this option is omitted, NM-TRAN replaces each null with a space.<br>
NOWIDE<br>
Requests that NM-TRAN attempt to limit FDAT A to 80-character records. Space<br>between adjacent columns may be suppressed and multi-line records may be gener-<br>ated. This is the default.<br>
WIDE<br>
Requests that FDAT A contain single-line records, and that at least one space separate<br>columns. (Records in FDAT A will never be wider than 300 characters.) With this<br>option, there will be no FINISH (FIN) record in the NONMEM data set.<br>
NOREWIND|REWIND<br>
With the ﬁrst problem speciﬁcation in a control stream, the ﬁle is positioned at its<br>initial point so that the ﬁrst NM-TRAN data set in the ﬁle is used. The options<br>REWIND and NOREWIND apply only with a $DAT A record in a subsequent prob-<br>lem speciﬁcation, and only when the ﬁle named on the record is the same as that<br>speciﬁed for the previous problem. When the ﬁle named on the record is different<br>from that speciﬁed for the previous problem, the ﬁle is (re)positioned at its initial<br>point so that the ﬁrst NM-TRAN data set in the ﬁle is used.<br>REWIND: Reposition the ﬁle at its intial point so that the ﬁrst NM-TRAN data set<br>in the ﬁle is re-used.<br>(Whether the ﬁle input to NONMEM itself will be repositioned depends on whether<br>this ﬁle is FDAT A or is one named in the $DAT A record; see NONMEM Users<br>Guide, Part IV for a complete explanation.)<br>NOREWIND: Leave the ﬁle at its current position so that the next NM-TRAN data<br>set in the ﬁle is used. The $DAT A record with the previous problem speciﬁcation<br>must have included the RECORDS option (or a FINISH record must have termi-<br>nated the data set used in the previous problem), so that NM-TRAN did not read to a<br>physical end-of-ﬁle. This is the default.<br>
CHECKOUT<br>
Requests that NONMEM implement the data checkout mode, in which the PRED<br>routine is not called and predictions, residuals, weighted residuals and the objective<br>function are not computed.<br>May also be coded CHECKDATA. No tasks other than $TABLE or $SCAT can be<br>speciﬁed.<br>
NOOPEN<br>
NM-TRAN will not open the named data ﬁle. This permits the data ﬁle to be cre-<br>ated by one problem and used in a subsequent problem of the same run. May not be<br>used with options IGNORE, DROP, or when data items ID, MDV, or EVID must be<br>generated by NM-TRAN. With NOOPEN, a format speciﬁcation is required. No<br>day-time translation takes place.<br>
LAST20=<i>n</i>3<br>
Override the LAST20 constant in resource/TRGLOBAL.f90 (default: 50).<br>One or two digit years &gt; LAST20 are assumed to be in the 1900’s,<br>
144<br>
<hr>
<A name=150></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$DAT A<br>
One or two digit years &lt;= LAST20 are assumed to be in the 2000’s.<br>E.g,. suppose LAST20=50. Then two digit years are interpreted as follows:<br>
00-50 = 2000-2050<br>51-99 = 1951-1999<br>
LAST20=-1 can be used when two digit years span the year 2051. All two digit<br>years will be assumed to be in the same century. If year is recorded with four digits,<br>it is always processed correctly and the value of LAST20 is of no consequence.<br>
TRANSLATE=(list)<br>
&quot;list&quot; describes modiﬁcations to be made to the contents of the data ﬁle. It may con-<br>tain one of:<br>TIME/F, TIME/F/D<br>and/or one of<br>II/F, II/F/D<br>
F (&quot;factor&quot;) may be an integer or a real value. If F is a real number, the translated<br>value in FDAT A will have the same number of digits after the decimal point. If F is<br>an integer and D is omitted, there will be 2 digits. Alternately, the number of digits<br>may be speciﬁed explicitly by D (&quot;digits&quot;). If D is a real number, it is truncated to<br>integer. If D is speciﬁed as 0, it defaults to 2. The maximum value of D is 12. The<br>number of digits that may be requested in F is limited by the precision of the com-<br>puter.<br>
For example, either of the following can be used to request values of TIME in<br>FDAT A that have 4 digits to the right of the decimal point:<br>TIME/1.0000<br>
TIME/1/4<br>
Another example is<br>II/0.01/6<br>which divides II values by 0.01, and writes 6 digits to the right of the decimal point.<br>
If F is speciﬁed as &quot;24&quot; (or 24.0..), the options involving TIME (II) can be used to<br>convert the units of time (of the steady-state interval) from hours to days. The TIME<br>(II) data item is ﬁrst processed as if the option were not present. Then the resulting<br>value is divided by F.<br>
Note: The value of TIME is divided by F, whether or not day-time translation occurs<br>(i.e., whether or not relative times are being computed by NM-TRAN). Similarly,<br>the value of II is divided by F whether or not &quot;:&quot; appears in any II data value.<br>
BLANKOK<br>
Speciﬁes that blank lines are permitted in the NM-TRAN data set. With all versions<br>prior to NONMEM VI 2.0 a blank line was permitted, and was copied to the NON-<br>MEM data set. A warning message was issued. With later versions, NM-TRAN<br>stops with an error message when there is a blank line in the NM-TRAN data set.<br>Option BLANKOK restores the previous behavior. There is no abbreviation.<br>BLANKOK must be coded in full.<br>
MISDAT=@r@ (NM74)<br>
A numerical value indicating a missing data value in the data set, which is displayed<br>on $TABLE table outputs, but is safely interpreted as 0 by other steps of NONMEM.<br>May be used up to 20 times.<br>Example: $DATA mydatafile MISDAT=1.0E-99 MISDAT=1.0E-102.<br>
Another change in NONMEM VI 2.0 is that tab characters (and other characters that are<br>smaller than blank in the computer’s collating sequence, such as carriage return ˆM) are<br>
145<br>
<hr>
<A name=151></a>$DAT A<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
permitted in NM-TRAN input ﬁles. In the NM-TRAN data set they are treated like com-<br>mas, i.e., as ﬁeld delimiters. In the NM-TRAN control stream they are converted to spa-<br>ces. They are left unchanged in verbatim code. With NONMEM 7, the last non-blank<br>character on the line is replaced by a space if it is a low-value character.<br>
Note: The character &quot;:&quot; in TIME or II data items requests day-time translation of TIME<br>or II values. These values must have the form hh:mm (i.e., hours:minutes). With NON-<br>MEM 7.3, values may also have the form hh:mm:ss (i.e., hours:minutes:seconds).<br>(See <b>Guide IV, section II.C.2</b>)<br>
REFERENCES: Guide IV, section III.B.5<br>REFERENCES: Guide V, section 6.4<br>
146<br>
<hr>
<A name=152></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$DEFAULT<br>
$DEFAULT<br>
MEANING: Speciﬁes certain defaults for NONMEM<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$DEFAULT [NOSUB=[-1|0|1]]<br>
SAMPLE:<br>$DEFAULT NOSUB=1<br>
DISCUSSION:<br>$DEFAULT is optional. If present, it must appear following $PROB<br>
Speciﬁes certain defaults for NONMEM. If more than one $DEFAULT record is present<br>in a given problem, the one used by NONMEM is the last one in the problem.<br>
OPTIONS:<br>
NOSUB=[-1|0|1]<br>
With NOSUB=0, label substitution will be performed for all tasks in the problem.<br>This is the default.<br>(See <b>$ABBREVIATED</b>).<br>With NOSUB=1, label substitution will not be performed.<br>With NOSUB=-1, rev ert to NONMEM default, which is to treat -1 as a 0.<br>
If the NOSUB option is also speciﬁed on a task speciﬁcation record ($TABLE,<br>$SCATTER), then this value of NOSUB applies only for the current task. When<br>speﬁcied on a $EST record, the usual rule for options apply, in which the option<br>varies carries into the next $EST record in the problem unless otherwise re-speciﬁed.<br>
May also be coded $DEFAULTS.<br>
REFERENCES: Guide Introduction_7<br>
147<br>
<hr>
<A name=153></a>$DES DETAILED DESCRIPTIONS<br>
Help Guide<br>
$DES<br>
MEANING: Marks the beginning of abbreviated code for the DES routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$DES<br>abbreviated code<br>
SAMPLE:<br>
Suppose differential equations were used for ADVAN2, rather than the analytic solution.<br>The $DES block would be as follows:<br>$DES<br>
DADT(1)=-P(3)*A(1)<br>
DADT(2)=P(3)*A(1)-P(1)*A(2)<br>
DISCUSSION:<br>The $DES record is used to compute differential equations. It is used with PREDPP’s<br>general non-linear models (ADVAN6, ADVAN8, ADVAN9, ADVAN13, ADVAN14,<br>ADVAN15). General rules for abbreviated code are documented elsewhere<br>(See <b>abbreviated code</b>).<br>Speciﬁc rules follow.<br>
ASSIGNMENT AND CONDITIONAL STATEMENTS<br>
Left-hand quantities in assignment statements:<br>
DADT(1), DADT(2), ... (Required. Derivative of each compartment amount with<br>respect to time.)<br>
It is important to note that PREDPP itself adds in the rates for any infusions<br>that may be active. It is possible to introduce endogenous drug into a compart-<br>ment by explicit terms in a differential equation, rather than by PREDPP dose<br>ev ent records. Drug introduced in this manner is not included by PREDPP in<br>the computation of the output compartment.<br>
DES-deﬁned (i.e., PRED-deﬁned) items.<br>
Right-hand quantities in assignment statement and in conditions:<br>
A(1), A(2), ... (Current compartment amounts; may be random variables.)<br>
P(1), P(2), ... (Post-translation explicit basic PK parameters; may be random<br>variables.)<br>
PK-deﬁned items (Post-translation implicit basic PK parameters; may be random<br>variables.)<br>
T (Time; may be random variable. T takes values continuously over an integration<br>interval.) (Note that T may take values that are larger than the ending time of the<br>interval.)<br>
148<br>
<hr>
<A name=154></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$DES<br>
DES-deﬁned items that appeared earlier as left-hand quantities in $DES.<br>
Data item labels speciﬁed on the $INPUT statement may be used explicitly in DES<br>and $DES abbbreviated code (rather than obtained as PK parameters). This may<br>improve run time. As with $PK, values are those of the current event record (the<br>ev ent record to which the system is being advanced).<br>
THETA(n).<br>
Fortran functions that are continuous, such as SIN and COS, may be used. The INT,<br>MOD, and ABS functions (or other functions that introduce a discontinuity) should not<br>be used in the $DES block. Instead, use model event times MTIME in the $PK block,<br>and either set ﬂag variables in $PK that can be tested in $DES, or use MPAST in the<br>$DES block. See Appendix 3 of Guide VI PREDPP. Sev eral examples are available for<br>the use of MTIME with $DES.<br>(See <b>mtime</b>, <b>model time examples</b>).<br>(See <b>Examples Using MTIME to Model Periodic Discontinuities in $DES</b>).<br>See step_circexa.ctl in the NONMEM examples directory.<br>See idr_circexa.ctl in the NONMEM examples directory.<br>
Global Variables in Modules<br>Certain variables in FORTRAN Modules can be used.<br>(See <b>Variables_in_Modules</b>)<br>The following are of particular interest.<br>
DOSTIM<br>
DOSTIM is the time of a lagged dose or additional dose to which the system is being<br>advanced. Abbreviated code in $DES may test DOSTIM. It may use DOSTIM on the<br>right, unless DOSTIM is a random variable. In this case, it may be used on the right in<br>a $PK block to deﬁne a random variable which may in turn be used on the right in the<br>$DES block.<br>
DOSREC<br>
DOSREC is the dose record corresponding to the dose entering at DOSTIM. Abbrevi-<br>ated code in $AES may test items in DOSREC in a logical condition, and DOSREC<br>may always be used on the right.<br>
ISFINL<br>
During simulation or a copying pass, and during the advance to a particular time (event<br>or non-event time), ISFINL=1 at a ﬁnal call to DES at that time. Otherwise,<br>ISFINL=0.<br>
Forbidden Variable Names:<br>
IR DA DP E(n) ETA(n) EPS(n) ERR(n)<br>
PSEUDO ASSIGNMENT STATEMENTS<br>
COMRES=-1<br>
RECORD ORDER:<br>
Follows $SUBROUTINES $INPUT $MODEL $PK<br>
149<br>
<hr>
<A name=155></a>$DES DETAILED DESCRIPTIONS<br>
Help Guide<br>
DISPLAYED VALUES<br>
DES-deﬁned variables may be listed for display in $TABLE or $SCATTER. The values<br>displayed for the ﬁrst event record of the data set are 0’s. The values displayed for the<br>ﬁrst event record of subsequent individuals are those from the last event record of the pre-<br>vious individual. This is because there is no call to DES with the ﬁrst event record of the<br>individual record, or with any other event record with the same value of TIME. NM-<br>TRAN provides a warning message.<br>
(WARNING 48) DES-DEFINED ITEMS ARE COMPUTED ONLY WHEN EVENT TIME<br>
INCREASES. E.G., DISPLAYED VALUES ASSOCIATED WITH THE FIRST EVENT RECORD<br>
OF AN INDIVIDUAL RECORD ARE COMPUTED WITH (THE LAST ADVANCE TO) AN EVENT<br>
TIME OF THE PRIOR INDIVIDUAL RECORD.<br>
The values displayed for event records other than the ﬁrst are evaluated at the event time<br>(as are all other displayed items such as PK-deﬁned values and data record items).<br>
Note that multiple calls to DES are associated with each event record. Some (including<br>the ﬁnal call during integration) may have a value of T that is larger than the end time of<br>the integration interval. When NONMEM is performing simulation or a copying pass<br>(COMACT&gt;0), DES is called immediately after the advance to an event time or non-<br>ev ent time, with a value of T equal to this time, so that displayed values are the ﬁnal value<br>of T. Global variable ISFINL is set by PREDPP to 1 on this ﬁnal call to DES. ISFINL<br>can be tested on a WRITE statement if such statements are used in DES.<br>
(See <b>des</b>, <b>advan6</b>, <b>advan8</b>, <b>advan9</b>).<br>
REFERENCES: Guide IV, section V.C.7<br>REFERENCES: Guide VI, section VI.C<br>
150<br>
<hr>
<A name=156></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ERROR<br>
$ERROR<br>
MEANING: Marks the beginning of abbreviated code for the ERROR routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$ERROR<br>abbreviated code<br>
DISCUSSION:<br>The $ERROR record is used to model intra-individual error in observed values. It is used<br>with PREDPP. It can also be used to to convert predictions from PREDPP, i.e., scaled<br>drug amounts, to other types of predictions (for example, to obtain the prediction of a<br>drug effect as a function of concentration, in a pharmacodynamic study). General rules<br>for abbreviated code are documented elsewhere (See <b>abbreviated code</b>). Speciﬁc rules<br>follow.<br>
ASSIGNMENT AND CONDITIONAL STATEMENTS<br>
Left-hand quantities in assignment statements:<br>
Y (Required. The modeled value for the dependent variable under the statistical<br>model.)<br>
ERROR-deﬁned (i.e., PRED-deﬁned) items.<br>
Left-hand quantities from the $PK block, if they are not random variables <b>and<br></b>neither $PK nor $ERROR include the COMRES=-1 pseudo-assignment state-<br>ment.<br>
Right-hand quantities in assignment statement and in conditions:<br>
F (Required. The value of the scaled drug amount in the observation compartment.)<br>
Data item labels speciﬁed on the $INPUT statement.<br>
THETA(n)<br>
ETA(n) (Required if the data are single-subject, and can be coded ERR(n).<br>Optional if the data are population.)<br>
EPS(n) (Required if the data are population, and can be coded ERR(n).)<br>
ERROR-deﬁned items that appeared earlier as left-hand quantities. This includes Y.<br>
Left-hand quantities from the $PK block, if neither $PK nor $ERROR include the<br>COMRES=-1 pseudo-assignment statement.<br>
NEWIND<br>
Same as the NEWIND argument passed by NONMEM to PREDPP.<br>NEWIND=0: First record of the data set. THETA value may differ from value at<br>last call with this record.<br>
151<br>
<hr>
<A name=157></a>$ERROR DETAILED DESCRIPTIONS<br>
Help Guide<br>
NEWIND=1: First record of the data set, THETA value does not differ from value<br>at last call with this record, and PRED is nonrecursive (see <b>I_REC</b>), or,<br>First record of a subsequent individual record.<br>NEWIND=2: Subsequent data record of an individual record.<br>
NEWL2<br>
NEWL2=1: First record of an L2 record.<br>NEWL2=2: Otherwise.<br>
ICALL<br>
Same as the ICALL argument passed by NONMEM to PREDPP.<br>ICALL=1: Initialization.<br>ICALL=2: Normal call.<br>ICALL=3: Finalization.<br>ICALL=4: Simulation.<br>ICALL=5: Expectation.<br>ICALL=6: Data Average.<br>Special rules apply to blocks of abbreviated code that are executed when ICALL<br>is not 2.<br>(See <b>Initialization-Finalization block</b>, <b>Simulation block</b>).<br>(See <b>Expectation block</b>, <b>Data_Average block</b>).<br>
Global Variables in Modules<br>
Certain variables in FORTRAN Modules can be used. (See <b>Variables_in_modules</b>)<br>The following are of particular interest.<br>
A(n) (Amount in compartment n.) (See <b>State Vector A</b>)<br>
Note: If there is no verbatim code and no explicit use of a subscripted variable A<br>in the $ERROR block, then the symbol A can be used as a data item label or as a<br>name of an ERROR-deﬁned item.<br>
Forbidden Variable Names:<br>
IDEF IREV EVTREC NVNT INDXS G HH DADT(n) E(n) P(n)<br>
PSEUDO ASSIGNMENT STATEMENTS<br>
COMRES=-1<br>
CALLFL=-1: Call with every event record.<br>CALLFL=0: Call with every observation record.<br>CALLFL=1: Call once per individual record.<br>
Of the last three, CALLFL=-1 is the default, except when the abbreviated code con-<br>sists of one line specifying a simple additive or proportional error model, and no verba-<br>tim code is present.<br>CALLFL=2: Call once per problem.<br>In effect, this is supplied by NM-TRAN for the simple error models, but it cannot be<br>speciﬁed explicitly in the $ERROR record.<br>(See <b>callﬂ</b>).<br>
Pseudo-assignments statements may be enclosed in parentheses. If two of them are<br>present in the same set of parentheses, separate them with a semicolon. A calling pro-<br>tocol phrase may be used within parentheses instead of a pseudo-assignment statement,<br>and then either upper or lower case may be used . E.g.,<br>$ERROR (ONCE PER IR)<br>
; same as CALLFL=1<br>
152<br>
<hr>
<A name=158></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ERROR<br>
$ERROR (ONLY OBSERVATIONS) ; same as CALLFL=0<br>
$ERROR (EVERY EVENT)<br>
; same as CALLFL=-1 (default)<br>
RECORD ORDER:<br>
Follows $SUBROUTINES and $INPUT<br>Follows $MODEL (if a general model such as ADVAN6 is used)<br>Follows $PK (if present)<br>
REFERENCES: Guide IV, section V.C.6<br>REFERENCES: Guide V, section 8<br>REFERENCES: Guide VI, section IV<br>
153<br>
<hr>
<A name=159></a>$ESTIMATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ESTIMATION RECORD OPTIONS<br>
MEANING: Instructions for the NONMEM Estimation Step<br>CONTEXT: NM-TRAN Control Record<br>
List of $ESTIMATION Record Options and Their Relevance to Various Methods<br>
Classical methods are the First order method (METHOD=0 or METHOD=FO), the Condi-<br>tional method (METHOD=1<br>
or<br>
METHOD=FOCE)<br>
and the Hybrid method<br>
(METHOD=HYBRID). All other methods are EM (Expectation-Maximization) / Bayesian<br>methods and are new to NONMEM 7.<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
-2LL X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
ATOL +<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
AUTO X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
CALPHA X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
CENTERING X<br>
CINTERVAL X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
CITER/CNSAMP X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
CONDITIONAL X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
CONSTRAIN X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
CTYPE (CTYPE 4) X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
DERCONT X<br>
X<br>
X<br>
 <br>
X<br>
DF X<br>
X<br>
DFS(CHAIN only)<br>
EONLY X<br>
X<br>
X<br>
 <br>
X<br>
ETABARCHECK X<br>
ETADER X<br>
X<br>
X<br>
X<br>
ETASAMPLES X<br>
X<br>
X<br>
ETASTYPE X X<br>
X<br>
X<br>
X<br>
X<br>
FILE X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
FNLETA X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
FORMAT/DELIM X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
FPARAFILE X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
GRD X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
GRDQ X<br>
X<br>
GRID(Stieltjes) X<br>
HYBRID X<br>
IACCEPT X<br>
X<br>
X<br>
X<br>
X<br>
IACCEPTL X<br>
X<br>
INTERACTION X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
IKAPPA X<br>
ISAMPEND X<br>
X<br>
X<br>
 <br>
X<br>
ISAMPLE X<br>
X<br>
X<br>
ISAMPLE_M1 X<br>
X<br>
X<br>
ISAMPLE_M1A X<br>
X<br>
X<br>
ISAMPLE_M1B X<br>
X<br>
X<br>
ISAMPLE_M2 X<br>
X<br>
X<br>
154<br>
<hr>
<A name=160></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION<br>
ISAMPLE_M3 X<br>
X<br>
X<br>
ISCALE_MAX X<br>
X<br>
X<br>
X<br>
X<br>
ISCALE_MIN X<br>
X<br>
X<br>
X<br>
X<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
KAPPA X<br>
KNUTHSUMOFF X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
LAPLACE X<br>
X<br>
*<br>
 <br>
*<br>
X<br>
 <br>
*<br>
*<br>
*<br>
LEVWT($LEVEL) X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
LIKE X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
LNTWOPI X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
MADAPT X<br>
MAPCOV X<br>
X<br>
MAPINTER X<br>
X<br>
MAPITER X<br>
X<br>
MASSRESET ***<br>
X<br>
MAXEVAL X<br>
MCETA X<br>
X<br>
X<br>
X<br>
MSFO X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
MUM X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
NBURN X<br>
X<br>
X<br>
NITER/NSAMPLE X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
NOABORT X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
NOCOV** X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
NOHABORT X X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
NOLABEL X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
NONINFETA X<br>
NOOMEGABOUNDTEST X<br>
NOPRIOR X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
NOSIGMABOUNDTEST X<br>
NOSUB X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
NOTHETABOUNDTEST X<br>
NOTITLE X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
NSIG/SIGDIGITS X<br>
X<br>
NUMDER X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
NUMERICAL X<br>
X<br>
*<br>
 <br>
*<br>
X<br>
 <br>
*<br>
*<br>
*<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
NUTS_BASE X<br>
NUTS_DELTA X<br>
NUTS_EPARAM ***<br>
X<br>
NUTS_GAMMA X<br>
NUTS_INIT X<br>
NUTS_MASS ***<br>
X<br>
NUTS_MAXDEPTH X<br>
NUTS_OPARAM ***<br>
X<br>
NUTS_REG ***<br>
X<br>
NUTS_SPARAM ***<br>
X<br>
NUTS_STEPINTER X<br>
NUTS_STEPITER X<br>
155<br>
<hr>
<A name=161></a>$ESTIMATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
NUTS_TERM X<br>
NUTS_TEST X<br>
NUTS_TRANSFORM X<br>
OACCEPT X<br>
X<br>
OLKJDF X<br>
OLNTWOPI X<br>
X<br>
X<br>
OMEGABOUNDTEST X<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
OMITTED X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
OPTMAP X<br>
X<br>
X<br>
X<br>
ORDER X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
OSAMPLE_M1 X<br>
X<br>
OSAMPLE_M2 X<br>
X<br>
OVARF X<br>
PACCEPT X<br>
X<br>
PARAFILE X X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
PARAFPRINT X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
PHITYPE X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
X<br>
POSTHOC X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
PREDICTION X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
PRINT X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
PRIORC X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
PSAMPLE_M1 X<br>
X<br>
PSAMPLE_M2 X<br>
X<br>
PSAMPLE_M3 X<br>
X<br>
PSCALE_MAX X<br>
X<br>
PSCALE_MIN X<br>
X<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
RANMETHOD=nSmP X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
REPEAT X<br>
REPEAT1 X<br>
REPEAT2 X<br>
SADDLE_HESS X<br>
SADDLE_RESET X<br>
SEED X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
X<br>
SIGL X<br>
X<br>
X<br>
 <br>
X<br>
X<br>
 <br>
X<br>
SIGLO X<br>
X<br>
X<br>
X<br>
SIGMABOUNDTEST X<br>
SLKJDF X<br>
SLOW/NOSLOW/FAST X<br>
X<br>
*<br>
 <br>
*<br>
X<br>
 <br>
*<br>
*<br>
*<br>
SORT X<br>
STDOBJ X<br>
X<br>
STIELTJES X<br>
SVARF X<br>
THETABOUNDTEST X<br>
THIN X<br>
X<br>
TTDF X<br>
ZERO X<br>
Option Classical<br>
ITS DIRECT IMP IMPMAP SAEM BAYES NUTS<br>
+ ADVAN9,ADVAN13,ADVAN14,ADVAN15<br>
156<br>
<hr>
<A name=162></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION<br>
*May be needed to suppress error messages from NMTRAN or<br>
NONMEM.<br>
**When last estimation step<br>
***In prep for NUTS<br>
(See <b>$ESTIMATION</b>).<br>
REFERENCES: Guide Introduction_7<br>
157<br>
<hr>
<A name=163></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ESTIMATION,$ESTM<br>
MEANING: Instructions for the NONMEM Estimation Step<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$ESTIMATION<br>
[<b>ABORT</b>|NOABORT|NOHABORT]<br>[ATOL=<i>n</i>]<br>[AUTO=[0|1|2|3]]<br>[CALPHA=<i>n</i>]<br>[CENTERING|<b>NOCENTERING</b>]<br>[CINTERVAL=<i>n</i>]<br>[CITER=<i>n </i>| CNSAMP=<i>n</i>]<br>[CONSTRAIN=<i>n</i>]<br>[CTYPE=[0|1|2|3|4]]<br>[DERCONT=[0|1]]<br>[DF=<i>n</i>]<br>[DFS=<i>n</i>]<br>[EONLY=[0|1]]<br>[ETABARCHECK|<b>NOETABARCHECK</b>]<br>[ETADER=<i>n</i>]<br>[<b>ETASAMPLES=0 </b>| ETASAMPLES=1]<br>[<b>ETASTYPE=0 </b>| ETASTYPE=1]<br>[FILE=filename]<br>[FNLETA=<i>n</i>]<br>[FORMAT|DELIM=<i>s</i>3]<br>[FO|<b>NOFO</b>]<br>[FPARAFILE=[ﬁlename|ON|OFF]<br>[GRD=<i>s</i>2]<br>[GRDQ=<i>s</i>2]<br>[GRID=(nr,ns,r0,r1)]<br>[IACCEPT=<i>r</i>]<br>[IACCEPTL=<i>r</i>]<br>[IKAPPA=<i>x</i>]<br>[INTERACTION|NOINTERACTION]<br>[ISAMPEND=<i>n</i>]<br>[ISAMPLE=<i>n</i>]<br>[ISAMPLE_M1=<i>n</i>]<br>[ISAMPLE_M1A=<i>n</i>]<br>[ISAMPLE_M1B=<i>n</i>]<br>[ISAMPLE_M2=<i>n</i>]<br>[ISAMPLE_M3=<i>n</i>]<br>[ISCALE_MAX=<i>x</i>]<br>[ISCALE_MIN=<i>x</i>]<br>[KAPPA=<i>x</i>]<br>[KNUTHSUMOFF=<i>n</i>]<br>[LAPLACIAN|<b>NOLAPLACIAN</b>]<br>[LEVWT=<i>n</i>]<br>[LIKELIHOOD|-2LOGLIKELIHOOD]<br>
158<br>
<hr>
<A name=164></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
[LNTWOPI]<br>[MADAPT=<i>n</i>]<br>[MAPCOV=<i>n</i>]<br>[MAPINTER=<i>n</i>]<br>[MAPITER=<i>n</i>]<br>[MASSRESET=<i>n</i>]<br>[MAXEVALS=<i>n</i>]<br>[MCETA=<i>n</i>]<br>[METHOD=kind]<br>[MSFO=ﬁlename]<br>[MUM=<i>s</i>1]<br>[NBURN=<i>n</i>]<br>[NITER=<i>n</i>]<br>[NOCOV=[0|1]]<br>[NOLABEL=[0|1]]<br>[NONINFETA=[0|1]]<br>[NOPRIOR=[0|1]]<br>[NOSUB=[0|1]]<br>[NOTITLE=[0|1]]<br>[NUMDER=[0|1|2|3]]<br>[NUMERICAL|<b>NONUMERICAL</b>]<br>[NUTS_BASE=<i>x</i>]<br>[NUTS_DELTA=<i>x</i>]<br>[NUTS_EPARAM=<i>n</i>]<br>[NUTS_GAMMA=<i>x</i>]<br>[NUTS_INIT=<i>x</i>]<br>[NUTS_MASS=[B|F|D|BD|DB|BBD|BBB]]<br>[NUTS_MAXDEPTH=<i>n</i>]<br>[NUTS_OPARAM=<i>n</i>]<br>[NUTS_REG=<i>x</i>]<br>[NUTS_SPARAM=<i>x</i>]<br>[NUTS_STEPINTER=<i>n</i>]<br>[NUTS_STEPITER=<i>n</i>]<br>[NUTS_TERM=<i>x</i>]<br>[NUTS_TEST=<i>n</i>]<br>[NUTS_TRANSFORM=<i>n</i>]<br>[OACCEPT=<i>n</i>]<br>[OLKJDF=<i>n</i>]<br>[OLNTWOPI]<br>[<b>OMEGABOUNDTEST</b>|NOOMEGABOUNDTEST]<br>[OMITTED]<br>[OPTMAP=<i>n</i>]<br>[ORDER=xxxf]<br>[OSAMPLE_M1=<i>n</i>]<br>[OSAMPLE_M2=<i>n</i>]<br>[OVARF=<i>x</i>]<br>[PACCEPT=<i>n</i>]<br>[PARAFILE=[ﬁlename|ON|OFF]<br>[PARAFPRINT=<i>n</i>]<br>[PHITYPE=<i>n</i>]<br>
159<br>
<hr>
<A name=165></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
[POSTHOC|<b>NOPOSTHOC</b>]<br>[<b>PREDICTION</b>]<br>[PRINT=<i>n</i>]<br>[PRIORC]<br>[PSAMPLE_M1=<i>n</i>]<br>[PSAMPLE_M2=<i>n</i>]<br>[PSAMPLE_M3=<i>n</i>]<br>[PSCALE_MAX=<i>n</i>]<br>[PSCALE_MIN=<i>n</i>]<br>[RANMETHOD=[n|S|m|P] ]<br>[REPEAT|<b>NOREPEAT</b>]<br>[REPEAT1|<b>NOREPEAT1</b>]<br>[REPEAT2|<b>NOREPEAT2</b>]<br>[SADDLE_HESS=<i>n</i>]<br>[SADDLE_RESET=<i>n</i>]<br>[SEED=<i>n</i>]<br>[SELECT=<i>n</i>]<br>[SIGDIGITS|NSIGDIGITS=<i>n</i>]<br>[SIGL=<i>n</i>]<br>[SIGLO=<i>n</i>]<br>[<b>SIGMABOUNDTEST</b>|NOSIGMABOUNDTEST]<br>[SLKJDF=<i>x</i>]<br>[SLOW=1|SLOW=2]<br>[SLOW|<b>NOSLOW</b>|FAST]<br>[SORT|<b>NOSORT</b>]<br>[STDOBJ=<i>r</i>]<br>[STIELTJES]<br>[SVARF=<i>x</i>]<br>[<b>THETABOUNDTEST</b>|NOTHETABOUNDTEST]<br>[TTDF=<i>n</i>]<br>[ZERO=list]<br>
SAMPLE:<br>$ESTIMATION MAXEVAL=450<br>
PRINT=5<br>
DISCUSSION:<br>Optional. Requests that the NONMEM Estimation Step be implemented. May also be<br>coded $ESTM or $ESTIMATE. The Estimation Step obtains parameter estimates.<br>With NONMEM 7, multiple Estimation Steps can be implemented in a single problem.<br>A sequence of two or more Estimation Steps will result in the sequential execution of<br>each. Options speciﬁed in an $ESTIMATION record will carry over to the next $ESTI-<br>MATION record unless a new option is speciﬁed. If a particular option is not used by the<br>method then the option will be ignored. The ﬁnal parameter estimates from an Estima-<br>tion Step will be passed on as the initial estimates for the next Estimation Step.<br>(See <b>$ESTIMATION_record_options</b>).<br>
See also &quot;Reserved Variables that are of Interest During the Estimation Step&quot;, at the end<br>of this help item.<br>
OPTIONS:<br>
<b>ABORT</b><br>
During the Estimation Step, NONMEM does not implement theta-recovery when<br>PRED sets the error return code to 1. (The PRED error return code n is set by the<br>
160<br>
<hr>
<A name=166></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
statement &quot;EXIT n [k]&quot; in abbreviated code, or by the statement IERPRD=n in user-<br>supplied code, or by PREDPP when it detects errors.) This is the default.<br>
NOABORT<br>
During the Estimation Step, NONMEM implements theta-recovery, i.e., attempt to<br>avoid values of theta which result in PRED error return code 1. In addition, most<br>non-positive Hessian matrices will be forced to be positive deﬁnite, allowing the<br>program to continue, and abnormal termination of the estimation step will occur less<br>often.<br>
NOHABORT<br>
Perform positive deﬁnite correction at all levels of the estimation. This can hide a<br>serious ill-posed problem, so use with care.<br>
ATOL=<i>n </i>(NM72)<br>
Absolute tolerance. Used only with ADVAN9, ADVAN13, ADVAN14, and<br>ADVAN15, for which TOL is a relative tolerance. Sets ANRD=ATOL. The default<br>is 12 (that is, accuracy is 10**(-12)). Usually the problem runs quickly when using<br>this setting. On occasion, however, you may want to reduce ATOL (usually set it<br>equal to that of TOL), and improve speeds of up to 3 to 4 fold.<br>
By default, the value set on $SUBROUTINES record (or $TOL or TOL subroutine)<br>is used. If ATOL is coded on $ESTIMATION, it overrides the default for that step.<br>If ATOL is coded on $COVARIANCE, it overrides $ESTIMATION and/or the<br>default for that step. With NONMEM 74, this feature is deprecated. A user-sup-<br>plied TOL subroutine should test NM_STEP and set ANRD accordingly.<br>
AUTO=0 (NM73)<br>
NONMEM does not provide best settings of certain options. This is the default.<br>
AUTO=1 (NM73)<br>
Several options will be set by NONMEM that will allow best settings to be deter-<br>mined. User may still over-ride those options set by auto, by specifying them on the<br>same $EST record. The AUTO option is ignored by the FO/FOCE/Laplace meth-<br>ods.<br>
AUTO=2 (NM74)<br>
AUTO=2 may be user with NUTS estimation to setup the alternative sampling strat-<br>egy &quot;Matt trick&quot;. IP &quot;AUTO=2 (NM74)&quot; AUTO=3 may be user with NUTS estima-<br>tion to setup the alternative sampling strategy of eta sampling.<br>See <b>INTRODUCTION TO NONMEM 7 </b>for more information.<br>
CALPHA=<i>n</i><br>
<i>n </i>is a value between 0.01 and 0.05. Alpha error rate to use for linear regression test<br>to assess statistical signiﬁcance. Default is 0.05.<br>
CENTERING<br>
Requests that the average conditional estimates of each eta be constrained to be<br>close to 0. May only be used with METHOD=1. Not permitted with INTERAC-<br>TION.<br>
<b>NOCENTERING</b><br>
Requests that the average conditional estimates of each eta not be constrained. This<br>is the default.<br>
CINTERVAL=<i>n</i><br>
Every <i>n </i>iterations is submitted to the convergence test system. If CINTERVAL=0,<br>then a best CINTERVAL will be found, then used.<br>
161<br>
<hr>
<A name=167></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
CITER=<i>n</i><br>
<i>n </i>is the number of latest PRINT or CINTERVAL iterations on which to perform a<br>linear regression test (where independent variable is iteration number, dependent<br>variable is parameter value). If CITER=10, then 10 of the most recent PRINTed or<br>CINTERVAL iterations are used for the linear regression test. Default is 10. May<br>also be coded CNSAMP. If CINTERVAL is not speciﬁed, then the PRINT option is<br>used.<br>
CONSTRAIN=<i>n </i>(NM72)<br>
Requests simulated annealing for parameters to slow the rate of reduction of the ele-<br>ments of OMEGA during the burn-in phase of the SAEM method, allowing for a<br>more global search of parameters that minimize the objective function. Values for <i>n<br></i>are:<br>
0 or 4   No simulated annealing.<br>
1 or 5   Requests simulated annealing for OMEGA.<br>
2 or 6   Requests simulated annealing for SIGMA.<br>
3 or 7   Requests simulated annealing for both OMEGA and SIGMA.<br>
Default is 1.<br>
When CONSTRAIN&gt;=4, simulated annealing is also performed on diagonal ele-<br>ments of OMEGA that are ﬁxed to 0 to facilitate any associated thetas.<br>
Simulated annealing is performed by subroutine CONSTRAINT.<br>
The $ANNEAL record facilitates EM search methods for this additional annealing<br>technique. The subroutine CONSTRAINT may also be used to provide any kind of<br>constraint pattern on any parameters.<br>(See <b>$ANNEAL</b>).<br>The user may modify the subroutine CONSTRAINT that performs the simulated<br>annealing algorithm.<br>(See <b>additional_output_ﬁles</b>, <b>raw_output_ﬁle</b>).<br>
CTYPE=[0|1|2|3|4]<br>
CTYPE is used to deﬁne the termination test to be applied to the burn-in phases for<br>SAEM and BAYES methods and to the estimation phases for the ITS, IMP, and<br>IMPMAP methods. (CTYPE=4 Applies to classical methods FO/FOCE/Laplacean.)<br>CTYPE=0 indicates no termination test, the default.<br>CTYPE=1 indicates that the test should be applied to the objective function value,<br>THETA’ s and SIGMA’s but not to the OMEGA’s.<br>CTYPE=2 indicates that the test should be applied to the objective function value,<br>THETA’ s, SIGMA’s and diagonal elements of OMEGA.<br>CTYPE=3 indicates that the test should be applied to the objective function value,<br>THETA’ s, SIGMA’s and all OMEGA elements.<br>CTYPE=4 indicates that NONMEM should test if the objective function has not<br>changed by more then NSIG digits beyond the decimal point over 10 iterations, even<br>though a parameter may oscillate at some digit. If this condition is satisﬁed, the esti-<br>mation will terminate successfully. Applies to FO/FOCE/Laplacean methods.<br>
DERCONT=[0|1] (NM73)<br>
The derivative continuity test (DERCONT) by default is off (0). When DERCONT=1,<br>the partial derivative of the objective function with respect to thetas will perform an<br>additional test to determine if a backward difference assessment is more accurate<br>than a forward difference assessment. The forward difference assessment can differ<br>
162<br>
<hr>
<A name=168></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
greatly from the backward difference assessment in cases of extreme discontinuity<br>when varying certain thetas by even just a small amount in the model results in a<br>large change in objective function, (such as a viral model in which a very small<br>change in the potency of an anti-viral agent results in widely varying time of return<br>of viral load). This results in standard errors being poorly assessed for thetas that do<br>not have inter-subject variances associated with them. Setting DERCONT=1 slows<br>the analysis, but can provide more accurate assessments of SE in such models. The<br>DERCONT works only for the Monte Carlo EM algorithms such as IMP, DIRECT,<br>IMPMAP, and SAEM.<br>
DF=<i>n</i><br>
The proposal density is to be a t distribution with <i>n </i>degrees of freedom. Default is<br>0, a normal density. Used with the IMP and IMPMAP methods.<br>
DFS=<i>n </i>(NM73)<br>
Degrees of freedom for the Sigma matrix for simulation purposes by CHAIN.<br>
DFS=-1<br>
This is the default. The cholesky elements are uniformly varied over the inter-<br>val (1-accept)*initial value and (1+accept)*initial value.<br>
DFS=<i>n</i><br>
The SIGMA matrix is randomly created with an inverse Wishart distribution<br>centered about the initial SIGMA values, with degrees of freedom DFS for dis-<br>persion.<br>
DFS=0<br>
As above, but the size of the SIGMA matrix is used as degrees of freedom.<br>
DFS=&gt;1000000<br>
SIGMA is ﬁxed at its initial value.<br>
EONLY=[0|1]<br>
A value of 1 indicates the IMP objective function should be evaluated by performing<br>only the expectation step without advancing the population parameters. Default is 0.<br>
ETABARCHECK<br>
There is an etabar statistic (See <b>etabar</b>) from a previous problem, and the P-value<br>associated for the etabar statistic with the problem at hand relates to a hypothesis test<br>that the true etabar is the same as that with the previous problem.<br>
<b>NOETABARCHECK</b><br>
The P-value associated for the etabar statistic (See <b>etabar</b>) relates to a hypothesis<br>test that the true etabar is 0. This is the default.<br>
ETADER=<i>n </i>(NM73)<br>
For evaluating individual variances by numerical derivative methods. In evaluating<br>the MAP objective function, the term log(Det(V)) must be evaluated to obtained the<br>marginal or integrated posterior density, where V is the eta Variance matrix based on<br>the subject’s posterior density. With ETADER&gt;0, SLOW option may be needed.<br>
ETADER=0<br>
Expected value V, using analytical ﬁrst derivatives<br>
ETADER=1<br>
Expected value V, using forward ﬁnite difference numerical ﬁrst derivatives.<br>Needed if not all code evaluating F and Y derivatives with respect to eta are<br>available for processing by NM-TRAN or in user supplied code.<br>
163<br>
<hr>
<A name=169></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
ETADER=2<br>
Expected value V, using central ﬁnite difference numerical ﬁrst derivatives.<br>Needed if not all code evaluating F and Y derivatives with respect to eta are<br>available for processing by NM-TRAN or in user supplied code.<br>
ETADER=3<br>
2nd derivative method of evaluating V, using numerical second derivatives of<br>-log(L) with respect to etas. This is equivalent to using the &quot;Laplace NUMERI-<br>CAL&quot; method, even though FOCE may be selected.<br>
ETASAMPLES=[0|1] (NM74)<br>
Used with $EST METHOD=SAEM or $EST METHOD=BAYES. ETASAM-<br>PLES=0 is the default. ETASAMPLES=1 causes individual ISAMPLE random eta<br>samples per subject, to be written to root.ets, where root is the root name of the con-<br>trol stream ﬁle.<br>See &quot;Stochastic Approximation Expectation Maximization (SAEM) Method&quot; in<br>Guide INTRODUCTION TO NONMEM 7.<br>
ETASTYPE=0 (NM73)<br>
Eta shrinkage is averaged for all subjects. This is the default.<br>
ETASTYPE=1<br>
Eta shrinkage is averaged only among subjects that provided a non-zero derivative of<br>their data likelihood with respect to that eta. (See <b>etasxi</b>).<br>
FAST (NM74)<br>
The FAST option is available for FOCE/ITS methods. The FAST method allows use<br>of analytical theta derivatives to facilitate FOCE analysis. All thetas should be MU-<br>referenced in the manner described in Guide INTRODUCTION TO NONMEM 7,<br>&quot;MU Referencing&quot;. For thetas that should not have inter-subject variability, or<br>should not be MU referenced, MU reference it anyway by adding addional etas and<br>assigning them to these thetas through MU referencing, but set their associated<br>omega values to 0.0 FIXED.<br>
FILE=ﬁlename<br>
Name for the raw output ﬁle. Parameter estimates and objective function value will<br>be printed to this ﬁle every printed iteration as indicated by the PRINT option.<br>Default: root.ext, where root is the name of the control ﬁle (not including any exten-<br>sion; &quot;nmbayes&quot; if the name is not speciﬁed on the nmfe command line). Note that<br>the names of additional output ﬁles are not affected by this option. Additional out-<br>put ﬁles have extensions .ext, .phi, .phm, .shk, .shm .grd, .xml, .cov, .cor, .coi, .cnv,<br>.smt, .rmt, .imp, .npd, .npe, .npi, .fgh, .clt, .vpd, .ets. They always have the name of<br>the control ﬁle or &quot;nmbayes&quot; for root.<br>(See <b>additional_output_ﬁles</b>, <b>raw_output_ﬁle</b>).<br>
FNLETA=<i>n </i>(NM72)<br>
FNLETA=0 requests that the FNLMOD and FNLETA routines not be called after<br>the Estimation and Covariance steps are completed. May improve run time. Post-<br>hoc etas for METHOD=0 will not be computed. If variables listed in $TABLE are<br>random variables, the ETAs used will be the ﬁnal ones obtained by the Estimation<br>Step.<br>FNLETA=1 is the default. FNLMOD and FNLETA routines are called as usual.<br>FNLETA=2 requests that the estimation step not be done, and whatever etas are<br>stored in memory at the time are used in any subsequent $TABLE’s. This has value<br>if you loaded the individual etas from an MSF ﬁle, and you want to calculate<br>
164<br>
<hr>
<A name=170></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
$TABLE items based on those etas, rather than from a new estimation.<br>
FORMAT=<i>s</i>3<br>
<i>s</i>3 deﬁnes the delimiter [,|s(pace)|t(ab)] followed by a Fortran format speciﬁcation<br>for FILE. The default is s1PE12.5. Affects the raw output ﬁle and all additional<br>output ﬁles. If the user-deﬁned format is inappropriate for a particular number, then<br>the default format will be used for that number. May be terminated with line length<br>(e.g., FORMAT=s1PE15.8:160), line length with continuation marker for the end of<br>each line (e.g., FORMAT=s1PE15.8:160c), and continuation marker for start of each<br>continued line (e.g. FORMAT=s1PE15.8:160cx). If &quot;c&quot; is the letter s, it stands for<br>&quot;space&quot;. If &quot;c&quot; is the character &amp;, (e.g., FORMAT=s1PE15.8:160&amp;) and &amp; is the last<br>character on the line, it must be followed by &quot;;&quot; (e.g., FORMAT=s1PE15.8:160&amp;;)<br>
May also be coded DELIM.<br>
DELIM=<i>s</i>3<br>
Same as FORMAT option.<br>
FO<br>
Requests that the First-Order Model be used with METHOD=1 and CENTERING.<br>Cannot be used with LAPLACIAN.<br>
<b>NOFO</b><br>
Requests that the First-Order Model not be used with METHOD=1 and CENTERING.<br>This is the default.<br>
FPARAFILE=ﬁlename (NM74)<br>
Final etas (empirical Bayes estimates; EBE’s) are evaluated after the last Estimation<br>Step (when FNLETA=1). This computation is parallelized if parallelization is on for<br>the ﬁnal Estimation Step.<br>FPARAFILE=ﬁlename speciﬁes a different paraﬁle than was used for the Estima-<br>tion Step.<br>FPARAFILE=ON turns on parallelization for the EBE’s.<br>FPARAFILE=OFF turns off parallelization for the EBE’s.<br>The FPARAFILE option may be speciﬁed on any $ESTIMATION record, but<br>applies only after the last Estimation Step.<br>
GRD=<i>s</i>2<br>
<i>s</i>2 is a string of [G|N|D|S]’s with each symbol representing a THETA or SIGMA<br>parameter in numerical order. The ﬁrst m letters of GRD refer to the m THETA’ s.<br>Then the m+1th letter refers to SIGMA(1,1), m+2 refers to SIGMA(2,2), etc (going<br>along the diagonal of SIGMA). Omitted symbols are assumed to be D.<br>G indicates that the THETA should be Gibbs sampled. N indicates the THETA<br>should be sampled using the Metropolis-Hasting algorithm. S indicates that the<br>THETA is being used to model a SIGMA parameter. S is used with Monte Carlo<br>EM methods. D (default) indicates the program will decide. G and N are used only<br>with the BAYES method.<br>Default is DDDD...<br>
GRD=t1v1(n1):t2v2(n2):t3v3(n3)...<br>
An alternative syntax may be used. T is parameter type (T for theta, S for sigma-like<br>theta). V is a letter (S,D or N), and n is a number list. For example, to specify thetas<br>3, and 5 through 8 to be Gibbs samples, theta 4 is sigma-like, and sigmas 1-3 are to<br>be Metropolis-Hastings processed,<br>GRD=TG(3,5-8):TS(4):SN(1-3)<br>Thetas and sigmas not speciﬁed are given a default D designation.<br>
165<br>
<hr>
<A name=171></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
GRDQ=0 (NM74)<br>
Optional. The gradient quick option, called GRDQ, allows thetas that must be gra-<br>dient assessed (such as those that are not mu-referenced) and SIGMAS to be more<br>quickly evaluated by not evaluating the gradients for every one of the ISAMPLE<br>random samples, but chooses a subset of the most important samples.<br>
GRID=(nr,ns,r0,r1)<br>
Optional. May be used with STIELTJES. For nr, ns, r0, and r1, see the Introduc-<br>tion to Version VI 2.0. Brieﬂy, a grid is obtained by ﬁrst taking the interval [r0,r1]<br>of the length axis and dividing this interval into nr equal subintervals. ns may be<br>thought of as the number of points in a single quadrant of a 2-dimensional ellipse in<br>n-space. Constraints are nr&lt;=100, ns&lt;=9999, 0&lt;r0&lt;r1&lt;1. If r1&gt;.9999, there is no<br>tail region. nr and ns should be integers. The default values are: GRID=(3,1,.6,.9).<br>
IACCEPT=<i>r</i><br>
Has different meanings, depending on the method. With SAEM and BAYES, the<br>scaling of OMEGA is adjusted so that samples are accepted <i>r </i>fraction of the time.<br>See ISAMPLE_M2. Default is 0.4.<br>
With Importance sampling (IMP INTERACTION), expand proposal (sampling)<br>density variance relative to conditional density so that on average conditional den-<br>sity/proposal density=IACCEPT (default 0.4). For very sparse data or highly non-<br>linear posterior densities (such as with categorical data), you may want to decrease<br>to 0.1 to 0.3.<br>
IACCEPT=0<br>
For importance sampling only, you may set IACCEPT=0.0, and NONMEM will<br>determine the most appropriate IACCEPT level for each subject, and if necessary,<br>will use a t- distribution (by altering the DF for each subject) as well. If IAC-<br>CEPT=0, the individual IACCEPT values and DF values will be listed in root.imp.<br>
IACCEPTL=<i>r </i>(NM74)<br>
A scale to a second multi-variate normal density, to cover long tails in the posterior<br>density (hence L for long tails), in combination with the normal IACCEPT value to<br>cover the posterior density near the mode.<br>
IKAPPA=<i>x</i>] (NM74)<br>
Used in computing weight for individual parameters in ISAMPLE_M1B mode.<br>IKAPPA is 1.<br>
INTERACTION<br>
The dependence on etas of the model for intra-individual random error is preserved<br>in the computation of the objective function.<br>Cannot be used with CENTERING. With NONMEM 7.3, This is the default with<br>EM/Bayes methods and is supplied if NOINTERACTION is not speciﬁed by the<br>user. With NONMEM 7.4, INTERACTION is not supplied if LIKELIHOOD is<br>present.<br>
<b>NOINTERACTION</b><br>
Always set etas to 0 during the computation of the model for intraindividual random<br>error. This is the default with non-EM/Bayes methods.<br>
ISAMPEND=<i>n </i>(NM73)<br>
For SAEM, if ISAMPEND is speciﬁed as an upper integer value (usually 10), then<br>NONMEM will perform a ISAMPLE preprocess to determine the best ISAMPLE<br>value. See also STDOBJ.<br>
166<br>
<hr>
<A name=172></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
ISAMPLE=<i>n</i><br>
When used with the IMP or IMPMAP methods <i>n </i>is the number of random samples<br>per subject used for the expectation step. Default is 300. When used with the SAEM<br>or BAYES method <i>n </i>is the number of chains used by the Metropolis-Hastings algo-<br>rithm for individual parameter estimation. The default is 2 for SAEM and 1 for<br>BAYES.<br>
A kernel is the Metropolis-Hastings sampling and testing mode used. The ISAM-<br>PLE_Mx options deﬁne how many times to generate and test a sample for goodness-<br>of-ﬁt using a given kernel. ISAMPLE does not refer to a kernel, but deﬁnes the num-<br>ber of chains that are maintained, each chain having their own sample generation<br>and testing sequence using the various kernels. Each chain retains a ﬁnal sample for<br>each subject, at the end of each iteration.<br>
ISAMPLE_M1=<i>n</i><br>
<i>n </i>is the number of mode 1 iterations for the Metropolis-Hasting algorithm for esti-<br>mating individual parameters using the population means and variances as proposal<br>density. Used with the SAEM and BAYES methods. Default is 2.<br>
ISAMPLE_M1A=<i>n</i>(NM72)<br>
<i>n </i>is the number of mode 1A iterations for the Metropolis-Hasting algorithm, testing<br>model parameters from other subjects as possible values. Used with the SAEM and<br>BAYES methods. Default is 0.<br>
ISAMPLE_M1B=<i>n </i>(NM74)<br>
<i>n </i>is the number of mode 1B iterations for the Metropolis-Hasting algorithm Default<br>is 2.<br>
ISAMPLE_M2=<i>n</i><br>
<i>n </i>is the number of mode 2 iterations for the Metropolis-Hasting algorithm for esti-<br>mating individual parameters using the current parameter vector position as mean<br>and a scaled variance of OMEGA as variance. Used with the SAEM and BAYES meth-<br>ods. Default is 2.<br>
ISAMPLE_M3=<i>n</i><br>
<i>n </i>is the number of mode 3 iterations for the Metropolis-Hasting algorithm for esti-<br>mating individual parameters in which samples are generated for each parameter<br>separately. Used with the SAEM and BAYES methods. Default is 2.<br>
ISCALE_MIN=<i>x </i>ISCALE_MAX=<i>x </i>(NM72)<br>
In importance sampling, the scale factor used to vary the size of the variance of the<br>proposal density in order to meet the IACCEPT condition is by default bounded by<br>ISCALE_MIN of 0.1, and ISCALE_MAX=10.0. Defaults are (1.0E-06,1.0E+06)<br>for MCMC sampling. These options allow the scale factor boundary to be modiﬁed.<br>
KAPPA=<i>x </i>(NM74)<br>
Used with NUTS method. Default is 1.<br>
KNUTHSUMOFF=<i>n</i>] (NM74)<br>
The Knuth summing method is used to allow the most accurate summation of indi-<br>vidual objective function values, even with large variations in values of the individ-<br>ual objective function. To turn this off, and allow a standard summation (not recom-<br>mended except for comparison purposes from earlier versions), set KNUTH-<br>SUMOFF=1. With KNUTHSUM algorithm on by default, the SORT option is not<br>necessary. Default is 0. May also be set with $COVARIANCE record.<br>
LAPLACIAN<br>
Use the Laplacian method, in which second derivatives with respect to eta are used.<br>
167<br>
<hr>
<A name=173></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
Laplacian may not be used with METHOD=0. It may be used with the EM/Monte<br>Carlo methods, in which case the Laplacian option will be properly utilized, such as<br>during MAP estimation used during IMP, IMPMAP, and ITS, or ignored, such as<br>during SAEM or BAYES.<br>Cannot be used with $ABBREVIATED DERIV2=NO unless NUMERICAL option<br>is also speciﬁed.<br>
NOLAPLACIAN<br>
Do not use the Laplacian method. This is the default.<br>
LEVWT=<i>n </i>(NM74)<br>
This option applies when $LEVEL record is present. By default, LEVWT=0, and<br>weights each level value equally, reg ardless of number of subjects per level value. To<br>weight according to number of subjects for that value, set LEVWT=1.<br>
LIKELIHOOD<br>
This is designed mainly, but not exclusively, for use with noncontinuous observed<br>responses (&quot;odd-type data&quot;). Indicates that Y (with NM-TRAN abbreviated code) or<br>F (with a user-supplied PRED or ERROR code) will be set to a (conditional) likeli-<br>hood. Upon simulation it will be ignored, and the DV data item will be set directly<br>to the simulated value in abbreviated or user code. Also etas, if any, are understood<br>to be population etas. Epsilon variables and the $SIGMA record may not be used.<br>The L2 data item may not be used. The CONTR and CCONTR options of the<br>$SUBROUTINES record may not be used. NONMEM cannot obtain the initial esti-<br>mate for omega. If the data are population, and MAXEVALS=0 is not coded, then<br>NOINTERACTION is required. Compare with PREDICTION option.<br>
-2LOGLIKELIHOOD<br>
Indicates that Y (with NM-TRAN abbreviated code) or F (with a user-supplied<br>PRED or ERROR code) is a -2 log (conditional) likelihood. All remarks for LIKE-<br>LIHOOD apply. May also be coded -2LLIKELIHOOD. Compare with PREDIC-<br>TION option.<br>
MADAPT=<i>n </i>(NM74)<br>
Used with NUTS method. Default is -1.<br>
MAPCOV=1 (NM74)<br>
Unused. The default is 1.<br>
MAPINTER=<i>n </i>(NM72)<br>
Every <i>n</i>th iteration, the MAP estimation should be used to provide parameters to the<br>sampling density. Thus, if MAPITER=20 and MAPINTER=5, then for the ﬁrst 20<br>iterations, MAP estimation is used, and thereafter, every 5th iteration the MAP esti-<br>mation is used. If MAPINTER=-1, then mapinter will be turned on only if the<br>objective function increases consistently over sev eral iterations. Setting any of the<br>above parameters to -100 will force NONMEM to select the default value for that<br>parameter.<br>
MAPITER=<i>n </i>(NM72)<br>
The ﬁrst <i>n </i>iterations are to use MAP estimation to assess parameters for the sam-<br>pling density. After these <i>n </i>iterations, the conditional means and variances of the<br>pervious iteration are used for the sampling density parameters of the present itera-<br>tion. If MAPITER=0, then the ﬁrst iteration will rely on conditional means and vari-<br>ances that are in memory. These may have come from an MSF ﬁle, or from a previ-<br>ous estimation step.<br>
168<br>
<hr>
<A name=174></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
MASSRESET=<i>n </i>(NM74)<br>
Mass matrix information accumulation for NUTS method. Default is -1.<br>
MAXEVALS=<i>n</i><br>
Maximum allowable number of evaluations of the objective function during the Esti-<br>mation Step. Default: a generous number. (Each evaluation of the objective func-<br>tion requires one pass through the data set. This is also referred to as a &quot;function<br>evaluation.&quot;) MAXEVALS=-1 may be speciﬁed when a $MSFI record is present. It<br>requests that NONMEM re-use the value from the previous run, and is the default<br>with $MSFI.<br>
MAXEVAL=0 requests that the Estimation Step be omitted. This is useful, for exam-<br>ple, with POSTHOC (see above).<br>
MCETA=<i>n </i>(NM73)<br>
MCETA=0<br>
Eta=0 is initial setting for MAP estimation (eta optimization). This is the<br>default.<br>
MCETA=1<br>
ETA=values of previous iteration is initial setting for MAP estimation, or<br>ETA=0, whichever giv es lower objective function.<br>
MCETA&gt;1<br>
MCETA-1 Random samples of ETA, using normal random distribution with<br>variance OMEGA, are tested. Plus previous ETA is tested, and ETA=0 is<br>tested. Whichever giv es the lowest objective function is used as initial setting<br>for the MAP optimization.<br>
METHOD=kind<br>
Values for kind are:<br>
0 or ZERO<br>
Always set etas to 0 during the computation of the objective function. Also<br>called the &quot;ﬁrst order (FO) method.&quot; This is the default.<br>
1 or CONDITIONAL<br>
Use conditional estimates for the etas during the computation of the objective<br>function. METHOD=1 (without the LAPLACIAN option) is also called the<br>&quot;ﬁrst order conditional estimation (FOCE) method.&quot; The conditional estimates<br>of the etas are referred to as Conditional Parametric Etas (CPE).<br>
METH=COND NOLAPLACIAN is referred to as the FOCE method.<br>METH=COND LAPLACE is referred to as the Laplace method.<br>METH=COND NOLAPLACE CENTERING is referred to as the Centering FOCE method.<br>METH=COND LAPLACE CENTERING is referred to as the Centering Laplace method.<br>
HYBRID<br>
Use conditional estimates for the etas during the computation of the objective<br>function, with the exception of those etas listed in the ZERO option. Cannot be<br>used with LAPLACIAN or CENTERING.<br>
The following methods are new to NONMEM 7. When any of these methods are<br>used, the data are inferred to be population, and METHOD=1 is supplied if it is not<br>already present. The ﬁrst four methods are referred to as EM (Expectation-Maxi-<br>mization) Methods.<br>
ITS<br>
Use the iterative two-stage method. This method evaluates the conditional<br>
169<br>
<hr>
<A name=175></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
mode and ﬁrst order approximation of the conditional variance of parameters of<br>individuals by maximizing the posterior density. This integration step is the<br>same as used in the FOCE method. Population parameters are updated from<br>individuals’ conditional mode parameters and their approximate variances by<br>single iteration maximization steps.<br>
IMP<br>
Use the Monte-Carlo Importance Sampling Expectation Maximization method.<br>This method evaluates the conditional mean and variance of parameters of indi-<br>viduals by Monte Carlo sampling. It uses the posterior density, which incorpo-<br>rates the likelihood of parameters relative to population means and variances<br>with the individual’s observed data. The normal density near the mean or mode<br>of the posterior is used as a proposal density, then weighted according to the<br>posterior density as a correction.<br>
IMPMAP<br>
Use the Importance Sampling method assisted by Mode a Posteriori (MAP)<br>estimation. At each iteration, conditional modes and conditional ﬁrst order<br>variances are evaluated as in the ITS or FOCE method. These are then used as<br>parameters to the multivariate normal proposal density for the Monte-Carlo<br>importance sampling step.<br>
SAEM<br>
Use the Stochastic Approximation Expectation Maximization method. As in<br>importance sampling, random samples are generated from normal proposal<br>densities. However, instead of always being centered at the mean or mode of<br>the posterior density, the proposal density is centered at the previous sample<br>position.<br>
BAYES<br>
Use the Markov Chain Monte Carlo (MCMC) Bayesian Analysis method. The<br>goal of the MCMC Bayesian analysis is to obtain a large sample set of probable<br>population parameters. Various summary statistics of the population parameters<br>may then be obtained such as means and conﬁdence ranges.<br>
DIRECT<br>
Requests Monte Carlo Direct Sampling. Creates completely independent sam-<br>ples (unlike MCMC), and there is no chance of causing bias if the sampling<br>density is not similar enough to the conditional density (unlike IMP). However,<br>it is very inefﬁcient, requiring ISAMPLE settings of 10000 to 300000 to prop-<br>erly estimate the problem.<br>
NUTS (NM74)<br>
Requests No U-Turn Sampling (NUTS) Markov Chain Monte Carlo (MCMC)<br>Bayesian Analysis Method. Options unique to this method are listed alphabeti-<br>cally under NUTS_.... Other options of interest with their defaults are as fol-<br>lows:<br>
MASSRESET=-1<br>
MADAPT=-1<br>
KAPPA=1<br>
TTDF=0<br>
OLKJDF=0<br>
OVARF=1<br>
SLKJDF=0<br>
SVARF=1<br>
170<br>
<hr>
<A name=176></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
CHAIN<br>
Allows the user to create a series of random initial values of THETAs and<br>OMEGA’s, or for reading in initial population parameters from a ﬁle of rectan-<br>gular (rows/column) format. Applies only to the Estimation Step.<br>
LNTWOPI (NM74)<br>
The objective function is reported including the N*LOG(2pi) constant term, where<br>N is the total number of normally distributed data values in the data set. Compare<br>OLNTWOPI. Either or both may be used.<br>
MSFO=filename<br>
A Model Speciﬁcation File is output to a ﬁle with the given ﬁlename. Filename may<br>not contain embedded spaces. If ﬁlename contains commas, semicolons, or paren-<br>theses, then it must be surrounded by quotes (’ or &quot;). Filename may also contain<br>equal signs if it is enclosed in quotes. Filename may contain at most 71 characters.<br>If ﬁlename is the same as any option of the $ESTIMATION record, it must be<br>enclosed in quotes. If the $NONPARAMETRIC record is present and also speciﬁes<br>the MSFO option, the ﬁlename is required on the record which appears ﬁrst in the<br>control stream. If ﬁlename is present on both, it must be the same. If the ﬁlename is<br>omitted on the second of the two records, the MSF option must be the ﬁnal option<br>on that record. Default: If the MSFO option is not used, no MSF is output.<br>
If a MSFO is output, then the iteration estimates may also be seen in the original<br>parameterization for those iterations whose summaries appear in intermediate print-<br>out. These estimates may be found in ﬁle INTER.<br>
When MAXEVAL=0 and the Covariance Step is implemented, the MSFO option may<br>also be used, and then a model speciﬁcation ﬁle will be output which will include<br>information from the Covariance Step and from the input model speciﬁcation ﬁle<br>concerning the earlier Estimation Step (in this case there must be an input model<br>speciﬁcation ﬁle).<br>(See <b>model_speciﬁcation_ﬁle</b>).<br>
MUM=<i>s</i>1<br>
<i>s</i>1 is a string of [M|N|D|X]’s with each letter representing a THETA parameter in<br>numerical order. M indicates that the THETA should be Mu modeled. N indicates<br>the THETA should not be Mu modeled. D indicates the program will decide if the<br>parameter should be Mu modeled or not. X indicates that THETA is inv olved in a<br>covariate-dependent mixture model and is required if this is the case.<br>Default is DDDD...<br>
MUM=v1(n1):v2(n2):v3(n3)...<br>
An alternative syntax may be used. V is a letter (N,M,D, or X), and n is a number<br>list. For example, to specify that thetas 3 and 5 through 8 should not be MU mod-<br>eled, theta 2 is a population mixture parameter, and thetas 6 and 12 are to be MU<br>modeled:<br>MUM=N(3,5-8):X(2):M(6,12)<br>
NBURN=<i>n</i><br>
When used with the SAEM method <i>n </i>is the maximum number of iterations used to<br>perform the stochastic phase. Default is 2000. When used with the BAYES method<br><i>n </i>is the maximum number of iterations used to perform the burn-in phase. Default is<br>4000.<br>
NITER=<i>n</i><br>
When used with the ITS, IMP, and IMPMAP methods <i>n </i>is the maximum number of<br>
171<br>
<hr>
<A name=177></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
iterations. Default is 50. When used with the SAEM method n5 is the number of iter-<br>ations for the non-stochastic accumulation phase. Default is 1000. When used with<br>the BAYES method n5 is the number of iterations used to obtain the stationary distri-<br>bution. Default is 10000. NITER may also be coded NSAMPLE.<br>
NOCOV=[0|1] (NM73)<br>
If covariance estimation is not desired for a particular estimation step, set<br>NOCOV=1. It may be turned on again for the next estimation step with NOCOV=0.<br>If NOCOV=1 is set for an FOCE/Laplace/FO step, this is equivalent to $COV NOF-<br>COV setting.<br>For ITS and IMP, covariance estimation can take some time for large problems, and<br>you may wish to obtain only the objective function, such as in the case of $EST<br>METHOD=IMP EONLY=1 after an SAEM estimation. NOCOV has no effect on<br>BAYES analysis, as no extra time is required in assessing covariance for BAYES.<br>By default, standard error information for the classical methods (FO/FOCE/Laplace)<br>will be given only if they are the last estimation method, even if NOCOV=0 for an<br>intermediate estimation step. If NOCOV=1 for the FOCE/LAPLACE/FO method,<br>and it is the last estimation step, then standard error assessment for it will be turned<br>off.<br>
NOLABEL=[0|1]<br>
1 indicates that the row of item names for FILE will not be written, otherwise 0, the<br>default. Affects the raw output ﬁle and all additional output ﬁles.<br>
NONINFETA=[0|1] (NM73)<br>
Sometimes, gradients are not properly evaluated for classical NONMEM methods,<br>when not all etas are used for all subjects. For example, an eta to a ka absorption<br>rate constant during a ﬁt of a subject with only IV dosing would be considered a<br>non-inﬂuential data. If $EST METHOD=1 or 0 is used without the SLOW option,<br>this can result in evaluating very large and incorrect gradients, which in turn affects<br>the search path, and sometimes the ﬁnal objective function value. Should this occur,<br>add NONINFETA=1 to the $EST record. NONINFETA=0 is the default.<br>
NOPRIOR=[0|1]<br>
If prior information was speciﬁed using the $PRIOR statement, then normally the<br>analysis is set up for three stage hierarchical analysis. By default NOPRIOR=0, and<br>this prior information will be used. If NOPRIOR=1, then for the particular estima-<br>tion, the prior information is not included in the analysis. This is useful if you do not<br>want to use prior information during a maximization (METHOD=IMP, CONDI-<br>TIONAL, IMPMAP, SAEM, or ITS), but then use it for the Bayesian analysis<br>(METHOD=BAYES). With NOPRIOR=1, FOCE is still allowed to evaluate an S<br>MATRIX, since prior information is not used. I.e., $EST NOPRIOR=1 and $COV<br>MATRIX=S are permitted. With NONMEM 7.3, when NOPRIOR=1 is set, the esti-<br>mation will not use TNPRI prior information (TNPRI should only be used with<br>FO/FOCE/Laplace estimations). In previous versions of NONMEM, NOPRIOR=1<br>did not act on TNPRI priors.<br>
NOSUB=[0|1] (NM74)<br>
With NOSUB=0, label substitution will be performed for ﬁnal estimates in the NON-<br>MEM report ﬁle. (See <b>$ABBREVIATED</b>). This is the default. With NOSUB=1,<br>label substitution will not be performed.<br>
NOTITLE=[0|1]<br>
1 indicates the header for FILE will not be written, otherwise 0, the default. Affects<br>the raw output ﬁle and all additional output ﬁles.<br>
172<br>
<hr>
<A name=178></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
NUMDER=[0|1|2|3] (NM73)<br>
With NUMDER=1, NONMEM computes and displays numerically evaluated deriva-<br>tives of Y or F with respect to eta and eps (G and H). These numeric values are dis-<br>played in root.fgh, but are not used in estimation.<br>With NUMDER=0, ﬁle root.fgh is not produced. This is the default.<br>With NUMDER=2, analytical derivatives values are stored in root.agh<br>With NUMDER=3, both root.agh and root.fgh are produced.<br>
NUMERICAL<br>
Requests that second eta-derivatives for the Laplacian method be obtained numeri-<br>cally.<br>
NONUMERICAL<br>
Requests that second eta-derivatives for the Laplacian method be computed by<br>PRED. Not permitted with the combination LAPLACIAN and INTERACTION.<br>Otherwise, this is the default.<br>
NUTS_BASE (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0.025.<br>
NUTS_DELTA (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0.8<br>
NUTS_EPARAM (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0<br>
NUTS_GAMMA (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0.05<br>
NUTS_INIT (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0.075.<br>
NUTS_MASS (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is B<br>
NUTS_MAXDEPTH (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 10<br>
NUTS_OPARAM (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 1<br>
NUTS_REG (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0.0<br>
NUTS_SPARAM (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 1<br>
NUTS_STEPINTER (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0<br>
NUTS_STEPITER (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 1<br>
NUTS_TERM (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0.05<br>
NUTS_TEST (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0<br>
NUTS_TRANSFORM (NM74)<br>
See Guide INTRODUCTION TO NONMEM 7. Default is 0<br>
173<br>
<hr>
<A name=179></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
OACCEPT=<i>n</i><br>
Used only with the BAYES method. <i>n </i>has meaning only for OMEGA sampled by<br>the Metropolis-Hastings algorithm. The scaling of degrees of freedom is adjusted so<br>that samples are accepted <i>n </i>fraction of the time. See OSAMPLE_M2=. Default is 0.5.<br>
OLKJDF=<i>n </i>(NM74)<br>
Used with NUTS method, OLKJDF stands for Omega LKJ density degrees of free-<br>dom. Default is 0.<br>
OLNTWOPI (NM74)<br>
The objective function is reported including the NETA*NIND*LOG(2pi) constant<br>term for SAEM and BAYES, where NETA is the number of etas, and NIND is num-<br>ber of individuals. Compare LNTWOPI. Either or both may be used.<br>
THETABOUNDTEST, OMEGABOUNDTEST, SIGMABOUNDTEST<br>
With NONMEM VI, the estimation step sometimes terminates with the message<br>PARAMETER ESTIMATE IS NEAR ITS DEFAULT BOUNDARY.<br>These options request that the &quot;default boundary test&quot; be performed for THETA,<br>OMEGA, and SIGMA, respectively. THETABOUNDTEST may also be coded TBT<br>or TBOUNDTEST; OMEGABOUNDTEST may also be coded OBT or OBOUNDTEST;<br>SIGMABOUNDTEST may also be coded SBT or SBOUNDTEST. These options are<br>the defaults.<br>
NOTHETABOUNDTEST, NOOMEGABOUNDTEST, NOSIGMABOUNDTEST<br>
Instructs NONMEM to omit the &quot;default boundary test&quot; for this type of variable, i.e.,<br>to behave like NONMEM V in this regard. Any option listed above may be pre-<br>ceded by &quot;NO&quot;. The THETA, OMEGA, and SIGMA choices are independent of<br>each other. E.g., it is possible to specify NOOBT (to prevent the &quot;default OMEGA<br>boundary test&quot;) and permit both the &quot;default THETA boundary test&quot; and &quot;default<br>SIGMA boundary test&quot;.<br>
OMITTED<br>
The Estimation Step is not implemented.<br>
OPTMAP=<i>n </i>(NM73)<br>
For alternative MAP (eta optimization) methods. With OPTMAP&gt;0, SLOW option<br>may be needed.<br>
OPTMAP=0<br>
Standard variable metric (Broyden, Fletcher, Goldfarb, and Shanno (BFGS))<br>optimization method used by NONMEM to ﬁnd optimal eta values (referred to<br>as eta hat) for each subject at the mode of their posterior densities, using analyt-<br>ical derivatives of F with respect to etas (G), and analytical derivatives of F<br>with respect to etas (H), that were supplied by NMTRAN or by the user. This<br>is the default.<br>
OPTMAP=1<br>
Variable metric method using numerical ﬁnite difference methods for ﬁrst de-<br>rivatives of F with respect to etas. Necessary when not all code used in evaluat-<br>ing F, G and H for observation event records is abbreviated code (some may be<br>in verbatim code), and/or some portions of the computation of F, G and H are<br>evaluated in a hidden subroutine speciﬁed by &quot;$SUBROUTINES OTHER=&quot;<br>and the user-written code does not compute the eta derivatives. When<br>OPTMAP=1 is present, values of G and H are ignored during eta optimization.<br>This may be used to test user-coded deriatives, because two runs, one with<br>OPTMAP=1 and one without it, should give very similar values for the OBJV,<br>
174<br>
<hr>
<A name=180></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
WRES, etc. if the user-coded derivatives are correct.<br>
OPTMAP=2<br>
Nelder Mead method, which uses a secant method, rather than relying on deriv-<br>atives.<br>
ORDER=xxxf<br>
The values of x may be T (Theta), S (Sigma), and O (Order). The value of f may be<br>U (Upper) or L (Lower). Affects the way theta, omega, and sigma are displayed in<br>the raw and additional output ﬁles. xxx gives the overall order, and f gives the order<br>within OMEGA and SIGMA. Affects the raw output ﬁle and all additional output<br>ﬁles. The default is TSOL: THETA, SIGMA, OMEGA in Lower triangular form.<br>Does not affect the NONMEM report ﬁle.<br>(See <b>order_option</b>).<br>
OSAMPLE_M1=<i>n</i><br>
Used only with the BAYES method. <i>n </i>is the number of times each iteration that<br>OMEGA is generated using the Metropolis-Hastings algorithm and a Wishart pro-<br>posal density that has variance based on the previous samples. If <i>n </i>&lt; 0 this indicates<br>that the OMEGA’s are Gibbs sampled using the appropriate Wishart proposal den-<br>sity and other options are not relevant. Default is -1.<br>
OSAMPLE_M2=<i>n</i><br>
Used only with the BAYES method. <i>n </i>has meaning only for OMEGA sampled by<br>the Metropolis-Hastings algorithm. <i>n </i>is the number of times that OMEGA is gener-<br>ated using a Wishart proposal density at the present OMEGA position and degrees<br>of freedom scaled to have samples accepted a particular fraction of the time. If <i>n </i>&lt; 0<br>this is done as many times as there are non-ﬁxed OMEGA elements. Default is -1.<br>
OVARF=<i>x </i>(NM74)<br>
Used with NUTS method and OLKJDF option. Default is 1.<br>
PACCEPT=<i>n</i><br>
Used only with the BAYES method. <i>n </i>has meaning only for population parameters<br>sampled by the Metropolis-Hastings algorithm. The scaling of variance is adjusted<br>so that samples are accepted <i>n </i>fraction of the time. See PSAMPLE_M2=. Default is<br>0.5.<br>
PARAFILE=ﬁlename<br>
Name of the &quot;parallel ﬁle&quot; (the parallelization proﬁle) that controls parallelization<br>(distributed computing). Default ﬁle name if not speciﬁed: parallel.pnm or paraﬁle<br>name speciﬁed on nmfe command.<br>PARAFILE=ON<br>
turns on parallelization for this $ESTIMATION record.<br>
PARAFILE=OFF turns off parallelization for this $ESTIMATION record.<br>
PARAFPRINT=<i>n </i>(NM74)<br>
The print iteration intervals to the parallelization log ﬁle can be controlled by this<br>option during parallelization of the $EST step. See also $COVARIANCE record<br>and nmfe74 command. Default is PARAFPRINT=1.<br>
PHYTYPE=<i>n </i>(NM74)<br>
Default is 0. By default, after an estimation is performed, the phi(), conditional<br>means of the individual parameters, and their variances, are reported in the root.phi<br>ﬁle, where root is the root name of the control stream ﬁle. If you wish to have condi-<br>tional mean etas reported, set PHITYPE=1.<br>See &quot;Stochastic Approximation Expectation Maximization (SAEM) Method&quot; in<br>Guide INTRODUCTION TO NONMEM 7.<br>
175<br>
<hr>
<A name=181></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
POSTHOC<br>
This option may be used when the FO method is used. After the Estimation Step<br>terminates, the eta values are estimated for each individual. To estimate the etas<br>based on the initial estimates of THETA, OMEGA, and SIGMA (found either in the<br>control stream or in a model speciﬁcation ﬁle), also specify MAXEVAL=0 (which<br>omits the Estimation Step). The conditional estimates of the etas are referred to as<br>Conditional Parametric Etas (CPE).<br>
NOPOSTHOC<br>
Etas are not estimated. This is the default with METHOD=0. May not be used with<br>METHOD=1.<br>
<b>PREDICTION</b><br>
Indicates that Y (with NM-TRAN abbreviated code) or F (with a user-supplied<br>PRED or ERROR code) will serve as a prediction variable, i.e., it will be set to a<br>prediction. Upon simulation, the simulated observation is possibly also being set in<br>Y or F. (However, the DV data item may instead be set directly to the simulated<br>observation.) Also, etas (if any) are population etas only if epsilons also appear.<br>This is the default. Compare with LIKELIHOOD, -2LOGLIKELIHOOD options.<br>
PRINT=<i>n</i><br>
Iteration summaries are printed for the 0th, every <i>n</i>th iteration, and last iteration.<br>When <i>n</i>=0, no summaries are printed. Default: 9999 (so that summaries are printed<br>for 0th and last iterations).<br>
PRIORC (NM74)<br>
The objective function is reported including the prior constant term (constant term to<br>the prior).<br>
PSAMPLE_M1=<i>n</i><br>
Used only with the BAYES method. <i>n</i>n has meaning only for population parameters<br>sampled by the Metropolis-Hastings algorithm. <i>n </i>is the number of times that a vec-<br>tor of THETA’ s and SIGMA’s are generated using a multivariate normal proposal<br>density that has mean/variances based on the previous samples. Default is 1.<br>
PSAMPLE_M2=<i>n</i><br>
Used only with the BAYES method. <i>n </i>has meaning only for population parameters<br>sampled by the Metropolis-Hastings algorithm. <i>n </i>is the number of times that a vec-<br>tor of THETA’ s and SIGMA’s are generated using a multivariate normal proposal<br>density that has mean at the present parameter position and variance scaled to have<br>samples accepted a particular fraction of the time. If <i>n </i>&lt; 0 this is done as many times<br>as there are Metropolis-Hastings parameters. Default is -1.<br>
PSAMPLE_M3=<i>n</i><br>
Used only with the BAYES method. <i>n </i>has meaning only for population parameters<br>sampled by the Metropolis-Hastings algorithm. <i>n </i>is the number of times in mode 3<br>that each parameter is individually sampled. Default is 1.<br>
PSCALE_MIN=<i>n</i>, PSCALE_MAX=<i>n </i>(NM74)<br>
In MCMC sampling, the scale factor used to vary the size of the variance of the pro-<br>posal density population parameters (theta/sigma) that are not Gibbs sampled, in<br>order to meet the PACCEPT condition, is by default bounded by PSCALE_MIN of<br>0.01, and PSCALE_MAX=1000. This should left alone for MCMC sampling, but<br>on occasion there may be a reason to expand the boundaries (perhaps to<br>PSCALE_MIN=1.0e-06, PSAMPLE_MAX=1.0E+06).<br>
176<br>
<hr>
<A name=182></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
RANMETHOD=[n|S|m|P] (NM72)<br>
See <b>INTRODUCTION TO NONMEM 7</b>, Reference [4] and [6].<br>n: the random number generator used for all Monte Carlo EM and Bayesian meth-<br>ods.<br>
0: ran0 of reference [4], minimal standard generator<br>1: ran1 of reference [4], Bays and Durham.<br>2: ran2 of reference [4].<br>3: ran3 of reference [4], Knuth. (Default)<br>4: NONMEM’s traditional random number generator used in $SIMULATION<br>
S: sobol method without scrambling, used during importance or direct sampling<br>(methods IMP, IMPMAP, and DIRECT) and only for the purpose of creating quasi-<br>random samples of eta vectors. As of NONMEM 7.3, Sobol may be used for<br>BAYES and SAEM methods as well.<br>m: the type of scrambing desired<br>
0: no scrambing (S0 is the same as S)<br>1: Owen type scrambling<br>2: Faure-Tezuka type scrambling<br>3: Owen plus Faure-Tezuka type scrambling.<br>
P: each subject will receive its own seed path, that will stay with that subject regard-<br>less of whether the job is run as a single process or parallel process. (NM74)<br>
The RANMETHOD speciﬁcation propagates to subsequent $EST records in a given<br>problem, but does not propagate to $CHAIN or $TABLE records.<br>
REPEAT<br>
The search is repeated with the initial estimates being the ﬁnal estimates from the<br>ﬁrst search and with new UCP, so that a UCP value of 0.1 now corresponds to a ﬁnal<br>estimate from the ﬁrst search. Cannot be used with STIELTJES.<br>
<b>NOREPEAT</b><br>
The estimate obtained at the end of the minimization search is taken to be the ﬁnal<br>parameter estimate. This is the default. Cannot be used with STIELTJES.<br>
REPEAT1<br>
The search of the ﬁrst stage of the Stieltjes method is repeated with the initial esti-<br>mates being the ﬁnal estimates from the ﬁrst search and with new UCP, so that a<br>UCP value of 0.1 now corresponds to a ﬁnal estimate from the ﬁrst search. May<br>only be used with STIELTJES.<br>
<b>NOREPEAT1</b><br>
The estimate obtained at the end of the search of the ﬁrst stage of the Stieltjes<br>method is taken to be the ﬁnal parameter estimate at the ﬁrst stage. This is the<br>default. May only be used with STIELTJES.<br>
REPEAT2<br>
The search of the second stage of the Stieltjes method is repeated with the initial<br>estimates being the ﬁnal estimates from the ﬁrst search and with new UCP, so that a<br>UCP value of 0.1 now corresponds to a ﬁnal estimate from the ﬁrst search. May<br>only be used with STIELTJES.<br>
<b>NOREPEAT2</b><br>
The estimate obtained at the end of the search of the second stage of the Stieltjes<br>method is taken to be the ﬁnal parameter estimate at the second stage. This is the<br>default. May only be used with STIELTJES.<br>
177<br>
<hr>
<A name=183></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
SADDLE_HESS=<i>n </i>(NM74)<br>
SADDLE_HESS=0 selects the Hessian matrix last generated by the variable metric<br>method. SADDLE_HESS=1 causes the full second derivative information matrix<br>(identical to R matrix in the $COV step) to be evaluated. Default is 0.<br>See &quot;Resetting the Search to Circumnavigate Saddle Points and Detect Inestimable<br>Parameters&quot; in Guide INTRODUCTION TO NONMEM 7 for a discussion of SAD-<br>DLE_HESS and SADDLE_RESET options.<br>
SADDLE_RESET=<i>n </i>(NM74)<br>
SADDLE_RESET is the number of times that a reset should occur in the course of<br>the search. Normally, should be set to 1. Default is 0.<br>
SEED=<i>n</i><br>
The initial seed for the random number generator used for the Monte-Carlo methods.<br>Default is 14455.<br>
SELECT=[0|1|2|3] (NM73)<br>
Used with METHOD=CHAIN and $CHAIN to specify how the sample is selected.<br>SELECT=0<br>If ISAMPEND&gt;=ISAMPLE, then the default action for selecting between ISAM-<br>PLE and ISAMPEND is taken, which for $EST METHOD=CHAIN is to ﬁnd the<br>one giving the best OBJ at the initial values, and for $CHAIN is to randomly select a<br>sample, with replacement. This is the default.<br>SELECT=1<br>The sample is selected sequentially from ISAMPLE to ISAMPEND with each new<br>use of $CHAIN/$SIML with multiple sub-problems for the given problem, and with<br>each new $EST METHOD=CHAIN with multiple sub-problems and across prob-<br>lems. When ISAMPEND is reached, the sample selection begins at ISAMPLE<br>again.<br>SELECT=2<br>Uniform random selection of sample, without replacement. Should the sample<br>selection become exhausted, which would occur if CHAIN or $CHAIN records are<br>utilized for more than ISAMPEND-ISAMPLE+1 times, subsequent sample selection<br>then occurs with replacement.<br>SELECT=3<br>Uniform random selection of sample, with replacement (this is equivalent to<br>SELECT=0 for $CHAIN).<br>
SIGDIGITS=<i>n</i><br>
Number of signiﬁcant digits required in the ﬁnal parameter estimate. SIGDIGITS<br>is not used by the Monte-Carlo methods. Default: 3. May also be coded NSIGDIG-<br>ITS.<br>
SLKJDF=<i>n </i>(NM74)<br>
Used with NUTS method, SLKJDF stands for Sigma LKJ density degrees of free-<br>dom. Default is 0.<br>
SIGL=<i>n</i><br>
<i>n </i>is used to calculate the step-size for ﬁnite difference derivatives independent of the<br>SIGDIGITS value. If <i>n</i>=0 or <i>n</i>=100 then SIGL is ignored and SIGDIGITS is<br>used as in versions prior to NONMEM 7. SIGL should usually be 2 to 3 times the<br>value of NSIG. It is not used by the SAEM or BAYES methods.<br>
SIGLO=<i>n </i>(NM72)<br>
The precision to which the individual etas are optimized. The SIGL value set by the<br>
178<br>
<hr>
<A name=184></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ESTIMATION,$ESTM<br>
user continues to be the precision (or delta ) setting for the ﬁnite difference algo-<br>rithms in the higher level estimation process for THETAS, OMEGAS, and SIG-<br>MAS. By default, if SIGLO is not speciﬁed, then SIGLO is set to the same value as<br>SIGL. Should SIGLO be used, the recommended setting would be:<br>SIGLO&lt;=TOL<br>SIGL&lt;=SIGLO<br>NSIG&lt;=SIGL/3<br>
SIGMABOUNDTEST<br>
See OMEGABOUNDTEST.<br>
SLOW<br>
Requests a slower method of computation. Required when either a mixture model is<br>used along with CENTERING, or NUMERICAL is used. If not present, the option is<br>automatically supplied in these two cases. For problems where NONMEM VI does<br>not behave as well (e.g. yields a higher OFV at termination) compared to NONMEM<br>V, inclusion of the SLOW option may sometimes, but not always, yield NONMEM<br>VI results that are similar to NONMEM V.<br>
SLOW=1<br>
Same as SLOW.<br>
<b>NOSLOW</b><br>
Requests a faster method of computation. This is the default (but see SLOW)<br>
SLOW=2<br>
This option is permitted with STIELTJES.<br>
SORT<br>
Individual contribution to the objective function value and individual contributions<br>to the gradients are sorted before they are summed, so that smaller numbers are<br>summed before larger numbers.<br>
<b>NOSORT</b><br>
Individual contribution to the objective function value and individual contributions<br>to the gradients are summed in the order in which the individual records appear in<br>the NONMEM data set, as was done prior to NONMEM VI. This is the default.<br>
STDOBJ=<i>r </i>(NM74)<br>
For importance sampling and direct sampling only, if ISAMPEND is speciﬁed as an<br>upper integer value, and STDOBJ is set to a real value greater than 0, then NON-<br>MEM will vary the number of Monte Carlo samples under each subject between<br>ISAMPLE and ISAMPEND, until the stochastic standard deviation of the objective<br>function falls below STDOBJ.<br>
STIELTJES<br>
A set of tentative population estimates are ﬁrst obtained using some 1st- or 2nd-<br>order method. A tentative value for the integral (i.e. an area) is obtained. Then<br>numerical integration is used to obtain second-stage estimates. See the Introduction<br>to Version VI 2.0. Not permitted with METHOD=HYBRID.<br>
SVARF=<i>x </i>(NM74)<br>
Used with NUTS method and SLKJDF option. Default is 1.<br>
THETABOUNDTEST<br>
See OMEGABOUNDTEST.<br>
TTDF=<i>n </i>(NM74)<br>
TTDF stands for Theta t-density degrees of freedom. Default is 0.<br>
179<br>
<hr>
<A name=185></a>$ESTIMATION,$ESTM DETAILED DESCRIPTIONS<br>
Help Guide<br>
ZERO=list<br>
Required with METHOD=HYBRID. A list of indices for etas which are ﬁxed to zero<br>during the Estimation Step. &quot;list&quot; contains one or more integers. If more than one,<br>they must be surrounded by parentheses. The list must be contained entirely on one<br>line. The indices may be separated by commas or spaces.<br>
Reserved Variables that are of Interest During the Estimation Step<br>
MUFIRSTREC (NM74)<br>
The MUFIRSTREC option can speed up the NUTS method, and also ordinary<br>BAYES, FAST FOCE, ITS, and the EM methods. Set MUFIRSTREC=1 in $PRED<br>or $PK. MUFIRSTREC=1 selects the covariate of the ﬁrst record of the subject,<br>rather than averaging among its records when using that covariate in a MU refer-<br>ence.<br>The ﬁrst statement of the $PRED or $PK block should be<br>include nonmem_reserved_general.<br>
OBJQUICK (NM74)<br>
The OBJQUICK option can speed up the NUTS method, and also ordinary BAYES,<br>FAST FOCE, ITS, and the EM methods. Set OBJQUICK in $PRED or $PK.<br>
OBJQUICK=0<br>
Default. Standard NONMEN processing of the model occurs.<br>
OBJQUICK=1<br>
Certain tests and initializations are skipped.<br>
OBJQUICK=2<br>
A simpliﬁed modeling process occurs, but which cannot be used when<br>$LEVEL or $MIX is used in the model.<br>
The ﬁrst statement of the $PRED or $PK block should be<br>include nonmem_reserved_general.<br>
REFERENCES: Guide I, section C.3.5.1<br>REFERENCES: Guide II, section E , F<br>REFERENCES: Guide IV, section III.B.14 , IV.G<br>REFERENCES: Guide V, section 9.4.1, , 13.2<br>REFERENCES: Guide VII, section I , II , III<br>REFERENCES: Guide Introduction_7<br>
180<br>
<hr>
<A name=186></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$ETAS,$PHIS<br>
$ETAS,$PHIS<br>
MEANING: Speciﬁes Initial Values for Etas or Phis<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$ETAS [[<i>value</i>1 [<i>value</i>2] [<i>value</i>3] ... [<i>valuen</i>]]<br>
[FILE=ﬁlename FORMAT=<i>s</i>1 [TBLN=<i>n</i>]]<br>
$PHIS [[<i>value</i>1 [<i>value</i>2] [<i>value</i>3] ... [<i>valuen</i>]]<br>
[FILE=ﬁlename FORMAT=<i>s</i>1 [TBLN=<i>n</i>]]<br>
SAMPLE:<br>$ETAS 0.4 3.0 3.0 5.0<br>
$PHIS 0.4 3.0 3.0 5.0<br>
$ETAS FILE=myprevious.phi FORMAT=s1pE15.8 TBLN=3<br>
$PHIS FILE=myprevious.phi FORMAT=s1pE15.8 TBLN=3<br>
NONMEM describes the use of these records with messages in the report ﬁle such as the<br>following:<br>
LOADED 3 PHI/ETA ITEMS FROM CONTROL STREAM<br>
DISCUSSION:<br>
By default, the initial value used for ETA’ s in the Estimation Step search is 0. The<br>$ETAS and $PHIS records provide different initial estimates. Optional.<br>
OPTIONS:<br>
There are two forms:<br>
$ETAS <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...[[<i>valuen</i>]<br>
All of the subjects in the data set will be given these initial values of etas. If fewer<br>values are listed than the number of etas in the problem, the value 0 will be used for<br>the remaining etas. Any real value (positive, neg ative, zero) may be speciﬁed.<br>
When the record is $PHIS, values are entered as phi values, convenient for EM<br>methods. The eta values will then be evaluated as <i>eta</i>(<i>i</i>) = <i>phi</i>(<i>i</i>) − <i>mu</i>(<i>i</i>) for each<br>eta, where <i>mu</i>(<i>i</i>) = <i>mu</i>_<i>i </i>is evaluated according to their deﬁnitions in the $PK sec-<br>tion.<br>
FILE=ﬁlename FORMAT=<i>s</i>1 TBLN=<i>n</i><br>
Uses initial etas and/or phis for an entire set of subjects from a ﬁle .phi or .phm (in<br>the case of mixture problems) of a previous analysis.<br>
With FORMAT, <i>s</i>1 deﬁnes the delimiter [,|s(pace)|t(ab)] followed by a Fortran for-<br>mat speciﬁcation. The default is s1PE12.5. FORMAT should at least have the<br>delimiter appropriate to read the ﬁle.<br>
TBLN is the table number in the ﬁle. If TBLN is not speciﬁed, it defaults to 1, i.e.,<br>the ﬁrst set of etas/phis are brought in.<br>
In matching the etas/phis to the data set given in $DATA of the control stream ﬁle,<br>the attempt will be to match ID numbers rather than subject numbers, if an ID col-<br>umn in the ﬁle exists, which it will, if you are using a .phi or .phm ﬁle generated<br>from a previous nonmem analysis. The phc/etc variances will also be brought in.<br>
One purpose to bringing initial eta/phi and etc/phc values is you can readily resume<br>an analysis, if an MSF ﬁle was not set up in the previous analysis (the MSF ﬁle sys-<br>tem is still the most complete information transfer for resuming an analysis.<br>
181<br>
<hr>
<A name=187></a>$ETAS,$PHIS DETAILED DESCRIPTIONS<br>
Help Guide<br>
FURTHER DISUCSSION<br>
The etas from $ETAS/$PHIS can be used in several ways.<br>
In METHOD=0 (FO), they are ignored, because FO is speciﬁcally designed as a ﬁrst<br>order Taylor series approximation process centered around eta=0.<br>
In METHOD=1 (FOCE), they are ignored unless MCETA&gt;0. When MCETA&gt;0, then<br>various starting etas are tested, including a set from $ETAS, when available.<br>
In Bayes, SAEM, IMP MAPITER=0 they are used as the starting etas.<br>
In MAP estimation methods, such as METHOD=1, or ITS, or IMP MAPITER&gt;0, or<br>IMPMAP, and if MCETA&gt;0, then these etas are one of the initial eta vector positions<br>tested (during the ﬁrst iteration), and the one giving the lowest OBJ is then selected.<br>
In cases where FNLETA=2, the estimation step is skipped, and etas inputted from $ETAS<br>are treated as if they were the ﬁnal result of an estimation.<br>
For examples and discussion:<br>
See <b>INTRODUCTION TO NONMEM 7, $ETAS and $PHIS Record For Inputting<br>Speciﬁc Eta or Phi values</b><br>
REFERENCES: Guide Introduction_7<br>
182<br>
<hr>
<A name=188></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$INDEX,$INDXS<br>
$INDEX,$INDXS<br>
MEANING: Deﬁnes values for the PRED/PREDPP INDXS array<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$INDEX [<i>label</i>1|<i>value</i>1] [<i>label</i>2|<i>value</i>2] [<i>label</i>3|<i>value</i>3] ...<br>SAMPLE:<br>$INDEX DOSE<br>
1<br>
DISCUSSION:<br>Optional. Used only with user-supplied FORTRAN subroutines (ERROR, PK, INFN,<br>PRED) which make explicit use of the INDXS array. May also be coded $INDXS or<br>$INDEXES.<br>
OPTIONS:<br>
The labels are those of data items on the $INPUT record. The values are integers no<br>larger than the number of data items in the NONMEM input data set. Either the index of<br>the data items with <i>labeli </i>or <i>valuei </i>is stored in INDXS(i). (The index of a data item is its<br>position in the NONMEM data record.)<br>
REFERENCES: Guide I, section C.4.1<br>REFERENCES: Guide IV, section III.B.3<br>REFERENCES: Guide VI, section III.C , V.A<br>
183<br>
<hr>
<A name=189></a>$INFN DETAILED DESCRIPTIONS<br>
Help Guide<br>
$INFN<br>
MEANING: Marks the beginning of abbreviated code for the INFN routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$INFN<br>abbreviated code<br>
SAMPLE:<br>
$INFN<br>
IF (ICALL.EQ.1) CALL SUPP (1,1)<br>
DISCUSSION:<br>The $INFN record is used to describe initialization processing for a NONMEM run, or<br>NONMEM problem, or ﬁnalization processing for a NONMEM problem. It is used with<br>PREDPP.<br>
General rules for abbreviated code are documented elsewhere (See <b>abbreviated code</b>).<br>Speciﬁc rules for $INFN blocks are described elsewhere.<br>(See <b>Initialization-Finalization block</b>, <b>Finalization example</b>).<br>
RECORD ORDER:<br>
Follows $SUBROUTINES.<br>
REFERENCES: None.<br>
184<br>
<hr>
<A name=190></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$INPUT<br>
$INPUT<br>
MEANING: Deﬁnes the data item types in the data set<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$INPUT <i>item</i><br>
. . .<br>
1 <i>item</i>2 <i>item</i>3<br>
SAMPLE:<br>$INPUT ID DOSE TIME CP=DV WT<br>
DISCUSSION:<br>The items deﬁne the data item types that appear in the NM-TRAN data records, and<br>deﬁne the order of their appearance.<br>
This record is required. It must precede any other NM-TRAN control record that refers to<br>speciﬁc data item types.<br>
With NONMEM VI 2.0 and later versions, the length of a single $INPUT record (and all<br>records of the NM-TRAN input ﬁle) is at most 160 characters. (Previously, it was 80<br>characters.) With NONMEM 7.3, the maximum length is given by FSD in<br>resource/SIZES.f90 (FSD=67000 with NONMEM 7.3). With NONMEM 7.2 and higher,<br>both lower and upper case may be used for all user-deﬁned and reserved words in the<br>control stream. With NONMEM 7.3 and higher, &amp; may be used at the end of any line of<br>the control stream to indicate that the line is to be continued, including control records as<br>well as abbreviated code.<br>
Multiple $INPUT records may be used. Each continues the previous record.<br>
OPTIONS:<br>
Each item has form B or A=B, where A and B are data item labels.<br>
With previous versions of NONMEM labels were restricted to 4 characters in length and<br>could not include the character _. With NONMEM 7 a label consists of 1-24 letters (A-<br>Z), numerals (0-9), and the character ’_’, beginning with a letter. (The length 24 is speci-<br>ﬁed by constant SDF in SIZES)<br>(See <b>SIZES</b>).<br>
The labels may be used in subsequent NM-TRAN control records and will be used as<br>labels for data items in NONMEM output.<br>
Certain data item labels are <i>reserved </i>and refer to data items that may be needed by NON-<br>MEM or PREDPP, i.e.,<br>
ID L1 L2 DV MDV<br>
RAW_ MRG_ RPT_<br>
TIME DATE DAT1 DAT2 DAT3 DROP SKIP EVID AMT RATE SS II ADDL<br>
CMT PCMT CALL CONT<br>
Certain data item labels are semi-reserved, in that they hav e reserved meanings if used in<br>$INPUT, but can also be user-deﬁned in abbreviated code, in which case they hav e no<br>reserved meaning, i.e.,<br>
XVID1 XVID2 XVID3 XVID4 XVID5<br>(See <b>evid data item</b>).<br>
185<br>
<hr>
<A name=191></a>$INPUT DETAILED DESCRIPTIONS<br>
Help Guide<br>
Others are labels assigned by the user, e.g., to label user (concomitant) data.<br>
Certain labels should not appear in the $INPUT record:<br>
ETA1 ETA2 ETA3 ETA4 ETA5 ETA6 ETA7 ETA8 ETA9<br>Labels for basic PK parameters (e.g., CL, V, K, KA)<br>Labels for additional PK parameters (e.g., S1, F0, R1, F1)<br>Arguments of subroutines internal to NONMEM/PREDPP<br>Mu variables (e.g., MU_ MU_i )<br>
When the form A=B is used, at least one of the labels A or B must be a reserved label. If<br>A or B is a non-reserved label, it is a synonym for the reserved label. The synonym is<br>used as the label in NONMEM output.<br>
If DROP (or SKIP) is used as a data item label or synonym, the data item type will not<br>appear in the NONMEM data set. DROP (or SKIP) may be used with more than one<br>item.<br>
If the label DATE (or DAT1, DAT2, or DAT3) is used, DATE=DROP causes the data item<br>to not appear in the NONMEM data set. However, NMTRAN will adjust the TIME data<br>item to reﬂect the date.<br>(See <b>date data item</b>).<br>
REFERENCES: Guide IV, section III.B.2 , V.C.1<br>REFERENCES: Guide V, section 6.5<br>REFERENCES: Guide VI, section V.A<br>
186<br>
<hr>
<A name=192></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$LEVEL<br>
$LEVEL<br>
MEANING: Speciﬁes Nested Random Levels Above Subject ID<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$LEVEL item=(<i>n</i>1[<i>m</i>1] , <i>n</i>2[<i>m</i>2] ... ) ...<br>SAMPLE:<br>$LEVEL<br>
DISCUSSION:<br>
Identiﬁes one or more Super ID data items.<br>
item<br>
Item is the name of a data item listed on $INPUT. It deﬁnes an additional nested<br>random level. and is referred to as a &quot;super ID&quot; data item. The ﬁrst super ID item<br>deﬁnes an additional random nesting level above that of subject ID. More than one<br>super ID item may be listed on $LEVEL. Each subsequent super ID item deﬁnes an<br>additional nesting level above that of the previous nesting level, i.e., above the previ-<br>ous super ID.<br>
<i>nk</i>[<i>mk</i>]<br>
States that ETA(<i>nk</i>) is associated with this super ID item, and ETA(<i>mk</i>) is nested<br>within ETA(<i>nk</i>).<br>
With NONMEM 7.4, a short-hand notation may be used to describe a series of values of<br><i>nk</i>. A sequence of values for <i>nk </i>can be described as<br>
start TO end BY interval<br>
TO is required. The character : may be used instead of TO. BY is optional. Default<br>is 1. The value of BY may be negative.<br>
If the second value of BY differs, the same syntax may also be used for <i>mk</i>.<br>Nesting levels below the subject ID is modelled as with previous versions of NONMEM.<br>(See <b>Interoccasion_variability example</b>).<br>
The order that super ID’s are listed on $LEVEL deﬁnes their nesting level. The order that<br>standard and super ID’s are listed on $INPUT (i.e., the order in which they appear in each<br>record of the data set) is immaterial.<br>
When $LEVEL is used with FOCE ($ESTM METHOD=1), the SLOW option is<br>required, and MATRIX=R is required with $COV.<br>
EXAMPLE:<br>
$INPUT ... ID ... SID ... CID ...<br>
...<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
CL=DEXP(MU_1+ETA(1)+ETA(5)+ETA(9))<br>
V1=DEXP(MU_2+ETA(2)+ETA(6)+ETA(10))<br>
...<br>
$LEVEL<br>
SID=(5[1],6[2])<br>
CID=(9[5],10[6])<br>
187<br>
<hr>
<A name=193></a>$LEVEL DETAILED DESCRIPTIONS<br>
Help Guide<br>
The data item named SID is the site ID. The data item named CID is the country ID.<br>There are several sites belonging to one country, some other sites belonging to another<br>country, etc. For clearance, eta(9) is the country variability that has nested in it the site<br>variability eta(5), which in turn has nested in it the subject variability (the standard ID<br>data) eta(1). For V1, eta(10) is the country variability that has nested in it the site vari-<br>ability eta(6), which in turn has nested in it the subject variability (the standard ID data)<br>eta(2).<br>
An alternate way of coding the $LEVEL records is<br>
SID=(5 to 6[1])<br>
CID=(9 to 10[5])<br>
NONMEM performs appropriate summary statistics for eta(5), and makes the appropriate<br>constraints on eta(5), so eta(5) changes by site, that is, by every SID value change, and<br>not by every ID value change.<br>
The above method, using $LEVEL, is a linearized approximation at the super ID level,<br>and takes advantage of a dual OBJ function call, freely allowing all etas to vary on the<br>ﬁrst call of OBJ, then averaging the SID etas, ﬁxing them to these averages, and going<br>through another OBJ call to allow the subject (ID) etas to be assessed. This approxima-<br>tion method works very well for the EM and Monte Carlo methods, and reasonably well<br>for the FOCE/Laplace methods.<br>
To perform an exact analysis, separate thetas must be deﬁned for each value pertaining to<br>a super ID data item, so that theta is shared only by the subjects with the particular SID<br>value. $LEVEL is not used.<br>(See <b>superid3_6</b>).<br>
If there are multiple $PROBLEM records, $LEVEL should be restated with each prob-<br>lem for which it is still relevant. For example, this is the case with $SUPER problems<br>and $LEVEL.<br>
See also LEVWT option of the $ESTIMATION record (NM74). By default, LEVWT=0,<br>and weights each level value equally, reg ardless of number of subjects per level value. If<br>you wish to weight according to number of subjects for that value, set LEVWT=1 on the<br>$EST record.<br>
REFERENCES: Guide Introduction_7<br>
188<br>
<hr>
<A name=194></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$MIX<br>
$MIX<br>
MEANING: Marks the beginning of abbreviated code for the MIX routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$MIX<br>abbreviated code<br>
SAMPLE:<br>
$MIX<br>
NSPOP=2<br>
P(1)=THETA(5)<br>
P(2)=1-THETA(5)<br>
DISCUSSION:<br>The $MIX record is used to describe the mixture probabilities of a mixture model. It is<br>evaluated with individual records.<br>
General rules for abbreviated code are documented elsewhere (See <b>abbreviated code</b>).<br>Speciﬁc rules follow.<br>
ASSIGNMENT AND CONDITIONAL STATEMENTS<br>
Left-hand quantities in assignment statements:<br>
NSPOP<br>
An integer variable. The number of sub-populations. Must be given a value when<br>ICALL=1.<br>
P(i)<br>
For each i (i=1, ... , NSPOP), P(i) is the modeled fraction of the population in the ith<br>subpopulation. The sum of the P(i) should equal 1. In principle, the P(i) can change<br>from individual to individual. If for a given individual, the second (for example)<br>subpopulation doesn’t apply, then set P(2)=0 for that individual. MIXP may be<br>coded instead of P; they are synonymous in the context of the $MIX block.<br>
Right-hand quantities in assignment statement and in conditions:<br>
THETA(n).<br>
MIX-deﬁned items that appeared earlier as left-hand quantities.<br>
ICALL<br>
ICALL=0: Run initialization.<br>ICALL=1: Problem initialization.<br>ICALL=2: Normal call.<br>ICALL=4: Simulation.<br>
Data items listed in DAT A option of $CONTR record<br>
E.g., assume that the following records appear in the control stream prior to the<br>$MIX block:<br>
$INPUT ... STDY ...<br>
189<br>
<hr>
<A name=195></a>$MIX DETAILED DESCRIPTIONS<br>
Help Guide<br>
$CONTR DATA=(STDY)<br>Then STDY may be used on the right in $MIX. STDY and STDY(1) both refer<br>to the value of STDY on the ﬁrst observation record of the individual record.<br>STDY(i) refers to the value of STDY on the i-th. observation record of the indi-<br>vidual record. TEMPLT may be used.<br>(See <b>MIX CONTR: TEMPLT</b>).<br>
Global Variables in Modules<br>
Certain variables in FORTRAN modules can be used. (See <b>Variables_in_modules</b>)<br>
May not include:<br>
EXIT, CALL , DO WHILE / ENDDO statements<br>
COMRES, CALLFL pseudo-variables<br>
Forbidden Variable Names:<br>
NEWIND,ETA(i),EPS(i),ERR(i) COM(i)<br>
Variables deﬁned in $MIX are not listed in module NMPRD4 and may not be displayed<br>in $TABLE and $SCATTER.<br>
RECORD ORDER:<br>
Follows $SUBROUTINES.<br>
REFERENCES: Guide IV, section III.B.4 , III.B.6<br>
REFERENCES: Guide IV, section IV.E.1 , 4.E.2<br>
REFERENCES: Guide VI, section III.L.2 , Figure 6<br>
190<br>
<hr>
<A name=196></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$MODEL<br>
$MODEL<br>
MEANING: Speciﬁes the MODEL subroutine of PREDPP<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$MODEL [NCOMPARTMENTS=<i>n</i>1] [NEQUILIBRIUM=<i>n</i>2] [NPARAMETERS=<i>n</i>3]<br>
[COMPARTMENT=([name] [<i>attribute</i>1] [<i>attribute</i>2] ...)] ...<br>[LINK <i>compnamea </i>[<b>TO</b>|AND] <i>compnameb </i>BY k [l]] ...<br>[I_SS=<i>n</i>]<br>
SAMPLE:<br>$MODEL NPARAMETERS=3<br>
COMP=(DEPOT DEFDOSE INITIALOFF) COMP=(CENTRAL DEFOBS NOOFF)<br>
DISCUSSION:<br>Required with a general ADVAN (ADVAN5,6,7,8,9,13,14,15).<br>
OPTIONS:<br>
NCOMPARTMENTS=<i>n</i>1<br>
Total number of compartments other than the output compartment. Default: the<br>number of COMPARTMENT options. May also be coded NCM or NCOMPS.<br>
NEQUILIBRIUM=<i>n</i>2<br>
Number of equilibrium compartments. Default: 0<br>
NPARAMETERS=<i>n</i>3<br>
Number of basic PK parameters. Default: The number of basic PK parameters<br>deﬁned in the $PK abbreviated code. May also be coded NPARAMS. May be 0 with<br>the general non-linear models (ADVAN6, ADVAN8, ADVAN9, ADVAN13,<br>ADVAN14, ADVAN15).<br>
COMPARTMENT= ([name] [<i>attribute</i>1] [<i>attribute</i>2] ...)<br>
Each COMPARTMENT option deﬁnes a single compartment. Compartments are<br>numbered in the order in which they are deﬁned. The name option gives the name<br>for the compartment. The name option may not be one of the compartment<br>attributes below, unless it is enclosed in quotes (’ or &quot;).<br>If the name option is not used, then the compartment is named &quot;COMPn,&quot; where n is<br>the compartment number.<br>
Attributes are chosen from the following list. When an attribute is not chosen, its<br>opposite is the default.<br>
INITIALOFF - Compartment is initially off.<br>NOOFF - Compartment may not be turned on or off.<br>NODOSE - Compartment may not receive a dose.<br>EQUILIBRIUM - Compartment is an equilibrium compartment (ADVAN9 and<br>ADVAN15 only; implies NODOSE).<br>EXCLUDE - Compartment amount is excluded from the computation of the<br>amount (Amt) of the output compartment (ADVAN9 and ADVAN15 only).<br>[Amt=(total amount of drug thus far input into system) minus (total amount<br>remaining in the system)]<br>
The following two attributes have no opposites.<br>
DEFOBSERVATION - Compartment is the default observation compartment.<br>
191<br>
<hr>
<A name=197></a>$MODEL DETAILED DESCRIPTIONS<br>
Help Guide<br>
DEFDOSE - Compartment is the default dose compartment.<br>If no compartment has the DEFOBSERVA TION attribute, the default is the ﬁrst<br>compartment with the name CENTRAL; otherwise, the ﬁrst compartment. If<br>no compartment has the DEFDOSE attribute, the default is the ﬁrst compart-<br>ment with the name DEPOT which may receive doses; otherwise, the ﬁrst com-<br>partment which may receive doses.<br>
LINK compname [TO|AND] compname BY k [l]<br>
Link clauses are used with ADVAN5 and ADVAN7, but <i>only </i>in the absence of $PK<br>abbreviated code. They are rarely used, and are described in Guide IV.<br>
I_SS= <i>n</i><br>
I_SS may be used with the general non-linear models (ADVAN6, ADVAN8,<br>ADVAN9, ADVAN13, ADVAN14, ADVAN15) to request the initial state feature of<br>PREDPP. Values of n are<br>
0 No initial state state (the default)<br>1 Initial steady state<br>2 Initial steady state, adds to current compartment amounts.<br>3 Initial steady state, use current compartment amounts as initial estimates.<br>
The attributes INITIALOFF NODOSE deﬁne an output-type compartment. As with the<br>output compartment, it is possible to use a negative value of CMT to obtain an observa-<br>tion and turn off such a compartment with one observation record. Like the output com-<br>partment, it is initially off, and it remains off (so that the amount therein remains zero)<br>until it is explicitly turned on by an other type event record which has the output com-<br>partment’s number in the CMT data item. Unlike the output compartment, a differential<br>equation (DADT) must be supplied for an output-type compartment.<br>
(See <b>advan68</b>, <b>advan9_15</b>, <b>$pk</b>)<br>(See <b>Initial Steady State: I_SS,ISSMOD</b>).<br>
RECORD ORDER:<br>Follows $SUBROUTINES<br>Precedes $PK (if present)<br>
REFERENCES: Guide IV, section V.C.4<br>REFERENCES: Guide VI, section VI.B<br>
192<br>
<hr>
<A name=198></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$MSFI<br>
$MSFI<br>
MEANING: Gives the name of an input Model Speciﬁcation File<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$MSFI ﬁlename [<b>NORESCALE</b>|RESCALE] [NPOPETAS[=n]]<br>
[ONLYREAD] [NOMSFTEST|<b>MSFTEST</b>]<br>[VERSION=n]<br>[NEW]<br>
SAMPLE:<br>$MSFI MSF13<br>
DISCUSSION:<br>This record gives the name of an input Model Speciﬁcation File.<br>
OPTIONS:<br>
filename<br>
Name of the Model Speciﬁcation File. Must be the ﬁrst option. Filename may not<br>contain embedded spaces. If it contains commas, semicolons, or parentheses, then it<br>must be surrounded by single quotes ’ or double quotes &quot;. Filename may also con-<br>tain equal signs if it is enclosed in quotes. If ﬁlename is the same as any option of<br>the $MSFI record, it must be enclosed in quotes. Filename may contain at most 71<br>characters.<br>
NORESCALE<br>
If a search is continued, it is continued just as it would have been in the previous<br>run. This option has no effect if the Estimation Step is not implemented or if the<br>step is implemented, but using different options on the $ESTIMATION record from<br>those used with the previous run. This is the default option.<br>
RESCALE<br>
The search is to be restarted with initial estimates taken to be the ﬁnal estimates<br>from the previous run, so that a UCP value of 0.1 now corresponds to a ﬁnal esti-<br>mate from the previous run. This option may be used only if the search with the pre-<br>vious run terminated successfully and all the options used on the $ESTIMATION<br>record coincide with those used with the previous run (except the MAXEVAL<br>option).<br>
NPOPETAS[=n]<br>
If the data are to be understood to be population data, the option NPOPETAS may be<br>needed, and then the part &quot;=n&quot;, n&gt;0, may also need to be coded. The integer n<br>should be the number of population eta variables. The part &quot;=n&quot; is required when<br>the $ERROR block describes a model that changes the value of F, and there is no<br>$PK block. It is also required when variables A(n) are used in the $PK abbreviated<br>code. If the data are to be understood to be single-subject data, the option<br>NPOPETAS=0 may be needed.<br>May also be coded POPETAS.<br>
ONLYREAD<br>
This option should be used if and only if the model speciﬁcation ﬁle is being used to<br>convey prior information to a succeeding problem in the control stream<br>(See <b>TNPRI</b>). No task records may appear in a problem speciﬁcation containing a<br>$MSFI record with this option.<br>
193<br>
<hr>
<A name=199></a>$MSFI DETAILED DESCRIPTIONS<br>
Help Guide<br>
When the $MSFI record is used in a problem speciﬁcation, $THETA, $OMEGA and<br>$SIGMA records should not appear in that speciﬁcation. It is permissible for the data ﬁle<br>to differ from the original data ﬁle, but usually this is not done.<br>
<b>MSFTEST</b><br>
Prevents an MSF ﬁle from being utilized in a subsequent control stream ﬁle or prob-<br>lem if there were errors. This is the default.<br>
NOMSFTEST<br>
Sometimes the MSFI error check is too strict. This occurs particularly when using<br>classical NONMEM methods. To turn of MSFI error checking, use NOMSFTEST.<br>
VERSION[=n]<br>
Read in MSF ﬁles from previous versions. With NONMEM 7.4.0, choices are:<br>$MSFI myﬁle.msf VERSION=7.3.0<br>$MSFI myﬁle.msf VERSION=7.2.0<br>$MSFI myﬁle.msf VERSION=7.1.2<br>$MSFI myﬁle.msf VERSION=7.1.0<br>$MSFI myﬁle.msf VERSION=6.2<br>$MSFI myﬁle.msf VERSION=6.1<br>
NEW<br>
When the problem that created the MSF ﬁle has successfully completed, calling for<br>a resumed or new estimation is prevented when the method is FO/FOCE/Laplace. To<br>allow analysis to continue, or to allow an analysis on a new data set, resuming from<br>the ﬁnal parameters of the MSF ﬁle, use the option NEW: $MSFI myfilename<br>NEW.<br>
With NONMEM 7.3 and later, when MSF or MSFO option is used to specify an MSFO<br>ﬁle in the $EST record e.g.,<br>$EST ... MSFO=msfroot.msf<br>then in addition to the main MSF ﬁle msfroot.msf, ﬁle msfroot_ETAS.msf containing<br>individual etas will also be produced, and provide additional information when a $MSFI<br>record is used in a subsequent problem or control stream. This is referred to as an &quot;extra&quot;<br>msf ﬁle. If the Covariance Step is also implemented, ﬁles msfroot_RMAT.msf and msf-<br>root_SMAT.msf containing intermediate information on the R matrix and S matrix will<br>also be produced. These ﬁles provide information when a $MSFI record along with a<br>$COV ... RESUME record is used in a subsequent problem or control stream.<br>
The use of an extension, e.g., .msf, is optional. If the _ETA ﬁle is not present, NON-<br>MEM issues a warning:<br>WARNING: EXTRA MSF FILE COULD NOT BE OPENED: c5msf2x_ETAS<br>
There is no warning if _SMAT and/or _RMAT are not present.<br>
REFERENCES: Guide I, section B.3<br>REFERENCES: Guide II, section E.3<br>REFERENCES: Guide III, section 3.2<br>REFERENCES: Guide IV, section III.B.12<br>REFERENCES: Guide Introduction_7<br>
194<br>
<hr>
<A name=200></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$NONPARAMETRIC<br>
$NONPARAMETRIC<br>
MEANING: Instructions for the NONMEM Nonparametric Step<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$NONPARAMETRIC [<b>MARGINALS</b>|ETAS] [MSFO=filename] [RECOMPUTE]<br>
[EXPAND] [NPSUPP=n | NPSUPPE=n]<br>[BOOTSTRAP [STRAT=label] [STRATF=label]]<br>[PARAFILE=[ﬁlename|ON|OFF]<br>[<b>UNCONDITIONAL</b>|CONDITIONAL] [OMITTED]<br>
SAMPLE:<br>$NONPARAMETRIC ETAS<br>
DISCUSSION:<br>Optional. Requests that the NONMEM Nonparametric Step be implemented. When<br>present, the $ESTIMATION record must also be present and must specify METHOD=1<br>or POSTHOC.<br>
For a giv en eta, the points of support are the vector of posthoc estimates of that eta for all<br>individuals (i.e., the CPE values for that eta), which is essentially equal to the number of<br>individuals in the data set.<br>
OPTIONS:<br>
MARGINALS<br>
Requests that marginal cumulatives be obtained (the default). These values are<br>found in NONMEM global variables<br>(See <b>Nonparametric Density: DEN_,CDEN_)</b><br>
ETAS<br>
Requests that conditional (nonparametric) estimates of eta values be obtained. (Also<br>called the CNPE).<br>
MSFO=filename<br>
A Model Speciﬁcation File is output to the given ﬁlename. Filename may not con-<br>tain embedded spaces. If ﬁlename contains commas, semicolons, equal signs, or<br>parentheses, it must be enclosed in quotes (’ or &quot;). Filename may contain at most 71<br>characters. If ﬁlename is the same as any option of the $NONPARAMETRIC<br>record, it must be enclosed in quotes. The MSFO option may appear without a ﬁle<br>name. More precisely, if the $ESTIMATION record is also present, and it also spec-<br>iﬁes the MSFO option, then the ﬁlename is required only on one of the two records,<br>$ESTIMATION or $NONPARAMETRIC, whichever one appears ﬁrst in the control<br>stream. If the ﬁlename appears present on both records, it must be the same on both<br>records. If the ﬁlename is omitted on the second of the two records, the MSF option<br>must be the ﬁnal option on that record. Default: No MSF is output.<br>
RECOMPUTE<br>
Requests that the nonparametric density estimate occurring in an input MSF should<br>be ignored; the nonparametric estimate should be recomputed.<br>
EXPAND<br>
After the parametric estimation is performed, the ﬁnal eta MAP (or empirical Bayes<br>estimates, EBE) estimates, based on the ﬁnal SIGMAS, OMEGAS, and THETAS,<br>are normally used as support points. When EXPAND is selected, an alternative set<br>
195<br>
<hr>
<A name=201></a>$NONPARAMETRIC DETAILED DESCRIPTIONS<br>
Help Guide<br>
of EBEs are evaluated using the initial OMEGA values, but using the ﬁnal THETAS<br>and SIGMAS.<br>
NPSUPP=n<br>
Number of total support points to be used. If NPSUPP&gt;number of subjects, then<br>extra support points are randomly created from the ﬁnal OMEGAS (even when<br>EXPAND is selected). Only one of NPSUPP or NPSUPPE may be speciﬁed.<br>
NPSUPPE=n<br>
Number of total support points to be used. If NPSUPPE&gt;number of subjects, then<br>extra support points are randomly created from the initial, presumably inﬂated,<br>OMEGAS (even when EXPAND is not selected). Only one of NPSUPP or<br>NPSUPPE may be speciﬁed.<br>
BOOTSTRAP<br>
The original data set is ﬁtted during the parametric estimation ($EST), and the eta<br>support points from the original data set are used for the nonparametric version.<br>However, a bootstrap sample, with subjects uniformly randomly selected with<br>replacement from the original data set, is used for the nonparametric distribution<br>analysis.<br>
STRAT<br>
The label of a data item that serves as the stratiﬁcation. This splits the data set into<br>distinct sub-sets, guaranteeing a speciﬁc number of subjects will be selected from<br>each category.<br>
STRATF<br>
The label of a data item that contains the fraction that should represent a category in<br>the bootstrapped data set. Without STRATF, the number of subjects to be taken<br>from a given category is proportional to the number of subjects.<br>
CONDITIONAL<br>
The Nonparametric Step is implemented only when the Estimation Step terminates<br>successfully or is not implemented (i.e., the $ESTIMATION record speciﬁes MAX-<br>EVAL=0). This is the default.<br>
PARAFILE=ﬁlename<br>
As of NONMEM 7.4, nonparametric analysis can be parallelized.<br>PARAFILE=ﬁlename speciﬁes a different paraﬁle than was used for the previous<br>step.<br>PARAFILE=ON turns on parallelization for the Nonparametric Step.<br>PARAFILE=OFF turns off parallelization for the Nonparametric Step.<br>
UNCONDITIONAL<br>
The Nonparametric Step is always implemented.<br>
OMITTED<br>
The Nonparametric Step is not implemented.<br>
REFERENCES: None.<br>
196<br>
<hr>
<A name=202></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$OMEGA<br>
$OMEGA<br>
MEANING: Supplies initial estimates for the NONMEM OMEGA Matrix<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$OMEGA [<b>DIAGONAL(</b>n<b>)</b>|BLOCK(n)|BLOCK(n) SAME(m)|BLOCK SAME(m)]<br>
[BLOCK(n)VALUES(diag,odiag)]<br>[<b>VARIANCE</b>|STANDARD] [<b>COVARIANCE</b>|CORRELATON] [CHOLESKY]<br>[[<i>value</i>1] [<i>value</i>2] [<i>value</i>3] ... [FIXED]]<br>[(<i>value</i>)x<i>n</i>]<br>
SAMPLE:<br>$OMEGA BLOCK(3)<br>
6. .005 .3 .0002 .006 .4<br>
DISCUSSION:<br>Gives initial estimates and constraints for elements of one or several blocks of the<br>OMEGA matrix, i.e., the matrix of variances and covariances of the eta variables in the<br>statistical model. This record should appear only if the statistical model contains eta vari-<br>ables. Multiple $OMEGA records may be used to deﬁne multiple blocks of OMEGA.<br>The order of the appearance of all blocks over all records corresponds to the order of the<br>blocks in OMEGA.<br>
OPTIONS:<br>
There are four forms:<br>
1.<br>
$OMEGA [DIAGONAL(n)] [ v11 v22 v33 ... vnn ]<br>
This gives the initial estimates of the diagonal elements of a diagonal block of<br>OMEGA. E.g.,<br>
$OMEGA .04 .12<br>Initial estimate of variance of eta(1) = .04<br>Initial estimate of variance of eta(2) = .12<br>
Each initial estimate may optionally be coded with one of the forms:<br>
init options<br>
(init options)<br>
(options init)<br>
Any initial value or group of initial values may be enclosed in parentheses and fol-<br>lowed by &quot;x<i>n</i>&quot;, which means to replicate the values within parentheses <i>n </i>times<br>(&quot;repeated value&quot;).<br>Options apply only to a single initial estimate (i.e., a single 1x1 block) and must fol-<br>low the initial estimate unless within parentheses.<br>
Option FIXED indicates that the variance is to be constrained to be ﬁxed to the<br>given initial estimate. (When FIXED appears anywhere, then the block is described<br>by NONMEM as consisting of separate blocks, each of dimension one.)<br>
Option VARIANCE indicates that the initial estimate is understood to be a variance<br>of the eta. This is the default.<br>
Option STANDARD indicates that the initial estimate is understood to be a standard<br>deviation of the eta. May also be coded SD.<br>
An initial estimate may be 0 only if the variance or standard deviation is ﬁxed to this<br>estimate.<br>
197<br>
<hr>
<A name=203></a>$OMEGA DETAILED DESCRIPTIONS<br>
Help Guide<br>
2.<br>
$OMEGA BLOCK(n) [ v11 v21 v22 v31 v32 v33 ... vn1 vn2 ... vnn ]<br>
This gives the initial estimates of all the elements of a nondiagonal (&quot;full&quot;) block of<br>OMEGA. E.g.,<br>
$OMEGA BLOCK(2) .04 .002 .12<br>Initial estimate of variance of eta(1) = .04<br>Initial estimate of covariance of eta(2), eta(1) = .002<br>Initial estimate of variance of eta(2) = .12<br>
Any initial value or group of initial values may be enclosed in parentheses and fol-<br>lowed by &quot;x<i>n</i>&quot;, which means to replicate the values within parentheses <i>n </i>times<br>(&quot;repeated value&quot;).<br>
The following options apply to the entire block and may appear anywhere among the<br>list of initial estimates:<br>
FIXED indicates that the entire block is constrained to be ﬁxed to its initial estimate.<br>
VARIANCE indicates that all initial estimates given for diagonal elements are under-<br>stood to be initial estimates of variances of etas. This is the default.<br>
STANDARD indicates that all initial estimates given for diagonal elements are under-<br>stood to be initial estimates of standard deviations of etas. May also be coded SD.<br>
COVARIANCE indicates that all initial estmates given for off-diagonal elements are<br>understood to be initial estimates of covariances of etas. This is the default.<br>
CORRELATON indicates that all initial estmates given for off-diagonal elements are<br>understood to be initial estimates of correlations of etas.<br>
CHOLESKY indicates that the block is speciﬁed in its Cholesky form.<br>
Options VARIANCE or STANDARD may be combined with COVARIANCE or COR-<br>RELATON.<br>
Note that NONMEM converts all initial estimates to variance and covariances. The<br>values desplayed in the NONMEM report and in the raw and additional output ﬁles<br>are always variances and covariances.<br>
The (entire) initial estimate of the block must be positive deﬁnite. The only excep-<br>tion is when the entire initial estimate of the block is 0, in which case it must be<br>ﬁxed to this estimate. Initial estimates of some of the elements of the block may be<br>0, while initial estimates of some other elements may be nonzero, but only in the<br>case where the block is constrained to be of band symmetric form. That is, given the<br>diagonal and a group of contiguous subdiagonals symmetrically ocurring across the<br>diagonal, the elements off both the diagonal and the subdiagonals are constrained to<br>be zero. To specify the initial estimates of such a block, the initial estimates of those<br>elements that are to be constrained to 0 should be given as 0, while all other initial<br>estimates should be given as nonzero. E.g., with these structures for $OMEGA<br>BLOCK(3), the 0’s are preserved:<br>
x<br>0x<br>00x<br>
x<br>
198<br>
<hr>
<A name=204></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$OMEGA<br>
xx<br>0xx<br>
With NONMEM 7.3, if the initial estimate of a block is not positive deﬁnite because<br>of rounding errors, a value will be added to the diagonal elements to make it positive<br>deﬁnite. A message in the NONMEM report ﬁle will indicate that this was done.<br>E.g.,<br>DIAGONAL SHIFT OF<br>
1.1000E-03 WAS IMPOSED TO ENSURE POS-<br>
ITIVE DEFINITENESS<br>
3.<br>
$OMEGA BLOCK(n) SAME(m)<br>
This describes a block whose initial estimates, as well as ﬁnal estimates, are con-<br>strained to be equal to those of the preceding block. Values may not be given. &quot;(n)&quot;<br>may be omitted.<br>&quot;(m) may be omitted. If m is present, then this record is equivalent to m identical<br>records without (m). E.g.,<br>$OMEGA BLOCK(2) SAME(3)<br>is equivalent to<br>$OMEGA BLOCK(2) SAME<br>
$OMEGA BLOCK(2) SAME<br>
$OMEGA BLOCK(2) SAME<br>
4.<br>
$OMEGA BLOCK(n) VALUES(diag,odiag)<br>
This supplies initial values for a block such that the initial estimates of the diagonal<br>elements are all the same, speciﬁed by &quot;diag&quot;, and the initial estimates of the off-<br>diagonal elements are all the same, speciﬁed by &quot;odiag&quot;. VALUES must follow<br>BLOCK. Other options (such as FIXED, CHOLESKY, VARIANCE,STAN-<br>DARD,COVARIANCE,CORRELATON) may follow VALUES or be placed<br>between BLOCK and VALUES.<br>E.g.,<br>$OMEGA BLOCK(6) VALUES(0.1,0.01)<br>
is the same as<br>
$OMEGA BLOCK(6)<br>
0.1<br>
0.01 0.1<br>
(0.01)x2 0.1<br>
(0.01)x3 0.1<br>
(0.01)x4 0.1<br>
(0.01)x5 0.1<br>
If the values are omitted in forms 1 or 2, then NONMEM will try to obtain initial esti-<br>mates.<br>
If all OMEGA diagonals are FIXED to 1.0E+06, NONMEM describes the data as<br>
ANALYSIS TYPE: POPULATION WITH UNCONSTRAINED ETAS<br>
Structurally NONMEM sees the analysis as population, but mathematically, the popula-<br>tion density portion of the total likelihood is not included. This allows a population data<br>set to be analyzed as if the data from each individual were single-subject data. Further-<br>more, some theta parameters could be shared across subjects (&quot;pooled ﬁt parameters&quot;),<br>whereas etas are free to ﬁt each individual without any population constraint. Paralleliza-<br>tion is possible.<br>
199<br>
<hr>
<A name=205></a>$OMEGA DETAILED DESCRIPTIONS<br>
Help Guide<br>
EXAMPLES:<br>
The following describe the same block (within rounding errors):<br>
$OMEGA BLOCK(2) ; or $OMEGA VARIANCE COVARIANCE BLOCK(2)<br>
0.64<br>
-0.24 0.58<br>
$OMEGA STANDARD BLOCK(2)<br>
0.8<br>
-0.24 0.762<br>
$OMEGA STANDARD CORRELATION BLOCK(2)<br>
0.8<br>
-0.394 0.762<br>
$OMEGA VARIANCE CORRELATION BLOCK(2)<br>
0.64<br>
-0.394 0.58<br>
$OMEGA CHOLESKY BLOCK(2)<br>
0.8<br>
-0.3 0.7<br>
REFERENCES: Guide I, section C.3.4.6 , D.5.2 , D.5.3<br>REFERENCES: Guide IV, section III.B.10 , V.C.6<br>REFERENCES: Guide V, section 9.3<br>
200<br>
<hr>
<A name=206></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$OMEGAP,$OMEGAPD<br>
$OMEGAP,$OMEGAPD<br>
MEANING: Gives prior information for omegas<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$OMEGAP <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...<br>$OMEGAPD <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...<br>SAMPLE:<br>; Prior to OMEGA (NETPxNETP=4x4 of them)<br>
$OMEGAP BLOCK(4)<br>
0.2 FIX<br>
0.0 0.2<br>
0.0 0.0 0.2<br>
0.0 0.0 0.0 0.2<br>
; Set degrees of freedom of OMEGA Prior (one value per OMEGA block)<br>
$OMEGAPD (4 FIX)<br>
DISCUSSION:<br>
These are called the informative forms (i.e., informative record names) of the $OMEGA<br>record, for use with the NWPRI utility.<br>
$OMEGAP gives prior information for elements of the OMEGA matrix.<br>$OMEGAPD gives degrees of freedom (also called the dispersion factor) for OMEGA<br>priors.<br>
The name of the record describes the kind of information it gives, rather than the struc-<br>ture of the information. E.g., in the example above, $OMEGAPD is implemented in<br>FCON with a $THETA record because it is always a vector of values. These records may<br>be located anywhere in the control stream. NM-TRAN inserts the corresponding records<br>in the control stream in the correct order. When the informative forms are used, the<br>options of $PRIOR NWPRI need not be speciﬁed. However, if options are listed in<br>$PRIOR NWPRI, then these values are chosen over what is surmised from the informa-<br>tively labeled theta/omega/sigma records.<br>(See <b>nwpri</b>).<br>
OPTIONS:<br>
The option FIXED should be used. Other appropriate options are BLOCK and VALUES.<br>
REFERENCES: Guide Introduction_7<br>
201<br>
<hr>
<A name=207></a>$OMIT DETAILED DESCRIPTIONS<br>
Help Guide<br>
$OMIT<br>
MEANING: Deﬁnes data item types to be excluded from template matching when raw<br>data averages are computed<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$OMIT item1 item2 item3 ...<br>
SAMPLE:<br>$OMIT TIME<br>
DISCUSSION:<br>Optional. If a label of a data item type listed in the $INPUT record, or a synonym for<br>such a data item type, appears in the $OMIT record, then data items of this type are<br>excluded from template matching.<br>
REFERENCES: None<br>
202<br>
<hr>
<A name=208></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$PK<br>
$PK<br>
MEANING: Marks the beginning of abbreviated code for the PK Routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$PK<br>abbreviated code<br>
DISCUSSION:<br>The $PK record is used to model the values of basic and additional pharmacokinetic<br>parameters. It is used with PREDPP.<br>
Basic PK parameters are typically the rate constants (&quot;micro-constants&quot;) for use in kinetic<br>formulas. $PK can compute instead parameters such as clearance and volume, and a<br>translator (&quot;TRANS&quot;) subroutine can be used to convert these to rate constants. Addi-<br>tional PK parameters include compartment scale parameters, which PREDPP uses to con-<br>vert compartment amounts to concentrations, and dose-related parameters such as mod-<br>eled infusion rates. General rules for abbreviated code are documented elsewhere<br>(See <b>abbreviated code</b>).<br>Speciﬁc rules for $PK follow.<br>
ASSIGNMENT AND CONDITIONAL STATEMENTS<br>
Left-hand quantities in assignment statements:<br>
Basic PK parameters for the ADVAN and TRANS routines (Required, except with<br>the General Nonlinear Kinetics Models ADVAN6, ADVAN8, ADVAN9, ADVAN13,<br>ADVAN14, ADVAN15). One or more of the following, depending on which<br>ADVAN and TRANS are being used.<br>
K CL V (ADVAN1)<br>KA K CL V (ADVAN2)<br>K K12 K21 CL V Q VSS V1 V2 ALPHA BETA AOB (ADVAN3)<br>KA K K23 K32 CL V Q VSS V1 V2 V3 ALPHA BETA AOB (ADVAN4)<br>Km0 Kmn (ADVAN5, ADVAN7)<br>P(n) (ADVAN6, ADVAN8, ADVAN9, ADVAN13, ADVAN14, ADVAN15)<br>VM, KM (ADVAN10)<br>K K12 K21 K13 K31 CL Q2 Q3 V1 V2 V3 ALPHA BETA GAMMA<br>
(ADVAN11)<br>
KA K K23 K32 K24 K42 CL Q3 Q4 V2 V3 V4 ALPHA BETA GAMMA<br>
(ADVAN12)<br>
P(n) are referred to as &quot;explicit&quot; basic PK parameters.<br>Any variable deﬁned in $PK may be used on the right-hand side in a<br>$DES or $AES block; these are &quot;implicit&quot; basic PK parameters.<br>
Additional PK parameters (Optional)<br>One or more of the following,<br>depending on the compartments deﬁned for the model.<br>The digit following the letter is the compartment number.<br>
Scale parameters Sn, e.g.: S1 S2 S3 S4 SC S0.<br>Bio-availability fractions Fn, e.g.: F1 F2 F3.<br>Output fractions Fn, e.g.: F2 F3 F4 F0 FO.<br>Infusion rates Rn, e.g.: R1 R2 R3.<br>
203<br>
<hr>
<A name=209></a>$PK DETAILED DESCRIPTIONS<br>
Help Guide<br>
Infusion durations Dn, e.g.: D1 D2 D3.<br>Absorption lags ALAGn, e.g.: ALAG1 ALAG2 ALAG3.<br>Time scale: TSCALE (may be written XSCALE).<br>Model event times MTIME(i), e.g.: MTIME(1) MTIME(2).<br>(The subscript i is not a compartment number.)<br>(See <b>MTIME</b>)<br>
Initial compartment amounts (Optional), e.g..: A_0(1) A_0(2).<br>(See <b>Compartment Initialization Block</b>)<br>
Initial steady state ﬂag I_SS (Optional).<br>(See <b>advan68</b>, <b>advan9</b>, <b>$model</b>)<br>(See <b>Initial Steady State: I_SS,ISSMOD</b>).<br>
PK-deﬁned (i.e., PRED-deﬁned) items<br>
Right-hand quantities in assignment statement and in conditions:<br>
Data item labels speciﬁed on the $INPUT statement.<br>
THETA(n).<br>
ETA(n) (Used if the data are population.)<br>
PK-deﬁned items that appeared earlier as left-hand<br>quantities.<br>
NEWIND<br>
Same as the NEWIND argument passed by NONMEM to PREDPP.<br>NEWIND=0:<br>First record of the data set.<br>THETA value may differ from value at last call with this record.<br>NEWIND=1:<br>First record of the data set, THETA value does not differ from<br>value at last call with this record, and PRED is nonrecursive<br>(see <b>I_REC</b>), or,<br>First record of a subsequent individual record.<br>NEWIND=2:<br>Subsequent data record of an individual record.<br>
ICALL<br>
Same as the ICALL argument passed by NONMEM to PREDPP.<br>ICALL=1: Initialization.<br>ICALL=2: Normal call.<br>ICALL=3: Finalization.<br>ICALL=4: Simulation.<br>ICALL=5: Expectation.<br>ICALL=6: Raw data averages.<br>Special rules apply to blocks of abbreviated<br>code that are executed when ICALL is not 2.<br>
204<br>
<hr>
<A name=210></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$PK<br>
(See <b>Initialization-Finalization block</b>, <b>Simulation block</b>).<br>(See <b>Expectation block</b>, <b>Data_Average block</b>).<br>
Global Variables in Modules<br>
Certain variables in FORTRAN modules can be used.<br>(See <b>Variables_in_modules</b>)<br>The following are of particular interest.<br>
DOSTIM DOSREC(n)<br>
If PK is not being called at an additional or lagged dose time, then DOSTIM = 0 and<br>all elements of DOSREC are 0.<br>
If PK is called at an additional or lagged dose time t, then DOSTIM=t<br>(See <b>Guide VI, Chapter III</b>)<br>DOSREC contains a copy of the dose event record which initiated the additional or<br>lagged dose (actually, only of the ﬁnal row: EVTREC(NVNT,*)). Data items may<br>be referred to by position or by label, e.g., DOSREC(1) or DOSREC(ID). In DOS-<br>REC, TIME and all user (concomitant) data items have values from the next event<br>record. All other NONMEM/PREDPP reserved data items have values from the ini-<br>tiating dose event record. (The $BIND record may be used to override this.)<br>
A(n) TSTATE<br>
A(n) are the latest computed compartment amounts, and TSTATE is the time at<br>which they were computed. That is, A(n) are the amounts at the previous event<br>time, or if at a later time, but before the time for which PK is being called, a lagged<br>or additional dose was given, or a regular infusion was terminated, or a modeled<br>ev ent occurred, then A(n) are the amounts at the latest such time. If there are popu-<br>lation etas, and A(n) are used in the $PK abbreviated code, then any $OMEGA<br>records referring to etas explicitly used in this code should precede the $PK record,<br>or if an $MSFI record is used, it should precede the $PK record and include the<br>option NPOP=m.<br>Note: If there is no verbatim code and no explicit use of a subscripted variable A in<br>the $PK record, then the symbol A can be used as a data item label or as a name of a<br>PK-deﬁned item.<br>
A_0FLG<br>
A_0FLG signals a record with which it is possible to initialize a compartment<br>amount.<br>(See <b>Compartment Initialization Block</b>)<br>
Forbidden Variable Names:<br>
IDEF IREV EVTREC NVNT INDXS IRGG GG NETAS DADT(n) E(n)<br>
EPS(n)<br>
PSEUDO ASSIGNMENT STATEMENTS<br>
COMRES=-1<br>
CALLFL=-2: Call with every event record and at additional and lagged dose times.<br>CALLFL=-1: Call with every event record.<br>
205<br>
<hr>
<A name=211></a>$PK DETAILED DESCRIPTIONS<br>
Help Guide<br>
CALLFL=0: Call with ﬁrst event record and new TIME values.<br>CALLFL=1: Call once per individual record.<br>
Of the last four, CALLFL=-2 is the default when DOSREC, DOSTIM, or MTIME<br>are used explicitly in the abbreviated code. Otherwise, CALLFL=-1 is the default.<br>
The pseudo-assignments statements may be enclosed in parentheses. If two of them<br>are present in the same set of parentheses, separate them with a semicolon. A call-<br>ing protocol phrase may be used within parentheses instead of a pseudo-assignment<br>statement, and either upper or lower case may be used. E.g.,<br>
$PK (ONCE PER IR)<br>
; same as CALLFL=1<br>
$PK (NEW TIME)<br>
; same as CALLFL=0<br>
$PK (EVERY EVENT)<br>
; same as CALLFL=-1<br>
$PK (NONEVENT)<br>
; same as CALLFL=-2<br>
RECORD ORDER:<br>
Follows $SUBROUTINES and $INPUT<br>Follows $MODEL (with General Nonlinear Kinetics Models ADVAN6, ADVAN8,<br>ADVAN9, ADVAN13, ADVAN14, ADVAN15).<br>Precedes $ERROR (if present)<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide V, section 7<br>REFERENCES: Guide VI, section III<br>
206<br>
<hr>
<A name=212></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$PRED<br>
$PRED<br>
MEANING: Marks the beginning of abbreviated code for the PRED routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$PRED<br>abbreviated code<br>
DISCUSSION:<br>The $PRED record is used to model values for the DV data items. It is NOT used with<br>PREDPP (but (See <b>$ERROR</b>). General rules for abbreviated code are documented else-<br>where (See <b>abbreviated code</b>). Speciﬁc rules for $PRED follow.<br>
ASSIGNMENT AND CONDITIONAL STATEMENTS<br>
Left-hand quantities in assignment statements:<br>
Y (Required. The modeled value for the dependent variable under the statistical<br>model.)<br>
PRED-deﬁned items.<br>
Right-hand quantities in assignment statement and in conditions:<br>
Data item labels speciﬁed on the $INPUT statement.<br>
THETA(n).<br>
ETA(n) (Used if the data are population or single-subject data, and in the latter case<br>can be coded ERR(n).)<br>
EPS(n) (Used if the data are population, and can be coded ERR(n).)<br>
PRED-deﬁned items that appeared earlier as left-hand quantities. This includes Y.<br>
NEWIND<br>
Same as the NEWIND argument passed by NONMEM to PREDPP.<br>NEWIND=0: First record of the data set. THETA value may differ from value at<br>last call with this record.<br>NEWIND=1: First record of the data set, THETA value does not differ from value<br>at last call with this record, and PRED is nonrecursive (see <b>I_REC</b>), or,<br>First record of a subsequent individual record.<br>NEWIND=2: Subsequent data record of an individual record.<br>
NEWL2<br>
NEWL2=1: First record of an L2 record.<br>NEWL2=2: Otherwise.<br>
ICALL<br>
ICALL=0: Run initialization.<br>ICALL=1: Problem initialization.<br>
207<br>
<hr>
<A name=213></a>$PRED DETAILED DESCRIPTIONS<br>
Help Guide<br>
ICALL=2: Normal call.<br>ICALL=3: Problem ﬁnalization.<br>ICALL=4: Simulation.<br>ICALL=5: Expectation.<br>ICALL=6: Data Average.<br>Special rules apply to blocks of abbreviated code that are executed when ICALL<br>is not 2.<br>(See <b>initialization</b>, <b>ﬁnalization</b>, <b>simulation</b>).<br>(See <b>expectation</b>, <b>data average</b>).<br>
Variables in Fortran modules<br>
Certain variables in FORTRAN modules can be used. (See <b>Variables_in_mod-<br>ules</b>)<br>
Forbidden Variable Names:<br>
DATREC INDXS G H DADT(n) A(n) E(n) P(n)<br>
PSEUDO ASSIGNMENT STATEMENTS<br>
COMRES=-1<br>
RECORD ORDER:<br>
Follows $SUBROUTINES and $INPUT<br>
REFERENCES: Guide I, section C.2<br>REFERENCES: Guide IV, section III.B.8 , IV<br>REFERENCES: Guide V, section 12.3<br>
208<br>
<hr>
<A name=214></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$PRIOR<br>
$PRIOR<br>
MEANING: Provides instructions for the PRIOR subroutine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$PRIOR subroutine [(conditional clause1 ), (conditional clause2) ... ]<br>
[DISPLAY[=<b>ALL</b>|CNT]] [ICMAX=n]<br>[argument1 , argument2 ...]<br>
SAMPLE:<br>$PRIOR TNPRI (PROBLEM 2) PLEV=.9999 ISS=0 IVAR=1<br>
DISCUSSION:<br>Optional. Speciﬁes the use of the PRIOR feature of NONMEM. Note that $PRIOR is a<br>control record, not a block of abbreviated code. Therefore, only those options that are<br>listed here may be used. E.g., verbatim code may not be used. Options and arguments<br>may be in any order, and may be on more than one line.<br>
OPTIONS:<br>
subroutine<br>
Required. Either TNPRI or NWPRI. The following options and arguments apply to<br>calls to this subroutine. Another subroutine option (or another $PRIOR record) may<br>follow, with a new set of options and arguments. Use only NWPRI for the new<br>$ESTIMATION methods of NONMEM 7.<br>
conditional clause<br>
Optional. One or more conditions, within parentheses.<br>
The conditions are<br>
&quot;AND&quot;ed together, i.e., the subroutine is called when all conditions in the condi-<br>tional clause are true. If there is more than one conditional clause, the clauses are<br>&quot;OR&quot;ed together, i.e., the subroutine is called if all the conditions in any one condi-<br>tional clause are true. See the Examples, below. Conditions may be one or more of:<br>
ESTIMATION or SIMULATION<br>
Speciﬁes the NONMEM task for which the subroutine is to be called. If omit-<br>ted, PRIOR is called for all tasks (i.e., for all values of ICALL). ESTIMATION<br>and SIMULATION may not both be speciﬁed in the same conditional clause.<br>ESTIMATION may be spelled ESTIMATE or ESTM; SIMULATION may be<br>spelled SIMULATE or SIML.<br>
May also be speciﬁed as ICALL=n, ICALL.EQ.n, or ICALLn, where n is 2<br>(ESTIMATION) or 4 (SIMULATION).<br>
PROBLEM=n<br>
Speciﬁes the problem for which the subroutine is to be called. May also be<br>speciﬁed as PROBLEM=n or PROBLEM.EQ.n or PROBLEMn. PROBLEM may<br>also be coded as IPROB. Instead of =, .EQ. may be used. Other permitted<br>tests are .NE., .LT., .LE., .GT., and .GE.<br>
209<br>
<hr>
<A name=215></a>$PRIOR DETAILED DESCRIPTIONS<br>
Help Guide<br>
DISPLAY[=<b>ALL</b>|CNT]<br>
Optional. The PRIOR subroutine will contain code to print items of interest in the<br>NONMEM report. This is to assist the user in checking that the $PRIOR record is<br>working correctly.<br>
DISPLAY=ALL is the default when only DISPLAY is present. Lines such as the<br>following are printed with every call to PRIOR:<br>
PRIOR ICALL,IPROB,IREP,CNT:<br>
2<br>
2<br>
0<br>
 <br>
-41.898951681785.<br>
With DISPLAY=CNT, lines such as the following are printed only when PRIOR is<br>called for simulation or estimation.<br>
PRIOR CNT:<br>
-41.898951681785<br>
ICMAX=n<br>
Optional. The PRIOR subroutine will set the given value in ICMAX prior to calling<br>the subroutine. (See <b>PRIOR Simulation: ICMAX</b>).<br>
Subroutine arguments<br>
Optional. The arguments are described in the help entries for NWPRI and TNPRI.<br>They must be coded excatly as shown, i.e., no abbreviations. Any argument that is<br>omitted defaults to 0.<br>
ITYP, NSAM, ISS, PLEV, CNT<br>
Arguments for both NWPRI and TNPRI<br>
NTHETA, NETA, NEPS, NTHP, NETP, NEPP, NPEXP<br>
Arguments unique to NWPRI<br>
IFND, MODE, IVAR<br>
Arguments unique to for TNPRI<br>
EXAMPLES:<br>
$PRIOR TNPRI (ESTIMATION, PROB .GE.3 ) IFND=1<br>
TNPRI is called with the Estimation step of problems 3 and higher. IFND is set to 1<br>with these calls; all other arguments are 0.<br>
$PRIOR TNPRI IFND=1<br>
(EST, PROB 3) (EST,PROB 4) (EST,PROB 5)<br>
Same as the preceding example, if the run consists of exactly ﬁve problems. TNPRI<br>is called with the Estimation step of problems 3, 4 and 5. IFND is set to 1 with these<br>calls; all other arguments are 0.<br>
210<br>
<hr>
<A name=216></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$PRIOR<br>
$PRIOR TNPRI (EST, PROB 3) IFND=1<br>
TNPRI (EST, PROB 4) IFND=1<br>
TNPRI (EST, PROB 5) IFND=1<br>
Same as the preceding example. TNPRI is called with the Estimation step of prob-<br>lem 3. IFND=1 with this call. Similarly with problems 4 and 5. Note that IFND<br>must be speciﬁed independently each time to be 1. With re-speciﬁcation of the sub-<br>routine, all arguments are reset to 0. This permits identical or different arguments<br>with each usage of the subroutine. NM-TRAN will warn if no argument is speciﬁed<br>in a subsequent speciﬁcation of TNPRI or NWPRI, in case the arguments have been<br>omitted by error. One or more arguments may be set explicitly to 0 to prevent the<br>warning. When the subroutine is speciﬁed more than once, then all speciﬁcations<br>must be conditional, i.e., conditional clauses are requrired.<br>
Within the same run, one may use TNPRI with some tasks or problems, and NWPRI<br>with other tasks or problems. There may be at most 10 $PRIOR records per prob-<br>lem.<br>
(See <b>TNPRI</b>, <b>TNPRI</b>, <b>prior</b>).<br>(See <b>tnpri example</b>, <b>nwpri example</b>).<br>
REFERENCES: Guide Introduction_VI<br>
211<br>
<hr>
<A name=217></a>$PROBLEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
$PROBLEM<br>
MEANING: Identiﬁes the start of a NONMEM Problem Speciﬁcation<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$PROBLEM<br>
[text]<br>
SAMPLE:<br>$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
DISCUSSION:<br>The $PROBLEM record identiﬁes the start of a NONMEM problem speciﬁcation. The<br>text becomes a heading for the NONMEM printout. This record is required. If the prob-<br>lem is part of a superproblem, $SUPER must precede the $PROBLEM record. If<br>$SIZES is present, it must precede the ﬁrst $SUPER or $PROBLEM record. Otherwise,<br>the ﬁrst NM-TRAN control record must be a $PROBLEM record. A $PROBLEM record<br>other than the ﬁrst one marks the beginning of another problem speciﬁcation.<br>
The text must be contained on a single record, and only the ﬁrst 72 characters of text are<br>used in the heading. Spaces <i>and </i>semicolons in text are regarded as part of the text. The<br>text is optional.<br>
REFERENCES: Guide IV, section III.B.1<br>
212<br>
<hr>
<A name=218></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SCATTERPLOT<br>
$SCATTERPLOT<br>
MEANING: Requests that NONMEM generate one or more scatterplots<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$SCATTERPLOT list1 VS list2 [BY list3]<br>
[FROM <i>n</i>1] [TO <i>n</i>2] [UNIT]<br>[ORD0|NOORD0] [ABS0|NOABS0] [FIRSTONLY] [OBSONLY]<br>[NOSUB=[0|1]]<br>[<b>UNCONDITIONAL</b>|CONDITIONAL] [OMITTED]<br>
SAMPLE:<br>$SCATTERPLOT (RES WRES) VS TIME BY ID<br>
DISCUSSION:<br>Requests that families of NONMEM scatterplots be produced. Up to 20 families of scat-<br>terplots may be included in the problem. May also be coded $SCATTERS or $SCAT-<br>TERGRAMS.<br>
OPTIONS:<br>
list1<br>
A list of item labels to be plotted on the ordinate axis (the long axis on the printed<br>output). The list may be enclosed in parentheses. It may include:<br>
Data item labels.<br>
Special items PRED, RES, and WRES.<br>
The user may request the following additional diagnostic items by including their name in<br>the list.<br>
NPRED, NRES, NWRES<br>
Calculated assuming non-conditional estimation and no eta-epsilon interac-<br>tion. NPRED and NRES are same as PRED and RES. NWRES is same as<br>WRES when INTERACTION is not set in $EST.<br>
PREDI, RESI, WRESI<br>
Calculated assuming non-conditional estimation with eta-epsilon interaction.<br>Always same as PRED, RES, and WRES.<br>
CPRED, CRES, CWRES<br>
Calculated assuming conditional estimation and no eta-epsilon interaction.<br>
CPREDI, CRESI, CWRESI<br>
Calculated assuming conditional estimation with eta-epsilon interaction.<br>
CIPRED, CIRES,CIWRES<br>
Conditional individual values<br>
CIPREDI, CIRESI,CIWRESI<br>
Conditional individual values with eta-epsilon interaction.<br>
NIPRED, NIRES, NIWRES<br>
NIPRED and NIRES are same as PRED and RES. NIWRES is weighted resid-<br>ual using F(eta=0) and V(eta=0), where V is individual variance.<br>
IPREDI, IRESI,IWRESI<br>
Same as NIPRED,NIRES,NIWRES<br>
213<br>
<hr>
<A name=219></a>$SCATTERPLOT<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
IPRD, IRS,IWRS<br>
Same as NIPRED, NIRES, and NIWRES<br>
EPRED, ERES, EWRES<br>
Monte-Carlo generated diagnostics and are not linearized approximations<br>like the other diagnostic types. EWRES is the Monte-Carlo version of<br>CWRESI.<br>
ECWRES<br>
Monte-Carlo version of CWRES.<br>
EIPRED, EIRES,EIWRES<br>
EIPRED and EIRES are same as EPRED and ERES. EIWRES is Monte Carlo<br>assessed individual weighted residual.<br>
NPDE<br>
Monte-Carlo generated normalized probability distribution error.<br>
NPD<br>
The correlated (or non-decorrelated) NPDE value.<br>
OBJI<br>
Objective function values for each individual (same as given in the root.phi<br>ﬁle). The sum of the individual objective function values is equal to the total<br>objective function.<br>
Labels ETA(1), ETA(2), ... ,ETA(10), ... , ETA(70), etc.,<br>or alternatively, labels ETA1, ETA2, ... ,ET10, ... , ET70, etc., corresponding to eta(1),<br>eta(2), etc.<br>The labels in the output will be ETA1, ETA2, ... , ET10, ... ET70, etc.<br>
With NONMEM 7.3, a range of etas may be requested:<br>
$SCAT ETAS(1:2) VS ETA3<br>is equivalent to<br>
$SCAT ETA1 ETA2 VS ETA3<br>
However, unlike $TABLE, $SCAT will ignore implied endings, such as<br>$SCAT ETAS(1:LAST) VS ETA3<br>And just interpret it as<br>$SCAT ETA1 VS ETA3<br>
With NONMEM 7.4, more ﬂexible syntax is available, using TO and BY.<br>(See <b>$table</b>).<br>
With NONMEM 7.4, a symbolic label speciﬁed in $ABBR REPLACE may be listed<br>in $SCAT. For example:<br>$ABBR REPLACE ETA(CL)=ETA(1)<br>
...<br>
$SCAT ETA(CL) VS ETA3<br>
Reserved positions of MODULE NMPRD4 (see <b>$ABBREV</b>). COM(k) or :k denotes the<br>kth reserved position. (There must be exactly 4 digits after &quot;:&quot;. Use leading 0’s as neces-<br>sary.) E.g., COM(3) or :003.<br>Labels of the form :k will be used in the output.<br>
Labels of PRED-deﬁned items in MODULE NMPRD4 if abbreviated code is present (up<br>to PDT distinct such labels in any one problem, for all tables and scatterplots. PDT is a<br>constant in resource/SIZES.f90; default value is 500.) These may include labels of the<br>NM-TRAN-deﬁned items:<br>
214<br>
<hr>
<A name=220></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SCATTERPLOT<br>
0nnn e.g., 0010 stands for A00nnn<br>1nnn e.g., 1010 stands for A01nnn<br>2nnn e.g., 2010 stands for C00nnn<br>3nnn e.g., 3010 stands for D00nnn<br>4nnn e.g., 4010 stands for E00nnn<br>5nnn e.g., 5010 stands for F00nnn<br>6nnn e.g., 6010 stands for P00nnn<br>
These may also include:<br>
labels VECTRA(1), VECTRA(2), ... ,VECTRA(9), or alternatively, labels VA_1,<br>VA_2, ... ,VA_9, corresponding to VECTRA(1), VECTRA(2), ..., VECTRA(9).<br>The labels in the output will be VA_1, VA_2, ... , VA_9.<br>Similarly, for VECTRB and VECTRC.<br>
Synonyms may be deﬁned on either the $TABLE or $SCATTER record for special items<br>PRED, RES, WRES; for PRED-deﬁned items; for NM-TRAN-deﬁned items; and for<br>reserved positions of MODULE NMPRD4.<br>
E.g., assume that IWRES is a PRED-deﬁned label, that at least 3 positions of NMPRD4<br>are reserved, and that NM-TRAN has generated A00032 as the label for a derivative in<br>the generated FSUBS routine. Either $TABLE or $SCATTER records may include:<br>
WRES=RES1,IWRES=RES2,COM(3)=ABC,0032=DK.<br>
For a discussion of the values of ETAs and PRED-deﬁned items (e.g., are they based on<br>initial or ﬁnal values of theta? Simulated or zero or conditional values of eta?), see <b>val-<br>ues</b>.<br>
Elements of G and H<br>E.g., $SCATTER G11 BY G21<br>The format is Gk1 or Hk1, where k is an integer value, e.g. 1-9 or 01-99 or 001-999. Gk1<br>requests the value of G(k,1), and Hk1 requests the value of H(k,1), where G and H are<br>arguments of subroutine PRED. G(k,1) is the partial of F (the prediction) with respect to<br>ETA(1), and H(k,1) is the partial of F with respect to EPS(1). (HH may be coded instead<br>of H, but it is treated as if it were H.) A variable of the form Gk1 or Hk1 is not a reserved<br>variable. If it is previously deﬁned (i.e., if it is listed in $INPUT, or used on the left in<br>abbreviated code, or used as a synonym e.g., $TABLE G11=COM(1)), then that deﬁni-<br>tion of the variable is used, and there is no change from previous versions of NM-TRAN.<br>Only if there is no other previous deﬁnition of the variable will it be understood to be an<br>element of G or H.<br>What NM-TRAN actually displays is the variable in MODULE NMPRD4 that was used<br>to compute the derivative of interest (a variable in the series A00nnn, C00nn, or D00nnn)<br>with the appropriate synonym such as G11. If there is no such variable, this is an error.<br>NMTRAN will not display variables that are not computed , e.g., G41 when there are<br>only 3 etas in the problem, or when there are 4 etas but ETA(4) does not contribute to the<br>value of Y.<br>[There is a workaround if the zero is wanted as a place holder in the table. In abbreviated<br>code ($ERROR or $PRED or $PK)<br>G41=0 .<br>
(See <b>Displayed PRED-Deﬁned Items</b>).<br>
list2<br>
Like list1, but includes the labels of items to be plotted on the abscissa axis (the<br>short axis on the printed output). The list may be enclosed in parentheses. The<br>
215<br>
<hr>
<A name=221></a>$SCATTERPLOT<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
word &quot;VS&quot; is optional; it may be omitted if the lists are enclosed in parenthesis, or if<br>each list consists of exactly one item label. VS may also be coded *. Each pair of<br>labels, one from list1 and one from list2, deﬁnes a family of scatterplots.<br>
list3<br>
A list of one or two item labels or synonyms. Each pair of labels from list1 and list2<br>produces a family of scatterplots, one scatterplot for each unique value (or combina-<br>tion of values) of the data item(s) in list3. If the BY option is omitted, each pair of<br>labels from list1 and list2 produces a family comprised of a single scatterplot.<br>
UNIT<br>
A line of unit slope is superimposed on the scatterplots.<br>
ORD0<br>
A line through the zero value on the ordinate axis is superimposed on the scatter-<br>plots. May also be coded ORDZERO.<br>
NOORD0<br>
Prevents a zero line from being superimposed on the ordinate axis of the scatter-<br>plots. May also be coded NOORDZERO.<br>If neither ORD0 nor NOORD0 is present, NONMEM automatically superimposes a<br>zero line on the ordinate axis if it is appropriate for the type of data item.<br>
ABS0<br>
A zero line is superimposed on the abscissa axis of the scatterplots. May also be<br>coded ABSZERO, AB0, or ABZERO.<br>
NOABS0<br>
Prevents a zero line from being superimposed on the abscissa axis of the scatter-<br>plots. May also be coded NOABSZERO, NOABS0, NOABZERO, NOAB0.<br>If neither of ABS0 and NOABS0 is present, NONMEM automatically superimposes<br>a zero line on the abscissa axis if it is appropriate for the type of data item.<br>
FIRSTONLY<br>
Only the ﬁrst data record from each individual record may contribute a point to the<br>scatterplot. May also be coded FIRSTRECORDONLY or FIRSTRECONLY.<br>
OBSONLY<br>
The scatterplot will only use data records with MDV=0. This option applies inde-<br>pendently of FIRSTONLY. It is not necessary when either DV, RES, or WRES is<br>plotted.<br>
FROM <i>n</i>1<br>
<i>n</i>1 is the number of the ﬁrst data record which may &quot;contribute&quot; to the scatterplot.<br>Default: <i>n</i>1 is 1.<br>
TO <i>n</i>2<br>
<i>n</i>2 is the number of the last data record which may &quot;contribute&quot; to the scatterplot.<br>Default: There is no upper limit. All appropriate records will contribute. To restore<br>the NONMEM VI behavior, use TO <i>n</i>1+899.<br>
With FIRSTONLY, <i>n</i>1 and <i>n</i>2 refer to (ﬁrst records of) individual records. The remaining<br>options apply to all $SCATTERPLOT records.<br>
NOSUB=[0|1]<br>
With NOSUB=0, label substitution will be performed scatterpots. (See <b>$ABBREVI-<br>ATED</b>). This is the default. With NOSUB=1, label substitution will not be per-<br>formed.<br>
216<br>
<hr>
<A name=222></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SCATTERPLOT<br>
CONDITIONAL<br>
The Scatterplot Step is implemented only when the Estimation Step terminates suc-<br>cessfully or is not implemented. This is the default.<br>
UNCONDITIONAL<br>
The Scatterplot Step is always implemented. This is the default.<br>
OMITTED<br>
The Scatterplot Step is not implemented.<br>
When DV, RES, or WRES is plotted, records having MDV=1 are not plotted.<br>
The following symbols are used in scatterplots:<br>
*<br>
1 point<br>
Overstriking:<br>
2-9 2-9 points<br>
A-Z 10-35 points (A=10, B=11, ... , Z=35)<br>
$<br>
more than 35 points<br>
REFERENCES: Guide IV, section III.B.17<br>REFERENCES: Guide V, section 9.5.2 , 10.7.2<br>
217<br>
<hr>
<A name=223></a>$SIGMA DETAILED DESCRIPTIONS<br>
Help Guide<br>
$SIGMA<br>
MEANING: Supplies initial estimates for the NONMEM SIGMA Matrix<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$SIGMA [<b>DIAGONAL(</b>n<b>)</b>|BLOCK(n)|BLOCK(n) SAME(m)|BLOCK SAME(m)]<br>
[BLOCK(n)VALUES(diag,odiag)]<br>[<b>VARIANCE</b>|STANDARD] [<b>COVARIANCE</b>|CORRELATON] [CHOLESKY]<br>[[<i>value</i>1] [<i>value</i>2] [<i>value</i>3] ... [FIXED]]<br>[(<i>value</i>)x<i>n</i>]<br>
SAMPLE:<br>$SIGMA BLOCK(3)<br>
6. .005 .3 .0002 .006 .4<br>
DISCUSSION:<br>Gives initial estimates and constraints for elements of one or several blocks of the<br>SIGMA matrix, i.e., the matrix of variances and covariances of the epsilon variables in<br>the statistical model. This record should appear only if the statistical model contains<br>epsilon variables, i.e., the data are population. Multiple $SIGMA records may be used to<br>deﬁne multiple blocks of SIGMA. The order of the appearance of all blocks over all<br>records corresponds to the order of the blocks in SIGMA.<br>
OPTIONS:<br>
There are four forms:<br>
1.<br>
$SIGMA [DIAGONAL(n)] [ v11 v22 v33 ... vnn ]<br>
This gives the initial estimates of the diagonal elements of a diagonal block of<br>SIGMA. E.g.,<br>
$SIGMA .04 .12<br>Initial estimate of variance of eps(1) = .04<br>Initial estimate of variance of eps(2) = .12<br>
Each initial estimate may optionally be coded with one of the forms:<br>
init options<br>
(init options)<br>
(options init)<br>
Any initial value or group of initial values may be enclosed in parentheses and fol-<br>lowed by &quot;x<i>n</i>&quot;, which means to replicate the values within parentheses <i>n </i>times<br>(&quot;repeated value&quot;).<br>Options apply only to a single initial estimate (i.e., a single 1x1 block) and must fol-<br>low the initial estimate unless within parentheses.<br>
Option FIXED indicates that the variance is to be constrained to be ﬁxed to the<br>given initial estimate. (When FIXED appears anywhere, then the block is described<br>by NONMEM as consisting of separate blocks, each of dimension one.)<br>
Option VARIANCE indicates that the initial estimate is understood to be a variance<br>of the epsilons. This is the default.<br>
Option STANDARD indicates that the initial estimate is understood to be a standard<br>deviation of the epsilons. May also be coded SD.<br>
An initial estimate may be 0 only if the variance or standard deviation is ﬁxed to this<br>estimate.<br>
218<br>
<hr>
<A name=224></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SIGMA<br>
2.<br>
$SIGMA BLOCK(n) [ v11 v21 v22 v31 v32 v33 ... vn1 vn2 ... vnn ]<br>
This gives the initial estimates of all the elements of a nondiagonal (&quot;full&quot;) block of<br>SIGMA. E.g.,<br>
$SIGMA BLOCK(2) .04 .002 .12<br>Initial estimate of variance of eps(1) = .04<br>Initial estimate of covariance of eps(2), eps(1) = .002<br>Initial estimate of variance of eps(2) = .12<br>
Any initial value or group of initial values may be enclosed in parentheses and fol-<br>lowed by &quot;x<i>n</i>&quot;, which means to replicate the values within parentheses <i>n </i>times<br>(&quot;repeated value&quot;).<br>
The following options apply to the entire block and may appear anywhere among the<br>list of initial estimates:<br>
FIXED indicates that the entire block is constrained to be ﬁxed to its initial estimate.<br>
VARIANCE indicates that all initial estimates given for diagonal elements are under-<br>stood to be initial estimates of variances of epsilons. This is the default.<br>
STANDARD indicates that all initial estimates given for diagonal elements are under-<br>stood to be initial estimates of standard deviations of epsilons. May also be coded<br>SD.<br>
COVARIANCE indicates that all initial estmates given for off-diagonal elements are<br>understood to be initial estimates of covariances of epsilons. This is the default.<br>
CORRELATON indicates that all initial estmates given for off-diagonal elements are<br>understood to be initial estimates of correlations of epsilons.<br>
CHOLESKY indicates that the block is speciﬁed in its Cholesky form.<br>
Options VARIANCE or STANDARD may be combined with COVARIANCE or COR-<br>RELATON.<br>
Note that NONMEM converts all initial estimates to variance and covariances. The<br>values desplayed in the NONMEM report and in the raw and additional output ﬁles<br>are always variances and covariances.<br>
The (entire) initial estimate of the block must be positive deﬁnite. The only excep-<br>tion is when the entire initial estimate of the block is 0, in which case it must be<br>ﬁxed to this estimate. Initial estimates of some of the elements of the block may be<br>0, while initial estimates of some other elements may be nonzero, but only in the<br>case where the block is constrained to be of band symmetric form. That is, given the<br>diagonal and a group of contiguous subdiagonals symmetrically ocurring across the<br>diagonal, the elements off both the diagonal and the subdiagonals are constrained to<br>be zero. To specify the initial estimates of such a block, the initial estimates of those<br>elements that are to be constrained to 0 should be given as 0, while all other initial<br>estimates should be given as nonzero. E.g., with these structures for $SIGMA<br>BLOCK(3), the 0’s are preserved:<br>
x<br>0x<br>00x<br>
219<br>
<hr>
<A name=225></a>$SIGMA DETAILED DESCRIPTIONS<br>
Help Guide<br>
x<br>xx<br>0xx<br>
With NONMEM 7.3, if the initial estimate of a block is not positive deﬁnite because<br>of rounding errors, a value will be added to the diagonal elements to make it positive<br>deﬁnite. A message in the NONMEM report ﬁle will indicate that this was done.<br>E.g.,<br>DIAGONAL SHIFT OF<br>
1.1000E-03 WAS IMPOSED TO ENSURE POS-<br>
ITIVE DEFINITENESS<br>
3.<br>
$SIGMA BLOCK(n) SAME(m)<br>
This describes a block whose initial estimates, as well as ﬁnal estimates, are con-<br>strained to be equal to those of the preceding block. Values may not be given. &quot;(n)&quot;<br>may be omitted.<br>&quot;(m) may be omitted. If m is present, then this record is equivalent to m identical<br>records without (m). E.g.,<br>$SIGMA BLOCK(2) SAME(3)<br>is equivalent to<br>$SIGMA BLOCK(2) SAME<br>
$SIGMA BLOCK(2) SAME<br>
$SIGMA BLOCK(2) SAME<br>
4.<br>
$SIGMA BLOCK(n) VALUES(diag,odiag)<br>
This supplies initial values for a block such that the initial estimates of the diagonal<br>elements are all the same, speciﬁed by &quot;diag&quot;, and the initial estimates of the off-<br>diagonal elements are all the same, speciﬁed by &quot;odiag&quot;. VALUES must follow<br>BLOCK. Other options (such as FIXED, CHOLESKY, VARIANCE,STAN-<br>DARD,COVARIANCE,CORRELATON) may follow VALUES or be placed<br>between BLOCK and VALUES.<br>E.g.,<br>$SIGMA BLOCK(6) VALUES(0.1,0.01)<br>
is the same as<br>
$SIGMA BLOCK(6)<br>
0.1<br>
0.01 0.1<br>
(0.01)x2 0.1<br>
(0.01)x3 0.1<br>
(0.01)x4 0.1<br>
(0.01)x5 0.1<br>
If the values are omitted in forms 1 or 2, then NONMEM will try to obtain initial esti-<br>mates.<br>
EXAMPLES:<br>
The following describe the same block (within rounding errors):<br>
$SIGMA BLOCK(2) ; or $SIGMA VARIANCE COVARIANCE BLOCK(2)<br>
0.64<br>
-0.24 0.58<br>
$SIGMA STANDARD BLOCK(2)<br>
220<br>
<hr>
<A name=226></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SIGMA<br>
0.8<br>
-0.24 0.762<br>
$SIGMA STANDARD CORRELATION BLOCK(2)<br>
0.8<br>
-0.394 0.762<br>
$SIGMA VARIANCE CORRELATION BLOCK(2)<br>
0.64<br>
-0.394 0.58<br>
$SIGMA CHOLESKY BLOCK(2)<br>
0.8<br>
-0.3 0.7<br>
REFERENCES: Guide I, section E.5.1<br>REFERENCES: Guide IV, section III.B.11<br>REFERENCES: Guide V, section 9.3<br>
221<br>
<hr>
<A name=227></a>$SIGMAP,$SIGMAPD DETAILED DESCRIPTIONS<br>
Help Guide<br>
$SIGMAP,$SIGMAPD<br>
MEANING: Gives prior information for sigmas<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$SIGMAP <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...<br>$SIGMAPD <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...<br>SAMPLE:<br>; Prior to SIGMA (NEPPxNEPP=1x1 of them)<br>
$SIGMAP 0.05 FIX<br>
; Set degrees of freedom of SIGMA Prior (one value per SIGMA block)<br>
$SIGMAPD (1 FIX)<br>
DISCUSSION:<br>
These are called the informative forms of the $SIGMA record, for use with the NWPRI<br>utility.<br>
$SIGMAP gives prior information for elements of the SIGMA matrix.<br>$SIGMAPD gives degrees of freedom (also called the dispersion factor) for SIGMA pri-<br>ors.<br>
The name of the record describes the kind of information it gives, rather than the struc-<br>ture of the information. E.g., in the example above, $SIGMAPD is implemented in<br>FCON with a $THETA record because it is always a vector of values. These records may<br>be located anywhere in the control stream. NM-TRAN inserts the corresponding records<br>in the control stream in the correct order. When the informative forms are used, the<br>options of $PRIOR NWPRI need not be speciﬁed. However, if options are listed in<br>$PRIOR NWPRI, then these values are chosen over what is surmised from the informa-<br>tively labeled theta/omega/sigma records.<br>(See <b>nwpri</b>).<br>
OPTIONS:<br>
The option FIXED should be used. Other appropriate options are BLOCK and VALUES.<br>
REFERENCES: Guide Introduction_7<br>
222<br>
<hr>
<A name=228></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SIMULATION<br>
$SIMULATION<br>
MEANING: Instructions for the NONMEM Simulation Step<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$SIMULATION (seed1 [seed2] [<b>NORMAL</b>|UNIFORM|NONPARAMETRIC] [NEW]) ...<br>
[SUBPROBLEMS=n] [ONLYSIMULATION] [OMITTED]<br>[REQUESTFIRST] [REQUESTSECOND] [<b>PREDICTION</b>|NOPREDICTION]<br>[TRUE=<b>INITIAL</b>|FINAL|PRIOR]<br>[BOOTSTRAP=n [<b>REPLACE</b>|NOREPLACE] [STRAT=label] [STRATF=label]]<br>[<b>NOREWIND</b>|REWIND] [<b>SUPRESET</b>|NOSUPRESET]<br>[RANMETHOD=[n|S|m|P] ]<br>[PARAFILE=[ﬁlename|ON|OFF]<br>
SAMPLE:<br>$SIMULATION (889215690) (2239177789 UNIFORM)<br>
DISCUSSION:<br>Optional. Requests that the NONMEM Simulation Step be implemented. May also be<br>coded $SIMULATE or $SIML.<br>
Usually, when the Simulation Step is implemented, the simulated observation is taken to<br>be the quantity to which the Y variable (with NM-TRAN abbreviated code) or F variable<br>(with a user-supplied PRED or ERROR routine) is set. This is the default behaviour.<br>However, see option NOPREDICTION below.<br>
If a $ESTIM record appears in the problem speciﬁcation, then unless the LIKELIHOOD<br>or -2LOGLIKELIHOOD option appears on the $ESTIM record, etas (if any) are under-<br>stood to be single-subject etas, except when epsilons also appear, in which case the etas<br>are understood to be population etas. If a $ESTIM record does not appear, but a $SIMUL<br>record appears, then unless the NOPREDICTION option appears on the $SIMUL record,<br>etas are understood in the same way. When the NOPREDICTION option is used, the etas<br>are understood to be population etas.<br>
In NM-TRAN abbreviated code, there can be a special block of code that is implemented<br>only during the simulation task (See <b>ICALL</b>, <b>Simulation Block</b>). It is called a &quot;simula-<br>tion block&quot;.<br>
OPTIONS:<br>The information coded within each set of parentheses deﬁnes the attributes of a single<br>random source. A source of random numbers is an &quot;inﬁnite&quot; stream of random numbers.<br>Each pair of parentheses on the record deﬁnes a separate source of random numbers, and<br>the information coded within the parentheses deﬁnes the attributes of the source. The<br>sources are ordered as they are deﬁned on the $SIMUL record. The numbers from a<br>source are explicitly available to the user via the NONMEM utility routine: RANDOM<br>(See <b>RANDOM</b>). By default, the ﬁrst source is earmarked for the simulation of etas and<br>epsilons, and then the numbers from this source are not explicitly available to the user.<br>
seed1<br>
Seed1 is the ﬁrst seed for the random source, an integer between 0 and 2147483647.<br>If this is not the ﬁrst problem speciﬁcation in the control stream, then seed1 can be<br>-1, indicating that the random source is to be continued from the previous problem.<br>
seed2<br>
Seed2 is the second seed for the random source, an integer between 0 and<br>
223<br>
<hr>
<A name=229></a>$SIMULATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
2147483647. For use of a second seed, see NONMEM Users Guide, Part IV.<br>
NORMAL<br>
The random numbers of the source are to be pseudo-normal with mean 0 and vari-<br>ance 1 (unless the source is the ﬁrst and used to generate eta and epsilon realizations,<br>in which case the variance-covariance of these variables is that speciﬁed in the<br>$OMEGA and $SIGMA records). This is the default.<br>
UNIFORM<br>
The random numbers of the source are to be pseudo-uniform on the interval [0,1].<br>
NONPARAMETRIC<br>
The random numbers from the ﬁrst source deﬁned with the NONPARAMETRIC<br>attribute are used to generate realizations of random vectors from a (multivariate)<br>nonparametric distribution on eta, obtained from the Nonparametric Step of an ear-<br>lier problem. An input MSF must also be present. It is understood that the etas are<br>to be simulated from the nonparametric distribution rather than from the pseudo-nor-<br>mal distribution associated with the ﬁrst source. The NONPARAMETRIC attribute<br>can only be used in the deﬁnition of the second or subsequent source.<br>
NEW<br>
If the NEW option is used, the vector of eta’s (epsilon’s) changes with each call to<br>SIMETA (SIMEPS), rather than only at the start of the next individual record (next<br>level-two record). That is, with NEW, a call to SIMETA will obtain new eta’s, even if<br>ID has not changed. A call to SIMEPS will obtain new eps’s, even if L2 has not<br>changed.<br>
ONLYSIMULATION<br>
NONMEM is being asked to simulate data but not to evaluate an objective function<br>on these data. WRES values in tables and scatterplots will be 0. PRED-deﬁned data<br>items in tables and scatterplots will be computed using simulated etas and initial<br>thetas.<br>
$ESTIM, $COV and $NONP cannot be used with ONLYSIMULATION. Also, see<br>the PREDICTION and NOPREDICTION options.<br>
SUBPROBLEMS=n<br>
Requests that the entire NONMEM problem is to be repeated n times in succession<br>(including all NONMEM steps: simulation, estimation, covariance, table, scatter-<br>plot). Each subproblem includes the Simulation Step, but the random sources are<br>simply continued from subproblem to subproblem. If n=0 or n=1, there is only one<br>subproblem; this is the default. May also be coded SUBPROBS, NSUBPROBLEMS,<br>NSUBPROBS. With all versions of NONMEM, the data set for each subproblem<br>after the ﬁrst is the same data set used by the previous subproblem, and includes any<br>changes (transgeneration) made by the previous subproblem.<br>With NONMEM 7.4 and higher, see REWIND, below.<br>With NONMEM 7.3 and higher, the maximum number of subproblems is increased<br>from 9999 to 2147483647.<br>
REQUESTFIRST<br>
NONMEM sets a variable IFIRSTEM in Module ROCM_INT (referenced as<br>FIRSTEM in abbreviated code) informing PRED whether or not PRED needs to<br>compute ﬁrst-partial derivatives with respect to eta. Normally, during the Simulation<br>Step, these derivatives are not needed, either by NONMEM or by the user. How-<br>ev er, the user may want the ﬁrst-partial eta derivatives of a PRED-deﬁned item and<br>
224<br>
<hr>
<A name=230></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SIMULATION<br>
may want FIRSTEM to reﬂect this. With the REQUESTFIRST option, the<br>FIRSTEM variable is set so to inform PRED that the derivatives need to be com-<br>puted. In this case, if an abbreviated code is used to compute the PRED-deﬁned<br>item, the item should not be computed within a simulation block, because NM-<br>TRAN does not provide derivatives for PRED-deﬁned items in a simulation block.<br>
REQUESTSECOND<br>
NONMEM sets a variable ISECDER in Module ROCM_INT (referenced as MSEC<br>in abbreviated code) informing PRED whether or not PRED needs to compute sec-<br>ond-partial derivatives with respect to eta. Normally, during the Simulation Step,<br>these derivatives are not needed, either by NONMEM or by the user. Howev er, the<br>user may want the second-partial eta derivatives of a PRED-deﬁned item and may<br>want the MSEC variable to reﬂect this. With the REQUESTSECOND option, the<br>MSEC variable is set so to inform PRED that the derivatives need to be computed.<br>In this case, if an abbreviated code is used to compute the PRED-deﬁned item, the<br>item should not be computed within a simulation block, because NM-TRAN does<br>not provide derivatives for PRED-deﬁned items in a simulation block. REQUEST-<br>SECOND implies REQUESTFIRST.<br>
PREDICTION<br>
Permitted only with ONLYSIM, and is the default.<br>With or without ONLYSIM, unless the NOPREDICTION is used, the simulated<br>observation is taken to be the quantity to which the Y variable (with NM-TRAN<br>abbreviated code) or F variable (with a user-supplied PRED or ERROR routine) is<br>set. In a simulation block, the DV variable may be directly set to the simulated<br>observation, but the Y (or F) variable should also be set to this observation. E.g., if a<br>line of code DV=... is used in a simulation block, be sure to follow this line with<br>the additional line Y=DV.<br>
NOPREDICTION<br>
Permitted only with ONLYSIM.<br>Indicates that the simulated observation will be taken to be the value to which the<br>DV variable is set. The code Y=... is permitted inside or outside a simulation<br>block, but if such code appears in a simulation block, be sure to also include e.g.<br>DV=Y. Also, etas (if any) are understood to be population etas, even if epsilons do<br>not appear.<br>
<b>TRUE=INITIAL</b><br>
The initial estimates given in the control stream are used as the parameter values<br>(&quot;true values&quot;) in the simulation, except when a model speciﬁcation ﬁle is input.<br>When a model speciﬁcation ﬁle is input, the initial estimates with the previous run<br>are used as the parameter values (&quot;true values&quot;) in the simulation, and the ﬁnal esti-<br>mates with the previous run are used as the initial estimates in all tasks other than<br>the simulation. The UCP used with these other tasks are the same as with the previ-<br>ous run. This is the default. May not be used with $MSFI in conjunction with<br>SUBPROBLEMS=n (n &gt; 1).<br>
TRUE=FINAL<br>
An input model speciﬁcation ﬁle must be used. The ﬁnal estimates with the previ-<br>ous run are used as the parameter values (&quot;true values&quot;) in the simulation and as the<br>initial estimates in all tasks other than the simulation. The UCP used with these<br>other tasks are new, so that a UCP value of 0.1 now corresponds to a ﬁnal estimate<br>from the previous run.<br>
225<br>
<hr>
<A name=231></a>$SIMULATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
TRUE=PRIOR<br>
The values stored in THET_P, OMEG_P, SIGM_P by the PRIOR routine are used as<br>the true parameter values (&quot;true values&quot;) in the simulation.<br>
BOOTSTRAP=n<br>
With the BOOTSTRAP option, NONMEM does not perform the usual simulation<br>activity of randomly creating DV values for a new data set, but rather selects a ran-<br>dom set of subjects from an existing &quot;template&quot; data set (which must already have<br>legitimate DV values). The BOOTSTRAP number n refers to how many subjects<br>are to be randomly selected from the data set. Setting -1 means to randomly select<br>as many subjects as are in the data set. For example, if 400 subjects are in the simu-<br>lation template data set, then 400 subjects are randomly selected. The random<br>source is, in effect, uniform, because any subject is equally probable. If n is greater<br>than the number of subjects, NONMEM will use the number of subjects.<br>
The BOOTSTRAP option in $SIML is most suitable for multi-subject data, in which<br>there is an ID data column identifying the subjects. However, see the example<br>&quot;BOOTSTRAPPING SINGLE SUBJECT DAT A&quot; in the INTRODUCTION TO<br>NONMEM 7.<br>
REPLACE<br>
Subjects are selected with replacement. This results in some subjects not being<br>selected at all, and some subjects selected more than once. This is the default.<br>
NOREPLACE<br>
Subjects are selected without replacement, that is, without repeating a subject. The<br>NOREPLACE feature is reasonable if there are many more than n subjects to choose<br>from in the template dataset (for example, 1000 subjects in the template, and for<br>each sub-problem, 50 of them are randomly chosen without replacement, that is,<br>without repeating a subject).<br>
STRAT<br>
The label of a data item that serves as the stratiﬁcation. This splits the data set into<br>distinct sub-sets, guaranteeing a speciﬁc number of subjects will be selected from<br>each category.<br>
STRATF<br>
The label of a data item that contains the fraction that should represent a category in<br>the bootstrapped data set. Without STRATF, the number of subjects to be taken<br>from a given category is proportional to the number of subjects in the base data set.<br>
<b>NOREWIND</b>|REWIND<br>
The <b>NOREWIND </b>option requests that if any input data item(s) are changed (transgen-<br>erated) during a the simulation step of a sub-problem, they remain changed at the<br>start of the next sub-problem. This is the default. With NONMEM 7.4, the REWIND<br>option requests that the original data set be used for all sub-problems. If the data set<br>is not changed during simulation, the NOREWIND and REWIND options give the<br>same results.<br>
Keep in mind that transgeneration performed on the data set using $INFN with<br>ICALL=1 affects the original data set and these changes are unaffected by REWIND<br>and NOREWIND options. For example:<br>$INFN<br>
IF (ICALL==1) THEN<br>
DOWHILE(DATA)<br>
... data transgeneration statements here<br>
226<br>
<hr>
<A name=232></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SIMULATION<br>
ENDDO<br>
ENDIF<br>
<b>SUPRESET</b>|NOSUPRESET<br>
This option affects seeds for random sources when a $SIMULATION record is<br>included in the scope of a $SUPER problem. The SUPRESET option requests that,<br>with subsequent iterations of a super-problem, the seed(s) for all random sources are<br>reset back to that listed in the $SIMULATION record of the control stream ﬁle. This<br>is the default. With NONMEM 7.4, the NOSUPRESET option may be used to pre-<br>vent resetting the random seeds, so that each iteration serves as a new random<br>instance.<br>
RANMETHOD=[n|S|m|P]<br>
As of NONMEM 7.3, the RANMETHOD option is available for the $SIM record, to<br>use alternative random numbers generators. N is the random number generator type,<br>S is Sobol sequence, and m is the Sobol scrambler. The default is NONMEM’s tra-<br>ditional one, n=4. Among the Sobol sequence methods, the S2 method appears to<br>provide the least biased random samples, that is nearly uniform distribution, with<br>good mixing in multi-dimensional spaces. As of NONMEM 7.4, RANMETHOD<br>will also act on the P modiﬁer , which will retain separate seed sequences for each<br>subject, so that the random variable patterns are retained regardless of whether the<br>simulation is done in single computing or parallel computing mode.<br>(See <b>$ESTIMATION</b>).<br>
PARAFILE=ﬁlename<br>
As of NONMEM 7.4, the Simulation Step computation may be parallelized. by<br>default. By default, parallelization is not turned on, because simulation is very rapid<br>anyway, and often does not need to be accelerated. When modeling with super-ID<br>nested ETA lev els ($LEVEL record is present), parallelization will not occur, since<br>these etas are shared across individuals, and there is no guarantee that all subjects<br>sharing the same etas will be simulated by the same process.<br>PARAFILE=ﬁlename speciﬁes a different paraﬁle than was used for the previous<br>step.<br>PARAFILE=ON turns on parallelization for the Simulation Step.<br>Set RANMETHOD=P to permit assure consistient seed patterns<br>regardless of whether or not parallelization is performed. E.g.,<br>$SIML ... PARAFILE=ON RANMETHOD=P<br>
PARAFILE=OFF turns off parallelization for the Simulation<br>Step. This is the default.<br>
OMITTED<br>
The Simulation Step is not implemented.<br>
REFERENCES: Guide IV, section III.B.13 , IV.I<br>REFERENCES: Guide V, section 12.4.8<br>REFERENCES: Guide VI, section III.C , III.E , IV.B , IV.G.1<br>
227<br>
<hr>
<A name=233></a>$SIZES DETAILED DESCRIPTIONS<br>
Help Guide<br>
$SIZES<br>
MEANING: Array sizes for NONMEM and PREDPP<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$SIZES [constant=value] [constant=value] ...<br>
SAMPLE:<br>$SIZES LIM1=30000 MAXFCN=2000000 NO=500<br>
DISCUSSION:<br>$SIZES is optional. If present, it must precede the ﬁrst $PROBLEM or $SUPER record.<br>
Certain constants are used in NM-TRAN, NONMEM and PREDPP. With NONMEM 7.2<br>and higher, the user may override many of the constants with the $SIZES record.<br>
See the discusion of sizes for a discussion of how these constants are determined, and<br>how they are communicated to NONMEM and PREDPP.<br>(See <b>SIZES FSIZES prsizes</b>)<br>
Any non-zero value speciﬁed on the $SIZES record overrides both the default and the<br>value that NM-TRAN would have speciﬁed. (A value of 0 is ignored.) As of NONMEM<br>7.3, as an alternative to modifying sizes.f90 to very large maximum sizes, you can tell<br>NMTRAN the maximum size that may be needed by specifying a $SIZES constant as a<br>negative value. Thus, a user can give NMTRAN permission to deal with all problems that<br>have data input ﬁles that have up to 1000 data items, and up to 150 etas and epsilons, and<br>up to 200 thetas, by the following:<br>
$SIZES PD=-1000 LVR=-150 LTH=-200<br>
but the values of these constants when the NONMEM executable is constructed will be<br>only what is needed for the particular problem. In contrast,<br>
$SIZES PD=1000 LVR=150 LTH=200<br>
will result in sizing the NONMEM executable with these values, and won’t make a &quot;tailor<br>ﬁt&quot;. This would result in a very large executable regardless of the model size. Thus,<br>$SIZES PD=-1000<br>tells NMTRAN that you may need as many as 1000 data items in a data ﬁle, whereas<br>$SIZES PD=1000<br>tells NMTRAN that you need exactly that size.<br>
List of $SIZES Record Options and Their Default Values<br>
LTH=100<br>LVR=30<br>LVR2=20<br>NO=250<br>MMX=10<br>LNP4=4000<br>LSUPP=4050<br>LIM7=2<br>LWS3=9000<br>MAXIDS=10000<br>LIM1=10000<br>LIM2=100000<br>
228<br>
<hr>
<A name=234></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SIZES<br>
LIM3=10000<br>LIM4=1000<br>LIM5=200<br>LIM6=400<br>LIM8=200<br>LIM11=25<br>LIM13=1000<br>LIM15=1000<br>LIM16=400<br>MAXRECID=200<br>PC=30<br>PCT=30<br>PIR=700<br>PD=50<br>PDT=50<br>PAL=50<br>MAXFCN=1000000<br>DIMTMP=500<br>DIMCNS=500<br>DIMNEW=1000<br>DIMVRB=200<br>PL=10<br>NPOPMIXMAX=10<br>MAXOMEG=70<br>MAXPTHETA=90<br>MAXITER=210<br>ISAMPLEMAX=10<br>MAXSIDL=0<br>PNM_MAXNODES=100<br>
Additional constants that may be set with $SIZES:<br>
LADD_MAX (See resource/SIZES.f90).<br>
(See <b>SIZES FSIZES prsizes</b>)<br>
REFERENCES: Guide Introduction_7<br>
229<br>
<hr>
<A name=235></a>$SUBROUTINES DETAILED DESCRIPTIONS<br>
Help Guide<br>
$SUBROUTINES<br>
MEANING: Lists certain subroutine choices for the NONMEM Executable<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$SUBROUTINES [subname1 = name1] [subname2 = name2] ...<br>
[TOL=<i>n</i>] [ATOL=<i>n</i>] [SSTOL=<i>n</i>] [SSATOL=<i>n</i>]<br>[SUBROUTINES=kind]<br>
SAMPLE:<br>$SUBROUTINES PRED=pred<br>
DISCUSSION:<br>Optional. Describes the choice of subroutines for the NONMEM executable (also called<br>the NONMEM load module). May also be coded $SUBS.<br>
One of the following is required:<br>ADVAN=name (also speciﬁes the use of PREDPP).<br>PRED=name (speciﬁes a user-supplied PRED routine).<br>
OPTIONS:<br>
subname=name<br>
Subname is the entry name of a user-supplied subroutine to be included in the NON-<br>MEM executable. Name is the name of a ﬁle containing FORTRAN source code for<br>the subroutine. Name is used by NM-TRAN as documentation (in FREPORT) and<br>for inclusion of source code (in FSUBS). More than one such option may be speci-<br>ﬁed. The names need not be unique. Name may not contain embedded spaces.<br>Name may contain as many characters as ﬁt a single line. It must not start with a<br>digit. If name contains commas, semicolons, equal signs, or parentheses, it must be<br>surrounded by single quotes ’ or double quotes &quot;.<br>
Subname may be chosen from the following categories.<br>
User-supplied NONMEM routines:<br>
CRIT MIX PRED CRIT MIX PRIOR CONTR CCONTR USMETA SPTWO<br>
User-supplied PRED routine:<br>
PRED<br>
Subroutines from the PREDPP library:<br>
ADVAN TRANS SS<br>
(See <b>ss_option</b>).<br>
User-supplied PREDPP routines:<br>
PK ERROR MODEL DES AES TOL INFN<br>
Other user-supplied subroutines:<br>
OTHER<br>
OTHER speciﬁes the name of a ﬁle that will be copied into FSUBS (e.g.,<br>OTHER=filename). A subroutine or function in ﬁle ﬁlename might be<br>called by a user-supplied routine or by verbatim code. With NONMEM 7.4, it<br>might be listed on a $ABBR FUNCTION record. The OTHER option may be<br>used up to 40 times, to specify the names of up to 40 such ﬁles; each ﬁle may<br>contain multiple subroutines and functions. These routines must be in Fortran<br>
230<br>
<hr>
<A name=236></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$SUBROUTINES<br>
90 format.<br>
SUBROUTINES=kind<br>
Speciﬁes the kind of subroutines to be included in the NONMEM executable (&quot;kind&quot;<br>must be DP - double precision).<br>
TOL=n<br>
When PREDPP is speciﬁed with an ADVAN that requires a TOL routine, this option<br>can be used to supply a NRD (&quot;number of required digits&quot;) value. &quot;n&quot; is an integer.<br>This is a relative tolerance.<br>
For TOL and the options that follow (AT OL, SSTOL, SSATOL), it is also possible<br>to code TOL=name to specify the name of a user-supplied TOL routine, or to include<br>$TOL abbreviated code, either of which allows all these values to be assigned by<br>compartment. A user-supplied TOL routine also allows values to be assigned by<br>compartment and for each NONMEM step. See also the TOL option of the<br>$COVARIANCE record. Required.<br>
ATOL=n<br>
Speciﬁes the absolute tolerance for ADVAN9, ADVAN13, ADVAN14, and<br>ADVAN15. Optional. Default is 1.0E-12. See also the ATOL option of the $ESTI-<br>MATION and $COVARIANCE records.<br>
SSTOL=n<br>
Speciﬁes the relative tolerance for Steady State evaluation. Optional. Default is<br>TOL.<br>
SSATOL=n<br>
Speciﬁes the absolute tolerance for Steady State evaluation. Optional. Default is<br>AT OL.<br>
REFERENCES: Guide IV, section III.B.6<br>
231<br>
<hr>
<A name=237></a>$SUPER DETAILED DESCRIPTIONS<br>
Help Guide<br>
$SUPER<br>
MEANING: Identiﬁes the start of a NONMEM Superproblem<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$SUPER [SCOPE=<i>n</i>1] [ITERATIONS=<i>n</i>2]<br>
[<b>NOPRINT</b>|PRINT]<br>
SAMPLE:<br>$SUPER SCOPE=2 ITERATIONS=10<br>
DISCUSSION:<br>Optional.<br>
OPTIONS:<br>
SCOPE=<i>n</i>1<br>
Number of problems in the superproblem. Required. Must be at least 1.<br>
ITERATIONS=<i>n</i>2<br>
Number of iterations of the superproblem. Required. Must be at least 2. ITERA-<br>TIONS may also be coded NITERATIONS.<br>
NOPRINT<br>
NONMEM printout displaying the input information for each of the problems of the<br>superproblem will be generated only during the ﬁrst iteration. This is the default.<br>
PRINT<br>
NONMEM printout displaying the input information for each of the problems of the<br>superproblem will be generated during all iterations.<br>
To deﬁne a sequence of problems as a superproblem, precede the $PROBLEM record of<br>the ﬁrst problem of the sequence with a $SUPER record. More than one $SUPER prob-<br>lem can be present in the control stream, but the level of nesting can be at most 2.<br>
The pattern for nested super problems is<br>
$SUPER SCOPE=s1<br>
$PROBLEM 1<br>
...<br>
$PROBLEM n<br>
$SUPER SCOPE=s2<br>
$PROBLEM n+1<br>
...<br>
$PROBLEM n+m<br>
The second super problem must be totally contained with in the ﬁrst.<br>
n &gt;= 1 and m &gt;= 1 is required (each $SUPER problem must contain at least one $PROB-<br>LEM).<br>
If s1 &gt; n, then the scope of the ﬁrst $SUPER includes the second $SUPER, and the scope<br>of the second must be entirely contained within the scope of the ﬁrst: s1 &gt;= n+s2.<br>
(See <b>Problem_Iteration_Counters</b>).<br>
REFERENCES: None.<br>
232<br>
<hr>
<A name=238></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$TABLE<br>
$TABLE<br>
MEANING: Requests that NONMEM generate a table<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$TABLE [list1] [BY list2]<br>
[<b>PRINT</b>|NOPRINT] [FILE=ﬁlename]<br>[NOHEADER|ONEHEADER] [ONEHEADERALL]<br>[NOTITLE|NOLABEL]<br>[FIRSTONLY|LASTONLY|FIRSTLASTONLY] [<b>NOFORWARD</b>|FORWARD]<br>[<b>APPEND</b>|NOAPPEND]<br>[FORMAT=<i>s</i>1] [LFORMAT=<i>s</i>1] [RFORMAT=<i>s</i>1]<br>[NOSUB=[0|1]]<br>[EXCLUDE_BY list3]<br>[PARAFILE=[ﬁlename|ON|OFF]<br>[ESAMPLE=<i>n</i>1][WRESCHOL] [SEED=<i>n</i>2]<br>[RANMETHOD=[n|S|m] ]<br>[VARCALC=[0|1|2]]<br>[FIXEDETAS=(list)]<br>[NPDTYPE=[0|1]]<br>[<b>UNCONDITIONAL</b>|CONDITIONAL] [OMITTED]<br>
SAMPLE:<br>$TABLE ID DOSE WT TIME<br>
DISCUSSION:<br>Requests that a NONMEM table be produced. Up to 10 $TABLE records may be<br>included in a given problem.<br>
OPTIONS:<br>
list1<br>
A list of item labels (i.e., user-chosen item types) to be tabled along with DV and the<br>special items PRED, RES, and WRES.<br>
The user may request the following additional special diagnostic items by<br>including their name in the list.<br>
NPRED, NRES, NWRES<br>
Calculated assuming non-conditional estimation and no eta-epsilon interac-<br>tion. NPRED and NRES are same as PRED and RES. NWRES is same as<br>WRES when INTERACTION is not set in $EST.<br>
PREDI, RESI, WRESI<br>
Calculated assuming non-conditional estimation with eta-epsilon interaction.<br>Always same as PRED, RES, and WRES.<br>
CPRED, CRES, CWRES<br>
Calculated assuming conditional estimation and no eta-epsilon interaction.<br>
CPREDI, CRESI, CWRESI<br>
Calculated assuming conditional estimation with eta-epsilon interaction.<br>
CIPRED, CIRES,CIWRES<br>
Conditional individual values<br>
233<br>
<hr>
<A name=239></a>$TABLE DETAILED DESCRIPTIONS<br>
Help Guide<br>
CIPREDI, CIRESI,CIWRESI<br>
Conditional individual values with eta-epsilon interaction.<br>
NIPRED, NIRES, NIWRES<br>
NIPRED and NIRES are same as PRED and RES. NIWRES is weighted resid-<br>ual using F(eta=0) and V(eta=0), where V is individual variance.<br>
IPREDI, IRESI,IWRESI<br>
Same as NIPRED,NIRES,NIWRES<br>
IPRD, IRS,IWRS<br>
Same as NIPRED, NIRES, and NIWRES<br>
EPRED, ERES, EWRES<br>
Monte-Carlo generated diagnostics and are not linearized approximations<br>like the other diagnostic types. EWRES is the Monte-Carlo version of<br>CWRESI.<br>
ECWRES<br>
Monte-Carlo version of CWRES.<br>
EIPRED, EIRES,EIWRES<br>
EIPRED and EIRES are same as EPRED and ERES. EIWRES is Monte Carlo<br>assessed individual weighted residual.<br>
NPDE<br>
Monte-Carlo generated normalized probability distribution error.<br>
NPD<br>
The correlated (or non-decorrelated) NPDE value.<br>
OBJI<br>
Objective function values for each individual (same as given in the root.phi<br>ﬁle). The sum of the individual objective function values is equal to the total<br>objective function.<br>
In addition the list may include:<br>
Data item labels.<br>
Labels ETA(1), ETA(2), ... ,ETA(10), ... , ETA(70), etc.,<br>or alternatively, labels ETA1, ETA2, ... ,ETA10, ... , ETA70, etc., corresponding to<br>eta(1), eta(2), etc.<br>The labels in the output will be ETA1, ETA2, ... , ET10, ... ET70, etc.<br>
With NONMEM 7.3, a range of etas may be requested:<br>
ETAS(k:n)<br>is equivalent to<br>
ETAk, ..., ETAn<br>where n &gt; k. LAST can be used in place of n, and requests the last (highest num-<br>bered) eta in the problem. E.g. ETAS(1:LAST)<br>With NONMEM 7.4, more ﬂexible syntax is available:<br>The word TO may be used in place of &quot;:&quot;.<br>The BY expression may be used:<br>ETAS(1 TO 10 by 3) prints out etas 1,4,7,10<br>ETAS(LAST TO 1 by -3) prints out etas 10,7,4,1 (assuming LAST=10)<br>A number list may be given:<br>ETAS(1,5,12,4) prints out etas 1, 5, 12, 4.<br>ETAS(4:1) prints etas 4, 3, 2, 1<br>
234<br>
<hr>
<A name=240></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$TABLE<br>
ETAS(4:1 by -2) prints etas 4, 2<br>ETAS(1:4 by -1) prints etas 4, 3, 2, 1 (the by value sets the direction).<br>
With NONMEM 7.4, a symbolic label speciﬁed in $ABBR REPLACE may be listed<br>in $TABLE. For example:<br>$ABBR REPLACE ETA(CL)=ETA(1)<br>
...<br>
$TABLE ETA(CL)<br>
Reserved positions of MODULE NMPRD4 (See <b>$ABBREVIATED</b>). COM(k) or :k<br>denotes the kth reserved position. (There must be exactly 4 digits after &quot;:&quot;. Use leading<br>0’s as necessary.) E.g., COM(3) or :003.<br>Labels of the form :k will be used in the output.<br>
Labels of PRED-deﬁned items in MODULE NMPRD4 if abbreviated code is present (up<br>to PDT distinct such labels in any one problem, for all tables and scatterplots. PDT is a<br>constant in resource/SIZES.f90; default value is 500.) These may include labels of the<br>NM-TRAN-deﬁned items:<br>
0nnn e.g., 0010 stands for A00nnn<br>1nnn e.g., 1010 stands for A01nnn<br>2nnn e.g., 2010 stands for C00nnn<br>3nnn e.g., 3010 stands for D00nnn<br>4nnn e.g., 4010 stands for E00nnn<br>5nnn e.g., 5010 stands for F00nnn<br>6nnn e.g., 6010 stands for P00nnn<br>
These may also include:<br>
labels VECTRA(1), VECTRA(2), ... ,VECTRA(9), or alternatively, labels VA_1,<br>VA_2, ... ,VA_9, corresponding to VECTRA(1), VECTRA(2), ..., VECTRA(9).<br>The labels in the output will be VA_1, VA_2, ... , VA_9.<br>Similarly, for VECTRB and VECTRC.<br>
Synonyms may be deﬁned on either the $TABLE or $SCATTER record for special items<br>PRED, RES, WRES; for PRED-deﬁned items; for NM-TRAN-deﬁned items; and for<br>reserved positions of MODULE NMPRD4.<br>
E.g., assume that IWRES is a PRED-deﬁned label, that at least 3 positions of NMPRD4<br>are reserved, and that NM-TRAN has generated A00032 as the label for a derivative in<br>the generated FSUBS routine. Either $TABLE or $SCATTER records may include:<br>
WRES=RES1,IWRES=RES2,COM(3)=ABC,0032=DK.<br>
For a discussion of the values of ETAs and PRED-deﬁned items (e.g., are they based on<br>initial or ﬁnal values of theta? Simulated or zero or conditional values of eta?), see <b>val-<br>ues</b>.<br>
Elements of G and H<br>E.g., $TABLE G11 G21 G31 H11 H21<br>The format is Gk1 or Hk1, where k is an integer value, e.g. 1-9 or 01-99 or 001-999. Gk1<br>requests the value of G(k,1), and Hk1 requests the value of H(k,1), where G and H are<br>arguments of subroutine PRED. G(k,1) is the partial of F (the prediction) with respect to<br>ETA(1), and H(k,1) is the partial of F with respect to EPS(1). (HH may be coded instead<br>of H, but it is treated as if it were H.) A variable of the form Gk1 or Hk1 is not a reserved<br>variable. If it is previously deﬁned (i.e., if it is listed in $INPUT, or used on the left in<br>
235<br>
<hr>
<A name=241></a>$TABLE DETAILED DESCRIPTIONS<br>
Help Guide<br>
abbreviated code, or used as a synonym e.g., $TABLE G11=COM(1)), then that deﬁni-<br>tion of the variable is used, and there is no change from previous versions of NM-TRAN.<br>Only if there is no other previous deﬁnition of the variable will it be understood to be an<br>element of G or H.<br>What NM-TRAN actually displays is the variable in MODULE NMPRD4 that was used<br>to compute the derivative of interest (a variable in the series A00nnn, C00nn, or D00nnn)<br>with the appropriate synonym such as G11. If there is no such variable, this is an error.<br>NMTRAN will not display variables that are not computed , e.g., G41 when there are<br>only 3 etas in the problem, or when there are 4 etas but ETA(4) does not contribute to the<br>value of Y.<br>[There is a workaround if the zero is wanted as a place holder in the table. In abbreviated<br>code ($ERROR or $PRED or $PK)<br>G41=0.<br>Now G41 may be listed in $TABLE or $SCATTER.]<br>This feature is designed so that the verbatim code in the &quot;compute.cwres&quot; R documenta-<br>tion is unnecessary.<br>E.g., Instead of:<br>
$ABB COMRES=5<br>
&quot;LAST<br>
&quot;<br>
COM(1)=G(1,1)<br>
&quot;<br>
COM(2)=G(2,1)<br>
&quot;<br>
COM(3)=G(3,1)<br>
&quot;<br>
COM(4)=HH(1,1) (or H(1,1) with $PRED)<br>
&quot;<br>
COM(5)=HH(2,1) (or H(2,1) with $PRED)<br>
$TABLE ID COM(1)=G11 COM(2)=G21 COM(3)=G31<br>
COM(4)=H11 COM(4)=H21<br>
IPRED MDV NOPRINT ONEHEADER FILE=cwtab1<br>
Use only:<br>$TABLE ID G11 G21 G31 H11 H21<br>
IPRED MDV NOPRINT ONEHEADER FILE=cwtab1<br>
(See <b>Displayed PRED-Deﬁned Items</b>).<br>
When tables are printed, the maximum number of labels permitted in list1 is 8; oth-<br>erwise, it is PDT. (But see the NOAPPEND option.)<br>
list2<br>
A list comprised of one or more labels from list1. The rows of the table are sorted<br>on the data items in list2. List2 may not appear when the number of labels in list1 is<br>greater than 8. That is, a table with more than 8 data items also may not be sorted.<br>
NOSUB=[0|1]<br>
With NOSUB=0, label substitution will be performed for ﬁnal estimates in table ﬁles.<br>(See <b>$ABBREVIATED</b>). This is the default. With NOSUB=1, label substitution<br>will not be performed.<br>
list3<br>
A list comprised of one or more items that are permitted in list1, e.g., data item<br>labels and labels of PRED-deﬁned items in MODULE NMPRD4. They follow<br>option EXCLUDE_BY. Labels in list3 are called exclusion variables. If one or more<br>of them have a non-zero value for a given data record, the row of the table corre-<br>sponding to the data record will be excluded from the table ﬁle. Exclusion variables<br>are not listed in the table ﬁle. They hav e no effect on the printed table or scatters in<br>the NONMEM output, e.g., they do not cause any rows to be deleted from the<br>
236<br>
<hr>
<A name=242></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$TABLE<br>
printed table and are displayed in the printed table.<br>
PARAFILE=ﬁlename<br>
Weighted residuals are evaluated before the ﬁrst $TABLE record. As of NONMEM<br>7.4, this computation is parallelized if parallelization is on when the ﬁrst Table Step<br>is implemented.<br>PARAFILE=ﬁlename speciﬁes a different paraﬁle than was used for the previous<br>step.<br>PARAFILE=ON turns on parallelization for the weighted residuals.<br>PARAFILE=OFF turns off parallelization for the weighted residuals.<br>The PARAFILE option may be speciﬁed on any $TABLE record, but applies to all<br>$TABLE records.<br>
ESAMPLE=<i>n</i>1<br>
<i>n</i>1 speciﬁes the number of random samples used to calculate the Monte-Carlo diag-<br>nostics. Should be speciﬁed only on the ﬁrst $TABLE record. Default is 300.<br>
WRESCHOL (NM73)<br>
Use the Cholesky square root of the variance, rather than the eigenvalue square<br>root, when computing weighted residuals. Should be speciﬁed only on the ﬁrst $TA-<br>BLE record. This can speed up the Table Step when there are a large number of<br>observations per individual.<br>
SEED=<i>n</i>2<br>
<i>n</i>2 speciﬁes the starting seed for generating the Monte-Carlo diagnostics. Should be<br>speciﬁed only on the ﬁrst $TABLE record. Default is 11456.<br>
RANMETHOD=[n|S|m]<br>
n: the random number generator used for the Monte-Carlo simuations of weighted<br>residual items.<br>
0: ran0 of reference [4], minimal standard generator<br>1: ran1 of reference [4], Bays and Durham.<br>2: ran2 of reference [4].<br>3: ran3 of reference [4], Knuth. (Default)<br>4: NONMEM’s traditional random number generator used in $SIMULATION<br>
S: sobol sequence<br>m: the type of scrambling desired<br>
0: no scrambing (S0 is the same as S)<br>1: Owen type scrambling<br>2: Faure-Tezuka type scrambling<br>3: Owen plus Faure-Tezuka type scrambling.<br>
See the description of RANMETHOD for $ESTIM. Among the Sobol sequence<br>methods, the S2 method appears to provide the least biased random samples, that is<br>nearly uniform distribution, with good mixing in multi-dimensional spaces.<br>See <b>INTRODUCTION TO NONMEM 7</b>, Reference [4].<br>See <b>INTRODUCTION TO NONMEM 7</b>, Monte Carlo Importance Sampling EM<br>RANMETHOD should be speciﬁed only on the ﬁrst $TABLE command. The RAN-<br>METHOD set in the $TABLE command does not propagate to $EST or $CHAIN.<br>
Options PRINT, NOPRINT, HEADER, NOHEADER, NOLABEL, NOTITLE, FILE,<br>FIRSTONLY, LASTONLY,FIRSTLASTONLY, FORWARD, NOFORWARD, APPEND,<br>NOAPPEND, FORMAT, VARCALC apply to the individual $TABLE record. They<br>must be speciﬁed for each table to which they apply.<br>
237<br>
<hr>
<A name=243></a>$TABLE DETAILED DESCRIPTIONS<br>
Help Guide<br>
PRINT<br>
A printed table appears in the NONMEM output. This is the default.<br>
NOPRINT<br>
No printed table appears in the NONMEM output.<br>
FILE=filename<br>
The table is written to the given ﬁle in character form, e.g., ASCII or EBCDIC,<br>according to the hardware platform. Filename may not contain embedded spaces. If<br>it contains commas, semicolons, or parentheses, then it must be surrounded by sin-<br>gle quotes ’ or double quotes &quot;. Filename may also contain equal signs if it is<br>enclosed in quotes. Filename may contain at most 71 characters. If ﬁlename is the<br>same as any option of the $TABLE record, it must be enclosed in quotes. Filename<br>can differ between $TABLE records.<br>Default: No table ﬁle is output. Required with NOPRINT.<br>
NOHEADER<br>
Used only with the FILE option. No header lines are included in the table ﬁle.<br>
ONEHEADER<br>
Used only with the FILE option. Only the ﬁrst line of the table is a header line.<br>
ONEHEADERALL (NM74)<br>
Used only with the FILE option and FORWARD. Only the ﬁrst line of the table ﬁle<br>is a header line. May also be coded ONEHEADERPERFILE.<br>
NOLABEL<br>
Used only with the FILE option. Do not print column labels. It may be combined<br>with ONEHEADER to print only the title at the beginning of each table.<br>
NOTITLE<br>
Used only with the FILE option. Do not print table titles. It may be combined with<br>ONEHEADER to print only the column labels at the beginning of each table.<br>NOLABEL NOTITLE is equivalent to NOHEADER.<br>
FIRSTONLY<br>
Only information corresponding to the ﬁrst data record from each individual record<br>appears in the table. May also be coded FIRSTRECORDONLY or FIRSTRE-<br>CONLY.<br>
LASTONLY<br>
Only information corresponding to the last data record from each individual record<br>appears in the table. May also be coded LASTRECORDONLY or LASTRECONLY.<br>
FIRSTLASTONLY<br>
Only information corresponding to the ﬁrst and last data record from each individual<br>record appears in the table.<br>
NOFORWARD<br>
Used only with the FILE option. When the table ﬁle is opened during a given<br>(sub)problem, it is positioned at the start of the ﬁle. This is the default. However,<br>when there are multiple $TABLE records within the same problem and having the<br>same ﬁlename, the situation is a little more complicated; see the text describing the<br>FORWARD option.<br>
FORWARD<br>
Used only with the FILE option. When a table ﬁle is opened during a given<br>(sub)problem, it is forwarded to the end of the ﬁle. This allows a table ﬁle to accu-<br>mulate tables from multiple subproblems and superproblems. Moreover, if in the<br>
238<br>
<hr>
<A name=244></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$TABLE<br>
same (sub)problem the $TABLE record is followed by a contiguous succession of<br>additional $TABLE records having the same ﬁlename as the given record, then even<br>though some of these additional records may have the NOFORWARD option, or have<br>neither the NOFORWARD nor the FORWARD options, the FORWARD option will apply<br>to each of the records in the succession.<br>
APPEND<br>
Items DV, PRED, RES, WRES appear automatically as the last 4 columns of the table.<br>This is the default.<br>
NOAPPEND<br>
Requests that items DV, PRED, RES, WRES not appear automatically. When this is<br>speciﬁed, the number of labels (i.e., user-chosen item types) that may appear in the<br>table can be as large as 12 (rather than 8) for a printed table, and as large as PDT=4<br>(rather than PDT) for a table ﬁle. If items PRED, RES, and/or WRES are explicitly<br>coded in list1, then they appear in the table, exactly as listed. (Previously to NON-<br>MEM VI 2.0, they could be included in the list, but were suppressed from the por-<br>tion of the table described by list1 in favor of the automatically-generated items.)<br>
FORMAT=<i>s</i>1<br>
<i>s</i>1 deﬁnes the delimiter [,|s(pace)|t(ab)] followed by a Fortran format speciﬁcation.<br>The default is s1PE11.4. Affects table ﬁles until a different FORMAT is speciﬁed.<br>If the user-deﬁned format is inappropriate for a particular number, then the default<br>format will be used for that number. Alternately, use LFORMAT and/or RFOR-<br>MAT.<br>
LFORMAT=<i>s</i>1<br>
Speciﬁes the format of the full label record of a table. Allows different formats for<br>different columns. Sample:<br>LFORMAT=&quot;(4X,A4,4(’,’,4X,A8))&quot;<br>
RFORMAT=<i>s</i>1<br>
Speciﬁes the format of the full numeric record of a table. Allows different formats<br>for different columns. Sample:<br>RFORMAT=&quot;(F8.0,,4(’,’,1PE12.5))&quot;<br>
Multiple LFORMAT options and RFORMAT options may be present and will be<br>concatenated. The format speciﬁcations are not checked by NMTRAN. If either is<br>invalid, the run will fail in NONMEM. Both LFORMAT and RFORMAT affect ta-<br>ble ﬁles until a different format is speciﬁed. Use LFORMAT=&quot;NONE&quot; or RFOR-<br>MAT=&quot;NONE&quot; to resume use of the default format (which may have been speciﬁed<br>by the FORMAT option) in a subsequent problem.<br>
VARCALC=[0|1|2]<br>
To report standard errors in the tables for PREDPP and user-deﬁned parameters, set<br>$TABLE ...VARCALC=1. This appends an item named item_SE following each<br>item in list1. If using RFORMAT formatting option, make sure to allow enough for-<br>mat ﬁelds to include reported standard errors. In addition, full variances-covariances<br>among all user-deﬁned and PREDPP parameters will be outputted to root.vpd (the<br>FORMAT used for this ﬁle is that deﬁned in the $EST statement). To only print the<br>vpd ﬁle, and not report SE’s to the table, set VARCALC=2. This option must be re-<br>coded for each $TABLE record for which SE’s are wanted. If VARCALC=1 or 2 is<br>requested at least once among any of the tables, then the variance items are written<br>to the vpd table. VARCALC=0 requests neither SE’s nor vpd, and is the default.<br>
239<br>
<hr>
<A name=245></a>$TABLE DETAILED DESCRIPTIONS<br>
Help Guide<br>
FIXEDETAS=(list)(NM74)<br>
Speciﬁed etas may be treated as if they are ﬁxed effects when evaluating population<br>diagnostics during the $TABLE step. This is particularly suitable for super-ID<br>$LEVEL etas that span groups of subjects, as if they were a ﬁxed effect when evalu-<br>ating populations characteristics during the $TABLE step, such as PRED, CWRES,<br>NPDE, etc. In this way, the PRED evaluated will be, not of the total population, but<br>of a given site level for that subject. List is a number-list of etas. For example,<br>FIXEDETAS=(3-6)<br>A number-list may contain a single integer, a range of integers (with -), or a series of<br>integers and ranges separated by comma.<br>
NPDTYPE=1<br>
The strict stochastic (Monte Carlo) method over the data y domain as well as etas is<br>implemented for NPD diagnostics.<br>
NPDTYPE=0<br>
An asymptotic assessment of the residual variability is used. This is the default.<br>
UNCONDITIONAL<br>
The Table Step is always implemented. This is the default.<br>
CONDITIONAL<br>
The Table Step is implemented only when the Estimation Step terminates success-<br>fully or is not implemented.<br>
OMITTED<br>
The Table Step is not implemented.<br>
REFERENCES: Guide IV, section III.B.16<br>REFERENCES: Guide V, section 9.5.1 , 10.7.1<br>
240<br>
<hr>
<A name=246></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$THETA<br>
$THETA<br>
MEANING: Gives initial estimates and bounds for thetas<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$THETA <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...<br>
[(<i>value</i>)x<i>n</i>]<br>[NUMBERPOINTS=n]<br>[<b>ABORT</b>|NOABORT|NOABORTFIRST]<br>
SAMPLE:<br>$THETA (0,3) 2 FIXED (0,.6,1) 10 (-INF,-2.7,0) (37 FIXED)<br>
DISCUSSION:<br>Gives initial estimates and bounds for elements of the THETA matrix. Thetas are num-<br>bered in the order in which they are deﬁned.<br>
OPTIONS:<br>
Each value deﬁnes a theta and gives its initial estimate and bounds. A value has one of 4<br>forms:<br>
init [FIXED]<br>
Init is the initial estimate. If FIXED is used, the ﬁnal parameter estimate is to be<br>constrained to equal the initial parameter estimate.<br>
([low,] init [,up] [FIXED])<br>
Low and up are lower and upper bounds respectively. They are the boundaries for<br>the minimization search. Commas are optional. If an upper bound is used, a lower<br>bound must also be used (e.g., -INF; see below). The lower and upper bounds (or<br>if just the lower bound is used, then just this bound) may be omitted, in which case<br>this form differs from the one described above only in so far as with this form, the<br>initial estimate and the FIXED attribute are enclosed in parentheses. When FIXED<br>is used, and a bound appears the bound must equal the initial estimate. FIXED is<br>implied when all three values are equal. The lower bound can be -INF (i.e., -inﬁn-<br>ity), and the upper bound can be INF (i.e., +inﬁnity). These are the defaults for<br>lower and upper bounds. They are communicated to NONMEM as numeric values<br>-1000000 and 1000000.<br>
([low,] init [,up]) [FIXED]<br>
This is just like the form described above except that if the FIXED attribute is used,<br>the attribute occurs outside the parentheses, and then if moreover, a bound appears,<br>the bound need not equal the initial estimate.<br>
(low,,up)<br>
The commas are required. Because no initial estimate is given, a search for an initial<br>estimate (the Initial Estimates Step) is undertaken by NONMEM. With NONMEM<br>7.4, when initial thetas are to be estimated, evaluations can now be done for FOCE<br>and Laplace, not just for FO.<br>
(<i>value</i>)x<i>n</i><br>
Any initial value or group of initial values may be enclosed in parentheses and fol-<br>lowed by &quot;x<i>n</i>&quot;, which means to replicate the values within parentheses <i>n </i>times<br>(&quot;repeated value&quot;). The values within the parenthesis may have any of the above<br>forms. For example, the following two are equivalent:<br>
241<br>
<hr>
<A name=247></a>$THETA<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
$THETA 2 2 2 2 (0.001,0.1,1000) (0.001,0.1,1000) (0.001,0.1,1000)<br>
(0.5 FIXED) (0.5 FIXED)<br>
$THETA (2)x4 (0.001,0.1,1000)x3 (0.5 FIXED)x2<br>
NUMBERPOINTS=n<br>
During NONMEM’s search for an initial estimate, a number of points will be exam-<br>ined. This number will be automatically determined by NONMEM, or it can be<br>speciﬁed with this option.<br>
May also be coded NUMBERPTS, NUMPOINTS,<br>
NUMPTS.<br>
ABORT<br>
During the Initial Estimates step, NONMEM is to abort when PRED sets the error<br>return code to 1. (The PRED error return code n is set by the statement &quot;EXIT n<br>[k]&quot; in abbreviated code, or by the statement IERPRD=n in user-supplied code, or<br>by PREDPP when it detects an error.) This is the default.<br>
NOABORT<br>
During the Initial Estimates step, NONMEM is simply to ignore values of the theta<br>vector that result in PRED error return code 1. (Ordinarily the ﬁrst value of the theta<br>vector is never ignored.) These will not be feasible values for an initial estimate.<br>
NOABORTFIRST<br>
Same as NOABORT option, but also applies to the ﬁrst value of the theta vector that<br>is tried. It cannot be shortened; all characters must be coded. May be used with the<br>NOABORT option, in which case the stronger condition (NOABORTFIRST) takes<br>precedence.<br>
REFERENCES: Guide IV, section III.B.9<br>
242<br>
<hr>
<A name=248></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$THETAI<br>
$THETAI<br>
MEANING: Gives Instructions for Transforming Initial Thetas<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$THETAI Fortran statements<br>
SAMPLE:<br>$THI<br>
THETA(1:NTHETA)=LOG(THETAI(1:NTHETA))<br>
THETAP(1:NTHP)=LOG(THETAPI(1:NTHP))<br>
THETA=LOG(THETA)<br>
DISCUSSION:<br>
The purpose of $THETAI is to transform the initial values in the $THETA and $THETAP<br>records. The record name may also be coded as $THI.<br>
In the above sample code, it is desired that the thetas by estimated within NONMEM in<br>the log domain, but the user wants the convenience of inputting and outputting them in<br>the natural domain, such as when performing linear MU referencing.<br>
The $THETAI record will convert any initial thetas in a $THETA record, or thetas<br>obtained from a chain ﬁle, but will not convert thetas from an MSF ﬁle. The variance to<br>the theta priors will be appropriately converted when using $PRIOR NWPRI.<br>
The assignment statements may be any Fortran 95 statements. They are copied<br>unchanged to subroutine SUBROUTINE THETAISUB in FSUBS (also found in<br>thetair.f90).<br>
They may include array assigment statements specifying the whole arrays or sections of<br>arrays.<br>
If the initial estimate for an element of theta is transformed, so is the upper and lower<br>bounds for that theta, if any.<br>
Arguments of the subroutine are as follows.<br>
THETAI<br>
Values of THETA speciﬁed on $THETA records. Input.<br>
THETAPI<br>
Values of THETA speciﬁed on $THETAP records (or, if the informative names are<br>not used, thetas corresponding to priors, if any). Input.<br>
THETA<br>
New values of THETA. Output.<br>
THETAP<br>
New values of THETA’ s for priors. Output.<br>
Other reserved variables that may be used are as follows:<br>
NTHETA<br>
Number of thetas to be estimated.<br>
NTHP<br>
Number of theta priors.<br>
243<br>
<hr>
<A name=249></a>$THETAI DETAILED DESCRIPTIONS<br>
Help Guide<br>
NPROB IPROB<br>
These can be tested in IF statements so that values may be assigned diffently for dif-<br>ferent problems.<br>
If the range is not speciﬁed, NONMEM to supply the range (which is by default<br>NTHETA+NTHP).<br>
When appropriate, for reporting thetas, the inverse function should be supplied, e.g., with<br>the samples above:<br>
$THR<br>
THETAR(1:NTHETA)=EXP(THETA(1:NTHETA))<br>
THETAPR(1:NTHP)=EXP(THETAP(1:NTHP))<br>
or<br>
THETAR=EXP(THETA)<br>
Note that the assignment occurs after the NONMEM control stream has been processed,<br>so that errors in assignment of THETA’ s are not found. E.g.<br>$THI<br>
THETA=0.<br>This will set all theta’s to 0, and there will be no speciﬁc error message from NONMEM,<br>though most likely the run will fail.<br>
If initial estimates of all or part of THETA are omitted, NONMEM performs a search for<br>missing initial estimates as its ﬁrst task. (These are printed on a separate page under the<br>heading &quot;INITIAL PARAMETER ESTIMATE&quot;). This search occurs before the trans-<br>formation by $THETAI.<br>
Values of INITIAL ESTIMATE OF THETA in NONMEM output are those from the<br>$THETA/$THETAP records. Values of THETA in the root.ext ﬁles are as set in $THI.<br>
$THI may be used with $THR, but not necessarily.<br>
Another example is rescaling thetas. E.g., suppose in CONTROL5<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
is replaced with<br>
$THETAI<br>
THETA=THETAI/10.<br>
$THETA (1,30,50) (.08,.8,5) (.04,.4,9)<br>
The results will be identical, except for the values of INITIAL ESTIMATE OF THETA in<br>the NONMEM report. The values in .ext will not be affected.<br>
REFERENCES: Guide Introduction_7<br>
244<br>
<hr>
<A name=250></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$THETAP,$THETAPV<br>
$THETAP,$THETAPV<br>
MEANING: Gives prior information for thetas<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$THETAP <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...<br>$THETAPV <i>value</i>1 [<i>value</i>2] [<i>value</i>3] ...<br>SAMPLE:<br>; Prior information of THETAS (NTHP=4 of them)<br>
$THETAP (2.0 FIX) (2.0 FIX) (2.0 FIX) (2.0 FIX)<br>
; Variance to prior information of THETAS (NTHPxNTHP=4x4 of them).<br>
$THETAPV BLOCK(4)<br>
10000 FIX<br>
0.00 10000<br>
0.00 0.00 10000<br>
0.00 0.00 0.0 10000<br>
DISCUSSION:<br>
These are called the informative forms of the $THETA record, for use with the NWPRI<br>utility.<br>
$THETAP gives prior information for elements of the THETA matrix.<br>$THETAPV gives variance information for THETA priors.<br>
The name of the record describes the kind of information it gives, rather than the struc-<br>ture of the information. E.g., in the example above, $THETAPV is implemented in<br>FCON with an $OMEGA record because it is in general an array of values. These<br>records may be located anywhere in the control stream. NM-TRAN inserts the corre-<br>sponding records in the control stream in the correct order. When the informative forms<br>are used, the options of $PRIOR NWPRI need not be speciﬁed. However, if options are<br>listed in $PRIOR NWPRI, then these values are chosen over what is surmised from the<br>informatively labeled theta/omega/sigma records.<br>(See <b>nwpri</b>).<br>
OPTIONS:<br>
The option FIXED should be used. Other appropriate options are BLOCK and VALUES.<br>
REFERENCES: Guide Introduction_7<br>
245<br>
<hr>
<A name=251></a>$THETAR DETAILED DESCRIPTIONS<br>
Help Guide<br>
$THETAR<br>
MEANING: Gives Instructions for Transforming Final Thetas<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$THETAR Fortran statements<br>
SAMPLE:<br>$THETAR<br>
THETAR=EXP(THETA)<br>
Or<br>
$THETAR<br>
THETAR(1:NTHETA)=EXP(THETA(1:NTHETA))<br>
THETAPR(1:NTHP)=EXP(THETAP(1:NTHP))<br>
DISCUSSION:<br>
The purpose of $THETAR is to transform the ﬁnal theta values for the NONMEM report<br>and additional output ﬁles. The record name may also be coded as $THR.<br>
In the above sample code, it is assumed that $THETAI was used to transform thetas from<br>the natural domain to the log domain for estimation within NONMEM, such as when per-<br>forming linear MU referencing. $THETAR causes them to be output in the natural<br>domain as well.<br>
This affects the following data in the output report:<br>NPARAMETR<br>
FINAL PARAMETER ESTIMATE for THETA.<br>
FIRST ORDER STANDARD ERROR OF ESTIMATE<br>
THETA - VECTOR OF FIXED EFFECTS PARAMETERS<br>
FIRST ORDER COVARIANCE MATRIX OF ESTIMATE<br>
THETA - VECTOR OF FIXED EFFECTS PARAMETERS<br>
Contents of additional output ﬁles such as .coi and .cov and .cor are also affected.<br>
The assignment statements may be any Fortran 95 statements. They are copied<br>unchanged to subroutine SUBROUTINE THETARSUB in FSUBS (also found in<br>thetair.f90).<br>
They may include array assigment statements specifying the whole arrays or sections of<br>arrays.<br>
Arguments of the subroutine are as follows.<br>
THETA<br>
Final estimates of theta. Input.<br>
THETAP<br>
Final estimates of thetas speciﬁed on $THETAP records (or, if the informative<br>names are not used, thetas corresponding to priors, if any). Input.<br>
THETAR<br>
New values of THETA. Output<br>
THETAPR<br>
New values of THETA’ s for priors. Output.<br>
Other reserved variables that may be used are as follows:<br>
246<br>
<hr>
<A name=252></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$THETAR<br>
NTHETA<br>
Number of thetas to be estimated.<br>
NTHP<br>
Number of theta priors.<br>
NPROB IPROB<br>
These can be tested in IF statements so that values may be assigned diffently for dif-<br>ferent problems.<br>
If the range is not speciﬁed, NONMEM to supply the range (which is by default<br>NTHETA+NTHP).<br>
$THR may be used with $THI, but not necessarily.<br>
Another example is rescaling thetas. E.g., suppose that<br>$THETAI<br>
THETA=THETAI/10.<br>
was used to rescale thetas on input.<br>
Then<br>$THETAR<br>
THETAR=THETA*10.<br>can be used to report them in the original domain.<br>
REFERENCES: Guide Introduction_7<br>
247<br>
<hr>
<A name=253></a>$TOL DETAILED DESCRIPTIONS<br>
Help Guide<br>
$TOL<br>
MEANING: Marks the beginning of abbreviated code for the TOL routine<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$TOL<br>
abbreviated code<br>
DISCUSSION:<br>The $TOL record is used to specify compartment-speciﬁc NRD values. It is used with<br>PREDPP’s general non-linear models (ADVAN6, ADVAN8, ADVAN9, ADVAN13,<br>ADVAN14, ADVAN15 and SS6 and SS9). NRD stands for &quot;Number of Required Dig-<br>its,&quot; although the precise meaning depends on the particular ADVAN or SS routine that<br>uses it.<br>
$TOL cannot be present if the $SUBROUTINES record includes any of the correspond-<br>ing options.<br>
The following are equivalent:<br>$SUBROUTINES ... TOL=n<br>and<br>$SUBROUTINES ...<br>
$TOL NRD=n<br>
Left-hand quantities:<br>
These are identical to the left-hand variables that may be set in subroutine TOL. If sub-<br>script &quot;(I)&quot; is omitted, it defaults to 1.<br>
NRD(I)<br>
The number of digits that are required to be accurate in the computation of the drug<br>amount in compartment I, i.e., the relative tolerance. ADVAN 9, 13, 14, and 15 have<br>the capability of using different values of NRD for different compartments. For<br>compartments not speciﬁed, the tolerance of the last compartment speciﬁed will be<br>used.<br>
However, all the other ADVAN routines requiring TOL take the relative tolerance to<br>be the same for all compartments; NRD(I), <i>I </i>&gt; 1, is ignored, and only NRD(1) is<br>used. With NONMEM 7.4, NRD(0) is the relative tolerance for the Steady State<br>computations. If NRD(0) is not speciﬁed, NRD(1) is used.<br>
The value of NRD(1) can also be speciﬁed using $SUBROUTINES option TOL.<br>The value of NRD(0) can also be speciﬁed using $SUBROUTINES option SSTOL.<br>
ANRD(I) (NM74)<br>
The absolute tolerance in the computation of the drug amount in compartment I.<br>The default is 12 (that is, accuracy is 10**(-12)). Used by ADVAN 9, 13, 14, and<br>15, which have the capability of using different values of ANRD for different com-<br>partments. For compartments not speciﬁed, the tolerance of the last compartment<br>speciﬁed will be used.<br>
ANRD(0) is the absolute tolerance for the Steady State computations. If ANRD(0)<br>is not speciﬁed, ANRD(1) is used.<br>
The value of ANRD(1) can also be speciﬁed using $SUBROUTINES option ATOL.<br>The value of ANRD(0) can also be speciﬁed using $SUBROUTINES option<br>SSATOL.<br>
248<br>
<hr>
<A name=254></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$TOL<br>
NRDC(I) (NM74)<br>
Same as NRD(I), but used for the FOCE/LAPLACE covariance step. Used with<br>ADVAN 9, 13, 14, and 15. If not set, NRDC defaults to the value of NRD.<br>NRDC(0) is used for Steady State computations during the FOCE/LAPLACE<br>covariance step.<br>
The value of NRDC(1) can also be speciﬁed using $SUBROUTINES option TOLC.<br>The value of NRDC(0) can also be speciﬁed using $SUBROUTINES option<br>SSTOLC.<br>
ANRDC(I) (NM74)<br>
Same as ANRD(I), but used for the FOCE/LAPLACE covariance step. Used with<br>ADVAN 9, 13, 14, and 15. If not set, ANRDC defaults to the value of ANRD.<br>ANRDC(0) is used for Steady State computations during the FOCE/LAPLACE<br>covariance step.<br>
The value of ANRDC(1) can also be speciﬁed using $SUBROUTINES option<br>AT OLC.<br>The value of ANRDC(0) can also be speciﬁed using $SUBROUTINES option<br>SSATOLC.<br>
Right-hand quantities:<br>
Integers, e.g., NRD(1)=4<br>
Forbidden Variable Names:<br>
All other variables.<br>
RECORD ORDER:<br>
Follows $SUBROUTINES and $MODEL<br>
REFERENCES: Guide IV, section V.C.3 , V.C.10<br>REFERENCES: Guide VI, section VI.D , Figure 41<br>
249<br>
<hr>
<A name=255></a>$WARNINGS DETAILED DESCRIPTIONS<br>
Help Guide<br>
$WARNINGS<br>
MEANING: Control Display of NM-TRAN Warning, Data Warning and Data Error mes-<br>sages<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>$WARNINGS [NONE] [<i>n</i>] [<b>RESET </b>| NORESET ]<br>
[WARNINGMAXIMUM= [ NONE | <i>n </i>| (list)] ]<br>[DATAMAXIMUM= [ NONE | <i>n </i>| (list)] ]<br>[ERRORMAXIMUM=<i>n </i>]<br>
SAMPLE:<br>$WARNING WMAX=1,EMAX=9999<br>
DISCUSSION:<br>Optional. Controls the display of NM-TRAN warning messages and data error messages<br>in the current and all subsequent problems until another $WARNING record appears.<br>May appear anywhere in the control stream following $SIZES, $SUPER (if present) and<br>$PROBLEM records, but cannot affect the display of warning messages associated with<br>the records that precede it.<br>
OPTIONS:<br>
NONE<br>
Suppress all warning messages.<br>
<i>n</i><br>
Sets WARNINGMAXIMUM=n, ERRORMAXIMUM=n, DATAMAXIMUM=n. May be 0,<br>in which case it is the same as NONE.<br>
LIST<br>
Print a list of all possible warning messages. When this option is present, the con-<br>trol stream must consist <b>only </b>of the single record:<br>
$WARNING LIST<br>
WARNINGMAXIMUM<br>
Refers to general (non-data) warning messages. May also be coded WARNMAXIMUM<br>and shorter substrings, e.g., WMAX, WARN. May appear more than once, with cumu-<br>lative effect.<br>
WARNINGMAXIMUM=NONE<br>
Suppress warning messages.<br>
WARNINGMAXIMUM=<i>n</i><br>
Each type of warning message will be displayed no more than <i>n </i>times (<i>n </i>≥ 0).<br>The default is 20.<br>
WARNINGMAXIMUM=(list)<br>
The list is a series of integers <i>n</i><br>
≥<br>
1, <i>n</i>2, <i>n</i>3 ... (<i>ni</i><br>
0). <i>ni </i>gives the the maximum<br>
number for the <i>i</i>th type of warning message.<br>
NONE may coded for any <i>ni </i>if it is the last in the list. Sets the maximum num-<br>ber of messages for the <i>i</i>th and all higher-numbered messages to zero.<br>
Example:<br>$WARNING WMAX=1<br>Sets the maximum for all non-data messages to 1.<br>
250<br>
<hr>
<A name=256></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
$WARNINGS<br>
DATAMAXIMUM<br>
Refers to data warning messages. May also be coded DMAXIMUM and shorter sub-<br>strings, e.g. DMAX, DATA. May appear more than once, with cumulative effect.<br>Forms and default are identical to those for the WARNINGMAXIMUM option.<br>
ERRORMAXIMUM=<i>n</i><br>
Refers to data error messages. It can also be coded ERRMAXIMUM or EMAXIMUM,<br>and shorter strings, e.g., EMAX. Each type of data error message will be displayed<br>no more than <i>n </i>times (<i>n </i>≥ 0). The default is 20. Data error messages can never be<br>totally suppressed. With <i>n </i>= 0 and <i>n </i>= 1, NM-TRAN displays the ﬁrst data error<br>message and then terminates.<br>
Example:<br>
$WARNING EMAX=99999<br>
Sets the maximum number of data error messages displayed from 20 to a much<br>higher value, so that NM-TRAN will not terminate until all data error conditions<br>have been identiﬁed.<br>
RESET<br>
All counts reset to 0 with each new problem. This is the default.<br>
NORESET<br>
Counts of how many times a given message has been displayed are accumulated<br>over problems. (A new $WARNING record always resets all counters, but they will<br>not be automatically reset again with subsequent problems.)<br>
A $WARNING record with no options re-establishes all default conditions as if no<br>$WARNING records had been present.<br>
REFERENCES: None.<br>
251<br>
<hr>
<A name=257></a>ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
ABBREVIATED CODE<br>
MEANING: FORTRAN-like statements<br>CONTEXT: Abbreviated code<br>
SAMPLE:<br>$PK CL=THETA(1)+ETA(1)<br>
DISCUSSION:<br>Abbreviated code is FORTRAN-like language within an NM-TRAN control stream that<br>is used to specify a model. The $PRED, $PK, $ERROR, $DES, $AES, $AESINITIAL,<br>$TOL, $MIX, and $INFN records each begin a block of abbreviated code. Such a block<br>ends with either the appearance of another record beginning with a &quot;$&quot;, or with the<br>absence of any further records in the control stream.<br>
The general rules are:<br>
One statement of abbreviated per line, starting anywhere on the line.<br>No statement numbers (unlike with FORTRAN).<br>Comments may be included on any line after the semicolon character &quot;;&quot;.<br>No statement types other than assignment,<br>IF, THEN, ELSE, ELSEIF, ENDIF, DO WHILE,<br>ENDDO, CALL, WRITE, PRINT, RETURN, OPEN, CLOSE, REWIND.<br>(e.g., no GOTO, READ, FORMAT.)<br>With NONMEM 7.2 and higher, both lower and upper case may be used for all<br>user-deﬁned and reserved words.<br>Continuation lines are permitted using the character &amp; at the end<br>of the line.<br>A special statement type, EXIT, is permitted.<br>
ASSIGNMENT STATEMENTS<br>
An assignment statement (A=B) uses right-hand quantities in an expression B in<br>order to deﬁne a quantity A.<br>
Permissible right-hand quantities are:<br>previously deﬁned quantities, including declared variables that have also been used<br>on the left side of an assignment statement.<br>(See <b>$abbreviated</b>).<br>constants, e.g 1, 1.1, 3E+1 3E1, 3E01, 3E-1 3E-01, 3D+1, 3D1, 3D01, 3D-1 3D-01<br>THETA, OMEGA and SIGMA elements, e.g. THETA(1), OMEGA(2,2). When<br>the two subscripts for an OMEGA or SIGMA element are the same, only one sub-<br>script is needed, e.g. OMEGA(2).<br>labels of data items deﬁned in the $INPUT record<br>variables ETA(n), EPS(n), ERR(n), which are understood to have mean 0 and<br>variances and covariances given by elements of the OMEGA and SIGMA arrays.<br>operators + - * / **<br>parentheses ()<br>built-in functions: LOG (natural log), LOG10, EXP, SQRT, SIN, COS, ABS, TAN,<br>ASIN, ACOS, ATAN, INT, MIN, MAX, MOD<br>NONMEM functions: PHI, GAMLN<br>
FORTRAN functions may have random variable arguments and the appropriate<br>partial derivatives are computed. The partial derivative of ABS(X) with respect<br>to η is mathematically undeﬁned at X=0. We are arbitrarily deﬁning it to be<br>
252<br>
<hr>
<A name=258></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ABBREVIATED<br>
<i>dX </i>/<i>deta</i>. If the prediction depends on X, X must always be either positive or<br>negative. If the argument of GAMLN is a random variable, it must always be<br>positive. Function PHI may have a random argument but no partial derivates<br>are computed.<br>
The INT, MOD, MIN, and MAX functions produce discontinuous results. No<br>partial derivatives are computed. If they are used outside of a simulation block<br>and the function value affects the value of the objective function, then an error<br>in the NONMEM Estimation Step will probably occur. If they are needed in<br>the computations of DADT (differential equations; with ADVAN 6, 8 ,9), then<br>the funcions should be used instead in the PK routine, and model event time<br>(MTIME) parameters be used to set ﬂags for DES.<br>(See <b>Model Time examples</b>)<br>(See <b>Cirdadian example</b>)<br>
abbreviated functions (see below)<br>subscripted variables (see below)<br>
With previous versions of NONMEM, constants were limited to 12 characters. With<br>NONMEM 7 a constant may be up to 30 characters. (The length is speciﬁed by con-<br>stant SCO in SIZES)<br>
Further information about Assignment statements:<br>
Parentheses may be nested in the right-hand side of an assignment statement.<br>
Except in certain blocks of abbreviated code (i.e. a simulation block, an initialization<br>block, or a ﬁnalization block), the variables ETA(n), EPS(n), ERR(n) are con-<br>sidered to be (the base) random variables, and quantities deﬁned in terms of these<br>variables (directly or indirectly) are themselves considered to be random variables.<br>NM-TRAN sets up computations for derivatives of random variables with respect to<br>the base random variables.<br>
Left-hand variables that have no reserved meaning are called user-deﬁned variables.<br>With previous versions of NONMEM they were restricted to 8 characters in length<br>and could not include the character _. With NONMEM 7 a user-deﬁned variable<br>name consists of 1-20 letters (A-Z), numerals (0-9), and the character ’_’, beginning<br>with a letter. (The length 20 is speciﬁed by constant SD in SIZES)<br>(See <b>SIZES</b>).<br>
With NONMEM 7, variables MU_1, MU_2, etc., are reserved and are used for mu<br>modelling.<br>See <b>INTRODUCTION TO NONMEM 7, MU Referencing<br></b>(See <b>MU_Model</b>).<br>
Left-hand quantities VECTRA(n), VECTRB(n), VECTRC(n) may be deﬁned, and<br>these become elements of pre-deﬁned vectors VECTRA, VECTRB, VECTRC. If<br>VECTRA, VECTRB, VECTRC is deﬁned without a subscript, it is understood to be a<br>simple variable. A subscript must be an integer constant, or a character string that is<br>replaced by an integer constant using the $ABBR REPLACE feature. Whereas once<br>it is deﬁned, a vector element may be used as a right-hand quantity - in the same<br>
253<br>
<hr>
<A name=259></a>ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
way as any previously deﬁned variable - the vector itself may be used only as an<br>argument to an abbreviated function.<br>
(See VECTORS and ABBREVIATED FUNCTIONS, below.)<br>
Values may be assigned to certain special variables: RPTO, RPTON and PRDFL -<br>with the repetition feature<br>(See <b>Repetition Variables</b>);<br>SKIP_ (but only in a ﬁnalization block) - with superproblems or subproblems<br>(See <b>SKIP</b>).<br>
Variables, constants, and functions are all of double precision ﬂoating point type.<br>(E.g., K=.5 gives K the value .5, not 0 as it would be under the FORTRAN conven-<br>tion that K is integer type.)<br>
Except in certain blocks of abbreviated code (i.e. a simulation block, an initialization<br>block, or a ﬁnalization block), a label in an $INPUT record may not appear on the<br>left in an assignment statement.<br>
There is a reserved storage area of module NMPRD4, and when deﬁning the kth<br>variable in this area, it may be referenced as COM(k). Then, even if the variable is<br>deﬁned in terms of random variables, it is not regarded as being a random variable;<br>derivatives of COM(k) with respect to the base random variables are not computed.<br>
CONDITIONAL STATEMENTS<br>
Conditional statements have one of two forms:<br>
IF (condition) assignment statement<br>
IF (condition) THEN<br>
abbreviated code ...<br>
ELSEIF (condition) THEN<br>
abbreviated code ...<br>
ELSE<br>
abbreviated code ...<br>
ENDIF<br>
See below for a restriction on ELSEIF.<br>Conditions may include the operators .EQ., .NE., .LE., .GE., .LT., .GT., .AND., and<br>.OR.. The arthmetic operators may be coded as ==, /=, &lt;=, &gt;=, &lt;, and &gt;, respec-<br>tively. They may include expressions that can be used as right-hand quantities with<br>assignment statements. They may not include parentheses except in such expres-<br>sions.<br>Valid:<br>
IF (Q.EQ.(R+C)/D) ...<br>
Invalid:<br>
IF (Q.EQ.R.AND.(C.GT.D.OR.E.EQ.F)) ...<br>
With $PRED, $PK, and $ERROR records, a condition may test the ICALL argu-<br>ment. However, if the test is IF (ICALL.EQ.2), then ELSE may not be used.<br>Special rules apply. For more detail, see SPECIAL STATEMENTS (below), and<br>help entries for these records.<br>
254<br>
<hr>
<A name=260></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ABBREVIATED<br>
A condition may also test certain variables deﬁned in modules<br>(See <b>Variables_in_modules</b>, <b>NONMEM_modules</b>, <b>PREDPP_modules</b>).<br>
Abbreviated code in a particular THEN or ELSE clause may not contain multiple<br>deﬁnitions of the same random variable. The code below is inv alid:<br>
IF (condition) THEN<br>X=...an expression involving a random variable<br>X= ....<br>ENDIF<br>
Random variables cannot be deﬁned within nested conditionals, i.e., within a condi-<br>tional structure beginning with an IF and containing another IF. The use of ELSEIF<br>... THEN implies a nested conditional.<br>
A special rule applies when random variables are deﬁned via conditional statements.<br>If a random variable is multiply deﬁned within a series of IF ... THEN structures, but<br>all conditions are false, then the value of the random variable is set to zero. If an<br>ELSE appears, then not all conditions are false.<br>Consider two cases in which the following statements are the only ones deﬁning<br>TVK and K, respectively:<br>
IF (WT.GT.0) TVK=THETA(1)*WT<br>
If the condition is false, the non-random variable TVK retains the value set with the<br>previous data record.<br>
IF (WT.GT.0) K=THETA(1)*WT*EXP(ETA(1))<br>
If the condition is false, the value of the random variable K is set to zero.<br>NM-TRAN prints a warning message when it detects such code.<br>
In $PK, $ERROR, and $PRED records, recursion code may be used in an explicit<br>manner, as in this example:<br>
IF (WT.GT.0) THEN<br>
K=THETA(1)*WT*EXP(ETA(1))<br>
ELSE<br>
K=K<br>
ENDIF<br>
If the condition is false, K retains its value set with the previous data record.<br>
Recursion code can be used in $PRED, $PK, and $ERROR records for other pur-<br>poses as well. The following two fragments of code illustrate how one can use<br>abbreviated code to implement recursive kinetics in $PRED. The ﬁrst example<br>works with a single bolus dose and the second example works with single or multi-<br>ple bolus doses. Similar code can be used in $PK and $ERROR.<br>
K=THETA(1)*EXP(ETA(1))<br>
IF (TIME.EQ.0) THEN<br>
OLDA=AMT<br>
T=TIME<br>
ENDIF<br>
A=OLDA*EXP(-K*(TIME-T))<br>
255<br>
<hr>
<A name=261></a>ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
OLDA=A<br>
T=TIME<br>
K=THETA(1)*EXP(ETA(1))<br>
IF (TIME.EQ.0) THEN<br>
A=AMT<br>
T=TIME<br>
ELSE<br>
A=A*EXP(-K*(TIME-T))+AMT<br>
ENDIF<br>
T=TIME<br>
The above forms of recursion work for recursion from one data record to the next<br>(&quot;inter-record&quot; recursion). It is also possible to use recursion in a do-while loop<br>(&quot;intra-record&quot;, or &quot;do-while&quot; recursion).<br>
Example of a do-while recursive loop using a random variable:<br>
TERM=THETA(1)*EXP(ETA(1))<br>
SUM=0<br>
DO WHILE(condition)<br>
SUM=SUM+TERM<br>
...<br>
ENDDO<br>
A product loop such as<br>
PROD=PROD*TERM<br>
is also possible, as are other ways the dowhile recursive variable can be used, so<br>long as the variable appears on both sides of the equal sign within the DOWHILE<br>loop: V= ... V ...<br>
EXIT STATEMENT<br>
The exit statement has three forms:<br>
EXIT<br>
EXIT n<br>EXIT n k<br>
n is called the &quot;PRED error return code&quot;; (also called the &quot;PRED exit code.&quot;) It<br>must be 1 or 2. Default is 1.<br>k is the user error code. It may be omitted; if present, it must be integer-valued in<br>the range 0-999. Default is 0.<br>
The EXIT statement causes an immediate exit from the routine and, if PREDPP is<br>being used, a subsequent immediate exit from PREDPP, with a return to NONMEM.<br>It is typically used in an IF statement to avoid further computation of the users code<br>when the values of theta/eta’s set by NONMEM are inappropriate or would lead to<br>an arithmetic exception. If such an exit occurs during a Simulation, Covariance, Ta-<br>ble or Scatterplot Step, or during computation of the initial value of the objective<br>function, NONMEM will abort. If the exit occurs during an Estimation or Initial<br>Estimates Step, NONMEM’s action depends on the error return code value:<br>
256<br>
<hr>
<A name=262></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ABBREVIATED<br>
1<br>
Suppose ﬁrst that a search for eta is not underway. Then a search for theta is under-<br>way, and when a search is underway for theta, the following happens:<br>
If the NOABORT option is used, NONMEM will try to continue using different<br>values for theta (i.e. &quot;theta-recovery&quot;); otherwise, NONMEM aborts. If theta-<br>recovery fails, NONMEM aborts.<br>
Next, suppose a search for eta is underway. NONMEM will try to continue using<br>different values for eta (i.e. &quot;eta-recovery&quot;). Suppose eta-recovery fails. If a search<br>for theta is not also underway, NONMEM aborts. Otherwise, the above procedure<br>regarding theta-recovery applies.<br>(See <b>Guide VI, section III.K</b>)<br>
2<br>
NONMEM aborts immediately.<br>
If NONMEM aborts, and k&gt;0, a user message such as the following is printed in the<br>output:<br>&quot;PK SUBROUTINE: USER ERROR CODE = k&quot;<br>This message is intended to help the user distinguish which EXIT statement caused<br>NONMEM to abort when more than one EXIT statement is present in the abbrevi-<br>ated code.<br>
WRITE AND PRINT STATEMENTS<br>
(See <b>write print</b>).<br>
SPECIAL STATEMENTS<br>
Optional. Each of these special statements is permitted in special blocks of abbrevi-<br>ated code.<br>(See <b>Initialization-Finalization block</b>, <b>Simulation block</b>).<br>(See <b>Expectation block</b>, <b>Data_Average block</b>).<br>
CALL PASS(MODE)<br>
Must be coded exactly as shown. May be used only in $PRED initialization-ﬁnal-<br>ization blocks, and in $INFN records. If present, MODE becomes a reserved variable<br>with type INTEGER, and may not be used outside the block(s).<br>
CALL SUPP(ie,ic)<br>
Must be coded as shown, with constant integer values 0 or 1 in place of ie and ic. A<br>value 1 for ie (ic) suppresses output from the Estimation (Covariance) step. A value<br>0 does not suppress the output from the step. May be used only in $PRED initializa-<br>tion-ﬁnalization blocks, and in $INFN records. The ie (ic) value remains in force<br>until changed by a call to SUPP.<br>
CALL RANDOM(n,R)<br>
Must be coded as shown, with a constant integer value 1-10 in place of n. The value<br>is the number of the random source. R is a random number from this source. May<br>be used only in Simulation and Expectation blocks. If present, R becomes a<br>reserved variable with type REAL, and may not be used outside the block(s).<br>
CALL SIMETA(ETA)<br>
257<br>
<hr>
<A name=263></a>ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
Must be coded exactly as shown. May only be used in Simulation blocks. Note that<br>NM-TRAN itself provides the minimum necessary call to SIMETA. This statement<br>is used in abbreviated code only to obtain a different value of ETA, e.g., so that the<br>eta distribution may be truncated:<br>DO WHILE (ETA(1).GT.5)<br>
CALL SIMETA(ETA)<br>
ENDDO<br>
CALL SIMEPS(EPS)<br>
Must be coded exactly as shown. May only be used in Simulation blocks. Note that<br>NM-TRAN provides the minimum necessary call to SIMEPS. This statement is<br>used in abbreviated code only to obtain a different value of EPS, e.g., so that the dis-<br>tribution may be truncated (see SIMETA above).<br>
DO WHILE( condition )<br>
With NONMEM 7, DOWHILE may be used in all blocks of abbreviated code.<br>DOWHILE marks the beginning of a set of statements that are executed repeatedly<br>until the condition is false. The ending of the set of statements is marked by the<br>statement ENDDO. The non-FORTRAN syntax DO WHILE(DATA) is permitted in<br>$PRED initialization and ﬁnalization blocks, and in the $INFN record.<br>(See <b>Initialization-Finalization block</b>).<br>
RETURN<br>
May be used in all special blocks. RETURN statements must be used with caution<br>because they by-pass certain normal ﬁnal actions of the routine.<br>
VECTORS and ABBREVIATED FUNCTIONS<br>
Reserved variable names VECTRA, VECTRB, VECTRC, etc. may be used for pre-<br>deﬁned vectors. elements. Elements can be deﬁned in any order.<br>
Vectors that are deﬁned outside of $DES (or $AES) may not be used in the $DES (or<br>$AES) code. I.e., a vector may not be an implicit basic PK parameter.<br>
If FUNCA, FUNCB, FUNCC, etc. is deﬁned without a subscript, it is understood to<br>be a simple variable, and then it may appear as such as a right-hand quantity. If<br>FUNCx appears for the ﬁrst time as a right-hand quantity, it is understood to be the<br>reserved name of an abbreviated function, and then it must include a single argu-<br>ment, e.g. FUNCA(VECTRA)) or FUNCA(THETA(1)). Complete FORTRAN<br>code for an abbreviated function is supplied by the user (See <b>abbreviated function</b>).<br>
The argument of an abbreviated function may be any expression that can be used in<br>an assignment statement (possibly involving explicit vector elements), or it can be<br>simply a vector. In the latter case, any VECTR may be used with any FUNC, e.g.<br>X=FUNCA(VECTRB).<br>
With NONMEM VI 2.0:<br>
258<br>
<hr>
<A name=264></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ABBREVIATED<br>
Function names may be FUNCA through FUNCC.<br>Reserved argument vector names may be VECTRA through VECTRC.<br>A giv en reserved function may have at most 9 elements in the argument vector, and<br>may appear in abbreviated code at most 9 times.<br>
With NONMEM 7.3:<br>
Function names may be FUNCA through FUNCI, and constant NFUNCX in SIZES<br>may be used to increase the number.<br>Reserved argument vector names may be VECTRA through VECTRC.<br>
With NONMEM 7.4:<br>
Function names may be FUNCA through FUNCZ.<br>Reserved argument vector names may be VECTRA through VECTRZ.<br>Extended reserved names are recognized. These are FUNCxy and FUNCxyz, where<br>each of x, y, z stands for an alphabetic character A-Z, e.g., FUNCAB or FUNCABC.<br>Similar extended reserved names for vectors are also recognized: e.g, VECTRAB or<br>VECTRABC.<br>A reserved function may appear in abbreviated code more than 9 times.<br>
The $ABBR FUNCTION and $ABBR VECTOR feature allows the user to declare<br>the names of user-deﬁned functions and the names and sizes of user-deﬁned argu-<br>ment vectors. Restrictions such as the number of user functions, the number of ele-<br>ments in a vector, and the number of times a given function may appear in abbrevi-<br>ated code are more ﬂexible and may be modiﬁed by the user.<br>(See <b>$abbreviated</b>).<br>(See <b>abbreviated function</b>).<br>
PSEUDO ASSIGNMENT STATEMENTS<br>
Pseudo-assignment statements are optional and provide certain special instructions.<br>If present, they must appear (in any order) at the beginning of a record, before the<br>rest of the essential abbreviated code comprising that record. They may be enclosed<br>in parentheses, but two or more pseudo-assignment statements enclosed by parenthe-<br>ses must be separated by a semicolon &quot;;&quot;. The following pseudo-statement may be<br>used in all records except $MIX.<br>
COMRES=-1 : All quantities deﬁned in abbreviated code are to be stored locally;<br>they are not to be stored in the (global) MODULE NMPRD4.<br>(Variables in MODULE NMPRD4 can be used for communication between various<br>user-routines, and can be displayed in tables and scatterplots.)<br>
See the entries for speciﬁc records for information about pseudo-assignment state-<br>ments special to those records.<br>
RESERVED VARIABLE NAMES<br>
Reserved variable names include names of those variables that have special meaning<br>for the user, as well as names of variables that are used internally by NM-TRAN.<br>Entries for $PRED, $PK, $ERROR, $DES, $AES, $AESINITIAL, and $TOL<br>describe the reserved variable names for these abbreviated codes.<br>
259<br>
<hr>
<A name=265></a>ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
A variable name that is reserved in an abbreviated code may not be used as the name<br>of a variable deﬁned in this code, or in any other abbreviated code unless the<br>pseudo-assignment statement COMRES=-1 is used (in some code). If a reserved<br>variable name is inappropriately used, NM-TRAN will generate an error message.<br>
The following names are reserved in all abbreviated codes for internal use by NM-<br>TRAN:<br>
Names of modules and of variables in the modules<br>(See <b>Variables_in_modules</b>).<br>GETETA SIMETA SIMEPS<br>
COMSAV NWIND ETEXT IERPRD MSEC MFIRST NETEXT<br>
ETA1-ETA9,ETA10-ETA99<br>
Annnnn Bnnnnn Cnnnnn Dnnnnn Ennnnn Fnnnnn Pnnnnn Qnnnnn<br>
MCnnnn MEnnnn MGnnnn MTnnnn<br>(where nnnnn is numeric 00000-99999, and nnnn is numeric 0000-9999)<br>
SUBSCRIPTED VARIABLES<br>
Subscripts may be used with user-deﬁned variables that are declared to be arrays<br>using the $ABBR DECLARE record, and also with certain reserved variables:<br>
THETA,THETAFR,SETHET,THSIMP,SETHETR,THSIMPR<br>
OMEGA,OMEGAF,SEOMEG,OMSIMP<br>
SIGMA,SIGMAF,SESIGM,SGSIMP<br>
CNTID,IIDX<br>
CDEN_<br>
A, A_0 (when used in a WRITE or PRINT statement)<br>ETA, EPS, ERR (when used in a WRITE OR PRINT statement)<br>
Where a subscript is permitted or necessary, it may be an <i>integer expression</i>. An<br>integer expression is an integer constant, a declared integer variable that has<br>appeared on the left (i.e., has been given a value), a constant deﬁned in SIZES, an<br>expression involving integer constants and integer variables and arithmetic operators<br>+, -, *, /, **. It may also be a character string that is replaced by an integer expres-<br>sion using the $ABBR REPLACE feature. The number of subscripts must be equal<br>to the number of dimensions. If there are two subscripts, either or both may be con-<br>stants or expressions. If a subscripted variable may be used on the left side, then the<br>subscript may also be an integer expression. E.g.,<br>
$ABBR DECLARE INTEGER IND<br>
...<br>
$PK<br>
IND=1<br>
X=THETA(IND+1)<br>
With reserved random variables such as<br>ETA(n) EPS(n) ERR(n) A(n) A_0(n)<br>integer expressions may be used only if they are listed in in WRITE or PRINT state-<br>ments. Otherwise n must be an integer constant, or a character string that is<br>replaced by an integer constant using the $ABBR REPLACE feature.<br>
260<br>
<hr>
<A name=266></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ABBREVIATED<br>
NONMEM RESERVED VARIABLES<br>
There are many variables that are generally internal to NONMEM, and often are not<br>needed by users except occasionally, which are not explicitly recognized by<br>NMTRAN, and so cannot be used in abbreviated code, but must be used with verba-<br>tim code (&quot; at beginning of line). A convenient means of accessing such variables,<br>as well as letting NMTRAN allow you to use the variables in abbreviated code is to<br>place the MODULE deﬁnitions in an include ﬁle that begins with the name NON-<br>MEM_RESERVED (case insensitive). Insert include statements for such ﬁles at the<br>beginning of the block(s) of abbreviated code in which you want to use them. The<br>user may use any of these variables without using verbatim code. NMTRAN<br>&quot;reads&quot; the nonmem_reserved ﬁle, and remembers the variables declared in there as<br>acceptable to use.<br>
A list of useful variables and their meanings are listed in ..\guides\useful_vari-<br>ables.pdf. Be careful in their use, as you have the ability to change the values of<br>these reserved variables, and this could crash the system if you change the wrong<br>thing.<br>
NONMEM_RESERVED_GENERAL in the ..\util directory has a few of the quite<br>useful variables listed. It needs to be copied to the present run directory so that NM-<br>TRAN has access to it. Note that there may be user-deﬁned variable names in the<br>control stream that inadvertently have the same names as variables in NON-<br>MEM_RESERVED_GENERAL, which may cause compiler errors. If so, make a<br>smaller version of NONMEM_RESERVED_GENERAL with a name also starting<br>with &quot;NONMEM_RESERVED&quot; that contains only those reserved variables of inter-<br>est.<br>
As an example,<br>
NONMEM_RESERVED_GENERAL contains<br>
&quot; USE NMBAYES_INT, ONLY: ITER_REPORT,BAYES_EXTRA_REQUEST,BAYES_EXTRA<br>
These variables can be used as shown in example 8:<br>
$PK<br>
include nonmem_reserved_general<br>
BAYES_EXTRA_REQUEST=1<br>
....<br>
IF(BAYES_EXTRA==1 .AND. ITER_REPORT&gt;=0 .AND. TIME==0.0) THEN<br>
WRITE(50,*) ITER_REPORT,ID,CL,V1,Q,V2<br>
ENDIF<br>
ITER_REPORT contains the present iteration number as reported to the console or<br>NONMEM report ﬁle. BAYES_EXTRA and BAYES_EXTRA_REQUEST are<br>described in example8.ctl.<br>
RESERVED AND OTHER FUNCTIONS<br>
261<br>
<hr>
<A name=267></a>ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
The nonmem_reserved_general ﬁle contains function declarations, such as TFI and<br>TFD, which are convenient functions to easily convert an integer to text (&quot;text from<br>integer&quot; TFI) or double precision value to text (&quot;text from double&quot; TFD).<br>
If you wish to deﬁne your own function for use in abbreviated code and have the<br>information about its proper use of arguments be conveyed upon its execution, so the<br>compiler may detect errors, then one method is to package the deﬁnition of the func-<br>tion in a USE module, such as is done in the example User-deﬁned Reserved Func-<br>tion.<br>
REFERENCES: Guide IV, section IV<br>REFERENCES: Guide VI, section III.K<br>REFERENCES: Guide Introduction_7<br>
262<br>
<hr>
<A name=268></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ABBREVIATED<br>
ABBREVIATED FUNCTION<br>
MEANING: User-supplied function that may be used in abbreviated code.<br>CONTEXT: Fortran coded function<br>
The following applies to all versions of NONMEM.<br>
USAGE:<br>FUNCTION FUNCA(X,X1,X2)<br>
DOUBLE PRECISION X,X1,X2,FUNCA<br>
DIMENSION X(9),X1(9),X2(9,9)<br>
The constant &quot;9&quot; must be used exactly as shown.<br>
DISCUSSION:<br>The FORTRAN function FUNCA may be used in abbreviated code. Similarly,<br>the functions FUNCB, FUNCC, etc. may be used; their constructions would be similar to<br>that of FUNCA. In abbreviated code, the function is referenced with a single argument,<br>either a (scalar) expression or a vector. Certain reserved names such as VECTRA, VEC-<br>TRB, etc. may be used in the abbreviated code, but the name of the argument is not in<br>the code deﬁning the function. (See <b>abbreviated code</b>). In the code deﬁning the func-<br>tion, the function has three arguments.<br>
Input Argument:<br>
X<br>
The value of the argument (which may be a vector).<br>
Output Argument:<br>
FUNCA<br>
The value of the function is to be stored in FUNCA.<br>
There are two other outputs.<br>
X1 X1(n) is the ﬁrst-partial derivative of the function with respect to the nth element<br>
of the argument.<br>If the value of X(n) will not be a value of a random variable, X1(n) need not be<br>set.<br>If the argument X is a (scalar) expression, only X1(1) is needed.<br>
X2 X2(n,m) is the second-partial derivative of the function with respect to the nth and<br>
mth elements of the argument.<br>If the value of either X(n) or X(m) will not be a value of a random variable,<br>X2(n,m) need not be set. Nor need any value of X2 be set if a test of MSEC=1 is<br>false (See <b>Partial Derivative Indicators</b>).<br>If the argument is a (scalar) expression, only X2(1,1) may be needed. If the argu-<br>ment is a vector and if the value of X2(n,m) is needed, then the value of X2(m,n)<br>is needed as well, even though these two values will be identical.<br>
The Fortran code for the functions should be placed in one or more ﬁles. Suppose there<br>is one such ﬁle and its name is funcﬁle. It should be listed on the $SUBROUTINES<br>record. It may contain more than one FUNCTION. E.g.,<br>$SUBROUTINES ... OTHER=funcfile<br>
With NONMEM VI 2.0, reserved function names are FUNCA through FUNCC.<br>reserved names for vectors are VECTRA through VECTRC.<br>
263<br>
<hr>
<A name=269></a>ABBREVIATED DETAILED DESCRIPTIONS<br>
Help Guide<br>
With NONMEM 7.3, reserved function names are FUNCA through FUNCI.<br>
With NONMEM 7.4, reserved function names are FUNCA through FUNCZ. Reserved<br>names for vectors are VECTRA through VECTRZ.<br>
If the abbreviated code uses one of these reserved function names, but the user does not<br>supply the code via $SUBR OTHER, the NONMEM executable will be created, but there<br>will be an error message in the NONMEM report ﬁle such as:<br>FUNCA WAS CALLED, BUT NO CODE WAS SUPPLIED.<br>
With NONMEM 7.4, extended reserved names are recognized. These are FUNCxy and<br>FUNCxyz, where each of x, y, z stands for an alphabetic character A-Z, e.g., FUNCAB or<br>FUNCABC. Similar extended reserved names for vectors are also recognized: e.g, VEC-<br>TRAB or VECTRABC.<br>If the abbreviated code uses one of these extended reserved function names, but the user<br>does not supply the code via $SUBR OTHER, the NONMEM executable cannot be cre-<br>ated, and there will be an error message from the Fortran compiler such as:<br>Undefined Symbols<br>
_funcaaa_<br>
(See <b>Abbreviated function example</b>).<br>
The following applies only to NONMEM 7.4 and higher.<br>
The $ABBR FUNCTION allows the user to declare the name of the function, the name of<br>the vector of input arguments (which is of no use to the function), and the length of the<br>vector of input arguments, which is passed to the function as argument NDIM.<br>AJB what did I mean by &quot;which is of no use to the function&quot;? Constant NVECX in<br>SIZES gives the maximum value size of the vector of input arguments.<br>
In the NONMEM control stream:<br>
$ABBR FUNCTION function_name(input_vector_name,dimension,usage)<br>
(See <b>$ABBREVIATED</b>).<br>(See VECTORS and ABBREVIATED FUNCTIONS)<br>
The function should be coded as follows:<br>
FUNCTION function_name(X,X1,X2,NDIM)<br>
USE SIZES, ONLY: DPSIZE,ISIZE<br>
INTEGER(KIND=ISIZE) :: NDIM<br>
REAL(KIND=DPSIZE), INTENT(IN)<br>
:: X<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: X1,X2<br>
REAL(KIND=DPSIZE):: function_name<br>
DIMENSION X(NDIM),X1(NDIM),X2(NDIM,NDIM)<br>
Function_name must be exactly as speciﬁed via $ABBR FUNCTION. The value coded<br>as &quot;dimension&quot; is passed to the function as NDIM. (The value coded as &quot;usage&quot; is<br>optional and does not appear in code for the function.)<br>
The value of the function is to be stored in function_name. Otherwise, the function<br>is coded exactly as described above, with X1 and X2 as output arguments. The input_vec-<br>tor_name is never used in the Fortran code for the function.<br>
REFERENCES: none<br>
264<br>
<hr>
<A name=270></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ABSORPTION<br>
ABSORPTION LAG PARAMETER<br>
MEANING: Absorption lag (ALAG) parameter for PREDPP<br>CONTEXT: Additional PK Parameters<br>
USAGE:<br>$PK<br>
ALAG1= ....<br>
DISCUSSION:<br>
Absorption lag parameters are used with PREDPP. They are optional additional PK<br>parameters. With NM-TRAN, they are symbolized in the $PK block by reserved vari-<br>ables ALAGn, where n is the compartment number to which the parameter applies.<br>
There is one absorption lag time (parameter) associated with every possible dose com-<br>partment of the kinetic model (the output compartment is not a possible dose compart-<br>ment) and the absorption lag time used for a given dose is that one associated with the<br>compartment into which the dose is given (the dose compartment).<br>
The event time t on a dose record refers to the recorded time the dose was administered.<br>In the case of a regular infusion, t is the time the infusion was initiated. An absorption<br>lag time is an increment of time L such that the time that the dose is regarded (by<br>PREDPP) as entering (or starting to enter) the system is t+L.<br>
Absorption lag times are optional in the sense that absorption lag times associated with<br>compartments never used as dose compartments may be ignored. The values of absorp-<br>tion lag times that are not computed in PK are always understood to be 0.<br>
An absorption lag time for a dose is computed by the PK routine using, if needed, infor-<br>mation in the dose record. When additional doses are speciﬁed on a dose event record,<br>the absorption lag time applies to the dose and to all the additional doses. With a steady-<br>state multiple dose the absorption lag time applies not only to this dose, but also to all the<br>preceding implied doses. With a steady-state dose, the lag time should be less than the<br>interdose interval.<br>
(See <b>cmt</b>, <b>pk</b>, <b>$pk</b>, <b>default_compartment</b>).<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide VI, section III.F.6 , V.F.1 , V.H<br>
265<br>
<hr>
<A name=271></a>ACTIVE DETAILED DESCRIPTIONS<br>
Help Guide<br>
ACTIVE ETA LIST FOR PREDPP<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: PK, ERROR, TRANS routines<br>
USAGE:<br>USE PROCM_INT, ONLY: NACTIV,M=&gt;IDXETA<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LVR<br>
INTEGER(KIND=ISIZE) :: NACTIV,IDXETA(LVR)<br>
DISCUSSION:<br>
NACTIV<br>
NACTIV = # of etas in the problem - NRETA.<br>(See <b>Non-Active_ETA_list_for_PRED</b>).<br>
NACTIV tells how many of the etas in the problem have partial derivatives that<br>NONMEM is not currently ignoring.<br>
M<br>
M(k) is the index of the kth 0-valued element of LVOUT (for k=1,...,NACTIV).<br>
Suppose a user-written TRANS routine modiﬁes the kth. element of GG. Here is code<br>that might be used to modify only those of its ﬁrst eta derivatives that are of current inter-<br>est to NONMEM:<br>
DO 100 I=1,NACTIV<br>
100 GG(K,M(I)+1,1)=GG(K,M(I)+1,1)<br>
+ ...<br>
Location prior to NONMEM 7: procm5<br>
REFERENCES: None.<br>
266<br>
<hr>
<A name=272></a>Help Guide<br>
DETAILED DESCRIPTIONS ADDITIONAL OUTPUT FILES<br>
ADDITIONAL OUTPUT FILES<br>
MEANING: NONMEM Additional Output ﬁles<br>CONTEXT: NONMEM Output Files<br>
DISCUSSION:<br>
With NONMEM 7, a NONMEM run produces several additional output ﬁles. These pro-<br>vide a more efﬁcient way of extracting numerical results from the analysis than by obtain-<br>ing them from the NONMEM report ﬁle.<br>(See <b>raw_output_ﬁle</b>).<br>
Names of the ﬁles start with &quot;root&quot;, where root is the root name (not including extension)<br>of the NM-TRAN control stream ﬁle given at the nmfe command line, or<br>root=&quot;nmbayes&quot; if the control stream ﬁle name is not passed as an argument to the NON-<br>MEM executable. In this example the root is myexample, and NONMEM 7.4 is invoked.<br>nmfe74 myexample.ctl myexample.res<br>The ﬁles have names with extensions (sufﬁxes) .ext, .cov, .clt, .coi, .cor, .cpu, .phi, .phm,<br>.grd, .shk, .shm, .cnv, smt, .rmt, .vpd, .ets In this example, they will be myexample.cov,<br>myexample.coi, etc.<br>
Each type of ﬁle accumulates information from each step that generates the type of output<br>in question.<br>
The ﬁrst two lines of each ﬁle is the same. First is a header line that begins with the word<br>TABLE, such as:<br>
TABLE NO.<br>
n:<br>
These tables are not related to the ones produced by the $TABLE record. The value of n<br>is incremented each time the Estimation Step is implemented, i.e., once per $ESTIM<br>record, when MAXEVAL is not 0 and $EST is not omitted. The $EST records may be in<br>the same problem, or in subsequent problems. If $COV is present in a problem without<br>$EST (e.g., when $MSFI is used), then n is also incremented.<br>
Next on the header line is the analysis text (same as given on the #METH: line in the<br>report ﬁle), e.g., &quot;First Order&quot;.<br>
Also on this line are:<br>Problem=1 Subproblem=0 Superproblem1=0 Iteration1=0<br>
Superproblem2=0 Iteration2=0<br>
The values of Problem, Subproblem, Superproblem1, Iteration1, Superproblem2, Itera-<br>tion2 are the same values as would be found in the following variables in modules during<br>the run:<br>IPROB IREP S1NUM S1IT S2NUM S2IT<br>
The second line contains the column headers for the current additional ﬁle, all on one<br>line.<br>
Options NOTITLE and NOLABEL and FORMAT of the $ESTIMATION record can be<br>used to supress the ﬁrst and/or second lines, and to modify the format of the values in the<br>table. They apply to raw and additional output ﬁles, but only for the current Estimation<br>Step. The options must be re-speciﬁed with each $EST record.<br>
The additional output ﬁles are:<br>
267<br>
<hr>
<A name=273></a>ADDITIONAL OUTPUT FILES DETAILED DESCRIPTIONS<br>
Help Guide<br>
root.ext<br>
Always. (See <b>raw_output_ﬁle</b>).<br>
root.phi<br>
Always. Individual phi parameters (phi(i)=mu(i)+eta(i), for ith parameter), and their<br>variances phc(,). For parameters not MU referenced phi(i)=eta(i). When a classical<br>method is performed (FOCE, Laplace), then mode of posterior eta(i) are printed out,<br>along with their Fisher information (ﬁrst order expected value for FOCE, second<br>order for Laplace) assessed variances etc(,). For ITS, these parameters are the<br>modes of the posterior density, with ﬁrst-order approximated expected variances (or<br>second order variances if $EST METHOD=ITS LAPLCE is used). For IMP,<br>IMPMAP, SAEM methods, they are the Monte Carlo evaluated conditional mean<br>parameters and variances of the parameters under the posterior density. For MCMC<br>Bayesian, they are random single samples of phi(), as of the last position. Their vari-<br>ances are zero. Individual objective function values (obji) are also produced. As of<br>NONMEM 7.4, if $EST PHITYPE=1 is speciﬁed, then conditional mean etas are<br>reported in the phi table. regardless of the analysis method.<br>
root.phm (NM72)<br>
Individual phi/eta/obji parameters per sub-population. This ﬁle is only produced in<br>$MIXTURE problems.<br>
root.shk (NM72)<br>
This ﬁle presents composite eta shrinkage and epsilon shrinkage information, the<br>same as given in the NONMEM report ﬁle between the #TERM: and #TERE: tags,<br>but in rows/column format, and with adjustable formatting.<br>(See <b>shrinkage</b>).<br>
root.shm (NM73)<br>
This ﬁle is a shrinkage map describing which etas were included or excluded in the<br>eta shrinkage assessment. (See <b>shrinkage</b>).<br>
root.grd (NM72)<br>
Gradient values for classical NONMEM methods. Always.<br>
root.xml (NM72)<br>
An XML markup version of the contents of the NONMEM report ﬁle. The rules by<br>which it is constructed are given in output.xsd and output.dtd.<br>
root.cov<br>
Full variance-covariance error matrix of thetas, sigmas, and omegas. Same as<br>&quot;COVARIANCE MATRIX OF ESTIMATE&quot; in the NONMEM report except that it<br>is full (NONMEM displays only the lower triangle), elements that are ﬁxed or not<br>estimated are displayed as 0 (NONMEM displays them as .....), and, when the data<br>are individual, sigma is displayed as 0 (NONMEM does not display sigma at all.)<br>Only generated if the $COVARIANCE record is present.<br>(See <b>covariance matrix of estimate</b>).<br>(See <b>Covariance_Output_ﬁles</b>).<br>(See <b>order_option</b>).<br>
root.clt (NM74)<br>
The lower-triangular portion of the variance-covariance of the parameter estimates<br>reported in root.cov. This is provided for easier pasting of the information as theta<br>priors for a subsequent analysis. Only generated if the $COVARIANCE record is<br>present.<br>
268<br>
<hr>
<A name=274></a>Help Guide<br>
DETAILED DESCRIPTIONS ADDITIONAL OUTPUT FILES<br>
root.cor<br>
Full correlation matrix of thetas, sigmas, and omegas. Same as &quot;CORRELATION<br>MATRIX OF ESTIMATE&quot;, except as described for root.cov.<br>(See <b>correlation matrix of estimate</b>).<br>
root.coi<br>
Full inverse covariance matrix (Fischer information matrix) for thetas, sigmas, and<br>omegas. Same as &quot;INVERSE COVARIANCE MATRIX OF ESTIMATE&quot; except as<br>described for root.cov.<br>
root.cnv (NM72)<br>
Convergence information for the Monte Carlo/EM methods, if CTYPE&gt;0.<br>(See <b>raw_output_ﬁle</b>).<br>
root.smt (NM72)<br>
Contains the S matrix, if $COV step failed.<br>
root.rmt (NM72)<br>
Contains the R matrix, if $COV step failed.<br>
root.imp (NM73)<br>
Produced if the user selects importance sampling with option IACCEPT=0.0. Con-<br>tains the ﬁnal IACCEPT and DF values that NONMEM selected for each subject.<br>
root.npd (NM73)<br>
For NONPARAMETRIC method. Each row contains information about a support<br>point.<br>
root.npe (NM73)<br>
For NONPARAMETRIC method. The expected value etas and expected value eta<br>covariances (ETC) are listed for each problem or sub-problem.<br>
root.npi (NM73)<br>
For NONPARAMETRIC method. The individual probabilities are listed. Each row<br>contains information about a support point.<br>
root.npl (NM74)<br>
For NONPARAMETRIC method. The individual data likelihoods (not including the<br>parameter density) are listed in this ﬁle.<br>
root.fgh (NM73)<br>
This ﬁle is produced if the user selects $EST NUMDER=1 or NUMDER=3. The<br>ﬁle lists the numerically evaluated derivatives of Y with respect to eta, where<br>
F=Y (the prediction)<br>G(I,1)=partial Y with respect to eta(i))<br>G(I,J+1)=Second derivatives of Y with respect to eta(i),eta(j)<br>H(I,1)=partial Y with respect to eps(i)<br>H(i,j+1)=partial Y with respect to eps(i),eta(j)<br>
The values are those used in the Estimation Step. Values of F are computed by<br>PRED with eta=0 if METHOD=0 is used; otherwise they are computed with non-<br>zero etas: the Conditional (CPE) etas, empirical bayes estimates (EBE), mode a pos-<br>teriori (MAP) estimates) or conditional mean etas, depending on the Estimation<br>Method. Values of G are computed by NONMEM via ﬁnite differences using these<br>values of F and eta. Values of H are computed by NONMEM with the same values<br>of F and eta if INTERACTION is speciﬁed; otherwise, they are computed with<br>eta=0.<br>
269<br>
<hr>
<A name=275></a>ADDITIONAL OUTPUT FILES DETAILED DESCRIPTIONS<br>
Help Guide<br>
root.agh (NM73)<br>
This ﬁle is produced if the user selects $EST NUMDER=2 or NUMDER=3. The<br>ﬁle lists the analytically evaluated derivatives of Y with respect to eta. The format<br>and order is the same as ﬁle root.fgh. The values are those returned by subroutine<br>PRED in arguments F, G, and H. These are 0 if not computed by PRED. (E.g. sec-<br>ond derivatves are not computed analytically with a method other than LAPLA-<br>CIAN.) Values in root.agh correspond exactly to those in root.fgh. That is, values<br>of F and G are from calls to PRED with eta=0 or with non-zero etas, as described<br>above. Values of H are from calls to PRED with the same values of eta if INTER-<br>ACTION is speciﬁed; otherwise, they are from calls to PRED with eta=0, regardless<br>of the Estimation method.<br>
root.vpd (NM74)<br>
This ﬁle is produced if the $TABLE ﬁle option VARCALC=1 or VARCALC=2 is<br>used. It is the full variances- covariances among all user-deﬁned and PREDPP<br>parameters. The FORMAT used for this ﬁle is that deﬁned in the $EST record.<br>
root.ets (NM74)<br>
As of NM74, one can obtain random samples of individual etas, and uses these for<br>covariate and model diagnostics. $EST option ETASAMPLES=1 causes individual<br>ISAMPLE random eta samples per subject, to be written to root.ets, where root is<br>the root name of the control stream ﬁle.<br>See &quot;Stochastic Approximation Expectation Maximization (SAEM) Method&quot; in<br>Guide Introduction_7.<br>
root.cpu (NM73)<br>
The cpu time in seconds is reported in this ﬁle. It is an accurate representation of the<br>computer usage, whether single or parallel process. The same problem when run<br>singly or in parallel will report a similar cpu time. This is in contrast with elapsed<br>time, which is improved with parallelization.<br>
With NONMEM 7.3 and higher, the $THETAI and $THETAR records may be used to<br>transform initial and ﬁnal estimates of THETA, respectively. This will affect values in<br>the .ext, .cov, etc. ﬁles<br>(See <b>$thetai</b>, <b>$thetar</b>)<br>
REFERENCES: Guide Introduction_7<br>
270<br>
<hr>
<A name=276></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADDITIONAL RECORD COUNTERS<br>
ADDITIONAL RECORD COUNTERS<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>include nonmem_reserved_general<br>
DISCUSSION:<br>
In addition to the record counters NDREC and NIREC, NONMEM 7.4 provides addi-<br>tional record counters. All except IRECIDX refers to a record number within the current<br>individual record.<br>
FIRSTREC<br>
First record of the individual.<br>
LASTREC<br>
Last record of the individual.<br>
FIRSTOBS<br>
First observation record of the individual (for which MDV=0 or 100)<br>
LASTOBS<br>
Last observation record of the individual (for which MDV=0 or 100)<br>
FIRSTDOS<br>
With PREDPP, ﬁrst dose record of the individual (for which EVID=1 or 4, and<br>MDV=1 or MDV=101).<br>Without PREDPP, -1.<br>
LASTDOS<br>
With PREDPP, last dose record of the individual (for which EVID-1 or 4, and<br>MDV=1 or MDV=101).<br>Without PREDPP, -1.<br>
EFIRSTREC<br>
First record of the individual during Estimation or Covariance Steps (for which<br>MDV=0 or MDV=1)<br>
ELASTREC<br>
Last record of the individual during Estimation or Covariance Steps (for which<br>MDV=0 or MDV=1)<br>
EFIRSTOBS<br>
First observation record of the individual during Estimation or Covariance Steps (for<br>which MDV=0)<br>
ELASTOBS<br>
Last observation record of the individual during Estimation or Covariance Steps (for<br>which MDV=0)<br>
EFIRSTDOS<br>
With PREDPP, ﬁrst dose record of the individual during Estimation or Covariance<br>Steps (for which EVID=1 or 4, and MDV=1).<br>Without PREDPP, -1.<br>
ELASTDOS<br>
With PREDPP, last dose record of the individual during Estimation or Covariance<br>Steps (for which EVID=1 or 4, and MDV=1).<br>
271<br>
<hr>
<A name=277></a>ADDITIONAL RECORD COUNTERS<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
Without PREDPP, -1.<br>
IRECIDX<br>
IRECIDX+1 is the starting record number in the NONMEM data set for the current<br>individual record. NDREC starts at 1 for the ﬁrst record of each individual record,<br>so that NDREC+IRECIDX is the number of the current data record within the NON-<br>MEM data set.<br>
Like NIREC and NDREC, the additional record counters also change value in conjunc-<br>tion with calls to PASS, a NONMEM utility routine. They may all be used as right-hand<br>quantities in $PRED, $PK, and $ERROR blocks, and in a $INFN block in conjunction<br>with PASS.<br>
REFERENCES: Guide Introduction_7<br>
272<br>
<hr>
<A name=278></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADDL<br>
ADDL DAT A ITEM<br>
MEANING: Additional Dose (ADDL) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... ADDL ...<br>
DISCUSSION:<br>ADDL labels PREDPP’s additional dose (ADDL) data item. The additional dose data<br>item is optional. In a dose or reset-dose event record it describes how many additional<br>doses, exactly like the present (&quot;initiating&quot;) dose, should be given. The interdose interval<br>(II) data item gives the time between the additional doses (See <b>ii</b>).<br>
When ADDL is 0, no additional doses are given.<br>
For non-steady-state doses, ADDL should be a positive number if and only if the II data<br>item is a positive number. II giv es the time between additional doses.<br>
For steady-state infusions, ADDL must be 0.<br>
For other steady-state doses, ADDL is optional. If it is a positive number, it continues the<br>pattern of implied doses beyond the steady-state dose. The additional doses of the pattern<br>are non-steady state doses.<br>
For observation, other-type and reset event records, ADDL should be zero.<br>
The following two data record fragments specify the same set of doses:<br>
TIME AMT ADDL II<br>
DV<br>
10. 15.<br>
0<br>
0<br>
.<br>
15. .<br>
.<br>
.<br>
25.7<br>
20. 10.<br>
0<br>
0<br>
.<br>
22. 15.<br>
0<br>
0<br>
.<br>
34. 15.<br>
0<br>
0<br>
.<br>
36. .<br>
.<br>
.<br>
30.2<br>
TIME AMT ADDL II<br>
DV<br>
10. 15.<br>
2<br>
12. .<br>
15. .<br>
.<br>
.<br>
25.7<br>
20. 10.<br>
0<br>
0<br>
.<br>
36. .<br>
.<br>
.<br>
30.2<br>
The observation at time 15 and the extra dose at time 20 do not affect the regular dosing<br>regimen (doses at times 10, 22, and 34).<br>
There is a discussion of user (concomitant) data items used to compute PK parameters<br>that are relevant to ADDL doses; (See <b>$BIND</b>).<br>
REFERENCES: Guide VI, section V.K<br>
273<br>
<hr>
<A name=279></a>ADVAN<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
ADVAN (GENERAL)<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVANn<br>
SAMPLE:<br>$SUBROUTINE ADVAN1<br>
DISCUSSION:<br>PREDPP contains a library of routines, called ADVAN routines, which implement spe-<br>ciﬁc kinetic models. Exactly one ADVAN routine must be selected for each NON-<br>MEM/PREDPP run. Its function is to &quot;advance&quot; the kinetic system from one state time<br>point to the next. The ADVAN routines are:<br>
ADVAN1 One Compartment Linear Model<br>ADVAN2 One Compartment Linear Model with First Order Absorption<br>ADVAN3 Two Compartment Linear Model<br>ADVAN4 Two Compartment Linear Model with First Order Absorption<br>ADVAN5 General Linear Model<br>ADVAN6 General Nonlinear Model<br>ADVAN7 General Linear Model with Real Eigenvalues<br>ADVAN8 General Nonlinear Model with Stiff Differential Equations<br>ADVAN9 General Nonlinear Model with Equilibrium Compartments<br>ADVAN10 One Compartment Model with Michaelis-Menten Elimination<br>ADVAN11 Three Compartment Linear Model<br>ADVAN12 Three Compartment Linear Model with First Order Absorption<br>ADVAN13 General Nonlinear Model using LSODA<br>ADVAN14 General Nonlinear Model using CVODA<br>ADVAN15 General Nonlinear Model with Eqilibrium Compartments using IDA<br>
With a general ADVAN (numbered 5 and above, except for 10, 11, 12), a $MODEL<br>record (or user-supplied MODEL subroutine) must be provided to specify certain details<br>of the model. With ADVAN 6, 8, 9, 13, 14 and 15, a $DES block (or DES subroutine)<br>must be provided to evaluate the differential equations. With ADVAN9 and ADVAN15,<br>$AES and $AESINITIAL blocks (or AES subroutine) may also be provided to evaluate<br>the algebraic expressions. With any ADVAN for which $DES is required, and with<br>ADVAN10 or SS6, TOL must be speciﬁed by means of the TOL option of the $SUB-<br>ROUTINES record (or a $TOL block or TOL subroutine).<br>
To use a given ADVAN routine, follow two steps:<br>
1. Specify this ADVAN to NM-TRAN on the $SUBROUTINES record. This enables<br>
NM-TRAN to interpret other records such as $PK.<br>
2. Include the speciﬁed ADVAN routine when building the NONMEM executable.<br>
NM-TRAN itself places the name of the speciﬁed ADVAN routine (and any other<br>routines from the PREDPP library required by that ADVAN) in its output ﬁle FRE-<br>PORT.<br>
The nmfe and nmfe.bat commands automatically include the correct ADVAN routine in<br>the NONMEM executable.<br>
274<br>
<hr>
<A name=280></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN<br>
REFERENCES: Guide VI, section I , III.A , VII.C<br>REFERENCES: Guide IV, section V.C.3 , V.C.5<br>
275<br>
<hr>
<A name=281></a>ADVAN1 DETAILED DESCRIPTIONS<br>
Help Guide<br>
ADVAN1<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN1<br>
SAMPLE:<br>$SUBROUTINE ADVAN1<br>
DISCUSSION:<br>ADVAN1 is a routine in PREDPP’s library which implements the kinetic equations for<br>the One Compartment Linear Model.<br>
Compt. Function Initial<br>
On/Off<br>
Dose Default Default<br>
No. Status<br>
Allowed Allowed for Dose for Obs.<br>
1<br>
Central On<br>
No Yes Yes Yes<br>
2<br>
Output Off<br>
Yes No<br>
No No<br>
TRANS routines that may be used: TRANS1, TRANS2<br>
Basic PK parameter with TRANS1:<br>
K (rate constant of elimination)<br>
Basic PK parameters with TRANS2: (See <b>TRANS2</b>).<br>
Additional PK parameters:<br>
S1 - Scale for central compartment (also called SC)<br>S2 - Scale for output compartment (also called S0)<br>F1 - Bioavailability for central compartment<br>R1 - Rate for central compartment<br>D1 - Duration for central compartment<br>ALAG1 - Absorption lag for central compartment<br>F0 - Output fraction (also called F2, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
REFERENCES: Guide VI, section VII.C.1<br>
276<br>
<hr>
<A name=282></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN2<br>
ADVAN2<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN2<br>
SAMPLE:<br>$SUBROUTINE ADVAN2<br>
DISCUSSION:<br>ADVAN2 is a routine in PREDPP’s library which implements the kinetic equations for<br>the One Compartment Linear Model with First Order Absorption.<br>
Compt. Function Initial<br>
On/Off<br>
Dose Default Default<br>
No. Status<br>
Allowed Allowed for Dose for Obs.<br>
1<br>
Depot Off<br>
Yes Yes Yes No<br>
2<br>
Central On<br>
No Yes No<br>
Yes<br>
3<br>
Output Off<br>
Yes No<br>
No No<br>
TRANS routines that may be used: TRANS1, TRANS2<br>
Basic PK parameters with TRANS1:<br>
K (rate constant of elimination)<br>KA (rate constant of absorption)<br>
Basic PK parameters with TRANS2: (See <b>TRANS2</b>).<br>
Additional PK parameters:<br>
S1 - Scale for depot compartment<br>S2 - Scale for central compartment (also called SC)<br>S3 - Scale for output compartment (also called S0)<br>F1 - Bioavailability for depot compartment<br>F2 - Bioavailability for central compartment<br>R1 - Rate for depot compartment<br>R2 - Rate for central compartment<br>D1 - Duration for depot compartment<br>D2 - Duration for central compartment<br>ALAG1 - Absorption lag for depot compartment<br>ALAG2 - Absorption lag for central compartment<br>F0 - Output fraction (also called F3, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
REFERENCES: Guide VI, section VII.C.2<br>
277<br>
<hr>
<A name=283></a>ADVAN3 DETAILED DESCRIPTIONS<br>
Help Guide<br>
ADVAN3<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN3<br>
SAMPLE:<br>$SUBROUTINE ADVAN3<br>
DISCUSSION:<br>ADVAN3 is a routine in PREDPP’s library which implements the kinetic equations for<br>the Two Compartment Linear Model.<br>
Compt. Function<br>
Initial On/Off<br>
Dose Default Default<br>
No. Status<br>
Allowed Allowed for Dose for Obs.<br>
1<br>
Central On<br>
No Yes Yes Yes<br>
2<br>
Peripheral On<br>
No Yes No<br>
No<br>
3<br>
Output Off<br>
Yes No<br>
No No<br>
TRANS routines that may be used: TRANS1, TRANS3, TRANS4, TRANS5, TRANS6<br>Basic PK parameters with TRANS1:<br>
K (rate constant of elimination)<br>K12 (rate constant from central to peripheral)<br>K21 (rate constant from peripheral to central)<br>
Basic PK parameters with TRANS3: (See <b>TRANS3</b>).<br>
Basic PK parameters with TRANS4: (See <b>TRANS4</b>).<br>
Basic PK parameters with TRANS5: (See <b>TRANS5</b>).<br>
Basic PK parameters with TRANS6: (See <b>TRANS6</b>).<br>
Additional PK parameters:<br>
S1 - Scale for central compartment (also called SC)<br>S2 - Scale for peripheral compartment<br>S3 - Scale for output compartment (also called S0)<br>F1 - Bioavailability for central compartment<br>F2 - Bioavailability for peripheral compartment<br>R1 - Rate for central compartment<br>R2 - Rate for peripheral compartment<br>D1 - Duration for central compartment<br>D2 - Duration for peripheral compartment<br>ALAG1 - Absorption lag for central compartment<br>ALAG2 - Absorption lag for peripheral compartment<br>F0 - Output fraction (also called F3, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
REFERENCES: Guide VI, section VII.C.3<br>
278<br>
<hr>
<A name=284></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN4<br>
ADVAN4<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN4<br>
SAMPLE:<br>$SUBROUTINE ADVAN4<br>
DISCUSSION:<br>ADVAN4 is a routine in PREDPP’s library which implements the kinetic equations for<br>the Two Compartment Linear Model with First Order Absorption.<br>
Compt. Function<br>
Initial On/Off<br>
Dose Default Default<br>
No. Status<br>
Allowed Allowed for Dose for Obs.<br>
1<br>
Depot Off<br>
Yes Yes Yes No<br>
2<br>
Central On<br>
No Yes No<br>
Yes<br>
3<br>
Peripheral On<br>
No Yes No<br>
No<br>
4<br>
Output Off<br>
Yes No<br>
No No<br>
TRANS routines that may be used: TRANS1, TRANS3, TRANS4, TRANS5, TRANS6<br>
Basic PK parameters with TRANS1:<br>
K (rate constant of elimination)<br>K23 (rate constant from central to peripheral)<br>K32 (rate constant from peripheral to central)<br>KA (rate constant of absorption)<br>
Basic PK parameters with TRANS3: (See <b>TRANS3</b>).<br>
Basic PK parameters with TRANS4: (See <b>TRANS4</b>).<br>
Basic PK parameters with TRANS5: (See <b>TRANS5</b>).<br>
Basic PK parameters with TRANS6: (See <b>TRANS6</b>).<br>
Additional PK parameters:<br>
S1 - Scale for depot compartment<br>S2 - Scale for central compartment (also called SC)<br>S3 - Scale for peripheral compartment<br>S4 - Scale for output compartment (also called S0)<br>F1 - Bioavailability for depot compartment<br>F2 - Bioavailability for central compartment<br>F3 - Bioavailability for peripheral compartment<br>R1 - Rate for depot compartment<br>R2 - Rate for central compartment<br>R3 - Rate for peripheral compartment<br>D1 - Duration for depot compartment<br>D2 - Duration for central compartment<br>D3 - Duration for peripheral compartment<br>ALAG1 - Absorption lag for depot compartment<br>ALAG2 - Absorption lag for central compartment<br>ALAG3 - Absorption lag for peripheral compartment<br>F0 - Output fraction (also called F4, FO)<br>
279<br>
<hr>
<A name=285></a>ADVAN4 DETAILED DESCRIPTIONS<br>
Help Guide<br>
XSCALE - Time scale<br>MTIME(i) - Model event times<br>
REFERENCES: Guide VI, section VII.C.4<br>
280<br>
<hr>
<A name=286></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN5<br>
ADVAN5 ADVAN7<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN5<br>
SAMPLE:<br>$SUBROUTINE ADVAN5<br>
DISCUSSION:<br>ADVAN5 and ADVAN7 are routines in PREDPP’s library which implement the general<br>linear model. The general linear model is used for systems in which a drug is distributed<br>between compartments according to linear processes. ADVAN7 may be used when the<br>eigenvalues of the rate constant matrix are known to be real (which is true for many phar-<br>macokinetic systems such as mammillary models). It is generally faster than ADVAN5.<br>
A $MODEL record is required to describe the compartments and their attributes. The<br>$PK record (or, if a user-supplied PK routine is used, the $MODEL record) describes<br>how the compartments are linked.<br>
TRANS routines that may be used: TRANS1<br>
Suppose there are m compartments in the system, including the output compartment.<br>
Basic PK parameters with TRANS1:<br>
Kij (rate constant from compartment i to compartment j)<br>Ki0 (alternate name for Kim)<br>
The letter T may be used as a separator between the two compartment numbers, e.g.,<br>KiTj. The letter T is optional when there is no ambiguity, but required when there<br>are two possible interpretations of the numbers that follow K. E.g., with 12 com-<br>partments, K111 is ambiguous. It should be coded K1T11 or K11T1, depending if<br>it symbolizes the rate constant from compartment 1 to compartment 11 or from com-<br>partment 11 to compartment 1.<br>
Additional PK parameters:<br>
For each compartment n in the system (n=1, ..., m):<br>
Sn - Scale for nth compartment<br>S0 - Alternate name for scale for output compartment<br>
For each dosable compartment n in the system:<br>
Fn - Bioavailability for nth compartment<br>Rn - Rate for nth compartment<br>Dn - Duration for nth compartment<br>ALAGn - Absorption lag for nth compartment<br>
Other additional PK parameters:<br>
F0 - Output fraction (also called Fm, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
Required PREDPP Library subroutines:<br>ADVAN5 - REXPON, RXSUBS<br>ADVAN7 - RRXPON, RXSUBS<br>
281<br>
<hr>
<A name=287></a>ADVAN5 DETAILED DESCRIPTIONS<br>
Help Guide<br>
Notes:<br>
1<br>
Analytical second derivatives used with the Laplacian method are not obtained with<br>ADVAN5 and ADVAN7. Numerical second derivatives must be used.<br>
REFERENCES: Guide VI, section VII.C.5 , VII.C.7<br>REFERENCES: Guide IV, section V.C.4<br>
282<br>
<hr>
<A name=288></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN6<br>
ADVAN6 ADVAN8 ADVAN13 ADVAN14<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN6<br>
SAMPLE:<br>$SUBROUTINE ADVAN6<br>
DISCUSSION:<br>ADVAN6, ADVAN8 ADVAN13, ADVAN14 are routines in PREDPP’s library which<br>implement the general non-linear model. The general non-linear model is used for sys-<br>tems in which a drug is distributed between compartments according to ﬁrst-order pro-<br>cesses. The differences are in the package of code that performs the integration of the<br>differential equations.<br>
ADVAN6 uses IMSL’s DVERK, a Runge-Kutta-Verner ﬁfth and sixth order method<br>of integration, for nonstiff problems.<br>
ADVAN8 uses IMSL’s DGEAR, the Gear method of numerical integration, for stiff<br>problems.<br>
ADVAN13 uses the LLNL solver for ordinary differential equations (LSODA), with<br>automatic method switching for stiff (BDF) and non-stiff (Adams method) prob-<br>lems. It is a decendent of ADVAN8.<br>
ADVAN14 uses CVODES from the LLNL SUNDIALS system for ordinary differ-<br>ential equations and is a descendent of LSODA (ADVAN13). ADVAN14 also has a<br>root-ﬁnding algorithm.<br>The user may choose to make modiﬁcations to ..\pr\CVODEU.f90. See<br>..\guides\cvs_guide.pdf and ..\guides\cv_guide.pdf.<br>
ADVAN8 may be used in preference to ADVAN6 when the differential equations<br>describing the processes are stiff. ADVAN13 may be preferable with a mixed system<br>(both stiff and non-stiff). For discussion of ADVAN14 as well as changes to ADVAN13,<br>see Guide INTRODUCTION TO NONMEM 7.<br>
A $MODEL record is required to describe the compartments and their attributes. The<br>$DES record is required to describe the differential equations.<br>
TRANS routines that may be used: TRANS1<br>
Explicit Basic PK parameters:<br>
P(n) (nth basic PK parameter)<br>
Implicit basic PK parameters:<br>
PK-deﬁned variables used also in $DES block<br>
Additional PK parameters:<br>
Suppose there are m compartments in the system, including the output compartment. For<br>each compartment n in the system (n=1, ..., m):<br>
Sn - Scale for nth compartment<br>S0 - Alternate name for scale for output compartment<br>
For each dosable compartment n in the system:<br>
283<br>
<hr>
<A name=289></a>ADVAN6 DETAILED DESCRIPTIONS<br>
Help Guide<br>
Fn - Bioavailability for nth compartment<br>Rn - Rate for nth compartment<br>Dn - Duration for nth compartment<br>ALAGn - Absorption lag for nth compartment<br>
Other additional PK parameters:<br>
F0 - Output fraction (also called Fm, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
TOLERANCE values<br>
TOL (Relative Tolerance) is required; this can be supplied with the $SUBROUTINE<br>or $TOL record, or a user-supplied TOL routine, which sets NRD=TOL.<br>(See <b>$SUBROUTINES</b>).<br>(See <b>$TOL</b>).<br>
With NONMEM 7.4, ATOL (Absolute tolerance) may be speciﬁed for ADVAN9,<br>ADVAN13, ADVAN14.<br>For example, $SUBROUTINE ... ATOL=n.<br>The default is 12 (that is, accuracy is 10**(-12)). Usually the problem runs quickly<br>when using this setting. On occasion, however, you may want to reduce ATOL (usu-<br>ally set it equal to that of TOL), and improve speeds of up to 3 to 4 fold. Values of<br>TOL and ATOL may also be speciﬁed for evaluations of Steady State amounts, and<br>also for the Covariance Step.<br>
See options ATOL, TOLC, ATOLC, SSATOL, SSATOLC of the $SUBROUTINE<br>and $TOL records.<br>
A user-supplied TOL routine may assign values of NRD and ANRD speciﬁcally for<br>the initial (base) setting and each NONMEM step (estimation, covariance, simula-<br>tion, table/scatter step, simulation, initial parameters estimate, nonparametric). It<br>may also supply speciﬁc values for each compartment, and for Steady State<br>amounts.<br>(See <b>TOL</b>).<br>
With ADVAN13, the user may ﬁnd that the TOL option should specify larger NRD<br>values than for other ADVANs (e.g., ADVAN6). Values of 7 or 8 may not be unrea-<br>sonable with double precision.<br>
See <b>INTRODUCTION TO NONMEM 7, Controlling the Accuracy of the Gra-<br>dient Evaluation and Individual Objective Function Evaluation</b><br>
Reserved variable MXSTEP (the maximum number of integration steps) can be speci-<br>ﬁed for ADVAN13 and ADVAN14.<br>(See <b>mxstep</b>).<br>
With ADVAN13, if there is a period of time during which some compartment’s amount<br>should be zero, that compartment should be turned off. Otherwise, very small amounts<br>can appear in the compartment, which can cause difﬁculties during subsequent time peri-<br>ods.<br>
By default, the initial conditions (i.e., compartment amounts) are zero at the start of each<br>individual record. Different initial conditions may be speciﬁed using a compartment ini-<br>tialization block in PK. When endogenous drug is speciﬁed in the differential equations,<br>non-zero initial conditions may also be computed using a steady-state dose event record<br>with SS&gt;0 and AMT=0 and RATE=0, or using the I_SS (Initial Steady State) feature of<br>
284<br>
<hr>
<A name=290></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN6<br>
MODEL and/or PK.<br>(See <b>Compartment_Initialization_Block</b>, <b>SS_dose</b>).<br>(See <b>$model</b>, <b>$pk</b>).<br>(See <b>model</b>, <b>pk</b>).<br>(See <b>Initial_Steady_State:_I_SS,ISSMOD</b>).<br>
Required PREDPP Library subroutines:<br>ADVAN6 - DVERK1, FCN1<br>ADVAN8 - DGEAR1, FCN1, FCN3<br>ADVAN13 - LSODA, FCN1, JAC2<br>ADVAN14 - CVODE, FCN1, JAC2<br>
REFERENCES: Guide VI, section VII.C.6 , VII.C.8<br>REFERENCES: Guide IV, section V.C.4 , V.C.5<br>
285<br>
<hr>
<A name=291></a>ADVAN9 15<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
ADVAN9 15<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN9<br>
$SUBROUTINES [ADVAN=]ADVAN15<br>
SAMPLE:<br>$SUBROUTINE ADVAN9<br>
$SUBROUTINE ADVAN15<br>
DISCUSSION:<br>ADVAN9 and ADVAN15 are routines in PREDPP’s library which implement the general<br>non-linear model with equilibrium compartments. This general non-linear model is used<br>for systems in which a drug is distributed between compartments according to a system<br>of ﬁrst-order differential-algebraic processes. It may be useful when the system consists<br>of only stiff differential equations, and there are no equilibrium compartments (i.e., no<br>algebraic equations). It may also be used when the system consists of only algebraic<br>equations (i.e., no differential equations).<br>
A $MODEL record is required to describe the compartments and their attributes. The<br>$DES record describes the differential equations, if any. The $AES and $AESINITIAL<br>records describe the algebraic expressions, if any.<br>
TOL is required; (See <b>$SUBROUTINES</b>).<br>
TRANS routines that may be used: TRANS1<br>
Explicit Basic PK parameters:<br>
P(n) (nth basic PK parameter)<br>
Implicit basic PK parameters:<br>
PK-deﬁned variables used also in $AES or $DES blocks<br>
Additional PK parameters:<br>
Suppose there are m compartments in the system, including the output compartment. For<br>each compartment n in the system (n=1, ..., m):<br>
Sn - Scale for nth compartment<br>S0 - Alternate name for scale for output compartment<br>
For each dosable compartment n in the system:<br>
Fn - Bioavailability for nth compartment<br>Rn - Rate for nth compartment<br>Dn - Duration for nth compartment<br>ALAGn - Absorption lag for nth compartment<br>
Other additional PK parameters:<br>
F0 - Output fraction (also called Fm, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
With NONMEM 7.4, ATOL may be speciﬁed for ADVAN9 and ADVAN15. TOL (rela-<br>tive tolerance) and ATOL (Absolute tolerance) may be speciﬁed on the $SUBROUTINE<br>record, the $TOL record, or by a user-supplied TOL subroutine. See also the ATOL<br>
286<br>
<hr>
<A name=292></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN9 15<br>
option of the $ESTIMATION and $COVARIANCE records.<br>
AT OL is not required. The default is 12 (that is, accuracy is 10**(-12)). Usually the<br>problem runs quickly when using this setting. On occasion, however, you may want to<br>reduce ATOL (usually set it equal to that of TOL), and improve speeds of up to 3 to 4<br>fold.<br>
With ADVAN9, the user may ﬁnd that the TOL option should specify larger NRD values<br>than for other ADVANs (e.g., ADVAN6). Values of 7 or 8 may not be unreasonable.<br>
Reserved variable MXSTEP (the maximum number of integration steps) can be speci-<br>ﬁed for ADVAN9 and ADVAN15, as well as for ADVAN13 and ADVAN14.<br>(See <b>mxstep</b>).<br>
With ADVAN9, if there is a period of time during which some compartment’s amount<br>should be zero, that compartment should be turned off. Otherwise, very small amounts<br>can appear in the compartment, which can cause difﬁculties during subsequent time peri-<br>ods.<br>
By default, the initial conditions (i.e., compartment amounts) are zero at the start of each<br>individual record. Different initial conditions may be speciﬁed using a compartment ini-<br>tialization block in PK. When endogenous drug is provided in the differential equations,<br>non-zero initial conditions can be computed using a steady-state dose event record with<br>SS&gt;0 and AMT=0 and RATE=0, or using the I_SS (Initial Steady State) feature of<br>MODEL and/or PK. Note that with either method, steady-state is computed only for<br>compartments speciﬁed by differential equations. The equilibrium compartments are not<br>computed (i.e., the algebraic equations are not evaluated) until the system is advanced<br>beyond the initial value of TIME.<br>(See <b>Compartment_Initialization_Block</b>, <b>SS_dose</b>).<br>(See <b>$model</b>, <b>$pk</b>, <b>model</b>, <b>pk</b>).<br>(See <b>Initial_Steady_State:_I_SS,ISSMOD</b>).<br>
ADVAN9 uses the Lawrence Livermore National Laboratory (LLNL) solver for differen-<br>tial-algebraic equations, implicit form (LSODI), using the backward differentiation for-<br>mulas (BDF) for stiff problems.<br>
ADVAN15 uses IDA from the LLNL SUNDIALS system for differential-algebraic equa-<br>tions and is a descendent of the LSODI1 (ADVAN9) system. ADVAN15 also has a root-<br>ﬁnding algorithm. The user may choose to make modiﬁcations to parameters in<br>..\pr\IDAU.f90.<br>See ..\guides\idas_guide.pdf and ..\guides\ida_guide.pdf.<br>See <b>INTRODUCTION TO NONMEM 7</b>, section &quot;$SUBROUTINES: Yet Another New<br>Differential Equation Solving Method: IDAS (ADVAN15)&quot;<br>
Required PREDPP Library subroutines:<br>ADVAN9 - ADDA, FCN5, JAC, LEQT22, LSODI1, RES, ZSPOW2<br>ADVAN15 - ADDA, FCN5, JAC, LEQT22, IDA, RES, ZSPOW2<br>
1<br>
Analytical second derivatives used with the Laplacian method are not obtained with<br>ADVAN9 and ADVAN15. Numerical second derivatives must be used.<br>
REFERENCES: Guide VI, section VI.B , VII.C.9<br>REFERENCES: Guide IV, section V.C.8<br>
287<br>
<hr>
<A name=293></a>ADVAN10 DETAILED DESCRIPTIONS<br>
Help Guide<br>
ADVAN10<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN10<br>
SAMPLE:<br>$SUBROUTINE ADVAN10<br>
DISCUSSION:<br>ADVAN10 is a routine in PREDPP’s library which implements the kinetic equations for<br>the One Compartment Model with Michaelis-Menten Elimination.<br>
Compt. Function Initial<br>
On/Off<br>
Dose Default Default<br>
No. Status<br>
Allowed Allowed for Dose for Obs.<br>
1<br>
Central On<br>
No Yes Yes Yes<br>
2<br>
Output Off<br>
Yes No<br>
No No<br>
TOL is required; (See <b>$SUBROUTINES</b>).<br>
If steady-state doses are present, steady-state routine SS6 is used, and consequently a<br>$DES block (or user-supplied DES routine) is required. Unless there are steady-state<br>infusions, it may be a &quot;dummy routine&quot;.<br>(See <b>Guide VI, section VII.C.6</b>)<br>
TRANS routines that may be used: TRANS1<br>
Basic PK parameter with TRANS1:<br>
VM (maximum rate)<br>KM (Michaelis constant)<br>
Additional PK parameters:<br>
S1 - Scale for central compartment (also called SC)<br>S2 - Scale for output compartment (also called S0)<br>F1 - Bioavailability for central compartment<br>R1 - Rate for central compartment<br>D1 - Duration for central compartment<br>ALAG1 - Absorption lag for central compartment<br>F0 - Output fraction (also called F2, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
Required PREDPP Library subroutines:<br>ADVAN10 - MMPHI<br>
REFERENCES: Guide VI, section VII.C.6 , VII.C.10<br>
288<br>
<hr>
<A name=294></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN11<br>
ADVAN11<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN11<br>
SAMPLE:<br>$SUBROUTINE ADVAN11<br>
DISCUSSION:<br>ADVAN11 is a routine in PREDPP’s library which implements the kinetic equations for<br>the Three Compartment Linear Model.<br>
Compt. Function<br>
Initial On/Off<br>
Dose Default Default<br>
No. Status<br>
Allowed Allowed for Dose for Obs.<br>
1<br>
Central On<br>
No Yes Yes Yes<br>
2<br>
Peripheral 1<br>
On No<br>
Yes<br>
No<br>
No<br>
3<br>
Peripheral 2<br>
On No<br>
Yes<br>
No<br>
No<br>
4<br>
Output Off<br>
Yes No<br>
No No<br>
TRANS routines that may be used: TRANS1, TRANS4, TRANS6<br>
Basic PK parameters with TRANS1:<br>
K (rate constant of elimination)<br>K12 (rate constant from central to peripheral 1)<br>K21 (rate constant from peripheral 1 to central)<br>K13 (rate constant from central to peripheral 2)<br>K31 (rate constant from peripheral 2 to central)<br>
Basic PK parameters with TRANS4: (See <b>TRANS4</b>).<br>
Basic PK parameters with TRANS6: (See <b>TRANS6</b>).<br>
Additional PK parameters:<br>
S1 - Scale for central compartment (also called SC)<br>S2 - Scale for peripheral compartment 1<br>S3 - Scale for peripheral compartment 2<br>S4 - Scale for output compartment (also called S0)<br>F1 - Bioavailability for central compartment<br>F2 - Bioavailability for peripheral compartment 1<br>F3 - Bioavailability for peripheral compartment 2<br>R1 - Rate for central compartment<br>R2 - Rate for peripheral compartment 1<br>R3 - Rate for peripheral compartment 2<br>D1 - Duration for central compartment<br>D2 - Duration for peripheral compartment 1<br>D3 - Duration for peripheral compartment 2<br>ALAG1 - Absorption lag for central compartment<br>ALAG2 - Absorption lag for peripheral compartment 1<br>ALAG3 - Absorption lag for peripheral compartment 2<br>F0 - Output fraction (also called F4, FO)<br>XSCALE - Time scale<br>
289<br>
<hr>
<A name=295></a>ADVAN11 DETAILED DESCRIPTIONS<br>
Help Guide<br>
MTIME(i) - Model event times<br>
Steady-state subroutines: SS11, SS6<br>
Other required user or library routines:<br>
Library: EXP3<br>
Notes:<br>
1<br>
Analytical second derivatives used with the Laplacian method are not obtained with<br>ADVAN11. Numerical second derivatives must be used.<br>
2<br>
Can be greatly speeded up if calls to PK can be limited. (Use CALLFL=1 in $PK to<br>call once per IR, and use the CALL data item to force additional calls if and when<br>necessary; e.g., when covariates used in the PK model change.)<br>
REFERENCES: None.<br>
290<br>
<hr>
<A name=296></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN12<br>
ADVAN12<br>
MEANING: Choice of Pharmacokinetic Model for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [ADVAN=]ADVAN12<br>
SAMPLE:<br>$SUBROUTINE ADVAN12<br>
DISCUSSION:<br>ADVAN12 is a routine in PREDPP’s library which implements the kinetic equations for<br>the Three Compartment Linear Model with First Order Absorption.<br>
Compt. Function<br>
Initial On/Off<br>
Dose Default Default<br>
No. Status<br>
Allowed Allowed for Dose for Obs.<br>
1<br>
Depot Off<br>
Yes Yes Yes No<br>
2<br>
Central On<br>
No Yes No<br>
Yes<br>
3<br>
Peripheral 1<br>
On No<br>
Yes<br>
No<br>
No<br>
4<br>
Peripheral 2<br>
On No<br>
Yes<br>
No<br>
No<br>
5<br>
Output Off<br>
Yes No<br>
No No<br>
TRANS routines that may be used: TRANS1, TRANS4, TRANS6<br>
Basic PK parameters with TRANS1:<br>
K (rate constant of elimination)<br>K23 (rate constant from central to peripheral 1)<br>K32 (rate constant from peripheral 1 to central)<br>K24 (rate constant from central to peripheral 2)<br>K42 (rate constant from peripheral 2 to central)<br>KA (rate constant of absorption)<br>
Basic PK parameters with TRANS4: (See <b>TRANS4</b>).<br>
Basic PK parameters with TRANS6: (See <b>TRANS6</b>).<br>
Additional PK parameters:<br>
S1 - Scale for depot compartment<br>S2 - Scale for central compartment (also called SC)<br>S3 - Scale for peripheral compartment 1<br>S4 - Scale for peripheral compartment 2<br>S5 - Scale for output compartment (also called S0)<br>F1 - Bioavailability for depot compartment<br>F2 - Bioavailability for central compartment<br>F3 - Bioavailability for peripheral compartment 1<br>F4 - Bioavailability for peripheral compartment 2<br>R1 - Rate for depot compartment<br>R2 - Rate for central compartment<br>R3 - Rate for peripheral compartment 1<br>R4 - Rate for peripheral compartment 2<br>D1 - Duration for depot compartment<br>D2 - Duration for central compartment<br>D3 - Duration for peripheral compartment 1<br>
291<br>
<hr>
<A name=297></a>ADVAN12 DETAILED DESCRIPTIONS<br>
Help Guide<br>
D4 - Duration for peripheral compartment 2<br>ALAG1 - Absorption lag for depot compartment<br>ALAG2 - Absorption lag for central compartment<br>ALAG3 - Absorption lag for peripheral compartment 1<br>ALAG4 - Absorption lag for peripheral compartment 2<br>F0 - Output fraction (also called F5, FO)<br>XSCALE - Time scale<br>MTIME(i) - Model event times<br>
Steady-state subroutines: SS12, SS6<br>
Other required user or library routines:<br>
Library: EXP3 EXP4<br>
Notes:<br>
1<br>
Analytical second derivatives used with the Laplacian method are not obtained with<br>ADVAN12. Numerical second derivatives must be used.<br>
2<br>
Can be greatly speeded up if calls to PK can be limited. (Use CALLFL=1 in $PK to<br>call once per IR, and use the CALL data item to force additional calls if and when<br>necessary; e.g., when covariates used in the PK model change.)<br>
REFERENCES: None.<br>
292<br>
<hr>
<A name=298></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ADVAN7:<br>
ADVAN7: FACTOR<br>
MEANING: PREDPP global variables<br>CONTEXT: For use with PREDPP<br>
USAGE:<br>$PK<br>
&quot;FIRST<br>
&quot; USE PRCOM_REAL, ONLY: FACTOR=&gt;FAC<br>
&quot;MAIN<br>
&quot; FACTOR=10.<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: FAC<br>
DISCUSSION:<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of PREDPP code.<br>
USAGE:<br>
A message similar to the following is sometimes produced by ADVAN7:<br>
NUMERICAL DIFFICULTIES OBTAINING THE SOLUTION.<br>
NON-REAL<br>
EIGENVALUES. PERHAPS ADVAN5 SHOULD BE USED FOR THIS PROBLEM.<br>
&quot;LARGEST&quot; VALUE ALONG SUBDIAGONAL OF SCHUR MATRIX:<br>
0.423E-01<br>
(DIAG: 0.84E+00 0.84E+00)<br>
FA CTOR is a &quot;fudge factor&quot; that affects ADVAN7’s determination of how large the sub-<br>diagonal element is relative to the two diagonal elements. The default value of FACTOR<br>is 1.<br>
These error messages arise when the computations of the eigenvalues produce unexpected<br>values. The question is whether the subdiagonal elements are too large to ignore (e.g.,<br>when the eigenvalues are truly complex) in which case ADVAN5 must be used, or<br>whether trivially small quantities have been produced by the accumulation of rounding<br>error in the ﬂoating point computation, in which ADVAN7 can be used. (Non-real eigen-<br>values result when the system is non-mamillary, and may also occasionally occur when<br>there are etas associated with rate constants Kij).<br>
If the maximum value printed is very small (e.g., E-15), then the computations will pro-<br>ceed correctly using a value of FACTOR such as 10 or 100. Values such as FACTOR=10<br>or FACTOR=100 are more permissive, and allow larger subdiagonal elements. If no rea-<br>sonable value of FACTOR eliminates the error messages, then ADVAN5 should be used.<br>
Location prior to NONMEM 7: prcomw<br>
REFERENCES: None.<br>
293<br>
<hr>
<A name=299></a>AES DETAILED DESCRIPTIONS<br>
Help Guide<br>
AES<br>
MEANING: AES subroutine<br>CONTEXT: User-supplied subroutine; for use with PREDPP’s ADVAN9 and ADVAN15<br>
USAGE:<br>SUBROUTINE AES (INIT,A,P,T,E,IR,DA,DP,DT)<br>USE SIZES, ONLY: DPSIZE,ISIZE<br>INTEGER (KIND=ISIZE) :: INIT,IR<br>REAL(KIND=DPSIZE) :: A,P,E,DA,DP,DT<br>DIMENSION :: A(*),P(*),E(*),DA(IR,*),DP(IR,*),DT(*)<br>
DISCUSSION:<br>The AES subroutine is called by PREDPP to evaluate algebraic expressions for ADVAN9<br>and ADVAN15.<br>
Input argument:<br>
P(n)<br>
The value of the nth PK parameter.<br>
T<br>
Time. T takes values continuously over an integration interval.<br>
Input/output arguments:<br>
INIT<br>
When AES is called with INIT=1, this is an initial condition call at the start of an<br>integration interval. Approximate amounts in each equilibrium compartment n at<br>time T must be stored in A(n). (The amounts in the non-equilibrium compartments<br>are already stored in the lower-numbered elements of A.) DA, DP, DT need not be<br>computed.<br>
If AES stores approximate values in A, it must set INIT=0.<br>If AES stores exact values in A, it must leave INIT unchanged.<br>
When AES is called with INIT=2, the values of the algebraic expressions must be<br>stored in E and the derivatives in DA, DP, and DT.<br>
A(n)<br>
The amount in the nth compartment at time T.<br>
Output argument:<br>
E(k)<br>
The value of the algebraic expression g(k).<br>
DA(k,j)<br>
The derivative of g(k) with respect to A(j).<br>
DP(k,j)<br>
The derivative of g(k) with respect to P(j).<br>
DT(k)<br>
The derivative of g(k) with respect to T.<br>
Also see variables in NONMEM modules, NONMEM-PRED modules, and PREDPP<br>modules.<br>(See <b>variables in modules</b>)<br>In particular,<br>(See <b>DES AES: ICALL,IDEFD,IDEFA</b>)<br>
294<br>
<hr>
<A name=300></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
AES<br>
REFERENCES: Guide IV, section V.C.8 , V.C.9<br>REFERENCES: Guide VI, section VI.E<br>
295<br>
<hr>
<A name=301></a>AMT DETAILED DESCRIPTIONS<br>
Help Guide<br>
AMT DAT A ITEM<br>
MEANING: Dose Amount (AMT) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... AMT ...<br>
DISCUSSION:<br>AMT labels PREDPP’s dose amount (AMT) data item. The dose amount data item is<br>optional.<br>
AMT must be 0 for non-dose event records.<br>
AMT must be 0 for &quot;steady-state with constant infusion&quot; dose or reset-dose event records.<br>
AMT must be a positive number in all other dose or reset-dose event records.<br>
(See <b>dose</b>, <b>steady_state_dose</b>).<br>
REFERENCES: Guide VI, section V.D<br>REFERENCES: Guide V, section 6.8<br>
296<br>
<hr>
<A name=302></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ANEAL<br>
ANEAL<br>
MEANING: CONSTRAINT subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>$SUBROUTINES ADVAN3 TRANS4 OTHER=aneal.f90<br>
DISCUSSION:<br>
Additional algorithmic constraints may be imposed upon the model parameters, by use of<br>the subroutine CONSTRAINT. This feature is available only for the EM and Bayesian<br>algorithms.<br>
One use would be to slow the rate of reduction of the diagonal elements of the OMEGA<br>values during the burn-in phase of the SAEM method. This is shown in example 9,<br>where a user supplied annealing algorithm is used to replace the built-in one described<br>earlier. By specifying OTHER=ANEAL.f90, where ANEAL.f90 was originally derived<br>from a template of CONSTRAINT.f90 in the source directory, the user supplied CON-<br>STRAINT subroutine can be incorporated into the model.<br>
In example 9, whenever the argument iteration number (ITER_NO) of CONSTRAINT<br>changes, a new OMEGA is evaluated that is larger than what was determined by the<br>SAEM update. Typically, this expansion algorithm should be such that its impact<br>decreases with each iteration. This example is given in example 9.<br>
See <b>INTRODUCTION TO NONMEM 7, $ANNEAL to facilitate EM search meth-<br>ods</b><br>
REFERENCES: Guide Introduction_7<br>
297<br>
<hr>
<A name=303></a>BIOAVAILABILITY DETAILED DESCRIPTIONS<br>
Help Guide<br>
BIOAVAILABILITY BEHAVIOR<br>
MEANING: PREDPP global variables<br>CONTEXT: For use with PREDPP<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of PREDPP code.<br>
USAGE:<br>$PK<br>
&quot;FIRST<br>
&quot; USE PRCOM_LOG, ONLY: NEWBIO=&gt;NEWWAY<br>
&quot;MAIN<br>
&quot; NEWBIO=.FALSE.<br>
GLOBAL DECLARATION:<br>LOGICAL NEWWAY<br>
DISCUSSION:<br>This variable allows the user to change the way bioavailability fraction parameters are<br>used by PREDPP. Prior to 1990 (i.e., with NONMEM III / PREDPP I) bio-availability<br>fractions applied to all transient doses <i>except </i>infusions (doses with AMT &gt; 0 and RATE &gt;<br>0 ). Similarly, it did not apply to steady-state doses with multiple infusion and with a<br>positive rate data item.<br>
After the change, bio-availability fractions apply to all transient (non steady-state) doses,<br>and to steady-state doses for which the AMT is speciﬁed. The only doses to which bio-<br>availability fractions do not apply are steady-state with constant infusion.<br>
By default, NEWBIO is true and the new rules apply. If NEWBIO is set to false,<br>bioavailability fraction parameters revert to their pre-1990 behavior.<br>
Location prior to NONMEM 7: prcomu<br>
REFERENCES: None.<br>
298<br>
<hr>
<A name=304></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
BIOAVAILABILITY<br>
BIOAVAILABILITY FRACTION PARAMETER<br>
MEANING: Bioavailability fraction (F) parameter for PREDPP<br>CONTEXT: Additional PK Parameters<br>
USAGE:<br>$PK<br>
F1= ....<br>
DISCUSSION:<br>
Bioavailability fraction parameters are used with PREDPP. They are optional additional<br>PK parameters. With each possible dose compartment of the kinetic model (the output<br>compartment is not a possible dose compartment), there is associated one bioavailability<br>fraction (parameter), symbolized in the $PK record by the reserved variable Fn, where n<br>is the number of the compartment.<br>
If the amount on a dose record is A, and the bioavailability fraction is F, only the fraction<br>F of A actually appears in the dose compartment (either instantaneously at the time the<br>dose enters the compartment - with a bolus dose, or over a period of time - with a regular<br>infusion; the bioavailability fraction does not apply to a steady-state infusion).<br>
Bioavailability fractions are optional in the sense that bioavailability fractions associated<br>with compartments never used as dose compartments may be ignored. The values of<br>bioavailability fractions that are not computed in PK are always understood to be 1.<br>
When additional doses are speciﬁed on a dose event record, the bioavailability fraction<br>applies to the dose and to all the additional doses. When a steady-state dose is speciﬁed<br>on a dose event record, the bioavailability fraction applies to the dose and to all implied<br>doses leading to the steady-state.<br>
(See <b>cmt</b>, <b>pk</b>, <b>$pk</b>, <b>default_compartment</b>).<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide V, section 6.8 , 7.4.4<br>REFERENCES: Guide VI, section III.F.6 , V.F.1 , V.H<br>
299<br>
<hr>
<A name=305></a>CALL DETAILED DESCRIPTIONS<br>
Help Guide<br>
CALL DAT A ITEM<br>
MEANING: Call (CALL) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... CALL ...<br>
DISCUSSION:<br>CALL labels PREDPP’s call (CALL) data item. The call data item is optional. It is used<br>to force calls to PK and/or ERROR subroutines with event records for which such calls<br>would not normally occur. (When $PK and/or $ERROR blocks are present, the effect of<br>calling these routines with an event record is to evaluate the $PK and/or $ERROR abbre-<br>viated code for that particular event record.)<br>
Values are:<br>
0<br>
(Default) No forced call; PREDPP takes its normal action.<br>
1<br>
Force a call to ERROR with the event record.<br>
2<br>
Force a call to PK with the event record.<br>
3<br>
Force calls to both PK and ERROR with the event record.<br>
10 Call ADVAN9 or ADVAN15 with the event record. May be used whether or not the<br>
TIME data item is deﬁned. May be combined with values 1, 2, and 3. e.g., CALL =<br>11 forces calls to ADVAN9 or ADVAN15, and to ERROR with the event record.<br>
If the PK routine is not called with a given event record, then the basic and additional PK<br>parameters retain the values they had after the last call to PK. This would cause a prob-<br>lem if some parameter depends on an data item whose value is different on the given<br>ev ent record than on the last event record for which PK was called.<br>
If the ERROR routine is not called with a given event record, then NONMEM’s PRED<br>value is a scaled compartment amount. This would cause a problem if the event record is<br>an other-type event which was included in the data set in order to obtain a prediction of<br>(say) a pharmacodynamic effect.<br>
The pattern of calls to ADVAN9 or ADVAN15 depends on the presence or absence of the<br>TIME data item.<br>
If TIME is deﬁned, ADVAN9 or ADVAN15 is called by default exactly as other ADVAN<br>routines are called: when TIME increases. CALL=10 may be used to obtain additional<br>calls. For example, immediately following a bolus dose event record one might include<br>an other-type event record having the same value of TIME and CALL=10. ADVAN9 or<br>ADVAN15 is called, and the amounts in the equilibrium compartments are computed<br>based on the amounts in the other compartments.<br>
If TIME is not deﬁned, ADVAN9 or ADVAN15 is called by default with every event<br>record unless the AES routine speciﬁes the calling protocol &quot;call once per individual<br>record&quot;. In this case, CALL=10 may be used to force calls to the ADVAN routine for<br>records subsequent to the ﬁrst.<br>
REFERENCES: Guide VI, section V.J<br>REFERENCES: Guide IV, section V.C.1<br>
300<br>
<hr>
<A name=306></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CALLFL<br>
CALLFL<br>
MEANING: Control calls to PK and ERROR subroutine and ADVAN9/15<br>CONTEXT: Abbreviated code<br>
USAGE:<br>CALLFL=n<br>
DISCUSSION:<br>This pseudo-assignment statement may be present in $PK abbreviated code, in which<br>case it controls when PREDPP calls the PK routine. It may be present in $ERROR<br>abbreviated code, in which case it controls when PREDPP calls the ERROR routine. It<br>may be present in $AESINITIAL abbreviated code when the TIME data item is not used,<br>in which case it controls when PREDPP calls the ADVAN9 or ADVAN15 routine. The<br>use of CALLFL in each of these three abbreviated codes is independent of its use in the<br>others. The pseudo-assignment statement may be enclosed in parentheses. A calling pro-<br>tocol phrase may be used within parentheses instead of a pseudo-assignment statement<br>CALLFL (See <b>calling protocol</b>). The pseudo-assignment statement may take these<br>forms:<br>
CALLFL=-2<br>
Call the PK subroutine with every event record, with additional and lagged doses, and<br>at modeled event times. Does not apply to the ERROR or ADVAN9 or ADVAN15<br>routines.<br>
The following messages will appear in the NONMEM output report:<br>
PK SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
PK SUBROUTINE CALLED AT NONEVENT (ADDITIONAL AND LAGGED) DOSE TIMES<br>
or<br>
PK SUBROUTINE CALLED AT NONEVENT (ADDITIONAL AND LAGGED) DOSE TIMES<br>
AND AT MODEL TIMES<br>
CALLFL=-1<br>
Call the subroutine with every event record. This is the default.<br>
Some of the following messages will appear in the NONMEM output:<br>
PK SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES<br>
ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
ADVAN9 CALLED WITH EVERY EVENT RECORD<br>
ADVAN15 CALLED WITH EVERY EVENT RECORD<br>
CALLFL=0<br>
For the PK subroutine: If the data are population data, call the subroutine with the ﬁrst<br>ev ent record of each individual record; if the data are single-subject data, call the sub-<br>routine with the ﬁrst event record of the data set. In addition, call the subroutine with<br>with every event record where the event time differs from the previous event time.<br>
The following messages will appear in the NONMEM output report:<br>
PK SUBROUTINE CALLED ONLY WITH NEW INDIVIDUAL OR NEW TIME<br>
PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL DOSE OR LAGGED) DOSE TIMES.<br>
301<br>
<hr>
<A name=307></a>CALLFL DETAILED DESCRIPTIONS<br>
Help Guide<br>
For the ERROR subroutine: When the Simulation Step is being implemented, call the<br>subroutine with every event record. Otherwise, call the subroutine only with observa-<br>tion event records.<br>
The following messages will appear in the NONMEM output report:<br>
DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
OTHERWISE, ERROR SUBROUTINE CALLED ONLY WITH OBSERVATION EVENTS<br>
Does not apply to the ADVAN9 or ADVAN15 routine.<br>
With CALLFL=0, The CALL data item may be used to request calls with additional<br>ev ent records.<br>
CALLFL=1<br>
For the PK and ADVAN9 and ADVAN15 subroutines: If the data are population data,<br>call the subroutine with the ﬁrst event record of each individual record; if the data are<br>single-subject data, call the subroutine with the ﬁrst event record of the data set.<br>
The following messages appear in the NONMEM output report:<br>
PK SUBROUTINE CALLED ONCE PER INDIVIDUAL RECORD<br>
PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL DOSE OR LAGGED) DOSE TIMES<br>
ADVAN9 CALLED ONCE PER INDIVIDUAL RECORD.<br>
ADVAN15 CALLED ONCE PER INDIVIDUAL RECORD.<br>
For the ERROR subroutine: When the Simulation Step is being implemented, call the<br>subroutine with every event record. Otherwise, if the data are population data, call the<br>subroutine with the ﬁrst event record of each individual record; if the data are single-<br>subject data, call the subroutine with the ﬁrst event record of the data set.<br>
The following messages appear in the NONMEM output report:<br>
DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
OTHERWISE, ERROR SUBROUTINE CALLED ONCE PER INDIVIDUAL RECORD<br>
With CALLFL=1, The CALL data item may be used to request calls with additional<br>ev ent records.<br>
In a block of abbreviated code, the CALLFL=n pseudo-assignment statement must pre-<br>cede all the other abbreviated code (except for verbatim code or other pseudo-assignment<br>statements). The pseudo-assignment statement may not be used conditionally. CALLFL<br>may not be used as a variable elsewhere in the abbreviated code.<br>
Note: If the $ERROR record consists of exactly one of these four statements:<br>
Y=F+ERR(1)<br>
Y=F*(1+ERR(1))<br>
Y=F+F*ERR(1)<br>
Y=F*EXP(ERR(1))<br>
with <i>no </i>other lines of code (except for comment lines), NM-TRAN will automatically<br>limit calls to ERROR to once-per-problem (unless the Simulation Step is being imple-<br>mented, in which case. calls are made with every event record). In effect, this amounts<br>to yet another way to control when it is that calls may occur to the ERROR routine, but<br>one which may not be explicitly speciﬁed in $ERROR via the use of CALLFL.<br>
302<br>
<hr>
<A name=308></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CALLFL<br>
With the last three models (proportional and exponential), NM-TRAN will also cause<br>PREDPP to output the message:<br>
ERROR IN LOG Y IS MODELED<br>
(This does not mean that a model is ﬁt to Log Y data.)<br>
REFERENCES: Guide IV, section V.C.5<br>
303<br>
<hr>
<A name=309></a>CALLING DETAILED DESCRIPTIONS<br>
Help Guide<br>
CALLING PROT OCOL PHRASE<br>
MEANING: Control calls to PK and ERROR and ADVAN9 and ADVAN15<br>CONTEXT: Abbreviated code<br>
USAGE:<br>$PK (ONCE PER INDIVIDUAL RECORD)<br>
$ERROR (ONCE PER INDIVIDUAL RECORD)<br>
$AESINITIAL (ONCE PER INDIVIDUAL RECORD)<br>
DISCUSSION:<br>A calling protocol phrase can be used instead of the CALLFL pseudo-statement in $PK,<br>$ERROR, and $AESINITIAL abbreviated codes. The phrase must be enclosed in paren-<br>theses. Either upper or lower case may be used. In an abbreviated code, the line of code<br>containing the phrase must precede all the other abbreviated code (except for verbatim<br>code or other pseudo-assignment statements), and it may be the same line that marks the<br>beginning of the code, as in the above usage examples. Pseudo-statements deﬁning<br>COMRES may be coded within the same parentheses, separated by a semicolon &quot;;&quot;. No<br>abbreviated code may follow &quot;)&quot; on the same line as the &quot;)&quot;.<br>
Phrases equivalent to CALLFL=-2 for the $PK record:<br>
(NON-EVENT)<br>
(ADDITIONAL OR LAGGED)<br>
The following messages will appear in the NONMEM output report:<br>
PK SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
PK SUBROUTINE CALLED AT NONEVENT (ADDITIONAL AND LAGGED) DOSE TIMES<br>or<br>PK SUBROUTINE CALLED AT NONEVENT (ADDITIONAL AND LAGGED) DOSE<br>
TIMES AND AT MODEL TIMES<br>
Phrases equivalent to CALLFL=-1 for the $PK, $ERROR and $AESINITIAL records<br>(the default):<br>
(EVERY EVENT)<br>
(EVERY)<br>
The following messages will appear in the NONMEM output report (as appropriate):<br>
PK SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES<br>
ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
ADVAN9 CALLED WITH EVERY EVENT RECORD.<br>
ADVAN15 CALLED WITH EVERY EVENT RECORD.<br>
Phrases equivalent to CALLFL=0 for the $PK record:<br>
(NEW TIME)<br>
(NEW EVENT TIME)<br>
The following messages appear in the NONMEM output report:<br>
PK SUBROUTINE CALLED ONLY WITH NEW INDIVIDUAL OR NEW TIME<br>
PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES.<br>
304<br>
<hr>
<A name=310></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CALLING<br>
Phrases equivalent to CALLFL=0 for the $ERROR record:<br>
(OBSERVATION EVENT)<br>
(OBS)<br>
(OBSERVATION ONLY)<br>
(OBS ONLY)<br>
One or more of the following messages appear in the NONMEM output report when<br>calls are limited in this manner:<br>
DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
OTHERWISE, ERROR SUBROUTINE CALLED ONLY WITH OBSERVATION EVENTS<br>
Phrases equivalent to CALLFL=1 for the $PK, $ERROR and $AESINITIAL blocks:<br>
(ONCE PER INDIVIDUAL RECORD)<br>
(ONCE/IND.REC.)<br>
The following messages appear in the NONMEM output (as appropriate):<br>
PK SUBROUTINE CALLED ONCE PER INDIVIDUAL RECORD<br>
PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES<br>
DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD<br>
OTHERWISE, ERROR SUBROUTINE CALLED ONCE PER INDIVIDUAL RECORD<br>
ADVAN9 CALLED ONCE PER INDIVIDUAL RECORD.<br>
ADVAN15 CALLED ONCE PER INDIVIDUAL RECORD.<br>
REFERENCES: Guide IV, section V.C.5<br>
305<br>
<hr>
<A name=311></a>CCONTR DETAILED DESCRIPTIONS<br>
Help Guide<br>
CCONTR<br>
MEANING: CCONTR subroutine<br>CONTEXT: User-supplied subroutine; replaces a NONMEM dummy routine<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>SUBROUTINE CCONTR (I,CNT,P1,P2,IER1,IER2)<br>
USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER(KIND=ISIZE), INTENT(IN OUT)<br>
:: I,IER1,IER2<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: CNT,P1(:),P2(:,:)<br>
DISCUSSION:<br>CCONTR is a user-supplied routine for computing the contribution made to the objective<br>function from an L2 record. It is used to override the NONMEM default objective func-<br>tion.<br>
CCONTR may be used when there are no epsilons or etas and in other situations, e.g.,<br>with categorical population data.<br>
NONMEM sometimes produces this error message:<br>USER CCONTR ROUTINE NOT USED, BUT THERE ARE NO EPSILONS,<br>
AND ETAS ARE TO BE ESTIMATED<br>
This can happen when POSTHOC etas are requested, but the data are single-subject data.<br>The user may have included the POSTHOC option in error.<br>
The CCONTR routine may contain the following code:<br>CALL CELS (CNT,P1,P2,IER1,IER2)<br>
If the data is correlated across L2 records (e.g., auto-regressive data), CCONTR computes<br>the contribution to the objective function for data from an entire individual record.<br>
Input argument:<br>
I<br>
Similar to Ifor PRED subroutine<br>Possible values: 0, 1, 2<br>
Output argument:<br>
CNT<br>
The conditional contribution to the objective function for this L2 record.<br>
P1 P1(i) is the partial derivative of CNT with respect to eta(i).<br>
P2 P2(i,j) is the second partial derivative of CNT with respect to eta(i) and eta(j) (for i<br>
&lt;= j).<br>At ICALL=1, CCONTR sets P2(1,1)=-1 if second derivative values are to be used.<br>Otherwise, if cross-gradient values are to be used.<br>
IER1<br>
0 - Normal return.<br>non-zero - error return.<br>
IER2<br>
0 if error-recovery is to be implemented when IER1 is nonzero.<br>1 if NONMEM is to stop when IER1 is nonzero.<br>
306<br>
<hr>
<A name=312></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CCONTR<br>
Other inputs<br>
Other inputs are available to CCONTR in NONMEM read-only global variables.<br>(See <b>MIX_CONTR:_THETA</b>)<br>E.g., USE ROCM_REAL, ONLY: THETA=&gt;THETAC<br>(See <b>CCONTR:_Y,DAT A,N1,N2,DIM</b>)<br>(See <b>CCONTR:_F,G,H</b>)<br>
CCONTR is called by NONMEM’s NCONTR routine with one level 2 (&quot;L2&quot;) record<br>after another. If no CCONTR routine is supplied by the user, NCONTR calls NONMEM<br>utility CELS (&quot;Conditional ELS&quot;; ELS contribution conditional on knowing eta). If no<br>L2 data item is present, each level 2 record is a single observation event record. Other-<br>wise, it is a group of observation records grouped together by a common value of L2.<br>
REFERENCES: Guide IV, section III.B.4<br>
307<br>
<hr>
<A name=313></a>CCONTR: DETAILED DESCRIPTIONS<br>
Help Guide<br>
CCONTR: F,G,H<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>USE ROCM_REAL, ONLY: F=&gt;FL2,G=&gt;GL2,G2=&gt;GGL2,H=&gt;HL2<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: NO,LVR,LVR2,DPSIZE<br>
REAL(KIND=DPSIZE) :: FL2(NO),GL2(NO,LVR),GGL2(NO,LVR2*(LVR2+1)/2), &amp;<br>
HL2(NO,LVR*LVR/4+LVR/2)<br>
DISCUSSION:<br>
These variables change values with each L2 record. They may be used by CCONTR.<br>
F<br>
F(n) = value returned in F from PRED for the nth observation of the L2 record.<br>
G<br>
G(n,i) = Partial derivative of F(n) with respect to eta(i)<br>
G2 G2(n,i*(i-1)/2+j) = second partial derivative of F(n) with respect to eta(i) and eta(j)<br>
(j&lt;=i)<br>G2 is arranged in symmetric storage, e.g.<br>
1<br>2<br>
3<br>
4<br>
5<br>
6<br>
G2(n,1) = 2nd. partial of F(n) wrt. eta(1) eta(1)<br>G2(n,2) = 2nd. partial of F(n) wrt. eta(2) eta(1)<br>G2(n,3) = 2nd. partial of F(n) wrt. eta(2) eta(2)<br>G2(n,4) = 2nd. partial of F(n) wrt. eta(3) eta(1)<br>G2(n,5) = 2nd. partial of F(n) wrt. eta(3) eta(2)<br>G2(n,6) = 2nd. partial of F(n) wrt. eta(3) eta(3)<br>
H<br>
H(n,i) = Partial derivative of F(n) with respect to eps(i) for i=1,neps, where neps is<br>the number of epsilons in the problem.<br>H(n,j*neps+i) = second partial derivative of F(n) with respect to eps(i) and eta(j).<br>
E.g. suppose that there are two epsilons in the problem:<br>
1<br>
3<br>
5<br>
2<br>
4<br>
6<br>
H(n,1) = partial derivative of F(n) wrt. eps(1)<br>H(n,2) = partial derivative of F(n) wrt. eps(2)<br>H(n,3) = 2nd. partial of F(n) wrt. eps(1) eta(1)<br>H(n,4) = 2nd. partial of F(n) wrt. eps(2) eta(1)<br>H(n,5) = 2nd. partial of F(n) wrt. eps(1) eta(2)<br>H(n,6) = 2nd. partial of F(n) wrt. eps(2) eta(2)<br>
Location prior to NONMEM 7: rocm5<br>
308<br>
<hr>
<A name=314></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CCONTR:<br>
REFERENCES: None.<br>
309<br>
<hr>
<A name=315></a>CCONTR: DETAILED DESCRIPTIONS<br>
Help Guide<br>
CCONTR: Y,DAT A,N1,N2,DIM<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>USE ROCM_REAL, ONLY:<br>
Y=&gt;DV_ITM2,DATA=&gt;CDATA<br>
USE ROCM_INT, ONLY: N1=&gt;NL2_OBS,N2=&gt;L2NO,DIM=&gt;L2CR_DIM<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: NO,DPSIZE<br>
REAL(KIND=DPSIZE) :: DV_ITM2(NO),CDATA(NO,3)<br>
INTEGER(KIND=ISIZE) :: NL2_OBS,L2NO,L2CR_DIM(NO)<br>
DISCUSSION:<br>
These variables change values with each L2 record. They may be used by CCONTR.<br>When the epsilons are correlated between L2 records these variables change values with<br>each L1 record.<br>(See <b>Correlation_Across_L2_Records</b>)<br>
Y(k)<br>
DV data item on the kth observation record of the L2 (L1) record.<br>
DATA(k,i)<br>
The ith type of data item speciﬁed in NM-TRAN’s $CONTR record, appearing on<br>the kth observation record of the L2 (L1) record.<br>
N1 Number of observations in the L2 record. When the epsilons are correlated between<br>
L2 records, N1 is the number of L2 records within the L1 record.<br>
N2 Number of the L2 record within the L1 record. When the epsilons are correlated<br>
between L2 records, N2 is 0.<br>
DIM<br>
When the epsilons are correlated between L2 records, DIM gives the lengths of the<br>L2 records.<br>
Location prior to NONMEM 7: rocm3<br>
REFERENCES: None.<br>
310<br>
<hr>
<A name=316></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CELS<br>
CELS<br>
MEANING: CELS subroutine<br>CONTEXT: NONMEM utility routine<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
DISCUSSION:<br>CELS is a NONMEM utility routine. It may be called by a user-supplied CCONTR rou-<br>tine. It computes the default contribution to the conditional objective function from a L2<br>record.<br>
Certain NONMEM error messages refer to CELS, for example:<br>
PROGRAM TERMINATED BY OBJ, ERROR IN CELS<br>
WITH INDIVIDUAL<br>
1 (IN INDIVIDUAL RECORD ORDERING)<br>
INTRAINDIVIDUAL VARIANCE OF DATA FROM OBS RECORD<br>
1 ESTIMATED TO BE 0<br>
A common situation giving rise to this message is the use of a proportional intra-individ-<br>ual error model while some predicted values for actual observations are zero or close<br>to zero. (For example, if the ﬁrst dose is an infusion and there is a &quot;base- line&quot; observa-<br>tion at the start of the infusion, the predicted level will be zero.)<br>
CELS must not be called when a user-supplied CRIT routine is used.<br>
REFERENCES: None.<br>
311<br>
<hr>
<A name=317></a>CHOL DETAILED DESCRIPTIONS<br>
Help Guide<br>
CHOL<br>
MEANING: CHOL subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY:: ISIZE,DPSIZE<br>
INTEGER(KIND=ISIZE) :: MODE,N,IER<br>
REAL(KIND=DPSIZE) :: R<br>
DIMENSION R(5)<br>
CALL CHOL (MODE,N,R,IER)<br>
DISCUSSION:<br>CHOL is a NONMEM utility routine that may be called by any user routine. It computes<br>the Cholesky square root of a given positive deﬁnite matrix A, i.e., the lower triangular<br>matrix B satisfying BB’ = A.<br>
Input argument:<br>
MODE<br>
An integer variable or integer constant.<br>0 - the required initialization call.<br>1 - a normal call.<br>
N<br>
An integer variable or integer constant between 1 and 5; the dimension of the matrix.<br>
R<br>
An array of dimension at least N.<br>The ith row of the matrix A, at the i+1 st. call to CHOL. Elements R(j) with j&gt;i are<br>ignored.<br>
IER<br>
Upon input when MODE is 0:<br>0 - CHOL should terminate NONMEM execution when the matrix is algorithmically<br>not positive deﬁnite.<br>1 - CHOL should always return control to PRED.<br>
Output argument:<br>
R<br>
The ith row of B, upon return from the i+1 st. call to CHOL.<br>
IER<br>
0 - Normal return.<br>1 - matrix is algorithmically not positive deﬁnite. (This can only happen if IER was<br>1 at the call with MODE=0.)<br>
If the dimension of A is NxN, then CHOL is called N+1 times. The ﬁrst call initializes<br>the routine. On the i+1 st. call, the ith row is passed to CHOL, and CHOL returns the ith<br>row of B (i=1,..., N).<br>
REFERENCES: Guide II, section D.4 , D.4.2<br>REFERENCES: Guide II, Figure 20<br>
312<br>
<hr>
<A name=318></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CMT<br>
CMT PCMT DAT A ITEM<br>
MEANING: Compartment (CMT) and Prediction Compartment (PCMT) data items for<br>PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... CMT PCMT ...<br>
DISCUSSION:<br>CMT and PCMT label PREDPP’s compartment (CMT) and prediction compartment<br>(PCMT) data items. The compartment and prediction compartment data items are<br>optional. They may be used separately or together. Their meanings depend on the partic-<br>ular kind of event record.<br>
Observation Event:<br>
CMT speciﬁes the number of the observation compartment (the compartment whose<br>scaled drug amount appears as F in the error routine). When this number is that of<br>the output compartment, it is allowed to have a neg ative sign, in which case the out-<br>put compartment is turned off after F is obtained.<br>This is also the case for an output-type compartment, which is a compartment with<br>attributes INITIALOFF and NODOSE. (With a compartment n which is not the out-<br>put compartment or an output-type compartment, two records must be used, with the<br>same TIME value: the ﬁrst with CMT=n and EVID=1 to obtain the observation, and<br>the second with CMT=-n and EVID=2 to turn the compartment off.)<br>
By convention, the number of the output compartment may also be given by the<br>CMT data item as the number 1000 (this is true regardless of the type of the event<br>record). With small models (number of compartments &lt;= 99), this number may also<br>be given as 100. With versions of NONMEM prior to 7.3, only small models are<br>possible, and only 100 may be used.<br>
When CMT is 0, the default compartment for observations is used.<br>PCMT is ignored.<br>
Dose Event:<br>
CMT speciﬁes the number of the compartment into which the dose is introduced.<br>The dose compartment is turned on if it was previously off. When CMT is 0, the<br>default compartment for doses receives the dose.<br>PCMT speciﬁes the number of the compartment for which an F value is computed.<br>PCMT may be speciﬁed as 1000 or 100 to indicate the default compartment for out-<br>put, similarly to CMT above.<br>When PCMT is 0, the default compartment for observations is used.<br>
Other-Type Event:<br>
A positive value of CMT speciﬁes a compartment to be turned on.<br>A neg ative value of CMT speciﬁes a compartment to be turned off.<br>When CMT is 0, no change is made in the status of any compartment.<br>PCMT is the same as for dose events.<br>
Reset Event:<br>
CMT is ignored.<br>PCMT is the same as for dose events.<br>
Reset-Dose Event:<br>
CMT and PCMT are the same as for dose events.<br>
313<br>
<hr>
<A name=319></a>CMT DETAILED DESCRIPTIONS<br>
Help Guide<br>
Guide V (Introductory Guide) has an example of how urine collections and observations<br>of urine concentration can be described in the data ﬁle, along with observations of plasma<br>concentrations. See Chapter 6, Section 9, The Output Compartment: Urine Collections<br>and Observations<br>
REFERENCES: Guide VI, section V.H<br>REFERENCES: Guide V, section 6.9<br>
314<br>
<hr>
<A name=320></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
COM<br>
COM COMACT COMSAV COMRES<br>
MEANING: Variables related to the module NMPRD4<br>CONTEXT: Abbreviated code, verbatim code, user-supplied routines, NM-TRAN<br>
Reserved labels starting COM are related to each other. They all refer in some manner to<br>the module NMPRD4. (This module was originally a global COMMON; hence the use<br>of the letters &quot;COM&quot;.)<br>
COM(n) (in $TABLE and $SCATTER records)<br>
Certain positions of MODULE NMPRD4 may be reserved, and the variables stored<br>in these positions may be displayed by listing them as COM(1), COM(2), etc. on<br>$TABLE and $SCATTER records, e.g.,<br>
$TABLE COM(1) COM(2)<br>
COM(n) (in abbreviated and verbatim code)<br>
Certain positions of MODULE NMPRD4 may be reserved, and the variables stored<br>in these positions are referenced in abbreviated and verbatim code as COM(1),<br>COM(2), etc.<br>
COMACT (in any user code)<br>
Reserved variable COMACT is set by NONMEM. It may be tested in PRED (e.g., in<br>abbreviated code, verbatim code, or in user-written routines) to determine when<br>NONMEM is making a copying pass, i.e., when the data records are being passed to<br>PRED for the purpose of computing values of variables which will be obtained (i.e.<br>copied) from NMPRD4 for tables and scatterplots. NONMEM only makes a copy-<br>ing pass when PRED-deﬁned items are listed in $TABLE or $SCATTER records.<br>There may be a few copying passes. With the ﬁrst copying pass, the value of<br>COMACT is 1. As copying passes proceed, the value of COMACT may remain the<br>same or increase. The values used in tables and scatterplots are those copied from<br>NMPRD4 with the last copying pass.<br>COMACT=0: This is not a copying pass.<br>COMACT=1: This is a copying pass with ﬁnal thetas and zero-valued etas.<br>COMACT=2: This is a copying pass with ﬁnal thetas and conditional estimates of<br>etas.<br>COMACT=3: This is a copying pass with conditional (nonparametric) estimates of<br>etas.<br>Such a pass takes place when the control stream includes this record:<br>
$NONPARAMETRIC ETAS<br>
COMRES=<i>n</i>1 (option of $ABBREVIATED record)<br>
COMRES (&quot;common reserve&quot;) is an option of the $ABBREVIATED record. It gives<br>instructions to NM-TRAN about NMPRD4.<br>COMRES=-1: Do not store any variables in module NMPRD4.<br>COMRES=0: Store variables in NMPRD4, but do not reserve any positions (the<br>default).<br>COMRES=<i>n</i>1: Store variables in NMPRD4, and reserve the ﬁrst <i>n</i>1 positions.<br>
COMRES=-1 (in abbreviated code)<br>
The pseudo-assignment statement COMRES=-1 may be used in any block of abbre-<br>viated code to prevent any variable deﬁned in the block from being stored into<br>NMPRD4.<br>
315<br>
<hr>
<A name=321></a>COM DETAILED DESCRIPTIONS<br>
Help Guide<br>
COMSAV=<i>n</i>2 (option of $ABBREVIATED record)<br>
Values of variables displayed in tables and scatterplots are obtained from module<br>NMPRD4. There are particular times when data records are passed to PRED for the<br>purpose of obtaining these values; these are called copying passes. The SAVE<br>region of module NMPRD4 is the initial part of NMPRD4. If a variable is stored in<br>the SAVE region, then the value of the variable computed with a given data record<br>during a copying pass will be found in NMPRD4 when the same record is passed<br>during the next copying pass, i.e. it will have been saved from the previous copying<br>pass. This is in contrast to the usual behaviour, where with a given data record, the<br>value in NMPRD4 is the value computed with the previous data record.<br><i>n</i>2 is the initial size of the SAVE region, i.e. the number of positions in this region.<br><i>n </i>=<br>
2<br>
0 is the default value. <i>n</i>2 may not exceed <i>n</i>1.<br>
The SAVE region has size <i>n</i>2 initially, but NM-TRAN may extend it if SAVE vari-<br>ables are used. However, if <i>n </i>= −<br>
2<br>
1, the SAVE region is not to be extended, and<br>
there is to be no SAVE region altogether.<br>(See <b>copying_block</b>).<br>
NM-TRAN causes the generated routines to store the value of COMSAV at<br>ICALL=1.<br>
COMSAV=<i>n</i>2 (in user written code)<br>
In the absence of abbreviated code, COMSAV may be set by a user-written PRED<br>routine at ICALL&lt;=1, or at COMACT=1 with the very ﬁrst data record. <i>n</i>2 is as<br>described above.<br>
(See <b>COMACT,COMSAV</b>)<br>(See <b>PRED-Deﬁned Variables</b>)<br>(See <b>abbreviated</b>, <b>abbreviated_code</b>, <b>displayed_values</b>).<br>
REFERENCES: Guide IV, section III.B.7 , IV.E.2<br>REFERENCES: Guide VI, section III.J<br>
316<br>
<hr>
<A name=322></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
COMACT,COMSAV<br>
COMACT,COMSAV<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY: COMACT,COMSAV<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: COMACT,COMSAV<br>
DISCUSSION:<br>
COMACT is set by NONMEM; COMSAV is set by PRED.<br>
COMACT<br>
COMACT=0: NONMEM is not making a copying pass, i.e., values from NMPRD4<br>will not be copied for tables and scatterplots. (NONMEM only makes a copying<br>pass when PRED-deﬁned items are listed in $TABLE or $SCATTER records.)<br>COMACT=1: This is a copying pass with ﬁnal thetas; etas are zero.<br>COMACT=2: This is a copying pass with ﬁnal thetas and conditional eta estimates.<br>COMACT=3: This is a copying pass with conditional (nonparametric) estimates of<br>etas. Such a pass takes place when the control stream includes this record:<br>
$NONPARAMETRIC ETAS<br>
COMSAV<br>
Set by PRED at ICALL&lt;=1 or at COMACT=1 with the very ﬁrst data record. The<br>Save Region is an initial part of NMPRD4. If with a given data record, the value of<br>a PRED-deﬁned variable is stored in this region, then during a copy pass with<br>COMACT = 2, the value of the variable is initialized to the value obtained during<br>the copy pass with the same data record and COMACT=1. COMSAV is the size of<br>this region, i.e., the number of variables whose values are stored in this region.<br>
When NM-TRAN is used, COMACT may be tested in abbreviated code. COMSAV may<br>not be referenced in abbreviated code. Instead, the COMSAV option of the $ABBREVI-<br>ATED record is coded, and NM-TRAN causes the speciﬁed value to be stored in COM-<br>SAV.<br>
Location prior to NONMEM 7: nmprd3<br>
REFERENCES: Guide IV, section III.B.7 , IV.E.2<br>REFERENCES: Guide VI, section III.J , IV.E<br>
317<br>
<hr>
<A name=323></a>COMPARTMENT DETAILED DESCRIPTIONS<br>
Help Guide<br>
COMPARTMENT INITIALIZATION BLOCK<br>
MEANING: Abbreviated code for compartment initialization<br>CONTEXT: $PK abbreviated code<br>
SAMPLE:<br>$PK<br>
IF (A_0FLG.EQ.1) THEN<br>
... compartment initialization block ...<br>
ENDIF<br>
DISCUSSION:<br>A &quot;compartment initialization block&quot; is a block of abbreviated code that sets the initial<br>state of the kinetic system. It is to be executed only when A_0FLG=1. Such a block may<br>be present only in $PK. PREDPP sets A_0FLG to 1 at a call to PK with the ﬁrst event<br>record of an individual record (if the data are population data), with the ﬁrst event record<br>of the data set (if the data are single-subject data), and with a reset record.<br>
Special rules apply to such a block.<br>
1) Values may be assigned to reserved variables A_0(n), but only in a compartment ini-<br>
tialization block. The value of the amount in the nth compartment (the nth element<br>of the state vector) is set to the value assigned to A_0(n). If PK is called with a<br>dose record or a dose-reset record where the dose is input into the nth compartment,<br>this amount is then increased by the amount of the (bioavailable) dose. If a value is<br>assigned to A_0(n), then it is not necessary that values be assigned to any of the<br>remaining variables A_0(m). A value to the output compartment cannot be<br>assigned. A_INITIAL(n) is a synonym for A_0(n).<br>
2) The statement &quot;IF (A_0FLG.EQ.1)&quot; and the corresponding &quot;ENDIF&quot; statement<br>
may be included explicitly in abbreviated code, thus deﬁning an explicit compart-<br>ment initialization block. (See example 1 below.)<br>
3) A_0(n) may be assigned a value with an unconditional statement. This deﬁnes an<br>
implicit compartment initialization block; NMTRAN inserts &quot;IF<br>(A_0FLG.EQ.1) ...&quot; before the statement and &quot;ENDIF&quot; after it. (See example 2<br>below.)<br>Indicator variables may be included in the unconditional statement. (See example 3<br>below.)<br>
4) An IF statement testing ICALL and A_0FLG together is not permitted. Instead, two<br>
separate nested IF statements must be used: an IF statement testing ICALL must<br>occur as the outermost statement, and an IF statement testing A_0FLG must occur as<br>the innermost statement. The latter may be supplied by NM-TRAN as a result of<br>using an implicit initialization block. (See example 4 below.)<br>
5) Within an explicit compartment initialization block, A_0(n) may be assigned condi-<br>
tionally. The usual rules apply if A_0(n) is a random variable. E.g., A_0(n) cannot<br>be assigned within a nested IF, and it defaults to 0 if it is assigned conditionally but<br>incompletely. Howev er, in checking for a nested IF, tests of A_0FLG and of ICALL<br>are ignored. (See example 3 below.)<br>
6) User-deﬁned variables may be deﬁned in compartment initialization blocks, but not<br>
reserved variables such as basic or additional PK parameters.<br>
318<br>
<hr>
<A name=324></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
COMPARTMENT<br>
EXAMPLES OF USAGE:<br>
The following two fragments of code yield identical results:<br>
(1) Explicit compartment initialization block:<br>
IF (A_0FLG.EQ.1) THEN<br>
A_0(1)=THETA(1)*(1+ETA(1))<br>
ENDIF<br>
(2) Implicit compartment initialization block:<br>
A_0(1)=THETA(1)*(1+ETA(1))<br>
(3) This is an example of conditional assignment of A_0(n) (X is a data item or user-<br>deﬁned variable):<br>
IF (A_0FLG.EQ.1) THEN<br>
IF (X.EQ.1) THEN<br>
A_0(1)=THETA(1)*(1+ETA(1))<br>
ELSE<br>
A_0(1)=THETA(2)*(1+ETA(2))<br>
ENDIF<br>
ENDIF<br>
Note that this can be expressed unconditionally with the use of an indicator variable. E.g.,<br>if X is a 0/1 variable, then the above is equivalent to<br>
A_0(1)=X*THETA(1)*(1+ETA(1))+(1-X)*A_0(1)=THETA(2)*(1+ETA(2))<br>
(4) Suppose compartment initialization should occur only during the Simulation step.<br>The following is not permitted:<br>
IF (ICALL.EQ.4.AND.A_0FLG.EQ.1) A_0(1)=THETA(1)*(1+ETA(1))<br>
Instead, use:<br>
IF (ICALL.EQ.4) THEN<br>
IF (A_0FLG.EQ.1) A_0(1)=THETA(1)*(1+ETA(1))<br>
ENDIF<br>
or simply<br>
IF (ICALL.EQ.4) THEN<br>
A_0(1)=THETA(1)*(1+ETA(1))<br>
ENDIF<br>
or even more simply<br>
IF (ICALL.EQ.4) A_0(1)=THETA(1)*(1+ETA(1))<br>
(See <b>Compartment Initialization: A_0</b>)<br>(See <b>Compartment Initialization: A_0FLG</b>)<br>(See <b>pk</b>).<br>
REFERENCES: None.<br>
319<br>
<hr>
<A name=325></a>COMPARTMENT DETAILED DESCRIPTIONS<br>
Help Guide<br>
COMPARTMENT INITIALIZATION: A 0<br>
MEANING: PREDPP-PK global variables<br>CONTEXT: PK routine<br>
USAGE:<br>USE PRMOD_REAL, ONLY: A_0,DA_0,D2A_0<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: PC,LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: A_0(PC),DA_0(PC,LVR),D2A_0(PC,LVR,LVR)<br>
DISCUSSION:<br>
PREDPP sets A_0FLG to 1 (See <b>compartment initialization: a_0ﬂg</b>) at a call to PK<br>with the ﬁrst event record of an individual record (if the data are population data), with<br>the ﬁrst event record of the data set (if the data are single-subject data), and with a reset<br>record. At such times, the amounts in the various compartments can be set by the PK<br>routine. It can do this by storing the initial values for the state vector and its partials in<br>A_0,DA_0,D2A_0. The amount in the output compartment can not be set.<br>
A_0<br>
A_0(n) = the amount for compartment n<br>
DA_0<br>
DA_0(n,i) = the derivative of A_0(n) wrt eta(i)<br>
D2A_0<br>
D2A_0(n,i,j) = the second derivative of A_0(n) wrt eta(i), eta(j) (lower-trian-<br>gular; j=1, ..., i)<br>
There is a one-to-one correspondence between A_0,DA_0,D2A_0 and<br>A,DAETA,D2AETA (See <b>State Vector: A</b>).<br>
NM-TRAN includes A_0,DA_0,D2A_0 in the PK routine when the $PK block includes<br>references to variables A_0FLG, A_0, or A_INITIAL, or when verbatim code is present.<br>
(See <b>Compartment Initialization: A_0FLG</b>, <b>State Vector: A</b>).<br>
Location prior to NONMEM 7: prdpk3<br>
REFERENCES: None.<br>
320<br>
<hr>
<A name=326></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
COMPARTMENT<br>
COMPARTMENT INITIALIZATION: A 0FLG<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied PK routine<br>
USAGE:<br>USE PROCM_INT, ONLY: A_0FLG<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: A_0FLG<br>
DISCUSSION:<br>
A_0FLG<br>
When ICALL&gt;=2, at a call to PK with the ﬁrst record of of an individual record or<br>with a reset record, PREDPP sets A_0FLAG=1. At such a call, the state vector A<br>and its ﬁrst and second eta partials (DAETA and D2AETA) have been set to zero.<br>A_0FLG=0 at all other calls to PK.<br>
When A_0FLG=1, PK may initialize compartments. It can do this by storing the initial<br>values for the state vector and its partials in A_0,DA_0,D2A_0.<br>
NM-TRAN includes A_0FLG in the PK routine when the $PK block includes references<br>to variables A_0FLG, A_0(n), or A_INITIAL(n), or when verbatim code is present.<br>
(See <b>Compartment Initialization: A_0</b>, <b>State Vector: A</b>).<br>
Location prior to NONMEM 7: procmc<br>
REFERENCES: None.<br>
321<br>
<hr>
<A name=327></a>CONSTRAINT DETAILED DESCRIPTIONS<br>
Help Guide<br>
CONSTRAINT<br>
MEANING: CONSTRAINT subroutine<br>CONTEXT: NONMEM utility routine<br>
DISCUSSION:<br>CONSTRAINT is a NONMEM utility routine.<br>
Additional algorithmic constraints may be imposed upon model parameters by use of the<br>subroutine CONSTRAINT. This feature is available only for the EM and Bayesian algo-<br>rithms.<br>
The default CONSTRAINT.f90 is identical to source\CONSTRAINT.f90.<br>
Option CONSTRAIN of the $ESTIMATION record and the $ANNEAL record may be<br>used to give information to the subroutine.<br>
It may be modiﬁed by the user.<br>
See <b>INTRODUCTION TO NONMEM 7, $ANNEAL to facilitate EM search meth-<br>ods<br></b>See <b>INTRODUCTION TO NONMEM 7, Imposing Thetas, Omegas, and Sigmas by<br>Algebraic Relationships: Simulated Annealing Example</b><br>
REFERENCES: Guide Introduction_7<br>
322<br>
<hr>
<A name=328></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CONT<br>
CONT DAT A ITEM<br>
MEANING: Continuation (CONT) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... CONT ...<br>
DISCUSSION:<br>CONT labels PREDPP’s continuation (CONT) data item. The continuation data item is<br>optional. The CONT data item allows a PREDPP event record to span several data<br>records. It is useful when more than NONMEM’s maximum number of data items per<br>record are needed to describe a single event. When the CONT data item is not deﬁned on<br>the $INPUT record, every event record consists of a single data record.<br>
Values are:<br>
0<br>
This is the last or only data record of the event record.<br>
1<br>
This and the succeeding record are both members of the same event record. MDV<br>must be 1.<br>
PREDPP ignores records having CONT=1, except to pass them to the PK and ERROR<br>routines as part of the complete event record. Values of PREDPP data items such as<br>EVID, AMT, etc., are signiﬁcant only on the ﬁnal record of each event record, i.e., on<br>records having CONT=0.<br>
With NM-TRAN abbreviated code, values on data records having CONT=1 are not avail-<br>able for use as right-hand quantities, i.e., abbreviated code cannot reference the values in<br>data records other than the last of each event record. (It would be possible to reference<br>such values using verbatim code, however). When NM-TRAN performs time translation<br>or ii conversion, it does so only for the event records having CONT=0.<br>(See <b>date</b>, <b>time</b>, <b>ii</b>).<br>
REFERENCES: Guide VI, section II , V.A , V.I<br>REFERENCES: Guide IV, section V.B , V.C.5<br>
323<br>
<hr>
<A name=329></a>CONTR DETAILED DESCRIPTIONS<br>
Help Guide<br>
CONTR<br>
MEANING: CONTR subroutine<br>CONTEXT: User-supplied subroutine; replaces a NONMEM dummy routine<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>SUBROUTINE CONTR (I,CNT,IER1,IER2)<br>
USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER(KIND=ISIZE), INTENT(IN OUT) :: I,IER1,IER2<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: CNT<br>
DISCUSSION:<br>
CONTR is a user-supplied routine for computing the contribution made to the objective<br>function from an L1 record. It is used to override the NONMEM default objective func-<br>tion.<br>
A user-supplied CONTR routine may be used when the dimension of OMEGA is zero,<br>i.e., when there are no etas in the problem, and in other situations, e.g., with categorical<br>data.<br>
When NM-TRAN is used, the $CONTR record may be used to request that information<br>from the data records be made available to CONTR.<br>
Input argument:<br>
I<br>
Similar to ICALL for PRED subroutine.<br>
Possible values: 0, 1, 2<br>
Output argument:<br>
CNT<br>
Contribution to -2log likelihood for data from the individual record.<br>
IER1<br>
0 - Normal return.<br>
non-zero - error return.<br>
IER2<br>
0 - error-recovery is to be implemented when IER1 is nonzero.<br>
1 - NONMEM is to stop when IER1 is nonzero.<br>
Other Inputs:<br>
Other inputs are available to CONTR in NONMEM read-only global variables.<br>In particular:<br>
THETA (current theta) (See <b>CONTR_MIX:_THETA</b>)<br>
DV and data values for this L1 record.<br>(See <b>CONTR:_Y_DAT A_NOBS</b>, <b>CONTR:_III_DIM</b>)<br>(See <b>$CONTR</b>)<br>
Predictions and derivatives. (See <b>CONTR:_F_G_H</b>)<br>
NONMEM Utility Routines:<br>
324<br>
<hr>
<A name=330></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CONTR<br>
Other NONMEM subroutines may be called by CONTR, depending on the type of data,<br>as follows.<br>
POPULATION SINGLE-SUBJECT<br>
CONTINUOUS ELS, NCONTR ELS<br>
(note: same result)<br>
CATEGORICAL NCONTR<br>
none<br>
Scatterplots<br>
If the scatterplot step is implemented, and zero lines are appropriate for values of<br>RES and/or WRES, CONTR should request that NONMEM generate such lines.<br>(NONMEM does this by default when a user supplied CONTR is not supplied.) To<br>request zero lines for RES and WRES, CONTR should set OPSCRS(2) and<br>OPSCRS(3) (respectively) to 1.<br>e.g.,<br>
USE CMNM6_INT, ONLY: OPSCRS=&gt;ICONTRSC<br>
...<br>
IF (ICALL.LE.1) THEN<br>OPSCRS(2)=1<br>OPSCRS(3)=1<br>ENDIF<br>
REFERENCES: Guide I, section G.3<br>REFERENCES: Guide IV, section III.B.4<br>REFERENCES: Guide V, section 12.4.16<br>
325<br>
<hr>
<A name=331></a>CONTR: DETAILED DESCRIPTIONS<br>
Help Guide<br>
CONTR: F,G,H<br>
MEANING: NONMEM read-only global variables<br>
CONTEXT: User-supplied routines<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>USE ROCM_REAL, ONLY: F=&gt;FL1,G=&gt;GL1,G2=&gt;GGL1,H=&gt;HL1<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: NO,LVR,LVR2,DPSIZE<br>
REAL(KIND=DPSIZE) :: FL1(NO),GL1(NO,LVR), &amp;<br>
GGL1(NO,LVR2*(LVR2+1)/2), &amp;<br>
HL1(NO,LVR*LVR/4+LVR/2)<br>
DISCUSSION:<br>
These variables changes values with each individual record. They may be used by<br>CONTR.<br>
F<br>
F(n) = value returned in F from PRED for the nth observation of the individual<br>record.<br>
G<br>
G(n,i) = Partial derivative of F(n) with respect to eta(i)<br>
G2 G2(n,i*(i-1)/2+j) = second partial derivative of F(n) with respect to eta(i) and eta(j)<br>
(j&lt;=i)<br>G2 is arranged in symmetric storage, e.g.<br>
1<br>2<br>
3<br>
4<br>
5<br>
6<br>
G2(n,1) = 2nd. partial of F(n) wrt. eta(1) eta(1)<br>G2(n,2) = 2nd. partial of F(n) wrt. eta(2) eta(1)<br>G2(n,3) = 2nd. partial of F(n) wrt. eta(2) eta(2)<br>G2(n,4) = 2nd. partial of F(n) wrt. eta(3) eta(1)<br>G2(n,5) = 2nd. partial of F(n) wrt. eta(3) eta(2)<br>G2(n,6) = 2nd. partial of F(n) wrt. eta(3) eta(3)<br>
H<br>
H(n,i) = Partial derivative of F(n) with respect to eps(i) for i=1,neps, where neps is<br>the number of epsilons in the problem.<br>H(n,j*neps+i) = second partial derivative of F(n) with respect to eps(i) and eta(j).<br>
E.g. suppose that there are two epsilons in the problem:<br>
1<br>
3<br>
5<br>
2<br>
4<br>
6<br>
H(n,1) = partial derivative of F(n) wrt. eps(1)<br>H(n,2) = partial derivative of F(n) wrt. eps(2)<br>H(n,3) = 2nd. partial of F(n) wrt. eps(1) eta(1)<br>H(n,4) = 2nd. partial of F(n) wrt. eps(2) eta(1)<br>H(n,5) = 2nd. partial of F(n) wrt. eps(1) eta(2)<br>H(n,6) = 2nd. partial of F(n) wrt. eps(2) eta(2)<br>
326<br>
<hr>
<A name=332></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CONTR:<br>
Location prior to NONMEM 7: rocm3<br>
REFERENCES: None.<br>
327<br>
<hr>
<A name=333></a>CONTR: DETAILED DESCRIPTIONS<br>
Help Guide<br>
CONTR: III,DIM<br>
MEANING: NONMEM read-only global variables<br>
CONTEXT: User-supplied routines<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>USE ROCM_INT, ONLY:<br>
III=&gt;NL2_RECS, DIM=&gt;L2_DIM<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: NO<br>
INTEGER(KIND=ISIZE) :: NL2_RECS,L2_DIM(NO)<br>
DISCUSSION:<br>
These variables change values with each individual record. They may be used by<br>CONTR.<br>
III<br>
Number of L2 records in the individual record.<br>
DIM<br>
Length of each L2 record.<br>
When there is no L2 data item, III = number of observations in the individual record, and<br>all values in DIM = 1.<br>
Location prior to NONMEM 7: rocm2<br>
REFERENCES: None.<br>
328<br>
<hr>
<A name=334></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CONTR:<br>
CONTR: KCALL<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>USE ROCM_INT, ONLY: KCALL=&gt;K_CONTR<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: K_CONTR<br>
DISCUSSION:<br>
KCALL<br>
KCALL=1 with a unique pass through data calling PRED and CONTR with ﬁnal<br>parameter estimates.<br>KCALL=0 otherwise.<br>
Location prior to NONMEM 7: rocm13<br>
REFERENCES: None.<br>
329<br>
<hr>
<A name=335></a>CONTR: DETAILED DESCRIPTIONS<br>
Help Guide<br>
CONTR: Y DAT A NOBS<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: CONTR routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: Y=&gt;DV_ITM,DATA=&gt;RDATA<br>
USE ROCM_INT,<br>
ONLY: NOBS=&gt;NOBSIND2<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: NO,DPSIZE<br>
REAL(KIND=DPSIZE) :: DV_ITM(NO),RDATA(NO,3)<br>
INTEGER(KIND=ISIZE) :: NOBSIND2<br>
DISCUSSION:<br>
These variables change values with each individual record. They may be used by a user-<br>written CONTR subroutine.<br>
Y(k)<br>
DV data item on the kth data record of the individual record, ignoring data records<br>with MDV=1.<br>
DATA(k,i)<br>
The value of the ith type of data item speciﬁed in NM-TRAN’s $CONTR record,<br>appearing on the kth observation record of the individual record.<br>
NOBS<br>
Number of observations in the individual record.<br>
DATA is used also in MIX (See <b>data_for_mix</b>).<br>
Location prior to NONMEM 7: rocm1<br>
REFERENCES: Guide IV, section III.B.4<br>
330<br>
<hr>
<A name=336></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
COPYING<br>
COPYING BLOCK<br>
MEANING: Abbreviated code especially for copying pass<br>CONTEXT: $PRED, $PK, $ERROR, $AES, $DES abbreviated code<br>
SAMPLE:<br>
IF (COMACT.EQ.1) TVCL=CL<br>
DISCUSSION:<br>
Values of variables displayed in tables and scatterplots are obtained (i.e. copied) from<br>module NMPRD4. There are particular times when data records are passed to PRED for<br>the purpose of obtaining these values; these are called copying passes. The variable<br>COMACT signals that a copying pass is in progress when its value is positive. There<br>may be a number of copying passes, but if (and only if) values of variables are to be dis-<br>played, there is at least one copying pass. With the ﬁrst copying pass, the value of<br>COMACT is 1 and that of MIXNUM is 1. If a mixture model with k subpopulations is<br>used, then COMACT remains 1 during a total of k copying passes, and with each copying<br>pass the value of MIXNUM increments by 1. If conditional estimation is used (or if the<br>POSTHOC option appears), then there follows a set of copying passes where the value of<br>COMACT is 2 and again, MIXNUM increases from 1 to k. If a mixture model is not<br>used, there are altogether at most two copying passes, one with COMACT=1 and another<br>with COMACT=2.<br>
If values of a variable from earlier copying passes are needed in later passes, the values<br>for the variable should be stored in the SAVE region of module NMPRD4. (See <b>com-<br>sav</b>). When the values are stored in the SAVE region, that value computed with a given<br>data record during a copying pass will be found in NMPRD4 when the same record is<br>passed during the next copying pass, i.e. it will have been saved from the previous copy-<br>ing pass. This is in contrast to the usual behaviour (with a noncopying pass), where with<br>a giv en data record, the value in NMPRD4 is the value computed with the previous data<br>record. The value is 0 when a record is passed during the ﬁrst copying pass, and though<br>PRED may set it or reset it during a subsequent copying pass, this need not be done (see<br>discussion below about COMACT).<br>
The values used in tables and scatterplots (whether or not these values are stored in the<br>SAVE region) are those copied from NMPRD4 with the last copying pass.<br>
A copying block is a block of abbreviated code that is only executed during a copying<br>pass, i.e. when COMACT has a positive value. Special rules apply, which allow the user<br>to be less concerned about using the COMSAV option of the $ABBREVIATED record<br>(see example below):<br>
COM(i) variables that are deﬁned in a copying block are referred to as explicit SAVE<br>variables. PRED-deﬁned variables that are deﬁned in a copying block, other than<br>COM(i) variables, are referred to as implicit SAVE variables. Collectively, the two types<br>of SAVE variables are referred to as SAVE variables. NM-TRAN stores SAVE variables<br>in the SAVE region of module NMPRD4.<br>
Implicit and explicit SAVE variables cannot both appear in abbreviated code. The COM-<br>RES option of the $ABBREV record cannot be used when any implicit SAVE variables<br>are used, but it must be used when explicit SAVE variables appear (as whenever COM(i)<br>variables appear).<br>
The size of the SAVE region of NMPRD4 depends on the COMSAV option of the<br>$ABBREV record. This option may be used in three ways:<br>
331<br>
<hr>
<A name=337></a>COPYING DETAILED DESCRIPTIONS<br>
Help Guide<br>
No COMSAV option. The SAVE region of module NMPRD4 will nonetheless<br>include all the SAVE variables.<br>
COMSAV=n (n&gt;=0). NM-TRAN will, if necessary, extend the size of the SAVE<br>region from n to a larger value so that all SAVE variables will be included in the<br>region.<br>
COMSAV=-1. There is to be no SAVE region. Variables deﬁned in a copying block<br>will not be SAVE variables.<br>
EXAMPLE OF USAGE:<br>
$ERROR<br>
Y=F+F*EPS(1)<br>
IPRED=F<br>
IF (COMACT.EQ.1) FT=F<br>
WR=(DV-IPRED)/FT<br>
$EST ... POSTHOC<br>
$TABLE FT IPRED WR<br>
With the ﬁrst copying pass the value of COMACT is 1, which signals that during this<br>copying pass, all ETA variables are set to 0. Since the option POSTHOC appears, with a<br>subsequent copying pass the value of COMACT is 2, which signals that during this copy-<br>ing pass, all ETA variables are set to their conditional estimates.<br>
In this example, WR is set to the weighted intra-individual residual. When COMACT=1,<br>the prediction for the typical individual (ETA=0) is computed and stored in FT. FT is a<br>SAVE variable, so this value will have been saved, and when COMACT=2, this same<br>value will be found in FT. With COMACT=2, the weight used with the residual is com-<br>puted to be the reciprocal of this FT value, while IPRED is computed from conditional<br>estimates of the ETA variables and thus its value applies to to the individual with these<br>estimates, rather than to the typical individual. The values of IPRED and WR appearing<br>in the table are those obtained during the last copying pass. The tabled value of IPRED<br>is based on the conditional estimate of ETA. The value of FT is also the value obtained<br>during the last copying pass, but it in turn is also the value obtained from the ﬁrst copying<br>pass, as the value of FT has not changed during any subsequent copying pass, and this<br>value is based on ETA=0.<br>
Since FT is a SAVE variable, a SAVE region will have been allocated where this variable<br>will be stored, and (unless there is some reason to use the COMSAV option other than to<br>insure this) the user not be concerned about this option.<br>
(See <b>COMACT,COMSAV</b>)<br>(See <b>PRED-Deﬁned Variables</b>).<br>(See <b>abbreviated</b>).<br>
REFERENCES: None.<br>
332<br>
<hr>
<A name=338></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CORRELATION<br>
CORRELATION ACROSS L2 RECORDS<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED and ERROR routines<br>
USAGE:<br>CORRL2(n,m)=...<br>
DISCUSSION:<br>
An individual record is divided into L2 records. An L2 record may contain one or more<br>observations (on one or more separate data records respectively), in which case it is<br>called an observation-L2 record. The values of epsilons used in the intraindividual model<br>may be correlated across the observations contained in the L2 record, and thus the L2<br>record may deﬁne a multivariate observation - the L2 observation. (When all L2 observa-<br>tions in the data set are univariate, L2 data items need not appear, and when L2 data items<br>do not appear, NONMEM assumes that each data record is a distinct L2 record.)<br>
By default, the values of a given epsilon are statistically independent across L2 observa-<br>tions within an individual record. Using CORRL2, however, these values may be corre-<br>lated. More precisely, the values of the epsilons associated with the mth diagonal block<br>of SIGMA may be correlated across L2 observations, and it will be understood that for<br>two different epsilons (eps1 and eps2, say) associated with the mth block, the correlation<br>between the values of eps1 for L2 observations A and B will be taken to be the same as<br>the correlation between the values of eps2 for these same two L2 observations.<br>
With NONMEM 7.3, reserved variable CORRL2 is used and code such as the following<br>may be used in $ERROR and $PRED blocks.<br>
Proceed as follows. With the ﬁrst data record of the nth observation-L2 record, and with<br>respect to the values of the epsilons associated with the mth diagonal block of SIGMA,<br>the PRED routine should set CORRL2(k,m), for k=1,...,n, to the correlation between the<br>values for the kth L2 observation and the nth L2 observation. (CORRL2(n,m) should be<br>set to 1.0; in particular, with the ﬁrst data record of the 1st observation-L2 record,<br>CORRL2(1,m) should be set to 1.0.)<br>
E.g. Suppose that the L2 observations are bivariate and chronologically ordered by a<br>TIME data item, and suppose that the intraindividual model has two epsilons (one for<br>each element of the bivariate L2 observation), each associated with the same diagonal<br>block of SIGMA, Then the values of these epsilons may be autocorrelated across the L2<br>observations, as speciﬁed by the above code. But if the two epsilons are associated with<br>two different diagonal blocks, then one might use this code, in which each sigma block<br>has its own autocorrelation parameter theta(4) or theta(5):<br>
$ABBREVIATED DECLARE T1(NO)<br>
$ABBREVIATED DECLARE INTEGER I1<br>
$ABBREVIATED DECLARE DOWHILE J1<br>
IF (NEWL2==1.AND.EVID==0) THEN<br>
I1=I1+1<br>
T1(I1)=TIME<br>
J1=1<br>
DO WHILE (J1&lt;=I1)<br>
CORRL2(J1,1)=EXP(-THETA(4)*(TIME-T1(J1))) ; Sigma block 1<br>
CORRL2(J1,2)=EXP(-THETA(5)*(TIME-T1(J1))) ; Sigma block 2<br>
333<br>
<hr>
<A name=339></a>CORRELATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
J1=J1+1<br>
ENDDO<br>
ENDIF<br>
$THETA 2<br>
;[CL]<br>
$THETA 30 ;[V]<br>
$THETA 0.05 ;[Rho1]<br>
$THETA 0.075 ;[Rho2]<br>
If you wish to have more control as to when the CORRL2 is used to model among the<br>individual data records within the L2 records, consider the following example:<br>
$ABBR DECLARE T1(NO),<br>
$ABBR DECLARE INTEGER I1, DOWHILE J1<br>
$ERROR<br>
IF (NEWIND.NE.2) I1=0<br>
IF (NEWL2==1) THEN<br>
I1=I1+1<br>
T1(I1)=TIME<br>
J1=1<br>
DO WHILE (J1&lt;=I1)<br>
IF(MV1==0.0) CORRL2(J1,1)=EXP(-THETA(4)*(TIME-T1(J1)))<br>
IF(MV2==0.0) CORRL2(J1,2)=EXP(-THETA(5)*(TIME-T1(J1)))<br>
J1=J1+1<br>
ENDDO<br>
ENDIF<br>
IF(CMT==1) Y=F+F*EPS(1)+EPS(2)<br>
IF(CMT==2) Y=F+F*EPS(3)+EPS(4)<br>
...<br>
$SIGMA BLOCK(2)<br>
0.3<br>
0.001 0.04<br>
$SIGMA BLOCK(2)<br>
0.7<br>
0.001 0.08<br>
Here MV1 and MV2 data item that is assumed to exist in the data set, and MV signals<br>the desire to use CORRL2 on an L2 observation within an L2 record, <i>on the ﬁrst data<br>record of the L2 record</i>. The following is a section of data to indicate more clearly how<br>this may be set up:<br>
ID TIME L2 MV1 MV2 CMT DV<br>
1<br>
2.0 1 0<br>
0<br>
1<br>
0.8<br>
1<br>
2.0 1 0<br>
0<br>
2<br>
10.0<br>
1<br>
4.0 2 0<br>
0<br>
1<br>
0.6<br>
1<br>
4.0 2 0<br>
0<br>
2<br>
12.0<br>
1<br>
6.0 3 1<br>
1<br>
1<br>
0.3<br>
1<br>
6.0 3 1<br>
1<br>
2<br>
20.0<br>
1<br>
10.0 4 1<br>
0<br>
1<br>
0.1<br>
334<br>
<hr>
<A name=340></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CORRELATION<br>
1<br>
10.0 4 1<br>
0<br>
2<br>
15.0<br>
1<br>
14.0 5 1<br>
1<br>
1<br>
0.03<br>
Only data points with times 2, 4, and 10 hours will incorporate the correlation of the<br>CORRL2 model. Furthermore the record of time 10 hours has MV1=1 and MV2=0, so<br>the observation record in the 10 hour L2 record that uses Sigma block 2 will have a<br>CORRL2 assessment, whereas the observtation in the 10 hour L2 record that uses Sigma<br>block 1 will not be CORRL2 modeled. In the above example, Sigma block 1 consists of<br>EPS(1) and EPS(2), and Sigma block 2 consists of EPS(3) and EPS(4), with the CMT<br>value determining which data records use which Sigma blocks (epsilons sets) based on<br>how Y is evaluated.<br>
RESTRICTIONS:<br>
With versions of NONMEM before 7.3, C should be used rather than CORRL2. Because<br>C is not recognized by NM-TRAN, and because of other restrictions regarding abbrevi-<br>ated code, a speciﬁcation of C, as above, within a block of abbreviated code, must be<br>done using verbatim code. See help for that version of NONMEM.<br>
SIMULATION WITH POPULATION DAT A AND AUTO-CORRELATION<br>
If population data are simulated, the correlations must be stored in CORRL2 before the<br>NONMEM utility routine SIMEPS is called. With NONMEM 7.3, code such as the fol-<br>lowing may be used in $ERROR and $PRED blocks. Because the value of CORRL2 is<br>set before SIMEPS is called, NM-TRAN omits the usual default call to SIMEPS.<br>
$ABBR DECLARE T(NO), INTEGER I, DOWHILE J<br>
IF (ICALL == 4) THEN<br>
IF (NEWIND /= 2) I=0<br>
IF (MDV == 0) THEN<br>
I=I+1<br>
T(I)=TIME<br>
J=1<br>
DO WHILE (J &lt;= I)<br>
CORRL2(J,1)=EXP(-THETA(4)*(TIME-T(J)))<br>
J=J+1<br>
ENDDO<br>
ENDIF<br>
CALL SIMEPS(EPS)<br>
ENDIF<br>
RESTRICTIONS:<br>
With versions of NONMEM before 7.3, C should be used rather than CORRL2. Because<br>C is not recognized by NM-TRAN, and because of other restrictions regarding abbrevi-<br>ated code, a speciﬁcation of C, as above, within a block of abbreviated code, must be<br>done using verbatim code. Since NM-TRAN generated code has a call to SIMEPS in its<br>second section (see Guide IV), this means that correlations must be computed and stored<br>using verbatim code in the &quot;FIRST block. (Details can be supplied on request.)<br>
SINGLE-SUBJECT DAT A<br>
&quot;Single-subject data&quot; with correlated residual error, can be simulated and analyzed. To<br>do this, though, a technique is needed which can always be used with such data: the data<br>are handled as data from a population sample with a single individual, and OMEGA is<br>constrained to be 0.<br>
335<br>
<hr>
<A name=341></a>CORRELATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
(See <b>Simulation:_SIMEPS_Error_Code</b>)<br>
Location prior to NONMEM 7: nmprd5<br>
REFERENCES: None.<br>
336<br>
<hr>
<A name=342></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CORRELATION<br>
CORRELATION MATRIX OF ESTIMATE<br>
MEANING: Part of NONMEM’s estimate of the precision of its parameter estimates<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>Asymptotic statistical theory applied to extended least-squares estimation (as used in<br>NONMEM) says that the distribution of the parameter estimators is multivariate normal,<br>with variance-covariance matrix that can be estimated from the data. NONMEM supplies<br>such an estimate of the variance-covariance matrix of the parameter estimates<br>(See <b>covariance matrix of estimate</b>). The correlation matrix is the variance-covariance<br>matrix in correlation form. If the correlation between two parameters is large (e.g., &gt;.95),<br>then one may conclude that a considerable portion of the uncertainty in each parameter is<br>due to the inability of the data to distinguish between the two. The problem can be<br>avoided by getting additional data or by using a simpler (fewer parameters) model.<br>
**************** CORRELATION MATRIX OF ESTIMATE ********************<br>
TH 1<br>
TH 2<br>
OM11 OM12 OM22 SG11<br>
TH 1<br>
1.01E+00<br>
TH 2<br>
-2.85E-01 2.55E-02<br>
OM11 8.87E-01 -6.77E-01 1.67E+01<br>
OM12 ......... ......... ......... .........<br>
OM22 2.81E-01 -9.96E-01 6.72E-01 ......... 1.31E-03<br>
SG11 -4.83E-01<br>
3.10E-01 -5.44E-01 ......... -2.67E-01<br>
1.60E-01<br>
The matrix (which is symmetric) is given in lower triangular form. In this example, the<br>2x2 matrix, OMEGA, was constrained to be diagonal; the omitted entries above (.........)<br>indicate that omega(2,1) is not estimated, and consequently has no corresponding<br>row/column in the correlation matrix of the estimates.<br>
With NONMEM 7.2 and higher, the diagonal elements are equal to the square root of the<br>diagonal elements of the covariance matrix (standard error); with previous versions they<br>were 1.0.<br>
When the size of the array exceeds 75x75, a compressed form is printed in which the<br>omitted entries (.........) are not printed. The compressed form may also be requested for<br>arrays smaller than 75x75 (See <b>$covariance</b>).<br>
REFERENCES: Guide I, section C.3.5.2<br>REFERENCES: Guide V, section 5.4<br>
337<br>
<hr>
<A name=343></a>COVARIANCE DETAILED DESCRIPTIONS<br>
Help Guide<br>
COVARIANCE MATRIX OF ESTIMATE<br>
MEANING: NONMEM’s estimate of the precision of its parameter estimates<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>From asymptotic statistical theory, the distribution of the parameter estimates is multi-<br>variate normal, with a variance-covariance matrix that can be estimated from the data.<br>Such an estimate forms the basic output of NONMEM’s Covariance Step. The variance-<br>covariance matrix is not to be confused with either SIGMA, the covariance matrix for the<br>second level random effects, or with OMEGA, the covariance matrix for the ﬁrst level<br>random effects. These two matrices describe the variability of epsilons or etas, respec-<br>tively, about their means. The variance-covariance matrix of the (distribution of) parame-<br>ter estimates, on the other hand, describes the variability under the assumed model of the<br>parameter estimates across (imagined) replicated data sets, using the design of the real<br>data set. The following is an example of the NONMEM output giving the estimate of the<br>variance-covariance matrix.<br>
**************** COVARIANCE MATRIX OF ESTIMATE<br>
********************<br>
TH 1<br>
TH 2<br>
OM11 OM12 OM22 SG11<br>
TH 1<br>
1.02E+00<br>
TH 2<br>
-7.34E-03 6.50E-04<br>
OM11 1.50E+01 -2.88E-01 2.78E+02<br>
OM12 ......... ......... ......... .........<br>
OM22 3.73E-04 -3.33E-05 1.47E-02 ......... 1.72E-06<br>
SG11 -7.79E-02<br>
1.26E-03 -1.45E+00 ......... -5.59E-05<br>
2.55E-02<br>
The matrix (which is symmetric) is given in lower triangular form. In this example, the<br>2x2 matrix, OMEGA, was constrained to be diagonal; the omitted entries above (.........)<br>indicate that OM12 is not estimated, and consequently has no corresponding row/column<br>in the variance-covariance matrix. When the size of the array exceeds 75x75, a com-<br>pressed form is printed in which the omitted entries (.........) are not printed. The com-<br>pressed form may also be requested for arrays smaller than 75x75 (See <b>$covariance</b>).<br>
The (estimated) variance-covariance matrix is computed from the R and S matrices; it is<br>Rinv*S*Rinv, where Rinv is the inverse of the R matrix. The R matrix is the Hessian<br>matrix of the objective function, evaluated at the parameter estimates. The S matrix is<br>obtained by summing the cross-product gradient vectors of the individual-based objective<br>functions, evaluated at the parameter estimates. The individual-based objective functions<br>are the separate terms contributed by each individual’s data to the overall objective func-<br>tion, and the cross-product gradient vectors are summed across the individuals in the data<br>set.<br>
The inverse variance-covariance matrix R*Sinv*R is also output (labeled as the Inverse<br>Covariance Matrix), where Sinv is the inverse of the S matrix. If S is judged to be singu-<br>lar, a pseudo-inverse of S is used, and since a pseudo-inverse is not unique, the inverse<br>variance-covariance matrix is really not unique. In either case, the inverse variance-<br>covariance matrix can be used to develop a joint conﬁdence region for the complete set of<br>population parameters. As we usually develop a conﬁdence region for a very limited set<br>of population parameters, this use of the inverse variance-covariance matrix is somewhat<br>limited.<br>
338<br>
<hr>
<A name=344></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
COVARIANCE<br>
An error message from the Covariance Step stating that the R matrix is not positive semi-<br>deﬁnite suggests that the parameter estimate does not correspond to a true (local) mini-<br>mum and is not to be trusted. (It may be a saddle point.) An error message stating that<br>the R matrix is positive semideﬁnite, but singular, indicates that the objective function is<br>ﬂat in a neighborhood of the parameter estimate, and so the minimum is not really<br>unique, and there is probably some overparametrization. With both error messages, nei-<br>ther a variance-covariance matrix nor inverse variance-covariance matrix is output. An<br>error message stating that the S matrix is singular indicates strong overparameterization.<br>However, provided the R matrix is judged to be positive semidefnite and nonsingular (i.e.<br>positive deﬁnite), both the variance-covariance and inverse variance-covariance matrices<br>are output.<br>
When the R matrix is judged to be singular, but positive semideﬁnite, then the T matrix,<br>R*Sinv*R, where Sinv is the inverse (or a pseudo-inverse) of the S matrix, is output.<br>This cannot be called the inverse covariance matrix, as the covariance matrix does not<br>exist. However, as with the inverse variance-covariance matrix, T can be used to develop<br>a joint conﬁdence region for the complete set of population parameters.<br>
There are options that allow the variance-covariance matrix to be computed as either<br>2*Rinv or 4*Sinv. Asymptotic statistical theory suggests that these matrices are appropri-<br>ate under the additional assumption that the objective function is indeed additively pro-<br>portional to minus twice the log likelihood function for the data.<br>
Unless the reported number of signiﬁcant digits in the ﬁnal parameter estimate is at least<br>as large as the requested number of signiﬁcant digits, the Covariance Step will not be<br>implemented. (See <b>sig digits</b>). Sometimes, the number of signiﬁcant digits is not<br>reportable. However, when it is and the user thinks this number to be adequate, and a<br>model speciﬁcation ﬁle was output (See <b>model speciﬁcation ﬁle</b>), NONMEM may be<br>run again where the Covariance Step is implemented, while the Estimation step is is not<br>repeated (i.e. the MAXEVAL option is set to 0). With the subsequent run, the model speci-<br>ﬁcation ﬁle should be input, and the requested number of signiﬁcant digits should be set<br>to a value less than the reported number of signiﬁcant digits from the ﬁrst run (presum-<br>ably, this value would be the reported number rounded down to the highest integral<br>value).<br>
(See <b>standard error</b>, <b>correlation matrix of estimate</b>).<br>
REFERENCES: Guide I, section C.3.5.2<br>REFERENCES: Guide II, section D.2.5<br>REFERENCES: Guide V, section 5.4 , 13.3<br>
339<br>
<hr>
<A name=345></a>CRIT DETAILED DESCRIPTIONS<br>
Help Guide<br>
CRIT<br>
MEANING: CRIT subroutine<br>CONTEXT: User-supplied subroutine; replaces a NONMEM routine<br>
USAGE:<br>SUBROUTINE CRIT (ICALL,J,N,WRES,V)<br>
USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER(KIND=ISIZE), INTENT(IN)<br>
:: J,N<br>
INTEGER(KIND=ISIZE), INTENT(IN)<br>
:: ICALL<br>
REAL(KIND=DPSIZE), INTENT(OUT)<br>
:: V<br>
REAL(KIND=DPSIZE), INTENT(IN)<br>
:: WRES(*)<br>
END SUBROUTINE CRIT<br>
DISCUSSION:<br>The CRIT subroutine is used to modify the NONMEM objective function used with the<br>First-Order (or the Extended Least Squares) Estimation method. This objective function<br>may be regarded as being the sum of contributions computed from each individual record.<br>The ﬁrst term in the contribution from an individual record is independent of data, but the<br>second term in the contribution is the sum of the squared weighted residuals for the data<br>in the record. The weights are functions of the model parameters and are obtained so that<br>with a given set of parameter values, assumed to be the true parameter values, each<br>weighted residual has unit variance and all the weighted residuals are mutually uncorre-<br>lated. With the CRIT routine, a function of the weighted residuals other than the sum of<br>their squares may be substituted for the second term. The function may vary between<br>individual records. The CRIT routine is called by NONMEM with one individual record<br>after another (individual records without observations are skipped).<br>
Input argument:<br>
ICALL<br>
Similar to ICALL for PRED subroutine.<br>0 - First call to CRIT in the run<br>1 - First call to CRIT in the current problem<br>2 - Computation of function value required<br>
J<br>
Number of individual record<br>
N<br>
Number of observations in the individual record<br>
WRES<br>
Vector of weighted residuals (as many residuals as there are observations)<br>
Output argument:<br>
V<br>
Value of function<br>
Note: When a user CRIT is supplied, NONMEM subroutine CELS may not be called.<br>
REFERENCES: Guide II, section C.6 , Figure 8<br>
REFERENCES: Guide III, section V.5.0<br>REFERENCES: Guide IV, section III.B.6<br>
340<br>
<hr>
<A name=346></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CTLO<br>
CTLO CTUP PROBABILITY: PR CT<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_REAL, ONLY PR_CT<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: PR_CT<br>
DISCUSSION:<br>
When with a given data record, either of the limits CTLO or CTUP are set, thus deﬁning<br>an interval of values comprising one of several categories equated with the possible val-<br>ues of a potential observation, then during a copying pass (and during ICALL=5 and 6),<br>PR_CT is the estimated probability that an observation will be of the category in ques-<br>tion.<br>(See <b>CTLO</b>, <b>CTUP</b>)<br>(See <b>copying_block</b>, <b>expectation</b>, <b>data_average</b>)<br>
If the mean and variance of the intra-individual model for a potential observation are<br>speciﬁed, and if the limits CTLO or CTUP are set, a value of PR_CT will be computed,<br>whether the record has MDV=0 or MDV=1. If neither CTLO nor CTUP are set, the<br>value PR_CT will be 1.<br>
PR_CT may be used as a right-hand quantity in abbreviated code for $PRED, $PK,<br>$ERROR, and $INFN blocks.<br>
Location prior to NONMEM 7: rocm45<br>
REFERENCES: None.<br>
341<br>
<hr>
<A name=347></a>CTLO DETAILED DESCRIPTIONS<br>
Help Guide<br>
CTLO<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPR_REAL, ONLY:CTLO=&gt;CTLW,DCTLO=&gt;DCTLW,DDCTLO=&gt;DDCTLW<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: CTLW,DCTLW(LVR),DDCTLW(LVR,LVR)<br>
DISCUSSION:<br>An observation may be the event that the value of a normally distributed variable falls in<br>a giv en interval. The likelihood for this event may be automatically computed. With the<br>data record containing the observation, one speciﬁes the mean and variance of the vari-<br>able for NONMEM, as usual, and one sets CTLO to the lower endpoint of the interval. If<br>with population data, this endpoint depends on an eta variable, then the ﬁrst- and second-<br>derivatives of the endpoint with respect to etas should also be set. Derivatives equal to 0<br>need not be explicitly set, and the only elements of DDCTLO that need be set are those in<br>the lower triangle. CTLO may be set in a $PRED or $ERROR abbreviated code, and<br>then NM-TRAN automatically sets the derivatives. NONMEM can detect when CTLO is<br>not set. When CTLO is set, the Laplacian estimation method must be used.<br>
CTUP may be used in conjunction with CTLO.<br>(See <b>ctup</b>).<br>
PR_CT is the estimated probability that an observation will be of the category in ques-<br>tion.<br>(See <b>pr_ct</b>, <b>CTLO_CTUP_Probability:_PR_CT</b>).<br>
Limitation:<br>May not be used with the LIKELIHOOD or -2LOGLIKELIHOOD options.<br>
Location prior to NONMEM 7: nmpr13<br>
REFERENCES: None.<br>
342<br>
<hr>
<A name=348></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
CTUP<br>
CTUP<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPR_REAL, ONLY CTUP,DCTUP,DDCTUP<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: DPSIZE,LVR<br>
REAL(KIND=DPSIZE) :: CTUP,DCTUP(LVR),DDCTUP(LVR,LVR)<br>
DISCUSSION:<br>An observation may be the event that the value of a normally distributed variable falls in<br>a giv en interval. The likelihood for this event may be automatically computed. With the<br>data record containing the observation, one speciﬁes the mean and variance of the vari-<br>able for NONMEM, as usual, and one sets CTUP to the upper endpoint of the interval. If<br>with population data, this endpoint depends on an eta variable, then the ﬁrst- and second-<br>derivatives of the endpoint with respect to etas should also be set. Derivatives equal to 0<br>need not be explicitly set, and the only elements of DDCTUP that need be set are those in<br>the lower triangle. CTUP may be set in a $PRED or $ERROR abbreviated code, and then<br>NM-TRAN automatically sets the derivatives. NONMEM can detect when CTUP is not<br>set. When CTUP is set, the Laplacian estimation method must be used.<br>
CTLO may be used in conjunction with CTUP.<br>(See <b>ctlo</b>).<br>
PR_CT is the estimated probability that an observation will be of the category in ques-<br>tion.<br>(See <b>pr_ct</b>, <b>CTLO_TUP_Probability:_PR_CT</b>).<br>
Limitation:<br>May not be used with the LIKELIHOOD or -2LOGLIKELIHOOD options.<br>
Location prior to NONMEM 7: nmpr14<br>
REFERENCES: None.<br>
343<br>
<hr>
<A name=349></a>DATA AVERAGE DETAILED DESCRIPTIONS<br>
Help Guide<br>
DATA AVERAGE BLOCK<br>
MEANING: Abbreviated code for computation of raw-data-averages<br>CONTEXT: Abbreviated code<br>
SAMPLE:<br>
$ERROR<br>
IF (ICALL.EQ.6) THEN<br>
... data average block ...<br>
ENDIF<br>
DISCUSSION:<br>A data average block is a block of abbreviated code that is only executed when<br>ICALL=6. This value of ICALL occurs when the raw-data-average (RAW_) data item is<br>deﬁned in the data set and has a non-zero value for some records. Data average blocks<br>are not required when the raw-data-average data item is present, but they allow the user<br>additional functionality. Such blocks may be present in $PRED and $ERROR. If for a<br>given observation record matching a template record, a data average block sets the DV<br>variable to a value different from the one in the record, this value is the one included in<br>the average.<br>
In this example, the displayed DV value for each template record is the proportion of DV<br>items greater than 10 on those records matching the template record.<br>
Y=...<br>
TRDV=DV<br>
IF (ICALL.EQ.6) THEN<br>
DV=0<br>
IF (TRDV.GT.10) DV=1<br>
ENDIF<br>
PRED may return a value of 1 in F, indicating that the DV item in the record is not to be<br>included in the average. Continuing the above example, suppose that the DV variable is<br>set to a value only when it exceeds 2, so that the average is the proportion of observations<br>exceeding 10 among those that exceed 2. The code is as follows. See note 2 below on<br>the returned value of F.<br>
Y=...<br>
TRDV=DV<br>
IF (ICALL.EQ.6) THEN<br>
IF (TRDV.LE.2) Y=1<br>
DV=0<br>
IF (TRDV.GT.10) DV=1<br>
ENDIF<br>
When ICALL=6, PRED and ERROR are called with successive records as usual. How-<br>ev er, with each observation record, all output from these routines other than a value set<br>for the DV data item and values set for PRED-deﬁned (ERROR-deﬁned) items V used in<br>a table or scatterplot and located in the SAVE region (See <b>save_region </b>(and the F value,<br>in so far as it is or is not 1) is ignored. In the same way that an average is formed for the<br>DV, averages are formed for the elements of V. Upon entry into PRED or ERROR with a<br>given record, the value of the DV item is the one on the record, and the values for V are<br>the values that will be used in a table and/or scatterplot. If PRED or ERROR changes one<br>of these values, the new value is the one used in the average. If a value is not changed,<br>
344<br>
<hr>
<A name=350></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DATA AVERAGE<br>
the unchanged value is used in the average. (For a nonobservation record, the output<br>from that record is completely ignored.)<br>
The following series of examples concern taking averages of PRED-deﬁned items. They<br>involve a mixture model, where, under each of the subpopulations, there is a parameter<br>PA whose value depends on an eta. There is a template record.<br>
Example A.<br>
Suppose ﬁrst that PA does not depend on (interindividually-varying) covariate values.<br>Suppose moreover, that during copying passes, with each individual record a value of the<br>quantity Q=P1*PA1+P2*PA2+P3*PA3 has been computed and stored in the SAVE<br>region. Here, the P’s are the mixture probabilities, and the PA’ s are conditional estimates<br>of PA under the different models for the different subpopulations. Due to the presence of<br>the template record, at ICALL=6, the average of Q across the eta estimates (from individ-<br>uals with the same covariate values as are contained in the template record) will be com-<br>puted - without any need for a data average block. More precisely, at ICALL=6 a pass<br>through the data set occurs, during which a value of Q is obtained with each of the obser-<br>vation records that match the template record. However, the average of the Q values is an<br>av erage of within-individual averages, and since Q does not vary within an individual<br>record, the within-individual average computed for that record is the same value of Q as<br>is obtained with each of the observation records of the individual record (matching the<br>template record). The resulting average of the Q values is an estimate of the expected<br>value of PA over the subpopulations and the randomly-varying PA’ s.<br>
Example B.<br>
Suppose that PA depends on a covariate X<br>E.g. PA=THETA(1)*X**THETA(2)*EXP(ETA(1)),<br>and that one is interested in an estimate of the expected value of PA for X=x. Suppose<br>also that the value for X in the template record is x. Once again, suppose that during<br>copying passes, with each individual record a value of Q has been computed and stored in<br>the SAVE region - using whatever value of X appears in the individual record. At<br>ICALL=6, if <i>and only if </i>the observation records within an individual record have the<br>value X=x and match the template record with respect to the other relevant data items,<br>will the within-individual average be included in the average Q. Moreover, these obser-<br>vation records are the very ones whose value for Q is of interest.<br>
Example C.<br>
However, under a well-specifed model, ETA(1) should be independent of X, and so one<br>might want to use an average of Q across the eta estimates from <i>all </i>individuals (with<br>observation records). Then one might (i) during copying passes, for each individual<br>record compute Q using the speciﬁc value X=x - regardless of what value of X appears in<br>the individual record, and (ii) include the record<br>
$OMIT X<br>
to prevent the values of X from affecting the match with the template record.<br>
Example D.<br>
The strategy in example C fails if it is necessary to match on X for the purpose of form-<br>ing averages other than the average Q, and it is at least awkward if one is interested in the<br>expected value of PA for a variety of values of X. Here is an alternative strategy.<br>
345<br>
<hr>
<A name=351></a>DATA AVERAGE DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ABB COMRES=4 COMSAV=4<br>
$ERROR<br>
...<br>
Y=...<br>
IF (COMACT.EQ.2) THEN<br>
IF (MIXNUM.EQ.1) COM(1)=ETA(1)<br>
IF (MIXNUM.EQ.2) COM(2)=ETA(2)<br>
IF (MIXNUM.EQ.3) COM(3)=ETA(3)<br>
ENDIF<br>
IF (ICALL.EQ.6) THEN<br>
PA1=THETA(1)*TEMPLT(X)**THETA(2)*EXP(COM(1))<br>
PA2=THETA(1)*TEMPLT(X)**THETA(2)*EXP(COM(2))<br>
PA3=THETA(1)*TEMPLT(X)**THETA(2)*EXP(COM(3))<br>
COM(4)=MIXP(1)*PA1+MIXP(2)*PA2+MIXP(3)*PA3<br>
ENDIF<br>
$TABLE COM(1) COM(2) COM(3) NOPRINT FILE=junk<br>
$TABLE ID ... COM(4) ...<br>
During the copying passes, the values of the eta estimates are stored (in items COM(1),<br>COM(2) and COM(3) of the SAVE region) rather than the value of Q. The ﬁrst table<br>record appears because unless the items COM(1), COM(2), and COM(3) are displayed, at<br>ICALL=6 their values are 0. TEMPLT(X) refers generically to the value of X on the tem-<br>plate record (see Special Rule 4 below); so there can be numerous template records with<br>different values of X.<br>
Example E.<br>
Examples A-C are not explicit about how the mixture probabilities are computed. They<br>might be obtained via MIXP, in which case during the copying passes (similar to what<br>happens at ICALL=6 with example D), with a given individual record, they are the proba-<br>bilities pertaining to that record. As long as the mixture probabilities do not depend on<br>interindividual-varying covariates, the mixture probabilities are the same no matter what<br>individual record it is to which they pertain. But if the probabilities depend on interindi-<br>vidual-varying covariates, and especially if one wants to estimate the expected value of Q<br>for numerous different sets of values for these covariates, then one might use:<br>
$ERROR<br>
include nonmem_reserved_general<br>
Y=...<br>
IF (COMACT.EQ.2) THEN<br>
IF (MIXNUM.EQ.1) COM(1)=ETA(1)<br>
IF (MIXNUM.EQ.2) COM(2)=ETA(2)<br>
IF (MIXNUM.EQ.3) COM(3)=ETA(3)<br>
ENDIF<br>
IF (ICALL.EQ.6) THEN<br>
PA1=THETA(1)*TEMPLT(X)**THETA(2)*EXP(COM(1))<br>
PA2=THETA(1)*TEMPLT(X)**THETA(2)*EXP(COM(2))<br>
PA3=THETA(1)*TEMPLT(X)**THETA(2)*EXP(COM(3))<br>
COM(4)=MIXPT(1)*PA1+MIXPT(2)*PA2+MIXPT(3)*PA3<br>
ENDIF<br>
346<br>
<hr>
<A name=352></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DATA AVERAGE<br>
The mixture probabilities found in MIXPT pertain to the individual record containing the<br>template record (see Special Rule 7 below). Because they hav e been computed using the<br>covariate values in that record, they are commensurate with the way PA has been com-<br>puted for the different subpopulations. With versions prior to NONMEM 7.3, the proba-<br>bilities in MIXPT must be referenced via verbatim code (note the double quotes).<br>
$ERROR<br>
&quot; USE ROCM_REAL MIXPT=&gt;MIXP_RAW<br>
...<br>
&quot;<br>
COM(4)=MIXPT(1)*PA1+MIXPT(2)*PA2+MIXPT(3)*PA3<br>
Special rules apply to data average blocks and passes through the data with ICALL=6.<br>
1) No eta derivatives are computed in a data average block.<br>
2) A RETURN statement may be used in a data average block. If Y= appears (i.e. Y is<br>
assigned a value) in a data average block before the RETURN (not necessarily in the<br>same block containing the RETURN), then F is set to Y (F=Y); otherwise F is set to<br>to 0 (F=0). If there is no RETURN statement in a data average block, then as usual,<br>F is set to the value of Y assigned by the time PRED (ERROR) exits.<br>
3) Loops are permitted in a data average block. The syntax is as follows.<br>
DO WHILE (condition)<br>
.. statements ..<br>
END DO<br>
4) During calls with ICALL=6, the template data record is found in NONMEM global<br>
variable TEMPLT. Items in the template data record may be referred to in abbrevi-<br>ated code of the data average block by position or by label, e.g., TEMPLT(1) or<br>TEMPLT(ID).<br>
5) During calls with ICALL=6, the repetition feature may not be used.<br>
6) If a mixture model is used, then during calls with ICALL=6, both MIXNUM and<br>
MIXEST are the index of the subpopulation into which the individual (whose data<br>record is being passed) has been classiﬁed.<br>
7) If a mixture model is being used, then during calls with ICALL=6, (the ﬁnal esti-<br>
mates of) the mixture probabilities associated with the individual record containing<br>the template record are found in NONMEM global variable MIXPT. Code that uses<br>these probabilities must be verbatim code.<br>
(See <b>raw_</b>).<br>(See <b>MIX CONTR: TEMPLT</b>)<br>(See <b>Mixture model: MIXPT</b>).<br>
REFERENCES: None.<br>
347<br>
<hr>
<A name=353></a>DATA ITEMS DETAILED DESCRIPTIONS<br>
Help Guide<br>
DATA ITEMS<br>
MEANING: The elements of a NONMEM Data Record<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>Each data record consists of a series of data items, the labels for which are deﬁned on the<br>$INPUT record. Data items are of three types: NONMEM items, PREDPP items, and<br>others. The ﬁrst two types are signiﬁed by certain reserved labels, such as (for NON-<br>MEM items): ID (for IDentiﬁcation), MDV (for Missing Dependent Variable), or DV (for<br>Dependent Variable). NONMEM prints the labels of the data items in the order it under-<br>stands them to appear on the data records as a check for the user.<br>
LABELS TO BE USED FOR ITEMS APPEARING IN TABLES AND SCATTERPLOTS ARE:<br>
ID TIME DV AGE<br>
WT PRED RES<br>
WRES<br>
The above states that the ﬁrst data item is ID (NONMEM item), the second is TIME (a<br>PREDPP item), the third is DV (a NONMEM item), then AGE and WT, which are other<br>items, and ﬁnally PRED, RES and WRES, which are NONMEM-generated items — the<br>predicted value of DV, the residual (DV-PRED), and the weighted residual (a transforma-<br>tion of RES to units of the population standard deviation).<br>
(See <b>data record</b>, <b>data set</b>).<br>
REFERENCES: Guide IV, section III.B.2<br>
348<br>
<hr>
<A name=354></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DATA RECORDS<br>
DATA RECORDS<br>
MEANING: Organized elements of a NONMEM Data Set<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>A NONMEM data set consists of a series of data records; each data record, in turn, con-<br>sists of a series of data items, the names of which are deﬁned on the $INPUT record.<br>NONMEM counts the data records and displays this count in its output as a check for the<br>user. This count is of logical records as read by a FORTRAN format speciﬁcation, which<br>is also displayed in the output. If the format speciﬁcation contains no slash (/) characters<br>(which denote the start of a new FORTRAN record), then each logical record corresponds<br>to a FORTRAN record.<br>
NO. OF DATA RECS IN DATA SET:<br>
394<br>
(See <b>data item</b>, <b>data set</b>).<br>
REFERENCES: Guide IV, section II.C<br>
349<br>
<hr>
<A name=355></a>DATA SET DETAILED DESCRIPTIONS<br>
Help Guide<br>
DATA SET<br>
MEANING: The data to be analyzed by NONMEM<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>&quot;Data set&quot; refers to all of the data (from all of the individuals) that is to be used in the<br>NONMEM analysis. NONMEM is aware of certain features of the data. NONMEM lists<br>what it knows about the data set as a check for the user.<br>
DATA SET LOCATED ON UNIT NO.:<br>
2<br>
THIS UNIT TO BE REWOUND:<br>
NO<br>
NO. OF DATA RECS IN DATA SET:<br>
394<br>
NO. OF DATA ITEMS IN DATA SET:<br>
8<br>
ID DATA ITEM IS DATA ITEM NO.:<br>
1<br>
DEP VARIABLE IS DATA ITEM NO.:<br>
4<br>
The above states that the data set is associated with a ﬁle on FORTRAN logical unit 2.<br>The rewind feature (&quot;UNIT TO BE REWOUND ...&quot;) is of interest only if this is not the<br>ﬁrst problem of the NONMEM run. The other lines report how many records were read,<br>the number of data items on each record, and the index order of the two NONMEM data<br>items, ID (identiﬁcation) and DV (dependent variable).<br>
(See <b>data record</b>, <b>data item</b>).<br>
REFERENCES: Guide IV, section III.B.2<br>
350<br>
<hr>
<A name=356></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DATE<br>
DATE DAT A ITEM<br>
MEANING: Date (DATE) data item for NM-TRAN<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... DATE[=DROP] ...<br>
DISCUSSION:<br>DATE, DAT1, DAT2, and DAT3 are labels for the date data item. The date data item is<br>optional. When it is present, NM-TRAN performs time translation for the time data item<br>(to relative times starting at 0), whether or not any time values contain the character &quot;:&quot;.<br>
The label given to the date data item describes its format:<br>
DATE month day year<br>DAT1 day month year<br>DAT2 year month day<br>DAT3 year day month<br>
When the date represents a calendar date, components are separated by any nonnumeric<br>character, such as - or / (e.g., 12-3-90 or 12/3/90). DATE=DROP should be speciﬁed in<br>this case because the NONMEM data set must not contain non-numeric characters.<br>
If only one component is present, it is assumed to be the day (and it may be 0 or nega-<br>tive). If two components are present, they are assumed to be the day and month, and they<br>must not exceed 31 and 12, respectively.<br>
EXAMPLE:<br>
NM-TRAN data set<br>
NONMEM data set<br>
ID DATE<br>
TIME ID<br>
TIME<br>
---- ----<br>
---- ----<br>
----<br>
1<br>
10-1-86 9:15<br>
1<br>
0.00<br>
1<br>
10-1-86 14:40<br>
1<br>
5.42<br>
1<br>
10-2-86 8:30<br>
1<br>
23.25<br>
2<br>
10-12 8<br>
2<br>
0.00<br>
2<br>
10-14 10<br>
2<br>
50.00<br>
If present, the year component may consist of one to four digits. The value of NM-<br>TRAN’s LAST20 constant determines the assumed century of one and two digit years:<br>1900’s or 2000’s (See <b>last20</b>).<br>
REFERENCES: Guide IV, section II.C.2 , III.B.2<br>
351<br>
<hr>
<A name=357></a>DDEXPAND DETAILED DESCRIPTIONS<br>
Help Guide<br>
DDEXPAND<br>
MEANING: DDEXPAND program<br>CONTEXT: NONMEM run<br>
USAGE:<br>
..\util\ddexpand<br>
&lt; original.ctl &gt; new.ctl<br>
DISCUSSION:<br>With NONMEM 7.4, The utility program ddexpand in the ..\util directory will expand an<br>NM-TRAN template control stream to propagate and incorporate delay differential equa-<br>tions (dde).<br>
Example:<br>
ddexpand dde3.dde dde3.ctl<br>
The destination ﬁle dde3.ctl will be produced, and a ﬁnedata control stream ﬁle (ﬁne.ftl)<br>will be produced and submitted to ﬁnedata utility to add extra doses to the data ﬁle identi-<br>ﬁed in the dde3.dde control stream.<br>
For details and examples,<br>See <b>INTRODUCTION TO NONMEM 7: ddexpand Utility Program</b><br>
REFERENCES: Guide Introduction_7<br>
352<br>
<hr>
<A name=358></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DEFAULT<br>
DEFAULT COMPARTMENT<br>
MEANING: Default compartments for kinetic models with PREDPP<br>CONTEXT: NONMEM data set<br>
DISCUSSION:<br>
The prediction computed by PREDPP is a scaled drug amount in some compartment<br>
called the observation compartment. Every dose is input into some dose compartment.<br>
With every kinetic model there are designated a default observation compartment and a<br>default dose compartment. For some kinetic models, these designations are built into the<br>model deﬁnition; for others, these designations are given by the user in the user subrou-<br>tine MODEL (or in $MODEL abbreviated code).<br>
Unless otherwise speciﬁed on an observation event record by means of the compartment<br>data item (CMT), the observation compartment is taken to be the default observation<br>compartment. Unless otherwise speciﬁed on a dose event record by means of the com-<br>partment data item, the dose compartment is taken to be the default dose compartment.<br>
The models for which default designations are built-in are listed here. The numbers are<br>the compartment numbers.<br>
Model Default dose compartment<br>
Default observation compartment<br>
ADVAN1 1<br>
1<br>
ADVAN2 1<br>
2<br>
ADVAN3 1<br>
1<br>
ADVAN4 1<br>
2<br>
ADVAN10 1<br>
1<br>
ADVAN11 1<br>
1<br>
ADVAN12 1<br>
2<br>
(See <b>cmt</b>, <b>$model</b>, <b>model</b>).<br>
REFERENCES: Guide VI, section V.H , VI.B , VII.C<br>REFERENCES: Guide IV, section V.C.4<br>
353<br>
<hr>
<A name=359></a>DES DETAILED DESCRIPTIONS<br>
Help Guide<br>
DES AES: ICALL,IDEFD,IDEFA<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: DES and AES routines<br>
USAGE:<br>USE PRMOD_INT, ONLY ICALL=&gt;ICALLD,IDEFD,IDEFA<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: ICALLD,IDEFD(2),IDEFA(2)<br>
DISCUSSION:<br>
ICALL<br>
Identical to the argument ICALL passed by NONMEM to PREDPP.<br>
IDEFD<br>
DES may set IDEFD when ICALL is 1, as follows.<br>
IDEFD(1) may optionally be set by DES to indicate how many thetas it uses. Set to<br>0 if none. Otherwise, set to the index of the highest numbered theta used.<br>IDEFD(1)=-9 means &quot;unknown&quot;. PREDPP determines from the value stored in<br>IDEFD(1) how many elements of theta to copy from its input argument THETA to<br>THETAS.<br>(See <b>DES_AES:_THETA</b>).<br>
When IDEFD(1) is set by DES to -9, PREDPP copies all thetas in the problem to<br>THETAS (See <b>DES AES: THETA</b>). With NM-TRAN, IDEFD(1) is set to -9 when<br>the $DES block contains verbatim code. If a user-written DES leaves IDEFD(1)<br>unchanged, it defaults to -9, which does no harm, but may cause the run to be slower<br>than necessary.<br>
IDEFD(2) The full/compact ﬂag for DES.<br>
DES sets this as follows:<br>IDEFD(2)=0 DES will return compact arrays.<br>IDEFD(2)=1 DES will return full arrays (the default).<br>
IDEFA<br>
AES may set IDEFA when ICALL is 1, as follows.<br>
IDEFA(1) is set by AES to indicate how many thetas it uses. See above remarks for<br>IDEFD and DES.<br>
IDEFA(2) Calling protocol for ADVAN9 and ADVAN15<br>
AES sets this as follows:<br>
IDEFA(2)=-1 &quot;call with every event record&quot; (the default)<br>IDEFA(2)=1 &quot;call once per individual record&quot;<br>
IDEFA(2) applies only when no TIME data item<br>is deﬁned. It is ignored when the TIME data item is deﬁned.<br>
Location prior to NONMEM 7: prdde1<br>
REFERENCES: None.<br>
354<br>
<hr>
<A name=360></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DES<br>
DES AES: ISFINL<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied DES and AES routines<br>
USAGE:<br>USE PROCM_INT, ONLY: ISFINL<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: ISFINL<br>
DISCUSSION:<br>
ISFINL<br>
When NONMEM is performing simulation or a copying pass (COMACT&gt;0), DES<br>and AES are called immediately after the advance to an event time or non-event<br>time, with a value of T equal to this time.<br>
ISFINL = 1 at such a call; otherwise =0.<br>
NM-TRAN includes this global variable in the DES or AES routine when the $DES or<br>$AES block includes references to variable ISFINL, or when verbatim code is present.<br>
Location prior to NONMEM 7: procmb<br>
REFERENCES: None.<br>
355<br>
<hr>
<A name=361></a>DES DETAILED DESCRIPTIONS<br>
Help Guide<br>
DES AES: THETA<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied DES, AES routines<br>
USAGE:<br>USE PROCM_REAL, ONLY: THETA=&gt;THETAS<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LTH,DPSIZE<br>
REAL(KIND=DPSIZE) :: THETAS(LTH)<br>
DISCUSSION:<br>
THETA<br>
The THETA vector passed as an argument by NONMEM to PRED, PK, ERROR.<br>IDEFD(1) and IDEFA(1) affect how many elements are copied.<br>(See <b>DES_AES:_ICALL,IDEFD,IDEFA</b>)<br>
Location prior to NONMEM 7: procm6<br>
REFERENCES: None.<br>
356<br>
<hr>
<A name=362></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DES<br>
DES<br>
MEANING: DES subroutine<br>CONTEXT: User-supplied subroutine; for use with PREDPP’s ADVAN 6,8,9,13,14,15<br>
USAGE:<br>
SUBROUTINE DES (A,P,T,DADT,IR,DA,DP,DT)<br>USE SIZES, ONLY: DPSIZE,ISIZE<br>INTEGER(KIND=ISIZE) :: IR<br>REAL(KIND=DPSIZE) :: A,P,DADT,DA,DP,DT<br>DIMENSION :: A(*),P(*),DADT(*),DA(IR,*),DP(IR,*),DT(*)<br>
DISCUSSION:<br>The DES subroutine is called by PREDPP to evaluate right-sides of differential equa-<br>tions.<br>
Input argument:<br>
A(n)<br>
The amount in the nth compartment at time T.<br>
P(n)<br>
The value of the nth PK parameter.<br>
T<br>
Time. T takes values continuously over an integration interval.<br>
Output argument:<br>
DADT(n)<br>
The derivative with respect to T of the nth compartment’s amount. It is important to<br>note that PREDPP itself adds in the rates for any infusions that may be active.<br>
It is possible to introduce drug into a compartment by explicit terms in a differential<br>equation, rather than by PREDPP dose event records. Drug introduced in this man-<br>ner is not included by PREDPP in the computation of the output compartment.<br>Speciﬁcally, the amount in the output compartment may be thought of as being cal-<br>culated by summing all relevant doses from the INPUT ﬁle (i.e., those that precede<br>the time of the present record, accounting for bioavailability), subtracting all<br>amounts present in compartments other than the output compartment, and then mul-<br>tiplying the result by the output fraction parameter.<br>
For example, suppose differential equations were used for ADVAN2, rather than the<br>analytic solution. They would be:<br>DADT(1)=-P(3)*A(1)<br>
DADT(2)= P(3)*A(1)-P(1)*A(2)<br>
DA(n,j)<br>
The derivative of DADT(n) with respect to A(j). Continuing the above example,<br>DA(1,1)=-P(3)<br>
DA(2,1)= P(3)<br>
DA(2,2)=-P(1)<br>
DP(n,j)<br>
The derivative of DADT(n) with respect to P(j). Continuing the above example,<br>DP(1,3)=-A(1)<br>
DP(2,3)= A(1)<br>
DP(2,1)=-A(2)<br>
357<br>
<hr>
<A name=363></a>DES DETAILED DESCRIPTIONS<br>
Help Guide<br>
DT(n)<br>
The derivative of DADT(n) with respect to T.<br>
The format of arrays DA, DP, DT described above is called &quot;full format&quot;. Alternately,<br>compact format may be used (See <b>prdde1</b>). It is the default format for these arrays. A<br>description of compact format is beyond the scope of this document, but is described in<br>the NONMEM 7.4 version of Guide VI, Appendix IV. Compact Arrays in DES.<br>
Also see variables in NONMEM modules, NONMEM-PRED modules, and PREDPP<br>modules.<br>(See <b>variables in modules</b>)<br>In particular,<br>(See <b>DES AES: ICALL,IDEFD,IDEFA</b>)<br>
REFERENCES: Guide IV, section V.C.7<br>REFERENCES: Guide VI, section VI.C<br>
358<br>
<hr>
<A name=364></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DIFF<br>
DIFF EQ SOLVER SETTINGS<br>
MEANING: PREDPP global variables<br>CONTEXT: For use with PREDPP<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of PREDPP code.<br>
USAGE:<br>$PK<br>
&quot;FIRST<br>
&quot; USE PRCOM_INT, ONLY: MITER,METH,IMAX,ISTFLG,INTFLG<br>
&quot;MAIN<br>
&quot; IMAX=200000<br>
DISCUSSION:<br>These variables allows the user to over-ride certain default settings in ADVAN6,<br>ADVAN8, ADVAN9, ADVAN13, ADVAN14, ADVAN15, SS6, and SS9.<br>
MITER and METH<br>
PREDPP sets MITER and METH to default values with every new individual or<br>reset record.<br>
ADVAN8<br>
Always use METH=2.<br>If user set MITER, use his value. Otherwise, use MITER=2.<br>
ADVAN9<br>
If user set METH, use MF=METH*10 in call to LSODI. Otherwise, use<br>MF=20<br>If user did not set MITER, then set MITER to 1 (if no population etas) or 2 (if<br>population etas).<br>If user did set MITER, use his value.<br>
ADVAN13<br>
METH set in $PK is not used. LSODA determines whether ADAMS NON-stiff<br>(METH=1) or BDF stiff (METH=2) is to be used as it works its way through<br>the problem.<br>MITER should be set only to 1 (analytical Jacobian) or 2 (numerical Jacobian<br>determined by LSODA). Usually should be left alone.<br>
ADVAN14<br>
METH=2 by default. Could be set in cvodeu.f90 or $PK.<br>MITER set in $PK should not be used. Instead, the various options of Jacobians<br>(analytical/numerical, full/band, etc) should be set in CVODEU.f90, where<br>there are many other things the user can set.<br>
ADVAN15<br>
METH is not used. It is always METH=2 (BDF stiff).<br>MITER set in $PK should not be used. Instead, the various options of Jacobians<br>(analytical/numerical, full/band, etc) should be set in IDAU.f90, where there<br>are many other things the user can set.<br>
IMAX<br>
359<br>
<hr>
<A name=365></a>DIFF DETAILED DESCRIPTIONS<br>
Help Guide<br>
ADVAN6, ADVAN8, ADVAN9, ADVAN13, ADVAN14, ADVAN15, SS6<br>
The variable MAXCAL gives the maximum number of calls to FCN1<br>(ADVAN6, ADVAN8, ADVAN13, ADVAN14, SS6) or RES (ADVAN9,<br>ADVAN15) during an integration interval.<br>Each of the above routines sets MAXCAL to the value given by MAXFCN (a<br>parameter in the MODULE SIZES) at the start of each integration interval<br>unless the user supplies a value in IMAX, in which case the user’s value is<br>used.<br>
ISTFLG<br>
ADVAN9 ADVAN15<br>
ISTFLG controls how ADVAN9 calls LSODI1 and what it does if LSODI1<br>returns and indicates that an integration failed. ISTFLG is set to 0 (default) at<br>ICALL=0. If changed by the user, it retains the changed value until the user<br>changes it again. ISTATE is a variable that is passed from the ADVAN to<br>LSODI1. ISTATE=1 indicates that the integration is starting. ISTATE=2 indi-<br>cates that this call is a continuation from a prior successful integration.<br>Default: Use ISTATE=1 for the ﬁrst integration, and ISTATE=2 for a continua-<br>tion when nothing external to the ADVAN has changed. In case of failure with<br>ISTATE=2, restore original inputs and try again with ISTATE=1.<br>
ISTFLG=1<br>
Never try ISTATE=2, always use ISTATE=1.<br>
ISTFLG=2<br>
Never retry (only try ISTATE=2).<br>
ADVAN15 also uses ISTFLG for calls to IDA, but uncertainty exists as to what its<br>usefulness is.<br>
INTFLG<br>
ADVAN6, SS6, ADVAN8, ADVAN13, ADVAN14<br>
INTFLG stands for &quot;Integration Flag&quot; and affects the number of calls to the integrat-<br>ing subroutine during each advance. It is only of interest when second derivatives of<br>the state vector are calculated.<br>
It is present because there may be some trade-off between run time and accuracy of<br>computation. More calls to the integrator, with a smaller number of derivatives<br>obtained with each call, result in longer run times, but might also produce more<br>accurate derivatives. Also, it might provide more consistent computations when the<br>number of compartments and/or etas is to be changed.<br>
Default is -1. User may set to any other value in user-written code (e.g., with verba-<br>tim code in $PK).<br>
PREDPP examines this value after the ﬁrst call to PK for an individual record, so<br>that it can be set on an individual-by-individual basis. PREDPP examines INTFLG<br>when NEWIND=0 or 1 (i.e., at the start of an individual’s data). Presumably, this is<br>the only time that NONMEM might change the LVOUT array (See <b>non-<br>active eta list for pred</b>).<br>
When INTFLG is set to any other value than -1, ADVAN 6,8,13,14 and SS6 calcu-<br>late second derivatives &quot;one group at a time&quot;.<br>
E.g., with ADVAN6, suppose etas 1, 2, 3 are active.<br>
360<br>
<hr>
<A name=366></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DIFF<br>
1) call DVERK to obtain 2nd derivatives 1,1<br>2) call DVERK to obtain 2nd derivatives 1,2 and 2,2<br>3) call DVERK to obtain 2nd derivatives 1,3 and 2,3 and 3,3<br>
(Each calculation involves the integration of the state vector, augmented by the<br>relevant ﬁrst derivative(s) and the second derivatives for one eta.)<br>
Thus, the maximum number of differential equations that would ever be inte-<br>grated at one time is<br>
PW=2*PE*PM+PM<br>
Where: (PE is the maximum number of etas; currently 10)<br>(PM is the maximum number of compartments - 1; currently 9)<br>PW is the size deﬁned for various work arrays in the source code.<br>It is currently deﬁned as above (189).<br>
When INTFLG is -1, the ADVAN routines and SS6 makes the most efﬁcient use of<br>the work arrays when computing second derivatives, to reduce the number of calls to<br>DVERK.<br>
At NEWIND=0 or 1, PREDPP looks at the number of active etas for this individual<br>and the number of user-deﬁned compartments deﬁned by the MODEL subroutine<br>(NCM), and creates a scheme to calculate as many groups of 2nd. derivatives at once<br>as it can. (Although compartments may be turned on and off within the data set,<br>PREDPP does not revise the scheme of integration each time.)<br>
E.g., with the current values of PE, PM, and PW, here are some schemes of<br>integration. Under &quot;nth. call&quot; are the etas whose second derivatives are com-<br>puted with that call to DVERK.<br>
# compts. 1st. call 2nd. call 3d. call 4th. call<br>
9<br>
etas 1 - 5<br>
etas 6 - 7 eta 8<br>
eta 9<br>
8<br>
etas 1 - 5<br>
etas 6 - 7 eta 8<br>
eta 9<br>
7<br>
etas 1 - 5<br>
etas 6 - 7 eta 8 - 9<br>
6<br>
etas 1 - 6<br>
etas 7 - 8 eta 9<br>
5<br>
etas 1 - 7<br>
etas 8 - 9<br>
4<br>
etas 1 - 8<br>
etas 9<br>
3<br>
etas 1 - 9<br>
Changing the size of the work arrays:<br>
If the system is large enough that integration involves more than one call to DVERK,<br>and the user would like all second derivatives to be computed with a single call to<br>DVERK, the source code must be changed to deﬁne a larger value for PW.<br>
To integrate the maximum number of etas and compartments in one call, set:<br>
PW=PM*(1+PE+PE*(PE+1)/2)<br>
With the current values of PE and PM, PW=594<br>
Suppose PW is changed, but by accident is made smaller than the default<br>(2*PE*PM+PM=189). Then for problems with large numbers of compartments<br>and/or etas, the work arrays will not be large enough, with either INTFLG=-1 or<br>INTFLG!=-1.<br>
A new error message exists in PREDPP, for which PRED exit code is 2 (always<br>abort).<br>
WORK ARRAYS ARE TOO SMALL FOR 2ND. DERIVS. INCREASE PW, OR<br>DECREASE NO. OF. COMPTS AND/OR ETAS, OR USE DERIV2=NO<br>
361<br>
<hr>
<A name=367></a>DIFF DETAILED DESCRIPTIONS<br>
Help Guide<br>
Again, this message cannot occur unless the source code of PREDPP is changed<br>incorrectly.<br>
Location prior to NONMEM 7: prcomg<br>
REFERENCES: None.<br>
362<br>
<hr>
<A name=368></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DISPLAYED<br>
DISPLAYED PRED-DEFINED ITEMS<br>
MEANING: Displayed values of PRED-Deﬁned Items<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>PRED-deﬁned items can be displayed in tables and scatterplots. (This includes PK-<br>deﬁned and ERROR-deﬁned items.) These items are computed and recomputed many<br>times during a NONMEM run, with various values of theta and eta. It is important to<br>know which values are used in the computation of the items as displayed.<br>
Consider this fragment of an NM-TRAN control stream:<br>
$PK<br>
CL=THETA(1)*EXP(ETA(1))<br>
$TABLE CL ETA(1)<br>
The values of ETA(1) and the PRED-deﬁned item CL that are displayed depend on which<br>task speciﬁcation records are present.<br>
Displayed values<br>
Task speciﬁcation records<br>
THETA<br>
ETA(1) CL<br>
none initial<br>
0<br>
typical<br>
$EST (or $MSFI) METH=0<br>
ﬁnal 0<br>
typical<br>
$EST (or $MSFI) METH=1 or POSTHOC<br>
ﬁnal conditional<br>
conditional<br>
(CPE) (CPE)<br>
$SIMULATION initial<br>
0<br>
typical<br>
$SIMULATION ... ONLYSIM initial<br>
simulated† simulated<br>
$NONPARAMETRIC ETAS ﬁnal<br>
nonparametric nonparametric<br>(CNPE) (CNPE)<br>
† Displayed etas are the simulated etas if the simulated etas are stored in common<br>NMPRD7. This is the case when NM-TRAN is used. If they are not stored in NMPRD7,<br>displayed etas are all 0.<br>
Displayed values of PRED, RES, and WRES are always computed with typical values of<br>parameters, except as noted below.<br>
Displayed values of DV are simulated values when $SIMULATION is present.<br>
With NONMEM 7, Additional types of PRED, RES, and WRES values may be requested<br>than the usual set available in NONMEM VI. They may be speciﬁed at any $TABLE<br>command or $SCATTER command, as one would request PRED, RES, or WRES items.<br>Such items are supplied internally by NONMEM, and in the case of L2 data, more accu-<br>rately. An example of their use is in Example #4a, below.<br>
Every NONMEM output report contains the line:<br>THE FOLLOWING LABELS ARE EQUIVALENT<br>Subsequent lines show the relationship of such items for the current Estimation method.<br>(See <b>$table</b>, <b>$scatter</b>).<br>(See <b>PRED,RES,WRES</b>).<br>See <b>INTRODUCTION TO NONMEM 7, $TABLE: Additional Statistical Diagnos-<br>tics, Associated Parameters, and Output Format</b><br>
Suppose that marginal items appear. If this item is 1 or 2 on a given record, the values of<br>PRED and any PRED-deﬁned displayed item D (assuming D <i>is not </i>in the SAVE region<br>
363<br>
<hr>
<A name=369></a>DISPLAYED DETAILED DESCRIPTIONS<br>
Help Guide<br>
(See <b>comsav</b>) associated with this record) are determined as follows:<br>
If the Simulation Step is implemented, and ONLYSIMULATION is speciﬁed, the<br>PRED item is the simulation expectation of F, over the simulated values of eta for all<br>the individuals in the data set (including those individuals with no observation<br>records), and the D item is the simulation expectation of the variable D.<br>
If conditional estimates are obtained (e.g. with the use of the POSTHOC option), the<br>PRED item is the posterior expectation of F, over the conditional estimates of eta for<br>all individuals in the data set (that have some observation records), and the D item is<br>the posterior expectation of the variable D.<br>
Otherwise, the PRED and D items are the same as with a marginal item of 0 (see<br>description above).<br>
Suppose that the raw-data items appear. If this is 1 on a given record, the values of the<br>DV, RES, and any PRED-deﬁned displayed item D (assuming D <i>is </i>in the SAVE region<br>(See <b>comsav</b>) associated with this record) are determined as follows:<br>
The data record serves as a template record. The DV item appearing in a table or<br>scatterplot is the raw-data-average of the values of DV in observation records match-<br>ing the template record. The RES item is the difference between the PRED item and<br>this average. A PRED-deﬁned item D is the average of the values of D obtained<br>with observation records matching the template.<br>
(See <b>mrg</b>, <b>raw</b>, <b>template</b>).<br>
Several examples will illustrate techniques for displaying (subject-speciﬁc) conditional<br>values, (non-subject-speciﬁc) typical values, and simulated values.<br>
#1 Display typical and conditional values using different variables:<br>
$PK<br>
...<br>
TVCL=THETA(1)<br>
CL=TVCL*EXP(ETA(1))<br>
$ESTIM ... POSTHOC ...<br>
$TABLE TVCL CL<br>
TVCL is a typical value by deﬁnition. CL is a conditional value.<br>
#2 Display typical and conditional values of the same variable:<br>
$PK<br>
...<br>
CL=THETA(1)*EXP(ETA(1))<br>
IF (COMACT.EQ.1) TVCL=CL<br>
$ESTIM ... POSTHOC ...<br>
$TABLE TVCL CL<br>
TVCL is a SAVE variable because it is deﬁned in a copying block. During the copying<br>pass with COMACT=1, it is set to the typical value of CL, because when COMACT=1,<br>etas are 0. Were the values of TVCL not stored in the SAVE region, then during the<br>copying pass to obtain values for tables and with COMACT=2, TVCL would retain its<br>value set with the previous data record.<br>The ﬁrst column of the table is labelled TVCL and contains the typical value of CL, and<br>the second column contains the conditional value.<br>
364<br>
<hr>
<A name=370></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DISPLAYED<br>
#3 Display typical and conditional values of the prediction, and the individual residual<br>and weighted residual values:<br>
$ERROR<br>
IPRED=F<br>
IRES=DV-IPRED<br>
IWRES=IRES/IPRED<br>
Y=F+EPS(1)<br>
$ESTIM ... POSTHOC ...<br>
$TABLE IPRED IRES IWRES<br>
The IPRED column contains the conditional value of F (&quot;individual prediction&quot;). (F is<br>not a left-hand quantity and cannot be speciﬁed in a $TABLE or $SCATTERPLOT<br>record.) The PRED column contains the typical value. The IRES column contains the<br>&quot;individual residual&quot;. The IWRES column contains a value which is proportional to (but<br>not equal to) the &quot;individual weighted residual&quot;.<br>
If predicted values of F may be zero, then division by zero can be avoided by code such<br>as the following.<br>
$ERROR<br>
IPRED=F<br>
IRES=DV-IPRED<br>
DEL=0<br>
IF (IPRED.EQ.0) DEL=1<br>
IWRES=(1-DEL)*IRES/(IPRED+DEL)<br>
Y=F+EPS(1)<br>
#4 Display intra-individual weighted residual:<br>
This uses the constant CV intraindividual error model, and allows one to display the<br>weighted intra-individual residual that is used during Estimation when the FOCE method<br>without interaction is used.<br>
$ERROR<br>
Y=F+F*EPS(1)<br>
IPRED=F<br>
IF (COMACT.EQ.1) FT=F<br>
IF (FT.NE.0) WR=(DV-IPRED)/FT/SQRT(SIGMA(1,1))<br>
IF (IPRED.NE.0) WR2=(DV-IPRED)/IPRED/SQRT(SIGMA(1,1))<br>
$ESTIM METHOD=COND<br>
$TABLE FT IPRED WR WR2<br>
IPRED is the conditional estimate of F.<br>FT is a SAVE variable because it is deﬁned in a copying block. During the copying pass<br>with COMACT=1, it is set to the typical value of F, because when COMACT=1, etas are<br>0. Were the values of FT not stored in the SAVE region, then during the copying pass to<br>obtain values for tables and with COMACT=2, FT would retain its value set with the pre-<br>vious data record.<br>WR is the weighted intraindividual residual with no eta-eps interaction. It is deﬁned in a<br>conditional assignment since it is possible that the typical value of F is zero with some<br>non-observation record. (With previous versions of the help guide the SIGMA term was<br>omitted and the WR was proportional to the weighted intraindividual residual.) It is a no-<br>interaction residual because the denominator term, the residual standard deviation<br>FT*SQRT(SIGMA(1,1)), represents the epsilon error, and uses the predicted value (FT)<br>evaluated with eta=0, that is, eta does not interact with the epsilon error. WR2 is the<br>conditional intra-individual weighted residual with eta-eps interaction. It is an eta-eps<br>
365<br>
<hr>
<A name=371></a>DISPLAYED DETAILED DESCRIPTIONS<br>
Help Guide<br>
interaction residual because the denominator term, the residual standard deviation<br>IPRED*SQRT(SIGMA(1,1)), represents the epsilon error, and uses the predicted value<br>(IPRED) evaluated with a non-zero eta, that is, eta interacts with the epsilon error.<br>
#4a Display intra-individual weighted residual using reserved variables<br>
With NONMEM 7, It is possible to obtain the same table more easily, as follows, using<br>the reserved residual variables CIWRES (=WR) and CIWRESI(=WR2) :<br>
$ERROR<br>
Y=F+F*EPS(1)<br>
$ESTIM METHOD=COND<br>
$TABLE IPRD CIPRED CIWRES CIWRESI<br>
#5 Display simulated values:<br>
$PK<br>
...<br>
CL=THETA(1)*EXP(ETA(1))<br>
...<br>
$SIMULATION (seed) ONLYSIM<br>$TABLE ETA(1) CL<br>
ETA(1) and CL are simulated values.<br>
#6 Display simulated and estimated values:<br>
$INPUT .... CLSM E1SM ...<br>
$PK<br>
...<br>
CL=THETA(1)*EXP(ETA(1))<br>
IF (ICALL.EQ.4) THEN<br>
CLSM=CL<br>
E1SM=ETA(1)<br>
ENDIF<br>
$SIMULATION (seed)<br>$ESTIM<br>
$TABLE CLSM E1SM CL ETA(1)<br>
Modiﬁcation of the data record during the simulation pass is the only way to save the<br>simulated values in the absence of ONLYSIM. Column 1 and 2 of the table are the simu-<br>lated values. Column 3 and 4 are the typical values.<br>
#7 Display conditional values of a variable in each of two mixture subpopulations:<br>
$PK<br>
...<br>
IF (MIXNUM.EQ.1) CL=<br>
...<br>
IF (MIXNUM.EQ.2) CL=<br>
...<br>
IF (COMACT.EQ.2) THEN<br>
IF (MIXNUM.EQ.1) CL1=CL<br>
IF (MIXNUM.EQ.2) CL2=CL<br>
ENDIF<br>
$ESTIM ... POSTHOC ...<br>
$TABLE CL1 CL2<br>
CL1 (and CL2) is a SAVE variable because it is deﬁned in a copying block. Were the<br>values for CL1 not stored in the SAVE region, during the copying pass to obtain values<br>for tables and with MIXNUM=2, CL1 would retain its value set with the previous data<br>record.<br>
366<br>
<hr>
<A name=372></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DISPLAYED<br>
#8 Display conditional values of a variable in the subpopulation into which the individual<br>is classiﬁed:<br>
$PK<br>
...<br>
IF (MIXNUM.EQ.1) CL=<br>
...<br>
IF (MIXNUM.EQ.2) CL=<br>
...<br>
IF (COMACT.EQ.2.AND.MIXNUM.EQ.MIXEST) CLE=CL<br>
$ESTIM ... POSTHOC ...<br>
$TABLE CLE<br>
CLE is a SAVE variable because it is deﬁned in a copying block. Were the values for<br>CLE not stored in the SAVE region, during the copying pass to obtain values for tables<br>and with MIXNUM&gt;MIXEST, CLE would retain its value set with the previous data<br>record.<br>
REFERENCES: Guide IV, section III.B.7 , IV.E.2<br>REFERENCES: Guide VI, section III.J , IV.E<br>REFERENCES: Guide Introduction_7<br>
367<br>
<hr>
<A name=373></a>DOEXPAND DETAILED DESCRIPTIONS<br>
Help Guide<br>
DOEXPAND<br>
MEANING: DOEXPAND program<br>CONTEXT: NONMEM run<br>
USAGE:<br>
..\util\doexpand<br>
&lt; original.ctl &gt; new.ctl<br>
DISCUSSION:<br>With NONMEM 7.4, The utility program doexpand augments abbreviated code in an<br>NM-TRAN control stream ﬁle that has been annotated with DOE (which stands for DO<br>expand) and ENDDOE (which stands for ENDDO expand) directives. This is useful for<br>repetitive code statements that differ only by increments of indices. For example, it is<br>useful for replicating derivative equations that differ only by their indices to DADT() and<br>A(). These may occur with time delay and transit compartment differential equations.<br>
For details and examples,<br>See <b>INTRODUCTION TO NONMEM 7: doexpand Utility Program</b><br>
REFERENCES: Guide Introduction_7<br>
368<br>
<hr>
<A name=374></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DOSE<br>
DOSE EVENT RECORD<br>
MEANING: Speciﬁcation of dose for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
DISCUSSION:<br>PREDPP recognizes two varieties of doses, transient and steady-state. Steady-state doses<br>are described separately (See <b>SS_dose_event</b>). Transient doses are described here.<br>
For a transient dose, the SS data item must be not deﬁned or must be zero. The ADDL<br>data item may be used to specify additional transient doses at regular intervals given by<br>II. The dose is introduced into a dose compartment n, which is deﬁned either explicitly in<br>the event record (by the value n&gt;0 of the CMT data item), or as the default compartment<br>for doses for the particular ADVAN (when the CMT data item is not deﬁned or contains<br>zero).<br>
Absorption lag applies to the initiating dose and to all subsequent additional doses. If an<br>absorption lag parameter is deﬁned by PK for the dose compartment (this parameter is<br>coded ALAGn in abbreviated code) and has a positive value, then the dose is referred to as<br>a &quot;lagged dose&quot; and it is actually introduced into the system at a &quot;lagged time&quot; equal to<br>the time at which the dose would ordinarily be introduced plus the value of the absorption<br>lag parameter. The value of ALAGn in effect at time T applies to the dose and to all sub-<br>sequent additional doses, even if ALAGn changes value with a subsequent event record.<br>
Bioavailability applies to the initiating dose and to all subsequent additional doses. A<br>bioavailability parameter may be deﬁned by PK for the dose compartment (it is coded Fn<br>in abbreviated code) and must have a positive value. If no such parameter is deﬁned, the<br>bioavailability parameter is assumed to have the value 1. The value of amount in the fol-<br>lowing discussion is the value of the AMT data item multiplied by the value of the<br>bioavailability parameter in effect at the time the dose is actually introduced. Changes in<br>the value of Fn at later times have no affect on past doses, e.g., infusions and zero-order<br>bolus doses that are already in progress are unaffected.<br>
The type of dose is described by the values of the AMT and RATE data items.<br>
AMT RATE<br>&gt;0 0<br>
Bolus dose.<br>The dose is introduced into the dose compartment at the event time<br>(before ERROR is called with the event record).<br>
&gt;0 &gt;0<br>
Infusion dose (&quot;regular infusion&quot;).<br>The infusion is started at the event time. Its duration is computed as<br>amount/RATE.<br>
&gt;0 -1,-2<br>
Zero-order bolus dose.<br>Similar to a regular infusion, except that the duration of a regular infu-<br>sion is speciﬁed by information in the dose event record and computed<br>by PREDPP itself, whereas the duration of a zero-order bolus dose is<br>regarded as a parameter which may be modeled and computed by the<br>user’s PK routine or $PK abbreviated code. The infusion is started at the<br>dose event time.<br>
369<br>
<hr>
<A name=375></a>DOSE DETAILED DESCRIPTIONS<br>
Help Guide<br>
If RATE=-2, the duration is computed by PK. The parameter is coded<br>Dn in abbreviated code, e.g., D1 models the duration of zero-order bolus<br>doses to compartment 1. The duration is given by the value of Dn as<br>computed by PK at the dose event time (or lagged time, if the dose is<br>lagged). Rate is computed as amount/duration and is thus ﬁxed for this<br>infusion, even if the value of Dn changes value with a later event record.<br>
If RATE=-1, the infusion rate is computed by PK. The parameter is<br>coded Rn in abbreviated code, e.g., R1 models the rate of zero-order<br>bolus doses to compartment 1. The rate which applies during the<br>advance from a particular state time to a later state time is given by the<br>value of Rn in effect for the the later time, and may change during the<br>course of the infusion. The duration at any state time is computed as<br>amount/rate, where amount represents the remaining dose amount and<br>rate represents the value of Rn at the state time. The infusion continues<br>until the entire dose amount has been introduced into the system.<br>
CAUTION: If PREDPP is used without using NM-TRAN as a preprocessor then any<br>user-supplied negative values for these data items will be passed to PREDPP. For a dis-<br>cussion of the circumstances such that the data ﬁle used by NONMEM and PREDPP is<br>FDAT A (in which case NM-TRAN has preprocessed it) or is the ﬁle named in the $DAT A<br>record, see NONMEM Users Guide, Part IV.<br>
(See <b>multiple dose example</b>, <b>exogenous supplementation example</b>).<br>
REFERENCES: Guide VI, section III.B.2 , V.F , V.G , V.H<br>
REFERENCES: Guide V, section 6.8<br>
REFERENCES: Guide IV, section III.B.5<br>
370<br>
<hr>
<A name=376></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DOSE<br>
DOSE RECORD: DOSREC<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied PK, DES, AES routines<br>
USAGE:<br>USE PROCM_REAL, ONLY: DOSREC<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: VSIZE,DPSIZE<br>
REAL(KIND=DPSIZE) :: DOSREC(VSIZE)<br>
DISCUSSION:<br>
DOSREC<br>
At a call to PK which occurs at a non-event dose time (i.e., at the time of an addi-<br>tional or lagged dose), DOSREC contains the (last data record of the) event record<br>describing the dose.<br>
When PK is called at an event time, DOSREC contains 0’s.<br>
(See <b>Dose Time Non-Event: DOSTIM</b>).<br>
Location prior to NONMEM 7: procm3<br>
REFERENCES: Guide VI, section III.I<br>
371<br>
<hr>
<A name=377></a>DOSE DETAILED DESCRIPTIONS<br>
Help Guide<br>
DOSE TIME NON-EVENT: DOSTIM<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied PK, DES, AES routines<br>
USAGE:<br>USE PROCM_REAL, ONLY: DOSTIM,DDOST,D2DOST<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: DOSTIM,DDOST(LVR),D2DOST(LVR,LVR)<br>
DISCUSSION:<br>
DOSTIM<br>
DOSTIM=0: this call to PK occurs at an event time. DDOST, D2DOST, and DOSREC<br>contain zeros.<br>
DOSTIM&gt;0: this call to PK occurs at a non-event dose time DOSTIM, i.e., at the<br>time of an additional or lagged dose. DDOST, D2DOST, and DOSREC contain val-<br>ues of interest. (See <b>Dose Record: DOSREC</b>).<br>
DDOST<br>
DDOST(i) = Partial derivative of DOSTIM with respect to eta(i).<br>
D2DOST<br>
D2DOST(i,j) = Second partial derivative of DOSTIM with respect to eta(i), eta(j)<br>(lower-triangular; j=1, ..., i).<br>
When DOSTIM&gt;0, TIME and all user (concomitant) data items in EVTREC are from the<br>next event record. All other NONMEM/PREDPP reserved data items are from the initiat-<br>ing dose event record. (The $BIND record may be used to override this; (See <b>bind</b>)<br>
Location prior to NONMEM 7: procm2<br>
REFERENCES: Guide VI, section III.I<br>
372<br>
<hr>
<A name=378></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DOWHILE<br>
DOWHILE BLOCK<br>
MEANING: Coding technique<br>CONTEXT: Abbreviated code<br>
DISCUSSION:<br>
SAMPLE:<br>$ABBR DECLARE DOWHILE ILOOP $PK<br>
ILOOP=1<br>
DOWHILE (condition)<br>
.. statements ..<br>
ILOOP=ILOOP+1<br>
ENDDO<br>
DISCUSSION:<br>
DOWHILE blocks allow loops in abbreviated code. Previously, they were permitted only<br>in initialization-ﬁnalization, simulation, data average, and expectation blocks. See the<br>separate descriptions of these blocks. With NONMEM 7.3, DOWHILE may also be used<br>in data-analytic blocks (i.e., in code that is executed at ICALL=2).<br>
When it is used in data-anlytic code, DOWHILE must be used with a looping variable.<br>Such a variable meets three criteria:<br>(1) It is declared as such, e.g.<br>$ABBR DECLARE DOWHILE ILOOP<br>(2) It is given a value in the statement immediately before DOWHILE<br>(3) It is given a value in the statement immediately before ENDDO.<br>
Usually, the looping variable will be tested in the condition, but this is not necessary.<br>
DOWHILE blocks may be nested.<br>
DOWHILE blocks may not include IF/THEN/ENDIF blocks. Only single-statement IF<br>statements are permitted. E.g.,<br>IF (condition) statement<br>
Subscripted variables may be used within the block. These are variables that have been<br>declared arrays using the $ABBR statement, or subscripted reserved variables such as<br>THETA. Subscripts may be integer expressions using declared integer variables and inte-<br>ger values. E.g.<br>$ABBR DECLARE X(10)<br>
$ABBR DECLARE DOWHILE ILOOP<br>
...<br>
$PK<br>
ILOOP=1<br>
DOWHILE (condition)<br>
X(ILOOP)=THETA(ILOOP+1)<br>
ILOOP=ILOOP+1<br>
ENDDO<br>
(See <b>abbreviated code</b>).<br>
A DOWHILE loop may compute recursive random variables. These are variables that are<br>modiﬁed recursively in a dowhile block and which have eta derivatives. For example,<br>
TERM=THETA(1)*EXP(ETA(1))<br>
SUM=0<br>
373<br>
<hr>
<A name=379></a>DOWHILE DETAILED DESCRIPTIONS<br>
Help Guide<br>
ILOOP=1<br>
DO WHILE(ILOOP&lt;=IMAX)<br>
SUM=SUM+TERM<br>
ILOOP=ILOOP+1<br>
ENDDO<br>
The dowhile recursive variable must be initialized to a non-random variable outside the<br>loop and must appear on both sides of the equal sign only once within the DOWHILE<br>loop: V= ... V ...<br>
The syntax is very limited. The following are not permitted:<br>ILOOP=1<br>
DO WHILE(ILOOP&lt;=IMAX)<br>
IF (ILOOP == 1) SUM=0<br>
; initialization within the loop<br>
SUM=SUM+TERM<br>
ILOOP=ILOOP+1<br>
ENDDO<br>
ILOOP=1<br>
DO WHILE(ILOOP&lt;=IMAX)<br>
IF (ILOOP == 1) THEN<br>
SUM=0 ; initialization within the loop<br>
ELSE ; else statement<br>
SUM=SUM+TERM<br>
ENDIF<br>
ILOOP=ILOOP+1<br>
ENDDO<br>
Although the example given is a summing loop, a product loop such as<br>
PROD=PROD*TERM<br>
is also possible, as are other ways the dowhile recursive variable can be used. The loop-<br>ing variable ILOOP may also be set and tested and incremented with different integers<br>than shown.<br>
EXAMPLES:<br>
Several examples are present in the examples directory:<br>
Auto-correlation (See ar1mod.ctl)<br>Auto-correlation with Simulation (See ar1newsim.ctl).<br>Dose Superposition (See sumdosetn.ctl)<br>Summing elements of THETA (See superid3_6.ctl)<br>
REFERENCES: None.<br>
374<br>
<hr>
<A name=380></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
DURATION<br>
DURATION PARAMETER<br>
MEANING: Duration (D) parameter for PREDPP<br>CONTEXT: Additional PK Parameters<br>
USAGE:<br>$PK<br>
D1= ....<br>
DISCUSSION:<br>
Duration parameters are used with PREDPP. They are optional additional PK parame-<br>ters. With NM-TRAN, they are symbolized in the $PK block by reserved variables Dn,<br>where n is the compartment number to which the parameter applies.<br>
There is one duration parameter associated with every possible dose compartment of the<br>kinetic model (the output compartment is not a possible dose compartment) and the dura-<br>tion parameter used for a given dose is that one associated with the compartment into<br>which the dose is given (the dose compartment).<br>
A duration-modeled zero-order bolus dose is actually an infusion, but one whose duration<br>is given by the rate parameter computed by the PK routine.<br>
Duration parameters are optional in the sense that duration parameters associated with<br>compartments never receiving duration-modeled zero-order bolus doses may be ignored.<br>However, if the RATE data item on some dose event record contains the value -2, then a<br>duration parameter for the dose compartment must be computed in the PK routine.<br>
A duration parameter is computed by the PK routine using, if needed, information in the<br>dose record. Therefore, its value for the given dose is constant over time.<br>
When additional doses are speciﬁed on a dose event record the duration parameter applies<br>to the dose and to all the additional doses.<br>
(See <b>cmt</b>, <b>rate</b>, <b>pk</b>, <b>$pk</b>, <b>default_compartment</b>). (See <b>multiple dose example</b>).<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide V, section 12.2.3<br>REFERENCES: Guide VI, section III.F.3<br>
375<br>
<hr>
<A name=381></a>DV DETAILED DESCRIPTIONS<br>
Help Guide<br>
DV AND MDV DAT A ITEMS<br>
MEANING: Dependent Variable (DV) and Missing Dependent Variable (DV) data items<br>for NONMEM<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... DV MDV ...<br>
DISCUSSION:<br>
DV and MDV label NONMEM’s dependent variable (DV) and missing dependent variable<br>(MDV) data items, respectively.<br>
The dependent variable (DV) data item is required by NONMEM. It is the observed<br>value associated with the data record.<br>
The missing dependent variable (MDV) data item is optional. If it is present, then the ID<br>data item must also be present.<br>
Values of MDV are:<br>
0<br>
The DV data item is an observed value, i.e., DV is not missing.<br>
1<br>
The DV data item is not regarded an observed value, i.e., DV is missing. The<br>DV data item is ignored.<br>
100<br>
Same as MDV=0, but this record is ignored during Estimation and Covariance<br>Steps. During other steps, MDV will changed to 0.<br>
101<br>
Same as MDV=1, but this record is ignored during Estimation and Covariance<br>Steps. During other steps, MDV will changed to 1.<br>
Reserved variables MDVI1, MDVI2, MDVI3 can be used to override values of<br>MDV&gt;100. These variables are deﬁned in include ﬁle nonmem_reserved_gen-<br>eral, which needs to be copied from util to the present run directory so<br>NMTRAN has access to it.<br>
With PREDPP, event records whose types are dose, other-type, reset, or reset-dose (i.e.,<br>which have EVID values 1, 2, 3, 4) must all have MDV=1. NM-TRAN will append the<br>MDV data item if PREDPP is used and MDV is not present on the $INPUT record.<br>
(See <b>observation records</b>).<br>
REFERENCES: Guide I, section B.1 , C.4.3<br>REFERENCES: Guide VI, section II , V.A<br>REFERENCES: Guide IV, section III.B.2 , V.B<br>
376<br>
<hr>
<A name=382></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ELS<br>
ELS<br>
MEANING: ELS subroutine<br>CONTEXT: NONMEM utility routine<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>USE SIZES,<br>
ONLY:: ISIZE,DPSIZE,NO<br>
...<br>
INTEGER(KIND=ISIZE) :: IER1,IER2<br>
REAL(KIND=DPSIZE) :: CNT,D<br>
DIMENSION :: D(NO,2)<br>
...<br>
CALL ELS (CNT,D,IER1,IER2)<br>
DISCUSSION:<br>ELS is a NONMEM utility routine. It computes the Extended Least Squares contribution<br>to the objective function for the data from a single individual (&quot;L1&quot;) record. It may be<br>called by CONTR or SPTWO.<br>
Output argument:<br>
CNT<br>
Contribution to -2log likelihood for data from the L1 record as computed by<br>extended least squares.<br>
D(J,1)<br>
value of RES for Jth observation record of the L1 record when called by SPTWO;<br>otherwise 0.<br>
D(J,2)<br>
value of WRES for Jth observation record of the L1 record when called by SPTWO;<br>otherwise 0.<br>
IER1<br>
=0 - Normal return.<br>&gt;1 - Abnormal return.<br>
IER2<br>
undocumented error return code.<br>
ELS obtains all its inputs from NONMEM read-only variables.<br>
Certain NONMEM error messages refer to ELS, for example:<br>
PROGRAM TERMINATED BY OBJ, ERROR IN ELS<br>
WITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)<br>
VAR-COV OF DATA FROM INDIVIDUAL RECORD ESTIMATED TO BE SINGULAR<br>
A common situation giving rise to this message is the use of a proportional intra-individ-<br>ual error model while some predicted values for actual observations are zero or close to<br>zero. (For example, if the ﬁrst dose is an infusion and there is a &quot;base- line&quot; observation<br>at the start of the infusion, the predicted level will be zero.)<br>
REFERENCES: Guide I, section C.1<br>REFERENCES: Guide V, section 5.2.2<br>
377<br>
<hr>
<A name=383></a>ERROR DETAILED DESCRIPTIONS<br>
Help Guide<br>
ERROR<br>
MEANING: ERROR subroutine<br>CONTEXT: User-supplied subroutine; for use with PREDPP<br>
USAGE: Versions before NONMEM 7.2:<br>
SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)<br>USE SIZES, ONLY: DPSIZE,ISIZE,LVR<br>INTEGER (KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS<br>REAL(KIND=DPSIZE) :: THETA,F,G,HH<br>DIMENSION IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*),G(LVR,*)<br>DIMENSION HH(LVR,*)<br>
With NONMEM 7.2 and higher:<br>
SUBROUTINE ERROR (ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,F,G,HH)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
USE PRDIMS,<br>
ONLY: GERD,HERD<br>
IMPLICIT REAL(KIND=DPSIZE) (A-Z)<br>REAL(KIND=DPSIZE) :: EVTREC<br>INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS<br>DIMENSION :: IDEF(*),THETA(*),EVTREC(IREV,*),INDXS(*)<br>REAL(KIND=DPSIZE) :: G(GERD,*),HH(HERD,*)<br>
DISCUSSION:<br>The ERROR subroutine is called by PREDPP to model intra-individual error in observed<br>values. It can also be used to to convert predictions from PREDPP, i.e., scaled drug<br>amounts, to other types of predictions (for example, to obtain the prediction of a drug<br>effect as a function of concentration, in a pharmacodynamic study).<br>
Input argument:<br>
ICALL<br>
ICALL=1: ERROR has been called for initialization at the beginning of a NON-<br>MEM problem; one such call per problem. EVTREC contains the ﬁrst event record.<br>THETA contains the initial estimates. ERROR must return values in IDEF which<br>inform PREDPP what tasks it will perform at later calls. It may also set elments of<br>HH to the appropriate derivatives, when it has requested that ERROR be called only<br>once per problem.<br>
ICALL=2: ERROR has been called to obtain the modeled value; multiple calls<br>occur. ERROR should compute derivatives of F for HH. If ERROR changes F, it<br>should also change the derivates of F in G.<br>
ICALL=4: ERROR has been called during the Simulation Step; multiple calls occur.<br>ERROR should compute simulated observations and store them in F.<br>
ICALL=5: ERROR has been called during the computation of expectations; multi-<br>ple calls occur. Such calls occur when the marginal (MRG_) data item is deﬁned in<br>the data set and has non-zero values for some records. If the MRG_ data item has<br>the value 1 or 2, expectations are computed for that record, and the value returned by<br>ERROR in F contributes to the expectation that is being computed for the PRED<br>data item. The value of an ERROR-deﬁned item contributes to the expectation com-<br>puted for the item.<br>
ICALL=6: ERROR has been called during the computation of raw data averages;<br>multiple calls occur. Such calls occur when the raw-data (RAW_) data item is<br>
378<br>
<hr>
<A name=384></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ERROR<br>
deﬁned in the data set and has the value 1 for some records (See <b>template</b>). ERROR<br>may re-compute DV when the value of DV in the data record is not the quantity to<br>be included in the average. ERROR may return a value of 1 in F if no DV item is to<br>be included in the average with the particular record.<br>
THETA<br>
The NONMEM THETA vector.<br>
EVTREC<br>
The PREDPP event record.<br>
INDXS<br>
The values speciﬁed in the $INDEX record of the NM-TRAN control stream. (This<br>is the NONMEM INDXS array starting at position 12, the ﬁrst position beyond<br>those positions used by PREDPP itself.)<br>
Output argument:<br>
IDEF<br>
ERROR should store values in IDEF only when ICALL=1. A value of 1 in IDEF(1)<br>indicates that ERROR will store the derivatives of log y in HH (which causes<br>PREDPP to multiply each element of HH by F). That is, PREDPP understands that<br>the &quot;error in log y&quot; is modeled.<br>
The value in IDEF(2) describes when ERROR should be called:<br>-1 call with every event record.<br>
0 call once per observation record.<br>1 call once per individual record.<br>2 call once per problem.<br>
The value in IDEF(3) describes whether ERROR uses derivatives of compartment<br>amounts (i.e. whether compartment amounts themselves are used as random vari-<br>ables in arithmetic statements in ERROR).<br>-1 ERROR may use derivatives of A.<br>
0 ERROR does not use derivatives A.<br>1 ERROR does use derivatives of A.<br>
The default used by PREDPP is IDEF(3)=-1. However, when ERROR does not use<br>A, then if IDEF(3) is set to 0, PREDPP can avoid some time-consuming processing.<br>Indeed, when $ERROR abbreviated code is supplied, and there is no reference to a<br>compartment amount A(n) (as a random variable in an arithmetic statement) in the<br>abbreviated code (or to its derivatives in verbatim code), then NM-TRAN sets<br>IDEF(3)=0.<br>
Input/Output argument:<br>
F<br>
On input, the prediction based on the pharmacokinetic model, i.e., the value of the<br>scaled drug amount in the observation compartment. On output, F may be<br>unchanged, or it may be modiﬁed, e.g., when a PD prediction is needed. If ERROR<br>modiﬁes F and uses population eta variables to do so, then at ICALL=2 ERROR<br>must call GETETA to obtain eta values prior to modifying F. When ICALL=4,<br>ERROR should calculate the simulated observation (after calling SIMETA and/or<br>SIMEPS to obtain simulated etas and epsilons, as necessary) and place its value in F.<br>With the Simulation Step, ERROR may return the simulated observation as the DV<br>data item, rather than in the argument F. With odd-type data the simulated observa-<br>tion must be returned as the DV data item. (See <b>$estimation</b>).<br>
379<br>
<hr>
<A name=385></a>ERROR DETAILED DESCRIPTIONS<br>
Help Guide<br>
G<br>
On input, at ICALL=2 when the data are population, an array of partial derivatives<br>of F with respect to etas<br>G (i,1) is the partial derivative of F with respect to eta(i).<br>G (i,j+1) is the second derivative of F with respect to eta(i), eta(j) (lower-triangular;<br>j=1, ..., i).<br>(Second derivatives are only needed with estimation by the Laplacian method.)<br>On input, G contains zeros when the data are single-subject data.<br>At ICALL=2, ERROR must modify G when it has changed F and has thus changed<br>the derivatives of F with respect to the population etas.<br>
HH An array of partial derivatives of F with respect to etas (when the data are single-<br>
subject data) or epsilons (when the data are population). Values should be stored<br>when ICALL=2 and also when ICALL=1 if ERROR sets IDEF(2)=2.<br>HH(i,1) is the derivative of F with respect to eta(i) or eps(i).<br>HH(i,j+1) is the derivative of H(i,1) with respect to eta(j) (but are only needed with<br>conditional estimation when the dependence on etas of the variance of intra-individ-<br>ual random error should be preserved in the computation of the objective function;<br>see the INTERACTION option (See <b>$ESTIMATION</b>).<br>
Also see NONMEM read-only modules (of the form ROCMn), NONMEM-PRED mod-<br>ules (of the form NMPRDn), and PREDPP read-only modules (of the form PROCMn).<br>
REFERENCES: Guide IV, section V.C.6<br>REFERENCES: Guide V, section 8<br>REFERENCES: Guide VI, section IV<br>
380<br>
<hr>
<A name=386></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ESTIM<br>
ESTIM COVAR ERROR CODES<br>
MEANING: NONMEM read-only global variables<br>
CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_INT, ONLY: IERE=&gt;IEST_ERR,IERC=&gt;ICOV_ERR<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IEST_ERR,ICOV_ERR<br>
DISCUSSION:<br>
IERE<br>
The return code from the Estimation Step.<br>
IERC<br>
The return code from the Covariance Step.<br>
Values of 0 indicate normal termination.<br>
These variables may be used as right-hand quantities in abbreviated code for initializa-<br>tion/ﬁnalization blocks.<br>
Location prior to NONMEM 7: rocm9<br>
REFERENCES: None.<br>
381<br>
<hr>
<A name=387></a>ETABAR DETAILED DESCRIPTIONS<br>
Help Guide<br>
ETABAR<br>
MEANING: NONMEM’s estimate of the bias in the underlying assumption about eta.<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>
ETABAR is printed when a conditional population estimation method is used. The fol-<br>lowing is an example.<br>
ETABAR IS THE ARITHMETIC MEAN OF THE ETA-ESTIMATES,<br>
AND THE P-VALUE IS GIVEN FOR THE NULL HYPOTHESIS THAT THE TRUE MEAN IS 0.<br>
ETABAR: -3.5224E-02 -7.1437E-05 2.5095E-03<br>
SE: 3.4060E-01<br>
3.1223E-03 1.9001E-01<br>
N: 12<br>
12 12<br>
P VAL.: 9.1763E-01<br>
9.8175E-01 9.8946E-01<br>
The ith number listed after &quot;ETABAR&quot; is the sample average (across individuals) of the<br>conditional estimates of the ith eta, and the ith number listed after &quot;SE&quot; is the standard<br>error for this average. Under the assumed model, the population average of the the condi-<br>tional estimates is approximately zero. If the model is well-speciﬁed, the sample average<br>should be near 0. (but see below for a mixture model). The P-value helps one assess<br>whether the sample average is &quot;far&quot; from 0. A value under 0.05, for example, indicates<br>such an average (notice the value 0.32E-02).<br>
With a mixture model, the ith eta is understood to have a different distribution for each<br>subpopulation of the mixture. Accordingly, different instances of the above output will<br>appear, one for each of the different subpopulations. Using a standard Bayesian-type<br>computation, each individual is classiﬁed into one of the subpopulations, and the condi-<br>tional estimate of the ith eta under the model for this subpopulation is used in the sample<br>av erage for that subpopulation. If under the mth submodel, the ith eta does not inﬂuence<br>the data from any individual, but it does inﬂuence the data from some individual under<br>some other submodel, then the sample average for the ith eta for the mth submodel will<br>be 0. If the ith eta does not inﬂuence the data from any individual under any model, then<br>the sample average for the ith eta for the mth submodel will usually be 0, but it will not<br>be if (i) the ith eta is correlated with an eta that inﬂuences some individual’s data under<br>the mth submodel, and (ii) that individual is classiﬁed to be in the mth subpopulation.<br>
The population average of the conditional estimates is only approximately zero because a<br>conditional estimate is a (Bayesian) posterior mode, and not a posterior expectation.<br>However with a mixture model, with the estimate for a given individual, the posterior dis-<br>tribution is that for the subpopulation into which the individual is classiﬁed, and due to<br>possible missclassiﬁcation the expectation of the estimate may be even &quot;further from&quot;<br>zero than with a nonmixture model. For this reason too, the centered FOCE method may<br>not work well with a mixture model.<br>
With a mixture model, or with a nonmixture model, one may implement a second Estima-<br>tion Step (in a subsequent problem), and then a second ETABAR estimate (EB2) can be<br>obtained, with which the ﬁrst ETABAR estimate (EB1) can be compared. If the data-ana-<br>lytic model is well-speciﬁed, the two estimates should represent nearly the same quantity.<br>Using an option on the $ESTIMATION record, the second P-value assesses the magni-<br>tude of the difference between EB1 and EB2, and a P-value under 0.05 would suggest<br>
382<br>
<hr>
<A name=388></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ETABAR<br>
that the data-analytic model is not well-specifed. To obtain EB2, a data set is simulated<br>under the ﬁtted model, and EB2 is obtained using this data set. Both EB1 and EB2 are<br>(univariate) measures of central tendency of the distribution of interindividual &quot;residuals&quot;,<br>i.e. the distribution of the conditional estimates of the etas. In both cases the residuals are<br>deﬁned in terms of the data-analytic model. But for EB1, the distribution is governed by<br>the true (unknown) model, and for EB2, the distribution is governed by the ﬁtted model.<br>If the two models are &quot;close&quot;, EB1 and EB2 will be close. The conditional estimates of<br>the etas from the simulated data should be based on the population parameter estimates<br>from these data. It may cost considerable CPU time to obtain this second set of parame-<br>ter estimates, and so it may not always be feasible to compute EB2.<br>
One proceeds by constructing a problem speciﬁcation that<br>(a) includes the same $INPUT record as was used with a previous problem wherein EB1<br>was obtained<br>(b) includes an $MSFI record specifying a model speciﬁcation ﬁle from that previous<br>problem, so that in particular, EB1 is available<br>(c) includes a $SIMULATION record with the option TRUE=FINAL, so that a data set<br>will be simulated using the ﬁnal parameter estimate from that previous problem.<br>(d) includes a $ESTIMATION record with the option ETABARCHECK (and either the<br>option METHOD=COND or METHOD=HYBRID).<br>A data set will be simulated, and EB2 will be obtained. With the ETABARCHECK<br>option, the P-value for the difference EB2-EB1 will be computed. Otherwise, if the<br>model is a nonmixture model, EB1 is ignored, and the P-value will be simply that for<br>EB2, and if the model is a mixture model, no P-value will be output (only the standard<br>error for EB2 will be output). The numbers of data and/or individual records in the simu-<br>lated data set may differ from those for the previous problem; so if desired, this data set<br>can be much larger than the real data set.<br>
REFERENCES: Guide VII, section II.A , III.D<br>
383<br>
<hr>
<A name=389></a>ETASXI DETAILED DESCRIPTIONS<br>
Help Guide<br>
ETASXI<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY: ETASXI<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE), ALLOCATABLE, DIMENSION(:)<br>
:: ETASXI<br>
DISCUSSION:<br>
With NONMEM 7, an alternative eta shrinkage evaluation using empirical Bayes vari-<br>ances (EBVs, or conditional mean variances) are now also reported. The $ESTIMATION<br>record option ETASTYPE=0 requests that eta shrinkage be averaged for all subjects.<br>This is the default. With ETASTYPE=1, eta shrinkage is averaged only among subjects<br>that provided a non-zero derivative of their data likelihood with respect to that eta.<br>
Reserved variable ETASXI(i) may be used to specify certain etas of particular subjects to<br>be included, or to specify certain etas of certain subjects to be excluded, from the average<br>eta shrinkage assessment. ETASXI stands for eta shrinkage exclude/include. The sub-<br>script i refers to ETA(i).<br>
If ETASXI(i) is set to 2, ETA(i) is included.<br>If ETASXI(i) is set to 1, ETA(i) is excluded.<br>
This overrides whatever would happen based on ETASTYPE.<br>
EXAMPLE:<br>
ETASXI(3)=1<br>
ETASXI(4)=2<br>
For all subjects, ETA(3) is excluded and ETA(4) is included.<br>
ETASXI can be set differently for certain subjects.<br>
EXAMPLE:<br>
IF(ID==3) ETASXI(1)=1<br>
IF(ID==23) ETASXI(3)=2<br>
This excludes ETA(1) for subject 1, and includes ETA(3) for subject 23.<br>
ETASXI may be set only in $PK and $PRED blocks.<br>
The additional output ﬁle root.shm (which stands for shrinkage map) will contain infor-<br>mation which etas were excluded in the eta shrinkage assessment.<br>
REFERENCES: Guide Introduction_7<br>
384<br>
<hr>
<A name=390></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
EVENT<br>
EVENT RECORD: EVTREC<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied DES and AES routines<br>
USAGE:<br>USE PROCM_REAL, ONLY: EVTREC<br>
USE PROCM_INT, ONLY: NVNT=&gt;NEVENT<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: PD,DPSIZE<br>
REAL(KIND=DPSIZE) :: EVTREC(5,PD+1)<br>
INTEGER(KIND=ISIZE) :: NEVENT<br>
DISCUSSION:<br>
EVTREC<br>
Identical to the argument EVTREC passed by PREDPP to PK and ERROR routine<br>
NVNT<br>
Identical to the argument NVNT passed by PREDPP to PK and ERROR routines.<br>
Location prior to NONMEM 7: procm7<br>
REFERENCES: Guide VI, section III.C<br>
385<br>
<hr>
<A name=391></a>EVID DETAILED DESCRIPTIONS<br>
Help Guide<br>
EVID DAT A ITEM<br>
MEANING: Event Identiﬁcation (EVID) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... EVID ...<br>
DISCUSSION:<br>EVID labels PREDPP’s event identiﬁcation (EVID) data item. The event identiﬁcation<br>data item is required. NM-TRAN can supply this data item if dose and observation<br>ev ents are the only types of events present in the data. EVID can have one of four values<br>in any event record.<br>
0<br>
Observation event. The DV data item is an observation. The CMT data item speci-<br>ﬁes which compartment is being observed. Dose-related data items (AMT, RATE,<br>II, ADDL, SS) must be zero.<br>
1<br>
Dose event. The CMT data item speciﬁes which compartment is being dosed. The<br>DV data item is ignored. One or more of AMT, RATE, II, ADDL, SS data items<br>must be non-zero to deﬁne the dose.<br>
2<br>
Other-type event. The DV data item is ignored. Dose-related data items must be<br>zero. Examples of other-type events are: A compartment is turned on or off (CMT<br>speciﬁes which compartment is to be turned on or off); a prediction is obtained at a<br>speciﬁed time so that it may be displayed in a table or scatterplot (PCMT speciﬁes<br>the compartment from which the prediction is obtained); some event occurs at a dif-<br>ferent time than any observation or dose event, e.g. a covariate such as weight<br>changes, an intervention such as hemodialysis is started or stopped.<br>
3<br>
Reset event. The kinetic system is re-initialized. Time is reset to the time of the<br>ev ent record, the amounts in each compartment are reset to zero, the on/off status of<br>each compartment is reset to its initial status. The DV data item is ignored. Dose-<br>related data items must be zero.<br>
4<br>
Reset-and-dose event. The system is ﬁrst reset, and then a dose is given. The DV<br>data item is ignored.<br>
With NONMEM 7, there is a change in the value of EVID under the following circum-<br>stances:<br>1) NMTRAN is appending EVID<br>2) The record is not a dose event (AMT, RATE, SS = 0)<br>3) MDV is present in the data set (i.e., was listed on $INPUT)<br>4) MDV is 1 or MDV is 101<br>
Previous versions of NMTRAN always set EVID=0 (observation) when the record was<br>not a dose event. NMTRAN will now set EVID=2 (Other-type event) for this case. Note<br>that if the user supplies both EVID and MDV, there is no change. Similarly, if the user<br>supplies neither EVID nor MDV, so that NMTRAN is appending both of them, there is<br>no change. There is only a change when the user supplies MDV but not EVID, and has<br>set MDV=1 or MDV=101 for non-dose records.<br>
With NONMEM 7.2 and higher, the &quot;Repeated Observation Records&quot; feature exists to<br>assist in specialized methodologies such as stochastic differential equations. A record in a<br>data ﬁle may be set up for repeated calls to PK and ERROR. Each time, the same record<br>is passed to PK and/or ERROR, but with a different EVID. The user’s control stream<br>
386<br>
<hr>
<A name=392></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
EVID<br>
model in $PK or $ERROR may then take advantage of executing certain code conditional<br>on the EVID value. For this to occur, the user must introduce one or more of the follow-<br>ing data items in the data ﬁle, with these names:<br>
XVID1 XVID2 XVID3 XVID4 XVID5<br>
These stand for &quot;extra&quot; EVIDs. On the ﬁrst call to PK/ERROR, the EVID is set to the<br>value given in XVID1. On the second call, the EVID is set to that in column XVID2, etc.<br>up to XVID5. Only as many XVIDs as are required are needed to be deﬁned. All the<br>other items in the record do not change, except that if the present EVID used is not 0,<br>then the MDV value is set to 1 for that call. If an XVID is -1, then the call to PK/ERROR<br>for that XVID is not made, nor for the remaining XVIDs. If there is an EVID column,<br>the value in this column is not passed to PK/ERROR unless XVID1=-1 in which case a<br>&quot;normal&quot; call with that record occurs.<br>(See <b>stochastic differential equation example</b>)<br>
REFERENCES: Guide IV, section V.B<br>REFERENCES: Guide VI, section V.B<br>
387<br>
<hr>
<A name=393></a>EXPECTATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
EXPECTATION BLOCK<br>
MEANING: Abbreviated code for computation of expectations<br>CONTEXT: Abbreviated code<br>
SAMPLE:<br>$ERROR<br>
IF (ICALL.EQ.5) THEN<br>
... expectation block ...<br>
ENDIF<br>
DISCUSSION:<br>An expectation block is a block of abbreviated code that is only executed when<br>ICALL=5. This value of ICALL occurs when the marginal (MRG_) data item is deﬁned<br>in the data set and has a non-zero value for some records. Expectation blocks are not<br>required when the marginal data item is present, but they allow the user additional func-<br>tionality. Such blocks may be present in $PRED, $PK, $ERROR.<br>
If the MRG_ data item has the value 1 in a data record, PRED- (PK- and ERROR-)<br>deﬁned items displayed for the record (e.g. in the row of a table corresponding to the<br>record) are expectations. When ICALL=5, the expectations are being computed. With<br>each call to PRED with the data record, the value being set in Y is contributing to the<br>expectation being computed for the PRED item, and the value being set for a PRED-<br>deﬁned item that will be displayed in a table or scatterplot (except for an item stored in<br>the SAVE region) is contributing to the expectation being computed for that item.<br>
In this example, the displayed value of PRED with a record having MRG_=1 is the<br>expectation of the 0-1 variable taking the value 1 if and only if F &gt; 10.<br>
IF (ICALL.EQ.5) THEN<br>
Y=0<br>
IF (F.GT.10) Y=1<br>
RETURN<br>
ENDIF<br>
Special rules apply to expectation blocks and passes through the data with ICALL=5.<br>
1) No eta derivatives are computed in an expectation block.<br>
2) Calls to certain NONMEM utility routines are permitted in an expectation block:<br>
CALL RANDOM(n,R)<br>
where n is an integer 1-10. If CALL RANDOM is present, R becomes a reserved<br>variable, and may not be used outside the expectation block. Multiple calls to RAN-<br>DOM may be present.<br>
3) A RETURN statement may be used in an expectation block. If Y= appears (i.e. Y is<br>
assigned a value) in an expectation block before the RETURN (not necessarily the in<br>same block containing the RETURN), then F is set to Y (F=Y); otherwise F is set to<br>to 0 (F=0). If there is no RETURN statement in the expectation block, then as usual,<br>F is set to the value of Y assigned by the time PRED (PK, ERROR) exits.<br>
4) Loops are permitted in an expectation block. The syntax is as follows.<br>
DO WHILE (condition)<br>
.. statements ..<br>
END DO<br>
388<br>
<hr>
<A name=394></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
EXPECTATION<br>
5) If a mixture model is used, then during calls with ICALL=5, both MIXNUM and<br>
MIXEST are the index of the subpopulation into which the individual (whose data<br>record is being passed) has been classiﬁed.<br>
(See <b>mrg</b>).<br>
REFERENCES: None.<br>
389<br>
<hr>
<A name=395></a>FILES DETAILED DESCRIPTIONS<br>
Help Guide<br>
FILES<br>
MEANING: FILES Subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: ISIZE<br>
INTEGER(KIND=ISIZE) :: IUNIT<br>
CALL FILES (IUNIT)<br>
DISCUSSION:<br>Whenever a FORTRAN OPEN statement or a CLOSE statement is executed in a user-<br>supplied routine, NONMEM should be informed. This should be done as follows: Imme-<br>diately after the OPEN or CLOSE statement is executed, a call should be issued to<br>FILES.<br>
Input argument:<br>
IUNIT<br>
An integer variable or integer constant; the number of the logical unit involved in the<br>OPEN or CLOSE statement.<br>
If reads or writes are issued to a given unit, but no OPEN statement for this unit is exe-<br>cuted, then when ICALL is 0, a call to FILES should be issued (before any I/O statement<br>involving this ﬁle is executed), where IUNIT is the number of the logical unit. However,<br>reads and writes to a unit which has not been opened (connected) may not be allowed by<br>some operating systems.<br>
REFERENCES: Guide III, section V.10<br>
390<br>
<hr>
<A name=396></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
FINAL<br>
FINAL PARAMETER ESTIMATE<br>
MEANING: Final estimates of parameters THETA, OMEGA, SIGMA<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>A page with the title FINAL PARAMETER ESTIMATE is printed as part of every NON-<br>MEM output.<br>
If the Estimation Step was NOT run, then the values printed are the initial parameter esti-<br>mates speciﬁed for the problem.<br>
If the Estimation Step WAS run, then the values printed are the ﬁnal parameter estimates.<br>
These estimates of parameters are used by NONMEM to compute the objective function<br>value printed on the page with title &quot;MINIMUM VALUE OF OBJECTIVE FUNCTION&quot;<br>and to compute predicted values for Tables and Scatterplots.<br>
******************** FINAL PARAMETER ESTIMATE<br>
***************<br>
THETA - VECTOR OF FIXED EFFECTS PARAMETERS<br>
*********<br>
TH 1<br>
TH 2<br>
TH 3<br>
1.94E+00 1.02E-01 3.20E+01<br>
OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS<br>
********<br>
ETA1<br>
ETA1 8.99E-01<br>
OMEGA - CORR MATRIX FOR RANDOM EFFECTS - ETAS<br>
*******<br>
ETA1<br>
ETA1 9.48E-01<br>
This example is from a run involving single-subject data, so there is no SIGMA matrix.<br>
With NONMEM 7.2 and higher, the correlation matrix is included. It is computed from<br>the covariance matrix, whether or not the Estimation step is not run.<br>
(See <b>initial parameter estimate</b>).<br>
With NONMEM 7.3 and higher, the O$THETAR record may be used to transform ﬁnal<br>estimates of THETA before they are reported in the NONMEM output.<br>(See <b>$thetar</b>).<br>
REFERENCES: Guide V, section 10.5<br>
391<br>
<hr>
<A name=397></a>FINEDAT A<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
FINEDAT A<br>
MEANING: FINEDAT A program<br>CONTEXT: NONMEM run<br>
USAGE:<br>
..\util\finedata ﬁneplot.ftl<br>..\util\finedata &lt; ﬁneplot.ftl<br>
DISCUSSION:<br>The utility program ﬁnedata augments an NM-TRAN data ﬁle to incorporate additional,<br>non-observation, time values spaced at regular increments so that when a table is gener-<br>ated, NONMEM can ﬁll these records with predicted values, from which smooth predic-<br>tion curves may be plotted. If data items DV, EVID and/or MDV are listed in $INPUT<br>and are present in the input data records, inserted records will be given the following val-<br>ues by default<br>
DV=.<br>EVID=0<br>MDV=1<br>
This may be over-ridden by a data item speciﬁcation, such as $FINEDAT A EVID=2. See<br>also the EXAMPLE below.<br>
Alternately, ﬁnedata can be used to ﬁll in missing covariate values, but not to add any<br>additional records.<br>
ﬁneplot.ctl is the name of a control stream ﬁle containing special commands for the ﬁne-<br>data program.<br>
The only records that ﬁnedata pays attention to is $INPUT, from which it obtains the col-<br>umn names, $DAT A, from which it obtains the input data ﬁle, $FINEDAT A, which con-<br>tains instructions, and $PROB by which problems are separated.<br>
With NONMEM 7.4, the $EXTRADOSE record may be used to add additional non-<br>observation dose records to those already existing, but it allows items such as compart-<br>ment number, or EVID, etc., to vary. The EXTRADOSE has particular value when<br>adding time-delay compartments to a model, to deal with time-delay problems. For<br>details:<br>See <b>INTRODUCTION TO NONMEM 7, ﬁnedata Utility Program</b><br>
All other control stream records are ignored. All options of $DAT A are ignored, includ-<br>ing RECORD and IGNORE options. (Input records whose ﬁrst non-blank character is<br>alphabetic are copied to the output ﬁle but not used otherwise.) Thus, a way to create a<br>control stream is to copy the ﬁrst records describing the data layout from an existing<br>NONMEM control stream ﬁle, and then adding the $FINEDAT A record.<br>
Multiple data sets may be processed by one ﬁnedata control stream ﬁle, by using $PROB<br>records to separate the problems.<br>
The options to $FINEDAT A are as follows:<br>
$FINEDATA<br>
FILE= ﬁlename<br>AXIS= label[(LIN) | (LOG)]<br>NEVAL= [<i>n </i>| label ] | [TDELTA= [<i>r </i>| label ]<br>[TSTART= [<i>r </i>| label | FIRST ]]<br>
392<br>
<hr>
<A name=398></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
FINEDAT A<br>
[TSTOP= [<i>r </i>| label | LAST ]]<br>[OCC= label ]<br>[item= list] ...<br>[item= [PREV | NEXT] [LIN | LINLIN | LOG | LOGLIN ]] ...<br>[DELIM=s | DELIM=t | DELIM=, ]<br>[MISSING=list ]<br>
$EXTRADOSE ...<br>
SAMPLE:<br>$FINEDATA TSTART=0 TSTOP=50 NEVAL=100 AXIS=TIME(LIN) CMT=1,3<br>
FILE=example6b.csv<br>
OPTIONS:<br>
FILE=ﬁlename<br>
Required. The name of the output ﬁle.<br>
AXIS= label[(LIN) | (LOG)]<br>
Required. Name of column containing times, usually TIME. Optionally, designate<br>(LIN) or (LOG) in parenthesis, to indicate linear or geometric time incrementing<br>when new records are incorporated.<br>If LIN: additive time increment=(tstop-tstart)/(neval+1)<br>If LOG: multiplicative time increment=(tstop/tstart)**(1/(neval+1))<br>
Times may be entered as numerical values, or in hh:mm:ss format. Data sets with<br>DATE/TIME records may also be processed (but then TSTART and TSTOP must be<br>in numerical hours or hh:mm:ss format).<br>
NEVAL= [ <i>n </i>| label ]<br>
The number of additional incremental time records to be created per subject. Either<br>an integer value <i>n</i>, or the label of a data item in the original data set containing the<br>NEVAL value. When NEVAL=-1, then missing values will be ﬁlled in for speciﬁed<br>items, but no additional records will be created. If NEVAL/=-1, only the inserted<br>records will have ﬁlled in interpolated values, and the original records will remain<br>untouched.<br>Optional. One of NEVAL or TDELTA is required.<br>
TDELTA= [<i>r </i>| label ]<br>
The increment in time. Either a number, or the label of a data item in the original<br>data set containing the TDELTA value. Optional. One of NEVAL or TDELTA is<br>required.<br>
TSTART= [ <i>r </i>| label | FIRST ]<br>
Optional. Default: FIRST<br>The start time for creating incremental time records. Either a real or integer numeric<br>value <i>r</i>, or the label of a data item in the original data set containing the start time.<br>If TSTART is not a number and is not FIRST, then it is interpreted as the label of a<br>data item in the original data set containing the start time. If omitted or coded as<br>FIRST, then the time of the ﬁrst record of the subject. When TSTART is giv en by a<br>data item, it can differ according to occasion. The same holds true for TSTOP and<br>NEVAL (see below) if they are obtained from the data ﬁle.<br>
TSTOP= [ <i>r </i>| label | LAST ]<br>
Optional. Default: LAST<br>The stop time for creating incremental time records. Either a numeric value real or<br>integer <i>r</i>, or the label of a data item in the original data set containing the stop time,<br>
393<br>
<hr>
<A name=399></a>FINEDAT A<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
or LAST, in which case the last record of the subject or occasion or time section is<br>used.<br>
Finedata stops inserting records when occasion changes (if OCC= was given), or if<br>EVID=3 or 4, or after a re-initialization of time (indicated by the time in the data<br>record being less than that of the previous record). TSTART will be the next TIME<br>value.<br>
OCC= label<br>
Optional. Restart the time incrementing when the occasion changes, in addition to<br>the other conditions listed above.<br>
item= list<br>
List of values for data item ITEM for which there is to be a record at each time<br>increment. May be a list of values such as 1,3 etc. This can be done for a series of<br>data items. For example, if you enter $FINEDAT A CMT=1,3 EVID=2,2 then two<br>records per time point are inserted, one with CMT=1, EVID=2, and the other with<br>CMT=3, EVID=2.<br>
item= [LAST | NEXT] [LIN | LINLIN | LOG | LOGLIN ] ...<br>
A scheme to determine how to supply values to various data items for these inserted<br>records may also be given. The following may be interspersed with numeric values.<br>
NEXT: When inserting records between two consecutive original records of time t1<br>(PREV) and t2 (NEXT), the PREDPP’s default of using the covariate value of the t2<br>(NEXT) record is used for the inserted records. NEXT is the default.<br>
PREV: When inserting records between two consecutive original records of time t1<br>(PREV) and t2 (NEXT), the covariate value of the t1 (PREV) record is used for the<br>inserted records. (LAST may be coded instead of PREV, to be consistent with the<br>options of the $BIND record. Note that the $BIND record is not used by ﬁnedata.)<br>
LIN, or LINLIN: A covariate-linear, time-linear interpolation is used for the covari-<br>ate value for the inserted records. LINT or LINLINT (T for truncate) produces trun-<br>cated integer values, LINR or LINLINR (R for round) produces<br>values rounded to the nearest integer.<br>
LOG, or LOGLIN: A covariate-logarithmic, time-linear interpolation is used for the<br>covariate value for the inserted records. A T or R sufﬁx results in truncated or<br>rounded integer values, respectively.<br>
LINLOG: A covariate-linear, time-logarithmic interpolation is used for the covariate<br>value for the inserted records. A T or R sufﬁx results in truncated or rounded integer<br>values, respectively.<br>
LOGLOG: A covariate-logarithmic, time-logarithmic interpolation is used for the<br>covariate value for the inserted records. A T or R sufﬁx results in truncated or<br>rounded integer values, respectively.<br>
DELIM=x<br>
Optional. DELIM=delimiter of output data ﬁle, if it is to be different from the input<br>data ﬁle. DELIM=S is space, DELIM=t is tab, DELIM=, is comma.<br>
MISSING=list<br>
Optional. List is a comma delimted list of symbols that denote missing values. By<br>default, a period (.) and space (s) are considered missing values. Values such as 0 or<br>-99 may be present in the data as symbols for missing values. They may be<br>described with MISSING=0 or MISSING=-99. During interpolation, missing values<br>will be skipped, and only records with non-missing values will be used for<br>
394<br>
<hr>
<A name=400></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
FINEDAT A<br>
interpolation.<br>
EXAMPLE:<br>
With NONMEM 7.3 and higher, if an MDV is set to a value greater than or equal to 100,<br>it is converted to that value minus 100 upon input, but will also not be used at all during<br>estimation, only for table outputting. This option allows you to use the same enhanced<br>data ﬁle for estimation and Table outputs, without signiﬁcantly slowing down the estima-<br>tion. So, the ﬁnedata control stream ﬁle might include<br>
$FINEDATA TSTART=0 TSTOP=50 NEVAL=100 AXIS=TIME(LIN)<br>
CMT=1,3 MDV=101,101 FILE=example6b.csv<br>
See Guide Introduction_7 for details and examples.<br>
REFERENCES: Guide Introduction_7<br>
395<br>
<hr>
<A name=401></a>FINISH DETAILED DESCRIPTIONS<br>
Help Guide<br>
FINISH<br>
MEANING: FINISH record<br>CONTEXT: NM-TRAN and NONMEM data sets<br>
USAGE:<br>FIN<br>
DISCUSSION:<br>A FINISH record signals the end of the data for a given NONMEM problem. It is always<br>optional.<br>
FINISH record in NM-TRAN data sets:<br>
When the RECORDS option of the $DAT A record is omitted, NM-TRAN reads the<br>data set to a FINISH record or to end-of-ﬁle, whichever comes ﬁrst.<br>
When a format is omitted on the $DAT A record, a FINISH record consists of the<br>characters FIN appearing anywhere in the record (the other characters are all blank).<br>
When a format is provided on the $DAT A record, a FINISH record must have the<br>same form as in NONMEM data sets.<br>
FINISH record in NONMEM data sets:<br>
When Fields 3 and 6 of the NONMEM DAT A Control Record are blank or zero,<br>NONMEM reads the data set to a FINISH record or to end-of-ﬁle, whichever comes<br>ﬁrst. (Field 3 and 6 either contains the number of data records or are blank or zero.<br>They must be blank or zero when the number of records is greater than 99999999.)<br>
The format of the FINISH record is:<br>
Blank characters in positions 1-76 and 80 and the characters F, I, and N in posi-<br>tions 77, 78, and 79, respectively.<br>
If m is the number of FORTRAN records spanned per data record, there must<br>be m-1 blank FORTRAN records inserted before the FINISH record.<br>
In addition, the following three rules must be followed:<br>
All FORTRAN records of the input data ﬁle must be 80 characters long.<br>
All FORTRAN records of the input data ﬁle except the FINISH record must<br>have blank characters in positions 77-80.<br>
The total number of A, E, and F codes on the FORMAT record, including their<br>multiplicities, must equal, not exceed, the number of data items speciﬁed on the<br>DATA record.<br>
REFERENCES: Guide II, section D.2.3<br>REFERENCES: Guide IV, section III.B.5<br>
396<br>
<hr>
<A name=402></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
FLU<br>
FLU<br>
MEANING: FLU subroutine<br>CONTEXT: NONMEM user-installation routine<br>
USAGE:<br>
SUBROUTINE FLU (I)<br>
RETURN<br>
END<br>
DISCUSSION:<br>
Routine FLU is a user-installation routine. It allows the user to cause NONMEM to exe-<br>cute statements needed with certain operating systems.<br>
FLU is called by NONMEM whenever the buffer for an I/O unit should be emptied. Buf-<br>fer emptying is controlled in an operating system speciﬁc way, and often a compiler that<br>is supported under an operating system will support a FORTRAN language extension that<br>allows a buffer to be emptied. Whenever possible, such a FORTRAN instruction should<br>be coded into FLU. FLU has one argument, I, which is the I/O logical unit number. The<br>statement that should be inserted prior to RETURN follows, for two different operating<br>systems, is as follows:<br>
(Sun UNIX):<br>
CALL FLUSH (I)<br>
(MS WINDOWS 95):<br>
CALL COMMITQQ (I)<br>
REFERENCES: None.<br>
397<br>
<hr>
<A name=403></a>FNLETA<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
FNLETA<br>
MEANING: FNLETA subroutine<br>CONTEXT: NONMEM routine<br>
DISCUSSION:<br>FNLETA is a NONMEM routine.<br>
An error message from FNLETA indicates that NONMEM has experienced difﬁculties<br>obtaining posthoc etas.<br>
REFERENCES: None.<br>
398<br>
<hr>
<A name=404></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
F FLAG<br>
F FLAG<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPR_INT, ONLY: F_FLAG=&gt;IPRDFLG1<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IPRDFLG1<br>
DISCUSSION:<br>
When either of the options LIKELIHOOD or -2LOGLIKIHOOD appear in the $ESTI-<br>MATION record, this indicates that for all observations, the variable Y (with NM-TRAN<br>abbreviated code) or F (with a user-supplied PRED or ERROR routine) is being set to a<br>likelihood (or -2 log likelihood) value for the observation. Suppose, though, that neither<br>option appears. Then for a given observation, the default indication is that Y or F is<br>being set to a &quot;prediction&quot; of the observation. This is equivalent to setting the variable<br>F_FLAG to its default value of 0. When, however, the variable F_FLAG is set to the<br>value 1 (or 2) in the PRED or ERROR routine, this signals that Y or F is being set to a<br>likelihood (or -2 log likelihood) value for this particular observation.<br>
F_FLAG may be set in NM-TRAN abbreviated code.<br>
IF (TYPE.EQ.1) THEN<br>
Y=THETA(1)+ETA(1)+ERR(1) ; a prediction<br>
ELSE<br>
F_FLAG=1<br>
A=EXP(THETA(2)+ETA(2))<br>
B=1+A<br>
Y=DV*A/B+(1-DV)*1/B ; a likelihood<br>
ENDIF<br>
A nonzero value of F_FLAG has no effect during a Simulation Step. But note: When sin-<br>gle-subject data are simulated for which, when the data are later analyzed, Y (F) would<br>always be set to a likelihood, and when the ONLYSIMULATION option is used in the<br>$SIMULATION record, then usually the NOPREDICTION option can also be used.<br>When the NOPREDICTION option is used, if any eta’s are used in the model, the data<br>are regarded as population data, but the model for the data in question usually does not<br>involve eta variables. When, however, single-subject data are simulated for which, when<br>the data are analyzed, Y (F) would sometimes be set to a likelihood and sometimes to a<br>&quot;prediction&quot;, and when the ONLYSIMULATION option is used in the $SIMULATION<br>record, then the PREDICTION option will need to be used (this is the default option!).<br>The reason is that the expression of residual variability associated with the predictions<br>will involve eta variables.<br>
RESTRICTIONS:<br>
When F_FLAG is set to a non-zero-value for some observation, neither the LIKELI-<br>HOOD or -2LOGLIKIHOOD option may be used.<br>
When F_FLAG is set to a nonzero-value for an observation, the Laplacian estimation<br>method must be used.<br>
399<br>
<hr>
<A name=405></a>F FLAG<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
Unless with all observations within an individual record, F_FLAG is 0, the RES and<br>WRES items will be 0 for all data records in the individual record.<br>
When F_FLAG is set to a nonzero-value for an observation within an individual record,<br>inter-L2 correlated epsilons are not allowed with the observations within the individual<br>record.<br>(See <b>Correlation Across L2 Records</b>)<br>
If the data are population data, a nonzero value of F_FLAG cannot be used within a mul-<br>tiple-observation L2 record. If the data are single-subject data, a nonzero value of<br>F_FLAG cannot be used within a multiple-observation L1 record.<br>
Location prior to NONMEM 7: nmpr17<br>
REFERENCES: None.<br>
400<br>
<hr>
<A name=406></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
GAMLN<br>
GAMLN<br>
MEANING: GAMLN function<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: GAMLN,X<br>
REAL(KIND=DPSIZE) :: LN_OF_GAMMA<br>
.<br>
. .<br>
LN_OF_GAMMA= GAMLN(X)<br>
DISCUSSION:<br>Gives the natural logarithm of the gamma function. It is more accurate than the Stirling’s<br>approximation.<br>
May be used in abbreviated code. May be used in the computation of the objective func-<br>tion because it is continuous. The ﬁrst derivative (GAMLND1) and second derivative<br>(GAMLND2) are also evaluated, and are continuous for X&gt;0.0.<br>
Input argument:<br>
X<br>
EXAMPLE OF USAGE:<br>
FA C=EXP(GAMLN(X+1.))<br>
If X takes only integer values, then<br>
FAC=X!=X*(X-1)*(X-2)... *1<br>
The GAMMA function in effect &quot;ﬁlls in&quot; the values of the factorial (but with a shift<br>of 1 in the argument) for non-integer values of x.<br>
If the argument is a random variable, it should always be positive. Eta partial derivatives<br>are computed.<br>
REFERENCES: None.<br>
401<br>
<hr>
<A name=407></a>GETETA<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
GETETA<br>
MEANING: GETETA subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>
DIMENSION ETA(LVR)<br>
DOUBLE PRECISION ETA<br>
CALL GETETA (ETA)<br>
DISCUSSION:<br>The NONMEM utility routine GETETA is used to obtain subject-speciﬁc values of eta.<br>It may be called only when the data are population data.<br>
Output argument:<br>
ETA<br>
An array into which GETETA stores subject-speciﬁc eta values ETA(1), ETA(2),<br>etc. If a conditional estimation method is not used, GETETA stores zeros in the<br>ETA array.<br>
GETETA must always be initialized at ICALL=1. This simply involves calling GETETA<br>at ICALL=1. No values are stored in ETA at this call.<br>
When the data are population and abbreviated code is used, values of etas are always<br>obtained by a call to GETETA occurring in generated or Library PK or PRED subrou-<br>tines. (In the case of PK, the array of etas is stored in a common and is available to the<br>ERROR subroutine as well.) This call occurs even if a conditional estimation method is<br>not implemented, in which case GETETA stores zeros in ETA. As a result, when the<br>ﬁrst-order method is used, apparent subject-speciﬁc values computed in NM-TRAN<br>abbreviated code are the required typical values. Thus, an executable resulting from<br>using an abbreviated code for PRED (for PK and ERROR if PREDPP is used) can be<br>used with any estimation method.<br>
EXAMPLE OF USAGE:<br>
IF (ICALL.EQ.1) THEN<br>
...<br>
CALL GETETA (ETA)<br>
...<br>
RETURN<br>
ENDIF<br>
...<br>
IF (ICALL.EQ.2) CALL GETETA (ETA)<br>
It is also possible to obtain simulated subject-speciﬁc values of eta. (See <b>simeta</b>).<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide VI, section III.E.2 , IV.B.2<br>
402<br>
<hr>
<A name=408></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
HESSIAN<br>
HESSIAN<br>
MEANING: A matrix computed by NONMEM<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>
The Hessian matrix is the second derivative matrix of the objective function with respect<br>to the parameters of the model. NONMEM computes Hessian matrices for several pur-<br>poses.<br>
Estimation Step<br>
A rough numerical approximation to the Hessian is maintained during the minimiza-<br>tion search. The following message in the intermediate output refers to this matrix:<br>
RESET HESSIAN<br>
Explanation: The search starts with the Hessian set to the identity matrix. The Hes-<br>sian is updated after each iteration, using a rank 1 update procedure. When there is<br>no longer a sensible direction to take, but convergence has not been achieved, this<br>may be due to inadequacy of the updated Hessian. Then the Hessian is reset to a cer-<br>tain positive semi-deﬁnite diagonal matrix, and a new direction computed from this<br>matrix (and the gradient vector) is tried.<br>
The appearance of the message indicates why an unusually large number of function<br>evaluations were used for the iteration (extra ones were needed to compute the new<br>Hessian and perform a line search along the new direction) and why an unusually<br>long CPU time was needed for the iteration (if intermediate output is being moni-<br>tored). Its appearance suggests that the search is not going easily, and perhaps (not<br>necessarily) something is wrong.<br>
Covariance Step<br>
A good numerical approximation to the Hessian is computed at the ﬁnal parameter<br>estimates. It is referred to as the R matrix.<br>
Obtaining Conditional Estimates<br>
In this case, the Hessian matrix is the second derivative matrix of the conditional<br>objective function. The following error messages refer to this matrix:<br>
HESSIAN OF OBJ. FUNCT. FOR COMPUTING CONDITIONAL ESTIMATE IS<br>
NON POSITIVE DEFINITE<br>
NUMERICAL HESSIAN OF OBJ. FUNC. ...<br>
REFERENCES: Guide IV, section III.B.15<br>REFERENCES: Guide V, section 12.4.6<br>REFERENCES: Guide VII, section II.A<br>
403<br>
<hr>
<A name=409></a>ICALL DETAILED DESCRIPTIONS<br>
Help Guide<br>
ICALL<br>
MEANING: Argument of user-supplied subroutines<br>CONTEXT: User-supplied routines<br>
DISCUSSION:<br>ICALL is an argument passed by NONMEM to user-supplied subroutines CCONTR,<br>CONTR, CRIT, PRED, PRIOR and MIX.<br>
PREDPP selectively passes the same argument to PK, ERROR, and INFN. ICALL can<br>be used in $PK, $ERROR, and $PRED abbreviated code. The discussion below<br>describes the values of ICALL as seen by PRED.<br>
ICALL=0: the routine has been called for initialization at the beginning of the NONMEM<br>run; one such call per run.<br>
ICALL=1: the routine has been called for initialization at the beginning of a NONMEM<br>problem; one such call per problem.<br>
ICALL=2: the routine has been called for a prediction. Multiple calls occur.<br>
ICALL=3: the routine has been called for ﬁnalization at the end of a NONMEM problem;<br>one such call per problem.<br>
ICALL=4: the routine has been called during the Simulation Step; multiple calls occur, as<br>with ICALL=2.<br>
ICALL=5: the routine has been called when expectations are being computed; multiple<br>calls occur.<br>
ICALL=6: the routine has been called when raw data averages are being computed; mul-<br>tiple calls occur.<br>
Note: Some subroutines are called with only a subset of the possible values of ICALL.<br>
REFERENCES: Guide I, section C,4.2<br>REFERENCES: Guide IV, section IV.D , IV.E.1<br>REFERENCES: Guide VI, section III.C , IV.B.1<br>
404<br>
<hr>
<A name=410></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ID<br>
ID .ID. AND L1 DAT A ITEMS<br>
MEANING: Identiﬁcation (ID) data item for NONMEM<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... ID ...<br>
DISCUSSION:<br>ID, .ID. and L1 are labels for NONMEM’s identiﬁcation data item.<br>
ID<br>
The observations in the data set are divided into groups called level-one observa-<br>tions. These groups may have different sizes. Level-one observations are treated as<br>being statistically independent multivariate observations.<br>
Because there can be at most one scalar observation on any data record, the identiﬁ-<br>cation (ID) data item is used to group together the data records containing the scalar<br>observations comprising a level-one observation. Using NM-TRAN, the identiﬁca-<br>tion data item is given the label ID in the $INPUT record. A contiguous set of data<br>records with the same value of ID are collectively called an individual record (also<br>called an L1 record), and this record &quot;contains&quot; one level-one observation. A change<br>in ID value indicates the start of a new individual record.<br>
When every level-one observation consists of a single scalar observation, so that the<br>entire level-one observation can be contained in a single data record, ID data items<br>are not generally required. However, they are always required when the data are<br>population data and PREDPP is used.<br>
.ID.<br>
When the data are single-subject data and PREDPP is used, NM-TRAN automati-<br>cally generates the ID data items and provides the label .ID. for the NONMEM<br>control stream. (Or if L2 data items appear, these are taken to be the ID data items.)<br>If the ID label is given in the $INPUT record, NM-TRAN ignores it, and it also<br>ignores the data items associated with this label.<br>
L1<br>
Using NM-TRAN, the identiﬁcation data item may be given the label L1 in the<br>$INPUT record. Use of L1 as a label or synonym (e.g. ID=L1) in the $INPUT<br>record speciﬁes that the associated data items are to be used as the identiﬁcation data<br>items and, if the data are single-subject data, the automatic generation of the identiﬁ-<br>cation data items is suppressed.<br>
REFERENCES: Guide I, section B.1<br>REFERENCES: Guide IV, section II.C.4 , III.B.2<br>
405<br>
<hr>
<A name=411></a>II DETAILED DESCRIPTIONS<br>
Help Guide<br>
II DAT A ITEM<br>
MEANING: Interdose Interval (II) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... II ...<br>
DISCUSSION:<br>II labels PREDPP’s interdose interval (II) data item. The interdose interval data item is<br>optional. In a dose or reset-dose event record it gives the time between implied or addi-<br>tional doses (i.e., for repeated doses with a given period, the II data item is this period).<br>
For a steady-state infusion (AMT=0; RATE&gt;0), II should be 0.<br>
For other steady-state doses, II should be a positive number. II giv es the time between<br>implied doses.<br>
For non-steady-state doses, II should be a positive number if and only if the ADDL data<br>item is a positive number. II giv es the time between additional doses.<br>
For observation, other-type, and reset event records, II should be zero.<br>
The units of II should be consistent with those of TIME.<br>
Any II value in the NM-TRAN data set that contains a colon (:) is assumed to be a clock<br>time (hh:min) and NM-TRAN converts it (to hh.fr) as in the ﬁrst example:<br>
NM-TRAN data set<br>
NONMEM data set<br>
II II<br>---- ----<br>1:30 1.50<br>
1.30 1.30<br>
The $DAT A record may include the option TRANSLATE=(II/24), in which case all<br>interdose interval data items (obtained after clock time conversion) are divided by 24.<br>(See <b>$data</b>).<br>
(See <b>exogenous supplementation example</b>).<br>
REFERENCES: Guide VI, section V.G<br>REFERENCES: Guide IV, section V.B<br>
406<br>
<hr>
<A name=412></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INCLUDE<br>
INCLUDE<br>
MEANING: Causes NM-TRAN to read control stream records from a different ﬁle.<br>CONTEXT: NM-TRAN Control Record<br>
USAGE:<br>INCLUDE ﬁlename [ <i>n </i>]<br>
SAMPLE:<br>INCLUDE datadef<br>
DISCUSSION:<br>
This record causes NM-TRAN to read control stream records from a different ﬁle. The<br>record must start with the characters INCLUDE or include.<br>
$INCLUDE and<br>
$include are also recognized.<br>
OPTIONS:<br>
filename<br>
Name of the ﬁle to be read. Required. Filename may not contain embedded spaces.<br>If it contains commas, semicolons, or parentheses, then it must be surrounded by<br>single quotes ’ or double quotes &quot;. Filename may also contain equal signs if it is<br>enclosed in quotes.<br>
<i>n</i><br>
Optional. The number of copies of the ﬁle. Default is 1.<br>
NMTRAN opens the named ﬁle and reads it to end-of-ﬁle. The contents of the ﬁle may<br>be any portion of an NM-TRAN control stream, e.g., control records and/or abbreviated<br>code. After reaching end-of-ﬁle, if the number of copies is greater than 1, NM-TRAN<br>rewinds the ﬁle and re-reads it the speciﬁed number of times. After reaching end-of-ﬁle<br>on the ﬁnal (or only) copy, NMTRAN resumes reading the original control stream after<br>the include record.<br>
There may be more than one include record anywhere in the control stream, but they may<br>not be nested. That is, an included ﬁle may not contain include records.<br>
If an error is detected in the NMTRAN input, the line number displayed is cumulative.<br>The number of the line in the included ﬁle is added to the number of lines already read<br>from the control stream and any previous include ﬁles, as if the included ﬁle(s) are physi-<br>cally part of the control stream.<br>
EXAMPLE:<br>
$PROBLEM model A with data set 3<br>
include data3def<br>
include modela<br>
$THETA 1.3 4<br>
$OMEGA .04<br>
$SIGMA 1<br>
$ESTIMATION<br>
The ﬁle data3def contains the $INPUT and $DAT A statements. The ﬁle modela contains<br>the $SUBROUTINE statement, $PK block, and $ERROR block. one<br>
Verbatim comment lines may be present in an included ﬁle. If the character that immedi-<br>ately follows the initial &quot; is !, this conforms to the FORTRAN 90 syntax for comment<br>lines. The line is copied unchanged. If the character that immediately follows the initial<br>&quot; is C or c or &quot; or *, this conforms to the FORTRAN 77 syntax for comment lines. The<br>
407<br>
<hr>
<A name=413></a>INCLUDE DETAILED DESCRIPTIONS<br>
Help Guide<br>
line is copied unchanged, but C or c or &quot; or * is replaced by !.<br>
REFERENCES: None.<br>
408<br>
<hr>
<A name=414></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INDICATOR<br>
INDICATOR VARIABLES<br>
MEANING: Coding technique<br>CONTEXT: Abbreviated code<br>
DISCUSSION:<br>An indicator variable is a variable whose value is 0 or 1. It may be identiﬁed with an<br>input data item, or it may be a variable deﬁned in the abbreviated code. It is used to make<br>a choice in a computation.<br>
Suppose, for example, ICU is a variable which is either 0 or 1. The following code can<br>be used:<br>
IF (ICU.EQ.0) THEN<br>
CLM=TVCLM+ETA(1)<br>
ELSE<br>
CLM=TVCLM+ETA(2)<br>
ENDIF<br>
This can be coded unconditionally using an indicator variable:<br>CLM=TVCLM+(1-ICU)*ETA(1)+ICU*ETA(2)<br>
Unconditional code is preferred when MU variables are computed.<br>
In Guide V, Chapter 12, appears this example involving observations of two types, CP<br>and effect. The latter is modeled by the Emax model. Observations of both types are<br>recorded in the DV data item. A data item called TYPE with values 1 and 2 is used to<br>distinguish between them. This data item may be used to compute the appropriate pre-<br>diction in the $ERROR block, as follows:<br>
$ERROR<br>
EMAX=THETA(5)+ETA(3)<br>
C50=THETA(6)+ETA(4)<br>
EFF=EMAX*F/(C50+F)<br>
Y1=EFF+ERR(1)<br>
Y2=F+ERR(2)<br>
IF (TYPE.EQ.2) THEN<br>
Y=Y2<br>
ELSE<br>
Y=Y1<br>
ENDIF<br>
The last ﬁve lines of this example can also be coded as follows:<br>
Q=1<br>
IF (TYPE.EQ.2) Q=0<br>
Y=Q*Y1+(1-Q)*Y2<br>
A more general technique is to use two indicator variables. This technique can easily be<br>extended to the case of three or more choices.<br>
$ERROR<br>
EMAX=THETA(5)+ETA(3)<br>
C50=THETA(6)+ETA(4)<br>
EFF=EMAX*F/(C50+F)<br>
Y1=EFF+ERR(1)<br>
Y2=F+ERR(2)<br>
409<br>
<hr>
<A name=415></a>INDICATOR<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
Q1=0<br>
Q2=0<br>
IF (TYPE.EQ.1) Q1=1<br>
IF (TYPE.EQ.2) Q2=1<br>
Y=Q1*Y1+Q2*Y2<br>
REFERENCES: Guide V, section 7.5.3 , 7.5.4 , 12.5<br>
410<br>
<hr>
<A name=416></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INDIVIDUALS<br>
INDIVIDUALS<br>
MEANING: A data analysis unit<br>CONTEXT: NONMEM input/output<br>
DISCUSSION:<br>Data to be analyzed with NONMEM are often population data, by which is meant multi-<br>ple data arising from each of a number of individual units. Individuals are typically per-<br>sons, but they may be any other appropriate units, such as families, geographic localities,<br>etc. Data are regarded as being statistically independent from unit to unit.<br>
With NONMEM, there are two nested levels of random effects, The ﬁrst level applies to<br>individuals; different individuals are regarded as having different realizations of level-<br>one random effects. A second level of random effects applies to the observations from<br>each individual; different (univariate) observations are regarded as having different real-<br>izations of level-two randoms effects, but the same realization of level-one random<br>effects.<br>
The data from an individual is given in the data set by a contiguous group of data records,<br>with one observation on each data record, and all data records having the same identiﬁca-<br>tion (ID) data item. This group of data records is called the individual record, or level-<br>one (L1) record. (Do not confuse a <i>data record</i>, which is one record in a data ﬁle, with<br>an <i>individual record</i>, which is a group of data records.)<br>
Data to be analyzed may be single-subject data. These are data that appear to require at<br>most one level of random effects. (In fact, there are population data which require only<br>one level of the two NONMEM levels of random effects, along with a second level of<br>random effects which may be expressed in a way that is transparent to NONMEM. This<br>type of situation is communicated in such a way that NONMEM does not mistake these<br>data for single-subject data.) Such data may actually arise physically from different indi-<br>vidual units, or individuals. Indeed, when they do, they may even be comprised of multi-<br>ple data from different units, e.g. pairs of plasma and saliva concentrations obtained at the<br>same time point, each from a number of different subjects. However, if as with this<br>example, only one level of random effects is needed, these data are nonetheless consid-<br>ered to be single-subject data. The data are regarded as being statistically independent<br>from unit to unit. When single-subject data indeed arise physically from the same sub-<br>ject, the data can also be grouped into individual units such that the data are regarded as<br>being statistically independent from unit to unit. These units are also called &quot;individu-<br>als&quot;. As an example, there may be pairs of plasma and saliva concentrations from the<br>same subject. More precisely, NM-TRAN recognizes population data to be data that do<br>not qualify as single-subject data.<br>
NONMEM counts the number of distinct individuals in the data set, and reports this<br>count as a check.<br>
E.g.,<br>TOT. NO. OF INDIVIDUALS:<br>
166<br>
NONMEM 7 also reports how the data is to be analyzed:<br>
ANALYSIS TYPE: SINGLE-SUBJECT<br>
ANALYSIS TYPE: POPULATION<br>
ANALYSIS TYPE: POPULATION WITH UNCONSTRAINTED ETAS<br>
Population analysis with unconstrained etas is new with NONMEM 7, and can be used to<br>analyze a population data set as separate individuals. OMEGA diagonal values are ﬁxed<br>
411<br>
<hr>
<A name=417></a>INDIVIDUALS DETAILED DESCRIPTIONS<br>
Help Guide<br>
to a special value 1.0E+06.<br>
See Guide Introduction_7 &quot;Analyzing Single-subject data as Population with Uncon-<br>strained etas&quot;.<br>(See <b>recid2.exa</b>).<br>
REFERENCES: Guide I, section E<br>REFERENCES: Guide Introduction_7<br>
412<br>
<hr>
<A name=418></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INFERENTIAL<br>
INFERENTIAL STATISTICS<br>
MEANING: Inferential statistics<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>NONMEM provides estimates of the precision of its parameter estimates.<br>
Conﬁdence intervals for parameters, hypothesis tests on parameter values, and model-<br>building all require determination of plausible bounds on parameters. These can be<br>assigned if the distribution of the estimates (upon imagined replication of the data set)<br>can be estimated. Asymptotic statistical theory applied to extended least-squares estima-<br>tion (as used in NONMEM) says that the distribution of the parameter estimators is mul-<br>tivariate normal, with variance-covariance matrix that can be estimated from the data.<br>NONMEM supplies such an estimate of the variance-covariance matrix of the parameter<br>estimates (See <b>covariance matrix of estimate</b>). The square roots of the diagonal ele-<br>ments of that matrix are the estimated standard errors of the corresponding parameter<br>estimators (See <b>standard error of estimate</b>), while the off-diagonal elements can be<br>transformed into correlation coefﬁcients, and are presented in the correlation matrix of<br>the parameter estimates (See <b>correlation matrix of estimate</b>). The inverse of the covari-<br>ance matrix and the eigenvalues of the correlation matrix are also available (See <b>$covari-<br>ance</b>).<br>
REFERENCES: Guide V, section 5.4<br>
413<br>
<hr>
<A name=419></a>INFN DETAILED DESCRIPTIONS<br>
Help Guide<br>
INFN<br>
MEANING: INFN subroutine<br>CONTEXT: User-supplied subroutine; replaces a PREDPP dummy routine.<br>
USAGE:<br>SUBROUTINE INFN (ICALL,THETA,DATREC,INDXS,NEWIND)<br>USE SIZES, ONLY: ISIZE,DPSIZE<br>USE NMPRD_INT, ONLY: NWIND<br>INTEGER(KIND=ISIZE) :: ICALL,INDXS(*),NEWIND<br>REAL(KIND=DPSIZE) :: THETA(*),DATREC(*)<br>
DISCUSSION:<br>A run consists of one or more problems, and each problem consists of one or more sub-<br>problems. There are opportunities to make some rudimentary computations at the begin-<br>ning of a run (run initialization), at the beginning of a problem (problem initialization), at<br>the end of a subproblem (subproblem ﬁnalization), at the end of a problem (problem<br>ﬁnalization), and at the end of a run (run ﬁnalization). For example, at problem initializa-<br>tion, data transgeneration may take place, or a variable that will be modiﬁed at subprob-<br>lem ﬁnalization, may be initialized. At problem ﬁnalization, the value of this variable<br>may be written to a user ﬁle. There is no opportunity to do subproblem initialization.<br>
The INFN subroutine is called by PREDPP to make initialization and ﬁnalization compu-<br>tations. The version distributed with PREDPP is a &quot;stub&quot; or &quot;dummy&quot; routine that does<br>nothing. It may be replaced by a user-written code.<br>
Input/Output argument:<br>
ICALL<br>
ICALL=0: INFN may now make computations for run initialization. ICALL may be<br>reset by INFN to a number in the range 1-8999. This number will appear on NON-<br>MEM output, allowing the user to identify the INFN routine being used.<br>
ICALL=1: INFN may now make computations for problem initialization.<br>
ICALL=3: INFN may now make computations for subproblem ﬁnalization.<br>
ICALL=3: INFN may now make computations for problem ﬁnalization. If there are<br>subproblems, ﬁrst do subproblem ﬁnalization, if required.<br>
Then test for<br>
IREP=NREP (the number of the current subproblem equals the total number of sub-<br>problems), and if true, do problem ﬁnalization. Values of IREP and NREP may be<br>found in NONMEM modules<br>(See <b>Simulation: NREP,IREP</b>).<br>
ICALL=3: INFN may now make computations for run ﬁnalization. First do problem<br>ﬁnalization, if required. Then test for IPROB=NPROB (the number of the current<br>problem equals the total number of problems), and if true, do run ﬁnalization. Val-<br>ues of IPROB and NPROB may be found in NONMEM modules<br>(See <b>Problem_Iteration_Counters</b>).<br>
Input arguments:<br>
DATREC<br>
DATREC contains the ﬁrst data record of the current problem. (At ICALL=0, the<br>current problem is the ﬁrst problem.) Using PASS (see below), the contents of<br>DATREC are replaced by other data records for the current problem, allowing all<br>
414<br>
<hr>
<A name=420></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INFN<br>
these other records to be read and even modiﬁed.<br>
THETA<br>
The NONMEM THETA vector.<br>At ICALL=0, THETA contains the initial estimates for the ﬁrst problem.<br>At ICALL=1, THETA contains the initial estimates for the current problem.<br>At ICALL=3, THETA contains the ﬁnal estimates for the current problem.<br>
INDXS<br>
The values speciﬁed in the $INDEX record of the NM-TRAN control stream. (This<br>is the NONMEM INDXS array starting at position 12, the ﬁrst position beyond<br>those positions used by PREDPP itself.)<br>
NWIND<br>
NWIND has value 0 when INFN is called. It changes value during a pass through<br>the data using PASS (see below).<br>NWIND=0: First record of the data set.<br>NWIND=1: First record of a subsequent individual record.<br>NWIND=2: Subsequent data record of an individual record.<br>
EXAMPLES OF USAGE:<br>
Initialization<br>
Constants in the PK routine can be set if they are stored in a module or common<br>block declared both in INFN and PK.<br>
Transgeneration<br>
The data can be accessed and even modiﬁed via use of the NONMEM utility routine<br>PASS in routine INFN (See <b>pass</b>). As the data records are passed one-by-one to<br>INFN, each record is stored in turn in DATREC.<br>Data can be transgenerated and additional data items can be produced at both initial-<br>ization and ﬁnalization. Data items that appear in a table or scatterplot with a given<br>subproblem or problem are produced or left unchanged at the subproblem or prob-<br>lem ﬁnalization.<br>At ﬁnalization estimates of the eta’s can be obtained via the NONMEM utility rou-<br>tine GETETA. When used in conjunction with PASS, the values returned for the<br>eta’s with each call to GETETA are appropriate for the individual whose data record<br>is currently in DATREC.<br>
Interpolation<br>
As an example of transgeneration, interpolated values of a covariate can be com-<br>puted for event records in which values are missing, e.g. for other-type event records<br>that have been included so that predictions can be obtained at the times in these<br>records. This could also be done in PK or ERROR, but then this would be done with<br>ev ery call to these routines; if done in INFN, the computation is done once only.<br>
(See <b>Infn interpolation example</b>).<br>
REFERENCES: Guide VI, section VI.A , Figure 37<br>
415<br>
<hr>
<A name=421></a>INFN-DEFINED DETAILED DESCRIPTIONS<br>
Help Guide<br>
INFN-DEFINED VARIABLES<br>
MEANING: INFN-deﬁned global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>MODULE INFNP<br>
USE PRINFN, ONLY: TLCOM=&gt;ITV<br>
END MODULE INFNP<br>
GLOBAL DECLARATION:<br>MODULE PRINFN<br>
USE SIZES, ONLY : DPSIZE,DIMTMP<br>
IMPLICIT NONE<br>
SAVE<br>
REAL(KIND=DPSIZE), TARGET, DIMENSION (DIMTMP):: ITV<br>
END MODULE PRINFN<br>
DISCUSSION:<br>
PRINFN is a module for INFN-deﬁned variables. It contains an array ITV. (TLCOM is<br>suggested above as an alternate to the name ITV to be consistent with generated code,<br>but this is optional.) Variables are stored in PRINFN for communication with other other<br>blocks of abbreviated code or with user-written codes. These are variables deﬁned ﬁrst in<br>$INFN or in $PK-INFN or $ERROR-INFN blocks. Module PRINFN is declared in all<br>generated routines PK, ERROR, etc., and the variables can be used as right-hand quanti-<br>ties in these routines. INFN-deﬁned variables are not initialized or modiﬁed by NON-<br>MEM or PREDPP. Hence the variables in the module may be initialized or modiﬁed at<br>ICALL values 0 or 1 or 3, and will retain whatever values they are given. These variables<br>cannot be displayed in tables or scatterplots. If they are to be displayed, WRITE state-<br>ments can be used, or their values can be assigned to variables that are listed in module<br>NMPRD4. (See <b>PRED-deﬁned_variables</b>).<br>
Variables from PRINFN can be used in a user-written code. MODULE INFNP must be<br>deﬁned as above prior to the SUBROUTINE statement. The variables have names<br>TLCOM(1), TLCOM(2), etc.<br>E.g., X=TLCOM(1)/TLCOM(2). It is possible to give the variables the same (non-sub-<br>scripted) names that they had in $INFN. Suppose variables X1 and X2 are used in<br>$INFN, and the following is present in the generated INFN routine:<br>
X1=&gt;TLCOM(00001); X2=&gt;TLCOM(00002)<br>
In the user-written code, after the last declaraction, include:<br>
POINTER :: X1,X2<br>
Prior to the ﬁrst executable statement, include:<br>
X1=&gt;TLCOM(1); X2=&gt;TLCOM(2)<br>
Now the code is X=X1/X2.<br>
Code generated by NM-TRAN is somewhat more complex, but achieves the same result.<br>
REFERENCES: None.<br>
416<br>
<hr>
<A name=422></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INITIAL<br>
INITIAL ESTIMATE (INITIAL EST)<br>
MEANING: Initial estimates of parameters THETA, OMEGA, SIGMA<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>Initial estimates of parameters are required by NONMEM. They are used, for example,<br>to compute the initial value of the objective function (before NONMEM begins its search<br>for ﬁnal estimates). The user may provide initial estimates. Alternatively, he may<br>request that NONMEM provide initial estimates.<br>
(NONMEM may also use as initial estimates the ﬁnal estimates from a previous run, by<br>means of a Model Speciﬁcation File; (See <b>model speciﬁcation ﬁle</b>). When an MSFI is<br>used, the outputs described here do not appear.)<br>
NONMEM output reﬂects initial estimates provided by the user on its problem summary<br>page as in this example:<br>
INITIAL ESTIMATE OF THETA:<br>
LOWER BOUND<br>
INITIAL EST<br>
UPPER BOUND<br>
0.0000E+00 0.1500E+03 0.1000E+07<br>
0.0000E+00 0.0000E+00 0.0000E+00<br>
0.1000E+00 0.3000E+00 0.1000E+02<br>
-0.1000E+07 -0.1000E-01 0.1000E+07<br>
INITIAL ESTIMATE OF OMEGA:<br>
0.2500E+00<br>
0.0000E+00 0.2500E+00<br>
INITIAL ESTIMATE OF SIGMA:<br>
0.2500E+00<br>
The above states that:<br>
1) The initial estimate of theta(1) is 150, and the parameter is constrained to be<br>
greater than zero (no upper bound).<br>
2) Theta(1) is ﬁxed at zero.<br>
3) The initial estimate of theta(3) is .3, and the parameter is constrained to lie<br>
between .1 and 10.<br>
4) The initial estimate of theta(4) is -.01, and the parameter is unconstrained.<br>
5) OMEGA is 2x2 and constrained to be diagonal (signiﬁed by the 0 value of the<br>
initial estimate of omega(2,1); the initial estimates of omega(1,1) and<br>omega(2,2) are .25.<br>
6) SIGMA is 1x1 (a scalar), with initial estimate .25.<br>
If the initial estimate of an element of THETA is left blank, this indicates that the user has<br>requested that NONMEM provide the initial estimate, as in this example:<br>
INITIAL ESTIMATE OF THETA:<br>
LOWER BOUND<br>
INITIAL EST<br>
UPPER BOUND<br>
0.1000E+00 0.1000E+02<br>
Similarly, if the initial estimate of all or part of OMEGA and/or SIGMA is not printed,<br>this indicates that the user has requested that NONMEM provide the missing initial<br>
417<br>
<hr>
<A name=423></a>INITIAL DETAILED DESCRIPTIONS<br>
Help Guide<br>
estimate(s).<br>
NONMEM performs a search for missing initial estimates as its ﬁrst task. With NON-<br>MEM 7.4, when initial thetas are to be estimated, evaluations can now be done for FOCE<br>and Laplace, not just for FO. The complete set of initial estimates (including those pro-<br>vided by the user and those provided by NONMEM) are printed on a separate page under<br>the heading &quot;INITIAL PARAMETER ESTIMATE&quot;, as in the following example. The<br>format is identical to that of the &quot;FINAL PARAMETER ESTIMATE&quot; page. If all initial<br>parameter estimates are provided by the user, this page does not appear.<br>
******************** INITIAL PARAMETER ESTIMATE<br>
***<br>
THETA - VECTOR OF FIXED EFFECTS PARAMETERS<br>
**********<br>
TH 1<br>
TH 2<br>
TH 3<br>
1.50E+00 1.02E-01 2.90E+01<br>
OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS<br>
********<br>
ETA1<br>
ETA1 1.50E+00<br>
This example is from a run involving single-subject data, so there is no SIGMA matrix.<br>
(See <b>ﬁnal parameter estimate</b>).<br>
REFERENCES: Guide IV, section III.B.9 , III.B.10 , III.B.11<br>
418<br>
<hr>
<A name=424></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INITIAL<br>
INITIAL STEADY STATE: I SS,ISSMOD<br>
MEANING: PREDPP-PK global variables<br>CONTEXT: PK routine<br>
USAGE:<br>USE PRMOD_INT, ONLY: I_SS,ISSMOD<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: I_SS,ISSMOD<br>
DISCUSSION:<br>
Used for the Initial Steady State feature of PREDPP, with the general non-linear models<br>(ADVAN6, ADVAN8, ADVAN9, ADVAN13, ADVAN14, ADVAN15).<br>
By default, the initial conditions (i.e., compartment amounts) are zero at the start of each<br>individual record. Different initial conditions may be computed using the I_SS (Initial<br>Steady State) feature of MODEL and/or PK.<br>
ISSMOD may be set by MODEL.<br>(Note that the option of the $MODEL record is I_SS, not ISSMOD.)<br>Default: -1 (MODEL does not request the I_SS feature)<br>Values 0, 1, 2 and 3 are permitted. Value 0 requests that no steady state be computed.<br>ISSMOD values 1, 2, or 3 requests that PREDPP compute an initial steady state for the<br>model before the ﬁrst event record of an individual record, or after a reset event. The<br>results are identical to those that would be computed by a steady-state dose event record<br>with SS=ISSMOD and AMT=0 and RATE=0. If endogenous drug is speciﬁed in the dif-<br>ferential equations, non-zero initial conditions will be computed.<br>
I_SS may be set by PK.<br>Default: -1 (PK does not request the I_SS feature)<br>Values are the same as ISSMOD, with the same effect. This allows I_SS to be set condi-<br>tionally, e.g., if some subjects are at steady-state and others are not. If both ISSMOD and<br>I_SS are set, then the value of I_SS overrides that of ISSMOD.<br>
There is no difference between values 1, 2 and 3 of I_SS unless the PK routine also uses<br>the compartment initialization feature A_0. The I_SS feature behaves exactly like a<br>steady state dose record in this regard. Speciﬁcally,<br>
With I_SS=1 (&quot;reset&quot;), values of A_0 are ignored.<br>With I_SS=2 (&quot;sum&quot;), values of A_0 are added to the SS values.<br>With I_SS=3 (&quot;initial ests&quot;), values of A_0 are used as initial estimates when com-<br>puting the SS values.<br>
(and similarly for ISSMOD).<br>
If ISSMOD is set, or I_SS is set at ICALL=1, PREDPP will acknowlege the fact in the<br>NONMEM output.<br>
When I_SS or ISSMOD is set, even if only to 0, then SSS and the appropriate SS routine<br>are included in the NONMEM executable.<br>
When I_SS or ISSMOD is set, even if only to 0, or verbatim code is present in the $PK or<br>$INFN block, then NM-TRAN includes I_SS,ISSMOD in the PK and/or INFN routine.<br>
Example: $PK may include code such as<br>
IF (TYPE.EQ.1) THEN<br>
I_SS=1<br>
419<br>
<hr>
<A name=425></a>INITIAL DETAILED DESCRIPTIONS<br>
Help Guide<br>
ELSE<br>
I_SS=0<br>
ENDIF<br>
(See <b>$model</b>, <b>$pk</b>, <b>model</b>, <b>pk</b>).<br>
Location prior to NONMEM 7: prdpk4<br>
REFERENCES: None.<br>
420<br>
<hr>
<A name=426></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INITIAL.-FINAL.<br>
INITIALIZATION-FINALIZATION BLOCK<br>
MEANING: Abbreviated code for initialization and ﬁnalization<br>CONTEXT: $PRED, $PK, $ERROR, $INFN abbreviated code<br>
SAMPLE:<br>$PRED<br>
IF (ICALL.EQ.1) CALL SUPP(0,1)<br>
DISCUSSION:<br>
A run consists of one or more problems, and each problem consists of one or more sub-<br>problems, which are iterations of various tasks speciﬁed in the problem. The &quot;end&quot; of a<br>subproblem refers to the end of such an iteration. Problems themselves may be organized<br>into superproblems, which may be iterated. The &quot;beginning&quot; and &quot;end&quot; of a superprob-<br>lem refers to the beginning and end of the ﬁrst and last iterations of the superproblem.<br>There are opportunities to make some rudimentary computations at:<br>
the beginning of a run (run initialization)<br>the beginning of a superproblem (superproblem initialization)<br>the beginning of a problem (problem initialization)<br>the end of a subproblem (subproblem ﬁnalization)<br>the end of a problem (problem ﬁnalization)<br>the end of a superproblem (superproblem ﬁnalization)<br>the end of a run (run ﬁnalization)<br>
For example, data transgeneration may take place at problem initialization. Or, a variable<br>may be initialized at problem initialization and modiﬁed at each subproblem ﬁnalization,<br>and its ﬁnal value written to a user ﬁle at problem ﬁnalization. There is no opportunity to<br>do subproblem initialization. When using abbreviated code, initialization and ﬁnalization<br>opportunities are signalled by values of the variable ICALL:<br>
ICALL=0<br>
Run initialization.<br>
ICALL=1<br>
Superproblem and Problem initialization.<br>ICALL is set to 1 to signal problem initialization. When this happens:<br>
If a superproblem requires initialization, test<br>(i) S1IT (number of current superproblem iteration) equals 1 (or S2IT=1),<br>(ii) S1NUM (number of current superproblem) equals appropriate value, and<br>(iii) IPROB (number of current problem) equals number of ﬁrst problem in super-<br>problem,<br>and if (i)-(iii) are true, do superproblem initialization<br>(See <b>Problem_Iteration_Counters</b>).<br>
ICALL=3<br>
Subproblem, Problem, Superproblem and Run ﬁnalization.<br>ICALL is set to 3 to signal problem ﬁnalization. When this happens:<br>
If a problem with subproblems requires ﬁnalization, test<br>
421<br>
<hr>
<A name=427></a>INITIAL.-FINAL. DETAILED DESCRIPTIONS<br>
Help Guide<br>
IREP=NREP (number of the current subproblem equals total number of subprob-<br>lems) and if true, do problem ﬁnalization<br>(See Simulation: NREP,IREP).<br>
If a superproblem requires ﬁnalization, test<br>(i) S1IT=S1NIT (number of the current superproblem iteration equals total number<br>of superproblem iterations) (or S2IT=S2NIT),<br>(ii) S1NUM (number of current superproblem) equals appropriate value,<br>(iii) IPROB (number of current problem) equals number of last problem in the<br>superproblem, and<br>(iv) IREP=NREP, if there are subproblems with the last problem in the superprob-<br>lem<br>and if (i)-(iv) are true, do superproblem ﬁnalization.<br>
If a run having multiple problems requires ﬁnalization, test<br>(i) S1IT=S1NIT (or S2IT=S2NIT), if there are superproblems<br>(ii) S1NUM equals number of last superproblem, if there are superproblems,<br>(iii) IPROB=NPROB (number of the current problem equals total number of prob-<br>lems), and<br>(iv) IREP=NREP, if there are subproblems with the last problem in the superprob-<br>lem<br>and if (i)-(iv) are true, do run ﬁnalization.<br>
An initialization block is a block of abbreviated code that is only executed at ICALL=0 or<br>ICALL=1. A ﬁnalization block is a block of abbreviated code that is only executed at<br>ICALL=3. E.g.,<br>
IF (ICALL.EQ.1) THEN<br>
... initialization block ...<br>
ENDIF<br>
Such blocks may be present in $PRED, $PK, $ERROR, and $INFN blocks of abbreviated<br>code. If such blocks are present in $PK or $ERROR, an INFN routine is used to imple-<br>ment the logic in these blocks. Initialization and ﬁnalization blocks will be implemented<br>by means of a generated FORTRAN subroutine.<br>
Variables may be used as right-hand quantities even before they are deﬁned; if an expres-<br>sion which uses such a variable is computed before any value of the variable is computed,<br>the computation of the expression will be uncertain.<br>
Assignment, conditional, WRITE and PRINT statements may be used.<br>
In addition, these rules apply:<br>
Deﬁned quantities are not regarded as random variables; eta derivatives are not computed<br>in an initialization or ﬁnalization block<br>
Transgeneration of the data is permitted. NONMEM data items ID and MDV may not be<br>changed. If a data item label may appear on the left of an assignment statement, then<br>NM-TRAN generates assignment statements changing ﬁrst the data item in the event or<br>data record, and then the value of the local variable having that label. Note, however, that<br>at ICALL=0,1,or 3, by default, references to data items are references to those data items<br>
422<br>
<hr>
<A name=428></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INITIAL.-FINAL.<br>
in the ﬁrst data or event record. To transgenerate an item in any data or event record<br>(including the ﬁrst), use of the NONMEM utility routine PASS is required. See below.<br>
Calls to certain NONMEM routines are permitted:<br>
CALL PASS(MODE)<br>
CALL RANDOM(n,R)<br>
CALL SUPP(ie,ic)<br>
CALL PASS(MODE) must be coded exactly in this way. If CALL PASS(MODE)<br>is present, MODE becomes a reserved variable and may be used only with other<br>instances of CALL PASS(MODE). Multiple calls to PASS may be present.<br>
If CALL RANDOM(n,R) is present, R becomes a reserved variable and may be<br>used only with other instances of CALL RANDOM(n,R). n may only be an integer<br>value 1-10.<br>
SUPP is used to suppress portions of the NONMEM output report. (See <b>supp</b>). The<br>arguments ie and ic may only be 0 or 1.<br>
The following variables may be used on the right (their values change with calls to<br>PASS):<br>
Data record items (See <b>PASS: PASSRC</b>).<br>NEWIND (See <b>PASS NEWIND: NWIND</b>).<br>NIREC, NDREC (See <b>Record Counters: NIREC,NDREC</b>).<br>NEWL2 (See <b>PASS New L2 record: NEWL2</b>).<br>ETA when ICALL=3 (See <b>Simulation: ETA,EPS</b>)<br>LIREC (See <b>Size of Individual Record</b>)<br>PRED_, RES_, WRES_ when ICALL=3 (See <b>PRED,RES,WRES</b>).<br>IERE, IERC when ICALL=3 (See <b>Estim Covar Error Codes</b>).<br>NINDR, INDR1, INDR2 (See <b>NINDR INDR1 INDR2</b>).<br>NREP, IREP (See <b>Simulation: NREP,IREP</b>).<br>NPROB, IPROB, S1NUM, S2NUM, S1NIT, S2NIT, S1IT, S2IT (See <b>Prob-<br>lem_Iteration_Counters</b>).<br>
RETURN and EXIT statements may be used.<br>
DOWHILE loops are permitted. The syntax is as follows.<br>
DO WHILE (condition)<br>
.. statements ..<br>
END DO<br>
Here is an example of a transgeneration loop.<br>
$PRED<br>
IF (ICALL.EQ.0) THEN<br>
MODE=0<br>
CALL PASS (MODE)<br>
MODE=2<br>
CALL PASS (MODE)<br>
DO WHILE (MODE.EQ.2)<br>
... transgeneration statements ...<br>
CALL PASS (MODE)<br>
ENDDO<br>
RETURN<br>
ENDIF<br>
423<br>
<hr>
<A name=429></a>INITIAL.-FINAL. DETAILED DESCRIPTIONS<br>
Help Guide<br>
This type of usage of the PASS routine can be coded more simply, as follows:<br>
$PRED<br>
IF (ICALL.EQ.0) THEN<br>
DOWHILE (DATA)<br>
... transgeneration statements ...<br>
ENDDO<br>
RETURN<br>
ENDIF<br>
The DOWHILE (DATA) causes the transgeneration statements to be executed with<br>each data record. In effect, NM-TRAN supplies the statements MODE=... and<br>CALL PASS(MODE) that are shown in the above.<br>
Variables that are ﬁrst deﬁned in an initialization block or ﬁnalization block are not stored<br>globally in NMPRD4, but rather, are stored in module PRINFN. (This makes them avail-<br>able to subroutine MIX.)<br>
Variables deﬁned in an initialization or ﬁnalization block may be used freely outside of<br>such blocks, and vice versa: PRED-deﬁned variables deﬁned outside such blocks may be<br>used within them.<br>
THETA variables may be used in initialization and ﬁnalization blocks. They are obtained<br>from the subroutine argument.<br>At ICALL=0, THETA contains the initial estimates for the ﬁrst problem.<br>At ICALL=1, THETA contains the initial estimates for the current problem.<br>At ICALL=3, THETA contains the ﬁnal estimates for the current problem.<br>
Here is an example of code that could be used during a simulation with multiple<br>subproblems.<br>$PRED<br>
IF (ICALL.EQ.1) THEN<br>
SUM=0<br>
N=0<br>
RETURN<br>
ENDIF<br>
IF (ICALL.EQ.3) THEN<br>
N=N+1<br>
SUM=SUM+THETA(1)<br>
RETURN<br>
ENDIF<br>
IF (ICALL.EQ.3.AND.N.EQ.NREP) THEN<br>
MEAN=SUM/N<br>
PRINT *,MEAN<br>
ENDIF<br>
The following variables may be referenced as right-hand quantities in initialization and<br>ﬁnalization blocks. (Note also that unsubscripted arrays may appear in a WRITE state-<br>ment.)<br>
OMEGA(n,m)<br>SIGMA(n,m)<br>(See <b>Parameter Values: Initial and Final</b>).<br>(See <b>write print</b>).<br>
The following variables may be referenced as right-hand quantities in ﬁnalization blocks.<br>(Note also that unsubscripted arrays may appear in a WRITE statement.)<br>
424<br>
<hr>
<A name=430></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
INITIAL.-FINAL.<br>
SETHET(n)<br>SETHETR(n)<br>SEOMEG(n,m)<br>SESIGM(n,m)<br>OBJECT<br>(See <b>Standard Errors</b>).<br>(See <b>Objective Function Value</b>).<br>(See <b>write print</b>).<br>
The following statements are forbidden:<br>
CALL SIMETA(ETA)<br>
CALL SIMEPS(EPS)<br>
When the PRED repetition feature is used, the variables RPTO and PRDFL may appear as<br>left-hand quantities in initialization blocks.<br>(See <b>Repetition Variables</b>).<br>
(See <b>abbreviated</b>).<br>
REFERENCES: Guide II, section D.2.2<br>REFERENCES: Guide VI, section VI.A , Figure 37<br>
425<br>
<hr>
<A name=431></a>INTRA DETAILED DESCRIPTIONS<br>
Help Guide<br>
INTRA AND INTER-INDIVIDUAL<br>
MEANING: Types of random errors<br>CONTEXT: NONMEM terminology<br>
DISCUSSION:<br>
Random intra-individual (&quot;within an individual&quot;) and inter-individual (&quot;between individu-<br>als&quot;) variability are terms that are used in discussing NONMEM output.<br>
Case 1. When the data are population<br>
Random inter-individual variability refers to the unexplained difference between<br>individuals’ parameter values and the typical values in the population. It is<br>described in NM-TRAN using ETA(n) variables. PRED describes the effect of<br>these variables to NONMEM via the partial derivatives in the G array. The variance<br>of these variables is given in the OMEGA matrix.<br>
Random intra-individual variability refers to unexplained (residual) error in a model<br>(the difference between observed and predicted values). It is described in NM-<br>TRAN using EPS(n) or ERR(n) variables. PRED describes the effect of these<br>variables to NONMEM via the partial derivatives in the H array. The variance of<br>these variables is given in the SIGMA matrix.<br>
Case 2. When the data are single-subject<br>
Random inter-individual variability refers unexplained (residual) error in a model<br>(the difference between observed and predicted values). This, despite the fact that<br>data may come from a single subject, is because each observation is placed into a<br>separate individual record, and because only level-one random effects are needed to<br>describe it. It is described in NM-TRAN using ERR(n) or ETA(n) variables.<br>PRED describes the effect of these variables to NONMEM via the partial derivatives<br>in the G array. The variance of these variables is given in the OMEGA matrix.<br>
However, when the data are in fact from a single subject, and when there is no need<br>to use NONMEM terminology, then users often associate the ETA(n) and OMEGA<br>with intra-individual variability, which corresponds to their experimental point of<br>view.<br>
REFERENCES: Guide I, section A.5 , E<br>
426<br>
<hr>
<A name=432></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
L2<br>
L2 DAT A ITEM<br>
MEANING: Level Two (L2) data item for NONMEM<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... L2 ...<br>
DISCUSSION:<br>L2 labels level-two (L2) data items. The level two data item is optional.<br>
Recall that the ID data item is used to group together the data records containing observa-<br>tions which have the same realization of the level-one random effects (etas). Similarly,<br>the L2 data item is used to group together the data records containing observations which<br>have the same realization of the level-two random effects (epsilons). The observations of<br>such a group is called a level-two observation. The group itself is called a level-two (L2)<br>record. Data records of an L2 record must be contiguous (and contained within the same<br>individual record). By default, level-two observations are treated as being statistically<br>independent multivariate observations. (However, within a level-one observation, the<br>level-two random effects can be made to be correlated between level-two observations.)<br>
Here is an example of a fragment of a data set using L2 data items. There are two types<br>of observations, designated by the two different values of the user data item TYPE. Note<br>that the L2 data items are the same for both of the observations at TIME=2, and they are<br>also the same for both of the observations at TIME=112.5.<br>
ID TIME<br>
AMT APGR<br>
WT DV TYPE L2<br>
1<br>
0.<br>
25.0 1.4<br>
7<br>
.<br>
.<br>
1<br>
1<br>
2.0 .<br>
1.4 7<br>
6.0 1 1<br>
1<br>
2.0 .<br>
1.4 7<br>
17.3 2 1<br>
1<br>
12.5 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
24.5 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
37.0 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
48.0 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
60.5 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
72.5 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
85.3 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
96.5 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
108.5 3.5 1.4<br>
7<br>
.<br>
2<br>
2<br>
1<br>
112.5 .<br>
1.4 7<br>
8.0 1 2<br>
1<br>
112.5 .<br>
1.4 7<br>
31.0 2 2<br>
When the data are single-subject and the L2 data item is deﬁned to NM-TRAN in a<br>$INPUT record, the ID data item is taken to be the L2 data item. The ID item may be<br>deﬁned, but then it is not in turn identiﬁed to NONMEM as such. The labels L2 and ID<br>(if deﬁned) may be used in abbreviated code, and then they refer to the corresponding<br>items of the data record, as speciﬁed in the $INPUT record. However, if the user uses the<br>label L1 instead of the label ID, or uses the label L1 as a synonym with the ID label, then<br>NM-TRAN does not change the designations: For NONMEM, the items labeled L1 are<br>taken to be the ID data items, and the items labeled L2 are taken to be the L2 data items.<br>
REFERENCES: Guide II, section D.3.3<br>REFERENCES: Guide V, section 12.4.2 , 12.5<br>
427<br>
<hr>
<A name=433></a>MDVRES DETAILED DESCRIPTIONS<br>
Help Guide<br>
MDVRES<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY: MDVRES<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: MDVRES<br>
DISCUSSION:<br>
MDVRES stands for missing dependent variable (MDV) for residual (RES). Setting<br>MDVRES to 1 is equivalent to temporarily declaring an observation as missing during the<br>computation of residuals and weighted residuals.<br>
MDVRES=0 (default)<br>
Set MDVRES to 1 in the $ERROR or $PRED routine if you do not want to include a par-<br>ticular observation in the computation of residual and weighted residuals.<br>
One situation in which this may be useful is when F_FLAG is used because some obser-<br>vations are predictions (F_FLAG=0) and others are likelihood or -2 log likelihood values<br>(F_FLAG=1 or F_FLAG=2). By default, if F_FLAG is set to 1 or 2 for any observation<br>within an individual record, the RES and WRES items will be 0 for all data records in the<br>individual record. When MDVRES is set to 1 for any observation, this overrides the<br>default. NONMEM will compute RES and WRES for all observations for which<br>MDVRES is set to 0. MDVRES should be set to 1 with all observations having<br>F_FLAG=1 or F_FLAG=2, but may be set to 1 for other observations as well.<br>
EXAMPLE:<br>
Supose that some observations are assessed by a non-normal distribution likelihood such<br>as the PHI() function for below detection limit values, in which F_FLAG is set. By set-<br>ting MDVRES=1 to these particular below detection values, the weighted residual algo-<br>rithm can assess the remaining normally distributed values for that subject.<br>
$ERROR<br>
SD = THETA(5)<br>
IPRED = LOG(F)<br>
DUM = (LOQ - IPRED) / SD<br>
CUMD = PHI(DUM)<br>
IF (TYPE .EQ. 1) THEN<br>
F_FLAG = 0<br>
Y = IPRED + SD * ERR(1)<br>
ENDIF<br>
IF (TYPE .EQ. 2) THEN<br>
F_FLAG = 1<br>
Y = CUMD<br>
MDVRES=1<br>
ENDIF<br>
REFERENCES: Guide Introduction_7<br>
428<br>
<hr>
<A name=434></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MINIMUM<br>
MINIMUM VALUE OF OBJ. FUNCTION<br>
MEANING: The value of the objective function<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>The NONMEM OBJECTIVE FUNCTION is a goodness of ﬁt statistic; the lower the<br>value, the better the ﬁt. Negative values are possible and have no special signiﬁcance.<br>Under certain assumptions, the (default) objective function value is minus twice the log<br>likelihood.<br>
A page with the title MINIMUM VALUE OF OBJECTIVE FUNCTION&quot; is printed as<br>part of every NONMEM output, as in this example.<br>
****** MINIMUM VALUE OF OBJECTIVE FUNCTION<br>
***********<br>
***************** 11.570<br>
******************************<br>
If the Estimation Step was NOT run, then the value printed is the value of the objective<br>function using the initial parameter estimates speciﬁed for the problem.<br>
If the Estimation Step WAS run, then the value printed is the value of the objective func-<br>tion with the ﬁnal parameter estimates.<br>
Differences in the objective function of ﬁts of the same data to hierarchical models can<br>often be used to test approximately the plausibility of the smaller (fewer free parameters)<br>model by referencing the difference to a chi-square distribution with degrees of freedom<br>equal to the difference in the number of free model parameters between models (hypothe-<br>sis tests).<br>
Sometimes NM-TRAN may generate this warning message:<br>
(WARNING 68) THE INTEGER FUNCTION IS BEING USED OUTSIDE OF A SIMULATION<br>
BLOCK. IF THE INTEGER VALUE AFFECTS THE VALUE OF THE OBJECTIVE FUNCTION,<br>
THEN AN ERROR WILL PROBABLY OCCUR.<br>
In general, any code that affects the value of the prediction F (with $PRED) or Y (with<br>$ERROR), or their eta and eps partials, affects the value of the objective function. Such<br>code must be continuous, e.g., must not use functions such as INT or MOD, and must not<br>involve conditional statements that introduce discontinuities. The following examples<br>use Model Event Time parameters (MTIME) to avoid discontinuities in differential equa-<br>tions:<br>
Model Time examples<br>Examples Using MTIME to Model Periodic Discontinuities in $DES<br>Enterhepatic circulation examples<br>
(See <b>mtime</b>, <b>model time examples</b>).<br>(See <b>Circadian Example: Examples Using MTIME to Model Periodic Discontinu-<br>ities in $DES</b>)<br>(See <b>Enterhepatic circulation examples</b>).<br>
REFERENCES: Guide I, section C.3.5.1<br>REFERENCES: Guide V, section 5.5<br>
429<br>
<hr>
<A name=435></a>MIX DETAILED DESCRIPTIONS<br>
Help Guide<br>
MIX CONTR: TEMPLT<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied PRED routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: TEMPLT=&gt;VRAW<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: VSIZE,DPSIZE<br>
REAL(KIND=DPSIZE) :: VRAW(VSIZE)<br>
DISCUSSION:<br>
TEMPLT<br>
This variable serves two different purposes.<br>At ICALL=6, the template data record is stored in TEMPLT.<br>When MIX is called, the ﬁrst data record of the individual record is stored in TEM-<br>PLT.<br>
TEMPLT(n) may be used as a right-hand quantity in blocks of abbreviated code that test<br>for ICALL=6 and in $MIX blocks. The &quot;n&quot; may be either a position in the data record or<br>the label of the data item, e.g. TEMPLT(1) or TEMPLT(ID).<br>
Location prior to NONMEM 7: rocm31<br>
REFERENCES: None.<br>
430<br>
<hr>
<A name=436></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MIX<br>
MIX CONTR: THETA<br>
MEANING: NONMEM read-only global variables<br>
CONTEXT: MIX, CONTR, CCONTR routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: THETA=&gt;THETAC<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LTH,DPSIZE<br>
REAL(KIND=DPSIZE) :: THETAC(LTH)<br>
DISCUSSION:<br>
THETA<br>
The current value of theta, made available by NONMEM for the MIX, CONTR and<br>CCONTR routines. THETA is a reserved varible in $MIX abbreviated code.<br>
Location prior to NONMEM 7: rocm0<br>
REFERENCES: Guide VI, section III.L.2 , Figure 6<br>
431<br>
<hr>
<A name=437></a>MIX DETAILED DESCRIPTIONS<br>
Help Guide<br>
MIX<br>
MEANING: MIX subroutine<br>CONTEXT: User-supplied subroutine; replaces a NONMEM dummy routine<br>
USAGE:<br>SUBROUTINE MIX (ICALL,NSPOP,P)<br>
USE SIZES, ONLY: ISIZE,DPSIZE,LTH<br>
USE ROCM_REAL, ONLY: THETA=&gt;THETAC<br>
INTEGER(KIND=ISIZE), INTENT(IN) :: ICALL<br>
INTEGER(KIND=ISIZE), INTENT(OUT) :: NSPOP<br>
REAL(KIND=DPSIZE), INTENT(OUT) :: P(*)<br>
GLOBAL DECLARATION:<br>REAL(KIND=DPSIZE) :: THETAC(LTH)<br>
DISCUSSION:<br>MIX is a NONMEM routine that is replaced by a user-supplied routine when a mixture<br>model is used. The MIX subroutine is used to describe the mixture parameters of a mix-<br>ture model. It is called by NONMEM with one individual record after another.<br>
Input argument:<br>
ICALL<br>
Similar to ICALL for PRED subroutine.<br>
Output argument:<br>
NSPOP<br>
An integer variable or integer constant. The maximum number of sub-populations<br>that are possible. Must be given a value when ICALL=1.<br>
P<br>
An array. For each i (i=1, ... , NSPOP), P(i) gives the modeled fraction of the popu-<br>lation in the ith subpopulation. The sum of the P(i) should equal 1. In principle, the<br>P(i) can change from individual to individual. If for a given individual, the second<br>(for example) subpopulation doesn’t apply, then set P(2)=0 for that individual.<br>
Other inputs are available to MIX in NONMEM read-only global variables. In particular,<br>data items that are requested using the $CONTR record, and the current value of THETA,<br>as shown above.<br>(See <b>MIX:_DAT A</b>, <b>MIX CONTR:_THETA</b>).<br>
The TEMPLT data record in a NONMEM read-only global variable also serves to pro-<br>vide an additional way for individual-speciﬁc information to be made available<br>(See <b>MIX_CONTR:_TEMPLT</b>)<br>
With mixture models, MIXNUM, MIXEST and MIXP are variables that may be used as<br>right-hand quantities (or in logical conditions) in various other abbreviated codes or user-<br>supplied routines. MIXNUM is the index of the subpopulation for which variables are to<br>be computed. At ICALL=3, and at ICALL=2 when COMACT is not 0, MIXEST is the<br>index of the subpopulation estimated to be that from which the individual’s data most<br>probably arises. MIXP refers to the mixture probabilities P computed by subroutine<br>MIX.<br>
This is a general description. For details, see mixnum.<br>
(See <b>MIXNUM_MIXEST_MIXP</b>)<br>(See <b>mixnum_mixest_for_mixture_model</b>)<br>
432<br>
<hr>
<A name=438></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MIX<br>
(See <b>Mixture_model:_MIXP</b>)<br>(See <b>mixture_model_example</b>, <b>mixnum_mixest</b>).<br>
REFERENCES: Guide III, section V.5.0<br>
REFERENCES: Guide IV, section III.B.4 , III.B.6<br>REFERENCES: Guide IV, section IV.E.1 , 4.E.2<br>REFERENCES: Guide VI, section III.L.2 , Figure 6<br>
433<br>
<hr>
<A name=439></a>MIX: DETAILED DESCRIPTIONS<br>
Help Guide<br>
MIX: DAT A<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: MIX routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: DATA=&gt;RDATA<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: NO,DPSIZE<br>
REAL(KIND=DPSIZE) :: RDATA(NO,3)<br>
DISCUSSION:<br>
DATA(k,i)<br>
The value of the ith type of data item speciﬁed in NM-TRAN’s $CONTR record,<br>appearing on the kth observation record of the individual record. It changes values<br>with each individual record. DAT A is a reserved variable in $MIX abbreviated<br>code.<br>
DATA is also used in CONTR<br>(See <b>CCONTR:_Y,DAT A,N1,N2,DIM</b>)<br>
Location prior to NONMEM 7: rocm1<br>
REFERENCES: Guide IV, section III.B.4<br>
434<br>
<hr>
<A name=440></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MIXNUM MIXEST MIXP<br>
MIXNUM MIXEST MIXP<br>
MEANING: Variables used with mixture models<br>CONTEXT: Abbreviated code and user-supplied subroutines<br>
USAGE:<br>IF (MIXNUM.EQ.1) THEN<br>
...<br>
ENDIF<br>
IF (MIXNUM.EQ.2) THEN<br>
...<br>
ENDIF<br>
IF (MIXNUM.EQ.3) THEN<br>
...<br>
ENDIF<br>
DISCUSSION:<br>
With mixture models, MIXNUM, MIXEST and MIXP are global variables that may be<br>used as right-hand quantities (or in logical conditions) in abbreviated code or user-sup-<br>plied routines.<br>In general:<br>MIXNUM is an input to PRED (or PREDPP) set by NONMEM.<br>MIXEST is an output (result) or consequence from the estimation set by NONMEM.<br>
MIXNUM<br>
This is the index of the subpopulation for which variables are to be computed.<br>
During ICALL=4, MIXNUM is the index of the sub-population that was randomly<br>selected to simulate the subject’s data. When ICALL=3 and the PASS subroutine used,<br>or when ICALL=5 or 6, MIXNUM is the index of the subpopulation estimated to be that<br>from which the individual’s data most probably arises, and is equal to MIXEST (see<br>below).<br>
MIXEST<br>
When ICALL=3,5,6, and at ICALL=2 when COMACT is not 0, MIXEST is the index of<br>the subpopulation estimated to be that from which the individual’s data most probably<br>arises. Before nm7.3, at all other conditions, the value of MIXEST is not meaningful,<br>such as when ICALL=4 or ICALL=2 and COMACT=0. As of NONMEM 7.3, when<br>ICALL=4, MIXEST will equal MIXNUM, and when ICALL=2 and COMACT=0, MIX-<br>EST will be 0 to indicate it has not been assigned a meaningful value.<br>
MIXP<br>
These are the mixture probabilities P(i) computed by subroutine MIX or by the $MIX<br>block of abbreviated code.<br>
In abbreviated code, MIXP may be coded in either of three ways:<br>
MIXP(MIXNUM)<br>
MIXP<br>
MIXP(i)<br>
The ﬁrst two ways are identical; i.e., when no subscript is coded, NM-TRAN supplies the<br>subscript MIXNUM.<br>
435<br>
<hr>
<A name=441></a>MIXNUM MIXEST MIXP<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
With the third, the index i must not exceed the value of MMX in SIZES (or as set by<br>$SIZES record).<br>
(See <b>Mixture_model:_MIXNUM,MIXEST</b>)<br>(See <b>Mixture_model:_MIXP</b>)<br>(See <b>mix</b>, <b>mixture model example</b>).<br>
REFERENCES: Guide IV, section III.B.4 , III.B.6<br>REFERENCES: Guide IV, section IV.E.1 , 4.E.2<br>REFERENCES: Guide VI, section III.L.2 , Figure 6<br>
436<br>
<hr>
<A name=442></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MIXTURE<br>
MIXTURE MODEL: MIXNUM,MIXEST<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_INT,<br>
ONLY: MIXNUM=&gt;MIXCALL,MIXEST=&gt;IMIXEST<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: MIXCALL,IMIXEST<br>
DISCUSSION:<br>
MIXNUM<br>
The number of the subpopulation for which PRED is to compute outputs.<br>
MIXEST<br>
The number of the subpopulation estimated to be that from which the individual’s<br>data most probably arises. Should be used at ICALL = 3 and at ICALL = 2 when<br>COMACT &gt; 0.<br>
Used with mixture models. MIXNUM and MIXEST are reserved variables in all blocks<br>of abbreviated code.<br>
This is a general description. For details, see mixnum.<br>
(See <b>MIXNUM_MIXEST_MIXP</b>)<br>(See <b>Mixture_model:_MIXP</b>, <b>mix</b>)<br>(See <b>mixture_model_example</b>)<br>
Location prior to NONMEM 7: rocm11<br>
REFERENCES: Guide VI, section III.L.2 , Figure 6<br>
437<br>
<hr>
<A name=443></a>MIXTURE DETAILED DESCRIPTIONS<br>
Help Guide<br>
MIXTURE MODEL: MIXP<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_REAL, ONLY: MIXP<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: MMX,DPSIZE<br>
REAL(KIND=DPSIZE) :: MIXP(MMX)<br>
DISCUSSION:<br>
Used with mixture models.<br>
MIXP(i)<br>
The mixture probability for the ith subpopulation, computed by subroutine MIX.<br>
May be used as right-hand quantities in all abbreviated codes other than $MIX. There the<br>index i must be an integer constant.<br>
This is a general description. For details, see mixnum.<br>
(See <b>MIXNUM_MIXEST_MIXP</b>)<br>(See <b>mixnum_mixest_for_mixture_model</b>)<br>(See <b>mix</b>, <b>mixture model example</b>)<br>
Location prior to NONMEM 7: rocm25<br>
REFERENCES: Guide VI, section III.L.2 , Figure 6<br>
438<br>
<hr>
<A name=444></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MIXTURE<br>
MIXTURE MODEL: MIXPT<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: MIXPT=&gt;MIXP_RAW<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: MMX,DPSIZE<br>
REAL(KIND=DPSIZE) :: MIXP_RAW(MMX)<br>
DISCUSSION:<br>
MIXPT<br>
At ICALL=6, (the ﬁnal estimate of) the mixture probabilities associated with the<br>individual record containing the template data record are stored in MIXPT.<br>
Location prior to NONMEM 7: rocm47<br>
REFERENCES: None.<br>
439<br>
<hr>
<A name=445></a>MODEL DETAILED DESCRIPTIONS<br>
Help Guide<br>
MODEL EVENT TIME: MNOW,MPAST,MNEXT<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_INT, ONLY: MNOW=&gt;MTNOW,MPAST=&gt;MTPAST,MNEXT=&gt;MTNEXT<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: PCT<br>
INTEGER(KIND=ISIZE) :: MTNOW,MTPAST(PCT),MTNEXT(PCT)<br>
DISCUSSION:<br>
These variables are of interest when model event time parameters are deﬁned in PK.<br>
(See <b>mtime</b>).<br>
Location prior to NONMEM 7: procma<br>
REFERENCES: None.<br>
440<br>
<hr>
<A name=446></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MODEL<br>
MODEL EVENT TIME: MTDIFF<br>
MEANING: PREDPP-PK global variables<br>CONTEXT: PK routine<br>
USAGE:<br>USE PRMOD_INT, ONLY: MTDIFF<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: MTDIFF<br>
DISCUSSION:<br>
MTDIFF is of interest when model time parameters MTIME are used.<br>
The value of MTDIFF is 0 when PK is called. If PK sets MTDIFF to a value other than 0,<br>e.g., MTDIFF=1, then PREDPP will understand that with that call to PK, the values of<br>one or more of the MTIME(i) have possibly been reset.<br>
It is not necessary to set MTDIFF at a call to PK with the ﬁrst record of an individual or<br>with a reset record. At such calls, it is assumed that all MTIME(i) are being set (if only<br>to their default value of 0).<br>
Suppose PK has deﬁned a value MTIME(i). PREDPP calls PK prior to the advance to<br>MTIME(i). PK may change MTIME(i) at this call. However, the new value of<br>MTIME(i) is ignored till after the advance. Only then is the new value of MTIME(i)<br>effective.<br>
MTDIFF=0 (the default) can save considerable run time when there are many model time<br>parameters. Note that the results are unpredictable if the times are in fact changed when<br>MTDIFF=0.<br>
(See <b>mtime</b>, <b>model time examples</b>).<br>
Location prior to NONMEM 7: prdpk2<br>
REFERENCES: None.<br>
441<br>
<hr>
<A name=447></a>MODEL DETAILED DESCRIPTIONS<br>
Help Guide<br>
MODEL EVENT TIME: MTIME<br>
MEANING: PREDPP-PK global variables<br>CONTEXT: PK routine<br>
USAGE:<br>USE PKERR_REAL, ONLY :: MTIME<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: PCT,DPSIZE<br>
REAL(KIND=DPSIZE) :: MTIME(PCT)<br>
DISCUSSION:<br>
Model time parameters MTIME are stored in MTIME if they are deﬁned in $PK abbrevi-<br>ated code or if verbatim code is present in $PK. This makes them also available to the<br>ERROR routine. However, their eta derivatives (if any) are not included. Hence the<br>ERROR routine should not use model time parameters in such a way as to inﬂuence the<br>value of Y if those parameters have eta derivatives.<br>
A user-written PK routine need not deﬁne these variables unless perhaps the model time<br>parameter values are used in the ERROR routine.<br>
(See <b>mtime</b>, <b>model time examples</b>).<br>
Location prior to NONMEM 7: prdpk1<br>
REFERENCES: None.<br>
442<br>
<hr>
<A name=448></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MODEL<br>
MODEL<br>
MEANING: MODEL subroutine<br>CONTEXT: User-supplied subroutine; for use with PREDPP<br>
USAGE:<br>SUBROUTINE MODEL(IDNO,NCM,NPAR,IR,IATT,LINK)<br>
USE PRMOD_CHAR, ONLY: NAME<br>
USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
INTEGER(KIND=ISIZE) :: IDNO,NCM,NPAR,IR,IATT,LINK<br>
DIMENSION :: IATT(IR,*),LINK(IR,*)<br>
GLOBAL DECLARATION:<br>
Versions before NONMEM 7.4:<br>
CHARACTER(LEN=8) :: NAME(PC)<br>
Versions after NONMEM 7.4:<br>
USE SIZES,<br>
ONLY: SD<br>
CHARACTER(LEN=SD) :: NAME(PC)<br>
DISCUSSION:<br>The MODEL subroutine is called by PREDPP only once at the start of a run when a gen-<br>eral ADVAN (ADVAN 5, 6, 7, 8, 9, 13, 14, 15) is used. It allows the user to specify<br>aspects of the particular model he wishes to use. When NM-TRAN is used, the<br>$MODEL record supplies this information.<br>
Input argument: None.<br>
Output argument:<br>
IDNO<br>
An identiﬁcation number for the MODEL routine. The value assigned by MODEL<br>to IDNO is printed on the ﬁrst PREDPP problem summary page.<br>
NCM<br>
The total number of compartments in the model, excluding the output compartment.<br>Contains 0 when MODEL is called. NCM must be no greater than PC-1.<br>
NPAR<br>
The number of basic PK parameters used in the PK routine. Contains 0 when<br>MODEL is called. NPAR must be no greater than constant PG in ﬁle SIZES. With<br>the general non-linear models (ADVAN6, ADVAN8, ADVAN9, ADVAN13,<br>ADVAN14, ADVAN15), NPAR may remain 0.<br>
IATT<br>
Values of compartment attributes. The values of IATT(I,*) refers to the ith compart-<br>ment.<br>IATT(I,1)=0 initially off<br>IATT(I,1)=1 initially on<br>IATT(I,2)=0 may not be turned on and off<br>IATT(I,2)=1 may be turned on and off<br>IATT(I,3)=0 may not receive doses<br>IATT(I,3)=1 may receive doses<br>IATT(I,4)=0 not the default observation compartment<br>IATT(I,4)=1 the default observation compartment<br>
443<br>
<hr>
<A name=449></a>MODEL DETAILED DESCRIPTIONS<br>
Help Guide<br>
IATT(I,5)=0 not the default dose compartment<br>IATT(I,5)=1 the default dose compartment<br>
The remainder is used only with ADVAN9 and ADVAN15:<br>
IATT(I,8)=0 not an equilibrium compartment<br>IATT(I,8)=1 an equilibrium compartment<br>IATT(I,9)=0 should not be included in the total drug amount<br>in the system interior<br>IATT(I,9)=1 should be included in the total drug amount<br>in the system interior<br>
NAME<br>
Labels for the compartments (to be printed on the PREDPP summary page under<br>&quot;FUNCTION&quot;).<br>NAME(I) is the label for compartment i. With versions before NONMEM 7.4,<br>NAME was limited to 8 characters. With NONMEM 74 NAME may be up to SD<br>characters long. SD is deﬁned in SIZES and is set to 30 with NONMEM 7.4.<br>
LINK<br>
Only used with a general linear model (ADVAN5 and ADVAN7).<br>LINK(I, J)=0: no drug may distribute from compartment i to compartment j.<br>LINK(I, J)=K: drug distributes from compartment i to compartment j. The rate<br>constant quantifying this ﬁrst order distribution is computed by PK and stored in the<br>kth row of GG.<br>When MODEL is called, all elements of LINK are 0.<br>
(See <b>sizes</b>).<br>
An initial steady state may be requested by routine MODEL;<br>(See <b>Initial Steady State: I_SS,ISSMOD</b>)<br>(See <b>i_ss</b>, <b>initial_condition</b>).<br>
REFERENCES: Guide IV, section V.C.4<br>REFERENCES: Guide VI, section VI.B , Figures 28, 29, 43<br>REFERENCES: Guide VI, Appendix II<br>
444<br>
<hr>
<A name=450></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MODEL<br>
MODEL SPECIFICATION FILE<br>
MEANING: A NONMEM output and input ﬁle<br>CONTEXT: NONMEM input/output ﬁle<br>
DISCUSSION:<br>A Model Speciﬁcation File (MSF) can be output by NONMEM. It includes information<br>from the Estimation Step (initial estimate information, current (or ﬁnal) estimate informa-<br>tion, search information) and from the Covariance Step (if this step is implemented). It is<br>requested in a certain ﬁeld of the ESTIMATION control record (or, with NM-TRAN, by<br>an option of the $ESTIMATION record). NONMEM will use the information in the<br>MSF in a later problem, either to continue the parameter search if the search did not ter-<br>minate in the current run, or to perform other tasks that will be based on ﬁnal parameter<br>estimates in the MSF. These other tasks can be Simulation, Covariance, Table, Scatter-<br>plot, or Finalization Steps. If the MSF contains the results of a search that terminated<br>successfully, even an additional Estimation Step can be performed, using the ﬁnal param-<br>eter estimates in the MSF as initial estimates and an estimation method other than the one<br>used in the problem with which the MSF was output. If an MSF is output, and intermedi-<br>ate output with iteration summaries is requested, then NONMEM also writes the parame-<br>ter estimates of these summaries to ﬁle INTER.<br>
MSF ﬁles are often used because they eliminate needless duplication of computation that<br>has already occurred in the Estimation Step of a previous run. If there should be a com-<br>puter crash during or after the Estimation Step of the previous run and a MSF was output,<br>then with the current run, the MSF can be input, and the Estimation Step of the current<br>run will continue the search begun with the previous run, starting from the last iteration<br>whose summary was output before the crash occurred.<br>
With NM-TRAN, speciﬁcation that an existing Model Speciﬁcation File is to be input is<br>done by placing the ﬁle’s name on the $MSFI record.<br>
With NONMEM 7.3, when MSF or MSFO option is used to specify an MSFO ﬁle in the<br>$EST record e.g.,<br>$EST ... MSFO=msfroot.msf<br>then in addition to the main MSF ﬁle msfroot.msf, an extra ﬁle msfroot_ETAS.msf will<br>also be produced, and provide additional information when a $MSFI record is used in a<br>subsequent problem or control stream. File msfroot_ETAS.msf contains individual etas<br>and phis generated during estimation (except FO method, which does not generate non-<br>zero etas during estimation, and not POSTHOC evaluated etas.) The use of an extension<br>in the ﬁle name, e.g., .msf, is optional. If ﬁle _ETAS does not exist, NONMEM issues a<br>warning, e.g.,<br>
WARNING: EXTRA MSF FILE COULD NOT BE OPENED: c5msf2x_ETAS<br>
If the Covariance Step is also implemented, extra ﬁles msfroot_RMAT.msf and msf-<br>root_SMAT.msf containing intermediate information on the R matrix and S matrix will<br>also be produced. These ﬁles provide information when a $MSFI record along with a<br>$COV ... RESUME record is used in a subsequent problem or control stream. There is<br>no warning if ﬁles _SMAT and/or _RMAT are missing.<br>
EXAMPLE OF USAGE:<br>
Here is an example using NM-TRAN. A fragment of the control stream for the ﬁrst run<br>follows. The Estimation Step is run for a limited number of evaluations of the objective<br>function (200).<br>
445<br>
<hr>
<A name=451></a>MODEL DETAILED DESCRIPTIONS<br>
Help Guide<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA BLOCK(3)<br>
6 .005 .0002 .3 .006 .4<br>
$SIGMA .4<br>
$EST MAXEVAL=200<br>
PRINT=5 MSFO=msf1<br>
After review of the ﬁrst run’s output, it is decided to let the search continue. The continu-<br>ation will start from the iteration during which the 200th objective function evaluation<br>occurred in the previous search. A fragment of the control stream for the second run fol-<br>lows. $THETA, $OMEGA, and $SIGMA need not, and may not, be present. The Esti-<br>mation Step is allowed to run to completion, and standard errors and a table are<br>requested. A new MSF is obtained, which will allow additional tables and scatterplots to<br>be obtained later.<br>
$MSFI msf1<br>
$EST PRINT=5 MSFO=msf2<br>
$COV<br>
$TABLE ID TIME<br>
REFERENCES: Guide I, section B.3<br>REFERENCES: Guide IV, section III.B.12<br>
446<br>
<hr>
<A name=452></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MONITORING<br>
MONITORING OF SEARCH<br>
MEANING: History report on the Estimation Step search<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>NONMEM output includes a report of the history of the search undertaken in the Estima-<br>tion Step for parameter estimates. This report is called the intermediate output from the<br>Estimation Step, because it consists of summaries of the progress of the search, from iter-<br>ation to iteration, and because it may be viewed as the search progresses, provided the<br>NONMEM output ﬁle may be viewed as the search progresses. This report can also be<br>viewed in a special (unbuffered) ﬁle.<br>
The search is for parameter values that minimize the value of the OBJECTIVE FUNC-<br>TION (See <b>minimum value of objective function</b>). Basically, it entails the following<br>steps.<br>
1. The search is carried out in a different parameter space. The parameters are trans-<br>
formed to unconstrained parameters (UCP). In the transformation process a scaling<br>occurs so that the initial estimate of each of the UCP is 0.1.<br>
2. At the current parameter estimate the GRADIENT vector (i.e., the vector of ﬁrst<br>
partial derivatives of the objective function with respect to the UCP) is computed.<br>An approximate Hessian matrix (See <b>hessian</b>) is also computed. An ITERATION<br>SUMMARY, including the current parameter estimate and the gradient vector, may<br>placed into the intermediate output.<br>
With NONMEM 7, the parameter estimates are also displayed in their natural<br>(unscaled) space. These lines are identiﬁed as NPARAMETR and precede the<br>PARAMETER lines, which display the UCP values. Note that when OMEGA (or<br>SIGMA) have block structure, the values in NPARAMETR are listed in upper trian-<br>gular order, whereas elsewhere in NONMEM output they are displayed in lower tri-<br>angular order. For example, suppose the NONMEM output displays a 3x3 OMEGA<br>matrix as<br>
OMEGA(1,1)<br>OMEGA(2,1) OMEGA(2,2)<br>OMEGA(3,1) OMEGA(3,2) OMEGA(3,3)<br>
It will be listed in NPARAMTR as:<br>
OMEGA(1,1) OMEGA(2,1) OMEGA(3,1) OMEGA(2,2) OMEGA(3,2) OMEGA(3,3)<br>
This is inconsistent, but it cannot be changed; option ORDER of the $ESTIMATION<br>record does not affect the NPARAMTR line.<br>
3. Using the gradient vector and Hessian matrix, a direction in parameter space,<br>
emananting from the current parameter estimate, is computed, and a search is under-<br>taken along this direction for an approximate minimum point. When this point is<br>found, NONMEM returns to step 2. (An ITERATION consists of the computation<br>of the direction, the search along the direction, and the computation of the gradient<br>vector and Hessian matrix at the approximate minimum point.)<br>
4. Iteration stops when any one of the following conditions holds:<br>
A successful (local) minimum point has been found.<br>
447<br>
<hr>
<A name=453></a>MONITORING DETAILED DESCRIPTIONS<br>
Help Guide<br>
The maximum number of FUNCTION EVALUATIONS allowed by the user (MAX-<br>EVALS option of $ESTIM) is exceeded.<br>
It was not possible to successfully locate a minimum point due to so-called<br>ROUNDING ERRORS.<br>
Here is an example of intermediate output from the Estimation Step:<br>
448<br>
<hr>
<A name=454></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MONITORING<br>
MONITORING OF SEARCH:<br>
ITERATION NO.:<br>
0<br>
OBJECTIVE VALUE:<br>
110.244034784025 NO. OF FUNC. EVALS.:<br>
6<br>
CUMULATIVE NO. OF FUNC. EVALS.:<br>
6<br>
NPARAMETR: 3.0000E+00 8.0000E-02 4.0000E-02 6.0000E+00 5.0000E-03<br>
3.0000E-01 2.0000E-04 6.0000E-03 4.0000E-01 4.0008E-01<br>
PARAMETER: 1.0000E-01 1.0000E-01 1.0000E-01 1.0000E-01 1.0000E-01<br>
1.0000E-01 1.0000E-01 1.0000E-01 1.0000E-01 1.0000E-01<br>
GRADIENT: 1.4640E+01 -1.6691E+01 5.6460E+01 -9.4129E+00 -1.1699E+01<br>
1.0623E+01 -6.3485E-01 -4.7803E+01 -9.6457E+00<br>
5.2414E+00<br>
ITERATION NO.:<br>
5<br>
OBJECTIVE VALUE:<br>
105.453694506861 NO. OF FUNC. EVALS.:<br>
7<br>
CUMULATIVE NO. OF FUNC. EVALS.:<br>
45<br>
NPARAMETR: 2.8166E+00 8.0433E-02 3.8563E-02 6.6123E+00 9.7862E-03<br>
-3.9509E-02 2.3438E-04 8.1375E-03 4.9657E-01 4.0355E-01<br>
PARAMETER: -5.3055E-02<br>
1.0703E-01 5.7598E-02 1.4858E-01 1.8644E-01<br>
-1.2545E-02 1.5794E-01 1.3452E-01 3.7714E-02 1.0431E-01<br>
GRADIENT: 3.5103E-01 -1.3214E+01 2.8003E+01 1.1115E+00 1.9193E+00<br>
-5.3252E+00 7.1533E-02 -2.2091E+01 -1.4424E+00<br>
8.2329E+00<br>
ITERATION NO.:<br>
10 OBJECTIVE VALUE: 104.747695563098<br>
NO. OF FUNC. EVALS.:<br>
7<br>
CUMULATIVE NO. OF FUNC. EVALS.:<br>
80<br>
NPARAMETR: 2.7362E+00 7.6935E-02 3.5982E-02 5.7362E+00 1.0840E-03<br>
-2.9208E-01 2.3701E-04 9.4013E-03 5.1805E-01 3.8858E-01<br>
PARAMETER: -1.1928E-01<br>
4.9234E-02 -2.3022E-02<br>
7.7517E-02 2.2174E-02<br>
-9.9574E-02 1.9498E-01 1.4956E-01 -1.7173E-01 8.5414E-02<br>
GRADIENT: -1.3933E+00 -7.4632E+00 9.3144E+00 1.0280E+00 9.6395E-01<br>
-3.1313E+00 1.0212E+00 -5.3784E+00 -2.0828E+00 -9.1477E-01<br>
ITERATION NO.:<br>
15 OBJECTIVE VALUE: 104.561086502423<br>
NO. OF FUNC. EVALS.:<br>
7<br>
CUMULATIVE NO. OF FUNC. EVALS.:<br>
116<br>
NPARAMETR: 2.7735E+00 7.8097E-02 3.6292E-02 5.5466E+00 5.1735E-03<br>
-1.2911E-01 2.3941E-04 9.0947E-03 5.1461E-01 3.8760E-01<br>
PARAMETER: -8.8567E-02<br>
6.8686E-02 -1.2994E-02<br>
6.0711E-02 1.0762E-01<br>
-4.4762E-02 1.9028E-01 1.4643E-01 -8.4016E-02 8.4157E-02<br>
GRADIENT: 7.7937E-03<br>
5.7189E-03 3.0426E-02 -5.1648E-03 -1.2939E-02<br>
1.4490E-02 7.4602E-04 -2.5227E-02 -3.1443E-03<br>
1.5799E-02<br>
ITERATION NO.:<br>
19 OBJECTIVE VALUE: 104.561067398632<br>
NO. OF FUNC. EVALS.:<br>
0<br>
CUMULATIVE NO. OF FUNC. EVALS.:<br>
149<br>
NPARAMETR: 2.7739E+00 7.8129E-02 3.6307E-02 5.5498E+00 5.2393E-03<br>
-1.2767E-01 2.3985E-04 9.1064E-03 5.1521E-01 3.8742E-01<br>
PARAMETER: -8.8304E-02<br>
6.9219E-02 -1.2510E-02<br>
6.0998E-02 1.0895E-01<br>
-4.4249E-02 1.9095E-01 1.4652E-01 -8.3269E-02 8.4127E-02<br>
GRADIENT: 1.2144E-04 -1.4883E-04 -6.6257E-06 -7.5745E-05 -1.6157E-05<br>
1.1307E-04 6.4128E-05 1.1193E-04 -1.7655E-05 4.2676E-05<br>
Note that the values of the PARAMETERs are the values of the UCP, so that at the 0th<br>iteration, all the PARAMETERs have the value 0.1.<br>
The ﬁrst parameter (and gradient) elements correspond to the THETA elements which are<br>not ﬁxed. The remaining elements correspond to the OMEGA and SIGMA elements<br>
449<br>
<hr>
<A name=455></a>MONITORING DETAILED DESCRIPTIONS<br>
Help Guide<br>
which are not ﬁxed, but not in a simple 1-1 manner unless OMEGA and SIGMA are con-<br>strained to be diagonal.<br>
The PRINT option of the $ESTIMATION record determines how often iteration sum-<br>maries are printed: not at all (with PRINT=0); only for the 0th and last iterations (with<br>PRINT=9999); for the 0th iteration, for every 10th iteration thereafter, and for the last<br>iteration (with PRINT=10, as illustrated above).<br>
If a model speciﬁcation ﬁle is output, then the estimates may also be seen in the original<br>parameterization for those iterations whose summaries appear in intermediate output.<br>These estimates may be found in ﬁle INTER in the same order and format as elsewhere in<br>the NONMEM output. With NONMEM 7, INTER exists after the run is ﬁnished.<br>
When the Estimation Step terminates, it reports its success or lack of it, as in this exam-<br>ple:<br>
MINIMIZATION SUCCESSFUL<br>
NO. OF FUNCTION EVALUATIONS USED:<br>
149<br>
NO. OF SIG. DIGITS IN FINAL EST.:<br>
4.7<br>
Each (UCP) element of the mimimum point is determined to a number of signiﬁcant dig-<br>its. The number of signiﬁcant digits reported is the number of signiﬁcant digits in the<br>least-well-determined element. The report &quot;MINIMIZATION SUCCESSFUL&quot; is issued<br>when this number is no less than the number of signiﬁcant digits requested using the<br>SIGDIGITS option of the $ESTIMATION record. Note that this report alone does not<br>assure that a global (or even a local) minimum point has been located; what appears to be<br>a minimum point may be a saddle point. Nor, if a minimum point has been located, does<br>the report alone assure that the objective function is not &quot;ﬂat&quot; in a region of the point. For<br>such assurances, one also needs to implement the Covariance Step.<br>
REFERENCES: Guide I, section C.3.5.1<br>REFERENCES: Guide V, section 10.4.1<br>
450<br>
<hr>
<A name=456></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MRG<br>
MRG DAT A ITEM<br>
MEANING: Marginal (MRG_) data item<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... MRG_ ...<br>
DISCUSSION:<br>MRG_ labels NONMEM’s marginal (MRG) data item. The marginal data item is<br>optional. With a nonobservation record (i.e. MDV=1 or MDV=101), it controls the deﬁ-<br>nition of the value of the PRED item associated with the record. Basically, 0 means the<br>PRED item is the typical value of F, and 1 or 2 means it is the expectation of F. (Note<br>that with NM-TRAN, F is deﬁned by Y.) However, the marginal data item also controls<br>the deﬁnition of the value of any PRED-deﬁned item D that is displayed in a table or scat-<br>terplot (except items stored in the SAVE region) and associated with the record.<br>
Values are:<br>
0<br>
The PRED item is the typical value of F and a displayed item D is either the typical<br>value of the variable D or, if conditional estimates are requested, the conditional esti-<br>mate of the variable D.<br>
1 or 2<br>
The values of the PRED and D items are determined by other things: If the Simula-<br>tion Step is implemented, and ONLYSIMULATION is speciﬁed, the PRED item is<br>the simulation expectation of F, over the simulated values of eta for all the individu-<br>als in the data set (including those individuals with no observation records), and the<br>D item is the simulation expectation of the variable D. If conditional estimates are<br>obtained (e.g., using the POSTHOC option), the PRED item is the posterior expecta-<br>tion of F, over the conditional estimates of eta for all individuals in the data set (that<br>have some observation records), and the D item is the posterior expectation of the<br>variable D. Otherwise, the PRED and D items are as with METHOD=0.<br>
If the expectation is the posterior expectation:<br>
If MRG_=1, the deletion adjustment is not used.<br>
If MRG_=2, the deletion adjustment is used. With the deletion adjustment, the pos-<br>terior expectation for a given individual is obtained by not including in the computed<br>expectation the value of the variable evaluated at the conditional estimate of his eta.<br>
With MRG_=1 or 2, MDV must also be 1 or 101. This use of MDV=1 does not prevent,<br>as would ordinarily happen, the DV or RES items from being plotted.<br>
A plot of PRED (and of any PRED-deﬁned item not stored in the SAVE region) will only<br>include points from records with MRG_=1, unless one explicitly partitions on MRG_.<br>
If PREDPP is used and NM-TRAN generates MDV, MDV is set to 1 if MRG_ is 1 or 2.<br>If PREDPP is used, NM-TRAN sets MRG_ to 0 (if it is not already 0) when EVID is not<br>equal to 0. LP<br>
Warning: If PREDPP is used and NM-TRAN generates EVID, it sets EVID=2 for records<br>with MDV=1 and no dosing information. This causes MRG_ to be set to 0. When<br>MRG_ is used, the data set should include MDV and EVID data items. The values<br>should be MDV=1 and EVID=0 when MRG_&gt;0.<br>
451<br>
<hr>
<A name=457></a>MRG DETAILED DESCRIPTIONS<br>
Help Guide<br>
(See <b>expectation example</b>, <b>expectation block</b>).<br>
REFERENCES: none.<br>
452<br>
<hr>
<A name=458></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MTIME<br>
MTIME MNEXT MPAST MNOW MTDIFF<br>
MEANING: Variables related to the model event time feature of PREDPP.<br>CONTEXT: Abbreviated code, verbatim code, user-supplied routines, NM-TRAN<br>
USAGE:<br>MTIME(1)=THETA(1)<br>
Model event times are additional PK parameters deﬁned in the PK routine or $PK block.<br>A model event time is not associated with any compartment, but, like an absorption lag<br>time, deﬁnes a time to which the system is advanced. When the time is reached, indicator<br>variables are set and a call to PK is made. At this call (and/or subsequent to this call) PK<br>or DES or AES or ERROR can use the indicator variables to change some aspect of the<br>system, e.g., a term in a differential equation, or the rate of an infusion. This feature may<br>be used with any ADVAN routine. Model times are independent of non-event dose times.<br>The following are reserved variables when used in abbreviated code.<br>
MTIME(i)<br>
The i-th model event time. The maximum number of model event times is given by<br>constant PCT in ﬁle SIZES (See <b>sizes</b>).<br>
MTIME(i) may be less than, equal to, or greater than MTIME(i+1).<br>
Any<br>
MTIME(i) may be negative or hav e the value 0 (in which case MPAST(i)=1 always<br>and MNEXT(i)=0 always; see below). If PK deﬁnes MTIME(i) and MTIME(i+2)<br>but not MTIME(i+1), then this has the same effect as deﬁning MTIME(i+1)=0. PK<br>may redeﬁne MTIME(i). An ETA may be used in the deﬁnition of MTIME(i).<br>
MTDIFF<br>
The value of MTDIFF is 0 when PK is called. If PK sets MTDIFF to a value other<br>than 0, e.g., MTDIFF=1, then PREDPP will understand that with that call to PK, the<br>values of one or more of the MTIME(i) have possibly been reset. It is not necessary<br>to set MTDIFF at a call to PK with the ﬁrst record of an individual or with a reset<br>record.<br>
The following are the read-only indicator variables. They are not to be set by PK.<br>
MNOW<br>
MNOW=i if MNEXT(i)=1 for some i. MNOW=0 otherwise.<br>
MNEXT(i)<br>
MNEXT(i)=1 during the advance from the previous time to MTIME(i). Otherwise,<br>MNEXT(i)=0. The previous time may be an event time, a non-event time, or a<br>model event time.<br>
MPAST(i)<br>
MPAST(i)=0 until the call to PK subsequent to the one for which MNEXT(i)=1. At<br>that call MPAST(i)=1. It then retains this value, unless MTIME(i) is redeﬁned, in<br>which case MPAST will be appropriately redeﬁned as another step function.<br>
(See <b>model time examples</b>)<br>(See <b>Model Event Time: MNOW,MPAST,MNEXT</b>)<br>(See <b>Model Event Time: MTIME</b>)<br>(See <b>Model Event Time: MTDIFF</b>)<br>(See <b>Circadian Example: Examples Using MTIME to Model Periodic Discontinu-<br>ities in $DES</b>)<br>
453<br>
<hr>
<A name=459></a>MTIME DETAILED DESCRIPTIONS<br>
Help Guide<br>
REFERENCES: Guide VI, section III.F.9<br>
454<br>
<hr>
<A name=460></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MULT<br>
MULT<br>
MEANING: MULT subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: A,B<br>
CALL MULT (A,B)<br>
DISCUSSION:<br>MULT is a NONMEM utility routine that may be called by PRED. It allows reweighting<br>of the objective function. That is, it allows terms A(i) and B(i) of the contribution to the<br>(default) objective function of the ith individual to be set to values other than the defaults,<br>which are 1. A(i) multiplies the logarithm of the determinant of the variance - covariance<br>matrix for the ith individual and B(i) multiplies the sum of the squared weighted residuals<br>for the ith individual.<br>
Input argument:<br>
A<br>
A variable or constant.<br>
B<br>
A variable or constant.<br>
To set A(i) and B(i) to values a and b for the ith individual, PRED should issue a single<br>call to MULT during any one or more calls to it from NONMEM where ICALL is 2 and<br>some data record from the ith individual is in DATREC.<br>
At these calls, set A=a and B=b.<br>
At least one such call to MULT must be issued for each individual. If more than one such<br>call is issued for the same individual, then A and B should have the same values across all<br>such calls.<br>
MULT can be used whenever ELS is called. MULT can also be used whenever<br>NCONTR is called and NCONTR calls CELS. NCONTR calls CELS whenever<br>CCONTR is not called, or when CCONTR is called and CCONTR only calls CELS.<br>
REFERENCES: Guide II, section D.4 , D.4.3<br>REFERENCES: Guide II, Figure 20<br>
455<br>
<hr>
<A name=461></a>MU MODEL<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
MU MODEL<br>
MEANING:<br>CONTEXT: Abbreviated code<br>
USAGE:<br>MU_3=LOG(THETA(3))<br>V=EXP(MU_3+ETA(3))<br>
DISCUSSION:<br>
The new methods in NONMEM are most efﬁciently implemented if the user supplies<br>information on how the THETA parameters are associated arithmetically with the etas<br>and individual parameters, wherever such a relationship holds. Calling the individual<br>parameters phi, the relationship should be<br>phi_i=mu_i(theta)+eta(i)<br>for each parameter i that has an eta associated with it, and mu_i is a function of THETA.<br>The association of one or more THETA’ s with ETA(1) must be identiﬁed by a variable<br>called MU_1. Similarly, the association with ETA(2) is MU_2, that of ETA(5) is MU_5,<br>etcetera. This is called &quot;MU Referencing&quot;, or &quot;MU Modelling&quot;.<br>
Providing this information is as straight-forward as introducing the MU_ variables into<br>the $PRED or $PK code by expansion of the code.<br>
For a very simple example, the original code may have the lines<br>
CL=THETA(4)+ETA(2)<br>
This may be rephrased as:<br>
MU_2=THETA(4)<br>CL=MU_2+ETA(2)<br>
Another example would be:<br>
CL=(THETA(1)*AGE**THETA(2))*EXP(ETA(5))<br>V=THETA(3)*EXP(ETA(3))<br>
which would now be broken down into two additional lines, inserting the deﬁnition of a<br>MU as follows:<br>
MU_5= LOG(THETA(1))+THETA(2)*LOG(AGE)<br>MU_3=LOG(THETA(3))<br>CL=EXP(MU_5+ETA(5))<br>V=EXP(MU_3+ETA(3))<br>
Note the arithmetic relationship identiﬁed by the last two lines, where MU_5+ETA(5)<br>and MU_3+ETA(3) are expressed. This action does not change the model in any way.<br>
If the model is formulated by the traditional typical value (TV, mean), followed by indi-<br>vidual value, then it is straight-forward to add the MU_ references as follows:<br>
TVCL= THETA(1)*AGE**THETA(2)<br>CL=TVCL*EXP(ETA(5))<br>TVV=THETA(3)<br>V=TVV*EXP(ETA(3)<br>MU_3=LOG(TVV)<br>MU_5=LOG(TVCL)<br>
This also will work because only the MU_x= equations are required in order to take<br>advantage of EM efﬁciency. It is not required to use the MU_ variables in the expression<br>EXP(MU_5+ETA(5)), since the following are equivalent:<br>CL=TVCL*EXP(ETA(5))=EXP(LOG(TVCL)+ETA(5)=EXP(MU_5+ETA(5))<br>
456<br>
<hr>
<A name=462></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MU MODEL<br>
but it helps as an exercise to determine that the MU_ reference was properly transformed<br>(in this case log transformed) so that it represents an arithmetic association with the eta.<br>
An incorrect usage of MU modeling would be:<br>
MU_1=LOG(THETA(1))<br>MU_2=LOG(THETA(2))<br>MU_3=LOG(THETA(3))<br>CL=EXP(MU_1+ETA(2))<br>V=EXP(MU_2+MU_3+ETA(1))<br>
In the above example, MU_1 is used as an arithmetic mean to ETA(2), and a composite<br>MU_2 and MU_3 are the arithmetic means to ETA(1), which would not be correct. The<br>association of MU_x+ETA(x) must be strictly adhered to.<br>
Once one or more thetas are modeled to a MU, the theta may not show up in any subse-<br>quent lines of code. That is, the only usage of that theta may be in its connection with<br>MU. For example, if<br>
CL=THETA(5)*EXP(ETA(2))<br>
it can be rephrased as<br>
MU_2=LOG(THETA(5))<br>CL=EXP(MU_2+ETA(2))<br>
But later, suppose THETA(5) is used without its association with ETA(2):<br>
...<br>
CLZ=THETA(5)*2<br>
Then THETA(5) cannot be MU modeled, because it shows up as associated with ETA(2)<br>in one context, but as a ﬁxed effect without association with ETA(2) elsewhere.<br>
However, if<br>
MU_2=LOG(THETA(5))<br>CL=EXP(MU_2+ETA(2))<br>CLZ=CL*2<br>
Then this is legitimate, as the individual parameter CL retains the association of<br>THETA(5) with ETA(2), when used to deﬁne CLZ. That is, THETA(5) and ETA(2) may<br>not used separately in any other part of the model, except indirectly through CL, in which<br>their association is retained.<br>
Suppose you have:<br>
CL=THETA(5)+THETA(5)*ETA(2)<br>
One should see this as:<br>
CL=THETA(5)*(1+ETA(2))<br>
So the way to MU model this is:<br>
MU_2=1.0<br>CL=THETA(5)*(MU_2+ETA(2))<br>
Which would mean that in the end, THETA(5) is not actually MU modeled, since MU_2<br>does not depend on THETA(5). One would be tempted to model as follows:<br>
MU_2=THETA(5)<br>CL=MU_2+MU_2*ETA(2)<br>
But this would be incorrect, as MU_2 and ETA(2) may not show up together in the code<br>except as MU_2+ETA(2) or its equivalent. Thus, THETA(5) cannot be MU modeled. In<br>such cases, remodel to the following similar format:<br>
CL=THETA(5)*EXP(ETA(2))<br>
457<br>
<hr>
<A name=463></a>MU MODEL<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
So that THETA(5) may be MU modeled as:<br>
MU_2=LOG(THETA(5))<br>CL=EXP(MU_2+ETA(2))<br>
Sometimes, a particular parameter has a ﬁxed effect with no random effect, such as:<br>
Km=THETA(6)<br>
with the intention that Km is unknown but constant across all subjects. In such cases, the<br>THETA(6) and Km cannot be Mu referenced, and the EM efﬁciency will not be available<br>in moving this Theta. However, one could assign an ETA to THETA(5), and then ﬁx its<br>OMEGA to a small value, such as 0.0225 =0.15ˆ2 to represent 15% CV, if OMEGA rep-<br>resents proportional error. This often will allow the EM algorithms to efﬁciently move<br>this parameter, while retaining the original intent that all subjects have similar, although<br>not identical, Km’s. Very often, inter-subject variances to parameters were removed<br>because the FOCE had difﬁculty estimating a large parametered problem, and so it was<br>an artiﬁcial constraint to begin with. EM methods are much more robust, and are adept at<br>handling large, full block OMEGA’s, so you may want to incorporate as many etas as<br>possible when using the EM methods.<br>
You should Mu reference as many of the THETA’ s as possible, except those pertaining to<br>residual variance (which should be modeled through SIGMA whenever possible). If you<br>can afford to slightly change the theta/eta relationship a little to make it MU referenced<br>without unduly inﬂuencing the model speciﬁcation or the physiological meaning, then it<br>should be done.<br>
When the arithmetic mean of an ETA is associated with one or more THETA’ s in this<br>way, EM methods can more efﬁciently analyze the problem, by requiring in certain calcu-<br>lations only the evaluation of the MU’s to determine new estimates of THETAs for the<br>next iteration, without having to re-evaluate the predicted value for each observation,<br>which can be computationally expensive, particularly when differential equations are<br>used in the model. For those THETA’ s that do not have a relationship with any ETA’s,<br>and therefore cannot be MU referenced (including THETA’ s associated with ETAS whose<br>OMEGA value is ﬁxed to 0), computationally expensive gradient evaluations must be<br>made to provide new estimates of them for the next iteration.<br>
There is additional increased efﬁciency in the evaluation of the problem if the MU mod-<br>els are linear functions with respect to THETA. Recalling one of the previous examples<br>above, we could re-parameterize THETA such that<br>
MU_5=THETA(1)+THETA(2)*LOG(AGE)<br>CL=EXP(MU_5+ETA(5))<br>MU_3=THETA(3)<br>V=EXP(MU_3+ETA(3))<br>
This changes the values of THETA(1) and THETA(3) such that the re-parameterized<br>THETA(1) and THETA(3) are the logarithm of the original parameterization of<br>THETA(1) and THETA(3). The models are identical, however, in that the same maxi-<br>mum likelihood value will be achieved. The only inconvenience is having to anti-log<br>these THETA’ s during post-processing.<br>
The added efﬁciency obtained by maintaining linear relationships between the MU’s and<br>THETA’ s is greatest when using the SAEM method and the MCMC Bayesian method. In<br>the Bayesian method, THETA’ s that are linearly modeled with the MU variables have lin-<br>ear relationships with respect to the inter-subject variability, and this allows the Gibbs<br>sampling method to be used, which is much more efﬁcient than the Metropolis-Hastings<br>(M-H) method. By default, NONMEM tests MU-THETA linearity by determining if the<br>second derivative of MU with respect to THETA is nearly or equal to 0. Those THETA<br>
458<br>
<hr>
<A name=464></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MU MODEL<br>
parameters with 0 valued second derivatives are Gibbs sampled, while all other THETAS<br>are M-H sampled. In the Gibbs sampling method, THETA values are sampled from a<br>multi-variate normal conditional density given the latest PHI=MU+ETA values for each<br>subject, and the samples are always accepted. In M-H sampling, the sampling density<br>used is only an approximation, so the sampled THETA values must be tested by evaluat-<br>ing the<br>
Some additional rules for MU referencing are as follows:<br>
1) As much as possible, deﬁne the MU’s in the ﬁrst few lines of $PK or $PRED. Do<br>
not deﬁne MU_ values in $ERROR. Have all the MU’s particularly deﬁned before<br>any additional verbatim code, such as write statements. NMTRAN produces a<br>MUMODEL2 subroutine based on the PRED or PK subroutine in FSUBS.F90, and<br>this MUMODEL2 subroutine is frequently called with the ICALL=2 settings, more<br>often than PRED or PK. The fewer code lines that MUMODEL2 has to go through<br>to evaluate all the MU_s’ the more efﬁcient.<br>
2) Whenever possible, have the MU variables deﬁned unconditionally, outside<br>
IF...THEN blocks.<br>
3) Time dependent covariates cannot be part of the MU_ equation. For example<br>
MU_3=THETA(1)*TIME+THETA(2)<br>
should not be done. Or, consider<br>
MU_3=THETA(2)/WT<br>
Where WT varies with time. This would also not be suitable. However, we could<br>phrase as<br>
MU_3=THETA(2)<br>CL=WT*(MU_3+ETA(3))<br>
is ﬁne, where MU_3 represents a population mean clearance per unit weight, which<br>is constant with time, and more universal among subjects, whereas CL is the non-<br>wieght normalized clearance, than depends on a person’s weight, which could vary<br>with time as well. The MU variables may vary with inter-occasion, but not with<br>time.<br>
4) Starting with NONMEM 7.2, NMTRAN’s CHECKMU subroutine attempts to look<br>
for errors in MU modeling. If it appears that there may be errors, then there are<br>messages such as<br>
(MU_WARNING 13) MU_001: DOES NOT HAVE ADDITIVE ASSOCIATION WITH ETA(001)<br>
Such warnings do not affect the outputs from NMTRAN. FSUBS is generated as<br>usual. Sometimes the warnings may be ignored (see &quot;Model parameters as log t-<br>Distributed&quot;, below.) Sometimes warnings may not be generated when they should<br>be. Thus, the user must pay close attention to following the rules.<br>
Option NOCHECKMU of the $ABBR record may be used to prevent NM-TRAN from<br>attempting to check the MU model statements.<br>
Examples show examples of MU modeling for various problem types. Study these exam-<br>ples carefully. When transposing your own code, begin with simple problems and work<br>your way to more complex problems.<br>
At this point one may wonder why bother inserting MU references in your code. MU ref-<br>erencing only needs to be done if you are using one of the new EM or Gibbs sampling<br>methods to improve their efﬁciency. The EM methods may be performed without MU<br>references, but it will be several fold slower than the FOCE method, and the problem may<br>not even optimize successfully. For simple two compartment models, the new EM<br>
459<br>
<hr>
<A name=465></a>MU MODEL<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
methods are slower than FOCE even with the MU references. But, for 3 compartment<br>models, or numerical integration problems, the improvement in speed by the EM meth-<br>ods, properly MU modeled, can be 5-10 fold faster than with FOCE.<br>
Example 6 described at the end of the SIGL section is one example where importance<br>sampling solves this problem in 30 minutes, with R matrix standard error, versus FOCE<br>which takes 2-10 hours or longer, and without even requesting the $COV step. So, for<br>complex PK/PD problems that take a very long time in FOCE, it is well worth putting in<br>MU references and using one of the EM methods, even if you may need to rephrase some<br>of the ﬁxed/random (theta/eta) effects relationships. In addition, FOCE is a linearized<br>optimization method, and is less accurate than the EM and Bayesian methods when data<br>are sparse or when the posterior density for each individual is highly non-normal.<br>
Model parameters as log t-Distributed in the Population<br>
Sometimes one may suspect that PK/PD model parameters are actually log t-distributed<br>among the population, with degrees of freedom NU, instead of the usual log normal dis-<br>tributed.<br>
See <b>INTRODUCTION TO NONMEM 7, MU Referencing</b><br>
An example of simulation and analysis of such data is given as<br>
..\examples\tdist6_sim.ctl<br>..\examples\tdist6.ctl:<br>..\examples\tdist7.ctl<br>
Note that constructions such as<br>CL=EXP(MU_1+ETA(1)*SQRT((EXP(CLR)-1.0)/CLR))<br>violate the strict MU_x+ETA(x) rule recommended for EM analysis, because the term<br>SQRT((EXP(CLR)-1.0)/CLR) is multiplied by ETA(1). NM-TRAN will generate a<br>number of MU_WARNING messages. Nonetheless for this example, the importance<br>sampling works quite well, and the MU_WARNING messages may be ignored.<br>
REFERENCES: Guide Introduction_7<br>
460<br>
<hr>
<A name=466></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
MXSTEP<br>
MXSTEP<br>
MEANING: PREDPP-PK global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE PRDATA, ONLY: MXSTEP=&gt;MXSTP0<br>
(ADVAN9)<br>
USE PRDATA, ONLY: MXSTEP=&gt;MXSTP01 (ADVAN13,ADVAN14,ADVAN15)<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) MXSTP0<br>
INTEGER(KIND=ISIZE) MXSTP01<br>
DISCUSSION:<br>
MXSTEP<br>
The maximum number of integration steps for ADVAN9 and ADVAN13 and<br>ADVAN14 and ADVAN15.<br>
For ADVAN13 and ADVAN14 and ADVAN15, the default value of MXSTP01 is set<br>to 10000 in resource\PRDAT A.f90<br>
For ADVAN9, the default value of MXSTP0 is set to the largest possible integer<br>value 2147483647 in resource\PRDAT A.f90, so MXSTEP can only be used to set a<br>smaller value.<br>
This variable is only a reserved variable for ADVAN9 and ADVAN13 and<br>ADVAN14 and ADVAN15.<br>
REFERENCES: Guide Introduction_7<br>
461<br>
<hr>
<A name=467></a>NCONTR DETAILED DESCRIPTIONS<br>
Help Guide<br>
NCONTR<br>
MEANING: NCONTR subroutine<br>CONTEXT: NONMEM utility routine<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER(KIND=ISIZE) :: IER1,IER2,L2R<br>
REAL(KIND=DPSIZE) :: CNT<br>
...<br>
CALL NCONTR (CNT,IER1,IER2,L2R)<br>
DISCUSSION:<br>NCONTR is a NONMEM utility routine. It computes the normal-based contribution to<br>the objective function from the data from a single individual (&quot;L1&quot;) record.<br>
NCONTR may be called by a user-supplied CONTR. NCONTR can be used when eta is<br>from a normal distribution with mean 0 and variance-covariance OMEGA. It can be used<br>with population data. It should not be used with single-subject data.<br>
Output argument:<br>
CNT<br>
Contribution to -2log likelihood for data from the L1 record<br>
IER1<br>
IER1 return codes:<br>
1<br>
HESSIAN OF OBJ. FUNC. FOR COMPUTING SOME CONDITIONAL<br>ESTIMATE IS SINGULAR, IF LAPLACIAN IS NOT USED, OR NONPOSI-<br>TIVE DEFINITE, IF LAPLACIAN IS USED.<br>
2<br>
ETA-DERIVATIVE OF SOME CONDITIONAL -2LOG LIKELIHOOD<br>VALUE IS TOO LARGE<br>
3<br>
NUMERICAL HESSIAN OF OBJ. FUNC. FOR COMPUTING SOME CON-<br>DITIONAL ESTIMATE IS NON POSITIVE DEFINITE<br>
11 IF CCONTR IS NOT USED AND F = PREDICTION, SOME INTRAINDI-<br>
VIDUAL VARIANCE-COVARIANCE IS SINGULAR.<br>
IF CCONTR IS NOT USED AND F = LIKELIHOOD, SOME CONDI-<br>TIONAL LIKELIHOOD VALUE IS NEGLIGIBLE.<br>
12 IF CCONTR IS NOT USED AND F = PREDICTION, WEIGHTED SUM OF<br>
&quot;SQUARED&quot; INDIVIDUAL RESIDUALS IS INFINITE.<br>
10+<br>
IF CCONTR IS USED, 10 IS ADDED TO A NONZERO VALUE OF IER1<br>FROM CCONTR.<br>
IER2<br>
0 if error-recovery is to be implemented when IER1 is nonzero.<br>1 if NONMEM is to stop when IER1 is nonzero.<br>
462<br>
<hr>
<A name=468></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NCONTR<br>
L2R<br>
Index of L2 record giving rise to error condition.<br>
Other inputs:<br>
NCONTR obtains all its inputs from NONMEM read-only global variables.<br>
REFERENCES: None.<br>
463<br>
<hr>
<A name=469></a>NEFF,NEFFI DETAILED DESCRIPTIONS<br>
Help Guide<br>
NEFF,NEFFI<br>
MEANING: NEFF and NEFFI programs<br>CONTEXT: NONMEM run<br>
DISCUSSION:<br>With NONMEM 7.4, the NEFF and NEFFI utility programs are used to analyze the qual-<br>ity of a MCMC run. NEFF stands for &quot;Number of EFFective samples&quot;. NEFFI stands<br>for &quot;NEFF for individual&quot;.<br>
For details and examples,<br>See <b>INTRODUCTION TO NONMEM 7: NEFF and NEFFI Utility Programs</b><br>
REFERENCES: Guide Introduction_7<br>
464<br>
<hr>
<A name=470></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NEW<br>
NEW INDIVIDUAL INDICATOR: NEWIND<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied PK and ERROR routines<br>
USAGE:<br>USE PROCM_INT, ONLY: NEWIND=&gt;PNEWIF<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: PNEWIF<br>
DISCUSSION:<br>
NEWIND<br>
NEWIND is of interest only when ICALL=2, 4, 5, or 6. It is the same as the<br>NEWIND argument passed by NONMEM to PREDPP (with the ﬁrst data record of<br>the current event record). Values are:<br>
NEWIND=0: First event record of the data set.<br>NEWIND=1: First event record of the data set, THETA value does not differ<br>from value at last call with this record, and PRED is nonrecursive (See <b>Recur-<br>sive PRED Indicator</b>), or,<br>NEWIND=1: First event record of a subsequent individual record.<br>NEWIND=2: Subsequent event record of an individual record.<br>
Location prior to NONMEM 7: procm1<br>
REFERENCES: Guide VI, section III.I<br>
465<br>
<hr>
<A name=471></a>NINDR DETAILED DESCRIPTIONS<br>
Help Guide<br>
NINDR INDR1 INDR2<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_INT,<br>
ONLY: NINDR=&gt;NINDOBS,INDR1=&gt;IDXOBSF,INDR2=&gt;IDXOBSL<br>
GLOBAL DECLARATION:<br>REAL(KIND=ISIZE):: NINDOBS,IDXOBSF,IDXOBSL<br>
DISCUSSION:<br>
NINDR<br>
The number of individual records in the data set containing an observation record.<br>
INDR1<br>
The index of the ﬁrst individual record in the data set containing an observation<br>record.<br>
INDR2<br>
The index of the last individual record in the data set containing an observation<br>record.<br>
These variables may be used as right-hand quantities in $PRED, $PK, $ERROR, $INFN<br>and $MIX abbreviated code.<br>
Location prior to NONMEM 7: rocm46<br>
REFERENCES: None.<br>
466<br>
<hr>
<A name=472></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NM-TRAN<br>
NM-TRAN OUTPUT FILES<br>
MEANING: NM-TRAN output ﬁles<br>CONTEXT: NONMEM input ﬁle<br>
DISCUSSION:<br>
NM-TRAN produces several output ﬁles, several of which are input ﬁles to NONMEM<br>itself.<br>
In the ﬁrst column, the ﬁles are listed by the default ﬁle names supplied by constants in<br>NM-TRAN’s ABLOCK routine. (Some installations may use different names for these<br>ﬁles.)<br>
The second column lists the inputs to NM-TRAN that contribute to these ﬁles.<br>
The third column indicates how the ﬁles are used.<br>
Note that ﬁle FSIZES is a convenient reference for users to view, but is not used. SUB-<br>ROUTINE FSIZESR in FSUBS is what is actually used during the NONMEM run.<br>
File Relevant portion<br>
How ﬁle is used<br>
name of NM-TRAN inputs<br>
FCON All<br>
NONMEM (control stream)<br>
FDAT A<br>
Data ﬁle, $DAT A, $INPUT NONMEM (data ﬁle)<br>
FSTREAM Filenames from $DAT A,<br>
NONMEM (ﬁle control stream)<br>
$MSFI, $MSFO, $TABLE<br>
FSUBS Abbreviated code<br>
Generated FORTRAN subroutines<br>
FREPORT<br>
$SUBROUTINES<br>
Input to whatever generates the<br>commands that create the NON-<br>MEM executable (e.g., the<br>NMLINK routine).<br>
FORIG Abbreviated code, $ABBR<br>
When $ABBR REPLACE is used,<br>this ﬁle contains the original<br>abbreviated code.<br>
FREPL Abbreviated code, $ABBR<br>
When $ABBR REPLACE is used,<br>this ﬁle contains the post-replace-<br>ment abbreviated code.<br>
FWORK Data ﬁle NM-TRAN (work ﬁle)<br>FWARN All<br>
Warning and informational mes-<br>sages.<br>
FSIZES<br>
Abbreviated code,<br>
Dynamic array sizes for NON-<br>
$THETA, $OMEGA,<br>
MEM<br>
$SIGMA, $SIZES,<br>SIZES.f90<br>
prsizes<br>
Abbreviated code,<br>
Static array sizes for PREDPP<br>
$THETA, $OMEGA,<br>$SIGMA, $SIZES,<br>SIZES.f90<br>
With NONMEM 7, ﬁles FSUBS2 and FSUBS_MU are used by NMTRAN as work ﬁles<br>during the creation of FSUBS.<br>
467<br>
<hr>
<A name=473></a>NM-TRAN DETAILED DESCRIPTIONS<br>
Help Guide<br>
REFERENCES: Guide III, section V.6.0<br>REFERENCES: Guide Introduction_7<br>
468<br>
<hr>
<A name=474></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NMFE<br>
NMFE UTILITY PROGRAM<br>
MEANING: The name of a computer program<br>CONTEXT: NONMEM support utility routine<br>
USAGE:<br>
nmfe74 controlﬁle reportﬁle [-background]<br>
[-prsame] [-prcompile] [-prdefault] [-tprdefault]<br>[-trskip] [-nobuild]<br>[-maxlim=1] [-maxlim=2] [-maxlim=3]<br>[-rundir=directoryname] [-runpdir=directoryname]<br>[-parafile=ﬁlename]<br>[-parafprint=n]<br>[-nmexec=ﬁlename] [-xmloff]<br>[-licfile=ﬁlename]<br>[-locfile=ﬁlename]<br>[-simparon] [-flushtime&gt;=0.0]<br>
Default, if used in the run directory:<br>nmfe74 controlﬁle reportﬁle<br>-prsame (if possible; else -prcompile)<br>-rundir=run<br>-runpdir=temp_dir -nmexec=nonmem<br>-licﬁle=../license/nonmem.lic<br>
Options may need to be in quotes, e.g.,<br>nmfe74 CONTROL5 REPORT5.res &quot;-prsame&quot;<br>
The name of the command indicates the version of NONMEM, e.g. nmfe74 denotes<br>NONMEM 7.4.0. The command will be shown generically as nmfe7 in this help ﬁle.<br>For details speciﬁc to an earlier release than NONMEM 7.4.0, see the help ﬁle for that<br>release.<br>
OPTIONS:<br>
controlﬁle<br>
Name of the input ﬁle containing the NM-TRAN control stream.<br>
reportﬁle<br>
Name of the output ﬁle into which NONMEM writes the results. Also called &quot;the<br>standard results&quot; ﬁle.<br>
-prcompile,-prsame,-prdefault,-tprdefault<br>
By default, nmfe7 copies the required PREDPP routines from the nonmem ..\pr and<br>..\resource directories into a subfolder temp_dir of the current directory and com-<br>piles the routines there. (Some of these routines are needed even when $PRED is<br>used.) This is referred to as &quot;pr recompilation&quot;. The resulting object ﬁles are then<br>linked with NONMEM, and the nonmem executable is created. In a subsequent run,<br>nmfe7 will skip the pr recompilation if the same ADVAN/TRANS (or a $PRED) are<br>used, and the size of the problem (e.g., size of OMEGA and SIGMA) has not<br>changed.<br>
469<br>
<hr>
<A name=475></a>NMFE DETAILED DESCRIPTIONS<br>
Help Guide<br>
-prcompile<br>
Force pr recompilation, in case the run does not appear to execute properly when no<br>pr recompilation occurs.<br>
-prsame<br>
Force the skipping of pr recompilation. Used when nmfe7 detects a change in the<br>previous run from the present run, but the user is convinced there is no signiﬁcant<br>change. Uses the compiled ﬁles from the previous run.<br>
-prdefault<br>
Do not recompile any routines other than FSUBS. Use the precompiled routines in<br>..\pr and ..\resource directories. May be used if it is sufﬁcient to use default values<br>in sizes.f90 for the various parameters (see ..\util\prsizes.f90 for the list of those that<br>are used.). Any NONMEM parameters that are not used (that is, those not listed in<br>prsizes.f90) will still be dynamically sized.<br>
-tprdefault<br>
Tests if is okay to do -prdefault. If it is not okay, then it will test if there are<br>compiled pr routines in temp_dir directory,and if they are appropriate for the present<br>model. If so, it will not recompile those pr routines, and use those that are already<br>there. If not, it will perform a fresh PREDPP compile. May be combined with<br>either -prcompile or -prsame.<br>
-tprdefault -prcompile<br>
Tests if is okay to do -prdefault. If it is not okay, then it will perform a fresh<br>compile of the particular ..\pr routines, even if there were appropriate ones in<br>temp_dir already. (-prcompile forces a compile regardless of whether it was<br>necessary).<br>
-tprdefault -prsame<br>
Tests if is okay to do -prdefault. If it is not okay, then it will use those in<br>temp_dir, assuming that they are appropriate for the present problem.<br>
-trskip<br>
Requests that the NMTRAN step be skipped. The -trskip option is useful if you<br>wish to modify FSUBS.f90 created by a previous run, and insert extra debug lines<br>into FSUBS.f90, and prevent your modiﬁed FSUBS.f90 from being over-written by<br>NMTRAN (it will still be compiled).<br>
-trskip and any one of -prskip, -prnoskip, or -prstatic options may<br>be used together, or -trskip may be used by itself.<br>
-nobuild<br>
Prevents a new nonmem executable from being built, particularly useful for a series<br>of nonmem runs during boostrap procedures.<br>
-maxlim=[1|2|3]<br>
With maxlim=1, then LIM1, LIM3, LIM4, LIM13, and Lim15 (those used during<br>estimation, and therefore by workers in a parallelization problem), will be set to the<br>size needed to assure no buffer ﬁles are used, and everything is stored in memory,<br>for the particular prolem. With -maxlim=2, then LIM1, LIM2, LIM3, LIM4, LIM5,<br>LIM6, LIM7, LIM8, LIM13, LIM15, and LIM16 are also sized to what is needed to<br>assure that buffer ﬁles are not needed. With -maxlim=3, then MAXRECID will also<br>be sized, to MAXDREC, the largest number of records in any individual. With<br>maxlim=3, it is preferred to also use -tprdefault, or -prcompile, but not -prdefault, as<br>NMTRAN’s optional resizing of the PREDPP size parameter MAXRECID may<br>conﬂict with the -prdefault option<br>
470<br>
<hr>
<A name=476></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NMFE<br>
-rundir=directoryname<br>
Speciﬁes a directory for the NONMEM run if it is different from the present work-<br>ing directory. The directory must exist, and must contain all necessary input ﬁles,<br>such as the controlﬁle, msf ﬁles, and data ﬁles.<br>
-runpdir=directoryname<br>
Speciﬁes a directory for the compile if it is different from temp_dir. This is useful if<br>you are repeatedly going between two or more problems, so that often they need to<br>be pr recompiled, and you want to save time. Specify a unique temporary directory<br>for the compilation for each problem.<br>
-parafile=ﬁlename<br>
Name of the &quot;parallel ﬁle&quot; (the parallelization proﬁle) that controls parallelization<br>(distributed computing). Default ﬁle name if not speciﬁed: parallel.pnm. For details<br>on the content, see the INTRODUCTION TO NONMEM 7. Versions prior to NON-<br>MEM 7.2 do not support parallel computing.<br>
-parafprint=n<br>
Sometimes the parallelization log ﬁles can become very large during the $EST and<br>$COV steps. Each of these records have parafprint options to control the print inter-<br>vals. Or, you can control the print iterations globally with the -parafprint option at<br>the command line.<br>
-locfile=ﬁlename<br>
Name of a ﬁle to override the default ﬁle called &quot;nmloc&quot; or &quot;nmloc.bat&quot;. This is the<br>location ﬁle, which gives the path for compiler or MPI system. The nmfe7 script<br>will display a statement as to what path it uses. E.g., &quot;Pathlist information for com-<br>piler and MPI systems are located in nmpathlist.txt&quot; where nmpathlist.txt describes<br>which verson of nmloc is being used.<br>
-nmexec=ﬁlename<br>
Speciﬁes an alternate name for the NONMEM executable instead of the default non-<br>mem.exe (windows) or nonmem (Linux). Note that when parallelization is used,<br>this name must be speciﬁed in the pnm ﬁle. Example:<br>
nmfe7 controlfile reportfile -nmexec=nonmem2 -parafile=mpi2.pnm<br>Suppose mpi2.pnm is based on mpilinux_onecomputer.pnm, which contains<br>1:mpirun -wdir &quot;$PWD&quot; -n 1 ./nonmem<br>
$*<br>
2:-wdir &quot;$PWD/wrk_mpi&quot; -n 1 ./nonmem &lt;control_stream&gt; &lt;licfile&gt;<br>
Then mpi2.pnm must be changed as follows:<br>1:mpirun -wdir &quot;$PWD&quot; -n 1 ./nonmem2<br>
$*<br>
2:-wdir &quot;$PWD/wrk_mpi&quot; -n 1 ./nonmem2 &lt;control_stream&gt; &lt;licfile&gt;<br>
-background<br>
If &quot;-background&quot; is present NONMEM does not poll the terminal for ctrl characters<br>(See below.)<br>
-xmloff<br>
Turns off production of the XML output ﬁle root.xml, where root is the root name of<br>the control stream ﬁle. This may speed up fast computational problems such as<br>$SIM on simple models and small data sets.<br>
-simparon<br>
Turn on parallelization during simulation step.<br>
-flushtime&gt;=0.0<br>
File buffer contents are ﬂushed to ﬁle not more frequently than ﬂushtime seconds<br>
471<br>
<hr>
<A name=477></a>NMFE DETAILED DESCRIPTIONS<br>
Help Guide<br>
(1.0 second) is default. Floating number allowed.<br>
DISCUSSION:<br>
NMFE7.bat and NMFE7 are front-end tools for running NONMEM 7. Their use is<br>optional. NMFE7.BAT is a MS-DOS batch program. NMFE7 is a UNIX C-shell script.<br>Both are supplied on the NONMEM 7 distribution medium.<br>
They should be placed in a directory in the user’s path. Both make use of the support<br>utilities nmlink7 and compile7, which are also supplied on the NONMEM 7 distribution<br>medium.<br>
Both execute the following steps, stopping after any step in which errors occur:<br>
1) NM-TRAN processes the NM-TRAN control stream, which is found in a ﬁle whose<br>
name is given as the ﬁrst command-line argument. With NONMEM 7.2 and higher,<br>both lower and upper case may be used for all user-deﬁned and reserved words in<br>the control stream. With NONMEM 7.3 and higher, &amp; may be used at the end of<br>any line of the control stream to indicate that the line is to be continued, including<br>control records as well as abbreviated code. Lines may be longer than 160 charac-<br>ters long. The maximum length is given by FSD in resource/SIZES.f90.<br>(FSD=67000 with NONMEM 7.3). This step is omitted if option -trskip is used.<br>
2) NMLINK7 creates the ﬁle LINK.LNK (a list of object ﬁles to be included in the<br>
NONMEM executable). With NONMEM 7, compile7 creates the ﬁle compile7.lnk<br>(a list of PREDPP routines to be re-compiled with the current array sizes) and a<br>work directory temp_dir is created. All ﬁles listed in compile7.lnk are copied to<br>temp_dir and compiled. They are then copied to the current run directory. The<br>recompilation of PREDPP routines can take a noticeable amount of time. This step<br>is skipped if option -prsame or -prdefault is used.<br>(See <b>$sizes.ctl</b>).<br>
3) If a ﬁle FSUBS.f90 of generated and/or user-supplied FORTRAN code was created<br>
by NM-TRAN, it is compiled by the FORTRAN 90 compiler.<br>
4) Utility program nonmem_mpi.exe is called to check if parallel processing is<br>
requested, what transfer type is to be used, and make sure the parallel ﬁle is syntacti-<br>cally okay. Either of two sets of messages will appear at the console:<br>Exit status = 1<br>
IN MPI<br>
This indicates that parallel proccesing using the MPI method is requested. MPI<br>libraries will be included in the NONMEM executable.<br>
Exit status = 0<br>
IN REGULAR/FILE TRANSFER<br>This indicates that no parallel processing was requested, or parallel processing uses<br>the FPI (ﬁle transfer) method. No MPI library is needed.<br>
5) The NONMEM executable nonmem.exe (nonmem in UNIX) is created.<br>
6) The NONMEM executable is run. It is passed an option -licﬁle, which tells it where<br>
to ﬁnd the NONMEM license ﬁle. Typically, this is the ﬁle nonmem.lic in the sub-<br>directory license of the directory in which NONMEM was installed.<br>First, arrays are allocated dynamically, according to information supplied by NM-<br>TRAN in ﬁles FSIZES.<br>(See <b>$sizes</b>).<br>
472<br>
<hr>
<A name=478></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NMFE<br>
Processing may be performed as a single CPU process, or distruted among multiple<br>cores or nodes, as speciﬁed in the parallel ﬁle.<br>(See <b>parallel</b>).<br>The output ﬁle whose name is given as the second command-line argument is cre-<br>ated. During the run, NONMEM output can be found in the ﬁle OUTPUT. When<br>the run terminates, ﬁle OUTPUT is copied to the output ﬁle and then removed.<br>
While NONMEM 7 and higher is running, the following may be used if &quot;-backgound&quot;<br>was not present:<br>
ctrl-J<br>
Turn console iteration printing on/off during the Estimation Step (Default is on).<br>
ctrl-K<br>
Stop the Estimation Step, which completes its output, and goes on to next mode or<br>estimation method.<br>
ctrl-E<br>
Exit program gracefully.<br>
ctrl-T<br>
Monitor the progress of each individual during an estimation by toggling ctrl-T.<br>Wait 15 seconds or more to observe a subject’s ID, and individual objective function<br>value. It is also good to test that the problem did not hang if a console output had<br>not been observed for a long while.<br>
The signal program may be used in situations where NONMEM does not respond to the<br>ctrl key.<br>(See <b>signal</b>).<br>
EXAMPLES OF USAGE:<br>
nmfe7 CONTROL5 REPORT5.res<br>
nmfe7 CONTROL5 REPORT5.res -background &gt;&amp; consout &amp;<br>(Trailing &amp; is used in UNIX to run the command in the background.)<br>
Other ﬁles are created by nmfe7 and NONMEM:<br>
FSUBS_MU.F90<br>
Contains SUBROUTINE MUMODEL2. This subroutine contains only the code that<br>is needed to compute any MU parameters (MU_1, MU_2, etc.) that were deﬁned in<br>$PK or $PRED abbreviated code. It is also included in FSUBS.<br>
FSUBS and FSUBS.f90<br>
These are identical. They contain both the content of FSUBS as it was in previous<br>versions of NONMEM (generated subroutines PK, PRED, MODEL, etc., plus any<br>user-supplied code), and also subroutine MUMODEL2. Note that user-supplied<br>code must be in Fortran 90 format.<br>
With NONMEM 7 and higher, additional output ﬁles are created, with names con-<br>trolﬁle.xxx, where xxx is ext, cov, etc.<br>(See <b>additional_output_ﬁles</b>).<br>(See <b>raw_output_ﬁle</b>).<br>
REFERENCES: Guide III, section IV.1.0, V.7.0<br>REFERENCES: Guide Introduction_7<br>
473<br>
<hr>
<A name=479></a>NMTEMPLATE DETAILED DESCRIPTIONS<br>
Help Guide<br>
NMTEMPLATE<br>
MEANING: NMTEMPLATE program<br>CONTEXT: NONMEM run<br>
USAGE:<br>
..\util\nmtemplate<br>
source-template-ﬁle destination-ﬁle var1=val1 var2=val2 ...<br>
where var1=val1 is a variable name, and value to substitute in the template ﬁle. The<br>variable var1 must in turn appear as &lt;var1&gt; in the template ﬁle, and is case sensitive.<br>Similarly for var2, var3, etc.<br>
DISCUSSION:<br>
The utility program nmtemplate in the ..\util directory will perform variable substitution<br>on appropriately tagged control stream template ﬁles, and produce executable control<br>stream ﬁles.<br>
SAMPLE:<br>nmtemplate nmtemp.nmt nmtemp.ctl NMID=47 TH1=1.7 TH2=1.4 TH3=0.8 TH4=2.0<br>
The lines of interest in ﬁle ..\util\nmtemp.nmt are:<br>
$DATA nmtemp2.csv IGNORE=C ACCEPT=(ID.EQ.&lt;NMID&gt;)<br>
$THETA &lt;TH1&gt; &lt;TH2&gt; &lt;TH3&gt; &lt;TH4&gt;<br>
Note that &lt;NMID&gt; is to be replaced with a particular NONMEM ID number by nmtem-<br>plate, and the &lt;THX&gt; are to be replaced with speciﬁc values of thetas. The resulting ﬁle<br>nmtemp.ctl will have the various values substituted into the various &lt;&gt; placeholders, and<br>is ready to be read by NMTRAN:<br>
nmfe7 nmtemp.ctl nmtemp.res<br>
In the above nmtemp.nmt example, because FNLETA=2, then NONMEM will simply<br>evaluate the IPRED values using the inputted etas from the $ETAS record without per-<br>forming an estimation.<br>
Another example template ﬁle is example6.nmt listed in the ..\util directory, that you may<br>inspect for other ideas.<br>
Actually, nmtemplate is a general variable substitution program, and can process any text<br>ﬁle in the manner shown above. Consider a FINEDAT A control stream ﬁle template<br>(nmtemp.fnt):<br>
$INPUT C SET ID JID TIME<br>
DV=CONC AMT=DOSE RATE EVID MDV<br>
CMT CLX V1X QX V2X SDIX SDSX<br>
$DATA nmtemp.csv IGNORE=C<br>
$FINEDATA AXIS=TIME(LIN) TSTOP=&lt;TSTOP&gt; TSTART=&lt;TSTART&gt;<br>
NEVAL=&lt;NEVAL&gt; FILE=nmtemp2.csv<br>
in which the tstart, tstop, and neval parameters are to be inserted:<br>
nmtemplate nmtemp.fnt nmtemp.fnd TSTART=0 TSTOP=100<br>
NEVAL=200<br>
resulting in the FINEDAT A control stream ﬁle nmtemp.fnd:<br>
$INPUT C SET ID JID TIME<br>
DV=CONC AMT=DOSE RATE EVID MDV CMT<br>
CLX V1X QX V2X SDIX SDSX<br>
$DATA nmtemp.csv IGNORE=C<br>
$FINEDATA AXIS=TIME(LIN) TSTOP=100 TSTART=0 NEVAL=200<br>
474<br>
<hr>
<A name=480></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NMTEMPLATE<br>
FILE=nmtemp2.csv<br>
Note that only words that match the variable list at the nmtemplate command line, and<br>have enclosing brackets &lt;&gt;, will be replaced with the suggested values. The values may<br>also be text with no spaces in them.<br>
Nmtemplate may be used with a DOS patch script (which could also be converted to an<br>R/S-PLUS script or function).<br>
Another feature of nmtemplate is that the user may request a random number to be gener-<br>ated to serve as a value, by referring to ˜R(a1,a2,a3). R(a1,a2,a3) is a special function of<br>nmtemplate, which obtains a uniform random variate between a1 and a2. If a seed a3 is<br>given that is not 0, it means to initialize the seed. The initialization should be done once<br>in a series.<br>
For example, the following line sets the seed:<br>
nmtemplate wexample12.nmt dummy.ctl SAMPLE=˜R(1,10000,113345)<br>to be substituted wherever &lt;SAMPLE&gt; shows up in the template ﬁle with a throw-away<br>result ﬁle dummy.ctl. The template ﬁle wexample12.nmt may contain:<br>$EST METHOD=CHAIN FILE=wexample12.txt NSAMPLE=0 ISAMPLE=&lt;SAMPLE&gt;<br>and the resulting ﬁles will contain random ISAMPLE values.<br>
See Guide Introduction_7 for details and examples.<br>
REFERENCES: Guide Introduction_7<br>
475<br>
<hr>
<A name=481></a>NON-ACTIVE DETAILED DESCRIPTIONS<br>
Help Guide<br>
NON-ACTIVE ETA LIST FOR PRED<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY NAETA,LVOUT<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LVR<br>
INTEGER(KIND=ISIZE) :: NAETA,LVOUT(LVR)<br>
DISCUSSION:<br>
NAETA<br>
The number of positions in LVOUT that are set to 1.<br>
LVOUT<br>
When LVOUT(i)=1, NONMEM is ignoring partial derivatives with respect to<br>eta(i) with the current call to PRED.<br>
Location prior to NONMEM 7: rocm15<br>
REFERENCES: None.<br>
476<br>
<hr>
<A name=482></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
NONMEM CONTROL STREAM<br>
MEANING: NONMEM control records<br>CONTEXT: NONMEM input ﬁle<br>
DISCUSSION:<br>NONMEM control records contain the instructions to NONMEM. The set of control<br>records is called the NONMEM control stream. These are different from NM-TRAN<br>control records.<br>
When NM-TRAN is used, NM-TRAN creates the NONMEM control stream in a ﬁle<br>named FCON. When NM-TRAN is not used, the user must create it himself.<br>
Each NONMEM control record begins with a 3 or 4-character preface (record label)<br>which identiﬁes the record. They are listed here in the same order in which they must<br>appear in the NONMEM control stream. For details of the contents of the records, see<br>NONMEM Users Guide V &quot;Introductory Guide&quot;, Appendix 4 - NONMEM Control<br>Records (FCON).<br>
Record type<br>
Preﬁx Corresponding NM-TRAN record<br>
FILE FILE<br>
none<br>
SUPER PROBLEM SUPR<br>
$SUPER<br>
PROBLEM PROB $PROBLEM<br>DEFAULT DFLT<br>
$DEFAULT<br>
Data set speciﬁcation records<br>DATA DAT A<br>
$DAT A<br>
ITEM ITEM<br>
$INPUT<br>
INDEX INDX<br>
$INDEX<br>
LABEL LABL<br>
$INPUT,$TABLE,$SCATTER<br>
EXTRA EVID<br>
XVID $INPUT<br>
FORMAT<br>
FORM $DAT A<br>
Model speciﬁcation records<br>FIND FIND<br>
$MSFI<br>
VERSION MSFV<br>
$MSFI<br>
STRUCTURE STRC<br>
$THETA, $OMEGA, $SIGMA<br>
LEVEL OLEV<br>
$LEVEL<br>
Initial estimate records<br>THETA CONSTRAINT THCN<br>
$THETA<br>
THETA<br>
THTA<br>
$THETA<br>
LOWER BOUND<br>
LOWR $THETA<br>
UPPER BOUND<br>
UPPR $THETA<br>
DIAGONAL DIAG<br>
$OMEGA, $SIGMA<br>
BLOCK SET<br>
BLST $OMEGA, $SIGMA<br>
ETA VALUES ETA<br>
$ETAS<br>
PHI VALUES PHI<br>
$PHIS<br>
CHAIN CHN<br>
$CHAIN<br>
CHAIN FILE<br>
CFIL $CHAIN<br>
477<br>
<hr>
<A name=483></a>NONMEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
CHAIN DELIMITER<br>
CDLM $CHAIN<br>
CHAIN Order<br>
ORDR $CHAIN<br>
CHAIN PARAFILE CHFL<br>
$CHAIN (not used)<br>
OMEGA VALUES ANNL<br>
$ANNEAL<br>
Task speciﬁcation records<br>SIMULATION SIML<br>
$SIMULATION<br>
RANDOM SOURCE<br>
SORC $SIMULATION<br>
SIMULATION PARAFILE SFIL<br>
$SIMULATION<br>
ESTIMATION ESTM<br>
$ESTIMATION<br>
ESTIMATION BEST<br>
$ESTIMATION<br>
ESTIMATION PARAFILE BFIL<br>
$ESTIMATION<br>
ESTIMATION PARAFILE PFIL<br>
$ESTIMATION<br>
ESTIMATION FPARAFILE FFIL<br>
$ESTIMATION<br>
ZERO<br>
ZERO<br>
$ESTIMATION<br>
OMIT OMIT<br>
$OMIT<br>
ESTIMATION GRID<br>
GRID $ESTIMATION<br>
NONPARAMETRIC NONP<br>
$NONPARAMETRIC<br>
COVARIANCE COVR $COVARIANCE<br>COVARIANCE COVT $COVARIANCE<br>COVARIANCE PARAFILE CPAR $COVARIANCE<br>TABLE TABL $TABLE<br>TABLE PARAFILE PPAR $TABLE<br>SCATTERPLOT<br>
SCAT<br>
$SCATTERPLOT<br>
Output speciﬁcation records<br>ESTIMATION DELIMITER<br>
BDLM $ESTIMATION<br>
ESTIMATION MUM<br>
BMUM $ESTIMATION<br>
ESTIMATION GRD<br>
BGRD $ESTIMATION<br>
ESTIMATION ORDER<br>
ORDR $ESTIMATION<br>
LFORMAT<br>
FRML $TABLE<br>
RFORMAT<br>
FRMR $TABLE<br>
ADDITIONAL DIAGNOSTIC LABELS<br>
LBW1 $TABLE,$SCATTER<br>
SYMBOLIC LABELS<br>
LTHT $ABBR REPLACE<br>
SYMBOLIC LABELS<br>
LETA<br>
$ABBR REPLACE<br>
SYMBOLIC LABELS<br>
LEPS $ABBR REPLACE<br>
REFERENCES: Guide I, section B.2<br>REFERENCES: Guide V, Appendix 4<br>
478<br>
<hr>
<A name=484></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
NONMEM ERROR MESSAGES<br>
MEANING: Error messages<br>CONTEXT: NONMEM output<br>
USAGE:<br>
DISCUSSION:<br>This is not a complete list. It includes only commonly seen error messages.<br>
Section I. Errors in the control stream<br>
FILE RECORD MISSING<br>
There is something wrong with the NONMEM control ﬁle. Probably it is an NM-<br>TRAN control ﬁle (starting with $PROBLEM), rather than the FCON ﬁle produced<br>by NM-TRAN.<br>
TOT. NO. OF OBSERVATIONS IN INDIVIDUAL REC NO.<br>
1<br>
(IN<br>
INDIVIDUAL REC ORDERING) EXCEEDS<br>
50<br>
SEE INSTALLATION GUIDE<br>
There are too many observation records in some individual record. To increase the<br>limit beyond 50, NONMEM must be recompiled. see Guide III, Section 2.7.<br>
INITIAL ESTIMATE OF OMEGA HAS A NONZERO BLOCK WHICH IS<br>
NUMERICALLY NOT POSITIVE DEFINITE<br>
Possible cause: initial estimates of the variance and covariance terms in a block of<br>OMEGA are not appropriate. Try other initial estimates. (Hint: it helps of the<br>covariance estimates are small relative to the variance estimates.)<br>
USER CCONTR ROUTINE NOT USED, BUT THERE ARE NO EPSILONS, AND<br>
ETAS ARE TO BE ESTIMATED<br>
This can happen when POSTHOC etas are requested, but the data are single-subject<br>data. The user may have included the POSTHOC option in error.<br>
UNABLE TO OBTAIN A SATISFACTORY INITIAL ESTIMATE OF VARI-<br>
ANCE-COVARIANCE COMPONENTS<br>
BLOCKS IN BLOCK SET 2 OF OMEGA ARE NUMERICALLY NOT POSITIVE<br>
DEFINITE<br>
This message is from the Initial Estimates Step. It identiﬁes certain parameters<br>whose initial estimates could not be obtained.<br>
Part II. Error in NONMEM tasks<br>
NUMBER OF CALLS TO SIMETA EXCEEDS NO. OF DATA RECORDS FOR<br>
INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)<br>
During the Simulation Step, an excessive number of calls to SIMETA hav e occurred.<br>It may be that the users’s PRED is attempting to obtain ETA from a truncated distri-<br>bution but, due to some error, is rejecting all or virtually all values. (Possibly, the<br>NEW option was omitted from the random source.)<br>
Some messages are preceded by lines such as the following that identify the NONMEM<br>routine that has detected the error:<br>PROGRAM TERMINATED BY OBJ<br>
PROGRAM TERMINATED BY OBJ, ERROR IN CELS<br>
PROGRAM TERMINATED BY OBJ, ERROR IN ELS<br>
PROGRAM TERMINATED BY PRRES, ERROR IN ELS<br>
479<br>
<hr>
<A name=485></a>NONMEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
PROGRAM TERMINATED BY FNLETA<br>
OBJ computes the objective function;<br>ELS computes Extended Least-Squares contribution to the objective function from<br>the data from a single individual (&quot;L1&quot;) record.<br>CELS computes the conditional contribution to the ELS objective function;<br>PRRES prints ﬁnal results.<br>FNLETA computes subject-speciﬁc (posthoc) eta values.<br>
WITH INDIVIDUAL<br>
1 (IN INDIVIDUAL RECORD ORDERING)<br>
A line such as this identiﬁes the record.<br>
Here are some commonly seen error messages.<br>INTRAINDIVIDUAL VARIANCE OF DATA FROM OBS RECORD<br>
1 ESTIMATED TO BE 0<br>
VAR-COV OF DATA FROM INDIVIDUAL RECORD ESTIMATED TO BE<br>
SINGULAR<br>
A possible cause is the use of a proportional intra-individual error model while<br>some predicted values for actual observations are zero or close to zero. (For exam-<br>ple, if the ﬁrst dose is an infusion and there is a &quot;base- line&quot; observation at the<br>start of the infusion, the predicted level will be zero.)<br>
MINIMIZATION TERMINATED DUE TO PROXIMITY OF NEXT ITERATION<br>
EST. TO A VALUE AT WHICH THE OBJ. FUNC. IS INFINITE<br>
NONMEM Theta-recovery has failed.<br>
OCCURS DURING SEARCH FOR ETA AT A NONZERO VALUE OF ETA<br>
An error occurred while NONMEM was obtaining conditional estimates of eta.<br>
Section III. Errors in PREDPP<br>
Errors in LSODA<br>
As of NONMEM 7, A differential equation solver has been introduced, called LSODA,<br>and is accessed using ADVAN=13 or ADVAN13. The code to the differential equation<br>solver is found in source\LSODA.f90. On occasion, coded errors will be displayed if the<br>algorithm is having trouble integrating the equations. These errors may usually be<br>ignored, unless the error shows up frequently, and ultimately results in failure for the<br>problem to complete. Typically the remedy is to increase or decrease TOL, but for those<br>who desire to understand what the error codes mean, there are well documented com-<br>ments on these at the beginning of LSODA.f90. They are printed here for convenience:<br>
!ISTATE=An index used for input and output to specify the the state of the calculation.<br>
!<br>
! On input,the values of istate are as follows.<br>
! 1   Means this is the first call for the problem (initializations will be done).<br>
!<br>
See note below.<br>
! 2   Means this is not the first call,and the calculation is to continue<br>
!<br>
normally, with no change in any input parameters except possibly TOUT<br>
!<br>
and ITASK. (If ITOL,RTOL,and/or ATOL are changed between calls with<br>
!<br>
ISTATE=2,the new values will be used but not tested for legality.)<br>
! 3   Means this is not the first call,and the calculation is to continue<br>
!<br>
normally,but with a change in input parameters other than TOUT and ITASK.<br>
!<br>
changes are allowed in NEQ,ITOL,RTOL,ATOL,IOPT,LRW,LIW,JT,ML,MU and any<br>
!<br>
optional inputs except H0,MXORDN,AND MXORDS.<br>
!<br>
(see IWORK description for ML and MU.)<br>
! Note: A preliminary call with TOUT=T is not counted as a first call here,as<br>
! no initialization or checking of input is done. (Such a call is sometimes<br>
! useful for the purpose of outputting the initial conditions.) Thus the first<br>
480<br>
<hr>
<A name=486></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
! call for which TOUT /= T requires ISTATE=1 on input.<br>
!<br>
! On output,istate has the following values and meanings.<br>
!<br>
1<br>
Means nothing was done; TOUT=T and ISTATE=1 on input.<br>
!<br>
2<br>
Means the integration was performed successfully.<br>
! -1<br>
Means an excessive amount of work (more than MXSTEP steps) was done on<br>
!<br>
this call,before completing the requested task,but the integration was<br>
!<br>
otherwise successful as far as T. (MXSTEP is an optional input and is<br>
!<br>
normally 500.) TO continue,the user may simply reset ISTATE to a value &gt; 1<br>
!<br>
and call again (the excess work step counter will be reset to 0).<br>
!<br>
In addition,the user may increase MXSTEP to avoid this error return<br>
!<br>
(see below on optional inputs).<br>
! -2<br>
Means too much accuracy was requested for the precision of the machine<br>
!<br>
being used. This was detected before completing the requested task,but<br>
!<br>
the integration was successful as far as T. To continue,the tolerance<br>
!<br>
parameters must be reset,and ISTATE must be set to 3. The optional output<br>
!<br>
TOLSF may be used for this purpose. (Note: If this condition is detected<br>
!<br>
before taking any steps,then an illegal input return (ISTATE=-3) occurs<br>
!<br>
instead.)<br>
! -3<br>
Means illegal input was detected,before taking any integration steps.<br>
!<br>
See written message for details.<br>
!<br>
Note: If the solver detects an infinite loop of calls to the solver with<br>
!<br>
illegal input,it will cause the run to stop.<br>
! -4<br>
Means there were repeated error test failures on one attempted step,before<br>
!<br>
completing the requested task,but the integration was successful as far as T.<br>
!<br>
The problem may have a singularity,or the input may be inappropriate.<br>
! -5<br>
Means there were repeated convergence test failures on one attempted step,<br>
!<br>
before completing the requested task,but the integration was successful as<br>
!<br>
far as T. This may be caused by an inaccurate jacobian matrix, if one is<br>
!<br>
being used.<br>
! -6<br>
Means EWT(I) became zero for some I during the integration. Pure relative<br>
!<br>
error control (ATOL(I)=0.0) was requested on a variable which has now<br>
!<br>
vanished. The integration was successful as far as T.<br>
! -7<br>
Means the length of RWORK and/or IWORK was too small to proceed,but the<br>
!<br>
integration was successful as far as T. This happens when DLSODA chooses<br>
!<br>
to switch methods but LRW and/or LIw is too small for the new method.<br>
!<br>
! Note: Since the normal output value of ISTATE is 2, it does not need to be<br>
! reset for normal continuation. Also,since a negative input value of ISTATE<br>
! will be regarded as illegal, a negative output value requires the user to<br>
! change it, and possibly other inputs,before calling the solver again.<br>
REFERENCES: Guide I, section G<br>REFERENCES: Guide V, section 13<br>
481<br>
<hr>
<A name=487></a>NONMEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
NONMEM FILE CONTROL STREAM<br>
MEANING: NONMEM File Control Records<br>CONTEXT: NONMEM input ﬁle<br>
DISCUSSION:<br>The NONMEM File Control Stream provides the names of optional ﬁles to be opened by<br>NONMEM. It is read by NONMEM from a ﬁle whose name is given on the FILE record<br>of the NONMEM Control Stream.<br>
When NM-TRAN is used, NM-TRAN creates the NONMEM File Control Stream in a<br>ﬁle named FSTREAM.<br>
Each NONMEM File Control Record begins with a 4-character preface (record label)<br>which identiﬁes the record.<br>
Record type<br>
Preﬁx Corresponding NM-TRAN record<br>
DATA DAT A<br>
$DAT A ...<br>
MODEL SPECIFICATION FILE INPUT<br>
MSFI $MSFI ...<br>
MODEL SPECIFICATION FILE OUTPUT<br>
MSFO $ESTIMATION MSFO=...<br>
TABLE TABL $TABLE FILE=...<br>Problem delimiter<br>
**** none<br>
Multiple TABLE records may be present for a given problem, one for each table to be<br>written to a new table ﬁle.<br>
REFERENCES: Guide I, section B.3<br>
482<br>
<hr>
<A name=488></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
NONMEM MODEL<br>
MEANING: The name of a type of statistical model.<br>CONTEXT: NONMEM input/output<br>
DISCUSSION:<br>
The acronym NONMEM denotes both the model and the program used to analyze data<br>according to such a model. (See <b>nonmem_program</b>) This entry discusses the NONLIN-<br>EAR MIXED EFFECTS MODEL (NONMEM).<br>
Regression models structurally link (possibly multivariate) observations (Dependent vari-<br>ables, DV) to independent variables (ﬁxed effects, represented by other data items)<br>through a functional form (model) quantiﬁed by (ﬁxed effect) parameters. These model<br>forms may be nonlinear in the parameters.<br>
Random effects may also enter the model. In NONMEM they are of two types which usu-<br>ally enter the model at two different levels. The ﬁrst type, ETA, describes differences<br>between individuals; the second type, EPSILON, describes errors between model predic-<br>tions and observations. (When all data come from the same individual, or when each<br>observation is to be treated as statistically independent from all others, then ETA-type<br>random effects describe all errors, and EPSILON-type random effects do not appear).<br>
Within an individual, ETA may be a vector. Likewise, within one observation, EPSILON<br>may be a vector, especially if the observations are multivariate, as several random effects<br>of each type may be needed to characterize the data adequately.<br>
The parameter vector THETA contains all ﬁxed effect population parameters.<br>
The OMEGA matrix, a random effects parameter, is the variance-covariance matrix of<br>ETA (across individuals); the SIGMA matrix serves the same function for EPSILON (its<br>variance covariance is assumed identical across all observations).<br>
(See <b>eta</b>, <b>eps</b>, <b>theta</b>, <b>effect</b>). (See <b>parameter</b>, <b>model</b>, <b>omega</b>, <b>sigma</b>).<br>
REFERENCES: Guide I, section C , D , E<br>REFERENCES: Guide V, section 3 , 4<br>
483<br>
<hr>
<A name=489></a>NONMEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
NONMEM MODULES<br>
MEANING: Global variables in NONMEM<br>CONTEXT: User-supplied routines<br>
DISCUSSION:<br>FORTRAN modules are used to communicate values between various components of the<br>NONMEM system. They supplement the subroutine arguments.<br>
1) NONMEM-PRED modules<br>
These modules contain values that are (for the most part) communicated from PRED to<br>NONMEM. Prior to NONMEM 7 these values were COMMON blocks. Following is a<br>list of the MODULE, the (old) COMMON, and a description of the variables.<br>
NMPRD_INT (NMPRD1)<br>
PRED return code and user message count (IERPRD,NETEXT)<br>
NMPRD_CHAR (NMPRD2)<br>
PRED user message (ETEXT)<br>
NMPRD_INT (NMPRD3)<br>
&quot;Copying pass&quot; ﬂag and SAVE region size for NMPRD4 (COMACT,COMSAV)<br>
NMPRD4P (NMPRD4)<br>
PRED-deﬁned items for tables and scatterplots<br>
NMPRD_REAL (NMPRD5)<br>
Correlation matrix for ε ’s.<br>
NMPRD_INT (NMPRD6)<br>
Return code from routine SIMEPS.<br>
NMPRD_REAL (NMPRD7)<br>
Simulated etas for tables and scatterplots.<br>
NMPRD_REAL (NMPRD8)<br>
PRED’s &quot;recursive&quot; ﬂag<br>
NMPRD_REAL (NMPRD9)<br>
Data record at ICALL 0, 1 and 3<br>
NMPR_INT (NMPR10)<br>
Control information for PRED repetition feature.<br>
NMPR_INT (NMPR11)<br>
Flags to override effect of NEW option on $SIMULATION record.<br>
NMPR_REAL (NMPR12)<br>
Conditional limits on observation.<br>
NMPR_REAL (NMPR13)<br>
Lower limits deﬁning interval datum, and their derivatives.<br>
NMPR_REAL (NMPR14)<br>
Upper limits deﬁning interval datum, and their derivatives.<br>
NMPR_INT (NMPR15)<br>
Skip control variable.<br>
NMPR_REAL (NMPR16)<br>
Parameter values produced during Simulation Step.<br>
484<br>
<hr>
<A name=490></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
NMPR_INT (NMPR17)<br>
Flag indicating character of PRED variable F.<br>
2) NONMEM read-only modules<br>
These modules contain read-only values that are communicated from NONMEM to<br>PRED and other user-supplied routines.<br>
ROCM_REAL (ROCM0)<br>
Current theta (THETA)<br>
ROCM_REAL (ROCM1)<br>
DV, data items in current L1 record<br>
ROCM_INT (ROCM1C)<br>
Size of current L1 record (prior to NONMEN 7, this was combined with ROCM1).<br>
ROCM_INT (ROCM2)<br>
Number of L2 records and length of L2 record<br>
ROCM_REAL (ROCM3)<br>
Predictions and derivatives with current L1 record<br>
ROCM_REAL (ROCM4)<br>
Selected data from an individual record<br>
ROCM_INT (ROCM4)<br>
Selected data from an individual record<br>
ROCM_REAL (ROCM5)<br>
Predictions and derivatives with current L2 record<br>
ROCM_REAL (ROCM6)<br>
Initial/ﬁnal theta, omega, sigma<br>
ROCM_REAL (ROCM7)<br>
Standard errors of estimates of theta, omega, sigma<br>
ROCM_REAL (ROCM8)<br>
Final value of the objective function<br>
ROCM_INT (ROCM9)<br>
Return codes from Estimation and Covariance Steps<br>
ROCM_INT (ROCM10)<br>
Simulation: no. of replications (total and current)<br>
ROCM_INT (ROCM11)<br>
Mixture: index of subpopulation (current and most probable)<br>
ROCM_INT (ROCM12)<br>
Second and ﬁrst derivative ﬂags for PRED<br>
ROCM_INT (ROCM13)<br>
Simulation: Final pass ﬂag for PRED and CONTR<br>
NMPRD_INT (ROCM14)<br>
Problem and subproblem counters.<br>
NMPRD_INT (ROCM15)<br>
List of inactive etas.<br>
ROCM_REAL (ROCM16)<br>
The number of signiﬁcant digits in the the vector of ﬁnal estimates.<br>
485<br>
<hr>
<A name=491></a>NONMEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
ROCM_INT (ROCM17)<br>
New lev el 2 record ﬂag<br>
ROCM_REAL (ROCM18)<br>
Nonparametric estimates: height and heights of cumulative marginals<br>
ROCM_REAL (ROCM22)<br>
Current value of omega.<br>
ROCM_REAL (ROCM25)<br>
Mixing probabilities<br>
ROCM_REAL (ROCM28)<br>
Superproblem printing indicator<br>
NMPRD_INT (ROCM29)<br>
Population vs. single-subject data ﬂag.<br>
ROCM_REAL (ROCM31)<br>
Template record at ICALL=6.<br>
ROCM_INT (ROCM32)<br>
Number of the individual record and of the data record.<br>
ROCM_INT (ROCM34)<br>
NEWIND at ICALL 0, 1 and 3.<br>
ROCM_INT (ROCM35)<br>
Numbers of thetas, etas and epsilons in the problem.<br>
ROCM_REAL (ROCM36)<br>
Individual’s posterior variance-covariance matrix. No help entry.<br>
ROCM_INT (ROCM37)<br>
Indicator that Estimation Step is omitted and obj. func. is being evaluated for ﬁrst<br>time. No help entry.<br>
ROCM_REAL (ROCM38)<br>
Conditional limits for observations in individual record. No help entry.<br>
ROCM_REAL (ROCM39)<br>
Conditional limits for observation. No help entry.<br>
ROCM_REAL (ROCM40)<br>
Lower Limits deﬁning interval datum, and their derivatives in individual record. No<br>help entry.<br>
ROCM_REAL (ROCM41)<br>
Upper Limits deﬁning interval datum, and their derivatives in individual record. No<br>help entry.<br>
ROCM_REAL (ROCM42)<br>
Lower Limits deﬁning interval datum, and their derivatives. No help entry.<br>
ROCM_REAL (ROCM43)<br>
Upper Limits deﬁning interval datum, and their derivatives. No help entry.<br>
ROCM_REAL (ROCM44)<br>
Probability that observation is within (outside) limits.<br>
ROCM_REAL (ROCM45)<br>
Probability that category occurs.<br>
ROCM_INT (ROCM46)<br>
Number of individual records with observations, and indices of ﬁrst and last such<br>
486<br>
<hr>
<A name=492></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
record.<br>
ROCM_REAL (ROCM47)<br>
Mixture probabilities with individual record containing template record.<br>
ROCM_INT (ROCM48)<br>
Length of individual record.<br>
ROCM_REAL (ROCM49)<br>
Prediction, residual, and weighted residual values for all methods, as well as normal-<br>ized probability distribution error.<br>
ROCM_INT (ROCM50)<br>
ID data item for the individual contributions to the objective function.<br>
ROCM_REAL (ROCM50)<br>
Individual contributions to the objective function.<br>
Except as noted, each has its own entry in the Help document. Some modules are not<br>fully documented. The interested user may be able to obtain more information by study-<br>ing the appropriate sections of NONMEM code and previous examples that may be avail-<br>able from advanced users.<br>
(See <b>PREDPP_modules</b>).<br>
REFERENCES: Guide IV, section IV.E<br>REFERENCES: Guide VI, section III.E.4 , III.I , Figures 5, 6<br>
487<br>
<hr>
<A name=493></a>NONMEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
NONMEM OUTPUT FILES<br>
MEANING: NONMEM output ﬁles<br>CONTEXT: NONMEM output ﬁle<br>
DISCUSSION:<br>
NONMEM produces several output ﬁles.<br>
First is the NONMEM report ﬁle. The name of this ﬁle is speciﬁed by the user on the<br>nmfe command. Help entries describe the various sections of the report.<br>
(See <b>DATA_SET</b>,<b>DATA_RECORDS</b>,<b>DATA_ITEMS</b>).<br>(See <b>INITIAL_ESTIMATE</b>,<b>MONITORING_OF_SEARCH</b>).<br>(See <b>MINIMUM_VALUE_OF_OBJ._FUNCTION</b>,<b>FINAL_PARAMETER_ESTIMATE</b>).<br>(See <b>ETABAR</b>,<b>STANDARD_ERROR_OF_ESTIMATE</b>).<br>(See <b>SHRINKAGE</b>).<br>(See <b>CORRELATION_MATRIX_OF_ESTIMATE</b>,<b>COVARIANCE_MATRIX_OF_ESTIMATE</b>).<br>
With NONMEM 7, tag labels are present in the report ﬁle to allow a third-party program<br>to ﬁnd the appropriate positions in the ﬁle without having to search for speciﬁc words in<br>the text. (a more efﬁcient way of extracting numerical results from the analysis is from<br>the raw and additional output ﬁles (see below)). Tag labels are:<br>
#PARA (NM72)<br>
This tag identiﬁes the parallelization ﬁle and number of nodes used, if parallel esti-<br>mation is performed.<br>
#TBLN (NM72)<br>
This tag speciﬁes that following it, on the same line, will be found an integer that<br>refers to the number of this estimation method. This number is also the table num-<br>ber listed in the title to tables in the various output ﬁles (raw output ﬁle, .cov, .cor,<br>etc). The table number is incremented for each $EST statement, across all problems<br>in the control stream ﬁle.<br>
#METH<br>
This tag speciﬁes that following it, on the same line, will be found a text that<br>describes the method, for example First Order Conditional Estimation Method with<br>Interaction.<br>
#TERM<br>
This tag indicates that beginning on the next lines, text describes the termination sta-<br>tus of the analysis.<br>
#TERE<br>
This tag indicates the end of the lines describing the termination status of the analy-<br>sis. Thus, a software program may transfer all lines between #TERM: and #TERE:<br>to a summary ﬁle.<br>
#OBJT<br>
Indicates that following it, on the same line, is the text describing the objective func-<br>tion, such as Minimal Value Of Objective Function.<br>
#OBJV<br>
Indicates that following it, on the same line, is the objective function value.<br>
488<br>
<hr>
<A name=494></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
#OBJS<br>
Indicates that following it, on the same line, is the objective function standard devia-<br>tion (MCMC Bayesian analysis only).<br>
#OBJN (NM73)<br>
Indicates that following it, on the same line, is the nonparametric objective function<br>value.<br>
#CPUT (NM73)<br>
Total CPU time. It is an accurate representation of the computer usage, whether sin-<br>gle or parallel process. The same problem when run singly or in parallel will report<br>a similar cpu time. This is in contrast with elapsed time, which is improved with<br>parallelization.<br>
With NONMEM 7, raw and additional output ﬁles are generated to capture parts of the<br>report ﬁle.<br>
The raw output ﬁle is called root.ext, or named by the FILE option of the $ESTIMATION<br>record.<br>(See <b>raw_output_ﬁle</b>).<br>
The additional output ﬁles capture portions of the report ﬁle.<br>(See <b>additional_output_ﬁle</b>).<br>They are:<br>
root.cov<br>root.clt (NM74)<br>root.cor<br>root.coi<br>root.phi<br>root.phm (NM72)<br>root.shk (NM72)<br>root.shm (NM73)<br>root.grd (NM72)<br>root.xml (NM72)<br>root.cnv (NM72)<br>root.smt (NM72)<br>root.rmt (NM72)<br>root.imp (NM73)<br>root.npd (NM73)<br>root.npe (NM73)<br>root.npi (NM73)<br>root.npl (NM74)<br>root.fgh (NM73)<br>root.agh (NM73)<br>root.cpu (NM73)<br>root.vpd (NM74)<br>root.ets (NM74)<br>msfroot_ETAS<br>msfroot_RMAT, msfroot_SMAT (NM73)<br>
REFERENCES: Guide Introduction_7<br>
489<br>
<hr>
<A name=495></a>NONMEM DETAILED DESCRIPTIONS<br>
Help Guide<br>
NONMEM PROGRAM<br>
MEANING: The name of a computer program.<br>CONTEXT: NONMEM input/output<br>
DISCUSSION:<br>The acronym NONMEM denotes both a type of statistical model and the program used to<br>analyze data according to such a model. (See <b>nonmem_model</b>). This entry brieﬂy<br>describes the NONLINEAR MIXED EFFECTS MODEL (NONMEM) program.<br>
NONMEM is a computer program written in FORTRAN 90 used to analyze data accord-<br>ing to a Non-linear Mixed Effects Model. NONMEM is batch-oriented. It is accompa-<br>nied by an input preprocessor (NM-TRAN) that provides a SAS-like user communication<br>interface, and by a suite of subprograms (PREDPP) that, within the context of the NON-<br>MEM program, implements most of the common simple pharmacokinetic models used by<br>pharmacokineticists. PREDPP also has code for solving general linear and non-linear<br>differential equations describing more complicated pharmacokinetic models.<br>
The user generally will have to supply data and a code (either in an abbreviated form<br>understood by NM-TRAN, or in a FORTRAN subroutine) specifying the dependence on<br>the mixed effects. He will also have to make choices regarding the NONMEM process:<br>e.g., whether to estimate parameters, and if so, which of several estimation methods to<br>use (each method minimizes a different objective function).<br>
NONMEM output reports the minimum value of the objective function, parameter esti-<br>mates, standard errors, tables, and line-printer scatterplots, etc., as requested. NONMEM<br>computes model predictions using the parameter estimates, and similarly, residuals and<br>weighted residuals, and makes these available for tables and scatterplots.<br>
NONMEM can also easily be used to simulate data under a NONMEM model.<br>
With NONMEM 7, there are additional output ﬁles, called the &quot;raw&quot; and &quot;additional&quot; out-<br>put ﬁles. Here, &quot;root&quot; is the name of the NM-TRAN input ﬁle speciﬁed on the nmfe7<br>command (not including extension). These provide an efﬁcient way of way of extracting<br>numerical results from the analysis. By default, the raw output ﬁle is root.ext. The addi-<br>tional output ﬁles include root.ext root.cov root.coi root.cor root.phi, etc., where root is<br>the name of the control ﬁle (not including extensions).<br>
(See <b>raw_output_ﬁles</b>).<br>(See <b>additional_output_ﬁles</b>).<br>(See <b>estimate</b>, <b>method</b>, <b>parameter</b>, <b>parameter_estimate</b>).<br>(See <b>objective_function</b>, <b>table</b>, <b>scatterplot</b>).<br>(See <b>residual</b>, <b>weighted-residual</b>, <b>predpp</b>).<br>
REFERENCES: Guide I, section A<br>REFERENCES: Guide V, section 1 , 2<br>
490<br>
<hr>
<A name=496></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NONMEM<br>
NONMEM STEPS<br>
MEANING: Sequence of events in a NONMEM problem<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>
NONMEM loads information from a model speciﬁcation ﬁle, if $MSFI is present NON-<br>MEM makes a single call to PRED (with ICALL=0), at the beginning of the run, to allow<br>PRED to undertake run initialization (INITL).<br>
NONMEM makes a single call to PRED (with ICALL=1), at the beginning of every<br>problem, to allow PRED to undertake problem initialization (INITL).<br>
SIMULATION STEP<br>
NONMEM inputs initial ﬁxed effects parameters from ﬁle speciﬁed by $CHAIN, if<br>record is present NONMEM performs simulation (with ICALL=4) (if $SIMULA-<br>TION present).<br>
INITIAL ESTIMATE STEP (with ICALL=2)<br>
NONMEM obtains initial estimates for theta, omega, sigma (if the control stream<br>does not provide all initial estimates).<br>
ESTIMATION STEP (with ICALL=2)<br>
NONMEM inputs initial etas from ﬁle speciﬁed by $ETAS/$PHIS, if record is<br>present NONMEM searches for parameter values that minimize the objective func-<br>tion (if $ESTIMATION present). With NONMEM 7, multiple Estimation Steps can<br>be implemented in a single problem. A sequence of two or more Estimation Steps<br>will result in the sequential execution of each.<br>
COVARIANCE STEP (with ICALL=2)<br>
NONMEM obtains a variance-covariance matrix of the estimator and related infor-<br>mation such as standard errors (if $COVARIANCE present).<br>
FINALIZATION STEP (with ICALL=2,5,6)<br>
NONMEM obtains the following as needed:<br>
Classiﬁcation into subpopulations (if a MIXTURE model is used)(FNLMOD).<br>
Posthoc estimates of eta (FNLETA).<br>
Nonparametric step (NONPAR, with ICALL=2): NONMEM obtains either<br>marginal cumulatives or conditional (nonparametric) estimates of etas (if<br>$NONPARAMETRIC present).<br>
PRED-deﬁned values from NMPRD4 (NP4F) (for tables and scatterplots).<br>
NONMEM computes WRES and other diagnostics if they are to be displayed in tables or<br>scatters. (PRRES)<br>
NONMEM makes a single call to PRED (with ICALL=3), at the end of every problem<br>(and subproblem), to allow PRED to undertake problem ﬁnalization.<br>
TABLE STEP<br>
NONMEM constructs tables (if $TABLE present).<br>
SCATTERPLOT STEP<br>
NONMEM constructs scatterplots (if $SCATTERPLOT present).<br>
REFERENCES: Guide I, section A.4 , G<br>
491<br>
<hr>
<A name=497></a>NONPARAMETRIC DETAILED DESCRIPTIONS<br>
Help Guide<br>
NONPARAMETRIC DENSITY: DEN ,CDEN.ta 5.5iR<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_REAL, ONLY: DEN_=&gt;DEN_NP(1),CDEN_=&gt;DEN_NP(2:LVR+1)<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: DEN_NP(LVR+1)<br>
DISCUSSION:<br>
DEN_<br>
The nonparametric density.<br>
CDEN_(1)<br>
The marginal cumulative value for the ﬁrst eta.<br>
CDEN_(2)<br>
The marginal cumulative value for the second eta.<br>etc.<br>
Values are computed by NONMEM when the Nonparametric step is performed and mar-<br>ginal cumulatives<br>
are requested (with NM-TRAN: $NONPARAMETRIC<br>
MARGINALS).<br>
Values are available during the pass with COMACT=2 and (if PASS is called) at<br>ICALL=3.<br>
These variables may be used as right-hand quantities in abbreviated code blocks $PK,<br>$ERROR, $INFN and $PRED.<br>
Location prior to NONMEM 7: rocm18<br>
REFERENCES: None.<br>
492<br>
<hr>
<A name=498></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NPD,NPDE,NPDE MODE,DV LOQ<br>
NPD,NPDE,NPDE MODE,DV LOQ<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY: NPDE_MODE<br>
USE NMPRD_REAL, ONLY: DV_LOQ<br>
GLOBAL DECLARATION:<br>
INTEGER(KIND=ISIZE) ::<br>
NPDE_MODE<br>
REAL(KIND=DPSIZE) :: DV_LOQ<br>
DISCUSSION:<br>
NONMEM 7 can compute the following:<br>
NPDE<br>
Monte-Carlo generated normalized probability distribution error.<br>
NPD<br>
The correlated (or non-decorrelated) NPDE value.<br>
These are calculated during the Table Step, when NPD or NPDE is listed in $TABLE or<br>$SCATTER.<br>
NONMEM sets NPDE_MODE=1 when it is computing them.<br>
Otherwise,<br>
NPDE_MODE=0.<br>
EXAMPLE:<br>
To incorporate LOQ (Limit of Quantiﬁcation) data into NPDE assessments [4], use the<br>following method (as an example).<br>See <b>INTRODUCTION TO NONMEM 7</b>, Reference [4].<br>Here, TYPE and LOQ are user-deﬁned in previous code, or data item.<br>
$ERROR<br>
SD = THETA(5)<br>
IPRED = LOG(F)<br>
DUM = (LOQ - IPRED) / SD<br>
CUMD = PHI(DUM)<br>
IF (TYPE .EQ. 1.OR.NPDE_MODE.EQ.1) THEN<br>
F_FLAG = 0<br>
Y = IPRED + SD * ERR(1)<br>
ENDIF<br>
IF (TYPE .EQ. 2.AND.NPDE_MODE.EQ.0) THEN<br>
F_FLAG = 1<br>
Y = CUMD<br>
MDVRES=1<br>
ENDIF<br>
IF(TYPE.EQ.2) DV_LOQ=LOQ<br>
....<br>
$TABLE NPD NPDE<br>
By default, DV_LOQ is set to -1.0d-300 by the NONMEM routine that calls<br>PREDPP/PRED. If the user’s ERROR/PRED sets DV_LOQ to some other value and<br>NPDE_MODE=1, then the NPDE is being evaluated during that time, and this censored<br>value is to be treated as if it is a non-censored datum with value of LOQ<br>
493<br>
<hr>
<A name=499></a>NPD,NPDE,NPDE MODE,DV LOQ<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
(DV_LOQ=LOQ), in accordance with [4], utilizing a standard F_FLAG=0 deﬁnition for<br>Y. Note that during estimation of the objective function (when NPDE_MODE=0), NPDE<br>is not being evaluated, and censored values should be treated using F_FLAG=1, and Y<br>must be deﬁned as the integral of the normal density from -inf to LOQ.<br>
REFERENCES: Guide Introduction_7<br>
494<br>
<hr>
<A name=500></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NWPRI<br>
NWPRI<br>
MEANING: NWPRI subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER (KIND=ISIZE) :: NTHETA,NETA,NEPS,NTHP,NETP,NEPP,NPEXP<br>
INTEGER (KIND=ISIZE) :: ITYP,NSAM,ISS<br>
REAL (KIND=DPSIZE), ONLY: CNT<br>
REAL (KIND=DPSIZE), ONLY: PLEV<br>
INTEGER (KIND=ISIZE) :: ICALL<br>
CALL NWPRI (NTHETA,NETA,NEPS,NTHP,NETP,NEPP,NPEXP,ITYP,PLEV, &amp;<br>
NSAM,ISS,CNT)<br>
DISCUSSION:<br>The user-written PRIOR subroutine allows a penalty function based on a frequency prior<br>to be speciﬁed and added to the -2log likelihood function (Gisleskog et al, JPP, 2002, p.<br>473-505). This serves as a constraint on THETA, OMEGA, and SIGMA estimates and<br>thus as a way for stable estimates of these parameters to be obtained with insufﬁcient<br>data. NWPRI may be called by PRIOR. (See <b>prior</b>). It computes a function based on a<br>frequency prior that has a multivariate normal form for THETA, and also, in the case of<br>population data, an inverse Wishart form for OMEGA (independent from the normal for<br>THETA). The parameters of these forms are called &quot;hyperparameters&quot;, and the modeler<br>ﬁxes these to values of his/her choice.<br>
Using NWPRI, several penalties functions, each with a different set of values for the<br>hyperparameters, may be used simultaneously. Each set of values may be thought to<br>arise from a different prior experiment (study). In actuality, there is a way to combine the<br>several penalties functions into one (see above reference), and this is what NWPRI com-<br>putes.<br>
When NWPRI is used during a Simulation Step, it produces a random value of THETA<br>and a random value of OMEGA from the frequency prior. (See <b>Simulation example</b>).<br>(See <b>nwpri example</b>).<br>If NWPRI is used at ICALL=2, it need not be used at ICALL=4, and vice-versa.<br>
NWPRI should always be called at ICALL=0 or ICALL=1.<br>
Use only NWPRI for the new $ESTIMATION methods of NONMEM 7.<br>
Arguments<br>
Input arguments:<br>
NTHETA,NETA,NEPS<br>
NTHETA=number of Thetas to be estimated<br>NETA=number of Etas to be estimated<br>NEPS=number of epsilons to be estimated<br>These are The dimensions of the THETA, OMEGA, and SIGMA arrays of the<br>parameters that enter into the model for the data.<br>
Before NONMEM 7.3, NEPS was ignored. With odd-type population data or with<br>non-odd-type single-subject data, where OMEGA takes the place of SIGMA, the<br>input argument NETA must be set.<br>
495<br>
<hr>
<A name=501></a>NWPRI DETAILED DESCRIPTIONS<br>
Help Guide<br>
NTHP,NETP,NEPP<br>
NTHP=number of thetas which have a prior<br>NETP=number of Omegas with prior<br>NEPP=Number of Sigmas with prior<br>
The prior will only affect the initial subvector of THETA of dimension NTHP and<br>the initial submatrix of OMEGA of dimension NETP (i.e. the submatrix consisting<br>of the intersection of the ﬁrst NETP rows and the ﬁrst NETP columns of OMEGA).<br>The initial subvector and submatrix are called the prior-affected parts of THETA and<br>OMEGA. If NTHP=0 (NETP=0), the prior does not affect THETA (OMEGA) at<br>all. During the Simulation Step, simulated values for the affected parts of THETA<br>and OMEGA are obtained according to the prior distribution, and &quot;the simulated val-<br>ues&quot; for the unaffected parts of THETA and OMEGA are simply taken to be the val-<br>ues given in the NONMEM control stream or input Model Speciﬁcation record.<br>Before NONMEM 7.3, NEPP was ignored.<br>
NPEXP<br>
The number of prior experiments.<br>
ITYP<br>
Relevant only if NWPRI is called during a Simulation Step. Values are<br>
0: The value of the THETA vector is obtained from simple random sampling.<br>
1: Within the given problem, NWPRI is to be called a speciﬁed number (NSAM) of<br>times to obtain this number of different values of the THETA vector. These values<br>are obtained by generating a Latin sample of size NSAM from equiprobable parti-<br>tions of an ellipsoid in THETA space (hyper-ellipsoidal sampling), followed by sam-<br>pling a point &quot;uniformly&quot; from each partition. This scheme may be used, for exam-<br>ple, when the problem has NSAM subproblems, in which case, NWPRI would be<br>called NSAM times, once each time during the problem when ICALL=4, and at<br>each of these calls, a different random value of THETA will be produced.<br>
2: Just as with value 1, but the NSAM values are obtained by generating a Latin<br>sample of size NSAM from equiprobable partitions of an ellipsoid in THETA space<br>(hyper-ellipsoidal sampling), followed by taking the &quot;center point&quot; of each partition.<br>
In all three cases, each new value of the OMEGA matrix is obtained from simple<br>random sampling.<br>
After each call to NWPRI, the simulated values for THETA, OMEGA and SIGMA<br>may be found in global variables and thus they are communicated directly to NON-<br>MEM. (See <b>PRIOR_Simulation:_Parameters</b>).<br>
PLEV<br>
When NWPRI is being used at ICALL=0 or 1, but NWPRI will not be used at<br>ICALL=4 (i.e. during the Simulation Step), PLEV can be set to 0. When it is being<br>used at ICALL=2, PLEV can also be set to 0. When NWPRI is being used at<br>ICALL=0 or 1 and it will be used at ICALL=4, or when it is being used at<br>ICALL=4, then PLEV must be set to a fraction strictly less than 1, e.g. 0.999. PLEV<br>is double precision with NONMEM 7, and is single precision with NONMEM VI.<br>
A value of THETA will actually be obtained using a truncated multivariate normal<br>distribution, i.e. from an ellipsoidal region R1 over which only a fraction of mass of<br>
496<br>
<hr>
<A name=502></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NWPRI<br>
the normal occurs. This fraction is given by PLEV. The distribution is further trun-<br>cated to R2, the subregion of R1 lying within the rectangular boundaries deﬁned on<br>the $THETA record. Simple random sampling occurs in R2. Latin sampled parti-<br>tions are partitions of R1. However, when ITYP=1, if a uniformly sampled point<br>from a partition lies outside R2, it is replaced by a point obtained by simple random<br>sampling from R2. When ITYP=2, if the center point of a partition lies outside R2,<br>an abort occurs.<br>
NSAM<br>
Relevant only if NWPRI is called during a Simulation Step. Consider two cases. a)<br>Latin hyper-ellipsoid sampling is used with ITYP=1, and b) simple random sam-<br>pling along with the adjustment for small sample correlation effect is used (see next<br>input argument). In case a) NSAM should equal the exact total number of different<br>values of THETA that must eventually be produced over the entire NONMEM prob-<br>lem. In case b) NSAM should be no less than this number.<br>
ISS<br>
Relevant only if NWPRI is called during a Simulation Step. A THETA value is<br>obtained by transforming a value from the standard multivariate normal distribution<br>- called here &quot;the standard value&quot;. The correlation matrix of the standard normal is<br>the identity matrix. When NSAM is small, the estimated correlation matrix from the<br>sampled standard values might not be quite close to the identity matrix - this is here<br>called &quot;the small sample correlation effect&quot;.<br>
1: An adjustment is made for the small sample correlation effect, by ﬁrst transform-<br>ing the NSAM standard values <i>altogether </i>into new values which are very nearly<br>standard multivariate normal values and such that the sample correlation matrix of<br>these new values is exactly the identity matrix.<br>
0: No adjustment is made for the small sample correlation effect.<br>
Output argument:<br>
CNT<br>
Relevant only if NWPRI is called at ICALL=2. CNT is the penalty.<br>
Use of $PRIOR<br>
A $PRIOR record may be used instead of a user-written PRIOR subroutine, in which<br>case the input arguments listed above may be speciﬁed as options of $PRIOR, and the<br>value of CNT may be displayed in the NONMEM output. (See <b>$prior</b>).<br>
Use of $THETA, $OMEGA, $SIGMA records<br>
Specifying the multivariate normal form for THETA (NTHP&gt;0):<br>
After the usual set of $THETA records, add a second set of $THETA records giving the<br>mean of the multivariate normal. The values on these records must be ﬁxed. They<br>should number NTHP altogether.<br>
After the usual set of $OMEGA records, add a second set of $OMEGA records giving the<br>variance-covariance matrix of the multivariate normal. (If there are no etas in the model,<br>there will not be a usual set of $OMEGA records.) The values on these records must be<br>ﬁxed. They should number (NTHP+1)xNTHP/2 altogether, including implicit 0’s, which<br>may occur because the variance-covariance matrix of the normal may be block-diagonal.<br>If a (regular) theta is ﬁxed, the corresponding values of the mean and variance-covariance<br>matrix of the normal are ignored.<br>
497<br>
<hr>
<A name=503></a>NWPRI DETAILED DESCRIPTIONS<br>
Help Guide<br>
Specifying the inverse Wishart form for OMEGA (NETAP&gt;0; population data only):<br>
After the second set of $OMEGA records (or if NTHP=0, after the ﬁrst set of $OMEGA<br>records), add another set of $OMEGA records giving the mode of the inverse Wishart.<br>The values on these records must be ﬁxed. They should number (NETP+1)xNETP/2<br>altogether, including implicit 0’s, which may occur because the mode of the inverse<br>Wishart may be block-diagonal. If the prior-affected part of OMEGA is given as a block-<br>diagonal matrix, then the mode must conform to this structure. The SAME attribute can<br>be used.<br>
With each diagonal block of (the prior-affected part of) OMEGA, there corresponds a<br>number of &quot;degrees of freedom&quot; of the inverse Wishart. All blocks of a given block set<br>are constrained to be equal (by using the SAME attribute), and therefore, to each of these<br>blocks there corresponds the same number of degrees of freedom. After the second set of<br>$THETA records (or if NTHP=0, after the ﬁrst set of $THETA records), add another set<br>of $THETA records, giving for each block set in turn the number of degrees of freedom<br>for the blocks of the set. The values on these records must be ﬁxed. There should be as<br>many values as there are block sets with the prior-affected part of OMEGA.<br>
The inverse Wishart for a given block of OMEGA may be explicitly given as &quot;perfectly<br>ﬂat&quot; by specifying the number of degrees of freedom to be the negative of the dimension<br>of the block, minus 1. In this case the mode for the block may be simply taken to be the<br>0 matrix (or any positive deﬁnite matrix). If a block is ﬁxed, the corresponding values of<br>the mode and number of degrees of freedom are ignored.<br>
With NONMEM 7.3 and higher, you can use more informative record names that obviate<br>the need for speciﬁc ordering of the additional $THETA and $OMEGA records used by<br>NWPRI, and provide an alternative source for values of arguments NTHETA, NETA, et<br>al.<br>
$THETAP for theta priors<br>$THETAPV for variance-covariance matrix for theta’s<br>$OMEGAP for OMEGA prior<br>$OMEGAPD for degrees of freedom (or dispersion factor) for omega prior<br>$SIGMAP for SIGMA prior<br>$SIGMAPD for degrees of freedom (or dispersion factor) for sigma prior<br>
If the informative record names are used, the records may be in any order, and the options<br>of $PRIOR need not be speciﬁed. Note that the name of the record describes the kind of<br>information it gives, rather than the structure of the information. E.g., in the example<br>below, $THETAPV is used instead of an $OMEGA record and $OMEGAPV is used<br>instead of a $THETA record.<br>(See <b>$thetap</b>, <b>$omegap</b>, <b>$sigmap</b>)<br>
Examples<br>
Here are three examples of extra $THETA and $OMEGA records specifying prior infor-<br>mation from an experiment. This information concerns all the regular elements of<br>THETA and OMEGA. All examples are shown with a $PRIOR record although a<br>PRIOR subroutine could be used instead.<br>
$PRIOR NWPRI NTHETA=3 NETA=3 NTHP=3 NETP=3 NPEXP=1<br>
...<br>
$THETA 3 FIX .08 FIX .04 FIX<br>
$THETA 100 FIX<br>
$OMEGA BLOCK (3) .494 .00207 .0000847 .000692 .0000471 .0000292 FIX<br>
498<br>
<hr>
<A name=504></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
NWPRI<br>
$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08 FIX<br>
Perhaps it might be more perspicuous to organize the prior information thusly:<br>
$PRIOR NWPRI NTHETA=3 NETA=3 NTHP=3 NETP=3 NPEXP=1<br>
...<br>
;prior information for THETA<br>
$THETA 3 FIX .08 FIX .04 FIX<br>
$OMEGA BLOCK (3) .494 .00207 .0000847 .000692 .0000471 .0000292 FIX<br>
;prior information for OMEGA<br>
$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08 FIX<br>
$THETA 100 FIX<br>
With NONMEM 7.3 and higher, informative record names can be used:<br>
$PRIOR NWPRI<br>
...<br>
;prior information for THETA<br>
$THETAP 3 FIX .08 FIX .04 FIX<br>
$THETAPV BLOCK (3) .494 .00207 .0000847 .000692 .0000471 .0000292 FIX<br>
;prior information for OMEGA<br>
$OMEGAP BLOCK (3) .7 .04 .05 .02 .06 .08 FIX<br>
$OMEGAPD 100 FIX<br>
Multiple Experiments<br>
There may be prior information from a number of experiments, in which case the<br>$THETA and $OMEGA records specifying this information for each experiment may be<br>stacked, e.g.<br>
;usual records<br>
$THETA (0,4,10) (0,.09,.5) (.004,.01,.9)<br>
$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08<br>
;prior information from experiment 1<br>
$THETA 3 FIX .08 FIX .04 FIX<br>
$THETA 100 FIX<br>
$OMEGA BLOCK (3) .494 .00207 .0000847 .000692 .0000471 .0000292 FIX<br>
$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08 FIX<br>
;prior information from experiment 2<br>
$THETA 2 FIX .05 FIX .04 FIX<br>
$THETA 50 FIX<br>
$OMEGA BLOCK (3) .6 .003 .0001 .0004 .00001 .00003 FIX<br>
$OMEGA BLOCK (3) .9 .02 .05 .01 .06 .09 FIX<br>
Blocking on the variance-covariance matrix of the normal form for THETA need not be<br>the same across experiments.<br>
Limitation:<br>
There must be at least one THETA parameter and one OMEGA parameter in the model.<br>
499<br>
<hr>
<A name=505></a>NWPRI DETAILED DESCRIPTIONS<br>
Help Guide<br>
REFERENCES: None<br>
500<br>
<hr>
<A name=506></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
OBJ<br>
OBJ<br>
MEANING: OBJ subroutine<br>CONTEXT: NONMEM routine<br>
DISCUSSION:<br>OBJ is a NONMEM routine. It computes the objective function. Error messages from<br>OBJ may indicate some difﬁculty in this computation.<br>
REFERENCES: None.<br>
501<br>
<hr>
<A name=507></a>OBJECTIVE DETAILED DESCRIPTIONS<br>
Help Guide<br>
OBJECTIVE FUNCTION VALUE INDIVIDUAL<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_INT, ONLY: IIDX=&gt;IDVALX<br>
USE ROCM_REAL, ONLY: CNTID=&gt;OFV_IND<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: MAXIDS,DPSIZE<br>
INTEGER(KIND=ISIZE) :: IDVALX(MAXIDS)<br>
REAL(KIND=DPSIZE) :: OFV_IND(MAXIDS)<br>
DISCUSSION:<br>
Note: With NONMEM 7, the additional output ﬁle root.phi contains the same informa-<br>tion.<br>(See <b>additional_output_ﬁle</b>).<br>
These variables contain values of the ID data item and individual contributions to the<br>objective function. The values are in data-set order.<br>
IIDX<br>
Values of the ID data item.<br>
CNTID<br>
Values of the individual contribution to the objective function for the corresponding<br>values of IIDX.<br>
E.g., IIDX(n) is the ID data item for the nth. individual record, and CNTID(n) is the con-<br>tribution to the objective function for the nth. individual record.<br>
These values should only be displayed at ICALL = 3 (ﬁnalization block).<br>
With NONMEM VI 1.0, they can only be displayed using verbatim code.<br>With NONMEM VI 2.0 and later releases, they can be used on the right and displayed<br>using abbreviated code in $PRED, $PK, $ERROR and $INFN blocks (See <b>Individ-<br>ual objective function example</b>).<br>
(See <b>write</b>).<br>
They may also be displayed in a table, using<br>
$ABBR COMRES=2<br>
and code such as the following in the $ERROR or $PK block:<br>
IF (COMACT.EQ.1) THEN<br>
COM(1)=IIDX(NIREC)<br>
COM(2)=CNTID(NIREC)<br>
ENDIF<br>The following, for example, will produced a separate table for the values:<br>
$TABLE IID=COM(1) CNT=COM(2) FILE=comvals NOAPPEND NOPRINT FIRSTONLY<br>
Note: With earlier versions than NONMEM 7.3, verbatim code is needed:<br>&quot;<br>
COM(1)=IIDX(NIREC)<br>
&quot;<br>
COM(2)=CNTID(NIREC)<br>
Location prior to NONMEM 7: rocm50<br>
502<br>
<hr>
<A name=508></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
OBJECTIVE<br>
REFERENCES: None.<br>
503<br>
<hr>
<A name=509></a>OBJECTIVE DETAILED DESCRIPTIONS<br>
Help Guide<br>
OBJECTIVE FUNCTION VALUE<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: OBJECT<br>
GLOBAL DECLARATION<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: OBJECT<br>
DISCUSSION:<br>
OBJECT<br>
The ﬁnal value of the objective function.<br>
This value should only be used at ICALL = 3 (ﬁnalization block).<br>
May be used as a right-hand quantity in abbreviated code.<br>
Location prior to NONMEM 7: rocm8<br>
REFERENCES: None.<br>
504<br>
<hr>
<A name=510></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
OBSERVA TION<br>
OBSERVA TION RECORDS<br>
MEANING: Those data records containing observation information<br>CONTEXT: NONMEM input/output<br>
DISCUSSION:<br>A data record may contain an observation, in which case the missing dependent variable<br>(MDV) data item (which may be speciﬁed by the user, or created for him by NM-TRAN<br>when PREDPP is used) should be zero, and the dependent variable (DV) data item should<br>be the observation. If a data record does not contain an observation, the MDV data item<br>should be 1 or 101, and the DV data item may be any value. NONMEM counts observa-<br>tion records. It also must know in what position (column) of a data record the DV data<br>item appears. It reports its information about these things as a check to the user, as in this<br>example:<br>
DEP VARIABLE IS DATA ITEM NO.:<br>
4<br>
.<br>
.<br>
TOT. NO. OF OBS RECS:<br>
394<br>
(See <b>dv</b>, <b>mdv</b>).<br>
REFERENCES: Guide III, section V.3.2<br>REFERENCES: Guide IV, section II.C.4.1<br>REFERENCES: Guide V, section 6<br>REFERENCES: Guide VI, section II<br>
505<br>
<hr>
<A name=511></a>ORDER OPTION<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
ORDER OPTION<br>
MEANING: Instructions for the NONMEM Estimation Step<br>CONTEXT: NM-TRAN Control Record<br>
ORDER is an option of the $ESTIMATION record:<br>
ORDER=xxxf<br>
The values of x may be T (Theta), S (Sigma), and O (Order). The value of f may be<br>U (Upper) or L (Lower). Affects the way theta, omega, and sigma are displayed in<br>the raw and additional output ﬁles. xxx gives the overall order, and f gives the order<br>within OMEGA and SIGMA. Affects the raw output ﬁle and all additional output<br>ﬁles. The default is TSOL: THETA, SIGMA, OMEGA in Lower triangular form.<br>Does not affect the NONMEM report ﬁle.<br>
DISCUSION:<br>
On the $OMEGA record, elements of Omega are given in lower triangular order, e.g.,<br>$OMEGA BLOCK(3) OM11 OM21 OM22 OM31 O32 OM33<br>
This can also be coded as<br>$OMEGA BLOCK(3)<br>
OM11<br>
OM21 OM22<br>
OM31 O32 OM33<br>
The NONMEM report ﬁle is not consistent. The initial and ﬁnal parameter estimates are<br>printed in Lower triangular order, e.g.,<br>INITIAL ESTIMATE OF OMEGA:<br>
OM11<br>
OM21 OM22<br>
OM31 OM32 OM33<br>
However, in the intermediate printout of the Estimation step, OMEGA and SIGMA are in<br>Upper triangular order. This was not evident with previous version of NONMEM,<br>because the PARAMTER values corresponding to OMEGA and SIGMA are displayed as<br>unconstrained parameters (UCP), and these are not in a 1-1 mapping with the elements of<br>OMEGA and SIGMA. But with NONMEM 7.2 and higher, the intermediate output of<br>the Estimation step includes a line NPARAMETR, in which OMEGA and SIGMA are<br>converted to their &quot;natural&quot; space. E.g.,<br>OM11 OM12 OM13 OM22 OM23 OM33<br>Because OMEGA is symmetric, this is the same as<br>OM11 OM21 OM31 OM22 OM32 OM33<br>
In the NONMEM report, upper triangular form is used for all of the &quot;COVARIANCE<br>MATRIX OF THE ESTIMATE&quot;, &quot;CORRELATION MATRIX OF ESTIMATE&quot; and the<br>&quot;INVERSE COVARIANCE MATRIX OF ESTIMATE&quot;. E.g.,<br>OM11 OM12 OM13 OM22 OM23 OM33<br>
This is TOSU order.<br>
Case 1. ORDER is not used (Default)<br>
The raw output ﬁle .ext and additional output ﬁles .cov, etc, are in a different order:<br>TSOL. SIGMA precedes OMEGA. The order within OMEGA is lower triangular,<br>consistent with the Initial and ﬁnal estimates of OMEGA, but different than the<br>intermediate output in the NONMEM report. The order of the last line of the<br>
506<br>
<hr>
<A name=512></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
ORDER OPTION<br>
&quot;COVARIANCE MATRIX OF ESTIMATE&quot; in the NONMEM report differs from<br>the order of the lines of the .cov ﬁle, and similarly for .cor and .coi.<br>
Case 2. ORDER=TOSU<br>
Each line of the raw output ﬁle .ext is in the same order as in the intermediate output<br>portion of the NONMEM report. Also, each line of the .cov ﬁle is in the same order<br>as the last line of the &quot;COVARIANCE MATRIX OF ESTIMATE&quot; in the NONMEM<br>report, and similarly for .cor and .coi.<br>
Note that the ORDER option does not affect the NONMEM report ﬁle, only the raw and<br>additional output ﬁles. The SIGMA matrix always printed in the same order as OMEGA,<br>and the ORDER option applies to it as well.<br>
REFERENCES: Guide Introduction_7<br>
507<br>
<hr>
<A name=513></a>OUTPUT DETAILED DESCRIPTIONS<br>
Help Guide<br>
OUTPUT FRACTION PARAMETER<br>
MEANING: Output fraction (F0) parameter for PREDPP<br>CONTEXT: Additional PK Parameters<br>
USAGE:<br>$PK<br>
F0= ....<br>
DISCUSSION:<br>
The output fraction parameter is used with PREDPP. It is an optional additional PK<br>parameter. With NM-TRAN, it are symbolized in the $PK block by any one of the<br>reserved variables FO, F0, or Fn, where n is the compartment number of the output com-<br>partment.<br>
With any of the kinetic models a (peripheral) output compartment is always present.<br>Associated with this compartment is a PK parameter, the output fraction , denoted here<br>by <i>Fo</i>. Of the entire amount, <i>Ao</i>, of drug introduced into the system by various dosage<br>patterns and then eliminated from the system during a given time interval, a fraction <i>Fo<br></i>of <i>Ao </i>goes into this output compartment.<br>If the output compartment is never turned on, the output fraction can be ignored. If the<br>value of the output fraction is not computed in PK, it is always understood to be 1<br>
The use of <i>Fo </i>depends on the assumption that the rate of change of drug amount in the<br>output compartment is linear in the other compartment amounts. Other than this linearity<br>restriction, the system can be nonlinear.<br>
Tyically, the output compartment is used for urine observations, and the central for<br>plasma observations, with any ADVAN.<br>
(See <b>cmt</b>, <b>pk</b>, <b>$pk</b>, <b>default_compartment</b>).<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide V, section 6.9<br>REFERENCES: Guide V, section 7.4.1<br>REFERENCES: Guide V, section 7.4.5<br>REFERENCES: Guide V, section 7.4.3.3<br>REFERENCES: Guide VI, section III.F.7<br>
508<br>
<hr>
<A name=514></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PARALLEL<br>
PARALLEL COMPUTING<br>
MEANING: The parallel computing feature of NONMEM<br>
Parallel computing is described in the INTRODUCTION TO NONMEM 7.<br>
(See <b>nmfe</b>).<br>
REFERENCES: Guide Introduction_7<br>
509<br>
<hr>
<A name=515></a>PARAMETER DETAILED DESCRIPTIONS<br>
Help Guide<br>
PARAMETER DIMENSIONS<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE NMPRD_INT, ONLY: NTHES_=&gt;NWTHT,NETAS_=&gt;NWETA, NEPSS_=&gt;NWEPS<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: NWTHT,NWETA,NWEPS<br>
DISCUSSION:<br>
NTHES_<br>
The dimension of theta. If the dimension is 0, NTHES_=1.<br>
NETAS_<br>
The dimension of omega. If the dimension is 0, NETAS_=1.<br>
NEPSS_<br>
The dimension of sigma. If the dimension is 0, NEPSS_=1.<br>
Location prior to NONMEM 7: rocm35<br>
REFERENCES: None.<br>
510<br>
<hr>
<A name=516></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PARAMETER<br>
PARAMETER VALUES: INITIAL AND FINAL<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: THETAF,OMEGAF,SIGMA,THETAFR<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LTH,LVR ,DPSIZE<br>
REAL(KIND=DPSIZE) :: THETAF(LTH),OMEGAF(LVR,LVR), &amp;<br>
SIGMAF(LVR,LVR),THETAFR(LTH)<br>
DISCUSSION:<br>
THETAF<br>
THETAF(i) = zero, initial, or ﬁnal value of theta(i), according to the current value of<br>ICALL.<br>
THETAFR<br>
THETAFR(i) = zero, initial, or ﬁnal value of reported thetar(i), according to the cur-<br>rent value of ICALL. If record $THETAR is not used, THETAF and THETAFR are<br>equal. If record $THETAR is used, then THETAF is the internal theta as used in<br>$PK/$PRED, and THETAFR is the theta reported in the report ﬁle.<br>
OMEGAF<br>
OMEGAF(i,j) = zero, initial, or ﬁnal value of omega(i,j), according to the current<br>value of ICALL.<br>
SIGMAF<br>
SIGMAF(i,j) = zero, initial, or ﬁnal value of sigmaf(i,j), according to the current<br>value of ICALL.<br>
At ICALL = 0, these are zero values.<br>
At ICALL = 1, these are initial values.<br>
If NONMEM will be computing the initial value of theta(i), at ICALL=1 the initial value<br>THETAF(i) is set to some point between the lower and upper bounds.<br>If NONMEM will be computing the initial value of a diagonal block of OMEGA<br>(SIGMA), at ICALL=1 the initial value of the block is set to the identity matrix.<br>
At ICALL = 3, these are ﬁnal values.<br>
At ICALL = 2, the values of these variables should not be used unless the value of<br>COMACT is 1 or 2, in which case these are ﬁnal values.<br>(See <b>COMACT,COMSAV</b>)<br>
Location prior to NONMEM 7: rocm6<br>
REFERENCES: None.<br>
511<br>
<hr>
<A name=517></a>PARAMETERS DETAILED DESCRIPTIONS<br>
Help Guide<br>
PARAMETERS OMEGA SIGMA: CURRENT<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: OMEGA=&gt;VARNF<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: VARNF(LVR,LVR)<br>
DISCUSSION:<br>
OMEGA<br>
The current value of OMEGA being used.<br>
The current value of SIGMA is also located in this array as follows:<br>
SIGMA(I,J)=OMEGA(NETAS_+I,NETAS_+J)<br>
NETAS_ is described in Parameter dimensions.<br>
(See <b>Parameter dimensions</b>).<br>
At run and problem initialization and at problem ﬁnalization use the variables OMEGAF<br>and SIGMAF.<br>(See <b>Parameter values: Initial and Final</b>).<br>
Should not be used if an initial estimate is being computed.<br>
When an initial estimate is being computed, the value is just that found<br>
at problem initialization (when ICALL=1).<br>
EXAMPLE:<br>
Compute individual weighted residuals using a slope-intercept residual error model:<br>
$ERROR<br>
Y=F+EPS(1)+F*EPS(2)<br>
IF (COMACT.GE.1) THEN<br>
STD=SQRT(SIGMA(1)+F**2*SIGMA(2))<br>
IWRES=(DV-F)/STD<br>
ENDIF<br>
Location prior to NONMEM 7: rocm22<br>
REFERENCES: None.<br>
512<br>
<hr>
<A name=518></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PARTIAL<br>
PARTIAL DERIVATIVE INDICATORS<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY: MFIRST=&gt;IFRSTDER,MSEC=&gt;ISECDER,IFIRSTEM<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IFRSTDER,ISECDER,IFIRSTEM<br>
DISCUSSION:<br>
MSEC<br>
MSEC=1 when NONMEM is expecting second-partial eta-derivatives with the cur-<br>rent call to PRED.<br>MSEC=0 when NONMEM is ignoring second-partial eta-derivatives with the cur-<br>rent call to PRED.<br>
Second-partial eta-derivatives are never expected unless the Laplacian method is<br>used.<br>
MFIRST<br>
MFIRST=1 when NONMEM is expecting ﬁrst-partial eta-derivatives with the cur-<br>rent call to PRED.<br>MFIRST=0 when NONMEM is ignoring ﬁrst-partial eta-derivatives with the current<br>call to PRED. This variable is used only by PREDPP, not by generated FSUBS.<br>
Location of MFIRST and MSEC prior to NONMEM 7: rocm12<br>
IFIRSTEM<br>
With NONMEM 7.2 and higher, ﬁrst-partial eta-derivatives are computed by gener-<br>ated code in FSUBS for classical NONMEM methods, but not for IMP, SAEM, and<br>BAYES methods. This improves the speed at which the problem is evaluated. How-<br>ev er, on occasion such derivatives are needed, for example, when steady state values<br>are to be calculated, or when stochastic differential equations are to be evaluated. In<br>such cases, insert as the ﬁrst line in a each block of abbreviated code ($PK,<br>$ERROR, $DES, $AES, $PRED) the following line of code:<br>
FIRSTEM=1<br>
First derivatives will be evaluated for the new methods as well.<br>
Note that FIRSTEM is a local variable. In FSUBS, FIRSTEM is copied from<br>IFIRSTEM in MODULE NMPRD_INT prior to being used:<br>
FIRSTEM=IFIRSTEM<br>
...<br>
IF (FIRSTEM == 1) THEN<br>
block of first derivative code<br>
ENDIF<br>
The statement FIRSTEM=1 is inserted in generated code prior to the ﬁrst test of<br>FIRSTEM. Thus, the local variable FIRSTEM is changed by the user, not the global<br>variable IFIRSTEM.<br>
In order to implement this feature, NM-TRAN rearranges the order of statements in<br>FSUBS. Statements that compute ﬁrst-partial eta-derivatives are collected together<br>into blocks of ﬁrst derivative code to be executed only with FIRSTEM is 1. Option<br>NOFASTDER of the $ABBREVIATED record prevents NM-TRAN from doing this<br>
513<br>
<hr>
<A name=519></a>PARTIAL DETAILED DESCRIPTIONS<br>
Help Guide<br>
and restores the order of statements in FSUBS to what it was in previous versions.<br>(See <b>Abbreviated</b>)<br>
REFERENCES: Guide VI, section III.E.4 , IV.B.2<br>
514<br>
<hr>
<A name=520></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PASS<br>
PASS NEW L2 RECORD: NEWL2<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE NMPRD_INT, ONLY: NEWL2<br>
GLOBAL DECLARATION: INTEGER(KIND=ISIZE) :: NEWL2<br>
DISCUSSION:<br>
NEWL2<br>
NEWL2 = 1 if the data record is the ﬁrst of an L2 record.<br>NEWL2 = 2 otherwise.<br>
If there is no L2 data item, each data record is a different L2 record.<br>
NEWL2 also changes value in conjunction with calls to PASS.<br>
NEWL2 may be used as a right-hand quantity in $PRED and $ERROR blocks, and in an<br>$INFN block in conjunction with PASS.<br>
Location prior to NONMEM 7: rocm17<br>
REFERENCES: None.<br>
515<br>
<hr>
<A name=521></a>PASS DETAILED DESCRIPTIONS<br>
Help Guide<br>
PASS NEWIND: NWIND<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE NMPRD_INT, ONLY: NWIND<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: NWIND<br>
DISCUSSION:<br>
NWIND<br>
The NEWIND value at ICALL 0, 1 and 3. NWIND changes value in conjunction<br>with calls to PASS. (See <b>pred</b>, <b>newind</b>).<br>
Location prior to NONMEM 7: rocm34<br>
REFERENCES: Guide I, section C.3.5.2<br>
516<br>
<hr>
<A name=522></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PASS<br>
PASS<br>
MEANING: PASS subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: ISIZE<br>
INTEGER(KIND=ISIZE) :: MODE<br>
CALL PASS (MODE)<br>
DISCUSSION:<br>The NONMEM utility routine PASS can be used to read and/or to modify (&quot;transgener-<br>ate&quot;) data records. This can be done at both the beginning and ending of a problem.<br>
When ICALL=0, 1, or 3, PASS may be called by PRED, or by a subroutine of PRED<br>(such as PREDPP’s INFN), or PASS may be called from $PRED or $INFN abbreviated<br>code. With abbreviated code, the variable MODE should be used as the argument to<br>PASS and set as described below.<br>
Input argument:<br>
MODE<br>
MODE=0: Initialize PASS<br>
MODE=1: store next data record in DATREC (and in PASSRC of module<br>NMPRD9); any modiﬁcations of this record performed by PRED are ignored by<br>NONMEM.<br>
MODE=2: store next data record in DATREC (and in PASSRC of module<br>NMPRD9); any modiﬁcations of this record performed by PRED are placed into<br>NONMEM’s internal data set.<br>
MODE=3: terminate PASS (can be used only after MODE=1)<br>
Output argument:<br>
MODE<br>
Upon return from a call to PASS with MODE=1 or 2, PASS sets MODE=0 when<br>there are no more data records to be passed.<br>
The ﬁrst call to PASS with MODE=1 or 2 produces the ﬁrst data record, the second call<br>produces the second data record, etc. A value of NEWIND appropriate for the data<br>record currently in DATREC and PASSRC is also stored by PASS in NWIND of module<br>NMPRD_INT.<br>
The NONMEM utility routine GETETA can be used to obtain subject-speciﬁc estimates<br>of the eta’s. The values returned for the eta’s with each call to GETETA are appropriate<br>for the individual whose data record is currently in DATREC. When PASS is used in<br>abbreviated code, GETETA is used automatically. Any PRED-deﬁned items that are dis-<br>played are available in module NMPRD4 with each data record.<br>
The value of MIXEST is appropriate for the individual whose data record is currently in<br>DATREC.<br>
Since the call with ICALL=3 actually occurs before the Table and Scatterplot Steps, new<br>data items can be tabled and scatterplotted.<br>
The user should not use PASS to modify either the ID or MDV data items.<br>
517<br>
<hr>
<A name=523></a>PASS DETAILED DESCRIPTIONS<br>
Help Guide<br>
Within an initialization or ﬁnalization block, code to test MODE and call PASS is gener-<br>ated by NM-TRAN when abbreviated code such as the following is present:<br>
IF (ICALL.EQ.0) THEN<br>
DO WHILE (DATA)<br>
... transgeneration statements ...<br>
ENDDO<br>
RETURN<br>
ENDIF<br>
(See <b>Infn_pass_interpolation_example</b>, <b>Infn_example</b>).<br>(See <b>Initialization-Finalization block</b>).<br>
REFERENCES: Guide II, section D.2.2<br>REFERENCES: Guide VI, section VI.A , Figure 37<br>
518<br>
<hr>
<A name=524></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PASS:<br>
PASS: PASSRC<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_REAL, ONLY: PASSRC<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: VSIZE,DPSIZE<br>
REAL(KIND=DPSIZE) :: PASSRC(VSIZE)<br>
DISCUSSION:<br>
PASSRC<br>
PASSRC contains the data record at ICALL values 0, 1 and 3. PASSRC changes in<br>conjunction with calls to PASS, at which time transgeneration is permitted.<br>
Location prior to NONMEM 7: nmprd9<br>
REFERENCES: None.<br>
519<br>
<hr>
<A name=525></a>PHI DETAILED DESCRIPTIONS<br>
Help Guide<br>
PHI<br>
MEANING: PHI function<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: PHI,X,CUMDIS<br>
CUMDIS= PHI(X)<br>
DISCUSSION:<br>Gives the value of the cumulative distribution function.<br>
Input argument:<br>
X<br>
EXAMPLE OF USAGE:<br>
PHI may be used in abbreviated code.<br>
A=THETA(1)*EXP(ETA(1))<br>B=PHI(A)<br>
The argument may be a random variable, but no eta partial derivatives are computed.<br>
REFERENCES: None.<br>
520<br>
<hr>
<A name=526></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PK<br>
PK<br>
MEANING: PK subroutine<br>CONTEXT: User-supplied subroutine; for use with PREDPP<br>
USAGE:<br>
Versions before NONMEM 7.2:<br>
SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE,LVR<br>
REAL(KIND=DPSIZE) :: EVTREC<br>INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS<br>DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*)<br>DIMENSION :: GG(IRGG,LVR+1,*)<br>
With NONMEM 7.2 and higer:<br>
SUBROUTINE PK(ICALL,IDEF,THETA,IREV,EVTREC,NVNT,INDXS,IRGG,GG,NETAS)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
USE PRDIMS,<br>
ONLY: GPKD<br>
IMPLICIT REAL(KIND=DPSIZE) (A-Z)<br>REAL(KIND=DPSIZE) :: EVTREC<br>INTEGER(KIND=ISIZE) :: ICALL,IDEF,IREV,NVNT,INDXS,IRGG,NETAS<br>DIMENSION :: IDEF(7,*),THETA(*),EVTREC(IREV,*),INDXS(*)<br>DIMENSION :: GG(IRGG,GPKD+1,*)<br>
DISCUSSION:<br>The PK subroutine is called by PREDPP to obtain values for basic and additional phar-<br>macokinetic parameters. Basic PK parameters are typically the rate constants (&quot;micro-<br>constants&quot;) for use in kinetic formulas. PK can compute instead parameters such as<br>clearance and volume, and a translator (&quot;TRANS&quot;) subroutine can be used to convert<br>these to rate constants. Additional PK parameters include compartment scale parameters,<br>which PREDPP uses to convert compartment amounts to concentrations, and dose-related<br>parameters such as modeled infusion rates.<br>
Input argument:<br>
ICALL<br>
ICALL=1: PK has been called for initialization at the beginning of a NONMEM<br>problem; one such call per problem. EVTREC contains the ﬁrst event record.<br>THETA contains the initial estimates. PK must return values in IDEF, which inform<br>PREDPP what tasks it will perform at later calls. It may also set GG (k,1,1) to 1,<br>indicating that the kth PK parameter will be modeled as a log (a feature which can-<br>not be speciﬁed using abbreviated code).<br>
ICALL=2: PK has been called to obtain parameter values; multiple calls occur. PK<br>should call GETETA to obtain ETA values for the individual. PK should compute all<br>relevant portions of GG.<br>
ICALL=4: PK has been called during the Simulation Step; multiple calls occur. PK<br>should call SIMETA to obtain simulated ETA values for the individual. PK should<br>compute individual-speciﬁc parameters for column 1 of GG.<br>
ICALL=5: PK has been called during the computation of expectations; multiple<br>calls occur. Such calls occur when the marginal (MRG_) data item is deﬁned in the<br>data set and has non-zero values for some records. If the MRG_ data item has the<br>value 1 or 2, the values of PK-deﬁned items contribute to the expectations computed<br>for these items.<br>
521<br>
<hr>
<A name=527></a>PK DETAILED DESCRIPTIONS<br>
Help Guide<br>
ICALL=6: PK has been called during the computation of raw data averages; Such<br>calls occur when the raw-data data item (RAW_) is deﬁned in the data set and has<br>non-zero values for some records.<br>
THETA<br>
The NONMEM THETA vector.<br>
EVTREC<br>
The PREDPP event record.<br>
INDXS<br>
The values speciﬁed in the $INDEX record of the NM-TRAN control stream. (This<br>is the NONMEM Index array starting at position 12, the ﬁrst position beyond those<br>positions used by PREDPP itself).<br>
NETAS<br>
The number of population etas in the problem.<br>
Output argument:<br>
IDEF<br>
PK should store values in IDEF only when ICALL=1.<br>Values may be stored in the following elements:<br>IDEF(1,1)=-9 (required)<br>IDEF(1,2) is the call limiting element (compare $PK’s CALLFL).<br>Values are:<br>
-2: call with every event record and at additional and lagged dose times.<br>-1: call with every event record (default)<br>
0: call with ﬁrst event record and new TIME values<br>1: call once per individual record<br>
Compartment initialization may be performed by routine PK;<br>(See <b>Compartment Initialization: A_0</b>)<br>(See <b>sCompartment Initialization: A_0FLG</b>).<br>An initial steady state may be requested by routine PK;<br>(See <b>Initial Steady State: I_SS,ISSMOD</b>)<br>(See <b>i_ss</b>, <b>initial_condition</b>).<br>The value in IDEF(1,3) describes whether PK performs compartment initializa-<br>tion, i.e., whether or not PK initializes elements of the initial state vector A_0(n).<br>Values are:<br>
-1: PK may initialize A_0.<br>
0: PK does not initialize A_0.<br>1: PK does initialize A_0.<br>
The default used by PREDPP is IDEF(1,3)=-1. However, when compartment initial-<br>ization is not implemented, then if IDEF(1,3) is set to 0, PREDPP can avoid some<br>time-consuming processing. Indeed, when $PK abbreviated or verbatim code is sup-<br>plied, and there is no reference to compartment initialization amounts A_0(n) in<br>either the abbreviated or verbatim code, then NM-TRAN sets IDEF(1,3)=0.<br>
Compartment amounts may be used by routine PK;<br>(See <b>State Vector: A</b>).<br>The value in IDEF(1,4) describes whether PK uses derivatives of compartment<br>amounts (e.g. compartment amounts themselves are used as random variables in<br>arithmetic statements in PK). Values are:<br>
-1: PK may use derivatives of compartment amounts.<br>
0: PK does not use derivatives of compartment amounts.<br>
522<br>
<hr>
<A name=528></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PK<br>
1: PK uses derivatives of compartment amounts.<br>
The default used by PREDPP is IDEF(1,4)=-1. However, when derivatives of com-<br>partment amounts are not used, then if IDEF(1,4) is set to 0, PREDPP can avoid<br>some time-consuming processing. Indeed, when $PK abbreviated or verbatim code<br>is supplied, and there is no reference to A(n) (as a random variable in an arithmetic<br>statement) in the abbreviated code (or to derivatives of A(n) in the verbatim code),<br>then NM-TRAN sets IDEF(1,4)=0.<br>
Remaining elements contain row numbers in GG:<br>IDEF(2,1): row number of F0 (output fraction)<br>IDEF(2,2): row number of XSCALE (Time Scale)<br>IDEF(2,3): row number of lowest-numbered MTIME<br>IDEF(2,4): row number of highest-numbered MTIME<br>IDEF(3,n): row number of Sn (Scale for comp. n) (thru n+1 output)<br>IDEF(4,n): row number of Fn (bioavailability fraction for comp. n)<br>IDEF(5,n): row number of Rn (modeled rate for comp. n)<br>IDEF(6,n): row number of Dn (modeled duration for comp. n)<br>IDEF(7,n): row number of ALAGn (absorption lag for comp. n)<br>
GG The array of PK parameters and their eta derivatives. The maximum number of<br>
rows in GG is given by IRGG, which is the same as constant PG found in ﬁle SIZES<br>(See <b>sizes</b>).<br>At ICALL = 2:<br>GG(k,1,1) contains the value of the kth parameter.<br>GG(k,i+1,1) contains its derivative with respect to the ith eta.<br>GG(k,i+1,j+1) contains its second derivative with respect to the ith eta and the<br>jth eta (lower-triangular; j=1, ..., i). (Second derivatives are only needed with esti-<br>mation by the Laplacian method.)<br>At ICALL = 4:<br>GG(k,1,1) contains the individual-speciﬁc value of the kth parameter. Other col-<br>umns of GG need not be computed.<br>
Also see variables in NONMEM modules, NONMEM-PRED modules, and PREDPP<br>modules.<br>(See <b>variables in modules</b>)<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide V, section 7<br>REFERENCES: Guide VI, section III<br>
523<br>
<hr>
<A name=529></a>POPULATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
POPULATION SINGLE-SUBJECT INDICATOR<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE NMPRD_INT, ONLY: IPS<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IPS<br>
DISCUSSION:<br>
IPS<br>
IPS = 1 when the data are population data.<br>IPS = 2 when the data are single-subject data.<br>
Location prior to NONMEM 7: rocm29<br>
REFERENCES: Guide I, section B.1<br>REFERENCES: Guide IV, section II.C.4<br>
524<br>
<hr>
<A name=530></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PRED<br>
PRED ERROR MESSAGE<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_CHAR, ONLY :: ETEXT<br>
GLOBAL DECLARATION:<br>CHARACTER(LEN=132) :: ETEXT(3)<br>
DISCUSSION:<br>
ETEXT<br>
The user message which appears as part of the PRED error message. When PRED<br>returns to NONMEM with IERPRD&gt;0, PRED may store here one to three lines of<br>text explaining the error, for printing. The number of lines of text to be printed must<br>be stored in NETEXT. (See <b>PRED Exit Code</b>)<br>
When abbreviated code is used, the EXIT statement causes appropriate text to be stored<br>in ETEXT.<br>
Location prior to NONMEM 7: nmprd2<br>
REFERENCES: Guide VI, section III.K.2 , IV.F<br>
REFERENCES: Guide IV, section IV.G<br>
525<br>
<hr>
<A name=531></a>PRED DETAILED DESCRIPTIONS<br>
Help Guide<br>
PRED EXIT CODE<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY: IERPRD,NETEXT<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IERPRD,NETEXT<br>
DISCUSSION:<br>
Values are stored by PRED for use with NONMEM.<br>
IERPRD<br>
The PRED error return code; also called the PRED exit code. Is set to 0 before<br>PRED is called.<br>IERPRD=0: Normal return<br>IERPRD=1: PRED is unable to compute. If possible, NONMEM should attempt<br>recovery.<br>IERPRD=2: PRED is unable to compute. NONMEM should abort the run.<br>
NETEXT<br>
NETEXT=0 to 3: the number of lines of text of an error message stored by PRED in<br>ETEXT. (See <b>PRED Error Message</b>).<br>
When abbreviated code is used, the EXIT statement causes appropriate values to be<br>stored in NMPRD1.<br>
Location prior to NONMEM 7: nmprd1<br>
REFERENCES: Guide VI, section III.K.2 , IV.F<br>REFERENCES: Guide IV, section IV.G<br>
526<br>
<hr>
<A name=532></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PRED<br>
PRED<br>
MEANING: PRED subroutine<br>CONTEXT: User-supplied routine; required with NONMEM<br>
USAGE:<br>
Versions before NONMEM 7.2:<br>
SUBROUTINE PRED (ICALL,NEWIND,THETA,DATREC,INDXS,F,G,H)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE,LVR<br>
REAL(KIND=DPSIZE) :: DATREC<br>INTEGER(KIND=ISIZE) :: ICALL,NEWIND,INDXS<br>DIMENSION :: THETA(*),DATREC(*),INDXS(*),G(LVR,*),H(LVR,*)<br>
With NONMEM 7.2 and higher:<br>
SUBROUTINE PRED (ICALL,NEWIND,THETA,DATREC,INDXS,F,G,H)<br>USE SIZES, ONLY: DPSIZE,ISIZE<br>IMPLICIT REAL(KIND=DPSIZE) (A-Z)<br>REAL(KIND=DPSIZE) :: DATREC<br>INTEGER(KIND=ISIZE) :: ICALL,NEWIND,INDXS<br>REAL(KIND=DPSIZE) :: G(GPRD,*),H(HPRD,*)<br>DIMENSION :: THETA(*),DATREC(*),INDXS(*)<br>
DISCUSSION:<br>The PRED subroutine is called by NONMEM to obtain modeled values. (PREDPP is a<br>PRED subroutine that is distributed with NONMEM.)<br>
Input argument:<br>
ICALL<br>
ICALL=0: PRED has been called for initialization purposes at the beginning of the<br>NONMEM run; one such call per run. DATREC contains the ﬁrst data record.<br>THETA contains the initial estimates. PRED need not compute F, G, or H.<br>
ICALL=1: PRED has been called for initialization purposes at the beginning of a<br>NONMEM problem; one such call per problem. Otherwise, identical to ICALL=0.<br>
ICALL=2: For the data record contained in DATREC, PRED has been called for the<br>purpose of computing F, the value of the prediction, and/or the values of other<br>PRED-deﬁned items, appropriate for the record. PRED should compute F, and also<br>G and H as appropriate. THETA contains the values to be used to compute F. With<br>conditional estimation, to obtain ETA values, PRED should call GETETA.<br>
ICALL=3: PRED has been called for ﬁnalization purposes at the end of a NON-<br>MEM problem; one such call per (sub)problem. DATEC contains the ﬁrst data<br>record. THETA contains the ﬁnal estimates. Otherwise, identical to ICALL=0.<br>
ICALL=4: For the data record contained in DATREC, PRED has been called during<br>the Simulation Step for the purpose of computing a value of the dependent variable<br>and, possibly, values of independent variables, appropriate for the record. PRED<br>should compute F (the value of the dependent variable). THETA contains the initial<br>estimates, which are the values to be used to compute F. PRED should call SIMETA<br>(and SIMEPS) to obtain simulated values of ETA (and EPS).<br>
ICALL=5: For the data record contained in DATREC, PRED has been called for the<br>purpose of computing the expectation of the PRED item and possibly, the expecta-<br>tions of other PRED-deﬁned items, appropriate for the record. Such a call occurs<br>
527<br>
<hr>
<A name=533></a>PRED DETAILED DESCRIPTIONS<br>
Help Guide<br>
when the marginal data item (MRG_) is deﬁned in the data set and has a non-zero<br>value for the data record in question. If the MRG_ data item on the record has the<br>value 1 or 2, the value returned by PRED in F contributes to the expectation of the<br>PRED item. Similarly, the values returned in other PRED-deﬁned items contribute<br>to expectations of these items. THETA contains the ﬁnal estimates. The expecta-<br>tions in question are over possible values of ETA, and to obtain ETA values, PRED<br>should call GETETA.<br>
ICALL=6: PRED has been called for the purpose of computing the raw data aver-<br>age of the DV data items and, possibly, the raw data averages of PRED-deﬁned<br>items. Such a call occurs when the raw-data data item (RAW_) is deﬁned in the data<br>set and has a non-zero value for a template data record (See <b>template</b>). The value of<br>the DV data item in the data record contained in DATREC will be included in the<br>raw data average of the DV data items. However, when the raw data average corre-<br>sponding to the label DV in a table or scatterplot is to be different from the raw data<br>av erage of the DV items themselves, PRED may recompute the value of DV. PRED<br>may return a value of 1 in F to omit the DV item in the data record from the average.<br>
NEWIND<br>
NEWIND=0: First record of the data set. THETA value may differ from value at last<br>call with this record.<br>NEWIND=1: First record of the data set, THETA value does not differ from value at<br>last call with this record, and PRED is nonrecursive (see <b>I_REC</b>), or,<br>First record of a subsequent individual record.<br>NEWIND=2: Subsequent data record of an individual record.<br>
THETA<br>
The NONMEM THETA vector.<br>
DATREC<br>
The current data record.<br>
INDXS<br>
The values speciﬁed in the $INDEX record of the NM-TRAN control stream.<br>
Output argument:<br>
F<br>
When ICALL=2, the prediction associated with the data record. With odd-type data,<br>the likelihood of the observation in the record, but if there is no observation, F is<br>ignored.<br>
When ICALL=4, the value of the simulated observation associated with the data<br>record. Alternatively, F can be ignored, and the DV item in the data record can be<br>directly set to the value of the simulated observation. With odd-type data, F is<br>ignored; PRED should directly set the DV item to the value of the simulated obser-<br>vation.<br>
G<br>
An array of derivatives of F   with respect to etas. Values should be set when<br>ICALL=2.<br>G(i,1) is the partial derivative of F with respect to eta(i).<br>When the data are population, G(i,j+1) is the second partial derivative of F with<br>respect to eta(i), eta(j) (lower-triangular; j=1,..., i).<br>Second derivatives are needed only when the Laplacian method is used to estimate<br>parameters.<br>
528<br>
<hr>
<A name=534></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PRED<br>
H<br>
An array of partial derivatives of F with respect to epsilons. When the data are pop-<br>ulation, values should be set when ICALL=2.<br>H(i,1) is the derivative of F with respect to eps(i).<br>H(i,j+1) is the partial derivative of H(i,1) with respect to eta(j)<br>These mixed second derivatives are needed only when the INTERACTION option<br>is used to estimate parameters. (See <b>$ESTIMATION</b>).<br>
Also see variables in NONMEM modules, NONMEM-PRED modules, and PREDPP<br>modules.<br>(See <b>variables in modules</b>)<br>
REFERENCES: Guide I, section C.2<br>REFERENCES: Guide IV, section III.B.8 , IV<br>REFERENCES: Guide V, section 12.3<br>
529<br>
<hr>
<A name=535></a>PRED,RES,WRES DETAILED DESCRIPTIONS<br>
Help Guide<br>
PRED,RES,WRES<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied PRED and INFN routines<br>
USAGE:<br>USE ROCM_REAL, ONLY:<br>
&amp;<br>
PRED_=&gt;APPND(001),RES_=&gt;APPND(002),WRES_=&gt;APPND(003) &amp;<br>
IWRS_=&gt;APPND(004),IPRD_=&gt;APPND(005),IRS_=&gt;APPND(006) &amp;<br>
NPRED_=&gt;APPND(007),NRES_=&gt;APPND(008),NWRES_=&gt;APPND(009) &amp;<br>
NIWRES_=&gt;APPND(010),NIPRED_=&gt;APPND(011),NIRES_=&gt;APPND(012) &amp;<br>
CPRED_=&gt;APPND(013),CRES_=&gt;APPND(014),CWRES_=&gt;APPND(015) &amp;<br>
CIWRES_=&gt;APPND(016),CIPRED_=&gt;APPND(017),CIRES_=&gt;APPND(018) &amp;<br>
PREDI_=&gt;APPND(019),RESI_=&gt;APPND(020),WRESI_=&gt;APPND(021) &amp;<br>
IWRESI_=&gt;APPND(022),IPREDI_=&gt;APPND(023),IRESI_=&gt;APPND(024) &amp;<br>
CPREDI_=&gt;APPND(025),CRESI_=&gt;APPND(026),CWRESI_=&gt;APPND(027) &amp;<br>
CIWRESI_=&gt;APPND(028),CIPREDI_=&gt;APPND(029),CIRESI_=&gt;APPND(030) &amp;<br>
EPRED_=&gt;APPND(031),ERES_=&gt;APPND(032),EWRES_=&gt;APPND(033) &amp;<br>
EIWRES_=&gt;APPND(034),EIPRED_=&gt;APPND(035),EIRES_=&gt;APPND(036) &amp;<br>
NPDE_=&gt;APPND(037),ECWRES_=&gt;APPND(038),NPD_=&gt;APPND(039) &amp;<br>
OBJI_=&gt;APPND(040)<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: APPND(MAXXNAME)<br>
DISCUSSION:<br>
The PRED_,RES_,WRES_ items are the same as PRED, RES and WRES items.<br>
The CPRED_,CRES_,CWRES_ are calculated as if the estimation was performed using a<br>CONDITIONAL method without INTERACTION. (conditional, non-interactive in the<br>manner of Hooker et al.)<br>
The PREDI_,RESI_,WRESI_ are calculated as if the estimation was performed using the<br>FO method with INTERACTION (non-conditional, interactive).<br>
The CPREDI_,CRESI_,CWRESI_ are calculated as if the estimation was performed<br>using a CONDITIONAL method with INTERACTION (conditional, interactive)<br>
EPRED_,ERES_,EWRES_ are Monte-Carlo generated pred, res, and wres values, and are<br>not linearized approximations like the other weighted residual types.<br>
NPDE_ is the normalized prediction distribution error (takes into account within-subject<br>correlations)<br>
NPD_ is the correlated normalized prediction distribution error (does not take into<br>account within-subject correlations)<br>
EWRES_ and NPDE_ and NPD_ are evaluated using predicted function and residual<br>variances evaluated over a Monte Carlo sampled range of etas with population variance<br>Omega.<br>
ECWRES_ is evaluated with only the predicted function evaluated over a Monte Carlo<br>sampled range of etas with population variance Omega, while residual variance is always<br>evaluated at conditional mode or mean. Thus, ECWRES is the Monte Carlo version of<br>CWRES, while EWRES is the Monte Carlo version of CWRESI.<br>
530<br>
<hr>
<A name=536></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PRED,RES,WRES<br>
The EPRED_, ERES_, EWRES_, NPD_, NPDE_, ECWRES_ items are calculated by the<br>Table Step. When EPRED_, ERES_, EWRES_, NPD_, NPDE_, ECWRES_ items are<br>displayed, the options ESAMPLE and SEED of the $TABLE record are of interest.<br>(See <b>$table</b>).<br>
The PRED_,RES_,WRES_ (PRED,RES,WRES) items behave as they did with NON-<br>MEM VI. Consequently, if FO or a CONDITIONAL method without INTERACTION is<br>used, NPRED_,NRES_,NWRES_ and PRED_,RES_,WRES_ are equivalent. If FO or a<br>CONDITIONAL method with INTERACTION is used, IPRED_,IRES_,IWRES and<br>PRED_,RES_,WRES_ are equivalent.<br>
These items are available with passes through the data set during problem ﬁnalization<br>(i.e. ICALL=3), in a data record speciﬁc way.<br>
These items may be used as right-hand quantities in $PRED and $INFN during problem<br>ﬁnalization. They can also be output in table ﬁles by specifying their names (without the<br>underscore) on a $TABLE statement.<br>
(See <b>pred res</b>, <b>wres</b>).<br>
Location prior to NONMEM 7: rocm49<br>
For other variables, see the INTRODUCTION TO NONMEM 7.<br>
REFERENCES: Guide I, section C.3.5.3 , C.3.5.4<br>REFERENCES: Guide IV, section III.B.16 , III.B.17<br>REFERENCES: Guide V, section 9.5 , 10.7 , 11.4.4.2<br>REFERENCES: Guide Introduction_7<br>
531<br>
<hr>
<A name=537></a>PRED-DEFINED DETAILED DESCRIPTIONS<br>
Help Guide<br>
PRED-DEFINED VARIABLES<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE NMPRD4, ONLY: COM=&gt;VRBL<br>
GLOBAL DECLARATION:<br>MODULE NMPRD4<br>
USE SIZES, ONLY: DPSIZE<br>
IMPLICIT NONE<br>
SAVE<br>
REAL(KIND=DPSIZE), ALLOCATABLE, TARGET :: VRBL(:)<br>
END MODULE<br>
DISCUSSION:<br>
NMPRD4 is a module for PRED-deﬁned variables (including PK-deﬁned and ERROR-<br>deﬁned variables). It contains an array VRBL. (COM is suggested above as an alternate<br>to the name VRBL to be consistent with generated code, but this is optional.) The VRBL<br>array is allocated dynamically by NONMEM. The default size is given by constant<br>LNP4 in resource/sizes.f90, but this can be changed using the $SIZES record.<br>
Variables are stored in NMPRD4 for communication with other blocks of abbreviated<br>code or with user-written codes, or so that NONMEM has access to these variables for<br>display in tables or scatterplots. (See <b>$table, $scatter</b>). Values are stored by PRED and<br>by subroutines of PREDPP. A SAVE region of NMPRD4 may be designated;<br>(See <b>COMACT,COMSAV</b>).<br>
When abbreviated code is used, by default NM-TRAN lists all PRED-deﬁned variables in<br>the module, as well as certain NM-TRAN-deﬁned variables which give the values of par-<br>tial derivatives. Comment lines in the generated code (ﬁle FSUBS) identify these vari-<br>ables. This makes the listed variables globally accessible to all blocks of abbreviated<br>code, which may not be desirable. (An exception is made for initialization-ﬁnalization<br>variables; these are PRED-deﬁned variables that are ﬁrst deﬁned within a block that tests<br>for ICALL 0, 1, 3. Such variables are stored locally and will not be changed by NON-<br>MEM at ICALL 2 or 4.) (See <b>INFN-deﬁned_variables.</b>)<br>
Variables from a given block of abbreviated code can be excluded from the module by<br>including the following pseudo-statement in that block:<br>COMRES=-1<br>Variables from all blocks of abbreviated code can be excluded from the module by<br>including the identical option (COMRES=-1) on the $ABBREVIATED record.<br>
Variables from NMPRD4 can be used in a user-written subroutine. If the user-written<br>subroutine contains the USE NMPRD4 statement as shown above, the variables have the<br>names COM(1), COM(2), etc. E.g., X=COM(1)/COM(1). It is possible to give the<br>variables the same (non-subscripted) names that they had in $PRED, $PK or $ERROR.<br>Suppose variables CL and V are used in $PK, and the following is present in the gener-<br>ated PK routine:<br>
CL=&gt;COM(00001); V=&gt;COM(00002)<br>
In the user-written subroutine, after the last declaration, include:<br>
POINTER :: CL,V<br>
532<br>
<hr>
<A name=538></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PRED-DEFINED<br>
Prior to the ﬁrst executable statement, include:<br>
CL=&gt;COM(1); V=&gt;COM(2)<br>
Now the code is X=CL/V.<br>
Code generated by NM-TRAN is somewhat more complex, but achieves the same result.<br>
REFERENCES: Guide III, section V.3.3<br>REFERENCES: Guide IV, section III.B.7 , III.B.16 , III.B.17 , IV.H , V.C.5-9<br>REFERENCES: Guide VI, section III.J , III.L.2 , IV.E , IV.G.4 Figures 5, 14<br>
533<br>
<hr>
<A name=539></a>PREDPP DETAILED DESCRIPTIONS<br>
Help Guide<br>
PREDPP MODULES<br>
MEANING: Global variables in PREDPP<br>CONTEXT: User-supplied routines<br>
DISCUSSION:<br>
These modules contain values that are (for the most part) communicated from PRED to<br>its subroutines. Prior to NONMEM 7 these values were COMMON blocks. Following is<br>a list of the MODULE, the (old) COMMON, and a description of the variables.<br>(See <b>NONMEM_modules</b>).<br>
PREDPP read-only modules contain values that are communicated from PREDPP to vari-<br>ous user-subroutines PK, ERROR, DES and AES.<br>
PROCM_INT (PROCM1)<br>
NEWIND, for PK and ERROR<br>
PROCM_REAL (PROCM2)<br>
Non-event dose time and derivatives, for PK<br>
PROCM_REAL (PROCM3)<br>
Initiating dose record (at non-event dose time), for PK<br>
PROCM_REAL (PROCM4)<br>
Compartment amounts and derivatives, for PK and ERROR<br>
PROCM_INT (PROCM5)<br>
Number and map of active etas, for PK and ERROR (and TRANS)<br>
PROCM_REAL (PROCM6)<br>
Theta vector from NONMEM, for DES and AES<br>
PROCM_REAL (PROCM7)<br>
EVTREC from NONMEM, for DES and AES<br>
PROCM_CHAR (PROCM8)<br>
Format statements, for all routines<br>
PROCM_REAL (PROCM9)<br>
Time at which the state-vector (in PROCM4) was last computed, for PK<br>
PROCM_INT (PROCMA)<br>
Indicator variables associated with model event times, for all routines<br>
PROCM_INT (PROCMB)<br>
Flag indicating ﬁnal call to DES or AES after advance to event or non-event time,<br>for DES and AES<br>
PROCM_INT (PROCMC)<br>
Flag indicating compartment initialization call to PK, for PK<br>
The following are special modules containing values that are communicated from user<br>routines to PREDPP.<br>
PRCOM_INT (PRCOMG)<br>
Override default settings in ADVAN6, ADVAN8, ADVAN9, ADVAN13,and SS6<br>
PRCOM_LOG (PRCOMU)<br>
Restore pre-1990 behavior of bio-availability fraction<br>
PRCOM_REAL (PRCOMW)<br>
Fudge factor for error tests in ADVAN7/SS7<br>
534<br>
<hr>
<A name=540></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PREDPP<br>
These modules contain values that are communicated from subroutines to PREDPP.<br>
PKERR_REAL (PRDPK1)<br>
Communicate model event time parameters computed by PK to the ERROR routine<br>
PRMOD_INT (PRDPK2)<br>
Flag indicating possible change in model event time parameters<br>
PRMOD_REAL (PRDPK3)<br>
Compartment initialization values from PK<br>
PRMOD_INT (PRDPK4)<br>
Values of ISSMOD and I_SS (&quot;Initial Steady-State&quot;) ﬂags.<br>
PROCM_INT (PRDDE1)<br>
Initialization values that are communicated from subroutine DES and AES to<br>PREDPP.<br>
PRINFN (PRINFN)<br>
Contains values of INFN-deﬁned variables which are communicated to other<br>PREDPP user-routines.<br>
Each has its own entry in the Help document.<br>
REFERENCES: Guide VI, section III.I , IV.D , Figure 14<br>
535<br>
<hr>
<A name=541></a>PRED RES WRES<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
PRED RES WRES<br>
MEANING: PRED, RES, WRES<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>NONMEM tables usually include special items: prediction, residual, and weighted resid-<br>ual, which are generated by NONMEM. The default labels for these items are PRED,<br>RES, and WRES, respectively. Synonyms may be speciﬁed on the $TABLE record for<br>one or more of these labels. With the NOAPPEND option on this record, the three items<br>are not included in a table unless explicity listed on the $TABLE record. With the use of<br>the user-routine SPTWO, the values of the RES and WRES items can be deﬁned differ-<br>ently from the values described below.<br>(See <b>sptwo</b>).<br>
These items may also be displayed in scatterplots. Synonyms may be speciﬁed on the<br>$SCATTERPLOT record as well; synonyms speciﬁed on either the $TABLE or $SCAT-<br>TERPLOT record also apply to the other record.<br>
PRED<br>
Prediction items are the predictions computed by the PRED subroutine. For popula-<br>tion data, prediction items are always population predictions, i.e., they are computed<br>at the mean value of eta (0).<br>
RES<br>
The residual is deﬁned as DV - PRED; that is, the observed value minus the predic-<br>tion item.<br>
WRES<br>
The weighted residuals for an individual are formed by transforming the individual’s<br>residuals so that under the model, assuming the true values of the parameters are<br>given by the estimates of those parameters, all weighted residuals have mean 0, unit<br>variance and are uncorrelated. For population data, the &quot;weights&quot; are computed at<br>eta = 0.<br>
For odd-type data, the prediction items are likelihoods (for population data, using the esti-<br>mated values of the parameters, and computed at eta = 0). These may not be of much<br>interest. The RES and WRES items are 0.<br>
With a mixture model, each individual is classiﬁed into one of the subpopulations of the<br>mixture according to a computation based on the individual’s data and on the ﬁnal param-<br>eter estimates. For a data record from the individual record, the prediction, residual, and<br>weighted residual items in the corresponding row of a table (or point on a scatterplot) are<br>based on the submodel deﬁning the subpopulation into which the individual is classiﬁed.<br>
If the Marginal data item (MRG_) is 1 or 2 for a given data record, then PRED is an<br>expected prediction, rather than the prediction at the mean value of eta. When the Raw-<br>data data item (RAW_) is 1, then DV is a raw-data average and RES is the difference<br>between the PRED item and this average.<br>(See <b>displayed PRED-deﬁned items</b>).<br>
REFERENCES: Guide I, section C.3.5.3 , C.3.5.4<br>REFERENCES: Guide IV, section III.B.16 , III.B.17<br>REFERENCES: Guide V, section 9.5 , 10.7 , 11.4.4.2<br>
536<br>
<hr>
<A name=542></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PRIOR<br>
PRIOR<br>
MEANING: PRIOR subroutine<br>CONTEXT: User-supplied subroutine; replaces a NONMEM dummy routine<br>
USAGE:<br>SUBROUTINE PRIOR (ICALL,CNT)<br>
USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER(KIND=ISIZE), INTENT(IN) :: ICALL<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: CNT<br>
DISCUSSION:<br>The user-written PRIOR subroutine allows a penalty function based on a frequency prior<br>to be speciﬁed and added to the -2log likelihood function (Gisleskog et al, JPP, 2002, p.<br>473-505). This serves as a constraint on the <i>estimates </i>of THETA, OMEGA, and SIGMA<br>and thus as a way for stable estimates to be obtained with insufﬁcient data.<br>
When the Simulation Step is implemented, THETA and OMEGA, and SIGMA may also<br>be simulated (along with etas and epsilons, should any such appear in the model and have<br>nonzero-variances) in the PRIOR subroutine (See <b>PRIOR_Simulation:_Parameters</b>).<br>However, this need not be done (simply execute a return in PRIOR at ICALL=4), in<br>which case the values for THETA, OMEGA, and SIGMA used in the simulation are the<br>values given in the NONMEM control stream or input Model Speciﬁcation File.<br>
Input argument:<br>
ICALL<br>
Similar to ICALL for PRED subroutine.<br>Possible values: 0, 1, 2, and 4.<br>In a multiple problem run, PRIOR is called with ICALL=1 only with the ﬁrst prob-<br>lem.<br>
Output argument:<br>
CNT<br>
CNT is the penalty term.<br>
Other Inputs:<br>
Other inputs are available to PRIOR in NONMEM read-only modules. (See <b>NON-<br>MEM_modules</b>).<br>
NONMEM Utility Routines:<br>
PRIOR may call NONMEM utility routines, NWPRI and TNPRI. (See <b>nwpri</b>, <b>tnpri</b>).<br>E.g.,<br>
SUBROUTINE PRIOR (ICALL,CNT)<br>USE SIZES, ONLY: DPSIZE,ISIZE<br>REAL (KIND=DPSIZE) :: CNT<br>REAL (KIND=DPSIZE) :: PLEV<br>INTEGER (KIND=ISIZE) :: ICALL<br>NTHETA=3<br>NETA=3<br>NEPS=1<br>NTHP=2<br>NETP=2<br>NEPP=1<br>
537<br>
<hr>
<A name=543></a>PRIOR DETAILED DESCRIPTIONS<br>
Help Guide<br>
PLEV=0<br>CALL NWPRI (NTHETA,NETA,NEPS,NTHP,NETP,NEPP,NPEXP,ITYP,PLEV, &amp;<br>
NSAM,ISS,CNT)<br>
RETURN<br>END<br>
NWPRI and TNPRI compute particular types of penalty functions. NWPRI computes a<br>function based on a frequency prior that has a multivariate normal form for THETA, and<br>also, in the case of population data, an inverse Wishart form for OMEGA (independent<br>from the normal for THETA). When used during a Simulation Step, it produces a ran-<br>dom value of THETA and a random value of OMEGA from the frequency prior. The<br>prior information is entered manually into the control stream. This prior is especially<br>useful for a subjective speciﬁcation of a penalty function. (See <b>nwpri</b>, tnpri).<br>
Model parameters may be constrained in various ways. Those parameters whose values<br>are not ﬁxed are transformed to new parameters whose values are not at all constrained a<br>priori (the &quot;unconstrained parameters&quot;, or UCP). TNPRI computes a penalty function<br>based on a frequency prior that has a multivariate normal form for all UCP. When used<br>during a Simulation Step, it produces a random value of the vector of all model parame-<br>ters (whose values are not ﬁxed). The prior information is found in an input model speci-<br>ﬁcation ﬁle, and it has been automatically stored there as part of a NONMEM analysis of<br>a prior data set. (See <b>$msﬁ</b>, <b>model_speciﬁcation_ﬁle</b>). This prior is especially useful for<br>an empirical speciﬁcation of a penalty function. (See <b>TNPRI</b>).<br>
The $PRIOR statement can be used instead of a PRIOR subroutine.<br>(See <b>$prior.ctl</b>).<br>
REFERENCES: Guide V, section 12.4.16<br>
538<br>
<hr>
<A name=544></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PRIOR<br>
PRIOR SIMULATION: ICMAX<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRIOR routine<br>
USAGE:<br>USE NMPR_INT, ONLY: ICMAX=&gt;IMAXSIM<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IMAXSIM<br>
DISCUSSION:<br>
This variable allows the user to control the behavior of the NWPRI and TNPRI NON-<br>MEM utility routines. It is relevant during simulation when PRIOR sets ISS to a non-<br>zero value. By default, NWPRI and TNPRI attempt at most 100 times to obtain a sample.<br>After that number of attempts, they terminate with the message<br>
MAXIMUM ATTEMPTS TO OBTAIN SAMPLE EXCEEDED<br>
ICMAX<br>
If a value is set in ICMAX, this overrides the default of 100. E.g., in a PRIOR sub-<br>routine:<br>
USE NMPR_INT, ONLY: ICMAX=&gt;IMAXSIM<br>
... other code ...<br>
ICMAX=500<br>
Location prior to NONMEM 7: nmpr50<br>
REFERENCES: None.<br>
539<br>
<hr>
<A name=545></a>PRIOR DETAILED DESCRIPTIONS<br>
Help Guide<br>
PRIOR SIMULATION: PARAMETERS<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPR_REAL, ONLY: THSIMP=&gt;THET_P,OMSIMP=&gt;OMEG_P,SGSIMP=&gt;SIGM_P,THSIMPR<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LTH,LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: THET_P(LTH),OMEG_P(LVR,LVR),SIGM_P(LVR,LVR)<br>
DISCUSSION:<br>Values of THETA, OMEGA and SIGMA that are produced during a Simulation Step<br>using the user-supplied routine PRIOR must be stored in these variables. If one of the<br>NONMEM utility routines NWPRI or TNPRI is used by PRIOR to produce THETA,<br>OMEGA, and SIGMA values, these values will automatically be stored in<br>THET_P,OMEG_P,SIGM_P. If $THETAR record is not used, THSIMPR contains the<br>same values as THSIMP (THET_P). If $THETAR record, THSIMP contains the internal<br>theta values, and THSIMPR contains the reported values (THSIMP values transformed<br>by equations of the $THETAR record). The entire THETA, OMEGA and SIGMA arrays<br>are stored by NPWRI and TNPRI, not just the the inital sub-vectors (prior-affected parts).<br>(See <b>nwpri</b>, <b>tnpri</b>).<br>
These variables may be used as right-hand quantities in $PK, $ERROR, $INFN and<br>$PRED blocks. After being set during the Simulation Step, they remain available during<br>problem ﬁnalization (i.e., ICALL=3).<br>
Location prior to NONMEM 7: nmpr16<br>
REFERENCES: None.<br>
540<br>
<hr>
<A name=546></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PROBABILITY<br>
PROBABILITY DENSITY FUNCTIONS<br>
MEANING: Functions that may be used in abbreviated code.<br>CONTEXT: Fortran coded function<br>
A series of built in probability density functions are available with NONMEM 7.4.2. For<br>a giv en probability density there is also a cumulative distribution function (densitycdf),<br>and random number generating function (density_rng).<br>
They are described in INTRODUCTION TO NONMEM 7.4.2 Section I.26.<br>
The density and densityCDF functions have arguments that are compatible with the<br>FUNC system, in which function provides derivatives (XD), and second derivatives<br>(XDD) (see I.65.Expanded Syntax and Capacity for User-Deﬁned Functions (FUNCA)<br>(NM74)). Thus, even random (eta associated) variables may serve as arguments to the<br>parameters of the density functions. The source code of these densities are in<br>..\source\DISTRIB.f90, DISTRIBCDF.f90, and DISTRIBRNG.f90. Note that multi-vari-<br>ate densities do not have a corresponding CDF routine.<br>
Note that multi-variate densities do not have a corresponding CDF routine.<br>
Examples of their use are in the ..\examples\densities directory.<br>
Here are the list of densities, which are modeled after the format from the Stan manual:<br>
BERNOULLI<br>BERNOULLILOGIT<br>BINOMIAL<br>BINOMIALLOGIT<br>BETABINOMIAL<br>HYPERGEOMETRIC<br>CATEGORICAL<br>CATEGORICALLOGIT<br>ORDEREDLOGISTIC<br>NEGBINOMIAL<br>NEGBINOMIAL2<br>NEGBINOMIAL2LOG<br>POISSON<br>POISSONLOG<br>MULTINOMIAL<br>NORMAL<br>EXPMODNORMAL<br>SKEWNORMAL<br>STUDENTT<br>DOUBLEEXPONENTIAL<br>LOGISTIC<br>GUMBEL<br>LOGNORMAL<br>CHISQUARE<br>INVCHISQUARE<br>SCALEDINVCHISQUARE<br>EXPONENTIAL<br>GAMMA<br>
541<br>
<hr>
<A name=547></a>PROBABILITY DETAILED DESCRIPTIONS<br>
Help Guide<br>
INVGAMMA<br>WEIBULL<br>FRECHET<br>RAYLEIGH<br>PARETO<br>PARETO2<br>BETA<br>DIRICHLET<br>VON MISES<br>
REFERENCES: none<br>
542<br>
<hr>
<A name=548></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PROBLEM<br>
PROBLEM ITERATION COUNTERS<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE NMPRD_INT, ONLY: NPROB,IPROB,S1NUM=&gt;IDXSUP(1),S2NUM=&gt;IDXSUP(2), &amp;<br>
S1NIT=&gt;NITR_SUP(1),S2NIT=&gt;NITR_SUP(2), &amp;<br>
S1IT=&gt;NITSUP(1),S2IT=&gt;NITSUP(2)<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: NPROB,IPROB,IDXSUP(2),NITR_SUP(2),NITSUP(2)<br>
DISCUSSION:<br>
NPROB<br>
The number of problems in the run.<br>
IPROB<br>
The number of the current problem.<br>
IPROB is 1 unless there are multiple problems (e.g., multiple $PROBLEM records<br>in the NM-TRAN control stream).<br>
S1NUM<br>
The number of the active ﬁrst-level superproblem.<br>S1NUM is 0 if there is no active ﬁrst-level superproblem.<br>
S2NUM<br>
The number of the active second-level superproblem.<br>S2NUM is 0 if there is no active second-level superproblem.<br>
S1NIT<br>
The number of iterations for the active ﬁrst-level superproblem.<br>S1NIT is 0 if there is no active ﬁrst-level superproblem.<br>
S2NIT<br>
The number of iterations for the active second-level superproblem.<br>S2NIT is 0 if there is no active second-level superproblem.<br>
S1IT<br>
The number of the current iteration of the active ﬁrst-level superproblem.<br>S1IT is 0 if there is no active ﬁrst-level superproblem.<br>
S2IT<br>
The number of the current iteration of the active second-level superproblem.<br>S2IT is 0 if there is no active second-level superproblem.<br>
These variables may be used as right-hand quantities in abbreviated code for initializa-<br>tion/ﬁnalization blocks.<br>
(See <b>$super</b>).<br>
Location prior to NONMEM 7: rocm14<br>
REFERENCES: None.<br>
543<br>
<hr>
<A name=549></a>PROTECT DETAILED DESCRIPTIONS<br>
Help Guide<br>
PROTECT FUNCTIONS<br>
MEANING: PROTECT functions<br>CONTEXT: Source code<br>
USAGE:<br>X=..<br>XLOG10=PLOG10(X)<br>
DISCUSSION:<br>As of NONMEM 7.4, a series of routines are available that protect against domain viola-<br>tions, divide by zero, and ﬂoating point overﬂows. Each of these routines start with the<br>letter P, followed by the name of the mathematical operation they are to perform. For<br>example, PLOG is the protective code routine that performs the LOG operation. In addi-<br>tion, there are ﬁrst derivative (such as PLOGD1), and second derivative (such as<br>PLOGD2) companion routines available which NMTRAN uses for computing analytical<br>derivatives. The source code of these routines are available in ..\source\PROTECT.f90. If<br>you wish to modify their behavior, then copy PROTECT.f90 to your run directory as (say)<br>myprotect.f90, modify it, then refer to this modiﬁed code with $SUBROUTINES<br>OTHER=myprotect.f90 (The OTHER option is not needed if the P functions are coded<br>explicitly or implicitly via $ABBR PROTECT.)<br>
The following protective code routines are available:<br>
For all routines, if X=not a number, X is converted to machine precision value, which is<br>about 1.0E-15, before performing an operation on it. If X&gt;INFNTY (where INFNTY is<br>approximately 1.0E+154), then X is converted to INFNTY before an operation is per-<br>formed on it.<br>
PLOG(x): returns LOG of x. If x&lt;SMALLZ, where SMALLZ is approximately<br>2.8E-103, then LOG(SMALLZ) is returned.<br>
PLOG10(x): returns LOG10 of x. If x&lt;SMALLZ, where SMALLZ is approxi-<br>mately 2.8E-103, then LOG10(SMALLZ) is returned.<br>
PSQRT(x): returns SQRT of x. If x=0.0d+00, then 0 is returned.<br>
PEXP(x): returns EXP of x. If x&gt;40.0, then PEXP(100.0) is returned (avoids over-<br>ﬂow).<br>
PDZ(x): returns 1/x . Protects against divide by zero. If abs(x)&lt;SMALLZ, then<br>1/SMALLZ is returned.<br>
PZR(x): returns x. protects against zero. If abs(x)&lt;SMALLZ, then SMALLZ is<br>returned.<br>
PNP(x): returns x. Protects against non-positive. If X&lt;SMALLZ, then SMALLZ is<br>returned.<br>
PHE(x): returns x. Protects against high exponent. If X&gt;100, then 100 is returned.<br>Thus PEXP(x)=EXP(PHE(x)).<br>
PNG(x): returns x. Protects against negative. If X&lt;0.0, then 0.0 is returned.<br>
PTAN(x): returns tan(x). Protects against returning inﬁnity on inputs near pi/2.<br>
PATAN(x): returns atan(x). Protects against large intputs.<br>
PA COS(x), PASIN(x): returns acos(x), asin(x), respectively. If |X| is between 1.0<br>and 1+10**(-08), then x is submitted as 1 or -1. So, &quot;dirty ones&quot; are cleaned up, but<br>
544<br>
<hr>
<A name=550></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
PROTECT<br>
values clearly beyond 1 are allowed to trip up the function, so the user is aware of<br>the logical error in the code, and ﬁx the issue.<br>
Instead of replacing various operations with protected code operations by hand, you can<br>ask NMTRAN to automatically convert your code to protected code with the following<br>statement:<br>
$ABBR PROTECT<br>
NMTRAN will automatically replace all LOG (or DLOG) with PLOG, EXP (or DEXP)<br>with PEXP, SQRT (or DSQRT) with PSQRT, / operations with *PDZ(), and B**E opera-<br>tions with PEXP(E*PLOG(B)), and so on.<br>
Note that the any P function name that is used explicitly or implicitly via $ABBR PRO-<br>TECT may not be used for a user-deﬁned variable name.<br>
When you use $ABBR PROTECT, you will ﬁnd a considerable improvement in estima-<br>tion stability, reg ardless of estimation method used.<br>
REFERENCES: Guide Introduction_7<br>
545<br>
<hr>
<A name=551></a>PRRES DETAILED DESCRIPTIONS<br>
Help Guide<br>
PRRES<br>
MEANING: PRRES subroutine<br>CONTEXT: NONMEM routine<br>
DISCUSSION:<br>PRRES is a NONMEM routine. It is called with ﬁnal parameter estimates.<br>
An error message may indicate that NONMEM has experienced difﬁculties in PRRES<br>with the ﬁnal parameter estimates. (When the Estimation Step is not implemented, these<br>are the same as the initial parameter estimates.)<br>
PRRES may not be called by user-written code.<br>
REFERENCES: None.<br>
546<br>
<hr>
<A name=552></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
RANDOM<br>
RANDOM MODELS<br>
MEANING: Models for random variables<br>CONTEXT: Abbreviated code<br>
DISCUSSION:<br>The following are examples of commonly used models using random variables.<br>
Models for CL in terms of TVCL (&quot;typical value of clearance&quot;) and ETA are examples of<br>models expressing population inter-individual variability.<br>
Models for Y involving F (&quot;prediction based on the pharmacokinetic parameters&quot;) and<br>ERR are examples of models for intra-individual (&quot;residual&quot;) variability. They are used<br>with both population or single-subject data, in which case ERR stands for EPS or ETA,<br>respectively.<br>
Additive models<br>
CL=TVCL+ETA(1)<br>
Y=F+ERR(1)<br>
Proportional (CCV; Constant Coefﬁcient of Variation) models<br>
CL=TVCL*(1+ETA(1))<br>
Y=F*(1+ERR(1))<br>
An equivalent way of coding the proportional model is:<br>
CL=TVCL+TVCL*ETA(1)<br>
Y=F+F*ERR(1)<br>
Exponential models<br>
CL=TVCL*EXP(ETA(1))<br>
Y=F*EXP(ERR(1))<br>
During estimation by the ﬁrst-order method, the exponential model and proportional<br>models give identical results, i.e., NONMEM cannot distinguish between them.<br>
During estimation by a conditional estimation method, the exponential and propor-<br>tional models for inter-individual variability give different results. During simula-<br>tion, the two models give different results, in both the inter- and intra-individual<br>cases.<br>
Power Function model<br>
Y=F+F**P*ERR(1)<br>
The Power Function model has both the additive and the CCV error models as spe-<br>cial cases, and smoothly interpolates between them in other cases.<br>
Combined Additive and Proportional model (slope-intercept model)<br>
Y =F*(1+ERR(1))+ERR(2)<br>
Here is an alternative parameterization for the same model when there is no covari-<br>ance between ERR(1) and ERR(2). Any theta may be used.<br>
W=(1+THETA(5)*THETA(5)*F*F)**.5<br>
Y=F+W*ERR(1)<br>
REFERENCES: Guide V, section 3 , 4.1 , 7.5 , 8.3<br>REFERENCES: Guide V, section 8<br>
547<br>
<hr>
<A name=553></a>RANDOM DETAILED DESCRIPTIONS<br>
Help Guide<br>
REFERENCES: Guide VII, section I , III<br>
548<br>
<hr>
<A name=554></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
RANDOM<br>
RANDOM<br>
MEANING: RANDOM subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER(KIND=ISIZE) :: KR<br>
REAL(KIND=DPSIZE) :: R<br>
CALL RANDOM (KR,R)<br>
DISCUSSION:<br>The NONMEM utility routine RANDOM may be called (by PRED, PK or ERROR) dur-<br>ing the Simulation Step (ICALL=4) and when data averages are being computed<br>(ICALL=5) to obtain numbers from different random sources.<br>
Input argument:<br>
KR An integer variable or integer constant. The index of a random source.<br>
Output argument:<br>
R<br>
A number from the KRth source. R is double precision with NONMEM 7, and is<br>single precision with NONMEM VI. Each time RANDOM is called, a new number<br>is output.<br>
Random sources are deﬁned using the $SIMULATION record. Typically, the ﬁrst source<br>is reserved by NONMEM to generate realizations of the eta and epsilon variables and/or<br>to randomly mix individuals into different subpopulations according to the mixing param-<br>eter. Thus, typically, RANDOM must be called with KR &gt; 1. However, there are cases<br>when NONMEM itself needs no random sources, and all deﬁned random sources can be<br>used by PRED (see references).<br>
A random source that is speciﬁed on the $SIMULATION record as NONPARAMETRIC<br>should not be used to obtain a value of R.<br>
EXAMPLES OF USAGE:<br>
WT (an item in the data record, and a local variable with the same name) is generated<br>with a simulated value having mean 70 and standard deviation 7. The second random<br>source is assumed to be pseudo-normal, which is the default distribution for each random<br>source.<br>
An abbreviated code may use RANDOM explicitly in either a simulation or a data aver-<br>age block. When RANDOM is called in abbreviated code, R is reserved and is used for<br>the random number. E.g.,<br>
IF (ICALL.EQ.4.AND.NEWIND.NE.2) THEN<br>
CALL RANDOM(2,R)<br>
ENDIF<br>
IF (ICALL.EQ.4) WT=70+7*R<br>
REFERENCES: Guide IV, section III.B.13 , IV.I<br>REFERENCES: Guide V, section 12.4.8<br>
549<br>
<hr>
<A name=555></a>RATE DETAILED DESCRIPTIONS<br>
Help Guide<br>
RATE DAT A ITEM<br>
MEANING: Dose Rate (RATE) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... RATE ...<br>
DISCUSSION:<br>RATE labels PREDPP’s dose rate (RATE) data item. The dose rate data item is optional.<br>In a dose or reset-dose event record it can take four kinds of values.<br>
0<br>
The dose is an instantaneous bolus dose.<br>
&gt;0 The dose is an infusion, and the value of RATE gives its rate. If this is not a steady-<br>
state infusion, the AMT data item must be positive also. If this is a steady-state dose<br>ev ent record, both AMT and RATE may be 0; (See <b>ss dose</b>).<br>
-1 The dose is a zero-order bolus dose, i.e., an infusion, whose rate is modeled in the<br>
PK routine. As an example, suppose the compartment being dosed is numbered 1<br>(e.g., the CMT data item contains 1, or it contains 0 and compartment 1 is the<br>default compartment for doses). The $PK abbreviated code must deﬁne a value for<br>R1, the rate parameter for compartment 1, e.g., R1=THETA(4)+ETA(4)<br>
-2 The dose is a zero-order bolus dose, i.e., an infusion, whose duration is modeled in<br>
the PK routine. As an example, suppose the compartment being dosed is numbered<br>1 as above. The $PK abbreviated code must deﬁne a value for D1, the duration<br>parameter for compartment 1, e.g., D1=THETA(4)+ETA(4)<br>
RATE must be 0 for observation, other-type, and reset event records.<br>
(See <b>dose, steady_state_dose</b>).<br>REFERENCES: Guide VI, section V.E<br>REFERENCES: Guide V, section 6.8<br>
550<br>
<hr>
<A name=556></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
RATE<br>
RATE PARAMETER<br>
MEANING: Rate (R) parameter for PREDPP<br>CONTEXT: Additional PK Parameters<br>
USAGE:<br>$PK<br>
R1= ....<br>
DISCUSSION:<br>
Rate parameters are used with PREDPP. They are optional additional PK parameters.<br>With NM-TRAN, they are symbolized in the $PK block by reserved variables Rn, where<br>n is the compartment number to which the parameter applies.<br>
There is one rate parameter associated with every possible dose compartment of the<br>kinetic model (the output compartment is not a possible dose compartment) and the rate<br>parameter used for a given dose is that one associated with the compartment into which<br>the dose is given (the dose compartment).<br>
A rate-modeled zero-order bolus dose is actually an infusion, but one whose rate is given<br>by the rate parameter computed by the PK routine.<br>
Rate parameters are optional in the sense that rate parameters associated with compart-<br>ments never receiving rate-modeled zero-order bolus doses or rate-modeled steady-state<br>infusions may be ignored. However, if the RATE data item on some dose event record<br>contains the value -1, then a rate parameter for the dose compartment must be computed<br>in the PK routine.<br>
Rate parameters act continuously. PREDPP obtains the value of a rate parameter, holding<br>over the state-interval (<i>t</i>1, <i>t</i>2), from a call to PK with the record associated with <i>t</i>2, even if<br>the dose event time occurs before <i>t</i>2. Therefore, if there are state times (e.g. <i>t</i>2) falling<br>within the time interval over which a zero-order bolus dose appears in the system, there<br>exists the possibility that the rate of drug input can change during the interval. For this to<br>occur, the rate parameter would need to be modeled in terms of time varying covariates.<br>As a result, a zero-order bolus dose where the rate is modeled might be better described<br>as a piecewise zero-order process.<br>
When additional doses are speciﬁed on a dose event record the rate parameter applies to<br>the dose and to all the additional doses.<br>
(See <b>cmt</b>, <b>rate</b>, <b>pk</b>, <b>$pk</b>, <b>default_compartment</b>).<br>(See <b>exogenous supplementation example</b>).<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide V, section 12.2.3<br>REFERENCES: Guide VI, section III.F.4-5<br>
551<br>
<hr>
<A name=557></a>RAW<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
RAW DAT A ITEM<br>
MEANING: Raw-data (RAW_) data item<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... RAW_ ...<br>
DISCUSSION:<br>RAW_ labels NONMEM’s raw-data (RAW) data item. The raw-data data item is optional.<br>With a nonobservation record (i.e. MDV=1) it controls the deﬁnition of the value of the<br>DV item associated with that record that appears in tables or scatterplots (whereas with-<br>out the raw-data item, this DV item is the one in the original data set). Basically, 0 means<br>the displayed DV item is that in the original data set, and 1 means the DV item is the raw-<br>data-average of original DV items.<br>
Values are:<br>
0<br>
The data record is not a template record.<br>
1<br>
The data record serves as a template record, aiding in the deﬁnition of the (particu-<br>lar) raw-data-average. The DV and RES items become the raw-data-average and the<br>difference between this average and the PRED item, respectively. The average is<br>over all observations in all other data records with user-deﬁned data items matching<br>(i.e. equal to) those occurring in the template record. (A user-deﬁned data item is a<br>data item not recognized by NONMEM, i.e., not one of ID, L2, DV, MDV, RAW_,<br>MRG_. It may be a PREDPP data item. Speciﬁc user-deﬁned data item types may<br>be excluded from the match; see the $OMIT record.) The average is a two-stage<br>av erage; it is the average of within-individual averages.<br>
Any PRED-deﬁned item stored in the SAVE region and displayed in a table or scat-<br>terplot is handled as is the DV item; it too is replaced by an average of the corre-<br>sponding PRED-deﬁned items obtained with observation records. Thus, several dif-<br>ferent raw-data-averages can be deﬁned (using the same template).<br>
With RAW_=1, MDV must also be 1 or 101. This use of MDV=1 does not prevent, as<br>would ordinarily happen, the DV or RES items from being plotted.<br>
A plot of DV, RES (and of any PRED-deﬁned item stored in the SAVE region) will only<br>include points from records with RAW_=1, unless one explicitly partitions on RAW_.<br>
If PREDPP is used and NM-TRAN generates MDV, MDV is set to 1 if RAW_ is 1. If<br>PREDPP is used, NM-TRAN sets RAW_ to 0 (if it is not already 0) when EVID is not<br>equal to 0.<br>
Warning: If PREDPP is used and NM-TRAN generates EVID, it sets EVID=2 for records<br>with MDV=1 and no dosing information. This causes RAW_ to be set to 0. When<br>RAW_ is used, the data set should include MDV and EVID data items. The values<br>should be MDV=1 and EVID=0 when RAW_&gt;0.<br>
(See <b>data average example</b>, <b>data average block</b>).<br>
REFERENCES: none.<br>
552<br>
<hr>
<A name=558></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
RAW OUTPUT FILE<br>
RAW OUTPUT FILE<br>
MEANING: NONMEM Raw Output ﬁle<br>CONTEXT: NONMEM Output Files<br>
DISCUSSION:<br>
With NONMEM 7, a NONMEM run produces several additional output ﬁles. These pro-<br>vide a more efﬁcient way of way of extracting numerical results from the analysis than by<br>obtaining them from the NONMEM report ﬁle.<br>(See <b>additional_output_ﬁle</b>).<br>
Names of the ﬁles start with &quot;root&quot;, where root is the root name (not including extension)<br>of the NM-TRAN control stream ﬁle given at the nmfe7 command line, or<br>root=&quot;nmbayes&quot; if the control stream ﬁle name is not passed as an argument to the NON-<br>MEM executable. E.g., in this example the root is myexample.<br>nmfe7 myexample.ctl myexample.res<br>The raw output ﬁle (&quot;root.ext&quot;) will be named myexample.ext<br>
A different name for this ﬁle may be speciﬁed using the FILE=ﬁlename option of the<br>$ESTIMATION record. This ﬁlename is used for all subsequent problems, until a new<br>FILE=ﬁlename option is coded. The raw output ﬁle is only generated if the $ESTIMA-<br>TION record is present and accumulates information from each Estimation step.<br>
The ﬁrst two lines of each ﬁle is the same. First is a header line that begins with the word<br>TABLE, such as:<br>
TABLE NO.<br>
n:<br>
These tables are not related to the ones produced by the $TABLE record. The value of n<br>is incremented each time the Estimation Step is implemented, i.e., once per $ESTIM<br>record, when MAXEVAL is not 0 and $EST is not omitted. The $EST records may be in<br>the same problem, or in subsequent problems. If $COV is present in a problem without<br>$EST (e.g., when $MSFI is used), then n is also incremented.<br>
Next on the header line is the analysis text (same as given on the #METH: line in the<br>report ﬁle), e.g., &quot;First Order&quot;.<br>
In the raw output ﬁle, the analysis text is followed by the goal function text (same as<br>given on the #OBJT: line in the report ﬁle), e.g.,<br>Goal Function=MINIMUM VALUE OF OBJECTIVE FUNCTION<br>At the end of the header line is:<br>Problem=1 Subproblem=0 Superproblem1=0 Iteration1=0<br>
Superproblem2=0 Iteration2=0<br>
The values of Problem, Subproblem, Superproblem1, Iteration1, Superproblem2, Itera-<br>tion2 are the same values as would be found in the following variables in modules during<br>the run:<br>IPROB IREP S1NUM S1IT S2NUM S2IT<br>(See <b>Problem_Iteration_Counters</b>).<br>
The second line of the raw output ﬁle contains the column headers for the table, all on<br>one line.<br>
Options NOTITLE and NOLABEL and FORMAT of the $ESTIMATION record can be<br>used to supress the ﬁrst and/or second lines, and to modify the format of the values in the<br>table. They apply to raw and additional output ﬁles, but only for the current Estimation<br>
553<br>
<hr>
<A name=559></a>RAW OUTPUT FILE<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
Step. The options must be re-speciﬁed with each $EST record.<br>
Values of the Parameters and of the objective function are printed to the raw output ﬁle<br>ev ery PRINT iterations. The default order is:<br>ITERATION THETA, SIGMA, OMEGA, OBJ (Objective function). Values of Sigma<br>and Omega are in the original parameterization, as in the ﬁle INTER. The option<br>ORDER of the $ESTIMATION record may be used to change the order of THETA,<br>SIGMA, and OMEGA.<br>(See <b>order_option</b>).<br>
The iteration number, which is the ﬁrst value in every line, is typically positive, but also<br>may be negative under the following conditions:<br>
1) The burn-in iterations of the MCMC Bayesian analysis are given neg ative values,<br>starting at -NBURN, the number of burn-in iterations requested by the user. These<br>are followed by positive iterations of the stationary phase.<br>
2) The stochastic iterations of the SAEM analysis are given neg ative values. These<br>are followed by positive iterations of the accumulation phase.<br>
3) Iteration -1000000000 (negative one billion) identiﬁes the line that contains the<br>ﬁnal result (thetas, omegas, and sigmas, and objective function) of the particular<br>analysis. These are the value in the NONMEM output ﬁle that are labelled FINAL<br>PARAMETER ESTIMATE. The order is theta, sigma, omega.<br>
4) Iteration -1000000001 identiﬁes the line that contains the standard errors of the<br>ﬁnal population parameters. These are the value in the NONMEM output ﬁle that<br>are labelled STANDARD ERROR OF ESTIMATE. The order is theta, sigma,<br>omega.<br>
This line is present if the Covariance Step is successful, or with<br>
METHOD=BAYES.<br>
5) Iteration -1000000002 identiﬁes the line that contains the eigenvalues of the cor-<br>relation matrix of the variances of the ﬁnal parameters.<br>
6) Iteration -1000000003 identiﬁes the line that contains the condition number , low-<br>est, highest, Eigenvalues of the correlation matrix of the variances of the ﬁnal<br>parameters.<br>
7) Iteration -1000000004 identiﬁes the line that contains the OMEGA and SIGMA<br>elements in standard deviation/correlation format<br>
8) Iteration -1000000005 identiﬁes the line that contains the standard errors to the<br>OMEGA and SIGMA elements in standard deviation/correlation format<br>
9) Iteration -1000000006 identiﬁes the line that indicates 1 if parameter was ﬁxed in<br>estimation, 0 otherwise.<br>
10) Iteration -1000000007 lists termination status (ﬁrst item) followed by termina-<br>tion codes.<br>
In nm73, termination status catalogs the error status:<br>For traditional analyses, an error number is listed. If negative, the analysis was<br>user-interrupted<br>For EM/Bayes analysis, error numbers map as follows:<br>0,4: optimization was completed<br>1,5: optimization not completed (ran out of iterations)<br>2,6: optimization was not tested for convergence<br>3,7: optimization was not tested for convergence and was user interrupted<br>8,12: objective function is inﬁnite or all individual objective fuctions are zero.<br>problem ended<br>
554<br>
<hr>
<A name=560></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
RAW OUTPUT FILE<br>
16,20: All individual objective fuctions are zero. problem ended<br>4,5,6,7,12,20: reduced stochastic/stationary portion was not completed prior to<br>user interrupt<br>
11) Iteration -1000000008 lists the partial derivative of the likelihood (-1/2OFV)<br>with respect to each estimated parameter. This may be useful for using tests like the<br>Lagrange multiplier test.<br>
See the description of root.xml in Guide INTRODUCTION TO NONMEM 7 for<br>versions 7.4 and higher.<br>
A ﬁle simliar to the raw output ﬁle is root.cnv. This ﬁle contains convergence informa-<br>tion for the Monte Carlo/EM methods, if CTYPE&gt;0:<br>
1) Iteration -2000000000 identiﬁes the line that contains the mean of last CITER<br>values (mean objective function is that of second to last CITER values)<br>
2) Iteration -2000000001 identiﬁes the line that contains the standard deviation of<br>last CITER values (for objective function, STD of second to last CITER values)<br>
3) Iteration -2000000002 identiﬁes the line that contains the linear regression p-<br>value of last CITER values against iteration number. (for objective function, p-value<br>of second to last CITER values)<br>
4) Iteration -2000000003 identiﬁes the line that contains the Alpha used to assess<br>statistical signiﬁcance (p-value&lt;alpha)<br>
Please note the following: The Sigma values are in their Cholesky format, as this is<br>the form in which convergence of these values are tested. The Alpha are those based<br>on ones actually used for convergence test of that parameter, or which would have<br>been used on that parameter if CTYPE were of proper type. The alpha may be bon-<br>feroni corrected because of multiple comparisons, depending on number of parame-<br>ters that were tested or would have been tested. Objective function alphas are not<br>bonferoni corrected.<br>
For importance sampling and iterative two stage, the average objective function<br>listed in root.cnv could be used as an alternative to the ﬁnal objective function for<br>likelihood ratio tests.<br>
REFERENCES: Guide Introduction_7<br>
555<br>
<hr>
<A name=561></a>RECORD DETAILED DESCRIPTIONS<br>
Help Guide<br>
RECORD COUNTERS: NIREC,NDREC<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_INT, ONLY: NIREC=&gt;NINDREC,NDREC=&gt;NDATINDR<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: NINDREC,NDATINDR<br>
DISCUSSION:<br>
NIREC<br>
The number of the individual record at the current call.<br>
NDREC<br>
The number of the data record within the individual record at the current call.<br>
NIREC and NDREC also change value in conjunction with calls to PASS, a NONMEM<br>utility routine.<br>
NIREC and NDREC may be used as right-hand quantities in $PRED, $PK, and $ERROR<br>blocks, and in a $INFN block in conjunction with PASS.<br>
NM-TRAN automatically provides the necessary USE statement in the generated subrou-<br>tines.<br>
See also additional_record_counters for other variables of interest such as FIRSTREC.<br>
Location prior to NONMEM 7: rocm32<br>
REFERENCES: None.<br>
556<br>
<hr>
<A name=562></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
RECURSIVE<br>
RECURSIVE PRED INDICATOR<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_INT, ONLY: I_REC=&gt;IRECRSIV<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IRECRSIV<br>
DISCUSSION:<br>
A PRED routine may be recursive, i.e., for single-subject data, with a given data record,<br>the PRED computation depends on the values of variables that PRED computes with <i>any<br></i>of the previous records. PREDPP is such a routine.<br>
By default, PRED is taken to be nonrecursive. At ICALL=0 or 1, PRED can declare<br>itself to be recursive, by including the variable I_REC and setting it to 1.<br>
The setting of I_REC can be changed from problem to problem, but regardless of the set-<br>ting, with a given problem the setting is always taken to be 0 if the data for that problem<br>are population data.<br>
If I_REC is set to 1 and the repetition feature is not used, the SPECIAL option need not<br>appear on the $COVARIANCE record; the special computation is automatically used.<br>
PREDPP sets I_REC to 1 at ICALL=1.<br>
I_REC can be set explicitly in abbreviated code. With recursive $PRED abbreviated code<br>and with single-subject data, if I_REC is not set to a value in $PRED, then NM-TRAN<br>causes I_REC to be set to 1.<br>
Location prior to NONMEM 7: nmprd8<br>
REFERENCES: None.<br>
557<br>
<hr>
<A name=563></a>REPETITION DETAILED DESCRIPTIONS<br>
Help Guide<br>
REPETITION VARIABLES<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPR_INT, ONLY: RPTI=&gt;NRPT_IN,RPTO=&gt;NRPT_OUT, &amp;<br>
RPTON=&gt;NRPT_ON,PRDFL=&gt;IUSEPRD<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: NRPT_IN,NRPT_OUT,NRPT_ON,IUSEPRD<br>
DISCUSSION:<br>
These variables provide the information controlling the Repetition feature of NONMEM.<br>
RPTO<br>
RPTO is the &quot;repetition output value&quot;. With each data record, it may be set by<br>PRED, and it conveys information to NONMEM. RPTO may be used as a left-hand<br>quantity in $PRED, $PK and $ERROR blocks.<br>
RPTO=0<br>
If RPTO is set to 0, this produces no effect.<br>
RPTO=n (where n is between 1 and 5)<br>
The current record is thus marked as a &quot;repetition base with value n&quot;, i.e. as the<br>ﬁrst of a series of contiguous records of the current individual record (with sin-<br>gle-subject data, contiguous records of the data set) which will be repeated.<br>See the repeat data item (See <b>RPT_</b>).<br>
RPTO=-n (where n is between 1 and 5)<br>
The current record thus becomes a &quot;repetition initiator with value n&quot;, i.e.<br>before the next record is passed to PRED all preceding records of the individual<br>record (with single-subject data, all records of the data set), starting with the<br>last such record marked as a repetition base with value n, and up to and includ-<br>ing the current record, will be once again passed to PRED (will be &quot;repeated&quot;).<br>The value n is put onto the top of a stack - the &quot;repetition stack&quot;.<br>
The series of records from base to initiator is called the &quot;repetition series for n&quot;.<br>The series may be repeated any number of times (see RPTON). After all repe-<br>titions are complete, the value n is removed from the repetition stack.<br>
While the series is being repeated, RPTO may be set again with any record R of<br>the series. If the (unsigned) repetition output value is a value already on the<br>repetition stack, this value is ignored. Otherwise, the output value is not<br>ignored, and it may be set so as to mark R as a repetition base or as a repetition<br>initiator. In the latter case the current value on the top of the stack (m) is<br>pushed down to the next lower position, the value n is put onto the top of the<br>stack, and a new repetition series is initiated. After the new series has been<br>fully repeated, the value n is removed from the stack, the value m is again put<br>onto the top of the stack, and repetition of the series for m is continued with the<br>record following R.<br>
RPTO=-1<br>
This value is a special value that may be used as the repetition output value<br>with a given record. If a previous record has been marked as a repetition base<br>
558<br>
<hr>
<A name=564></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
REPETITION<br>
with value 1, then the record in question becomes a repetition initiator with<br>value 1 in the usual way. But if no previous record has been marked as a repeti-<br>tion base, then it is assumed that the ﬁrst record of the individual record (with<br>single-subject data, the ﬁrst record of the data set) is a repetition base with<br>value 1. That is, before the next record is passed to PRED all preceding records<br>of the individual record (with single-subject data, all records of the data set),<br>starting with the ﬁrst such record and up to and including the current record,<br>will be once again passed to PRED (will be &quot;repeated&quot;). The value 1 is put<br>onto the top of the repetition stack.<br>
In addition, for the repetition feature to work, it must be enabled at the outset.<br>This will be done if the repeat data item appears in the data set, or if RPTO is<br>set to a nonzero value at ICALL=0 or ICALL=1.<br>
RPTON<br>
With each data record, RPTON may be set by PRED, and it conveys information to<br>NONMEM. When the repetition output value is nonnegative, RPTON is ignored.<br>Otherwise, RPTON may be set to an integer that gives the number of times the repe-<br>tition series initiated by the data record is to be repeated. With the value 0, the series<br>is repeated once. RPTON may be used as a left-hand quantity in $PRED, $PK and<br>$ERROR blocks.<br>
RPTI<br>
RPTI is the &quot;repetition input value&quot;. With each data record, it is set by NONMEM,<br>and it conveys information to PRED. RPTI may be used as a right-hand quantity in<br>$PRED, $PK, $ERROR, $DES, and $AES blocks.<br>
RPTI=0<br>
The record being passed is not &quot;being repeated&quot;.<br>
RPTI!=0<br>
The record being passed to PRED is &quot;being repeated&quot;. The nonzero value is<br>the length of the repetition stack (see above).<br>
By default, with each pass through an individual record (with single-subject data, with<br>each pass through the data set), and with any data record that is being passed for the ﬁrst<br>time and is other than a repetition initiator, the output from PRED is used by NONMEM.<br>If the record is a repetition initiator, NONMEM uses the output from PRED only when<br>the repetition output value n has appeared on the repetition stack for the ﬁrst time (as a<br>result of RPTO being set to -n with this record) and when the record is being passed for<br>the last time before the output value is subsequently removed from the stack. Otherwise,<br>NONMEM ignores all output from PRED, except for the values set for these variables.<br>
For example, in the case where a record is a repetition initiator, as is a subsequent record,<br>where both records set RPTO to -1, and where both records set RPTON to 0, the ﬁrst<br>record is passed (at least) four times, and NONMEM uses the output from the ﬁrst record<br>when it is passed for the second time.<br>
PRDFL<br>
PRDFL is the &quot;PRED output control ﬂag&quot;. With each data record, it may be set by<br>PRED, and it conveys information to NONMEM. PRDFL may be used as a left-<br>hand quantity in $PRED, $PK and $ERROR blocks.<br>
The PRED output control ﬂag is used with very advanced applications with the repe-<br>tition feature. With it, some of the default behaviour for when NONMEM pays<br>
559<br>
<hr>
<A name=565></a>REPETITION DETAILED DESCRIPTIONS<br>
Help Guide<br>
attention to PRED output (see above) - may be overridden.<br>
PRDFL!=1<br>
This signals that the output from PRED with a passed record (except for the<br>values of the repetition variables) is to be ignored by NONMEM.<br>
PRDFL=1<br>
This signals that the output from PRED with a passed record is to be used by<br>NONMEM.<br>
With the PRED output control ﬂag, PRED speciﬁes when it is that NONMEM is to<br>use PRED’s output. However, just as with the default behavior, where during a pass<br>through the data, NONMEM uses the output from a given data record once and once<br>only, with each data record, PRDFL must be set to 1 once and once only, either<br>when the record is passed initially or when it is repeated. Moreover, as with the<br>default behavior, PRDFL can be set to 1 with a given record only after PRDFL has<br>been set to 1 with the previous data record of the individual record (for single-sub-<br>ject data, with the previous data record of the data set).<br>
In addition, for the PRED output control ﬂag to work, it must be enabled at the out-<br>set, i.e., PRDFL must be set to 1 at ICALL=0 or ICALL=1. It may be enabled only<br>when the repetition feature has also been enabled.<br>
Location prior to NONMEM 7: nmpr10<br>
(See <b>repeti1</b>, <b>repeti2</b>)<br>
Help ﬁle repeti1 discusses the following ﬁles in the examples directory:<br>
repeat1.ctl<br>repeat1s.ctl<br>repeat1t.ctl<br>repeatf.ctl<br>
REFERENCES: None.<br>
560<br>
<hr>
<A name=566></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
RPT<br>
RPT DAT A ITEM<br>
MEANING: REPEAT (RPT_) data item<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... RPT_ ...<br>
DISCUSSION:<br>RPT_ labels NONMEM’s repeat data item. The repeat data item is optional. It is used as<br>an alternative way to mark a data record as a repetition base. (For another way of doing<br>this, global &quot;Repetition Variables&quot; RPTI,RPTO,RPTON,PRDFL may be used.)<br>
Permissible values of RPT_ are:<br>
0<br>
The data record is not a repetition base.<br>
n (n between 1 and 5)<br>
The data record is marked as a &quot;repetition base with value n&quot;, i.e. as the ﬁrst of a<br>series of contiguous records of the current individual record (with single-subject<br>data, contiguous records of the data set) which may be repeated.<br>See repeatf.ctl in the examples directory.<br>
(See <b>Repetition_Variables</b>).<br>
REFERENCES: none.<br>
561<br>
<hr>
<A name=567></a>SCALING DETAILED DESCRIPTIONS<br>
Help Guide<br>
SCALING PARAMETER<br>
MEANING: Scaling (S) parameter for PREDPP<br>CONTEXT: Additional PK Parameters<br>
USAGE:<br>$PK<br>
S2= ....<br>
DISCUSSION:<br>
Scaling parameters are used with PREDPP. They are optional additional PK parameters.<br>With NM-TRAN, they are symbolized in the $PK block by reserved variables Sn, where<br>n is the compartment number to which the parameter applies.<br>
For each observation (or at any time other than an observation time for which a prediction<br>is needed), PREDPP computes a prediction available to the ERROR routine. Associated<br>with each observation is an observation compartment. The amount A in the observation<br>compartment at the time of observation, divided by the value of a parameter S, is used as<br>the prediction. The parameter S is called a scaling parameter. There is one such parameter<br>associated with every compartment of the kinetic model (including the output compart-<br>ment).<br>
Scaling parameters are optional in the sense that scaling parameters associated with com-<br>partments with which predictions are not needed may be ignored. The values of scaling<br>parameters that are not computed in PK are always understood to be 1.<br>
A scaling parameter is computed by the PK routine using, if needed, information in the<br>ev ent record.<br>
(See <b>cmt</b>, <b>pcmt</b>, <b>pk</b>, <b>$pk</b>, <b>default_compartment</b>).<br>
With all versions of PREDPP and all ADVAN routines, observations of urine concentra-<br>tion Cu, as well as plasma concentrations Cp, may be included in the data. The default<br>output compartment of all ADVANs may be used to accumulate urine data. This is dis-<br>cussed in Guide V, the Introductory Guide. See<br>
Chapter 6, Section 9, The Output Compartment: Urine Collections and Observations<br>Chapter 7, Secton 4.3.3. Scaling by a Data Item<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide V, section 3.2.2 , 7.4.3<br>REFERENCES: Guide V, section 6.9<br>REFERENCES: Guide V, section 7.4.1<br>REFERENCES: Guide VI, section III.F.1 , V.H<br>
562<br>
<hr>
<A name=568></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SDE<br>
SDE<br>
MEANING: SDE subroutine<br>CONTEXT: NONMEM utility routine<br>
Utility subroutine sde.f90 numerically evaluates SDE ( stochastic differential equations).<br>
USAGE:<br>$SUBROUTINE ADVAN6 TOL=10 DP OTHER=sde.f90<br>
See sde9.ctl, sde9b.ctl and sde.ctl. They, along with the data ﬁles, can be found in the<br>examples directory of the NONMEM 7 distribution medium.<br>
See <b>INTRODUCTION TO NONMEM 7, Repeated Observation Records<br></b>See <b>INTRODUCTION TO NONMEM 7, Stochastic Differential Equation Plug-In</b><br>
REFERENCES: Guide Introduction_7<br>
563<br>
<hr>
<A name=569></a>SHRINKAGE DETAILED DESCRIPTIONS<br>
Help Guide<br>
SHRINKAGE<br>
MEANING: NONMEM’s estimate of inter-subject variance shrinkage<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>
Shrinkage data are included in the results between #TERM and #TERE.<br>
With NONMEM 7.3, these are<br>ETAshrink<br>EBVshrink<br>EPSshrink<br>
For details, see the NONMEM 7 guide.<br>
With NONMEM 7.4, these are<br>ETAshrinkSD (called ETAshrink in NM73)<br>ETAshrinkVR<br>EBVshrinkSD (called EBVshrink in NM73)<br>EBVshrinkVR<br>EPSshrinkSD (called EPSshrink in NM73)<br>EPSshrinkVR<br>
For details, see the NONMEM 7.4 guide<br>
With NM73 and later, option ETASTYPE=1 in the $EST record, will average shrinkage<br>information only among individuals that provided a non-zero derivative of their data like-<br>lihood with respect to that eta, and will not include subjects with a non-inﬂuential eta,<br>that is in which the derivative of the data likelihood is zero.<br>
Furthermore, you may specify eta i of particular subjects to be excluded or included using<br>reserved variable ETASXI(i). (ETASXI stands for eta shrinkage exclude/include).<br>(See <b>etasxi</b>).<br>
Shrinkage data are also given in ﬁle root.shk File root.shm is a shrinkage map describing<br>which etas were included or excluded in the eta shrinkage assessment.<br>
REFERENCES: Guide Introduction_7<br>
564<br>
<hr>
<A name=570></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIGNAL<br>
SIGNAL<br>
MEANING: SIGNAL program<br>CONTEXT: NONMEM run<br>
Program SIGNAL is a NONMEM utility program. It allows the user to send a signal to<br>NONMEM while it is running.<br>
USAGE:<br>signal X<br>
The following signals may be sent:<br>
Print toggle: J,R, or P<br>Paraprint toggle: B,A, PA, or PP<br>Next: K or N<br>Stop: E or S<br>Subject Print toggle: T, U, or SU<br>
DISCUSSION:<br>
Sometimes NONMEM does not respond to user input via the ctrl key. This may occur<br>during a parallel distribution run using MPI, or if the user began NONMEM with the<br>-background switch. The user may open another console window, copy the program sig-<br>nal.exe (signal in UNIX) from the NONMEM util directory to your run directory, then<br>enter any one of these commands:<br>
Print toggle (monitor estimation progress):<br>signal J<br>signal R<br>signal P<br>
Paraprint toggle (monitor parallel processing trafﬁc):<br>signal B<br>signal A<br>signal PA<br>signal PP<br>
Next (move on to next estimation mode or next estimation): signal K signal N<br>
Stop (end the present run cleanly):<br>signal E<br>signal S<br>
Subject print toggle:<br>signal T<br>signal U<br>signal SU<br>
These create one of these ﬁles in the current (run) directory:<br>sig.print<br>sig.paraprint<br>sig.next<br>sig.stop<br>sig.subject<br>
The multiple signals are synonyms. For example, ctrl-T is the keyboard switch, so signal<br>t should match this. Also, since it is a subject toggle, signal s or signal su are synonyms,<br>
565<br>
<hr>
<A name=571></a>SIGNAL DETAILED DESCRIPTIONS<br>
Help Guide<br>
suggesting Subject.<br>
The signal command creates the signal ﬁles, and the nonmem program detects the signal<br>ﬁle, and immediately deletes it.<br>
A second argument is permitted to specify the run directory, in case you are not executing<br>the signal program from the run directory.<br>signal N ˜/nonmem/<br>
REFERENCES: Guide Introduction_7<br>
566<br>
<hr>
<A name=572></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIGNIFICANT<br>
SIGNIFICANT DIGITS FROM EST. STEP<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_REAL, ONLY NSIG=&gt;SIGD,SIG=&gt;DIFA<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LPAR,DPSIZE<br>
REAL(KIND=DPSIZE) :: SIGD,DIFA(LPAR)<br>
DISCUSSION:<br>
SIG(i)<br>
When the minimization in the Estimation Step terminates due to rounding errors, but the<br>number of signiﬁcant digits that is achieved is reported, the ith value in SIG gives the<br>number of signiﬁcant digits for the ith UCP element.<br>
NSIG<br>
NSIG gives the minimum of the values found in the vector SIG<br>
The NSIG and SIG values should only be used with ICALL = 3.<br>
Location prior to NONMEM 7: rocm16<br>
REFERENCES: None.<br>
567<br>
<hr>
<A name=573></a>SIMEPS DETAILED DESCRIPTIONS<br>
Help Guide<br>
SIMEPS<br>
MEANING: SIMEPS subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: DPSIZE,LVR<br>
REAL(KIND=DPSIZE):: EPS(LVR)<br>
CALL SIMEPS (EPS)<br>
DISCUSSION:<br>The NONMEM utility routine SIMEPS can be called by PRED during the simulation<br>step, to obtain simulated epsilon values. It may be called only when ICALL=4.<br>
Output argument:<br>
EPS<br>
An array into which SIMEPS stores simulated epsilon values EPS(1), EPS(2), ....<br>The dimension of the array may be smaller than the maximum, e.g., it may equal the<br>number of epsilons in the problem.<br>
Simulated epsilon values arise from a multivariate normal pseudo-random distribution<br>with mean 0 and variance-covariance as speciﬁed for SIGMA. With different calls to<br>SIMEPS with different level-two records, new and different simulated epsilon values are<br>obtained.<br>(A level-two record has the same value of L2 and may also be called an L2 record.)<br>(See <b>L2</b>).<br>(When the L2 data item is not deﬁned, all data records are level-two records, and so dif-<br>ferent data records are different level-two records.) By default, with different calls to<br>SIMEPS with the same level-two record, the same simulated epsilon values are obtained -<br>those obtained at the ﬁrst call with the record. (There is an advanced feature whereby<br>records are &quot;repeated&quot;<br>(See <b>Repetition_Variables</b>),<br>and when records of a level-two record are being repeated, with different calls to SIMEPS<br>with the same level-two record, the values obtained are the last values stored in these<br>variables when the record was previously passed to PRED.)<br>
If, though, the NEW option is used with the ﬁrst random source on the $SIMULATION<br>record, then each time SIMEPS is called (with the same or different level-two record),<br>new and different values are obtained. With any particular call to SIMEPS, the effect of<br>the NEW option can, though, be overridden;<br>(See <b>Simulation:_IETAOL_IEPSOL</b>)<br>
So that simple simulation can be easily implemented with abbreviated code, values of<br>epsilon are obtained by calls to SIMEPS occurring in the generated subroutine. When the<br>data are population data and the Simulation Step is implemented, SIMEPS is called once<br>with every call to PRED (or once at every call to ERROR if PREDPP is used). These<br>calls are implemented so that even if, initially, the Simulation Step is not implemented,<br>the NONMEM executable resulting from using an abbreviated code for PRED (or for<br>ERROR if PREDPP is used) can be reused with a run implementing the Simulation Step.<br>
Additional calls to SIMEPS may appear in simulation blocks of $PRED and $ERROR<br>abbreviated code.<br>There is an analogous routine SIMETA. (See <b>simeta</b>).<br>
568<br>
<hr>
<A name=574></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIMEPS<br>
REFERENCES: Guide IV, section III.B.13<br>REFERENCES: Guide V, section 12.4.8<br>REFERENCES: Guide VI, section IV.B.1 , IV.B.2 , Figure 10<br>
569<br>
<hr>
<A name=575></a>SIMETA<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
SIMETA<br>
MEANING: SIMETA subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: DPSIZE,LVR<br>
REAL(KIND=DPSIZE):: ETA(LVR)<br>
CALL SIMETA (ETA)<br>
DISCUSSION:<br>The NONMEM utility routine SIMETA can be called by PRED during the simulation<br>step, to obtain simulated eta values. It may be called only when ICALL=4.<br>
Output argument:<br>
ETA<br>
An array into which SIMETA stores simulated eta values ETA(1), ETA(2), ... The<br>dimension of the array may be smaller than the maximum, e.g., it may equal the<br>number of etas in the problem.<br>
Simulated eta values arise from a multivariate normal pseudo-random distribution with<br>mean 0 and variance-covariance as speciﬁed for OMEGA. With different calls to<br>SIMETA with different individual records, new and different simulated eta values are<br>obtained.<br>(With population data, an individual record has the same value of ID and may also be<br>called a level-one &quot;L1&quot; record.) (See <b>ID</b>).<br>By default, with different calls to SIMETA with the same individual record, the same<br>simulated eta values are obtained - those obtained at the ﬁrst call with the record. (There<br>is an advanced feature whereby records are &quot;repeated&quot;<br>(See <b>Repetition_Variables</b>),<br>and when records of an individual record are being repeated, with different calls to<br>SIMETA with the same individual record, the values obtained are the last values stored in<br>these variables when the record was previously passed to PRED.)<br>
If, though, the NEW option is used with the ﬁrst random source on the $SIMULATION<br>record, then each time SIMETA is called (with the same or different individual record),<br>new and different values are obtained. Thus, for example, when PRED is called with the<br>ﬁrst data record of an individual record, PRED can in turn call SIMETA multiple times<br>until values are obtained such that, for example, ETA(2) is not larger than 5 in absolute<br>value; that is, values can be obtained from a truncated distribution (see below). With any<br>particular call to SIMETA, the effect of the NEW option can, though, be overridden;<br>(See <b>Simulation:_IETAOL_IEPSOL</b>)<br>So that simple simulation can be easily implemented with abbreviated code, values of<br>etas are obtained by calls to SIMETA occurring in the generated subroutine. When the<br>data are population data, SIMETA is called once per individual record by PRED (or PK if<br>PREDPP is used). (In the case of PK, the array of etas is stored in a common and is<br>available to the ERROR subroutine as well.) When the data are single-subject data,<br>SIMETA is called once at every call to PRED (once at every call to ERROR if PREDPP<br>is used).<br>
These calls are implemented so that even if, initially, the Simulation Step is not imple-<br>mented, the NONMEM executable resulting from using an abbreviated code for PRED<br>(for PK or ERROR if PREDPP is used) can be reused with a run implementing the<br>
570<br>
<hr>
<A name=576></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIMETA<br>
Simulation Step.<br>
EXAMPLES OF USAGE:<br>
In this example, the value of ETA(2) used by PRED will be less than 5 in absolute value.<br>For this code to have the desired effect, the option NEW must be used in the $SIMULA-<br>TION record.<br>
IF (ICALL.EQ.4.AND.NEWIND.NE.2) THEN<br>
DO WHILE (ABS(ETA(2)).GT.5)<br>CALL SIMETA (ETA)<br>ENDDO<br>
ENDIF<br>
Suppose there are two etas to be selected in this manner. Each one needs its own CALL<br>SIMETA loop, because each CALL SIMETA replaces all the etas.<br>
IF (ICALL.EQ.4.AND.NEWIND.NE.2) THEN<br>
DO WHILE (ABS(ETA(2)).GT.5)<br>CALL SIMETA (ETA)<br>ENDDO<br>ETA2=ETA(2)<br>DO WHILE (ABS(ETA(1)).GT.0.52)<br>CALL SIMETA (ETA)<br>ENDDO<br>ETA1=ETA(1)<br>
ENDIF<br>
Another way this can be implemented is as follows:<br>
IF (ICALL.EQ.4.AND.NEWIND.NE.2) THEN<br>
DO WHILE(ABS(ETA(2)).GT.5.OR.ABS(ETA(1)).GT.0.52)<br>CALL SIMETA (ETA)<br>ENDDO<br>ETA2=ETA(2)<br>ETA1=ETA(1)<br>
ENDIF<br>
There is an analogous routine SIMEPS. (See <b>simeps</b>).<br>
REFERENCES: Guide IV, section III.B.13 , IV.I<br>REFERENCES: Guide V, section 12.4.8<br>REFERENCES: Guide VI, section III.E.2 , IV.B.2<br>
571<br>
<hr>
<A name=577></a>SIMULATION DETAILED DESCRIPTIONS<br>
Help Guide<br>
SIMULATION BLOCK<br>
MEANING: Abbreviated code for simulation<br>CONTEXT: Abbreviated code<br>
SAMPLE:<br>$PK<br>
IF (ICALL.EQ.4) CL=THETA(1)+ETA(1)<br>
DISCUSSION:<br>A &quot;simulation block&quot; is a block of abbreviated code that is only executed when ICALL=4<br>(during simulation). Such blocks may be present in $PK, $ERROR, and $PRED, and<br>may be implemented by means of generated FORTRAN subroutines. E.g.,<br>
IF (ICALL.EQ.4) THEN<br>
... simulation block ...<br>
ENDIF<br>
Special rules apply to such blocks.<br>
1) No eta derivatives are computed in a simulation block.<br>
2) Transgeneration is permitted. NM-TRAN allows a data item label to appear on the<br>
left of an assignment statement. NM-TRAN generates assignment statements<br>changing ﬁrst the data item in the event or data record, and then the local variable<br>having that label. E.g., suppose WT is listed in $INPUT:<br>
IF (ICALL.EQ.4) WT=70+70*ETA(3)<br>
The generated code is:<br>
IF(ICALL.EQ.4.D0)THEN<br>
EVTREC(NVNT,8 )=70.D0+70.D0*ETA(03)<br>
WT=EVTREC(NVNT,08)<br>
ENDIF<br>
NONMEM and PREDPP reserved data items should not be modiﬁed during simula-<br>tion. Transgeneration is permitted with simulation with subproblems. With all ver-<br>sions of NONMEM, the data set for each subproblem after the ﬁrst is the same data<br>set used by the previous subproblem, and includes any changes (transgeneration)<br>made by the previous subproblem.<br>
3) Calls to certain NONMEM routines are permitted:<br>
CALL SIMETA(ETA)<br>
CALL SIMEPS(EPS)<br>
CALL RANDOM(n,R)<br>where n is an integer 1-10. If CALL RANDOM is present, R becomes a reserved<br>variable used for the random number.<br>
Note that NM-TRAN provides the necessary calls to SIMETA and SIMEPS in gen-<br>erated routines. Explicit calls are used in abbreviated code only to obtain different<br>values of ETA and EPS.<br>
4) A RETURN statement may be used. If in $ERROR or $PRED, and the RETURN<br>
occurs in a simulation block, then Y may be assigned a value prior to the return. If<br>so, then F is set (F=Y); otherwise F is not set.<br>
5) Loops are permitted. The syntax is as follows.<br>
572<br>
<hr>
<A name=578></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIMULATION<br>
DO WHILE (condition)<br>
.. statements ..<br>
END DO<br>
Here are two examples.<br>
IF (ICALL.EQ.4.AND.NEWIND.NE.2) THEN<br>
DO WHILE (ETA(1).GT..5.OR.ETA(1).LT.-.5)<br>
CALL SIMETA(ETA)<br>
ENDDO<br>
ENDIF<br>
IF (ICALL.EQ.4) WT=70+70*ETA(1)<br>
(With this ﬁrst example, the ﬁrst random seed of the $SIMULATION record must have<br>the NEW option. Note also that, because of the previous automatic call to SIMETA,<br>ETA(1) requires no initialization, but that R in the next example does.)<br>
IF (ICALL.EQ.4.AND.NEWIND.NE.2) THEN<br>
R=1<br>
DO WHILE (R.GT..5.OR.R.LT.-.5)<br>
CALL RANDOM(2,R)<br>
ENDDO<br>
ENDIF<br>
IF (ICALL.EQ.4) WT=70+70*R<br>
The third example illustrates how a categorical variable with equal-likely probabilities<br>can be generated from a random number R, uniformly distributed between 0 and 1. In<br>this example, the categorical variable BIN takes values 1 through 5.<br>
IF (ICALL.EQ.4) THEN<br>
CALL RANDOM(2,R)<br>
BIN=INT(R*5)+1<br>
ENDIF<br>
The number 5 can be replaced with any other positive integer n to obtain an n-valued cat-<br>egorical variable. Here INT is the function that transforms a nonnegative number x into<br>the greatest integer not exceeding x. The effect of this simulation code is to perform the<br>transformation:<br>
BIN=1 if R &lt; .2<br>BIN=2 if R &lt; .4 and R &gt;= .2<br>BIN=3 if R &lt; .6 and R &gt;= .4<br>BIN=4 if R &lt; .8 and R &gt;= .6<br>BIN=5 if R &lt; 1 and R &gt;= .8<br>
(See <b>abbreviated</b>).<br>
REFERENCES: Guide IV, section III.B.13 , IV.I<br>REFERENCES: Guide V, section 12.4.8<br>REFERENCES: Guide VI, section III.E.2 , IV.B.2<br>
573<br>
<hr>
<A name=579></a>SIMULATION: DETAILED DESCRIPTIONS<br>
Help Guide<br>
SIMULATION: ETA,EPS<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPRD_REAL, ONLY: ETA,EPS<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: ETA(LVR),EPS(LVR)<br>
DISCUSSION:<br>
When the ONLYSIMULATION option on the $SIMULATION record is used, the dis-<br>played eta values are those that PRED stores in ETA during the Simulation Step (i.e., at<br>ICALL=4).<br>
In generated subroutines, eta values are automatically stored in ETA, and thus automati-<br>cally, the simulated etas are displayable.<br>
When using the PRED repetition feature, epsilon values generated in PRED for simula-<br>tion purposes (with or without the use of the ONLYSIMULATION option) should be<br>stored in EPS. Then when records are repeated, these same epsilons values will be avail-<br>able in EPS as input. In particular, with every repeated record, the values that were stored<br>in EPS the last time the record was passed, are made available as input to PRED.<br>
In generated subroutines, epsilon values are automatically stored in EPS, and thus auto-<br>matically, the simulated epsilons are available as input with repeated records.<br>
When using the repetition feature with single-subject data, eta values generated in PRED<br>for simulation purposes should be stored in ETA. What happens in this case is analogous<br>to what happens in the case of population data with epsilon values.<br>
In generated subroutines, eta values are automatically stored in ETA, and thus automati-<br>cally, the simulated etas are available as input with repeated records.<br>
Location prior to NONMEM 7: nmprd7<br>
REFERENCES: None.<br>
574<br>
<hr>
<A name=580></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIMULATION:<br>
SIMULATION: IETAOL IEPSOL<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>USAGE:<br>USE NMPR_INT, ONLY: IETAOL,IEPSOL<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IETAOL,IEPSOL<br>
DISCUSSION:<br>
Values are stored by PRED for use with SIMETA and SIMEPS. They allow the effect of<br>the NEW option on the $SIMULATION record to be overridden, which may be useful<br>when the PRED repetition feature is used. They also allow calls to SIMETA and<br>SIMEPS to be ignored. This may be useful when e.g. a simulation was undertaken with<br>user code where SIMEPS is called with every data record (as happens automatically with<br>NM-TRAN generated codes), and the exact same simulation is now to be repeated, but<br>with a data set obtained from the earlier one by the addition of new nonobservation<br>records (with which SIMEPS output is not needed). If calls to SIMEPS with the new<br>records are not ignored, SIMEPS output will be generated with all the records, and in par-<br>ticular, SIMEPS output will be generated with the original records, which will differ from<br>what it was earlier, thus resulting in the simulation of a different set of observations.<br>
IETAOL<br>
IETAOL=-1: Next call to SIMETA will be ignored<br>
IETAOL=0: Next call to SIMETA will behave as usual.<br>
IETAOL=1: Next call to SIMETA will behave as though NEW had not been speci-<br>ﬁed. If SIMETA has been called previously with the individual record, SIMETA<br>will produce the previous eta values.<br>
IEPSOL<br>
IEPSOL=-1: Next call to SIMEPS will be ignored.<br>
IEPSOL=0: Next call to SIMEPS will behave as usual.<br>
IEPSOL=1: Next call to SIMEPS will behave as though NEW had not been speci-<br>ﬁed. If SIMEPS has been called previously with the level-two record, SIMEPS will<br>produce the previous epsilon values.<br>
Values must be stored before PRED calls SIMETA (SIMEPS). NM-TRAN generated or<br>Library code has a call to SIMETA (SIMEPS) in its second section (see Guide IV). If<br>this call is to be affected, values must be stored using verbatim code in the FIRST block.<br>
Location prior to NONMEM 7: nmpr11.for<br>
REFERENCES: None.<br>
575<br>
<hr>
<A name=581></a>SIMULATION: DETAILED DESCRIPTIONS<br>
Help Guide<br>
SIMULATION: NREP,IREP<br>
MEANING: NONMEM read-only global variables<br>
CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_INT, ONLY: NREP,IREP=&gt;NCREP<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: NREP,NCREP<br>
DISCUSSION:<br>
NREP<br>
The number of replications in the Simulation Step, given by the NSUBS option of<br>the $SIMULATION record.<br>
IREP<br>
The number of the current replication.<br>
These variables may be used as right-hand quantities in abbreviated code for initializa-<br>tion/ﬁnalization blocks.<br>
Location prior to NONMEM 7: rocm10<br>
REFERENCES: None.<br>
576<br>
<hr>
<A name=582></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIMULATION:<br>
SIMULATION: SIMEPS ERROR CODE<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>USAGE:<br>USE NMPRD_INT, ONLY: IERSQ<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IERSQ<br>
DISCUSSION:<br>
Value is stored by SIMEPS for use with PRED and ERROR. Is relevant when correla-<br>tions are stored in CORRL2. Is set to 0 before SIMEPS is called.<br>(See <b>Correlation_Across_L2_Records</b>).<br>
IERSQ<br>
The SIMEPS error return code.<br>IERSQ=0: Normal return<br>IERSQ=1: Correlation matrix obtained using the correlations stored in CORRL2 is<br>not positive deﬁnite.<br>
PRED may attempt corrective action; if it does so successfully, it should reset<br>IERSQ to 0.<br>
(With versions of NONMEM through 7.2, C was used rather than CORRL2.)<br>
With NONMEM 7.3 (and all earlier versions), the value of IERSQ is not checked in gen-<br>erated code.<br>
Location prior to NONMEM 7: nmprd6<br>
REFERENCES: None.<br>
577<br>
<hr>
<A name=583></a>SIZE DETAILED DESCRIPTIONS<br>
Help Guide<br>
SIZE OF INDIVIDUAL RECORD<br>
MEANING: NONMEM read-only globoal variable<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_INT, ONLY: LIREC=&gt;NDATPASS<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: NDATPASS<br>
DISCUSSION:<br>LIREC is The number of data records contained in the individual record at the current<br>call to PRED.<br>
LIREC also changes value appropriately in conjunction with calls to PASS.<br>
LIREC may be used as a right-hand quantity in $PRED, $PK, and $ERROR blocks, and<br>in a $INFN block in conjunction with PASS.<br>
Location prior to NONMEM 7: rocm48<br>
REFERENCES: None.<br>
578<br>
<hr>
<A name=584></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIZES<br>
SIZES FSIZES PRSIZES<br>
MEANING: MODULE for NONMEM and its components.<br>CONTEXT: Source code<br>
DISCUSSION:<br>File SIZES is supplied on the NONMEM distribution media and is copied to the<br>resources directory. It contains FORTRAN PARAMETER statements giving the default<br>values of symbolic parameters used in source code. Constants from SIZES may be incor-<br>porated into the source code by means of the FORTRAN USE statement. Some of these<br>constants describe array sizes.<br>
With NONMEM 7.2 and higher, there are several changes vs. previous releases.<br>
There is only one version of SIZES (i.e., there is no longer a SIZES_reg or<br>SIZES_big).<br>
Many NONMEM and NM-TRAN arrays are allocated dynamically at run time.<br>
NM-TRAN creates a subroutine FSIZESR for NONMEM. FSIZESR contains val-<br>ues for some parameters (e.g., LVR) that are exactly what is needed for the current<br>problem, and contains 0’s for parameters that NM-TRAN cannot assess. Default<br>values for parameters that are 0 in FSIZESR are obtained by NONMEM from the<br>ﬁle SIZES.f90.<br>
Note that ﬁle FSIZES is a convenient reference for users to view, but is not used.<br>SUBROUTINE FSIZESR in FSUBS is what is actually used during the NONMEM<br>run.<br>
NM-TRAN creates a ﬁle prsizes.f90 for PREDPP. PREDPP arrays are allocated<br>statically but may be re-compiled at run time using parameters deﬁned in<br>prsizes.f90. Some constants in prsizes are assessed for the current problem; others<br>are copied from default values in SIZES.f90.<br>
The user may override many of the parameter values in FSIZES and prsizes with the<br>$SIZES record. Any value speciﬁed by $SIZES will override both the default in<br>SIZES.f90 and the value that NM-TRAN would have speciﬁed.<br>(See <b>$sizes</b>)<br>As of NONMEM 7.3, NMTRAN determines the maximum number of observation<br>records (MDV=0) that occur in any subject, among all data ﬁles used in the entire<br>control stream ﬁle. If this value is greater than the NO value listed in SIZES.f90, it<br>will set NO to this larger size. Thus, users no longer have to be conscientious of siz-<br>ing the NO parameter. Howev er, there is no guarantee that NMTRAN will correctly<br>assess NO for the entire scope of the control stream ﬁle for all types of problems.<br>Should this occur, NONMEM may issue an error, and the user will need to set the<br>NO value with a $SIZES record.<br>
Constants that may be changed with $SIZES record:<br>
LTH LVR LVR2 LPAR MMX MAXIDS NO PD MAXOMEG MAXPTHETA<br>
Consants that are also in prsizes:<br>
PC PCT PIR PD PAL MAXFCN<br>
Constants that may not be changed using $SIZES record<br>
LSTEXT MAXXNAME MAXVRESWRES MAXVRESN MXNAME DIMQ PPR PW<br>SD SCO SDF MAX_EXTRA<br>
579<br>
<hr>
<A name=585></a>SIZES DETAILED DESCRIPTIONS<br>
Help Guide<br>
The following is the descriptive comment and value of each parameter in the version of<br>SIZES that is supplied on the NONMEM 7 distribution medium. More information<br>including descriptions of the buffers may be found in the INTRODUCTION TO NON-<br>MEM 7.<br>
NLUSER=100<br>
Maximum number of logical I/O units user may use.<br>
LTH=100<br>
MAX. NO. OF THETA’S. Dynamically sized, or set by user via $SIZES record<br>
LVR=30<br>
MAX. NO. OF ETA’S +   EPS’S. Dynamically sized, or set by user via $SIZES<br>record<br>
LVR2=20<br>
MAX. NO. OF ETA’S PERMITTED WHEN LAPLACIAN METHOD IS USED.<br>Value may be over-ridden by user via $SIZES record<br>
NO=250<br>
MAX NO. OF OBSERVA TION RECORDS / INDIVIDUAL RECORD<br>
MMX=10<br>
MAX NO. OF MIXTURE SUBPOPULATIONS. Dynamically sized, or set by user<br>via $SIZES record<br>
LNP4=4000<br>
SIZE OF COMMON NMPRD4. Value may be over-ridden by user via $SIZES<br>record<br>
LSUPP=4050<br>
MAX. NO. OF POINTS OF SUPPORT WITH NONPARAMETRIC ESTIMATE.<br>Value may be over-ridden by user via $SIZES record<br>
LIM7=2<br>
SIZE OF BUFFER 7. DO NOT GO LOWER THAN 2. Value may be over-ridden<br>by user via $SIZES record<br>
LWS3=9000<br>
SIZE OF WORKING SPACE 3 AT LEAST AS LARGE AS: NS*NOETAS**2,<br>WHERE NS IS THE NO. OF DIRECTIONS USED WITH THE STIELTJES<br>METHOD, AND NOETAS IS THE NUMBER OF ETA’S. Value may be over-rid-<br>den by user via $SIZES record<br>
MAXIDS=10000<br>
MAX. NO. OF INDIVIDUALS IN DAT A SET. Dynamically sized, or set by user<br>via $SIZES record<br>
LIM1=10000<br>
SIZE OF BUFFER 1. Value may be over-ridden by user via $SIZES record<br>
LIM2=100000<br>
SIZE OF BUFFER 2. Value may be over-ridden by user via $SIZES record<br>
LIM3=10000<br>
SIZE OF BUFFER 3. DO NOT GO LOWER THAN 2. Value may be over-ridden<br>by user via $SIZES record<br>
LIM4=1000<br>
SIZE OF BUFFER 4: LIM4=NUMBER OF SUBJECTS. Value may be over-ridden<br>by user via $SIZES record<br>
580<br>
<hr>
<A name=586></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIZES<br>
LIM5=200<br>
SIZE OF BUFFER 5. Value may be over-ridden by user via $SIZES record<br>
LIM6=400<br>
SIZE OF BUFFER 6. Value may be over-ridden by user via $SIZES record<br>
LIM8=200<br>
SIZE OF BUFFER 8. Value may be over-ridden by user via $SIZES record<br>
LIM10=100000<br>
SIZE OF BUFFER 10. Value may be over-ridden by user via $SIZES record<br>
LIM11=25<br>
SIZE OF BUFFER 11. Value may be over-ridden by user via $SIZES record<br>
LIM13=1000<br>
SIZE OF BUFFER 13: LIM13=NUMBER OF SUBJECTS. Value may be over-rid-<br>den by user via $SIZES record<br>
LIM15=1000<br>
SIZE OF BUFFER 15: LIM15=NUMBER OF SUBJECTS. Value may be over-rid-<br>den by user via $SIZES record<br>
LIM16=400<br>
SIZE OF BUFFER 16. Value may be over-ridden by user via $SIZES record<br>
LSTEXT=70000<br>
AT LEAST (MAXOMEG*(MAXOMEG+1)/2+MAXPHETA+5)*NUMTEXT.<br>LSTEXT is maximun number of characters to a single line of the raw output ﬁle<br>speciﬁed by $EST FILE=. where NUMTEXT is number of characters needed to<br>represent a number and its delimiter. For example, FORMAT=,1PE12.5 takes up<br>NUMTEXT=13 characters.<br>
LSFORM=2048<br>
LSFORM is the character length of FORMAT TFORMATL,RFORMATL, pertain-<br>ing to the full length of LFORMAT, RFORMAT for the $TABLE record.<br>
MAXRECID=200<br>
Maximum number of records in any individual record. For use by PREDPP. Value<br>may be over-ridden by user via $SIZES record<br>
PC=30<br>
MAX. NO. OF COMPARTMENTS MAXIMUM IS 99. Value may be over-ridden<br>by user via $SIZES record<br>
PCT=30<br>
MAX. NO. OF MODEL EVENT TIMES. Value may be over-ridden by user via<br>$SIZES record<br>
PCT_BIG=10000<br>
MAX. NO. OF MODEL EVENT TIMES THAT NMTRAN CAN PROCESS.ˆM !<br>PG: SIZE OF GG; MAX. NO. OF BASIC+ADDITIONAL PK PARAMS.ˆM !<br>(MAXIMUM IS PCT+99)ˆM<br>
PIR=700<br>
SIZE OF COMPACT DA/DP/DT ARRAYS. Value may be over-ridden by user via<br>$SIZES record<br>
PD=50<br>
CHANGED TO INCREASE DAT A ITEMS PER DAT A RECORD FROM 20 TO 50<br>IT IS ALSO SIZE OF VDATREC DAT A ARRAY. THIS IS DONE TO SEPARATE<br>
581<br>
<hr>
<A name=587></a>SIZES DETAILED DESCRIPTIONS<br>
Help Guide<br>
VDATREC AND VRESWRES VARIABLES/ Dynamically sized, or set by user via<br>$SIZES record.<br>
MAXIC=90<br>
MAXIC: MAXIMUM NUMBER OF ACTIVE INFUSIONS FOR PREDPP. Value<br>may be over-ridden by user via $SIZES record<br>
PDT=500<br>
MAXIMUM NUMBER OF TABLE ITEMS/PRED-DEFINED ITEMS. Value may<br>be over-ridden by user via $SIZES record<br>
PAL=50<br>
NO. OF ADDITIONAL AND LAGGED DOSES. Value may be over-ridden by<br>user via $SIZES record<br>
MAXFCN=1000000<br>
MAX. NO. OF CALLS IN GENERAL NON-LINEAR MODELS IMAX IN MOD-<br>ULE PRCOM_INT OVERRIDES. Value may be over-ridden by user via $SIZES<br>record<br>
STIELTJ_SIZE=101<br>
The next four are for internal use, pertaining to various additional weighted residual<br>diagnostics<br>
MAXXNAME=40<br>
MAXVRESWRES=39<br>
MAXVRESN=9<br>
MXNAME=40<br>
DIMTMP=500<br>
RELATED TO THE NUMBER OF USER-DEFINED VARIABLES. Value may be<br>over-ridden by user via $SIZES record<br>
DIMCNS=500<br>
RELATED TO THE TOTAL NUMBER OF CONSTANTS. Value may be over-rid-<br>den by user via $SIZES record<br>
DIMNEW=1000<br>
RELATED TO THE TOTAL NUMBER OF INTERMEDIATE VARIABLES. Value<br>may be over-ridden by user via $SIZES record<br>
DIMQ=99999<br>
ARRAY SIZE FOR LOGICAL CONDITIONS<br>
FL=41<br>
LOGICAL UNIT NUMBER FOR FLIB<br>
DIMVRB=1000<br>
MAX. NO. OF LINES OF VERBATIM CODE<br>
PL=10<br>
MAXIMUM DEPTH OF NESTED IF STATEMENTS<br>
NFUNCX=100<br>
MAXIMUM NUMBER OF USER FUNCTIONS.<br>
NVECX=100<br>
MAXIMUM NUMBER OF USER VECTORS.<br>
MAXOTHER=1000<br>
Maximum number of ﬁlenames listed on $SUBROUTINE OTHER=ﬁlename<br>
582<br>
<hr>
<A name=588></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SIZES<br>
SD=30<br>
LENGTH OF DAT A LABEL<br>
FSD=67000<br>
LENGTH OF CONTROL STREAM FILE STRING (ALSO, MULTIPLE LINES<br>CONCATENATED WITH &amp; MAY NOT EXCEED FSD)<br>
FSD1=67001<br>
LENGTH OF CONTROL STREAM FILE STRING<br>
SCO=30<br>
STRING LENGTH OF NUMBER IN $THETA, $OMEGA, $SGIGMA RECORDS.<br>
SDF=24<br>
LENGTH OF DAT A ITEM<br>
NFSIZES=48<br>
NUMBER OF ITEMS LISTED IN FSIZES FILE<br>
NPRSIZES=12<br>
NUMBER OF PREDPP ITEMS IN PRSIZES.F90<br>
CONSTANTS FOR Monte Carlo, EM methods<br>
MAX_EXTRA=20<br>
Numer of $EST statements allowed per problem<br>
NPOPMIXMAX=10<br>
Now dynamically sized to MAXIMUM NUMBER OF SUB-POPULATIONS FOR<br>MIXTURE MODELS MMX. Or, set by user via $SIZES record<br>
MAXOMEG=70<br>
Now dynamically sizes to LVR, OR MAXIMUM OMEGA DIMENSION ETAS.<br>Or, set by user via $SIZES record (but should be left alone)<br>
MAXPTHETA=90<br>
Now dynamically sized to LTH, MAXIMUM NUMBER OF THETA, PLUS<br>LOWER TRIANGLE OF SIGMA. THUS, IF NUMBER OF THETAS IS N, AND<br>DIMENSION OF SIGMAS IS M, THEN NEED MAXPTHETA=N + M*(M+1)/2.<br>OR, may be set by user via $SIZES record (but should be left alone).<br>
MAXITER=210<br>
Maximum number of previous iterations to incorporate into Monte Carlo conver-<br>gence tests Effective CITER is &lt;=MAXITER<br>
ISAMPLEMAX=10<br>
FOR SAEM METHOD, EFFECTIVE ISAMPLE&lt;=ISAMPLEMAX<br>
MAXSIDS=100<br>
MAXIMUM NUMER OF SUPER ID ITEMS IN DAT A SET<br>
MAXSIDL=0<br>
MAXIMUM LEVEL OF SUPER IDS. MAXSIDL=0 MEANS NO SUPER IDS.<br>Default 0, until $LEVEL is used, in which case it will be dynamically sized.<br>
MAXFTEXT=100<br>
Maximum of PRDERR message lines<br>
PNM_MAXNODES=100<br>
MAXIMUM NUMBER OF PARALLELIZATION NODES<br>
PNM_BUFFER_SIZE=100000<br>
INTERNAL BUFFER SIZE, FOR EFFICIENT PACKAGING AND SENDING<br>
583<br>
<hr>
<A name=589></a>SIZES DETAILED DESCRIPTIONS<br>
Help Guide<br>
BETWEEN PROCESSES<br>
LEV=’7.4.0 ’<br>
The LEV constant in MODULE VERSION should not be changed by the user.<br>
REFERENCES: Guide III, section V.3.0<br>REFERENCES: Guide Introduction_7<br>
584<br>
<hr>
<A name=590></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SKIP<br>
SKIP<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPR_INT, ONLY SKIP_=&gt;SKIP<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: SKIP<br>
DISCUSSION:<br>
The SKIP_ variable controls premature termination of a problem (with subproblems),<br>superproblem or superproblem iteration. It may be set as follows during (sub)problem-<br>ﬁnalization.<br>
SKIP_=1<br>
With a subproblem: terminate the entire problem and proceed to the next problem, if<br>this exists.<br>
SKIP_=2<br>
With a problem during an iteration of a second-level superproblem A nested within a<br>ﬁrst-level superproblem B: terminate the iteration and proceed to the next iteration,<br>if this exists, and if this does not exist, to the following (second-level super)problem<br>of B, if this exists, and if this does not exist, to the next iteration of B.<br>
SKIP_=3<br>
With a problem during an iteration of a second-level superproblem A nested within a<br>ﬁrst-level superproblem B: terminate the entire superproblem A and proceed to the<br>following (second-level super)problem of B, if this exists, and if this does not exist,<br>to the next iteration of B.<br>
SKIP_=4<br>
With a problem during an iteration of a ﬁrst-level superproblem: terminate the itera-<br>tion and proceed to the next iteration, if this exists, and if this does not exist, to the<br>following (ﬁrst-level super)problem, if this exists.<br>
SKIP_=5<br>
With a problem during an iteration of a ﬁrst-level superproblem: terminate the entire<br>superproblem and proceed to the following (ﬁrst-level super)problem, if this exists.<br>
With NM-TRAN, in a ﬁnalization block of abbreviated code one may set SKIP_ and/or<br>use the following phrases:<br>
END PROBLEM<br>
(same as SKIP_=1)<br>
END SECOND-LEVEL SUPERPROBLEM<br>
(same as SKIP_=3)<br>
END FIRST-LEVEL SUPERPROBLEM<br>
(same as SKIP_=5)<br>
END SECOND-LEVEL SUPERPROBLEM ITERATION<br>
(same as SKIP_=2)<br>
END FIRST-LEVEL SUPERPROBLEM ITERATION<br>
(same as SKIP_=4)<br>
E.g. The following are all equivalent:<br>
A.<br>
SKIP_=2<br>
585<br>
<hr>
<A name=591></a>SKIP DETAILED DESCRIPTIONS<br>
Help Guide<br>
B.<br>
IF (...) THEN<br>
END SECOND-LEVEL SUPERPROBLEM ITERATION<br>
ENDIF<br>
C.<br>
IF (...) THEN<br>
ENDSECONDLEVELSUPERPROBLEMITERATION<br>
ENDIF<br>
Location prior to NONMEM 7: nmpr15<br>
REFERENCES: None.<br>
586<br>
<hr>
<A name=592></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SPTWO<br>
SPTWO<br>
MEANING: SPTWO subroutine<br>CONTEXT: User-supplied subroutine; replaces a NONMEM dummy routine<br>
This feature is not fully documented. The interested user may be able to obtain more<br>information by studying the appropriate sections of NONMEM code and previous exam-<br>ples that may be available from advanced users.<br>
USAGE:<br>SUBROUTINE SPTWO (ICALL,I1,I2,NROB,D,IER)<br>
USE SIZES, ONLY: ISIZE,DPSIZE,NO<br>
INTEGER(KIND=ISIZE), INTENT(IN)<br>
:: NROB,ICALL<br>
INTEGER(KIND=ISIZE), INTENT(IN OUT) :: I1,I2,IER<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: D(NO,2)<br>
DISCUSSION:<br>SPTWO is used to redeﬁne the meaning of the RES and WRES items for observation<br>records within an individual record. It is called with each individual record. The labels<br>’RES’ and ’WRES’ can be changed, as usual.<br>
Input argument:<br>
ICALL<br>
Similar to ICALL for PRED subroutine.<br>Possible values: 0, 1, 2<br>
NROB<br>
Number of observation records in the individual record.<br>
Output argument:<br>
I1,I2<br>
When SPTWO is used, by default, I1 and I2 are 0, meaning zero lines are not to be<br>generated through RES or WRES values on scatterplots. If zero lines through RES<br>or WRES values on scatterplots are desired, SPTWO should set I1 or I2, respec-<br>tively, to 1.<br>
D(J,1)<br>
Value of RES for Jth observation record, J=1,...,NROB.<br>
D(J,2)<br>
Value of WRES for Jth observation record, J=1,...,NROB<br>
IER<br>
Error indicator.<br>0 - Normal return.<br>non-zero - NONMEM should stop.<br>
Other Inputs:<br>
NONMEM read-only global variables.<br>(See <b>MIX:_DAT A</b>)<br>(See <b>CONTR:_III,DIM</b>)<br>(See <b>CONTR:_F,G,H</b>)<br>(See <b>Non-active_ETA_list_for_PRED</b>)<br>(See <b>Parameters_OMEGA_SIGMA:_Current</b>)<br>(See <b>Record_Counters:_NIREC,NDREC</b>)<br>
587<br>
<hr>
<A name=593></a>SPTWO<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
REFERENCES: None.<br>
588<br>
<hr>
<A name=594></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SS<br>
SS DAT A ITEM<br>
MEANING: Steady-State (SS) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... SS ...<br>
DISCUSSION:<br>SS labels PREDPP’s steady-state (SS) data item. The steady-state data item is optional.<br>It can take one of three values in any event record.<br>
0<br>
indicates that the dose is not a steady state dose.<br>
1<br>
indicates that the dose is a steady state dose, and that the compartment amounts are<br>to be reset to the steady-state amounts resulting from the given dose. Compartment<br>amounts resulting from prior dose event records are &quot;zeroed out,&quot; and infusions in<br>progress or pending additional doses are cancelled. The system is not totally reset:<br>the on/off status of the compartments remains as it was at the time of the prior event<br>record (if any), and the value of time must be greater than or equal to its value on the<br>prior event record (if any).<br>
2<br>
indicates that the dose is a steady state dose and that the compartment amounts are<br>to be set to the sum of the steady-state amounts resulting from the given dose plus<br>whatever those amounts would have been at the event time were the steady-state<br>dose not given. I.e., letting t be the time on the event record, then the amounts in the<br>compartments are updated to amounts valid for time t, and next, these amounts are<br>added to the steady-state amounts. This is meaningful when kinetics are linear and<br>the superposition principle holds.<br>
3<br>
indicates that the dose is a steady state dose. SS = 3 is identical to SS = 1 with one<br>exception: with Steady State routines SS6 and SS9, the existing state vector (com-<br>partment amounts and eta derivatives) is used as the initial estimate in the computa-<br>tion of the steady-state amounts. The user supplies the initial estimate with some<br>combination of prior event records, e.g., reset, transient dose, and other-type event<br>records.<br>
When the SS data item is used, one or more of the data items AMT, RATE, and II must<br>be present in the event record to specify the steady state dosing pattern.<br>
REFERENCES: Guide VI, section V.F<br>REFERENCES: Guide V, section 6.8<br>
589<br>
<hr>
<A name=595></a>SS DETAILED DESCRIPTIONS<br>
Help Guide<br>
SS DOSE EVENT RECORD<br>
MEANING: Speciﬁcation of steady-state dose for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
DISCUSSION:<br>PREDPP recognizes two varieties of doses, transient and steady-state. Transient doses<br>are described separately (See <b>dose_event</b>). Steady-state doses are described here.<br>
A steady-state dose is a dose that is imagined to be the last of a series of implied doses,<br>each exactly like the dose in question, given at a regular interval speciﬁed by the II data<br>item and leading to steady-state by the time the steady-state dose is given.<br>
For steady-state doses, the SS data item must be deﬁned and positive (See <b>ss_data_item</b>).<br>
The ADDL data item may be used on the SS dose event record to specify additional tran-<br>sient doses after the steady-state dose, given at the interval II.<br>
The CMT data item (See <b>cmt</b>) applies to steady-state doses as to transient doses.<br>
PK parameters absorption lag (ALAGn), bioavailability (Fn), modeled rates (Rn) and<br>modeled durations (Dn) apply to steady-state doses as they do to transient doses, except<br>as noted.<br>
When absorption lag applies, it is understood to apply to all implied doses. Steady-state<br>is computed as if there were no ALAG, and then there is an advance to the appropriate<br>point in the steady-state cycle (II-ALAG).<br>See <b>Guide VI, Section V.F.4, Note 4</b><br>
MTIME parameters do not apply to steady-state doses.<br>See <b>Guide VI, Section V.F.4, Note 3</b><br>
When bioavailability applies, it is understood to apply to all implied doses.<br>
Values of AMT, RATE, II data items:<br>
AMT RATE II<br>
&gt;0 0<br>
&gt;0 Steady-state with multiple bolus doses.<br>
&gt;0 &gt;0<br>
&gt;0 Steady-state with multiple infusions.<br>
The ﬁnal infusion is started at the event time of the SS dose<br>record and continues beyond its event time. (More than one<br>infusion continues when the duration of the steady-state infusion<br>is greater than II.)<br>
&gt;0 -1,-2<br>
&gt;0 Steady-state with multiple zero-order bolus doses.<br>
The ﬁnal infusion is started at the event time of the SS dose<br>record and continues beyond its event time. (More than one<br>infusion continues when the duration of the steady-state infusion<br>is greater than II.)<br>
0<br>
0,&gt;0,-1 0<br>
Steady-state with constant infusion.<br>
590<br>
<hr>
<A name=596></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SS<br>
The infusion terminates at the event time of the SS dose record.<br>The ADDL data item cannot be used to specify additional tran-<br>sient doses. Doses with rate 0 are useful when the differential<br>equations coded by the user explicitly provide for endogenous<br>drug production.<br>(The Initial Steady State feature (I_SS) may be speciﬁed in the<br>model instead of using a steady-state dose record with rate 0.)<br>
REFERENCES: Guide VI, section V.F<br>REFERENCES: Guide V, section 6.8<br>
591<br>
<hr>
<A name=597></a>SS DETAILED DESCRIPTIONS<br>
Help Guide<br>
SS OPTION<br>
MEANING: Choice of Steady-State Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES ... [SS=]name<br>
SAMPLE:<br>$SUBROUTINE ADVAN=ADVAN6 SS=SS6<br>
DISCUSSION:<br>The SS option tells NM-TRAN that a SS routine should be included in the NON-<br>MEM/PREDPP executable. It is optional.<br>
PREDPP contains a library of routines, including SS routines to compute steady-state<br>kinetics. The SS routines all have the same entry name, SS. Most analytic ADVAN rou-<br>tines have a corresponding speciﬁc SS routine except for ADVAN8 and ADVAN10, for<br>which SS6 is used.<br>
If the SS data item is present in the $INPUT record, then an SS routine is required in the<br>NONMEM/PREDPP executable. NM-TRAN will supply the SS option of the $SUB-<br>ROUTINES record if it is not present. The default pairing of ADVAN and SS routines is:<br>
ADVAN1-SS1 ; ADVAN2-SS2 ; ADVAN3-SS3 ; ADVAN4-SS4<br>ADVAN5-SS5 ; ADVAN6-SS6 ; ADVAN7-SS7 ; ADVAN8-SS6<br>ADVAN9-SS9 ; ADVAN10-SS6 ADVAN11-SS11 ; ADVAN12-SS12<br>ADVAN13-SS6; ADVAN14-SS6; ADVAN15-SS9<br>
(With versions prior to NONMEM 7.4, SS13 was used with ADVAN13. See ADVAN13<br>help entry for other changes to ADVAN13.)<br>
The SS option can be used to request creation of a NONMEM/PREDPP executable which<br>contains an SS routine even though the current data set does not contain the SS data item.<br>
The only real effect of the SS option is to list the name of the desired SS routine in NM-<br>TRAN’s FREPORT ﬁle. The actual construction of the executable is the users responsi-<br>bility.<br>
When the SS option is not included on the $SUBROUTINES record, and the SS data<br>item does not appear on the $DAT A record, then NM-TRAN lists the null SSS routine<br>(SSS0) in FREPORT and no SS routine is listed. Otherwise, NM-TRAN lists the (non-<br>null) SSS routine (&quot;Supervisor of Steady-State&quot;) and the appropriate SS routine.<br>
The nmfe and nmfe.bat commands automatically include the listed SSS and SS routines<br>in the NONMEM executable.<br>
REFERENCES: Guide VI, section VII<br>
592<br>
<hr>
<A name=598></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SS6<br>
SS6 SS9<br>
MEANING: Choice of Steady-State Routine for General Nonlinear Kinetics in PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [SS=]SS6<br>
SAMPLE:<br>$SUBROUTINE SS6<br>
DISCUSSION:<br>The SS6 subroutine computes steady-state kinetics in a very general way and may be<br>used with any choice of ADVAN (other than ADVAN9 and ADVAN15, with which only<br>SS9 can be used). With NONMEM 7.4, SS6 is the only steady-state routine that can be<br>used with ADVAN6, ADVAN8, ADVAN10, ADVAN13, ADVAN14. (With earlier ver-<br>sions of NONMEM 7, SS13 was used with ADVAN13.)<br>
When SS6 or SS9 is used, a DES subroutine (or $DES block) is required to evaluate dif-<br>ferential equations.<br>
TOL is required; (See <b>$subroutines</b>).<br>
With NONMEM 7.4, values of TOL and ATOL may be speciﬁed for evaluations of<br>Steady State amounts.<br>See options SSATOL and SSATOLC of the $SUBROUTINE and $TOL records, and the<br>TOL routine.<br>
Required PREDPP Library subroutines:<br>
With SS6: ZSPOW1, FCN1, FCN2<br>
With SS9: ZSPOW1, FCN2, FCN4<br>
REFERENCES: Guide VI, section VI.C , VII.B , VII.C.6 , VI.C.9<br>REFERENCES: Guide IV, section V.C.3 , V.C.10<br>
593<br>
<hr>
<A name=599></a>STANDARD DETAILED DESCRIPTIONS<br>
Help Guide<br>
STANDARD ERROR OF ESTIMATE<br>
MEANING: NONMEM’s estimate of the precision of its parameter estimates<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>Asymptotic statistical theory applied to extended least-squares estimation (as used in<br>NONMEM) says that the distribution of the parameter estimators is multivariate normal,<br>with variance-covariance matrix that can be estimated from the data. NONMEM supplies<br>such an estimate (See <b>covariance matrix of estimate</b>). The square root of the ith diago-<br>nal element of the matrix is the standard error of the ith parameter estimate. NONMEM<br>output presents standard errors as in this example.<br>
****** STANDARD ERROR OF ESTIMATE ********************<br>
THETA - VECTOR OF FIXED EFFECTS PARAMETERS<br>
**********<br>
TH 1<br>
TH 2<br>
6.27E+00 1.92E+01<br>
OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS<br>
********<br>
ETA1 ETA2<br>
ETA1 1.71E-02<br>
ETA2 .........<br>
1.12E-01<br>
SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS<br>
****<br>
EPS1<br>
EPS1 5.57E-03<br>
Note that standard errors are given for all types of population parameters: THETA, the<br>vector of ﬁxed effects parameters, and OMEGA and SIGMA, the matrices of random<br>effects parameters. In this example, the 2x2 matrix, OMEGA, was constrained to be<br>diagonal; the omitted entry (.........) indicates that the element omega(2,1) is not esti-<br>mated, and consequently has no standard error.<br>
REFERENCES: Guide I, section C.3.5.2<br>REFERENCES: Guide V, section 5.4.2.1<br>
594<br>
<hr>
<A name=600></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
STANDARD<br>
STANDARD ERRORS<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE ROCM_REAL, ONLY: SETHET=&gt;SETH,SEOMEG=&gt;SEOM,SESIGM=&gt;SESIG,<br>
SETHETR=&gt;SETHR<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: LTH,LVR,DPSIZE<br>
REAL(KIND=DPSIZES) :: SETH(LTH),SEOM(LVR,LVR),SESIG(LVR,LVR)<br>
DISCUSSION:<br>
SETHET<br>
SETHET(i) = the standard error of the estimate of theta(i).<br>
SETHETR<br>
SETHETR(i) = the standard error of the estimate of reported theta(i). If record<br>$THETAR is not used, SETHET and SETHETR are equal. If record $THETAR is<br>used, then SETHET is the standard error of the internal theta as used in<br>$PK/$PRED, and SETHETR is the standard error of the theta reported in the report<br>ﬁle.<br>
SEOMEG<br>
SEOMEG(i,j) = the standard error of the estimate of omega(i,j).<br>
SESIGM<br>
SESIGM(i,j) = the standard error of the estimate of sigma(i,j).<br>
These values should only be used with ICALL = 3.<br>
Location prior to NONMEM 7: rocm7<br>
REFERENCES: Guide I, section C.3.5.2<br>
REFERENCES: Guide V, section 5.4.2.1<br>
595<br>
<hr>
<A name=601></a>STATE<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
STATE VECTOR TIME: TSTATE<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied PK and ERROR routine<br>
USAGE:<br>USE PROCM_REAL, ONLY: TSTATE<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: TSTATE<br>
DISCUSSION:<br>
TSTATE<br>
TSTATE = the time at which the state-vector (See <b>State Vector: A</b>) was last com-<br>puted. It is the previous event time (i.e. the time on the previous event record passed<br>to PK), or if at a later time, but before the time for which PK is being called, a<br>lagged or additional dose was given, or a regular infusion was terminated, or a mod-<br>eled event occurred, then TSTATE is the latest such time.<br>
NM-TRAN includes this global variable in the PK and ERROR routines when $PK or<br>$ERROR abbreviated code includes references to variables A(n) or when verbatim code<br>is present.<br>
Location prior to NONMEM 7: procm9<br>
REFERENCES: None.<br>
596<br>
<hr>
<A name=602></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
STATE<br>
STATE VECTOR: A<br>
MEANING: PREDPP read-only global variables<br>CONTEXT: User-supplied PK and ERROR routines<br>
USAGE:<br>USE PROCM_REAL, ONLY A=&gt;AMNT,DAETA,D2AETA<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: PC,LVR,DPSIZE<br>
REAL(KIND=DPSIZE) :: AMNT(PC),DAETA(PC,LVR),D2AETA(PC,LVR,LVR)<br>
DISCUSSION:<br>
A<br>
A is the state vector of compartment amounts.<br>A(n) = the amount in compartment n.<br>
DAETA<br>
DAETA(n,i) = the derivative of A(n) wrt eta(i).<br>
D2AETA<br>
D2AETA(n,i,j) = the second derivative of A(n) wrt eta(i), eta(j) (lower-triangu-<br>lar; j=1, ..., i).<br>
The A(n) can be used as right-hand quantities in $ERROR and $PK abbreviated code.<br>These amounts are the latest ones computed. With $ERROR, the A(n) are computed at<br>the event time on the event record passed to ERROR. With $PK, the A(n) are computed<br>at the event time on the previous event record, or possibly at a later time. This time - the<br>latest time at which the amounts are computed - is given in the variable TSTATE, which<br>may also be used in $PK abbreviated code.<br>(See <b>State_Vector_TIME:_TSTATE</b>).<br>
Location prior to NONMEM 7: procm4<br>
REFERENCES: Guide VI, section IV.D , Figure 14<br>
597<br>
<hr>
<A name=603></a>STUBS DETAILED DESCRIPTIONS<br>
Help Guide<br>
STUBS<br>
MEANING: Type of NONMEM, PREDPP or User subroutine and function<br>CONTEXT: Replaced by a user-written subroutine or function<br>
DISCUSSION:<br>&quot;Stubs,&quot; or &quot;dummy&quot; routines, are subroutines or functions called by NONMEM,<br>PREDPP or user code. The versions of these routines that are distributed with NON-<br>MEM are essentially empty, i.e., they do nothing. They can be replaced by user-written<br>code in advanced applications.<br>
Each stub and utility subroutine or function has its own help entry.<br>
1) Stubs for NONMEM<br>
CRIT Modiﬁes the computation of the default objective function.<br>
CONTR Speciﬁes the contribution to the objective function of a level 1 (&quot;L1&quot;) record.<br>
CCONTR Speciﬁes the contribution to the objective function of a level 2 (&quot;L2&quot;) record.<br>
MIX Describes the mixing parameter of a mixture model.<br>
PRIOR Allows a Bayesian penalty to be included in the objective function.<br>
SPTWO<br>
SPTWO can be used to redeﬁne the RES and WRES items for observation<br>records.<br>
THETAI THETAI is used to transform initial thetas.<br>
THETAR THETAR is used to transform ﬁnal thetas for reporting.<br>
2) stubs for PREDPP<br>
INFN Initialization/Finalization routine.<br>
3) Stubs for User functions<br>
FUNCA, FUNCB, FUNCC, FUNCD, FUNCE, FUNCF, FUNCG, FUNCH, FUNCI<br>
Deﬁnes a function for abbreviated code.<br>
Code to replace a function stub should be placed in a ﬁle, e.g., funcacode. It should be<br>listed on the $SUBROUTINES record. E.g.,<br>$SUBROUTINES ... OTHER=funcacode<br>
REFERENCES: (CRIT) Guide II, section C.6<br>REFERENCES: (INFN) Guide VI, section VI.A , Figure 37<br>
598<br>
<hr>
<A name=604></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SUBROUTINE<br>
SUBROUTINE<br>
MEANING: Kind of subroutines in NONMEM/PREDPP Executable<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [SUBROUTINES=]kind<br>
SAMPLE:<br>$SUBROUTINE SUBROUTINES=DP<br>
DISCUSSION:<br>The SUBROUTINES option tells NM-TRAN how to implement the abbreviated code. If<br>there is no abbreviated code, the SUBROUTINES option is ignored. Possible values for<br>kind are:<br>
DP<br>
This is the default. NM-TRAN generates FORTRAN subroutines from abbreviated<br>code which compute with double-precision arithmetic. These subroutines are writ-<br>ten into NM-TRAN output ﬁle FSUBS. DP may also be coded DOUBLE or D.<br>Double-precision versions of NONMEM routines (and of PREDPP, if used) should<br>be included when the NONMEM executable is constructed.<br>
NM-TRAN also places into ﬁle FREPORT a line describing what kind of subrou-<br>tines were speciﬁed.<br>
GENERATED DP SUBROUTINES:<br>
REFERENCES: Guide IV, section III.B.6<br>REFERENCES: Guide III, section V.5.0, V.7.0, V.8.0<br>
599<br>
<hr>
<A name=605></a>SUPER DETAILED DESCRIPTIONS<br>
Help Guide<br>
SUPER PROBLEM PRINT CONTROL<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE NMPRD_INT, ONLY IPRNV<br>
GLOBAL DECLARATION:<br>INTEGER(KIND=ISIZE) :: IPRNV(2)<br>
DISCUSSION:<br>
IPRNV(i)<br>
0 indicates no printing of NONMEM input information with iterations 2, 3, etc. of<br>active ith level superproblem.<br>1 indicates printing of NONMEM input information with iterations 2, 3, etc. of<br>active ith level superproblem.<br>
Status with 2nd level superproblem takes precedence.<br>
(See <b>$super</b>).<br>
Location prior to NONMEM 7: rocm28<br>
REFERENCES: None.<br>
600<br>
<hr>
<A name=606></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
SUPP<br>
SUPP<br>
MEANING: SUPP subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY:: ISIZE<br>
INTEGER(KIND=ISIZE):: IE,IC<br>
...<br>
CALL SUPP (IE,IC)<br>
DISCUSSION:<br>The NONMEM utility routine SUPP is used to suppress portions of the NONMEM out-<br>put report. SUPP may be called only when ICALL is 0, 1, or 3.<br>
Input argument:<br>
IE An integer variable or integer constant. If the value is 1, the output from the Estima-<br>
tion Step is not included in the output report.<br>
IC An integer variable or integer constant. If the value is 1, the output from the Covari-<br>
ance Step is not included in the output report.<br>
SUPP is typically used during simulation with numerous sub-problems. A user-supplied<br>INFN routine, or similar code in a user-supplied PRED routine, presumably calculates<br>and prints summary statistics based on the ﬁnal parameter estimates, etc. Printed values<br>from each sub-problem are of little interest and may be suppressed to reduce the size of<br>the report ﬁle.<br>
When IE=1, pages with these headings are suppressed:<br>
MINIMUM VALUE OF OBJECTIVE FUNCTION<br>
FINAL PARAMETER ESTIMATE<br>
When IC=1, pages with these headings are suppressed:<br>
STANDARD ERROR OF ESTIMATE<br>
COVARIANCE MATRIX OF ESTIMATE<br>
CORRELATION MATRIX OF ESTIMATE<br>
INVERSE COVARIANCE MATRIX OF ESTIMATE<br>
The option PRINT=0 of the $ESTIMATION record is used to suppress the Intermediate<br>printout from the Estimation Step (&quot;MONITORING OF SEARCH:...&quot;)<br>
EXAMPLES OF USAGE:<br>
CALL SUPP(1,1)<br>
This suppress both Estimation and Covariance Step output.<br>
REFERENCES: None.<br>
601<br>
<hr>
<A name=607></a>TABLE COMPARE DETAILED DESCRIPTIONS<br>
Help Guide<br>
TABLE COMPARE<br>
MEANING: TABLE_COMPARE program<br>CONTEXT: NONMEM run<br>
The utility program table_compare compares the numerical values between two table ﬁles<br>produced by the NONMEM $TABLE record. The user may specify the tolerance for the<br>comparison.<br>
USAGE:<br>table_compare table1.tab table2.tab , precision.xtl &gt;differ-<br>
ences.txt<br>
where delimiter is {, t s} for {comma tab space}, and precision.xtl is a precision speciﬁ-<br>cation or control ﬁle. Default delimiter is space and default control ﬁle is table_com-<br>pare.xtl. It is useful to redirect difference results to a ﬁle, in this example differences.txt.<br>
EXAMPLE:<br>
For example, the user may desire that only relative differences greater than 0.001 be<br>reported. A very simple control ﬁle could be:<br>
$PRECISION<br>
ALL=0.01,0.003<br>
stating that all columns be compared with a relative difference of 0.01, and absolute dif-<br>ference of 0.003. Precision criteria for speciﬁc columns in the tables may also be given:<br>
$PRECISION<br>
ALL=0.01,0.003 WRES=0.1,0.2<br>
CL=0.05,0.02<br>
The equation for comparison is<br>ABS(X-Y)&gt;R*MAX(ABS(X),ABS(Y))+A<br>
then the difference is reported, where R is relative difference tolerance, and A is absolute<br>difference tolerance.<br>
REFERENCES: Guide Introduction_7<br>
602<br>
<hr>
<A name=608></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TABLE QUANT<br>
TABLE QUANT<br>
MEANING: TABLE_QUANT program<br>CONTEXT: NONMEM run<br>
The utility program table_quant transforms importance sampling (SIR) data in the NON-<br>MEM raw output ﬁle. Such data are present when the option SIRSAMPLE of the<br>$COVARIANCE record is used. (See NONMEM 74 Guide, &quot;Importance Sampling of<br>the Variance-Covariance of the Parameter Estimates&quot;). Table_quant produces a table<br>ﬁle with frequencies and cumulative values.<br>
USAGE:<br>table_quant inputfile outputfile delimiter start end<br>
Inputﬁle name should be the NONMEM ﬁle (root.ext).<br>Requred<br>
The results are written to outputﬁle, which may be called root.qnt. (This name is needed<br>if R script quantplot.R, or Splus script, quantplot.ssc, available in Pdx-Pop 5.2, is used to<br>view histograms and cdf plots from these result ﬁles.) The output ﬁle contains, for each<br>item, the sorted value, its frequency (freq), and its quantile position or cumulative proba-<br>bility (cum).<br>
Required.<br>
Delimiter is that used in the input ﬁle (s for space, t for tab, comma default)<br>
start and end are the range of iterations to be quantized (default is all non-negative itera-<br>tions).<br>
Table_quant uses the WEIGHT values record by NONMEM in the ﬁle. Bayes results,<br>which do not have the WEIGHT column, can be processed with this utility, but the<br>weight is then assumed constant among all samples.<br>
The output ﬁle will contain for each item, the sorted value, its frequency (freq), and its<br>quantile position or cumulative probability (cum). Also, make sure the input ﬁle contains<br>just one table of information.<br>
See also table_resample (tabresamp) program.<br>
EXAMPLE:<br>
REFERENCES: Guide Introduction_7<br>
603<br>
<hr>
<A name=609></a>TABLE RESAMPLE<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
TABLE RESAMPLE<br>
MEANING: TABLE_RESAMPLE program<br>CONTEXT: NONMEM run<br>
The utility program table_resample performs a resampling of importance sampling (SIR)<br>data in the NONMEM raw output ﬁle. Such data are present when the option SIRSAM-<br>PLE of the $COVARIANCE record is used. (See NONMEM 74 Guide, &quot;Importance<br>Sampling of the Variance-Covariance of the Parameter Estimates&quot;). Table_resample<br>produces a table ﬁle. Samples are weighted according to the WEIGHT column. If no<br>WEIGHT column is present, WEIGHT is assumed to be equal among all samples.<br>
USAGE:<br>table_resample inputfile outputfile delimiter newsize seed start end<br>
Inputﬁle name<br>
should be the raw NONMEM ﬁle (root.ext).<br>
outputﬁle<br>
The results are written to outputﬁle, which is required.<br>
Delimiter<br>
same as the delimiters that is used in the input ﬁle (s for space, t for tab, comma<br>default)<br>
start and end<br>
The range of iterations to be resampled (default is all non-negative iterations).<br>
newsize<br>
Size of the new samples, when seed &gt; 0.<br>
seed=0<br>
Non-randomized expansion of the samples, based on WEIGHT column<br>
seed&gt;0<br>
Randomized starting at seed, with repeated samples allowed If the user chooses<br>seed&gt;0, then newsize samples will be generated randomly and with replacement, in<br>proportion to the WEIGHT column.<br>
seed&lt;0<br>
Randomized starting at abs(seed), with repeated samples not allowed.<br>
If the user chooses seed=0, then newsize samples will be generated, each line of the<br>original root.ext ﬁle being repeated in proportion to its WEIGHT value, and these<br>repeated samples will be placed in root_new.ext. Thus the weight of each sample is<br>physically expressed in the manner of repeated rows of that sample. To assure that<br>integer truncation does not render the smaller weighted samples to be not at all<br>expressed, newsize should be something like 10000, or even 100000. The resulting<br>ﬁle, root_new.ext, will have the same structure as a BAYES result ﬁle, without the<br>WEIGHT column, and the R script bayesplot.R or Splus script bayesplot.ssc, avail-<br>able in Pdx-Pop 5.1, may be used to view histograms, quantile plots, and quantile<br>tables.<br>
The seed&lt;0 should be used only if newsize&lt;&lt;min(oldsize of original ﬁle, end-<br>start+1) that is, you just want a to pick a few samples.<br>
604<br>
<hr>
<A name=610></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TABLE RESAMPLE<br>
See also table_quant (tabquant) program.<br>
EXAMPLE:<br>
REFERENCES: Guide Introduction_7<br>
605<br>
<hr>
<A name=611></a>TABLE TO XML DETAILED DESCRIPTIONS<br>
Help Guide<br>
TABLE TO XML<br>
MEANING: TABLE_TO_XML program<br>CONTEXT: NONMEM run<br>
Program TABLE_TO_XML is a NONMEM utility program in the ..\util directory. It<br>converts additional output table ﬁles produced by NONMEM to XML Formatted ﬁles.<br>
USAGE:<br>table_to_xml inputfile outputfile ,<br>
where the delimiter is {, t s} for {comma tab space}. Default delimiter is space. The<br>rules (schema, document type deﬁnition) by which the xml ﬁle is constructed are given in<br>table.xsd and table.dtd in the ..\util directory.<br>
EXAMPLE:<br>
table_to_xml my_results.cov my_results_cov.xml<br>
REFERENCES: Guide Introduction_7<br>
606<br>
<hr>
<A name=612></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TIME<br>
TIME DAT A ITEM<br>
MEANING: Time (TIME) data item for PREDPP<br>CONTEXT: $INPUT record and NONMEM data set<br>
USAGE:<br>$INPUT ... TIME ...<br>
DISCUSSION:<br>TIME labels PREDPP’s time (TIME) data item. The time data item is required with<br>PREDPP. (An exception occurs with ADVAN9 and ADVAN15 when there are only equi-<br>librium compartments, in which case the time data item is optional.) However, even<br>when PREDPP is not used, a time data item has a special meaning to NM-TRAN; see<br>below.<br>
With PREDPP, the time data item gives the time of the event, the &quot;event time.&quot; With<br>NONMEM 7.4, time data items may be negative; with earlier versions, time data items<br>must be non-negative. Event records must be ordered within an individual record so that<br>time does not decrease, i.e., so that time on any record other than the ﬁrst is greater than<br>or equal to time on the prior record. Exceptions are the event times of reset and reset-<br>and-dose events, where the time may be any number.<br>
With or without PREDPP, if any time data item in the NM-TRAN data set contains a<br>colon (:), then all time data items are assumed to be clock times (hh:min), and NM-<br>TRAN translates all times to relative times (hh.fr) starting at time 0. Speciﬁcally, the<br>time of the ﬁrst data record of an individual record (if the data are population data) or the<br>ﬁrst data record of the data set (if the data are single-subject data) is set to 0. Subsequent<br>times in the NONMEM data set are calculated relative to<br>
that time.<br>
(See <b>date data item</b>).<br>
Example:<br>
NM-TRAN data set<br>
NONMEM data set<br>
TIME TIME<br>---- ----<br>8:00 0.<br>
14:45 6.75<br>
14.75 6.75<br>
NM-TRAN permits negative clock times.<br>
The $DAT A record may include the option TRANSLATE=(TIME/24), in which case all<br>relative times (obtained after clock time conversion) are divided by 24. (See <b>$data</b>).<br>REFERENCES: Guide VI, section V.C<br>REFERENCES: Guide IV, section II.C.2 , III.B.2<br>
607<br>
<hr>
<A name=613></a>TIME DETAILED DESCRIPTIONS<br>
Help Guide<br>
TIME SCALE PARAMETER<br>
MEANING: Time scale (TSCALE) parameter for PREDPP<br>CONTEXT: Additional PK Parameters<br>
USAGE:<br>$PK<br>
TSCALE= ....<br>
DISCUSSION:<br>
The time scale parameter is used with PREDPP. It is an optional additional PK parame-<br>ter. With NM-TRAN, it is symbolized in the $PK block by either of the reserved vari-<br>ables TSCALE or XSCALE.<br>
If a time scale parameter is modeled by PK, then time itself may be scaled differently<br>between individuals. There is a single time scale parameter that multiplies all rate con-<br>stants. The parameter acts continuously (and could therefore theoretically itself vary with<br>time measured on an external clock). It can only be used with linear kinetic models. If it<br>is not used, it can be ignored. If the value of the time scale parameter is not computed in<br>PK, it is always understood to be 1.<br>
The time scale parameter does not scale the duration parameter D of a duration-modeled<br>zero-order bolus dose.<br>
PREDPP ignores the time scale parameter with general non-linear models (ADVAN6, 8,<br>9, 13).<br>
(See <b>pk</b>, <b>$pk</b>).<br>
REFERENCES: Guide IV, section V.C.5<br>REFERENCES: Guide VI, section III.F.8<br>
608<br>
<hr>
<A name=614></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TNPRI<br>
TNPRI<br>
MEANING: TNPRI subroutine<br>CONTEXT: NONMEM utility routine<br>
USAGE:<br>USE SIZES, ONLY: ISIZE,DPSIZE<br>
INTEGER (KIND=ISIZE) :: IFND,MODE,ITYP,NSAM,ISS,IVAR<br>
REAL (KIND=DPSIZE) :: PLEV<br>
REAL (KIND=DPSIZE) :: CNT<br>
REAL (KIND=ISIZE) :: ICALL<br>
CALL TNPRI (IFND,MODE,ITYP,PLEV,NSAM,ISS,IVAR,CNT)<br>
DISCUSSION:<br>
The model parameters THETA, OMEGA and SIGMA parameters may be constrained in<br>various ways. Those parameters whose values are not ﬁxed are transformed in a one-to-<br>one manner to parameters whose values are not at all constrained a priori (the &quot;uncon-<br>strained parameters&quot;, or UCP). The user-written PRIOR subroutine allows a penalty<br>function based on a frequency prior to be speciﬁed and added to the -2log likelihood<br>function (Gisleskog et al, JPP, 2002, p. 473-505). This function serves as a constraint on<br>the <i>estimates </i>of THETA, OMEGA and SIGMA and thus as a way for stable estimates to<br>be obtained with insufﬁcient data. TNPRI may be called by PRIOR. (See <b>prior</b>). It<br>computes a penalty function based on a frequency prior that has a multivariate normal<br>form for all the UCP. The one-to-one transformation between THETA, OMEGA and<br>SIGMA and the UCP induces a frequency prior for THETA, OMEGA and SIGMA itself.<br>This latter form is called the &quot;transformed normal&quot; form.<br>
Both forms have the same parameters, which are called &quot;hyperparameters&quot;. The values of<br>the hyperparameters are produced with a prior NONMEM problem (called the &quot;prior<br>problem&quot;) used to analyze a prior data set. Thus the frequency prior has an empirical<br>nature. The prior problem should have implemented the Covariance Step (the Estimation<br>Step could have been implemented in yet an earlier problem). Whenever a problem<br>implements the Covariance Step and a model speciﬁcation ﬁle has been output, this ﬁle<br><i>automatically </i>contains information - referred to as the &quot;prior information&quot;, and including<br>values for the hyperparameters - which can be used when TNPRI is used in a subsequent<br>problem.<br>
The abilty to use TNPRI suggests that with any serious analysis undertaken in the future,<br>though it may not be necessary to save the data that were analyzed, a model speciﬁcation<br>ﬁle should be produced and safely stored along with a control stream showing the partic-<br>ulars that gav e rise to this ﬁle. There is a special way to input the prior information from<br>the model speciﬁcation ﬁle for its use with a subsequent application of TNPRI. (Alterna-<br>tively, a NONMEM control stream may consist of multiple problems, where one problem<br>(A) uses TNPRI, and the prior problem appears as an earlier problem (B) in the same<br>control stream. The prior information from problem B can be available to problem A<br>without the need to use a model speciﬁcation ﬁle.)<br>
When TNPRI is used during a Simulation Step, it produces a random value of the vector<br>of all model parameters (whose values are not ﬁxed in the parameter records) from the<br>frequency prior. (See <b>Simulation example</b>). (See <b>tnpri example</b>). If TNPRI is used<br>during a given problem at ICALL=2, it should not be used during the same problem at<br>ICALL=4, and vice-versa.<br>
609<br>
<hr>
<A name=615></a>TNPRI DETAILED DESCRIPTIONS<br>
Help Guide<br>
TNPRI may be used at ICALL=0 or ICALL=1, in which case only the values of its input<br>arguments are checked. If it is not used at ICALL=0 or ICALL=1, then the ﬁrst time it is<br>used at ICALL=2 or ICALL=4, checking will occur.<br>
Do not use TNPRI with the new $ESTIMATION methods of NONMEM 7.<br>
Input argument:<br>
IFND<br>
0: Indicates that a prior problem has been speciﬁed either earlier in the current con-<br>trol stream or in a previously run control stream, and that this problem has output a<br>model speciﬁcation ﬁle. The prior information will have automatically been stored<br>in the model speciﬁcation ﬁle. The prior problem should have implemented the<br>Covariance Step (which should have computed either the default variance-covari-<br>ance matrix or two times the inverse of the R matrix). The current control stream<br>should consist of at least two problems: the problem that uses TNPRI and a preceed-<br>ing problem that serves only to input the prior information from the model speciﬁca-<br>tion ﬁle, such as the following:<br>
$PROB READ THE MODEL SPECIFICATION FILE<br>$DAT A data<br>$INPUT ID TIME AMT DV TYPE SS II<br>$MSFI msf1 ONLYREAD<br>
This simple problem (B) should be the last problem in the current control stream that<br>appears before the problem using TNPRI (problem (A)) and inputs a model speciﬁ-<br>cation ﬁle. The problem speciﬁcation should not include any task records, but it<br>may include e.g. a $SUBROUTINES record and/or abbreviated code, if problem B<br>is the ﬁrst problem in the control stream, and these elements will be needed for a<br>subsequent problem. If problem A inputs a model speciﬁcation ﬁle msf2, any prior<br>information in msf2 will be ignored. If problem A outputs a model speciﬁcation ﬁle<br>msf3 and implements the Covariance Step, the prior information stored in msf3 is<br>based not only on the data being analyzed, but also on the prior information in msf1.<br>
1: Indicates that along with the current problem (with which TNPRI is being used), a<br>prior problem has been speciﬁed earlier in the same control stream. The prior prob-<br>lem is taken to be the last problem in the control stream that appears before the cur-<br>rent one and that implements the Covariance Step (which should have computed<br>either the default variance-covariance matrix or two times the inverse of the R<br>matrix).<br>
MODE<br>
Discussion: In any NONMEM problem speciﬁcation, all of the last contiguously<br>listed parameters on the $THETA record, whose values on this record are ﬁxed, and<br>assuming the value of the very last parameter itself is ﬁxed, are called the &quot;terminal<br>ﬁxed THETA parameters&quot;. There may be no such parameters. E.g. if the $THETA<br>record is<br>
$THETA 3.1 FIX 6.3 .01 400 FIX 7 FIX 90 FIX<br>
then THETA parameters 4-6 are the terminal ﬁxed THETA parameters. If the record<br>is<br>
610<br>
<hr>
<A name=616></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TNPRI<br>
$THETA 3.1 FIX 6.3 .01 400 FIX 7 FIX 90<br>
then there are no terminal ﬁxed THETA parameters, because the value 90 of the very<br>last parameter is not ﬁxed. Similarly, all the last contiguous ﬁxed parameters in<br>OMEGA (SIGMA), assuming the values in the very last block set are ﬁxed, are<br>called the &quot;terminal ﬁxed OMEGA (SIGMA) parameters&quot;. (Recall that in a diagonal<br>$OMEGA record, all the values form separate block sets.)<br>
There are some rules concerning the parameter records of a NONMEM control<br>stream that relate the parameters of the prior problem to those of the current prob-<br>lem:<br>
I. With the exception of the terminal ﬁxed THETA parameters in the prior problem,<br>which are altogether ignored in the current problem, the THETA parameters of the<br>prior problem must be the ﬁrst THETA parameters listed in the $THETA record of<br>the current problem, whether or not their values are ﬁxed in the prior problem.<br>
II. The order of these ﬁrst THETA parameters on the $THETA record must be the<br>same as that in the $THETA record of the prior problem. The initial estimates of<br>these parameters need not be the same, but any upper or lower bounds must be the<br>same.<br>
III. Among the ﬁrst THETA parameters, values that are ﬁxed on the $THETA<br>record of the prior problem must also be ﬁxed on the $THETA record of the current<br>problem, although the values need not be the same, but not vice-versa; see discus-<br>sion below concerning parameter interpretation.<br>
IV. THETA parameters peculiar to the current problem may be listed at the end of<br>the $THETA record of the current problem, after the parameters that are shared<br>between the prior and current problems.<br>
E.g. if the $THETA record with the prior problem is<br>
$THETA 3.1 FIX 6.3 (0,.01) 400 FIX 7 FIX 90 FIX<br>
then the $THETA record with the current problem may be<br>
$THETA 10<br>
FIX 7.0 (0,.03) 80.2 100.8<br>
in which case the values 80.2 and 100.8 are the values of the THETA parameters that<br>are peculiar to the current problem. The 2nd and 3rd parameters are used in both<br>prior and current problems, but have different values in the two problems. The ﬁrst<br>parameter may be used in the current problem, in which case its value is ﬁxed to 10.<br>
The same rules apply to the $OMEGA and $SIGMA records of the current problem.<br>
A model speciﬁcation ﬁle from a previous instance of the current problem may be<br>used, as usual, providing that if with the previous instance, parameter records were<br>used, the above rules were followed.<br>
Parameter Interpretation: The prior information concerns all parameters appearing<br>in the prior problem whose values are not ﬁxed in that problem. However, a parame-<br>ter with a nonﬁxed value in the prior problem may have a ﬁxed value in the current<br>problem, and this gives rise to some ambiguity. Such a parameter may have an inter-<br>pretation in the prior problem that remains unchanged in the current problem. Then<br>it needs to be identiﬁed as a &quot;shared parameter&quot;, in which case, because the value of<br>the parameter is ﬁxed with the current model, the frequency prior needs to be<br>
611<br>
<hr>
<A name=617></a>TNPRI DETAILED DESCRIPTIONS<br>
Help Guide<br>
adjusted in order to approximate the -2 log likelihood function for the prior data<br>when the parameter value is regarded as being ﬁxed in the prior model. (or when<br>TNPRI is being called in the Simulated Step, in order to use a <i>conditional </i>prior dis-<br>tribution, given the parameter value is the ﬁxed value). A shared parameter may not<br>actually be used in the current problem, but the salient point is that with the current<br>problem, the interpretation of this parameter remains unchanged. Alternatively, the<br>parameter’s interpretation may change in the current problem. Then it needs to be<br>identiﬁed as a &quot;prior-speciﬁc&quot; parameter, in which case if it is actually used in the<br>current model, its value will be the ﬁxed value, but for the purpose of applying the<br>prior information, TNPRI will regard this parameter as one speciﬁc to the prior<br>model. The MODE argument concerns this distinction.<br>
0: All parameters with a nonﬁxed value in the prior problem but a ﬁxed value in the<br>current problem are identiﬁed as being prior-speciﬁc parameters. However, the ﬁnal<br>estimates of these parameters are their ﬁxed values.<br>
1: All parameters with a nonﬁxed value in the prior problem but a ﬁxed value in the<br>current problem are identiﬁed as being prior-speciﬁc parameters. If the Estimation<br>Step is implemented, the ﬁnal estimate for such a parameter is the same one that<br>would result from not ﬁxing the value of the parameter in the current problem and<br>letting it be estimated, <i>assuming </i>that the parameter is not at all used in the current<br>model. This value will be similar to the ﬁnal estimate of the parameter in the prior<br>problem. (A difference from this prior estimate may result, reﬂecting the fact that if<br>there is a sequence of models, each a submodel of the one succeeding it, then the<br>data used to ﬁt the last of the models may bear on a parameter peculiar to the ﬁrst<br>model, if only slightly.) If indeed the parameter’s value were not ﬁxed, but the<br>parameter’s estimate obtained along with the estimates of the non-prior-speciﬁc<br>parameters, then the latter estimates and the minimum value of the objective func-<br>tion would be unchanged, but the search for the parameter’s estimate would require<br>additional computer time. With the value MODE=1, in fact, the parameter’s esti-<br>mate is obtainable posthoc, after the search, and this additional computer time is<br>saved. The output from the Covariance Step includes all the usual type of informa-<br>tion about the estimators of the prior-speciﬁc parameters along with that about the<br>estimators of the non-prior-speciﬁc parameters. However, note that an output model<br>speciﬁcation ﬁle will not contain any information about the estimates of prior-spe-<br>ciﬁc parameters.<br>
2: All parameters with a nonﬁxed value in the prior problem but a ﬁxed value in the<br>current problem are identiﬁed as being shared parameters (i.e. the frequency prior is<br>adjusted). The ﬁnal estimates of these parameters are their ﬁxed values.<br>
ITYP<br>
Relevant only if TNPRI is called during a Simulation Step. Values are:<br>
0: The value of the UCP (unconstrained parameter) vector is obtained from simple<br>random sampling.<br>
1: Within the given problem, TNPRI is to be called a speciﬁed number (NSAM) of<br>times to obtain this number of different values of the UCP vector. These values are<br>obtained by generating a Latin sample of size NSAM from equiprobable partitions<br>of an ellipsoid in UCP space (hyper-ellipsoidal sampling), followed by sampling a<br>
612<br>
<hr>
<A name=618></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TNPRI<br>
point &quot;uniformly&quot; from each partition. This scheme may be used, for example,<br>when the problem has NSAM subproblems, in which case, TNPRI would be called<br>NSAM times, once each time during the problem when ICALL=4, and at each of<br>these calls, a different random value of the UCP vector will be produced.<br>
2: Just as with value 1, but the NSAM values are obtained by generating a Latin<br>sample of size NSAM from equiprobable partitions of an ellipsoid in UCP space<br>(hyper-ellipsoidal sampling), followed by taking the &quot;center point&quot; of each partition.<br>
In all three cases, a value of the UCP vector is transformed into THETA-OMEGA-<br>SIGMA space.<br>
After each call to NWPRI, the simulated values for THETA, OMEGA and SIGMA<br>may be found in global variables and thus they are communicated directly to NON-<br>MEM. (See <b>PRIOR_Simulation:_Parameters</b>).<br>
PLEV<br>
When TNPRI is being used at ICALL=0 or 1, but TNPRI will not be used at<br>ICALL=4 (i.e. during the Simulation Step), PLEV should be set to 0. When it is<br>being used at ICALL=2, PLEV should also be set to 0. When TNPRI is being used<br>at ICALL=0 or 1 and will also be used at ICALL=4, or when it is being used at<br>ICALL=4, then PLEV must be set to a fraction strictly less than 1, e.g. 0.999. PLEV<br>is double precision with NONMEM 7, and is single precision with NONMEM VI.<br>
A UCP value will actually be obtained using a truncated multivariate normal distri-<br>bution, i.e. from an ellipsoidal region R1 over which only a fraction of mass of the<br>normal occurs. This fraction is given by PLEV. Simple random sampling occurs in<br>R1. Latin sampled partitions are partitions of R1.<br>
NSAM<br>
Relevant only if TNPRI is called during a Simulation Step. Consider two cases. a)<br>Latin hyper-ellipsoid sampling is used with ITYP=1, or b) simple random sampling<br>along with the adjustment for small sample correlation effect is used (see next input<br>argument). In case a) NSAM should equal the exact total number of different values<br>of the parameter vector that must eventually be produced over the entire NONMEM<br>problem. In case b) NSAM should be no less than this number.<br>
ISS<br>
Relevant only if TNPRI is called during a Simulation Step. A value of the UCP vec-<br>tor is obtained by ﬁrst sampling a value from the <i>standard </i>multivariate normal distri-<br>bution - called here &quot;the standard value&quot; and then transforming this value to one<br>from the appropriate multivariate normal. The correlation matrix of the standard<br>normal is the identity matrix. When NSAM is small, the estimated correlation<br>matrix from the sampled standard values might not be quite close to the identity<br>matrix - this is here called &quot;the small sample correlation effect&quot;.<br>
1: An adjustment is made for the small sample correlation effect, by ﬁrst transform-<br>ing the NSAM standard values <i>altogether </i>into new values which are very nearly<br>standard multivariate normal values and such that the sample correlation matrix of<br>these new values is exactly the identity matrix.<br>
0: No adjustment is made for the small sample correlation effect.<br>
613<br>
<hr>
<A name=619></a>TNPRI DETAILED DESCRIPTIONS<br>
Help Guide<br>
IVAR<br>
Relevant only if TNPRI is called during a Simulation Step. When TNPRI simulates<br>a parameter value, this value is that of an estimate of the parameter from possible<br>data under the prior model, and this simulation is based on asymptotic statistical the-<br>ory. The partial derivatives comprising the R and S matrices referred to below are<br>taken with respect to the UCP (See <b>covariance</b>). The possible values of IVAR are:<br>
0: The variance-covariance matrix of the multivariate normal on the UCP is taken to<br>be two times the inverse R matrix obtained from the prior problem. This could be<br>appropriate if the estimated asymptotic variance-covariance matrix from the prior<br>problem is also based only on the R matrix.<br>
1: The variance-covariance matrix of the multivariate normal on the UCP is taken to<br>be Rinv*S*Rinv matrix from the prior problem.<br>
Output argument:<br>
CNT<br>
Relevant only if TNPRI is called at ICALL=2. CNT is the penalty.<br>
REFERENCES: Guide II, section D.2.5<br>
614<br>
<hr>
<A name=620></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TOL<br>
TOL<br>
MEANING: TOL subroutine<br>CONTEXT: User-supplied subroutine; for use with PREDPP<br>
USAGE:<br>
Versions before NONMEM 7.4:<br>
SUBROUTINE TOL(NRD)<br>
USE SIZES,<br>
ONLY: ISIZE<br>
INTEGER(KIND=ISIZE) :: NRD<br>
DIMENSION :: NRD(*)<br>
With NONMEM 7.4:<br>
SUBROUTINE TOL(NRD,ANRD,NRDC,ANRDC)<br>
USE SIZES,<br>
ONLY: ISIZE<br>
INTEGER(KIND=ISIZE) :: NRD(0:*), ANRD(0:*), NRDC(0:*), ANRDC(0:*)<br>
Optional declarations with NONMEM 7.4:<br>
USE NMPRD_INT, ONLY: IPROB<br>
USE NM_BAYES_INT, ONLY: NM_STEP,BASE_STEP,EST_STEP,COV_STEP, &amp;<br>
TABLE_STEP,SIML_STEP,INE_STEP, NONP_STEP<br>
DISCUSSION:<br>The TOL subroutine is called by PREDPP when ADVAN 6, 8, 9, 10, 13, 14, or 15 is<br>used. It is also called when SS6 or SS9 is used. With NONMEM 7.4, there are multiple<br>calls during the run, for each NONMEM step. With earlier version, TOL is called only<br>once at the start of a run.<br>
Output argument:<br>
NRD(I)<br>
The number of digits that are required to be accurate in the computation of the drug<br>amount in compartment I, i.e., the relative tolerance. ADVAN 9, 13, 14, and 15 have<br>the capability of using different values of NRD for different compartments. For<br>compartments not speciﬁed, the tolerance of the last compartment speciﬁed will be<br>used.<br>
However, all the other ADVAN routines requiring TOL take the relative tolerance to<br>be the same for all compartments; NRD(I), <i>I </i>&gt; 1, is ignored, and only NRD(1) is<br>used. With NONMEM 7.4, NRD(0) is the relative tolerance for the Steady State<br>computations. If NRD(0) is not speciﬁed, NRD(1) is used.<br>
The value of NRD(1) can also be speciﬁed using $SUBROUTINES option TOL.<br>The value of NRD(0) can also be speciﬁed using $SUBROUTINES option SSTOL.<br>
ANRD(I) (NM74)<br>
The absolute tolerance in the computation of the drug amount in compartment I.<br>The default is 12 (that is, accuracy is 10**(-12)). Used by ADVAN 9, 13, 14, and<br>15, which have the capability of using different values of ANRD for different com-<br>partments. For compartments not speciﬁed, the tolerance of the last compartment<br>speciﬁed will be used.<br>
ANRD(0) is the absolute tolerance for the Steady State computations. If ANRD(0)<br>is not speciﬁed, ANRD(1) is used.<br>
615<br>
<hr>
<A name=621></a>TOL<br>
DETAILED DESCRIPTIONS<br>
Help Guide<br>
The value of ANRD(1) can also be speciﬁed using $SUBROUTINES option ATOL.<br>The value of ANRD(0) can also be speciﬁed using $SUBROUTINES option<br>SSATOL.<br>
NRDC(I) (NM74)<br>
Same as NRD(I), but used for the FOCE/LAPLACE covariance step. Used with<br>ADVAN 9, 13, 14, and 15. If not set, NRDC defaults to the value of NRD.<br>NRDC(0) is used for Steady State computations during the FOCE/LAPLACE<br>covariance step.<br>
The value of NRDC(1) can also be speciﬁed using $SUBROUTINES option TOLC.<br>The value of NRDC(0) can also be speciﬁed using $SUBROUTINES option<br>SSTOLC.<br>
ANRDC(I) (NM74)<br>
Same as ANRD(I), but used for the FOCE/LAPLACE covariance step. Used with<br>ADVAN 9, 13, 14, and 15. If not set, ANRDC defaults to the value of ANRD.<br>ANRDC(0) is used for Steady State computations during the FOCE/LAPLACE<br>covariance step.<br>
The value of ANRDC(1) can also be speciﬁed using $SUBROUTINES option<br>AT OLC.<br>The value of ANRDC(0) can also be speciﬁed using $SUBROUTINES option<br>SSATOLC.<br>
When NM-TRAN is used, this information may be supplied by either the TOL option of<br>the $SUBROUTINES record or the $TOL record.<br>
Finally, you may supply a TOL routine that assigns values of NRD and ANRD speciﬁ-<br>cally for the initial (base) setting and each NONMEM step (estimation, covariance, simu-<br>lation, table/scatter step, simulation, initial parameters estimate, nonparametric). For<br>example, create a toluser.f90 ﬁle,<br>
SUBROUTINE TOL(NRD,ANRD,NRDC,ANRDC)<br>
USE NMPRD_INT, ONLY: IPROB<br>
USE NM_BAYES_INT, ONLY: NM_STEP,BASE_STEP,EST_STEP,COV_STEP, &amp;<br>
TABLE_STEP,SIML_STEP,INE_STEP, NONP_STEP<br>
IMPLICIT NONE<br>
INTEGER :: NRD(0:*), ANRD(0:*), NRDC(0:*), ANRDC(0:*)<br>
IF(NM_STEP==EST_STEP) THEN<br>
NRD(1)=6<br>
ANRD(1)=10<br>
ELSE IF (NM_STEP==COV_STEP) THEN<br>
NRD(1)=7<br>
ANRD(1)=8<br>
ELSE IF (NM_STEP==TABLE_STEP) THEN<br>
NRD(1)=8<br>
ANRD(1)=7<br>
ELSE<br>
NRD(1)=9<br>
ANRD(1)=12<br>
ENDIF<br>
IF(IPROB&gt;1) THEN<br>
NRD(1)=NRD(1)+1<br>
ANRD(1)=ANRD(1)+1<br>
616<br>
<hr>
<A name=622></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TOL<br>
ENDIF<br>
RETURN<br>
END<br>
and incorporate using $SUBR, e.g.,<br>
$SUBROUTINES ADVAN13 TRANS1 TOL=toluser.f90<br>
REFERENCES: Guide IV, section V.C.4<br>REFERENCES: Guide VI, section VI.D , Figure 41<br>REFERENCES: Guide VI, Appendix II<br>
617<br>
<hr>
<A name=623></a>TRANS DETAILED DESCRIPTIONS<br>
Help Guide<br>
TRANS (OPTION)<br>
MEANING: Choice of Translator Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [TRANS=]TRANSn<br>
SAMPLE:<br>$SUBROUTINE ADVAN1 TRANS1<br>
DISCUSSION:<br>PREDPP contains a library of routines, called translator routines, which perform re-<br>parameterization of the basic PK parameters computed by the PK routine. Exactly one<br>TRANS routine must be selected for each NONMEM/PREDPP run. They are:<br>
TRANS1 Dummy, or null, translator; may be used with all ADVAN routines. It is the default.<br>TRANS2 Used with ADVAN1 and ADVAN2.<br>TRANS3 Used with ADVAN3 and ADVAN4.<br>TRANS4 Used with ADVAN3, ADVAN4, ADVAN11, ADVAN12<br>TRANS5 Used with ADVAN3 and ADVAN4.<br>TRANS6 Used with ADVAN3, ADVAN4, ADVAN11, ADVAN12<br>
Each has its own entry.<br>
REFERENCES: Guide VI, section III.A , III.M<br>
618<br>
<hr>
<A name=624></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TRANS<br>
TRANS (SUBROUTINE)<br>
MEANING: TRANS subroutine<br>CONTEXT: User-supplied subroutine; for use with PREDPP<br>
USAGE:<br>SUBROUTINE TRANS (ITRANS,IRGG,GG,NETAS)<br>
USE SIZES, ONLY: ISIZE,DPSIZE,LVR<br>
INTEGER(KIND=ISIZE) :: IRGG,NPETAS,ITRANS<br>
REAL(KIND=DPSIZE) :: GG(IRGG,LVR+1,LVR+1)<br>
DISCUSSION:<br>The TRANS subroutine translates (or transforms) the values for a set of basic PK param-<br>eters modeled in PK to a set of values for the internal parameters required by the<br>ADVAN. The PREDPP Library has a number of TRANS subroutines, representing dif-<br>ferent possible parameterizations in PK, from which the user may choose. If a suitable<br>translator is not found in the Library, the user may write his own.<br>
Input/Output argument:<br>
ITRANS<br>
ITRANS=1: TRANS has been called for initialization at the beginning of a NON-<br>MEM problem; one such call per problem. ITRANS must be reset by TRANS to a<br>number in the range 1-8999. This number appears on NONMEM output, allowing<br>the user to identify the TRANS routine being used.<br>
ITRANS=2: On input the GG array has stored in it the values computed by PK<br>(except that were any PK parameter modeled in its logarithm form in PK, PREDPP<br>would have already exponentiated its typical/subject-speciﬁc value and multiplied its<br>eta derivatives by its exponentiated typical/subject-speciﬁc value). On output the GG<br>array should have stored in it the values that would be computed by PK were the<br>internal parameters of the ADVAN modeled directly in PK (and none in their loga-<br>rithmic form).<br>
ITRANS=4: TRANS has been called during the Simulation Step. Only the ﬁrst col-<br>umn of the GG array need be computed as with ITRANS=2. Other columns need<br>not be computed.<br>
GG The array of PK parameters and their eta derivatives.<br>
The array is described elsewhere; (See <b>pk</b>).<br>
Input argument:<br>
NETAS<br>
The number of population etas in the problem.<br>
Certain variables are available in modules. Their use is optional.<br>
Variables in read/write modules:<br>
IERPRD NETEXT ETEXT<br>(See <b>PRED Exit Code</b>).<br>(See <b>PRED Error Message</b>).<br>
Variables in read-only commons:<br>
NOETAS, SECOND<br>(See <b>Partial Derivative Indicators</b>).<br>
619<br>
<hr>
<A name=625></a>TRANS DETAILED DESCRIPTIONS<br>
Help Guide<br>
When SECOND is true, PREDPP requires second-partial derivatives of etas.<br>
REFERENCES: Guide VI, section III.M<br>
620<br>
<hr>
<A name=626></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TRANS1<br>
TRANS1<br>
MEANING: Choice of Translator Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [TRANS=]TRANS1<br>
SAMPLE:<br>$SUBROUTINE ADVAN1 TRANS1<br>
DISCUSSION:<br>TRANS1 is a translator routine in PREDPP’s library which can be used with any<br>ADVAN routine. It is a &quot;dummy&quot; translator that does not perform any reparameterization<br>of the basic PK parameters. It is the default translator when none is speciﬁed on the<br>$SUBROUTINES record.<br>
REFERENCES: Guide VI, section III.A , III.M<br>
621<br>
<hr>
<A name=627></a>TRANS2 DETAILED DESCRIPTIONS<br>
Help Guide<br>
TRANS2<br>
MEANING: Choice of Translator Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [TRANS=]TRANS2<br>
SAMPLE:<br>$SUBROUTINE ADVAN1 TRANS2<br>
DISCUSSION:<br>TRANS2 is a routine in PREDPP’s library which can be used with ADVAN1 or<br>ADVAN2. It performs a reparameterization of the basic PK parameters to the internal<br>parameters K and KA.<br>
Basic PK parameters for ADVAN1, TRANS2:<br>
CL<br>
clearance<br>
V<br>
volume of distribution<br>
Relationship: K=CL/V<br>
Basic PK parameters for ADVAN2, TRANS2:<br>
CL<br>
clearance<br>
V<br>
volume of distribution<br>
KA<br>
rate constant of absorption<br>
Relationship: K=CL/V<br>KA=KA<br>
REFERENCES: Guide VI, section III.A , VII.C.1<br>
622<br>
<hr>
<A name=628></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TRANS3<br>
TRANS3<br>
MEANING: Choice of Translator Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [TRANS=]TRANS3<br>
SAMPLE:<br>$SUBROUTINE ADVAN3 TRANS3<br>
DISCUSSION:<br>TRANS3 is a routine in PREDPP’s library which can be used with ADVAN3 or<br>ADVAN4. It performs a reparameterization of the basic PK parameters to the internal<br>parameters K, K12, K21, and KA.<br>
Basic PK parameters for ADVAN3, TRANS3:<br>
CL<br>
clearance<br>
V<br>
central volume<br>
Q<br>
intercompartmental clearance<br>
VSS<br>
volume of distribution at steady-state<br>
Relationship:<br>K=CL/V<br>K12=Q/V<br>K21=Q/(VSS-V)<br>
Basic PK parameters for ADVAN4, TRANS3:<br>
CL<br>
clearance<br>
V<br>
central volume<br>
Q<br>
intercompartmental clearance<br>
VSS<br>
volume of distribution at steady-state<br>
KA<br>
absorption rate constant<br>
Relationship:<br>K=CL/V<br>K23=Q/V<br>K32=Q/(VSS-V)<br>KA=KA<br>
REFERENCES: Guide VI, section III.A , VII.C.3<br>
623<br>
<hr>
<A name=629></a>TRANS4 DETAILED DESCRIPTIONS<br>
Help Guide<br>
TRANS4<br>
MEANING: Choice of Translator Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [TRANS=]TRANS4<br>
SAMPLE:<br>$SUBROUTINE ADVAN3 TRANS4<br>
DISCUSSION:<br>TRANS4 is a routine in PREDPP’s library which can be used with ADVAN3, ADVAN4,<br>ADVAN11, or ADVAN12. It performs a reparameterization of the basic PK parameters<br>to the internal parameters K, K12, K21, and KA.<br>
Basic PK parameters for ADVAN3, TRANS4:<br>
CL<br>
clearance<br>
V1<br>
central volume<br>
Q<br>
intercompartmental clearance<br>
V2<br>
peripheral volume<br>
Relationship:<br>K=CL/V1<br>K12=Q/V1<br>K21=Q/V2<br>
Basic PK parameters for ADVAN4, TRANS4:<br>
CL<br>
clearance<br>
V2<br>
central volume<br>
Q<br>
intercompartmental clearance<br>
V3<br>
peripheral volume<br>
KA<br>
absorption rate constant<br>
Relationship:<br>K=CL/V2<br>K23=Q/V2<br>K32=Q/V3<br>KA is unchanged<br>
Basic PK parameters for ADVAN11, TRANS4:<br>
CL<br>
clearance<br>
V1<br>
central volume<br>
Q2<br>
intercompartmental clearance (central and periph. 1)<br>
V2<br>
peripheral 1 volume<br>
Q3<br>
intercompartmental clearance (central and periph. 2)<br>
V3<br>
peripheral 2 volume<br>
Relationship:<br>K=CL/V1<br>K12=Q2/V1<br>K21=Q2/V2<br>K13=Q3/V1<br>K31=Q3/V3<br>
624<br>
<hr>
<A name=630></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TRANS4<br>
Basic PK parameters for ADVAN12, TRANS4:<br>
CL<br>
clearance<br>
V2<br>
central volume<br>
Q3<br>
intercompartmental clearance (central and periph 1)<br>
V3<br>
peripheral 1 volume<br>
Q4<br>
intercompartmental clearance (central and periph 2)<br>
V4<br>
peripheral 2 volume<br>
KA<br>
absorption rate constant<br>
Relationship:<br>K=CL/V2<br>K23=Q3/V2<br>K32=Q3/V3<br>K24=Q4/V2<br>K42=Q4/V4<br>KA=KA<br>
REFERENCES: Guide VI, section VII.C.3 , VII.C.4<br>
625<br>
<hr>
<A name=631></a>TRANS5 DETAILED DESCRIPTIONS<br>
Help Guide<br>
TRANS5<br>
MEANING: Choice of Translator Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [TRANS=]TRANS5<br>
SAMPLE:<br>$SUBROUTINE ADVAN3 TRANS5<br>
DISCUSSION:<br>TRANS5 is a routine in PREDPP’s library which can be used with ADVAN3 or<br>ADVAN4. It performs a reparameterization of the basic PK parameters to the internal<br>parameters K, K12, K21, and KA.<br>
Basic PK parameters for ADVAN3, TRANS5:<br>
AOB<br>
A/B<br>
ALPHA<br>
alpha<br>
BETA<br>
beta<br>
Relationship:<br>K21=(AOB*BETA+ALPHA)/(AOB+1)<br>K=(ALPHA*BETA)/K21<br>K12=ALPHA+BETA-K21-K<br>
Basic PK parameters for ADVAN4, TRANS5:<br>
AOB<br>
A/B<br>
ALPHA<br>
alpha<br>
BETA<br>
beta<br>
KA<br>
absorption rate constant<br>
Relationship:<br>K32=(AOB*BETA+ALPHA)/(AOB+1)<br>K=(ALPHA*BETA)/K32<br>K23=ALPHA+BETA-K32-K<br>KA=KA<br>
REFERENCES: Guide VI, section VII.C.3 , VII.C.4<br>
626<br>
<hr>
<A name=632></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
TRANS6<br>
TRANS6<br>
MEANING: Choice of Translator Routine for PREDPP<br>CONTEXT: Option of NM-TRAN $SUBROUTINES record<br>
USAGE:<br>$SUBROUTINES [TRANS=]TRANS6<br>
SAMPLE:<br>$SUBROUTINE ADVAN3 TRANS6<br>
DISCUSSION:<br>TRANS6 is a routine in PREDPP’s library which can be used with ADVAN3, ADVAN4,<br>ADVAN11, and ADVAN12. It performs a reparameterization of the basic PK parame-<br>ters.<br>
Basic PK parameters for ADVAN3, TRANS6:<br>
ALPHA<br>
alpha<br>
BETA<br>
beta<br>
K21<br>
rate constant (peripheral to central)<br>
Relationship:<br>K=ALPHA*BETA/K21<br>K12=ALPHA+BETA-K21-K<br>
Constraint:<br>
Assuming that ALPHA &lt; BETA, then ALPHA &lt; K21 &lt; BETA.<br>The roles of ALPHA and BETA are exchangeable.<br>
Basic PK parameters for ADVAN4, TRANS6:<br>
ALPHA<br>
alpha<br>
BETA<br>
beta<br>
K32<br>
rate constant (peripheral to central)<br>
KA<br>
absorption rate constant<br>
Relationship:<br>K=ALPHA*BETA/K32<br>K23=ALPHA+BETA-K32-K<br>KA is unchanged<br>
Constraint:<br>
Assuming that ALPHA &lt; BETA, then ALPHA &lt; K32 &lt; BETA.<br>The roles of ALPHA and BETA are exchangeable.<br>
Basic PK parameters for ADVAN11, TRANS6:<br>
ALPHA<br>
alpha<br>
BETA<br>
beta<br>
GAMMA<br>
gamma<br>
K21<br>
rate constant (peripheral 1 to central)<br>
K31<br>
rate constant (peripheral 2 to central)<br>
Relationship:<br>K=ALPHA*BETA*GAMMA/(K21*K31)<br>K13=(P+K31*K31-K31*S-K*K21)/(K21-K31)<br>K12=S-K-K13-K21-K31<br>
627<br>
<hr>
<A name=633></a>TRANS6 DETAILED DESCRIPTIONS<br>
Help Guide<br>
where<br>
S=ALPHA+BETA+GAMMA<br>P=ALPHA*BETA+ALPHA*GAMMA+BETA*GAMMA<br>
Constraint:<br>
Assuming that ALPHA&lt;BETA&lt;GAMMA, then<br>
ALPHA&lt;K21&lt;BETA&lt;K31&lt;GAMMA<br>
or<br>
ALPHA&lt;K31&lt;BETA&lt;K21&lt;GAMMA.<br>
The roles of ALPHA, BETA, GAMMA, K21, K31, K12, and K13 are symmetric<br>and are exchangeable.<br>
Basic PK parameters for ADVAN12, TRANS6:<br>
ALPHA<br>
alpha<br>
BETA<br>
beta<br>
GAMMA<br>
gamma<br>
K32<br>
rate constant (peripheral 1 to central)<br>
K42<br>
rate constant (peripheral 2 to central)<br>
KA<br>
absorption rate constant<br>
Relationship:<br>K=ALPHA*BETA*GAMMA/(K32*K42)<br>K24=(P+K42*K42-K42*S-K*K32)/(K32-K42)<br>K23=S-K-K24-K32-K42<br>where<br>
S=ALPHA+BETA+GAMMA<br>P=ALPHA*BETA+ALPHA*GAMMA+BETA*GAMMA<br>
KA is unchanged<br>
Constraint:<br>
Assuming that ALPHA&lt;BETA&lt;GAMMA, then<br>
ALPHA&lt;K32&lt;BETA&lt;K42&lt;GAMMA<br>
or<br>
ALPHA&lt;K42&lt;BETA&lt;K32&lt;GAMMA.<br>
The roles of ALPHA, BETA, GAMMA, K32, K42, K23, and K24 are symmetric<br>and are exchangeable.<br>
REFERENCES: None.<br>
628<br>
<hr>
<A name=634></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
USERS<br>
USERS GUIDE<br>
MEANING: NONMEM Users Guide<br>CONTEXT: Documentation<br>
The following documents are collectively called the NONMEM Users Guide.<br>
<b>Part I - Users Basic Guide</b><br>
<b>Part II - Users Supplemental Guide</b><br>
<b>Part III - NONMEM Installation Guide</b><br>
<b>Part IV - NM-TRAN Guide</b><br>
<b>Part V - NONMEM-PREDPP Introductory Guide</b><br>
<b>Part VI - PREDPP Guide</b><br>
<b>Part VII - Conditional Estimation Methods</b><br>
<b>Part VIII - Help Guide</b><br>
<b>NONMEM V Supplemental Guide</b><br>
<b>Introduction to Version VI</b><br>
<b>Introduction to NONMEM 7</b><br>
They are distributed as PDF ﬁles on the NONMEM distribution media. They are also<br>present in HTML format as part of the HTML version of On-line help (Hyper-NMhelp).<br>
REFERENCES: Guide I<br>REFERENCES: Guide II<br>REFERENCES: Guide III<br>REFERENCES: Guide IV<br>REFERENCES: Guide V<br>REFERENCES: Guide VI<br>REFERENCES: Guide VII<br>REFERENCES: Guide VIII<br>REFERENCES: Guide Supplemental_V<br>REFERENCES: Guide Introduction_VI<br>REFERENCES: Guide Introduction_7<br>
629<br>
<hr>
<A name=635></a>VARIABLES DETAILED DESCRIPTIONS<br>
Help Guide<br>
VARIABLES IN MODULES<br>
MEANING: Variables in Modules<br>CONTEXT: Abbreviated code<br>
DISCUSSION:<br>Variables in certain FORTRAN modules may be used in abbreviated code. With NON-<br>MEM 7.2 and higher, either upper or lower case may be used.<br>
Variables in modules whose names start ROCM or PROCM may be used only on the right.<br>
Variables in modules whose names start NMPR or PRDPK may always be used on the<br>right and may sometimes be used on the left.<br>
Names of modules are reserved and may not be used in any block of abbreviated code.<br>
Provided is a list of blocks of abbreviated code and the modules and variables that may be<br>used. Second is a list of modules, the variables in the modules, and the blocks of abbrevi-<br>ated code in which these variables may be used.<br>
$AES<br>
NMPRD_INT: COMACT,COMSAV<br>
NMPRD_INT: NPROB,IPROB<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
NMPRD_INT: NTHES_,NETAS_,NEPSS_<br>
NMPR_INT: RPTI,RPTO,RPTON,PRDFL<br>
PKERR_REAL: MTIME<br>
PRMOD_INT: ICALL,IDEFD,IDEFA<br>
PRMOD_INT: MTDIFF<br>
PROCM_INT: ISFINL<br>
PROCM_INT: MNOW,MPAST,MNEXT<br>
PROCM_INT: NVNT<br>
PROCM_REAL: DOSREC<br>
PROCM_REAL: DOSTIM<br>
PROCM_REAL: EVTREC<br>
PROCM_REAL: THETA<br>
ROCM_INT: MIXNUM,MIXEST<br>
ROCM_INT: NIREC,NDREC<br>
ROCM_INT: NREP,IREP<br>
ROCM_REAL: MIXP<br>
$DES<br>
NMPRD_INT: COMACT,COMSAV<br>
NMPRD_INT: MSEC,MFIRST,IFIRSTEM<br>
NMPRD_INT: NPROB,IPROB<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
NMPRD_INT: NTHES_,NETAS_,NEPSS_<br>
NMPR_INT: RPTI,RPTO,RPTON,PRDFL<br>
PKERR_REAL: MTIME<br>
PRMOD_INT: ICALL,IDEFD,IDEFA<br>
PRMOD_INT: MTDIFF<br>
PROCM_INT: ISFINL<br>
PROCM_INT: MNOW,MPAST,MNEXT<br>
630<br>
<hr>
<A name=636></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
VARIABLES<br>
PROCM_INT: NVNT<br>
PROCM_REAL: DOSREC<br>
PROCM_REAL: DOSTIM<br>
PROCM_REAL: EVTREC<br>
PROCM_REAL: THETA<br>
ROCM_INT: MIXNUM,MIXEST<br>
ROCM_INT: NIREC,NDREC<br>
ROCM_INT: NREP,IREP<br>
ROCM_REAL: MIXP<br>
$ERROR<br>
CMNM1_INT: NIND_7<br>
NMPRD_INT: COMACT,COMSAV<br>
NMPRD_INT: MSEC,MFIRST,IFIRSTEM<br>
NMPRD_INT: NEWL2<br>
NMPRD_INT: NPROB,IPROB<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
NMPRD_INT: NTHES_,NETAS_,NEPSS_<br>
NMPRD_INT: MDVRES<br>
NMPRD_INT: NPDE_MODE<br>
NMPRD_INT: ETASXI<br>
NMPRD_INT: NOFIRSTDERCODE<br>
NMPRD_REAL: CORRL2<br>
NMPRD_REAL: ETA,EPS<br>
NMPR_INT: F_FLAG<br>
NMPR_INT: RPTI,RPTO,RPTON,PRDFL<br>
NMPR_REAL: CTLO<br>
NMPR_REAL: CTUP<br>
NMPR_REAL: YLO,YUP<br>
NMPR_REAL: THSIMP,OMSIMP,SGSIMP,THSIMPR<br>
PKERR_REAL: MTIME<br>
PRMOD_INT: MTDIFF<br>
PROCM_INT: MNOW,MPAST,MNEXT<br>
PROCM_INT: NEWIND<br>
PROCM_REAL: A<br>
ROCM_INT: LIREC<br>
ROCM_INT: MIXNUM,MIXEST<br>
ROCM_INT: NINDR,INDR1,INDR2<br>
ROCM_INT: NIREC,NDREC<br>
ROCM_INT: NREP,IREP<br>
ROCM_REAL: CNTID<br>
ROCM_REAL: CDEN_,DEN_<br>
ROCM_REAL: IIDX<br>
ROCM_REAL: MIXP<br>
ROCM_REAL: OMEGA<br>
ROCM_REAL: PR_CT<br>
ROCM_REAL: PR_Y<br>
ROCM_REAL: TEMPLT<br>
$INFN<br>
631<br>
<hr>
<A name=637></a>VARIABLES DETAILED DESCRIPTIONS<br>
Help Guide<br>
CMNM1_INT: NIND_7<br>
NMPRD_INT: NEWL2<br>
NMPRD_INT: NPROB,IPROB<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
NMPRD_INT: NWIND<br>
NMPRD_REAL: CORRL2<br>
NMPRD_REAL: ETA,EPS<br>
NMPRD_REAL: PASSRC<br>
NMPR_INT: F_FLAG<br>
NMPR_INT: RPTI,RPTO,RPTON,PRDFL<br>
NMPR_INT: SKIP_<br>
NMPR_REAL: THSIMP,OMSIMP,SGSIMP,THSIMPR<br>
PRMOD_INT: I_SS,ISSMOD<br>
ROCM_INT: IERE,IERC<br>
ROCM_INT: LIREC<br>
ROCM_INT: MIXNUM,MIXEST<br>
ROCM_INT: NINDR,INDR1,INDR2<br>
ROCM_INT: NIREC,NDREC<br>
ROCM_INT: NREP,IREP<br>
ROCM_REAL: CDEN_,DEN_<br>
ROCM_REAL: CNTID<br>
ROCM_REAL: IIDX<br>
ROCM_REAL: MIXP<br>
ROCM_REAL: OBJECT<br>
ROCM_REAL: PR_CT<br>
ROCM_REAL: PR_Y<br>
ROCM_REAL: SETHET,SEOMEG,SESIGM,SETHETR<br>
ROCM_REAL: THETAF,OMEGAF,SIGMAF,THETAFR<br>
ROCM_REAL: PRED_,RES_,WRES_,NPRED_,NRES_,NWRES_<br>
ROCM_REAL: CPRED_,CRES_,CWRES_,PREDI_,RESI_,WRESI_,<br>
ROCM_REAL: CPREDI_,CRESI_,CWRESI_,EPRED_,ERES_,EWRES_<br>
ROCM_REAL: NPDE_,ECWRES_<br>
$MIX<br>
NMPRD_INT: NPROB,IPROB<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
NMPRD_INT: NTHES_,NETAS_,NEPSS_<br>
ROCM_INT: NINDR,INDR1,INDR2<br>
ROCM_INT: NIREC,NDREC<br>
ROCM_INT: NREP,IREP<br>
ROCM_REAL: TEMPLT<br>
ROCM_REAL: THETA,DATA<br>
$PK<br>
CMNM1_INT: NIND_7<br>
NMPRD_INT: COMACT,COMSAV<br>
NMPRD_INT: MSEC,MFIRST,IFIRSTEM<br>
NMPRD_INT: NPROB,IPROB<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
NMPRD_INT: NTHES_,NETAS_,NEPSS_<br>
632<br>
<hr>
<A name=638></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
VARIABLES<br>
NMPRD_INT: MDVRES<br>
NMPRD_INT: NPDE_MODE<br>
NMPRD_INT: ETASXI<br>
NMPRD_INT: NOFIRSTDERCODE<br>
NMPRD_REAL: CORRL2<br>
NMPRD_REAL: ETA,EPS<br>
NMPR_INT: RPTI,RPTO,RPTON,PRDFL<br>
NMPR_REAL: THSIMP,OMSIMP,SGSIMP,THSIMPR<br>
PKERR_REAL: MTIME<br>
PRMOD_INT: I_SS,ISSMOD<br>
PRMOD_INT: MTDIFF<br>
PRMOD_REAL: A_0<br>
PROCM_INT: A_0FLG<br>
PROCM_INT: MNOW,MPAST,MNEXT<br>
PROCM_INT: NEWIND<br>
PROCM_REAL: A<br>
PROCM_REAL: DOSREC<br>
PROCM_REAL: DOSTIM<br>
PROCM_REAL: TSTATE<br>
ROCM_INT: LIREC<br>
ROCM_INT: MIXNUM,MIXEST<br>
ROCM_INT: NINDR,INDR1,INDR2<br>
ROCM_INT: NIREC,NDREC<br>
ROCM_INT: NREP,IREP<br>
ROCM_REAL: CNTID<br>
ROCM_REAL: CDEN_,DEN_<br>
ROCM_REAL: IIDX<br>
ROCM_REAL: MIXP<br>
ROCM_REAL: OMEGA<br>
ROCM_REAL: PR_CT<br>
ROCM_REAL: PR_Y<br>
$PRED<br>
CMNM1_INT: NIND_7<br>
NMPRD_INT: COMACT,COMSAV<br>
NMPRD_INT: I_REC<br>
NMPRD_INT: MSEC,MFIRST,IFIRSTEM<br>
NMPRD_INT: NEWL2<br>
NMPRD_INT: NPROB,IPROB<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
NMPRD_INT: NTHES_,NETAS_,NEPSS_<br>
NMPRD_INT: MDVRES<br>
NMPRD_INT: NPDE_MODE<br>
NMPRD_INT: ETASXI<br>
NMPRD_INT: NOFIRSTDERCODE<br>
NMPRD_REAL: CORRL2<br>
NMPRD_REAL: ETA,EPS<br>
NMPR_INT: F_FLAG<br>
NMPR_INT: RPTI,RPTO,RPTON,PRDFL<br>
NMPR_INT: SKIP_<br>
633<br>
<hr>
<A name=639></a>VARIABLES DETAILED DESCRIPTIONS<br>
Help Guide<br>
NMPR_REAL: CTLO<br>
NMPR_REAL: CTUP<br>
NMPR_REAL: THSIMP,OMSIMP,SGSIMP,THSIMPR<br>
NMPR_REAL: YLO,YUP<br>
ROCM_INT: IERE,IERC<br>
ROCM_INT: LIREC<br>
ROCM_INT: MIXNUM,MIXEST<br>
ROCM_INT: NINDR,INDR1,INDR2<br>
ROCM_INT: NIREC,NDREC<br>
ROCM_INT: NREP,IREP<br>
ROCM_REAL: CNTID<br>
ROCM_REAL: CDEN_,DEN_<br>
ROCM_REAL: IIDX<br>
ROCM_REAL: MIXP<br>
ROCM_REAL: OBJECT<br>
ROCM_REAL: OMEGA<br>
ROCM_REAL: PR_CT<br>
ROCM_REAL: PR_Y<br>
ROCM_REAL: SETHET,SEOMEG,SESIGM,SETHETR<br>
ROCM_REAL: TEMPLT<br>
ROCM_REAL: THETAF,OMEGAF,SIGMAF,THETAFR<br>
ROCM_REAL: PRED_,RES_,WRES_,NPRED_,NRES_,NWRES_<br>
ROCM_REAL: CPRED_,CRES_,CWRES_,PREDI_,RESI_,WRESI_,<br>
ROCM_REAL: CPREDI_,CRESI_,CWRESI_,EPRED_,ERES_,EWRES_<br>
ROCM_REAL: NPDE_,ECWRES_<br>
MODULES: VARIABLES<br>
BLOCKS<br>
CMNM1_INT: NIND_7<br>
$ERROR $PK $PRED $INFN<br>
NMPRD_INT: COMACT,COMSAV<br>
$DES $AES $ERROR $PK $PRED<br>
NMPRD_INT: I_REC<br>
$PRED<br>
NMPRD_INT: MSEC,MFIRST,IFIRSTEM<br>
$DES $ERROR $PK $PRED<br>
NMPRD_INT: NEWL2<br>
$ERROR $PRED $INFN<br>
NMPRD_INT: NPROB,IPROB<br>
$DES $AES $ERROR $MIX $PK $PRED $INFN<br>
NMPRD_INT: NTHES_,NETAS_,NEPSS_<br>
$DES $AES $ERROR $MIX $PK $PRED<br>
NMPRD_INT: NWIND<br>
$INFN<br>
NMPRD_INT: S1IT,S1NIT,S1NUM,S2IT,S2NIT,S2NUM<br>
$DES $AES $ERROR $MIX $PK $PRED $INFN<br>
NMPRD_REAL: CORRL2<br>
$ERROR $PK $PRED $INFN<br>
NMPRD_REAL: ETA,EPS<br>
$ERROR $PK $PRED $INFN<br>
NMPRD_REAL: PASSRC<br>
634<br>
<hr>
<A name=640></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
VARIABLES<br>
$INFN<br>
NMPR_INT: F_FLAG<br>
$ERROR $PRED $INFN<br>
NMPR_INT: RPTI,RPTO,RPTON,PRDFL<br>
$DES $AES $ERROR $PK $PRED $INFN<br>
NMPR_INT: SKIP_<br>
$PRED $INFN<br>
NMPR_REAL: CTLO<br>
$ERROR $PRED $ERROR $PRED<br>
NMPR_REAL: THSIMP,OMSIMP,SGSIMP,THSIMPR<br>
$PK $PRED $INFN<br>
NMPR_REAL: YLO,YUP<br>
$ERROR $PRED<br>
NMPR_REAL: THSIMP,OMSIMP,SGSIMP,THSIMPR<br>
$ERROR<br>
PKERR_REAL: MTIME<br>
$DES $AES $ERROR $PK<br>
PRMOD_INT: ICALL,IDEFD,IDEFA<br>
$DES $AES<br>
PRMOD_INT: I_SS,ISSMOD<br>
$PK $INFN<br>
PRMOD_INT: MTDIFF<br>
$DES $AES $ERROR $PK<br>
PRMOD_REAL: A_0<br>
$PK<br>
PROCM_INT: A_0FLG<br>
$PK<br>
PROCM_INT: ISFINL<br>
$DES $AES<br>
PROCM_INT: MNOW,MPAST,MNEXT<br>
$DES $AES $ERROR $PK<br>
PROCM_INT: NEWIND<br>
$ERROR $PK<br>
PROCM_INT: NVNT<br>
$DES $AES<br>
PROCM_REAL: A<br>
$ERROR $PK<br>
PROCM_REAL: DOSREC<br>
$DES $AES $PK<br>
PROCM_REAL: DOSTIM<br>
$DES $AES $PK<br>
PROCM_REAL: EVTREC<br>
$DES $AES<br>
PROCM_REAL: THETA<br>
$DES $AES<br>
PROCM_REAL: TSTATE<br>
$PK<br>
ROCM_INT: IERE,IERC<br>
$PRED $INFN<br>
ROCM_INT: LIREC<br>
635<br>
<hr>
<A name=641></a>VARIABLES DETAILED DESCRIPTIONS<br>
Help Guide<br>
$ERROR $PK $PRED $INFN<br>
ROCM_INT: MIXNUM,MIXEST<br>
$DES $AES $ERROR $PK $PRED $INFN<br>
ROCM_INT: NINDR,INDR1,INDR2<br>
$ERROR $MIX $PK $PRED $INFN<br>
ROCM_INT: NIREC,NDREC<br>
$DES $AES $ERROR $MIX $PK $PRED $INFN<br>
ROCM_INT: NREP,IREP<br>
$DES $AES $ERROR $MIX $PK $PRED $INFN<br>
ROCM_REAL: CDEN_,DEN_<br>
$ERROR $PK $PRED $INFN<br>
ROCM_REAL: CNTID<br>
$ERROR $PK $PRED $INFN<br>
ROCM_REAL: CPREDI_,CRESI_,CWRESI_,EPRED_,ERES_,EWRES_<br>
$PRED $INFN<br>
ROCM_REAL: CPRED_,CRES_,CWRES_,PREDI_,RESI_,WRESI_<br>
$PRED $INFN<br>
ROCM_REAL: IIDX<br>
$ERROR $PK $PRED $INFN<br>
ROCM_REAL: MIXP<br>
$DES $AES $ERROR $PK $PRED $INFN<br>
ROCM_REAL: NPDE_,ECWRES_<br>
$PRED $INFN<br>
ROCM_REAL: OBJECT<br>
$PRED $INFN<br>
ROCM_REAL: OMEGA<br>
$ERROR $PK $PRED<br>
ROCM_REAL: PRED_,RES_,WRES_,NPRED_,NRES_,NWRES_<br>
$PRED $INFN<br>
ROCM_REAL: PR_CT<br>
$ERROR $PK $PRED $INFN<br>
ROCM_REAL: PR_Y<br>
$ERROR $PK $PRED $INFN<br>
ROCM_REAL: SETHET,SEOMEG,SESIGM,SETHETR<br>
$PRED $INFN<br>
ROCM_REAL: TEMPLT<br>
$ERROR $MIX $PRED<br>
ROCM_REAL: THETA,DATA<br>
$MIX $PRED $INFN<br>
NONMEM RESERVED VARIABLES<br>
There are many other variables that are generally internal to NONMEM, and often are not<br>needed by users except occasionally, which are not explicitly recognized by NMTRAN.<br>Examples are<br>ITER_REPORT,BAYES_EXTRA_REQUEST,BAYES_EXTRA in module<br>NMBAYES_INT.<br>
Such variables can be used in abbreviated code if they are listed in include ﬁles whose<br>names start with NONMEM_RESERVED. See NONMEM_RESERVED_GENERAL in<br>directory ..\util. It needs to be copied from util to the present run directory so that NM-<br>TRAN has access to it.<br>
636<br>
<hr>
<A name=642></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
VARIABLES<br>
(See <b>abbreviated code</b>).<br>(See <b>Bayes Example 8</b>).<br>
REFERENCES: Guide Introduction_7<br>
637<br>
<hr>
<A name=643></a>VARIANCE-COVARIANCE DETAILED DESCRIPTIONS<br>
Help Guide<br>
VARIANCE-COVARIANCE<br>
MEANING: Variance-covariance matrix<br>CONTEXT: NONMEM output<br>
DISCUSSION:<br>NONMEM output refers to &quot;VARIANCE-COVARIANCE&quot; (or &quot;COVARIANCE&quot;) matri-<br>ces in three contexts:<br>
OMEGA and SIGMA<br>
OMEGA is the variance-covariance matrix for the ﬁrst level random effects ETA.<br>SIGMA is the variance-covariance matrix for the second-level random effects<br>EPSILON.<br>
Error messages referring to &quot;VARIANCE-COVARIANCE COMPONENTS&quot; arise<br>from difﬁculties with the initial estimates of OMEGA and/or SIGMA, either those<br>supplied by the user, or when no estimates are supplied, with those obtained in<br>NONMEM’s Initial Estimates Step. Initial estimates of both OMEGA and SIGMA<br>must be positive deﬁnite.<br>
With NONMEM 7.3 and higher, if the initial estimate of a block is not positive deﬁ-<br>nite because of rounding errors, a value will be added to the diagonal elements to<br>make it positive deﬁnite. A message in the NONMEM report ﬁle will indicate that<br>this was done. E.g.,<br>DIAGONAL SHIFT OF<br>
1.1000E-03 WAS IMPOSED TO ENSURE POS-<br>
ITIVE DEFINITENESS<br>
VAR-COV<br>
Error messages referring to &quot;VAR-COV&quot; (in particular, &quot;ESTIMATED TO BE SIN-<br>GULAR&quot; or &quot;ESTIMATED TO BE 0&quot;) arise when the variance-covariance matrix<br>for an individual’s data is non-positive deﬁnite. For example, with the error model<br>Y=F+F*EPS(1)<br>predicted values for some observations (i.e. values of F) may be zero or close to 0.<br>Then variances for these observations (which are proportional to F**2) are also zero,<br>and this gives rise to such an error message.<br>
COVARIANCE MATRIX OF ESTIMATE<br>
This variance-covariance matrix refers to an estimate of the variability and covari-<br>ability of the parameter estimates. It is computed in the Covariance Step, from the R<br>and S matrices. An error message from the Covariance Step, stating that one of<br>these two matrices is non-positive deﬁnite, indicates that the minimization procedure<br>did not ﬁnd a true or unique minimum (See <b>covariance</b>).<br>
REFERENCES: Guide I, section C.3.5.2<br>REFERENCES: Guide IV, section III.B.10 , III.B.11<br>REFERENCES: Guide V, section 5.4 , 13.4.3<br>
638<br>
<hr>
<A name=644></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
VERBATIM<br>
VERBATIM CODE<br>
MEANING: FORTRAN statements<br>CONTEXT: Abbreviated code<br>
USAGE:<br>&quot;<br>
verbatim line<br>
DISCUSSION:<br>Verbatim code is FORTRAN code within a block of abbreviated code that is to be copied<br>by NM-TRAN to the generated FORTRAN subroutine. It is not itself regarded as abbre-<br>viated code. Such code is marked by having the character &quot; as the ﬁrst non-blank charac-<br>ter. The &quot; is dropped and the characters to the right are copied as-is to columns 1-72 of<br>the generated subroutine. Lines of verbatim code can include any FORTRAN statements:<br>comment, declaration (e.g., INTEGER, COMMON, USE), I/O, CALL, assignment, con-<br>tinuation, DO, GOTO, etc.). Lower-case characters can be used freely, if the FORTRAN<br>compiler permits them.<br>
NM-TRAN does make some modiﬁcations to verbatim code, as follows:<br>
Placement of code<br>
The verbatim code is adjusted as necessary to conform to FORTRAN column con-<br>ventions. Alphabetic text that follows the initial &quot;, or that follows a statement num-<br>ber, is moved to column 7, as required by FORTRAN, except for:<br>
Comment lines<br>
If the character that immediately follows the initial &quot; is !, this conforms to the FOR-<br>TRAN 90 syntax for comment lines. The line is copied unchanged. If the character<br>that immediately follows the initial &quot; is C or c or &quot; or *, this conforms to the FOR-<br>TRAN 77 syntax for comment lines. The line is copied unchanged, but C or c or &quot;<br>or * is replaced by !. Example:<br>&quot;! this is a comment<br>
Continuation lines<br>
Fortran 77 continuation lines (non-blank in position 6) are not permitted with NON-<br>MEM 7. Instead, the line to be continued should end with character &amp;. Example:<br>&quot;<br>
X=A &amp;<br>
&quot;<br>
+D/E<br>
Replacement Rule<br>
In $PK, $ERROR, $DES, $AES, $INFN, and $PRED, in a line of abbreviated code<br>labels of items in the data record are replaced by direct references to the data record<br>itself (either DATREC or EVTREC, as appropriate). Thus, for example, if such a<br>label occurs as the left-hand side of an assignment statement, then without this rule,<br>when the statement is executed, the value of a local variable having the label is mod-<br>iﬁed, whereas with the rule, an item in the data record is modiﬁed.<br>
The character @, immediately before a label, can be used as an &quot;escape&quot; to prevent the<br>label from being replaced. If the character @ immediately follows the initial &quot;, none of<br>the labels occuring in the line are replaced.<br>
Labels occurring in common statements or as subroutine arguments are never replaced.<br>
Low-value Character<br>
Tab characters (and other characters that are smaller than blank in the computer’s<br>
639<br>
<hr>
<A name=645></a>VERBATIM DETAILED DESCRIPTIONS<br>
Help Guide<br>
collating sequence, such as carriage return ˆM) are permitted in verbatim code. With<br>NONMEM 7, the last non-blank character on the line is replaced by a space if it is a<br>low-value character. This permits DOS-type line endings ˆM.<br>
By default, all verbatim code goes in the main section of code and is called MAIN verba-<br>tim code. (The main section follows declarations and initial executable code inserted by<br>NM-TRAN.) Within the main section, verbatim and abbreviated code may be freely<br>mixed. Each line of verbatim code is positioned in the generated code after all code gen-<br>erated from the preceding line of abbreviated code. The user may explicitly specify a dif-<br>ferent location as follows.<br>
FIRST verbatim code<br>
Verbatim lines which must be positioned immediately after the declarations which<br>are part of the normal subroutine header, and prior to the FIRST executable state-<br>ment of the subroutine, must precede the ﬁrst line of abbreviated code and must start<br>with the line &quot;FIRST.<br>
MAIN verbatim code<br>
FIRST verbatim code is normally terminated by the ﬁrst line of abbreviated code. If<br>there is both FIRST and MAIN verbatim code, and/or the main section is to start<br>with verbatim code, the line &quot;MAIN may be used to separate the FIRST and MAIN<br>verbatim code.<br>
LAST verbatim code<br>
Verbatim lines which are to immediately precede the RETURN statement from the<br>generated subroutine must follow the last line of abbreviated code and must be pre-<br>ceded by the line &quot;LAST.<br>
Example:<br>
$ERROR<br>
Y=F*(1+ERR(1))<br>
&quot;LAST<br>
&quot; PRINT *,HH(1,1)<br>
This displays values after they hav e been assigned, immediately prior to the return.<br>
If any lines of verbatim code are present in a block of abbreviated code, NM-TRAN gen-<br>erates USE statements appropriate to the kind of abbreviated code and allows variables<br>undeﬁned in abbreviated code to be used as right-hand quantities in abbreviated code.<br>
Verbatim code is meant for use by expert users of NONMEM who are able to understand<br>the generated FORTRAN subroutine and check that the verbatim code has the desired<br>effect.<br>
REFERENCES: Guide IV, section IV.I<br>
640<br>
<hr>
<A name=646></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
WRITE<br>
WRITE FORMATS<br>
MEANING: PREDPP read-only global variables<br>
CONTEXT: User-supplied routines<br>
USAGE:<br>USE PROCM_CHAR, ONLY: FMT<br>
GLOBAL DECLARATION:<br>CHARACTER*80 FMT(3)<br>
DISCUSSION:<br>
FMT(1)<br>
A suitable format statement for WRITE statements when the full omega array is<br>written.<br>
FMT(2)<br>
A suitable format statement for WRITE statements when the full sigma array is writ-<br>ten.<br>
FMT(3)<br>
A suitable format statement for WRITE statements when the full theta array is writ-<br>ten.<br>
Location prior to NONMEM 7: procm8<br>
REFERENCES: None.<br>
641<br>
<hr>
<A name=647></a>WRITE DETAILED DESCRIPTIONS<br>
Help Guide<br>
WRITE PRINT<br>
MEANING: FORTRAN statements<br>CONTEXT: Abbreviated code<br>
SAMPLE:<br>
WRITE (50,*) 99,ID,CL,THETA(1),ETA(1)<br>
IF (ICALL.EQ.3) THEN<br>
WRITE (55,2) BIAS<br>
ENDIF<br>
DISCUSSION:<br>
Certain forms of FORTRAN WRITE, PRINT, OPEN, CLOSE, and REWIND statements<br>may be used anywhere in $PRED, $INFN, $PK, $ERROR, $DES, $AES, $AESINITIAL<br>blocks.<br>
PRINT list ...<br>PRINT *,list ...<br>WRITE (unit,format) list ...<br>WRITE (*,format) list ...<br>WRITE (unit,*) list ...<br>WRITE (*,*) list ...<br>OPEN(unit)<br>OPEN(unit,FILE=ﬁlename)<br>CLOSE(unit)<br>REWIND(unit)<br>
Single or double quotes around the ﬁlename are optional. However, if the ﬁlename con-<br>tains commas, semicolons, or parentheses, then it must be surrounded by single quotes ’<br>or double quotes &quot;. Filename may also contain equal signs if it is enclosed in quotes.<br>
If the ﬁle is opened by NM-TRAN, ﬁlename may contain embedded spaces if it is<br>enclosed in quotes, and may contain at most 80 characters. If the ﬁle is opened by NON-<br>MEM, ﬁlename may not contain embedded spaces, and may contain at most 71 charac-<br>ters.<br>
unit<br>
6, n or *.<br>
6 indicates the unit connected to the NONMEM output ﬁle<br>n indicates the number of an alternative unit (40&lt;n&lt;2000).<br>* indicates a FORTRAN system-dependent output (with most systems, this is<br>equivalent to using unit 6, but see the FORTRAN documentation) With OPEN,<br>CLOSE and REWIND, the unit may not be 6 or *.<br>
format<br>
*, 1, 2, 991, or 992.<br>
* indicates list-directed output. (FORTRAN library routines will select a format<br>appropriate for the current run-time value of the quantity when displayed.)<br>
1 or 991 requests the built-in format speciﬁcation:<br>
991 FORMAT (35F14.4)<br>
2 or 992 requests the built-in format speciﬁcation:<br>
992 FORMAT (35E15.7)<br>
642<br>
<hr>
<A name=648></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
WRITE<br>
(Format speciﬁcation numbers 991 and 992 are used in generated code to avoid<br>conﬂict with statement numbers arising from DO WHILE statements. The one<br>digit versions are perhaps easier to remember.)<br>
(No integer format speciﬁcation is provided because constants are stored as<br>ﬂoating point variables in generated and library routines.)<br>
list A list of one or more right-hand quantities, i.e., variables or constants that may<br>
appear on the right in abbreviated code. May not include expressions or names of<br>abbreviated functions. When subscripts are appropriate, these must be integer con-<br>stants, declared integer variables, or expressions involving such constants and vari-<br>ables.<br>
With a PRINT statement, a list may also include character constants. A character<br>constant is delimited by single or double quotes (’ or &quot;). As with any Fortran char-<br>acter constant, a pair of adjacent delimiters within the constant represents a single<br>character. E.g., PRINT *,’A isn’’t B’ will appear in the output as:<br>A isn’t B<br>
In an initialization or ﬁnalization block, a list may include elements of the OMEGA<br>and SIGMA arrays. In a ﬁnalization block, a list may include elements of the stan-<br>dard error arrays (SETHET,SETHETR,SEOMEG and SESIGM).<br>
Any array whose elements may be listed individually in a WRITE or PRINT state-<br>ment may also be written in its entirety, by listing it without any subscripts. Speciﬁ-<br>cally, one or more of the following may be included in a list:<br>
THETA THETAFR SETHET SETHETR<br>
THSIMP ETA THSIMPR<br>
OMEGA(BLOCK) OMEGA(DIAG) SEOMEG(BLOCK) SEOMEG(DIAG)<br>
OMSIMP(BLOCK) OMSIMP(DIAG)<br>
SIGMA(BLOCK) SIGMA(DIAG) SESIGM(BLOCK) SESIGM(DIAG)<br>
SGSIMP(BLOCK) SGSIMP(DIAG)<br>
IIDX CNTID IIDX,CNTID<br>
Note that IIDX and CNTID are arrays in a module;<br>(See <b>Objective Function Value Individual</b>).<br>When &quot;IIDX&quot; or &quot;CNTID&quot; is listed, then only that array is written. When<br>&quot;IIDX,CNTID&quot; is speciﬁed, then pairs of values are written, one pair per line, one<br>pair for each individual record.<br>
The option BLOCK requests that the entire array be written in full symmetric form.<br>The option DIAG requests that only the diagonal elements be written. DIAG may<br>also be coded DIAGONAL. Arrays of possibly different sizes (e.g., OMEGA and<br>SIGMA) may not be listed together in the same WRITE statement. If a WRITE<br>statement requests that an entire array be written, then the only other items that may<br>be listed with the statement are other entire arrays.<br>
When entire arrays are written, the format speciﬁcation with a WRITE statement must be<br>*. With either a WRITE or PRINT statement, an appropriate format is created by the<br>NONMEM system. With these formats, elements of the standard error arrays that do not<br>exist have the value 1E10 and are printed as 0.1000000E+11. (Such elements appear in<br>NONMEM output as dots (.........).) If the covariance step fails or is not requested, all ele-<br>ments of the standard error arrays are 0 and are printed as 0.0000000E+00.<br>
Example: To write the omega matrix and its standard errors in symmetric form code the<br>following. (Only as many elements will be written as are appropriate for the dimension<br>
643<br>
<hr>
<A name=649></a>WRITE DETAILED DESCRIPTIONS<br>
Help Guide<br>
of omega in the problem.)<br>
IF (ICALL.EQ.3) WRITE (99,*) OMEGA(BLOCK),SEOMEG(BLOCK)<br>
A list may also include a vector element or the entire vector (by listing the vector without<br>a subscript).<br>
The OPEN, CLOSE, and REWIND statements are part of the FORTRAN language. For<br>details (i.e., the relationship of external ﬁles to units), see the Language Reference Man-<br>ual and the Users Guide for your compiler.<br>
REFERENCES: None.<br>
644<br>
<hr>
<A name=650></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
XML COMPARE<br>
XML COMPARE<br>
MEANING: XML_COMPARE program<br>CONTEXT: NONMEM run<br>
The utility program xml_compare compares the contents of two NONMEM report XML<br>ﬁles that are produced by NONMEM.<br>
USAGE:<br>xml_compare myresult1.xml myresult2.xml myprecision.xtl &gt;mydifferences.txt<br>
where delimiter is {, t s} for {comma tab space}, and myprecision.xtl is a precision speci-<br>ﬁcation or control ﬁle. Default delimiter is space and default control ﬁle is xml_com-<br>pare.xtl. It is useful to redirect difference results to a ﬁle, in this example mydiffer-<br>ences.txt.<br>
The control ﬁle can be quite elaborate, but it allows speciﬁcation of various precision val-<br>ues for the many different types of values in the NONMEM report XML ﬁle, and to<br>ignore certain entries as well. An example xml_compare.xtl ﬁle is in the util directory,<br>and has the following contents:<br>
$IGNORE<br>
monitor<br>
elapsed_time<br>
datetime<br>
covariance_status<br>
termination_status<br>
nonmem(version)<br>
$PRECISION<br>
GENERAL=0.2,0.2 OBJ_BAYES=2.0,0.0 OBJ_SAEM=0,100.0<br>
OBJ_ITS=0,5.0 OBJ_IMP=0,10.0 OBJ_F=0,5.0<br>
DIAG=0.3,0 OFFDIAG=0,0.5 COR=0.0,0.3 VAR=0.3,0.1 COV=-1.0<br>
EIGENVALUES=2.0,0 OBJ_DIRECT=0,100.0<br>
correlation_o=-1.0 INVCOVARIANCE_O=-1 INVCOVARIANCE_D=-1<br>
etashrink=0,20 epsshrink=0,10<br>
METHOD=DIRECT ALL=-1<br>
METHOD=SAEM epsshrink=0,20<br>
The $IGNORE record will ignore all elements that are listed, or just a speciﬁc attribute of<br>an element, such as nonmem(version).<br>
Under the $PRECISION record, a<br>GENERAL=R,A<br>
can be given for most items, where relative is the relative tolerance, and absolute is the<br>absolute tolerance. Following the GENERAL speciﬁcation, tolerances may be speciﬁed<br>for other items.<br>
Tw o items of identical element and attributes are compared between the two ﬁles, where<br>the equation for comparison is, between value X of xml ﬁle 1 and value Y of xml ﬁle 2,<br>
ABS(X-Y)&gt;R*MAX(ABS(X),ABS(Y))+A<br>
The OBJ_BAYES is given a special test, as it has a standard deviation with it:<br>
STD(X,Y)=SQRT(STD(X)2+ STD(Y)2)<br>ABS(X-Y)&gt;R*STD(X,Y)+A<br>
645<br>
<hr>
<A name=651></a>XML COMPARE DETAILED DESCRIPTIONS<br>
Help Guide<br>
In the above example OBJ_BAYES=(2,0) means that if the Bayes objective functions in<br>the two ﬁles differ by more than 2 standard deviations, then the difference is noted.<br>
To ignore an item for comparison, specify -1. To specify an exact comparison, use 0,0.<br>To refer to a particular optimization method, then enter METHOD=SAEM for example,<br>and thereafter, all entries of items pertain to that estimation method, until METHOD is<br>changed.<br>
The METHOD attribute may have one of the following settings:<br>
FOCE, ITS, IMP, SAEM, DIRECT, BAYES<br>
For the total list of items, and their scope:<br>
See <b>INTRODUCTION TO NONMEM 7, xml_compare Utility Program and its Use<br>for Installation Qualiﬁcation</b><br>
Because of the versatility of selecting which items are to be compared and with what pre-<br>cision, the xml_compare program can be used for batch processing installation qualiﬁca-<br>tion procedures, in comparing NONMEM results of a test run against a reference run.<br>All results given in the standard NONMEM output ﬁle are also reported in the XML ﬁle.<br>
REFERENCES: Guide Introduction_7<br>
646<br>
<hr>
<A name=652></a>Help Guide<br>
DETAILED DESCRIPTIONS<br>
YLO<br>
YLO YUP<br>
MEANING: NONMEM-PRED global variables<br>CONTEXT: PRED routine<br>
USAGE:<br>USE NMPR_REAL, ONLY: YLO,YUP<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: YLO,YUP<br>
DISCUSSION:<br>If an observation is assumed to be normally distributed, with mean and variance speciﬁed<br>for NONMEM as usual, then the likelihood for the observation is conditioned on the<br>observation being in (or outside) an interval deﬁned by the values YLO and YUP. If<br>YLO is less than YUP, then the likelihood of the observation is conditioned on the obser-<br>vation being in the interval with lower bound YLO and upper bound YUP. If YLO is<br>greater than YUP, then the likelihood of the observation is conditioned on the observation<br>being outside the interval with lower bound YUP and upper bound YLO. These values<br>may be set with the data record containing the observation. They may be set in $PRED<br>and $ERROR abbreviated codes. If YLO or YUP is not set, it is assumed to be minus<br>inﬁnity or plus inﬁnity, respectively. When YLO or YUP is set, the Laplacian estimation<br>method must be used.<br>
PR_Y is the estimated probability that an observation will fall within (or outside) the<br>interval.<br>
(See <b>pr_y</b>, <b>YLO_YUP_Probability:_PR_Y</b>).<br>
Location prior to NONMEM 7: nmpr12<br>
REFERENCES: None.<br>
647<br>
<hr>
<A name=653></a>YLO DETAILED DESCRIPTIONS<br>
Help Guide<br>
YLO YUP PROBABILITY: PR Y<br>
MEANING: NONMEM read-only global variables<br>CONTEXT: User-supplied routines<br>
USAGE:<br>USE ROCM_REAL, ONLY: PR_Y<br>
GLOBAL DECLARATION:<br>USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE) :: PR_Y<br>
DISCUSSION:<br>
When with a given data record, either of the limits YLO or YUP are set so that during the<br>analysis an interval is deﬁned in which (or outside of which) an observation is condi-<br>tioned to exist, then during a copying pass (and during ICALL=5 and 6), PR_Y is the<br>estimated probability that an observation will fall within (or outside) the interval.<br>(See <b>YLO YUP</b>)<br>(See <b>copying_block</b>, <b>expectation</b>)<br>(See <b>data average</b>)<br>
For the purpose of computing this probability, an actual observation need not exist in the<br>record. If the mean and variance of the intra-individual model for a potential observation<br>are speciﬁed, and if the limits YLO or YUP are set, a value of PR_Y will be computed,<br>whether the record has MDV=0 or MDV=1. If neither YLO nor YUP are set, the value<br>PR_Y will be 1.<br>
PR_Y may be used as a right-hand quantity in abbreviated code for $PRED, $PK,<br>$ERROR, and $INFN blocks.<br>
Location prior to NONMEM 7: rocm44<br>
REFERENCES: None.<br>
648<br>
<hr>
<A name=654></a>Help Guide<br>
EXAMPLES EXAMPLES<br>
EXAMPLES<br>
EX-649<br>
<hr>
<A name=655></a>Help Guide<br>
EXAMPLES ABBREVIATED<br>
ABBREVIATED FUNCTION EXAMPLES<br>
Here is an example of the use and construction of a function of both time and the ﬁrst-<br>order elimination rate constant of a simple PK one-compartment model, to compute the<br>amount in the system at a given time.<br>(See <b>abbreviated_function</b>).<br>
$PRED<br>
...<br>
VECTRA(1)=THETA(1)*EXP(ETA(1))<br>
VECTRA(2)=TIME<br>
...<br>
A=DOSE*FUNCA(VECTRA)<br>
...<br>
With the $ABBREVIATED REPLACE feature, the function name can be changed to one<br>that is perhaps easier to understand.<br>
$ABBR REPLACE ONE_COMPARTMENT_LINEAR=FUNCA<br>
...<br>
$PRED<br>
...<br>
VECTRA(1)=THETA(1)*EXP(ETA(1))<br>
VECTRA(2)=TIME<br>
...<br>
A=DOSE*ONE_COMPARTMENT_LINEAR(VECTRA)<br>
...<br>
Either way, one needs to supply the function.<br>
FUNCTION FUNCA(X,X1,X2)<br>
! Implements the One Compartment Linear model<br>
USE SIZES, ONLY: DPSIZE<br>
REAL(KIND=DPSIZE), INTENT(IN)<br>
:: X<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: X1,X2<br>
REAL(KIND=DPSIZE) :: FUNCA<br>
DIMENSION :: X(9),X1(9),X2(9,9)<br>
REAL(KIND=DPSIZE) :: EXPT<br>
! THE FUNCTION ITSELF<br>
EXPT=EXP(-X(1)*X(2))<br>
FUNCA=EXPT<br>
! 1ST. PARTIALS<br>
X1(1)=-EXPT*X(2)<br>
X1(2)=-EXPT*X(1)<br>
! 2ND. PARTIALS<br>
X2(1,1)=EXPT*X(2)*X(2)<br>
X2(1,2)=EXPT*X(1)*X(2)<br>
X2(2,1)=EXPT*X(1)*X(2)<br>
X2(2,2)=EXPT*X(1)*X(1)<br>
RETURN<br>
END<br>
EX-1<br>
<hr>
<A name=656></a>ABBREVIATED EXAMPLES<br>
Help Guide<br>
Suppose the above code is in ﬁle ONE_COMPARTMENT_LINEAR.f90.<br>Then the control stream should also include<br>$SUBROUTINES OTHER=ONE_COMPARTMENT_LINEAR.f90<br>
Multiple functions can be used with the $ABBREVIATED REPLACE feature. Suppose<br>two functions are needed, called (for example) RED and GREEN. The control stream<br>might contain the following fragment:<br>
$SUBR OTHER=red.f90 OTHER=green.f90<br>
...<br>
$ABBR REPLACE RED=FUNCA<br>
$ABBR REPLACE GREEN=FUNCB<br>
...<br>
$PRED<br>
...<br>
VECTRA(1)=THETA(1)*EXP(ETA(1))<br>
VECTRA(2)=TIME<br>
A=DOSE*RED(VECTRA)<br>
B=DOSE*GREEN(VECTRA)<br>
...<br>
The ﬁle red.f90 contains code for FUNCA, and the ﬁle green.f90 contains code for<br>FUNCB.<br>
The $ABBREVIATED REPLACE feature could also be used to provide more meaningful<br>names for reserved vectors. For example, suppose the arguments of the functions are dif-<br>ferent vectors.<br>
$ABBR REPLACE RED=FUNCA, REDARG=VECTRA<br>
$ABBR REPLACE GREEN=FUNCB, GREENARG=VECTRB<br>
...<br>
$PRED<br>
...<br>
REDARG(1)=...<br>
REDARG(2)=...<br>
GREENARG(1)=...<br>
GREENARG(2)=...<br>
A=DOSE*RED(REDARG)<br>
B=DOSE*GREEN(GREENARG)<br>
...<br>
REFERENCES: Guide Introduction_7<br>
EX-2<br>
<hr>
<A name=657></a>Help Guide<br>
EXAMPLES BAYES1<br>
BAYES EXAMPLE 1<br>
This is example1.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Two compartment Model, Using ADVAN3, TRANS4<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# Example 1 (from samp5l)<br>
$INPUT C SET ID JID TIME<br>
DV=CONC AMT=DOSE RATE EVID MDV CMT CLX<br>
V1X QX V2X SDIX SDSX<br>
$DATA example1.csv IGNORE=C<br>
$SUBROUTINES ADVAN3 TRANS4<br>
$PK<br>
; The thetas are MU modeled.<br>
; Best that there is a linear relationship between THETAs and Mus<br>
; The linear MU modeling of THETAS allows them to be efficiently<br>
; Gibbs sampled.<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
CL=DEXP(MU_1+ETA(1))<br>
V1=DEXP(MU_2+ETA(2))<br>
Q=DEXP(MU_3+ETA(3))<br>
V2=DEXP(MU_4+ETA(4))<br>
S1=V1<br>
$ERROR<br>
Y = F + F*EPS(1)<br>
; Initial values of THETA<br>
$THETA<br>
(0.001, 2.0) ;[LN(CL)]<br>
(0.001, 2.0) ;[LN(V1)]<br>
(0.001, 2.0) ;[LN(Q)]<br>
(0.001, 2.0) ;[LN(V2)]<br>
;INITIAL values of OMEGA<br>
$OMEGA BLOCK(4)<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
EX-3<br>
<hr>
<A name=658></a>BAYES1 EXAMPLES<br>
Help Guide<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
;Initial value of SIGMA<br>
$SIGMA<br>
(0.6 )<br>
;[P]<br>
;Prior information is important for MCMC Bayesian analysis,<br>
;not necessary for maximization methods<br>
;Note the syntax used for defining priors that is available<br>
;as of NONMEM 7.3<br>
$PRIOR NWPRI<br>
; Prior information of THETAS<br>
$THETAP (2.0 FIX)X4<br>
; Variance to prior information of THETAS.<br>
; Because variances are very large, this means that the prior<br>
; information to the THETAS is highly uninformative.<br>
$THETAPV BLOCK(4) FIX VALUES(10000,0.0)<br>
; Prior information to the OMEGAS.<br>
$OMEGAP BLOCK(4) FIX VALUES(0.2,0.0)<br>
; Degrees of freedom to prior OMEGA matrix.<br>
; Because degrees of freedom is very low, equal to the<br>
; the dimension of the prior OMEGA, this means that the<br>
; prior information to the OMEGAS is highly uninformative<br>
$OMEGAPD (4 FIX)<br>
; Prior information to the SIGMAS<br>
$SIGMAP 0.06 FIX<br>
; Degrees of freedom to prior SIGMA matrix.<br>
; Because degrees of freedom is very low, equal to the<br>
; the dimension of the prior SIGMA, this means that the<br>
; prior information to the SIGMA is highly uninformative<br>
$SIGMAPD (1 FIX)<br>
; The first analysis is iterative two-stage,<br>
; maximum of 500 iterations (NITER), iteration results<br>
; are printed every 5 iterations, gradient precision (SIGL) is 4.<br>
; Termination is tested on all of<br>
; the population parameters (CTYPE=3),<br>
; and for less then 2 significant digits change (NSIG).<br>
; Prior information is not necessary for ITS, so NOPRIOR=1.<br>
; The intermediate and final results of the ITS method will be<br>
; recoded in row/column format in example1.ext<br>
$EST METHOD=ITS MAPITER=0 INTERACTION FILE=example1.ext NITER=500<br>
EX-4<br>
<hr>
<A name=659></a>Help Guide<br>
EXAMPLES BAYES1<br>
PRINT=5 NOABORT SIGL=4 CTYPE=3 CITER=10<br>
CALPHA=0.05 NOPRIOR=1 NSIG=2<br>
; The results of ITS are used as the initial values for the<br>
; SAEM method. A maximum of 3000 ; stochastic iterations (NBURN)<br>
; is requested, but may end early if statistical test determines<br>
; that variations in all parameters is stationary<br>
; (note that any settings from the previous $EST<br>
; carries over to the next $EST statement, within a $PROB).<br>
; The SAEM is a Monte Carlo process,<br>
; so setting the SEED assures repeatability of results.<br>
; Each iteration obtains only 2 Monte Carlo samples ISAMPLE),<br>
;<br>
so they are very fast.<br>
; But many iterations are needed, so PRINT only<br>
; every 100th iteration.<br>
; After the stochastic phase, 500 accumulation iterations will be<br>
; Performed (NITER), to obtain good parameters estimates with<br>
; little stochastic noise.<br>
; As a new FILE has not been given, the SAEM results will append to<br>
; example1.ext.<br>
$EST METHOD=SAEM INTERACTION NBURN=3000 NITER=500 PRINT=100<br>
SEED=1556678 ISAMPLE=2<br>
; After the SAEM method, obtain good estimates of the marginal<br>
; density (objective function),<br>
; along with good estimates of the standard errors.<br>
; This is best done with importance sampling ; (IMP),<br>
; performing the expectation step only (EONLY=1), so that<br>
; final population parameters remain at the final SAEM result.<br>
; Five iterations (NITER) should allow the importance sampling<br>
; proposal density to become stationary.<br>
; This is observed by the objective function settling<br>
; to a particular value (with some stochastic noise).<br>
; By using 3000 Monte Carlo samples<br>
; (ISAMPLE), this assures a precise assessment of standard errors.<br>
$EST METHOD=IMP<br>
INTERACTION EONLY=1 NITER=5 ISAMPLE=3000 PRINT=1<br>
SIGL=8 NOPRIOR=1<br>
; The Bayesian analysis is performed.<br>
; While 10000 burn-in iterations are requested as a maximum,<br>
; because the termination test is on (CTYPE&lt;&gt;0, set at the<br>
; first $EST statement), and because the initial parameters are at<br>
; the SAEM result, which is the maximum likelihood position,<br>
; the analysis should settle down to a stationary distribution in<br>
; several hundred iterations.<br>
; Prior information is also used to facilitate Bayesian analysis.<br>
; The individual Bayesian iteration results are important,<br>
; and may be need for post-processing analysis.<br>
EX-5<br>
<hr>
<A name=660></a>BAYES1 EXAMPLES<br>
Help Guide<br>
; So specify a separate FILE for the Bayesian analysis.<br>
$EST METHOD=BAYES INTERACTION FILE=example1.txt NBURN=10000<br>
NITER=10000 PRINT=100 NOPRIOR=0<br>
; Just for old-times sake, let’s see what the traditional<br>
; FOCE method will give us.<br>
; And, remember to introduce a new FILE, so its results won’t<br>
; append to our Bayesian FILE.<br>
; Appending to example1.ext with the EM methods is fine.<br>
$EST METHOD=COND INTERACTION MAXEVAL=9999 NSIG=3 SIGL=10<br>
PRINT=5 NOABORT NOPRIOR=1<br>
FILE=example1.ext<br>
; Time for the standard error results.<br>
; You may request a more precise gradient precision (SIGL)<br>
; that differed from that used during estimation.<br>
$COV MATRIX=R PRINT=E UNCONDITIONAL SIGL=12<br>
; Print out results in tables. Include some of the new weighted<br>
; residual types<br>
$TABLE ID TIME PRED RES WRES CPRED CWRES EPRED ERES EWRES NOAPPEND<br>
ONEHEADER FILE=example1.TAB NOPRINT<br>
$TABLE ID CL V1 Q V2 FIRSTONLY NOAPPEND NOPRINT FILE=example1.PAR<br>
$TABLE ID ETA1 ETA2 ETA3 ETA4 FIRSTONLY NOAPPEND<br>
NOPRINT FILE=example1.ETA<br>
REFERENCES: Guide Introduction_7<br>
EX-6<br>
<hr>
<A name=661></a>Help Guide<br>
EXAMPLES BAYES1B<br>
BAYES EXAMPLE 1B<br>
This is example1B.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Two compartment Model, Using ADVAN3, TRANS4<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# Example 1B (from samp5l)<br>
$INPUT C SET ID JID TIME<br>
DV=CONC AMT=DOSE RATE EVID MDV CMT CLX<br>
V1X QX V2X SDIX SDSX<br>
$DATA example1b.csv IGNORE=C<br>
$SUBROUTINES ADVAN3 TRANS4<br>
$PK<br>
; The thetas are MU modeled.<br>
; Best that there is a linear relationship between THETAs and Mus<br>
; The linear MU modeling of THETAS allows them to be efficiently<br>
; Gibbs sampled.<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
CL=DEXP(MU_1+ETA(1))<br>
V1=DEXP(MU_2+ETA(2))<br>
Q=DEXP(MU_3+ETA(3))<br>
V2=DEXP(MU_4+ETA(4))<br>
S1=V1<br>
$ERROR<br>
Y = F + F*EPS(1)<br>
; Initial values of THETA<br>
$THETA<br>
(0.001, 2.0) ;[LN(CL)]<br>
(0.001, 2.0) ;[LN(V1)]<br>
(0.001, 2.0) ;[LN(Q)]<br>
(0.001, 2.0) ;[LN(V2)]<br>
;INITIAL values of OMEGA<br>
$OMEGA BLOCK(4)<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
EX-7<br>
<hr>
<A name=662></a>BAYES1B EXAMPLES<br>
Help Guide<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
;Initial value of SIGMA<br>
$SIGMA<br>
(0.6 )<br>
;[P]<br>
;NTHETA=number of Thetas to be estimated<br>
;NETA=number of Etas to be estimated<br>
;<br>
(and to be described by NETAxBETA OMEGA matrix)<br>
;NTHP=number of thetas which have a prior<br>
;NETP=number of Omegas with prior<br>
;Prior information is important for MCMC Bayesian analysis,<br>
; not necessary for maximization methods<br>
$PRIOR NWPRI NTHETA=4, NETA=4, NTHP=4, NETP=4<br>
; Prior information of THETAS<br>
$THETAP (2.0 FIX) (2.0 FIX) (2.0 FIX) (2.0 FIX)<br>
; Variance to prior information of THETAS.<br>
; Because variances are very large, this<br>
; means that prior information to the THETAS is highly uninformative.<br>
$THETAPV BLOCK(4)<br>
10000 FIX<br>
0.00 10000<br>
0.00 0.00 10000<br>
0.00 0.00 0.0 10000<br>
; Prior information to the OMEGAS.<br>
$OMEGAP BLOCK(4)<br>
0.2 FIX<br>
0.0 0.2<br>
0.0 0.0 0.2<br>
0.0 0.0 0.0 0.2<br>
; Degrees of freedom to prior OMEGA matrix.<br>
; Because degrees of freedom is very low, equal to the<br>
; the dimension of the prior OMEGA, this means that the<br>
; prior information to the OMEGAS is highly uninformative<br>
$OMEGAPD (4 FIX)<br>
; The first analysis is iterative two-stage,<br>
; maximum of 500 iterations (NITER), iteration results<br>
; are printed every 5 iterations, gradient precision (SIGL) is 4.<br>
; Termination is tested on all of<br>
EX-8<br>
<hr>
<A name=663></a>Help Guide<br>
EXAMPLES BAYES1B<br>
; the population parameters (CTYPE=3),<br>
; and for less then 2 significant digits change (NSIG).<br>
; Prior information is not necessary for ITS, so NOPRIOR=1.<br>
; The intermediate and final results<br>
; of the ITS method will be recoded in row/column format in<br>
; example1b.ext<br>
$EST METHOD=ITS MAPITER=0 INTERACTION FILE=example1b.ext NITER=500<br>
PRINT=5 CINTERVAL=5 NOABORT SIGL=4 CTYPE=3 CITER=10<br>
CALPHA=0.05 NOPRIOR=1 NSIG=2<br>
; The results of ITS are used as the initial values for the SAEM<br>
; method. A maximum of 3000 ; stochastic iterations (NBURN) is<br>
; requested, but may end early if statistical test determines<br>
; that variations in all parameters is stationary<br>
; (note that any settings from the previous $EST<br>
; carries over to the next $EST statement, within a $PROB).<br>
; The SAEM is a Monte Carlo process,<br>
; so setting the SEED assures repeatability of results.<br>
; Each iteration obtains only 2 Monte Carlo samples ISAMPLE),<br>
;<br>
so they are very fast.<br>
; But many iterations are needed, so PRINT only<br>
; every 100th iteration.<br>
; After the stochastic phase, 500 accumulation iterations will be<br>
; Performed (NITER), to obtain good parameters estimates with<br>
; little stochastic noise.<br>
; As a new FILE has not been given, the SAEM results will append to<br>
; example1b.ext.<br>
$EST METHOD=SAEM INTERACTION NBURN=3000 NITER=500<br>
PRINT=250 CINTERVAL=100<br>
SEED=1556678 ISAMPLE=2<br>
; After the SAEM method, obtain good estimates of the marginal<br>
; density (objective function),<br>
; along with good estimates of the standard errors.<br>
; This is best done with importance sampling ; (IMP),<br>
; performing the expectation step only (EONLY=1), so that<br>
; final population parameters remain at the final SAEM result.<br>
; Five iterations (NITER) should allow the importance sampling<br>
; proposal density to become stationary.<br>
; This is observed by the objective function settling<br>
; to a particular value (with some stochastic noise).<br>
; By using 3000 Monte Carlo samples<br>
; (ISAMPLE), this assures a precise assessment of standard errors.<br>
$EST METHOD=IMP<br>
INTERACTION EONLY=1<br>
MAPITER=0 NITER=5<br>
ISAMPLE=3000 PRINT=1 SIGL=8 NOPRIOR=1<br>
$EST METHOD=DIRECT INTERACTION EONLY=1 NITER=3 ISAMPLE=3000<br>
PRINT=1 SIGL=8 NOPRIOR=1<br>
EX-9<br>
<hr>
<A name=664></a>BAYES1B EXAMPLES<br>
Help Guide<br>
; The Bayesian analysis is performed.<br>
; While 10000 burn-in iterations are requested as a maximum,<br>
; because the termination test is on (CTYPE&lt;&gt;0, set at the<br>
; first $EST statement), and because the initial parameters are at<br>
; the SAEM result, which is the maximum likelihood position,<br>
; the analysis should settle down to a stationary distribution in<br>
; several hundred iterations.<br>
; Prior information is also used to facilitate Bayesian analysis.<br>
; The individual Bayesian iteration results are important,<br>
; and may be need for post-processing analysis.<br>
; So specify a separate FILE for the Bayesian analysis.<br>
$EST METHOD=BAYES INTERACTION FILE=example1b.txt NBURN=10000<br>
NITER=10000 PRINT=1000 CINTERVAL=100 NOPRIOR=0<br>
; Just for old-times sake, let’s see what the traditional<br>
; FOCE method will give us.<br>
; And, remember to introduce a new FILE, so its results won’t<br>
; append to our Bayesian FILE.<br>
; Appending to example1b.ext with the EM methods is fine.<br>
$EST METHOD=COND INTERACTION MAXEVAL=9999 NSIG=3 SIGL=10<br>
PRINT=5 NOABORT NOPRIOR=1<br>
FILE=example1b.ext<br>
; Time for the standard error results.<br>
; You may request a more precise gradient precision (SIGL)<br>
; that differed from that used during estimation.<br>
$COV MATRIX=R PRINT=E UNCONDITIONAL SIGL=12<br>
; Print out results in tables. Include some of the new weighted<br>
; residual types<br>
$TABLE ID TIME PRED RES WRES CPRED CWRES EPRED ERES EWRES NOAPPEND<br>
ONEHEADER FILE=example1b.TAB NOPRINT<br>
$TABLE ID CL V1 Q V2 FIRSTONLY NOAPPEND NOPRINT FILE=example1b.PAR<br>
FORMAT=,1PE15.8<br>
$TABLE ID ETA1 ETA2 ETA3 ETA4 FIRSTONLY NOAPPEND NOPRINT<br>
FILE=example1b.ETA FORMAT=,1PE15.8<br>
REFERENCES: Guide Introduction_7<br>
EX-10<br>
<hr>
<A name=665></a>Help Guide<br>
EXAMPLES BAYES2<br>
BAYES EXAMPLE 2<br>
This is example2.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Two Compartment model with Clearance and<br>
; central volume modeled with covariates age and gender<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# example2 (from sampc)<br>
$INPUT C SET ID JID TIME DV=CONC AMT=DOSE RATE EVID MDV CMT GNDR AGE<br>
$DATA example2.csv IGNORE=C<br>
$SUBROUTINES ADVAN3 TRANS4<br>
$PK<br>
; LCLM=log transformed clearance, male<br>
LCLM=THETA(1)<br>
;LCLF=log transformed clearance, female.<br>
LCLF=THETA(2)<br>
; CLAM=CL age slope, male<br>
CLAM=THETA(3)<br>
; CLAF=CL age slope, female<br>
CLAF=THETA(4)<br>
; LV1M=log transformed V1, male<br>
LV1M=THETA(5)<br>
; LV1F=log transformed V1, female<br>
LV1F=THETA(6)<br>
; V1AM=V1 age slope, male<br>
V1AM=THETA(7)<br>
; V1AF=V1 age slope, female<br>
V1AF=THETA(8)<br>
; LAGE=log transformed age<br>
LAGE=DLOG(AGE)<br>
;Mean of ETA1, the inter-subject deviation of Clearance,<br>
; is ultimately modeled as linear function of THETA(1) to THETA(4).<br>
; Relating thetas to Mus by linear functions is not essential for<br>
; ITS, IMP, or IMPMAP methods, but is very helpful for MCMC methods<br>
; such as SAEM and BAYES.<br>
MU_1=(1.0-GNDR)*(LCLM+LAGE*CLAM) + GNDR*(LCLF+LAGE*CLAF)<br>
; Mean of ETA2, the inter-subject deviation of V1,<br>
; is ultimately modeled as linear function of THETA(5) to THETA(8)<br>
MU_2=(1.0-GNDR)*(LV1M+LAGE*V1AM) + GNDR*(LV1F+LAGE*V1AF)<br>
MU_3=THETA(9)<br>
MU_4=THETA(10)<br>
CL=DEXP(MU_1+ETA(1))<br>
EX-11<br>
<hr>
<A name=666></a>BAYES2 EXAMPLES<br>
Help Guide<br>
V1=DEXP(MU_2+ETA(2))<br>
Q=DEXP(MU_3+ETA(3))<br>
V2=DEXP(MU_4+ETA(4))<br>
S1=V1<br>
$ERROR<br>
CALLFL=0<br>
; Option to model the residual error coefficient in THETA(11),<br>
; rather than in SIGMA.<br>
SDSL=THETA(11)<br>
W=F*SDSL<br>
Y = F + W*EPS(1)<br>
IPRED=F<br>
IWRES=(DV-F)/W<br>
;Initial THETAs<br>
$THETA<br>
( 0.7 ) ;[LCLM]<br>
( 0.7 ) ;[LCLF]<br>
( 2 )   ;[CLAM]<br>
( 2.0);[CLAF]<br>
( 0.7 ) ;[LV1M]<br>
( 0.7 ) ;[LV1F]<br>
( 2.0 )<br>
;[V1AM]<br>
( 2.0 )<br>
;[V1AF]<br>
( 0.7 ) ;[MU_3]<br>
(<br>
0.7 );[MU_4]<br>
( 0.3 )<br>
;[SDSL]<br>
;Initial OMEGAs<br>
$OMEGA BLOCK(4)<br>
0.5 ;[p]<br>
0.001 ;[f]<br>
0.5 ;[p]<br>
0.001 ;[f]<br>
0.001 ;[f]<br>
0.5 ;[p]<br>
0.001 ;[f]<br>
0.001 ;[f]<br>
0.001 ;[f]<br>
0.5 ;[p]<br>
; SIGMA is 1.0 fixed, serves as unscaled variance for EPS(1).<br>
; THETA(11) takes up the residual error scaling.<br>
$SIGMA<br>
(1.0 FIXED)<br>
;Prior information is important for MCMC Bayesian analysis,<br>
; not necessary for maximization methods<br>
; In this example, only the OMEGAs have a prior distribution,<br>
EX-12<br>
<hr>
<A name=667></a>Help Guide<br>
EXAMPLES BAYES2<br>
; the THETAS do not.<br>
; For Bayesian methods, it is most important for at least the<br>
; OMEGAs to have a prior, even an uninformative one,<br>
; to stabilize the analysis. Only if the number of subjects<br>
; exceeds the OMEGA dimension number by at least 100,<br>
; then you may get away without priors on OMEGA for BAYES analysis.<br>
$PRIOR NWPRI<br>
; Prior OMEGA matrix<br>
$OMEGAP BLOCK(4) FIX VALUES(0.01,0.0)<br>
; Degrees of freedom to OMEGA prior matrix:<br>
$OMEGAPD 4 FIX<br>
; The first analysis is iterative two-stage.<br>
; Note that the GRD specification is THETA(11) is a<br>
; Sigma-like parameter.<br>
This will allow NONMEM to make<br>
; efficient gradient evaluations for THETA(11), which is useful<br>
; for later IMP,IMPMAP, and SAEM methods, but has no impact on<br>
; ITS and BAYES methods.<br>
$EST METHOD=ITS INTERACTION FILE=example2.ext NITER=1000 NSIG=2<br>
PRINT=5 NOABORT SIGL=8 NOPRIOR=1 CTYPE=3 GRD=TS(11)<br>
; Results of ITS serve as initial parameters for the IMP method.<br>
$EST METHOD=IMP INTERACTION EONLY=0 MAPITER=0 NITER=100 ISAMPLE=300<br>
PRINT=1 SIGL=8<br>
; The results of IMP are used as the initial values for the SAEM method.<br>
$EST METHOD=SAEM NBURN=3000 NITER=2000 PRINT=10 ISAMPLE=2<br>
CTYPE=3 CITER=10 CALPHA=0.05<br>
; After the SAEM method, obtain good estimates of the marginal density<br>
; (objective function),<br>
; along with good estimates of the standard errors.<br>
$EST METHOD=IMP INTERACTION EONLY=1 NITER=5 ISAMPLE=3000<br>
PRINT=1 SIGL=8 SEED=123334<br>
CTYPE=3 CITER=10 CALPHA=0.05<br>
; The Bayesian analysis is performed.<br>
$EST METHOD=BAYES INTERACTION FILE=example2.TXT NBURN=10000<br>
NITER=3000 PRINT=100 NOPRIOR=0<br>
CTYPE=3 CITER=10 CALPHA=0.05<br>
; Just for old-times sake, lets see what the traditional<br>
; FOCE method will give us.<br>
; And, remember to introduce a new FILE, so its results wont<br>
; append to our Bayesian FILE.<br>
EX-13<br>
<hr>
<A name=668></a>BAYES2 EXAMPLES<br>
Help Guide<br>
$EST METHOD=COND INTERACTION MAXEVAL=9999 FILE=example2.ext NSIG=2<br>
SIGL=14 PRINT=5 NOABORT NOPRIOR=1<br>
$COV MATRIX=R UNCONDITIONAL<br>
REFERENCES: Guide Introduction_7<br>
EX-14<br>
<hr>
<A name=669></a>Help Guide<br>
EXAMPLES BAYES3<br>
BAYES EXAMPLE 3<br>
This is example3.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Population Mixture Problem in 1 Compartment model,<br>
; with Volume and rate constant parameters and their inter-subject<br>
; variances modeled from two sub-populations<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# example3 (from ad1tr1m2s)<br>
$INPUT C SET ID JID TIME CONC=DV DOSE=AMT RATE EVID MDV CMT VC1 K101<br>
VC2 K102 SIGZ PROB<br>
$DATA example3.csv IGNORE=C<br>
$SUBROUTINES ADVAN1 TRANS1<br>
; The mixture model uses THETA(5) as the mixture proportion parameter,<br>
; defining the proportion of subjects in sub-population 1 (P(1),<br>
; and in sub-population 2 (P(2)<br>
$MIX<br>
P(1)=THETA(5)<br>
P(2)=1.0-THETA(5)<br>
NSPOP=2<br>
$PK<br>
;<br>
The MUs should always be unconditionally defined, that is,<br>
;<br>
they should never be defined in IF/THEN blocks<br>
; THETA(1) models the Volume of sub-population 1<br>
MU_1=THETA(1)<br>
; THETA(2) models the clearance of sub-population 1<br>
MU_2=THETA(2)<br>
; THETA(3) models the Volume of sub-population 2<br>
MU_3=THETA(3)<br>
; THETA(4) models the clearance of sub-population 2<br>
MU_4=THETA(4)<br>
VCM=DEXP(MU_1+ETA(1))<br>
K10M=DEXP(MU_2+ETA(2))<br>
VCF=DEXP(MU_3+ETA(3))<br>
K10F=DEXP(MU_4+ETA(4))<br>
Q=1<br>
IF(MIXNUM.EQ.2) Q=0<br>
V=Q*VCM+(1.0-Q)*VCF<br>
K=Q*K10M+(1.0-Q)*K10F<br>
S1=V<br>
$ERROR<br>
EX-15<br>
<hr>
<A name=670></a>BAYES3 EXAMPLES<br>
Help Guide<br>
Y = F + F*EPS(1)<br>
; Initial THETAs<br>
$THETA<br>
(-1000.0 4.3 1000.0) ;[MU_1]<br>
(-1000.0 -2.9 1000.0) ;[MU_2]<br>
(-1000.0 4.3 1000.0)<br>
;[MU_3]<br>
(-1000.0 -0.67 1000.0) ;[MU_4]<br>
(0.0001 0.667 0.9999)<br>
;[P(1)]<br>
;Initial OMEGA block 1, for sub-population 1<br>
$OMEGA BLOCK(2)<br>
.04 ;[p]<br>
.01 ; [f]<br>
.027; [p]<br>
;Initial OMEGA block 2, for sub-population 2<br>
$OMEGA BLOCK(2)<br>
.05; [p]<br>
.01; [f]<br>
.06; [p]<br>
$SIGMA<br>
0.01 ;[p]<br>
; Prior information setup for OMEGAS only<br>
$PRIOR NWPRI<br>
; Prior OMEGA block 1.<br>
Note that because the OMEGA is separated<br>
; into blocks, so their priors should have the same block design.<br>
$OMEGAP BLOCK(2)<br>
0.05 FIX<br>
0.0 0.05<br>
; Prior OMEGA block 2<br>
$OMEGAP BLOCK(2)<br>
0.05 FIX<br>
0.0 0.05<br>
; Degrees of Freedom defined for Priors.<br>
; One for each OMEGA block defining each sub-popluation<br>
$OMEGAPD (2 FIX) (2 FIX)<br>
$EST METHOD=ITS INTERACTION NITER=20 PRINT=1 NOABORT SIGL=8<br>
FILE=example3.ext CTYPE=3 CITER=10<br>
CALPHA=0.05 NOPRIOR=1<br>
EX-16<br>
<hr>
<A name=671></a>Help Guide<br>
EXAMPLES BAYES3<br>
$EST NBURN=500 NITER=500 METHOD=SAEM INTERACTION PRINT=10 SIGL=6<br>
ISAMPLE=2<br>
$EST METHOD=IMP INTERACTION NITER=5 ISAMPLE=1000 PRINT=1 NOABORT<br>
SIGL=6 EONLY=1 MAPITER=0<br>
$EST METHOD=BAYES INTERACTION NBURN=2000 NITER=1000 PRINT=10<br>
FILE=example3.txt SIGL=8 NOPRIOR=0<br>
$EST MAXEVAL=9999 NSIG=3 SIGL=12 PRINT=1 FILE=example3.ext<br>
METHOD=CONDITIONAL INTERACTION NOABORT<br>
NOPRIOR=1<br>
$COV MATRIX=R UNCONDITIONAL<br>
REFERENCES: Guide Introduction_7<br>
EX-17<br>
<hr>
<A name=672></a>BAYES4 EXAMPLES<br>
Help Guide<br>
BAYES EXAMPLE 4<br>
This is example4.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Population Mixture Problem in 1 Compartment model,<br>
; with rate constant parameter and its inter-subject variances<br>
; modeled as coming from two sub-populations<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# example4 (from ad1tr1m2t)<br>
$INPUT C SET ID JID TIME CONC=DV DOSE=AMT RATE EVID MDV CMT VC1<br>
K101 VC2 K102 SIGZ PROB<br>
$DATA example4.csv IGNORE=C<br>
$SUBROUTINES ADVAN1 TRANS1<br>
$MIX<br>
P(1)=THETA(4)<br>
P(2)=1.0-THETA(4)<br>
NSPOP=2<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
V=DEXP(MU_1+ETA(1))<br>
K10M=DEXP(MU_2+ETA(2))<br>
K10F=DEXP(MU_3+ETA(3))<br>
Q=1<br>
IF(MIXNUM.EQ.2) Q=0<br>
K=Q*K10M+(1.0-Q)*K10F<br>
S1=V<br>
$ERROR<br>
Y = F + F*EPS(1)<br>
$THETA<br>
(-1000.0 4.3 1000.0) ;[MU_1]<br>
(-1000.0 -2.9 1000.0) ;[MU_2]<br>
(-1000.0 -0.67 1000.0) ;[MU_3]<br>
(0.0001 0.667 0.9999)<br>
;[P(1)]<br>
$OMEGA BLOCK(3)<br>
.04 ;[p]<br>
0.01 ;[f]<br>
.027 ;[p]<br>
EX-18<br>
<hr>
<A name=673></a>Help Guide<br>
EXAMPLES BAYES4<br>
0.01 ;[f]<br>
0.001 ;[f]<br>
0.06 ;[p]<br>
$SIGMA<br>
0.01 ;[p]<br>
; Prior information setup for OMEGAS only<br>
$PRIOR NWPRI<br>
; Prior OMEGA<br>
$OMEGAP BLOCK(3)<br>
0.05 FIX<br>
0.0 0.05<br>
0.0 0.0<br>
0.05<br>
; Degrees of Freedom defined for Priors.<br>
$OMEGAPD (3 FIX)<br>
$EST METHOD=ITS INTERACTION NITER=30 PRINT=5 NOABORT SIGL=6<br>
FILE=example4.ext NOPRIOR=1 CTYPE=3 CITER=10 CALPHA=0.05<br>
$EST METHOD=IMP INTERACTION NITER=20 ISAMPLE=300 PRINT=1<br>
NOABORT SIGL=6 NOPRIOR=1<br>
$EST NBURN=500 NITER=500 METHOD=SAEM INTERACTION PRINT=10 SIGL=6<br>
ISAMPLE=2 NOPRIOR=1 MAPITER=0<br>
$EST METHOD=IMP INTERACTION EONLY=1 NITER=20 ISAMPLE=3000 PRINT=1<br>
NOABORT SIGL=6 NOPRIOR=1<br>
$EST METHOD=BAYES INTERACTION NBURN=2000 NITER=5000 PRINT=10<br>
FILE=example4.txt SIGL=6 NOPRIOR=0<br>
$EST MAXEVAL=9999 NSIG=3 SIGL=12 PRINT=1<br>
METHOD=CONDITIONAL INTERACTION<br>
NOABORT FILE=example4.ext NOPRIOR=1<br>
$COV MATRIX=R UNCONDITIONAL SIGL=10<br>
REFERENCES: Guide Introduction_7<br>
EX-19<br>
<hr>
<A name=674></a>BAYES5 EXAMPLES<br>
Help Guide<br>
BAYES EXAMPLE 5<br>
This is example5.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Population Mixture Problem in 1 Compartment model,<br>
; with rate constant parameter mean modeled for two<br>
; sub-populations, but its inter-subject variance is the same in<br>
; both sub-populations Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# example5 (from ad1tr1m4t)<br>
$INPUT C SET ID JID TIME CONC=DV DOSE=AMT RATE EVID MDV CMT VC1<br>
K101 VC2 K102 SIGZ PROB<br>
$DATA example5.csv IGNORE=C<br>
$SUBROUTINES ADVAN1 TRANS1<br>
$MIX<br>
P(1)=THETA(4)<br>
P(2)=1.0-THETA(4)<br>
NSPOP=2<br>
$PK<br>
Q=1<br>
IF(MIXNUM.EQ.2) Q=0<br>
MU_1=THETA(1)<br>
; Note that MU_2 can be modeled as THETA(2) or THETA(3),<br>
; depending on the MIXNUM value.<br>
; Also, we are avoiding IF/THEN blocks.<br>
MU_2=Q*THETA(2)+(1.0-Q)*THETA(3)<br>
V=DEXP(MU_1+ETA(1))<br>
K=DEXP(MU_2+ETA(2))<br>
S1=V<br>
$ERROR<br>
Y = F + F*EPS(1)<br>
$THETA<br>
(-1000.0 4.3 1000.0) ;[MU_1]<br>
(-1000.0 -2.9 1000.0)<br>
;[MU_2-1]<br>
(-1000.0 -0.67 1000.0) ;[MU_2-2]<br>
(0.0001 0.667 0.9999)<br>
;[P(1)]<br>
$OMEGA BLOCK(2)<br>
0.04 ;[p]<br>
0.01 ;[f]<br>
EX-20<br>
<hr>
<A name=675></a>Help Guide<br>
EXAMPLES BAYES5<br>
0.04 ;[p]<br>
$SIGMA<br>
0.01 ;[p]<br>
$EST METHOD=ITS INTERACTION NITER=100 PRINT=1 NOABORT SIGL=8<br>
FILE=example5.ext CTYPE=3<br>
$EST METHOD=IMPMAP INTERACTION NITER=20 ISAMPLE=300 PRINT=1<br>
NOABORT SIGL=8<br>
$EST METHOD=IMP INTERACTION NITER=20 ISAMPLE=1000 PRINT=1<br>
NOABORT SIGL=6<br>
$EST NBURN=500 NITER=500 METHOD=SAEM INTERACTION PRINT=10<br>
SIGL=6 ISAMPLE=2<br>
$EST METHOD=IMP INTERACTION NITER=5 ISAMPLE=1000 PRINT=1<br>
NOABORT SIGL=6 EONLY=1 MAPITER=0<br>
$EST METHOD=BAYES INTERACTION NBURN=2000 NITER=5000 PRINT=10<br>
FILE=example5.txt SIGL=8<br>
$EST MAXEVAL=9999 NSIG=2 SIGL=8 PRINT=10 FILE=example5.ext<br>
METHOD=CONDITIONAL INTERACTION NOABORT<br>
$COV MATRIX=R<br>
REFERENCES: Guide Introduction_7<br>
EX-21<br>
<hr>
<A name=676></a>BAYES6 EXAMPLES<br>
Help Guide<br>
BAYES EXAMPLE 6<br>
This is example6.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Receptor Mediated Clearance model with Dynamic Change<br>
;<br>
in Receptors<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# example6 (from r2compl)<br>
$INPUT C SET ID JID TIME DV=CONC DOSE=AMT RATE EVID MDV CMT<br>
$DATA example6.csv IGNORE=C<br>
; The new numerical integration solver is used, although ADVAN=9<br>
; is also efficient for this problem.<br>
$SUBROUTINES ADVAN13 TRANS1 TOL=4<br>
$MODEL NCOMPARTMENTS=3<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
MU_5=THETA(5)<br>
MU_6=THETA(6)<br>
MU_7=THETA(7)<br>
MU_8=THETA(8)<br>
VC=EXP(MU_1+ETA(1))<br>
K10=EXP(MU_2+ETA(2))<br>
K12=EXP(MU_3+ETA(3))<br>
K21=EXP(MU_4+ETA(4))<br>
VM=EXP(MU_5+ETA(5))<br>
KMC=EXP(MU_6+ETA(6))<br>
K03=EXP(MU_7+ETA(7))<br>
K30=EXP(MU_8+ETA(8))<br>
S3=VC<br>
S1=VC<br>
KM=KMC*S1<br>
F3=K03/K30<br>
$DES<br>
DADT(1) = -(K10+K12)*A(1) + K21*A(2) - VM*A(1)*A(3)/(A(1)+KM)<br>
DADT(2) = K12*A(1) - K21*A(2)<br>
DADT(3) =<br>
-VM*A(1)*A(3)/(A(1)+KM) - K30*A(3) + K03<br>
$ERROR<br>
CALLFL=0<br>
ETYPE=1<br>
EX-22<br>
<hr>
<A name=677></a>Help Guide<br>
EXAMPLES BAYES6<br>
IF(CMT.NE.1) ETYPE=0<br>
IPRED=F<br>
Y = F + F*ETYPE*EPS(1) + F*(1.0-ETYPE)*EPS(2)<br>
$THETA<br>
;Initial Thetas<br>
( 4.0 )<br>
;[MU_1]<br>
( -2.1 ) ;[MU_2]<br>
( 0.7 )<br>
;[MU_3]<br>
( -0.17 );[MU_4]<br>
( 2.2 ) ;[MU_5]<br>
( 0.14 )<br>
;[MU_6]<br>
( 3.7 )<br>
;[MU_7]<br>
( -0.7) ;[MU_8]<br>
;Initial Omegas<br>
$OMEGA BLOCK(8)<br>
0.2 ;[p]<br>
-0.0043 ;[f]<br>
0.2 ;[p]<br>
0.0048 ;[f]<br>
-0.0023 ;[f]<br>
0.2 ;[p]<br>
0.0032 ;[f]<br>
0.0059 ;[f]<br>
-0.0014 ;[f]<br>
0.2 ;[p]<br>
0.0029 ;[f]<br>
0.0027 ;[f]<br>
-0.00026 ;[f]<br>
-0.0032 ;[f]<br>
0.2 ;[p]<br>
-0.0025 ;[f]<br>
0.00097 ;[f]<br>
0.0024 ;[f]<br>
0.00197 ;[f]<br>
-0.0080 ;[f]<br>
0.2 ;[p]<br>
0.0031 ;[f]<br>
-0.00571 ;[f]<br>
0.0030 ;[f]<br>
-0.0074 ;[f]<br>
0.0025 ;[f]<br>
0.0034 ;[f]<br>
0.2 ;[p]<br>
0.00973 ;[f]<br>
0.00862 ;[f]<br>
0.0041 ;[f]<br>
EX-23<br>
<hr>
<A name=678></a>BAYES6 EXAMPLES<br>
Help Guide<br>
0.0046 ;[f]<br>
0.00061 ;[f]<br>
-0.0056 ;[f]<br>
0.0056 ;[f]<br>
0.2 ;[p]<br>
$SIGMA<br>
0.1 ;[p]<br>
0.1 ;[p]<br>
$PRIOR NWPRI<br>
; Omega prior<br>
$OMEGAP BLOCK(8)<br>
0.2 FIX<br>
0.0 0.2<br>
0.0 0.0 0.2<br>
0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.2<br>
; degrees of freedom for OMEGA prior<br>
$OMEGAPD<br>
(8 FIXED)<br>
;[dfo]<br>
; Starting with a short iterative two stage analysis brings the<br>
; results closer so less time needs to be spent during the<br>
; burn-in of the BAYES analysis<br>
$EST METHOD=ITS INTERACTION SIGL=4 NITER=15 PRINT=1<br>
FILE=example6.ext NOABORT NOPRIOR=1<br>
$EST METHOD=BAYES INTERACTION NBURN=4000 SIGL=4 NITER=10000<br>
PRINT=10 CTYPE=3 FILE=example6.txt NOABORT NOPRIOR=0<br>
; By default, ISAMPLE_M* are 2.<br>
Since there are many data points<br>
; per subject, setting these to 1 is enough, and it reduces the<br>
; time of the analysis<br>
ISAMPLE_M1=1 ISAMPLE_M2=1 ISAMPLE_M3=1 IACCEPT=0.4<br>
$COV MATRIX=R UNCONDITIONAL<br>
REFERENCES: Guide Introduction_7<br>
EX-24<br>
<hr>
<A name=679></a>Help Guide<br>
EXAMPLES BAYES6s<br>
BAYES EXAMPLE 6S<br>
This is example6s.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory. Note the old style syntax for priors.<br>
;Model Desc: Receptor Mediated Clearance model with Dynamic Change<br>
;<br>
in Receptors<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# example6s (from r2compl)<br>
$INPUT C SET ID JID TIME DV=CONC DOSE=AMT RATE EVID MDV CMT<br>
$DATA example6.csv IGNORE=C<br>
; The new numerical integration solver is used, although ADVAN=9<br>
; is also efficient for this problem.<br>
$SUBROUTINES ADVAN13 TRANS1 TOL=4<br>
$MODEL NCOMPARTMENTS=3<br>
$PRIOR NWPRI NTHETA=8, NETA=8, NTHP=0, NETP=8, NPEXP=1<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
MU_5=THETA(5)<br>
MU_6=THETA(6)<br>
MU_7=THETA(7)<br>
MU_8=THETA(8)<br>
VC=EXP(MU_1+ETA(1))<br>
K10=EXP(MU_2+ETA(2))<br>
K12=EXP(MU_3+ETA(3))<br>
K21=EXP(MU_4+ETA(4))<br>
VM=EXP(MU_5+ETA(5))<br>
KMC=EXP(MU_6+ETA(6))<br>
K03=EXP(MU_7+ETA(7))<br>
K30=EXP(MU_8+ETA(8))<br>
S3=VC<br>
S1=VC<br>
KM=KMC*S1<br>
F3=K03/K30<br>
$DES<br>
DEL=1.0E-10<br>
DADT(1) = -(K10+K12)*A(1) + K21*A(2) - VM*A(1)*A(3)/(A(1)+KM+DEL)<br>
DADT(2) = K12*A(1) - K21*A(2)<br>
DADT(3) =<br>
-VM*A(1)*A(3)/(A(1)+KM+DEL) - K30*A(3) + K03<br>
EX-25<br>
<hr>
<A name=680></a>BAYES6s EXAMPLES<br>
Help Guide<br>
$ERROR<br>
CALLFL=0<br>
ETYPE=1<br>
IF(CMT.NE.1) ETYPE=0<br>
IPRED=F<br>
Y = F + F*ETYPE*EPS(1) + F*(1.0-ETYPE)*EPS(2)<br>
$THETA<br>
;Initial Thetas<br>
( 4.0 )<br>
;[MU_1]<br>
( -2.1 ) ;[MU_2]<br>
( 0.7 )<br>
;[MU_3]<br>
( -0.17 );[MU_4]<br>
( 2.2 ) ;[MU_5]<br>
( 0.14 )<br>
;[MU_6]<br>
( 3.7 )<br>
;[MU_7]<br>
( -0.7) ;[MU_8]<br>
; degrees of freedom for OMEGA prior<br>
(8 FIXED)<br>
;[dfo]<br>
;Initial Omegas<br>
$OMEGA BLOCK(8)<br>
0.2 ;[p]<br>
-0.0043 ;[f]<br>
0.2 ;[p]<br>
0.0048 ;[f]<br>
-0.0023 ;[f]<br>
0.2 ;[p]<br>
0.0032 ;[f]<br>
0.0059 ;[f]<br>
-0.0014 ;[f]<br>
0.2 ;[p]<br>
0.0029 ;[f]<br>
0.0027 ;[f]<br>
-0.00026 ;[f]<br>
-0.0032 ;[f]<br>
0.2 ;[p]<br>
-0.0025 ;[f]<br>
0.00097 ;[f]<br>
0.0024 ;[f]<br>
0.00197 ;[f]<br>
-0.0080 ;[f]<br>
0.2 ;[p]<br>
0.0031 ;[f]<br>
-0.00571 ;[f]<br>
0.0030 ;[f]<br>
-0.0074 ;[f]<br>
0.0025 ;[f]<br>
EX-26<br>
<hr>
<A name=681></a>Help Guide<br>
EXAMPLES BAYES6s<br>
0.0034 ;[f]<br>
0.2 ;[p]<br>
0.00973 ;[f]<br>
0.00862 ;[f]<br>
0.0041 ;[f]<br>
0.0046 ;[f]<br>
0.00061 ;[f]<br>
-0.0056 ;[f]<br>
0.0056 ;[f]<br>
0.2 ;[p]<br>
; Omega prior<br>
$OMEGA BLOCK(8)<br>
0.2 FIX<br>
0.0 0.2<br>
0.0 0.0 0.2<br>
0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.2<br>
$SIGMA BLOCK(1) 0.1 ;[p]<br>
;$SIGMA BLOCK(1) 0.1 ;[p]<br>
$SIGMA BLOCK(1) SAME<br>
; Starting with a short iterative two stage analysis brings the<br>
; results closer so less time needs to be spent during the burn-in<br>
; of the BAYES analysis<br>
$EST METHOD=ITS INTERACTION SIGL=4 NITER=30 PRINT=1<br>
FILE=example6s.ext NOABORT NOPRIOR=1 CTYPE=3<br>
$EST METHOD=IMP INTERACTION SIGL=4 NITER=30 PRINT=1<br>
FILE=example6s.ext NOABORT NOPRIOR=1 ISAMPLE=100<br>
$EST METHOD=BAYES INTERACTION NBURN=4000 SIGL=4 NITER=1000<br>
PRINT=10 CTYPE=3 FILE=example6s.txt NOABORT NOPRIOR=0<br>
PSAMPLE_M1=1 PSAMPLE_M2=1 PSAMPLE_M3=1<br>
; By default, ISAMPLE_M* are 2.<br>
Since there are many data points<br>
; per subject, setting these to 1 is enough, and it reduces the<br>
; time of the analysis<br>
ISAMPLE_M1=1 ISAMPLE_M2=1 ISAMPLE_M3=1 IACCEPT=0.4<br>
$COV MATRIX=R UNCONDITIONAL<br>
REFERENCES: Guide Introduction_7<br>
EX-27<br>
<hr>
<A name=682></a>BAYES6sb EXAMPLES<br>
Help Guide<br>
BAYES EXAMPLE 6SB<br>
This is example6sb.ctl from the NONMEM 7 distribution medium. It, along with the<br>data ﬁle, can be found in the examples directory. Note the old style syntax for priors.<br>
;Model Desc: Receptor Mediated Clearance model with Dynamic Change<br>
;<br>
in Receptors<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# example6sb (from r2compl)<br>
$INPUT C SET ID JID TIME DV=CONC DOSE=AMT RATE EVID MDV CMT<br>
$DATA example6.csv IGNORE=C<br>
; The new numerical integration solver is used, although ADVAN=9<br>
; is also efficient for this problem.<br>
$SUBROUTINES ADVAN13 TRANS1 TOL=4<br>
$MODEL NCOMPARTMENTS=3<br>
$PRIOR NWPRI NTHETA=8, NETA=8, NTHP=0, NETP=8, NPEXP=1<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
MU_5=THETA(5)<br>
MU_6=THETA(6)<br>
MU_7=THETA(7)<br>
MU_8=THETA(8)<br>
VC=EXP(MU_1+ETA(1))<br>
K10=EXP(MU_2+ETA(2))<br>
K12=EXP(MU_3+ETA(3))<br>
K21=EXP(MU_4+ETA(4))<br>
VM=EXP(MU_5+ETA(5))<br>
KMC=EXP(MU_6+ETA(6))<br>
K03=EXP(MU_7+ETA(7))<br>
K30=EXP(MU_8+ETA(8))<br>
S3=VC<br>
S1=VC<br>
KM=KMC*S1<br>
F3=K03/K30<br>
$DES<br>
DADT(1) = -(K10+K12)*A(1) + K21*A(2) - VM*A(1)*A(3)/(A(1)+KM)<br>
DADT(2) = K12*A(1) - K21*A(2)<br>
DADT(3) =<br>
-VM*A(1)*A(3)/(A(1)+KM) - K30*A(3) + K03<br>
$ERROR<br>
EX-28<br>
<hr>
<A name=683></a>Help Guide<br>
EXAMPLES BAYES6sb<br>
CALLFL=0<br>
ETYPE=1<br>
IF(CMT.NE.1) ETYPE=0<br>
IPRED=F<br>
Y = F + F*ETYPE*EPS(1) + F*(1.0-ETYPE)*EPS(1)<br>
$THETA<br>
;Initial Thetas<br>
( 4.0 )<br>
;[MU_1]<br>
( -2.1 ) ;[MU_2]<br>
( 0.7 )<br>
;[MU_3]<br>
( -0.17 );[MU_4]<br>
( 2.2 ) ;[MU_5]<br>
( 0.14 )<br>
;[MU_6]<br>
( 3.7 )<br>
;[MU_7]<br>
( -0.7) ;[MU_8]<br>
; degrees of freedom for OMEGA prior<br>
(8 FIXED)<br>
;[dfo]<br>
;Initial Omegas<br>
$OMEGA BLOCK(8)<br>
0.2 ;[p]<br>
-0.0043 ;[f]<br>
0.2 ;[p]<br>
0.0048 ;[f]<br>
-0.0023 ;[f]<br>
0.2 ;[p]<br>
0.0032 ;[f]<br>
0.0059 ;[f]<br>
-0.0014 ;[f]<br>
0.2 ;[p]<br>
0.0029 ;[f]<br>
0.0027 ;[f]<br>
-0.00026 ;[f]<br>
-0.0032 ;[f]<br>
0.2 ;[p]<br>
-0.0025 ;[f]<br>
0.00097 ;[f]<br>
0.0024 ;[f]<br>
0.00197 ;[f]<br>
-0.0080 ;[f]<br>
0.2 ;[p]<br>
0.0031 ;[f]<br>
-0.00571 ;[f]<br>
0.0030 ;[f]<br>
-0.0074 ;[f]<br>
0.0025 ;[f]<br>
0.0034 ;[f]<br>
EX-29<br>
<hr>
<A name=684></a>BAYES6sb EXAMPLES<br>
Help Guide<br>
0.2 ;[p]<br>
0.00973 ;[f]<br>
0.00862 ;[f]<br>
0.0041 ;[f]<br>
0.0046 ;[f]<br>
0.00061 ;[f]<br>
-0.0056 ;[f]<br>
0.0056 ;[f]<br>
0.2 ;[p]<br>
; Omega prior<br>
$OMEGA BLOCK(8)<br>
0.2 FIX<br>
0.0 0.2<br>
0.0 0.0 0.2<br>
0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.0 0.2<br>
0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.2<br>
$SIGMA BLOCK(1) 0.1 ;[p]<br>
; Starting with a short iterative two stage analysis brings the<br>
; results closer so less time needs to be spent during the burn-in<br>
; of the BAYES analysis<br>
$EST METHOD=ITS INTERACTION SIGL=4 NITER=30 PRINT=1<br>
FILE=example6sb.ext NOABORT NOPRIOR=1 CTYPE=3<br>
$EST METHOD=IMP INTERACTION SIGL=4 NITER=30 PRINT=1<br>
FILE=example6sb.ext NOABORT NOPRIOR=1 ISAMPLE=100<br>
$EST METHOD=BAYES INTERACTION NBURN=4000 SIGL=4 NITER=1000 PRINT=10<br>
CTYPE=3 FILE=example6sb.txt NOABORT NOPRIOR=0<br>
; By default, ISAMPLE_M* are 2.<br>
Since there are many data points<br>
;<br>
per subject, setting these to 1 is enough, and it reduces the<br>
; time of the analysis<br>
ISAMPLE_M1=1 ISAMPLE_M2=1 ISAMPLE_M3=1 IACCEPT=0.4<br>
$COV MATRIX=R UNCONDITIONAL<br>
REFERENCES: Guide Introduction_7<br>
EX-30<br>
<hr>
<A name=685></a>Help Guide<br>
EXAMPLES BAYES7r<br>
BAYES EXAMPLE 7R<br>
This is example7r.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Interoccasion Variability<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB run# example7r<br>
$INPUT C SET ID<br>
TIME AMT RATE EVID MDV CMT DV OCC<br>
$ABBR REPLACE ETA(OCC_CL)=ETA(3,4,5)<br>
$DATA example7r.csv IGNORE=C<br>
$SUBROUTINES ADVAN1 TRANS2<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
V=DEXP(MU_1+ETA(1))<br>
S1=V<br>
VC=V<br>
CL=DEXP(MU_2+ETA(2))*EXP(ETA(OCC_CL))<br>
$ERROR<br>
IPRED=F<br>
Y = F+F*EPS(1)<br>
;Initial Thetas<br>
$THETA<br>
2.0 ;[MU_1]<br>
2.0 ;[MU_2]<br>
;Initial omegas<br>
$OMEGA BLOCK(2)<br>
.3 ;[p]<br>
-.01 ;[f]<br>
.3 ;[p]<br>
$OMEGA BLOCK(1)<br>
.1 ;[p]<br>
$OMEGA BLOCK(1) SAME(2)<br>
$SIGMA<br>
0.1 ;[p]<br>
$PRIOR NWPRI<br>
; Degrees of freedom for Prior Omega blocks<br>
$OMEGAPD (2.0 FIXED) (1.0 FIXED)<br>
; Prior Omegas<br>
$OMEGAP BLOCK(2)<br>
EX-31<br>
<hr>
<A name=686></a>BAYES7r EXAMPLES<br>
Help Guide<br>
.14 FIX<br>
0.0 .125<br>
$OMEGAP BLOCK(1) .0164 FIX<br>
$OMEGAP BLOCK(1) SAME(2)<br>
$EST METHOD=ITS INTERACTION FILE=example7r.ext<br>
NITER=10000<br>
PRINT=5 NOABORT SIGL=8 CTYPE=3 CITER=10<br>
NOPRIOR=1 CALPHA=0.05 NSIG=2<br>
$EST METHOD=SAEM INTERACTION NBURN=30000 NITER=500 SIGL=8<br>
ISAMPLE=2 PRINT=10 SEED=1556678 CTYPE=3<br>
CITER=10 CALPHA=0.05 NOPRIOR=1<br>
$EST METHOD=IMP<br>
INTERACTION EONLY=1 NITER=4 ISAMPLE=3000<br>
PRINT=1 SIGL=10 NOPRIOR=1 MAPITER=0<br>
$EST METHOD=BAYES INTERACTION FILE=example7r.txt NBURN=10000<br>
NITER=10000 PRINT=100 CTYPE=3 CITER=10<br>
CALPHA=0.05 NOPRIOR=0<br>
$EST METHOD=COND INTERACTION MAXEVAL=9999 NSIG=3 SIGL=10 PRINT=5<br>
NOABORT NOPRIOR=1<br>
FILE=example7r.ext<br>
$COV MATRIX=R PRINT=E UNCONDITIONAL<br>
REFERENCES: Guide Introduction_7<br>
EX-32<br>
<hr>
<A name=687></a>Help Guide<br>
EXAMPLES BAYES8<br>
BAYES EXAMPLE 8<br>
This is example8.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Two compartment Model, Using ADVAN3, TRANS4<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# Example 8 (from samp5l)<br>
$INPUT C SET ID JID TIME<br>
DV=CONC AMT=DOSE RATE EVID MDV CMT<br>
CLX V1X QX V2X SDIX SDSX<br>
$DATA example8.csv IGNORE=C<br>
$SUBROUTINES ADVAN3 TRANS4<br>
$PK<br>
include nonmem_reserved_general<br>
; Request extra information for Bayesian analysis.<br>
; An extra call will then be made for accepted samples<br>
BAYES_EXTRA_REQUEST=1<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
CL=DEXP(MU_1+ETA(1))<br>
V1=DEXP(MU_2+ETA(2))<br>
Q=DEXP(MU_3+ETA(3))<br>
V2=DEXP(MU_4+ETA(4))<br>
S1=V1<br>
; When Bayes_extra=1, then this particular set of individual<br>
; parameters were &quot;accepted&quot; So you may record them if you wish<br>
IF(BAYES_EXTRA==1 .AND. ITER_REPORT&gt;=0 .AND. TIME==0.0) THEN<br>
&quot;<br>
WRITE(51,98) ITER_REPORT,ID,CL,V1,Q,V2<br>
&quot; 98 FORMAT(I12,1X,F14.0,4(1X,1PG12.5))<br>
ENDIF<br>
$ERROR<br>
include nonmem_reserved_general<br>
BAYES_EXTRA_REQUEST=1<br>
Y = F + F*EPS(1)<br>
IF(BAYES_EXTRA==1 .AND. ITER_REPORT&gt;=0 ) THEN<br>
&quot; WRITE(52,97) ITER_REPORT,ID,TIME,F<br>
&quot; 97 FORMAT(I12,1X,F14.0,2(1X,1PG12.5))<br>
ENDIF<br>
; Initial values of THETA<br>
$THETA<br>
(2.0) ;[LN(CL)]<br>
EX-33<br>
<hr>
<A name=688></a>BAYES8 EXAMPLES<br>
Help Guide<br>
(2.0) ;[LN(V1)]<br>
(2.0) ;[LN(Q)]<br>
(2.0) ;[LN(V2)]<br>
;INITIAL values of OMEGA<br>
$OMEGA BLOCK(4)<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
;Initial value of SIGMA<br>
$SIGMA<br>
(0.6 )<br>
;[P]<br>
$PRIOR NWPRI<br>
; Prior information to the Thetas.<br>
$THETAP (2.0 FIX)x4<br>
$THETAPV BLOCK(4) FIX VALUES(10000.0,0.0)<br>
; Prior information to the OMEGAS.<br>
$OMEGAP BLOCK(4)<br>
0.2 FIX<br>
0.0 0.2<br>
0.0 0.0 0.2<br>
0.0 0.0 0.0 0.2<br>
$OMEGAPD (4 FIX)<br>
$EST METHOD=BAYES INTERACTION FILE=example8.ext NBURN=10000<br>
NITER=1000 PRINT=100 NOPRIOR=0 CTYPE=3 CINTERVAL=100<br>
REFERENCES: Guide Introduction_7<br>
EX-34<br>
<hr>
<A name=689></a>Help Guide<br>
EXAMPLES BAYES9<br>
BAYES EXAMPLE 9<br>
This is example9.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
;Model Desc: Two compartment Model, Using ADVAN3, TRANS4<br>
;Project Name: nm7examples<br>
;Project ID: NO PROJECT DESCRIPTION<br>
$PROB RUN# Example 9 (from samp5l)<br>
$INPUT C SET ID JID TIME<br>
DV=CONC AMT=DOSE RATE EVID MDV CMT<br>
CLX V1X QX V2X SDIX SDSX<br>
$DATA example9.csv IGNORE=C<br>
$SUBROUTINES ADVAN3 TRANS4 OTHER=aneal.f90<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
CL=DEXP(MU_1+ETA(1))<br>
V1=DEXP(MU_2+ETA(2))<br>
Q=DEXP(MU_3+ETA(3))<br>
V2=DEXP(MU_4+ETA(4))<br>
S1=V1<br>
$ERROR<br>
Y = F + F*EPS(1)<br>
; Initial values of THETA<br>
$THETA<br>
(0.001, 2.0) ;[LN(CL)]<br>
(0.001, 2.0) ;[LN(V1)]<br>
(0.001, 2.0) ;[LN(Q)]<br>
(0.001, 2.0) ;[LN(V2)]<br>
;INITIAL values of OMEGA<br>
$OMEGA BLOCK(4)<br>
0.05 ;[P]<br>
0.01 ;[F]<br>
0.05 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.05 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.05 ;[P]<br>
;Initial value of SIGMA<br>
$SIGMA<br>
EX-35<br>
<hr>
<A name=690></a>BAYES9 EXAMPLES<br>
Help Guide<br>
(0.6 )<br>
;[P]<br>
$EST METHOD=SAEM INTERACTION FILE=example9.ext NBURN=5000<br>
NITER=500 PRINT=10 NOABORT SIGL=6 CTYPE=3 CINTERVAL=100<br>
CITER=10 CALPHA=0.05<br>
REFERENCES: Guide Introduction_7<br>
EX-36<br>
<hr>
<A name=691></a>Help Guide<br>
EXAMPLES BAYES10<br>
BAYES EXAMPLE 10<br>
This is example10.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
$PROB F_FLAG04est2a.ctl<br>
$INPUT C ID DOSE=AMT TIME DV WT TYPE<br>
$DATA example10.csv IGNORE=@<br>
$SUBROUTINES ADVAN2 TRANS2<br>
$PK<br>
CALLFL=1<br>
MU_1=DLOG(THETA(1))<br>
KA=DEXP(MU_1+ETA(1))<br>
MU_2=DLOG(THETA(2))<br>
V=DEXP(MU_2+ETA(2))<br>
MU_3=DLOG(THETA(3))<br>
CL=DEXP(MU_3+ETA(3))<br>
SC=V/1000<br>
$THETA 5.0 10.0 2.0 0.1 0.1<br>
$OMEGA BLOCK (3)<br>
0.5<br>
0.01 0.5<br>
0.01 0.01 0.5<br>
; Because THETA(4) and THETA(5) have no inter-subject variability<br>
; associated with them, the algorithm must use a more computationally<br>
; expensive gradient evaluation for these two parameters<br>
$SIGMA 0.1<br>
$PRIOR NWPRI<br>
; Priors to Omegas<br>
$OMEGAP BLOCK (3)<br>
0.09 FIX<br>
0.0 0.09<br>
0.0 0.0 0.09<br>
$OMEGAPD (3 FIX)<br>
$ERROR<br>
EXPP=THETA(4)+F*THETA(5)<br>
IF (TYPE.EQ.0) THEN<br>
; PK Data<br>
EX-37<br>
<hr>
<A name=692></a>BAYES10 EXAMPLES<br>
Help Guide<br>
F_FLAG=0<br>
Y=F+F*ERR(1) ; a prediction<br>
ELSE<br>
; Categorical data<br>
F_FLAG=1<br>
; Use protected exponent PEXP, to avoid numerical overflow<br>
A=PEXP(EXPP)<br>
B=1+A<br>
Y=DV*A/B+(1-DV)/B ; a likelihood<br>
ENDIF<br>
$EST METHOD=ITS INTER LAP NITER=1000 PRINT=5 SIGL=6 NSIG=2<br>
NOABORT NOPRIOR=1 CTYPE=3 CITER=10 CALPHA=0.05<br>
FILE=example10.ext<br>
; Because of categorical data, which can make conditional density highly<br>
; non-normal, select a t-distribution with 4 degrees of freedom for<br>
; importance sampling proposal density<br>
$EST METHOD=IMP INTER LAP NITER=1000 PRINT=1 ISAMPLE=300 DF=4<br>
IACCEPT=1.0<br>
$EST METHOD=IMP EONLY=1 NITER=5 ISAMPLE=1000 PRINT=1 DF=4<br>
IACCEPT=1.0 MAPITER=0<br>
$EST METHOD=SAEM EONLY=0 INTER LAP NBURN=2000 NITER=1000 PRINT=50<br>
DF=0 IACCEPT=0.4<br>
$EST METHOD=IMP EONLY=1 NITER=5 ISAMPLE=1000 PRINT=1 DF=4<br>
IACCEPT=1.0 MAPITER=0<br>
$EST METHOD=BAYES NBURN=3000 NSAMPLE=3000 PRINT=100<br>
FILE=example10.txt DF=0 IACCEPT=0.4 NOPRIOR=0<br>
$EST METHOD=COND LAP INTER MAXEVAL=9999 PRINT=1 FILE=example10.ext<br>
NOPRIOR=1 NOHABORT<br>
$COV UNCONDITIONAL PRINT=E MATRIX=R SIGL=10<br>
$TABLE ID DOSE WT TIME TYPE DV A NOPRINT FILE=example10.tab<br>
REFERENCES: Guide Introduction_7<br>
EX-38<br>
<hr>
<A name=693></a>Help Guide<br>
EXAMPLES BAYES10l<br>
BAYES EXAMPLE 10L<br>
This is example10l.ctl from the NONMEM 7 distribution medium. It, along with the data<br>ﬁle, can be found in the examples directory.<br>
$PROB F_FLAG04est2a.ctl<br>
$INPUT C ID DOSE=AMT TIME DV WT TYPE<br>
$DATA example10l.csv IGNORE=@<br>
$SUBROUTINES ADVAN2 TRANS2<br>
$PK<br>
CALLFL=1<br>
MU_1=THETA(1)<br>
KA=DEXP(MU_1+ETA(1))<br>
MU_2=THETA(2)<br>
V=DEXP(MU_2+ETA(2))<br>
MU_3=THETA(3)<br>
CL=DEXP(MU_3+ETA(3))<br>
SC=V/1000<br>
$THETA 1.6 2.3 0.7 0.1 0.1<br>
$OMEGA BLOCK (3)<br>
0.5<br>
0.01 0.5<br>
0.01 0.01 0.5<br>
; Because THETA(4) and THETA(5) have no inter-subject variability<br>
; associated with them, the algorithm must use a more computationally<br>
; expensive gradient evaluation for these two parameters<br>
$SIGMA 0.1<br>
$PRIOR NWPRI<br>
; Priors to Omegas<br>
$OMEGAP BLOCK (3)<br>
0.09 FIX<br>
0.0 0.09<br>
0.0 0.0 0.09<br>
$OMEGAPD (3 FIX)<br>
$ERROR<br>
EXPP=THETA(4)+F*THETA(5)<br>
IF (TYPE.EQ.0) THEN<br>
EX-39<br>
<hr>
<A name=694></a>BAYES10l EXAMPLES<br>
Help Guide<br>
; PK Data<br>
F_FLAG=0<br>
Y=F+F*ERR(1) ; a prediction<br>
ELSE<br>
; Categorical data<br>
F_FLAG=1<br>
; Use protected exponent PEXP, to avoid numerical overflow<br>
A=PEXP(EXPP)<br>
B=1+A<br>
Y=DV*A/B+(1-DV)/B ; a likelihood<br>
ENDIF<br>
$EST METHOD=ITS INTER LAP NITER=1000 PRINT=5 SIGL=6 NSIG=2 NOABORT<br>
NOPRIOR=1 CTYPE=3 CITER=10 CALPHA=0.05 FILE=example10l.ext<br>
; Because of categorical data, which can make conditional density highly<br>
; non-normal, select a t-distribution with 4 degrees of freedom for<br>
; importance sampling proposal density<br>
$EST METHOD=IMP INTER LAP NITER=1000 PRINT=1 ISAMPLE=300 DF=4 IACCEPT=1.0<br>
$EST METHOD=IMP EONLY=1 NITER=5 ISAMPLE=1000 PRINT=1 DF=4 IACCEPT=1.0<br>
MAPITER=0<br>
$EST METHOD=SAEM EONLY=0 INTER LAP NBURN=2000 NITER=1000 PRINT=50<br>
DF=0 IACCEPT=0.4<br>
$EST METHOD=IMP EONLY=1 NITER=5 ISAMPLE=1000 PRINT=1 DF=4<br>
IACCEPT=1.0 MAPITER=0<br>
$EST METHOD=BAYES NBURN=3000 NSAMPLE=3000 PRINT=100<br>
FILE=example10l.txt DF=0 IACCEPT=0.4 NOPRIOR=0<br>
$EST METHOD=COND LAP INTER MAXEVAL=9999 PRINT=1 FILE=example10l.ext<br>
NOPRIOR=1<br>
$COV UNCONDITIONAL PRINT=E MATRIX=R SIGL=10<br>
$TABLE ID DOSE WT TIME TYPE DV A NOPRINT FILE=example10l.tab<br>
REFERENCES: Guide Introduction_7<br>
EX-40<br>
<hr>
<A name=695></a>Help Guide<br>
EXAMPLES BIND<br>
BIND EXAMPLE<br>
EXAMPLES OF THE USE OF $BIND<br>
Case 1.<br>
Suppose a fragment of the dose records looks like this:<br>
TIME AMT PREP<br>
X<br>
0<br>
100 4 .<br>
10 100<br>
1<br>
90<br>
20 0 0<br>
80<br>
Suppose $INPUT and $PK include this code:<br>
$INPUT ID TIME AMT DV PREP X<br>
$PK<br>
F1=1<br>
IF (PREP.EQ.4) F1=THETA(3)<br>
ALAG1=THETA(5)<br>
CL=THETA(1)*X*EXP(ETA(1))<br>
It is intended that theta(3) be the ratio of bioavailabilities of preparation 4 to preparation<br>1. However, calls to PK are made only at event times 0, 10 and 20. Suppose the value of<br>theta(5) (lag time) is 5. After 5 time units, the ﬁrst dose enters the system. The value of<br>PREP (dose preparation type) is taken from the event record at time 10, which is 1. F1 is<br>computed incorrectly. If the estimation step is run, the gradient with theta(3) will be 0,<br>indicating the problem.<br>
Case 2.<br>
If lag time is not modeled (no ALAG1), but the doses are multiple (ADDL&gt;0, II&gt;0), a<br>more subtle error can occur. Suppose a fragment of the data records looks like this:<br>
TIME AMT PREP<br>
X<br>
II<br>
ADDL<br>
0<br>
100 4 .<br>
5<br>
1<br>
10 100<br>
1<br>
90<br>
5<br>
 <br>
1<br>
20 0 0<br>
80 .<br>
.<br>
Suppose $INPUT and $PK include this code:<br>
$INPUT ID TIME AMT DV PREP X II ADDL<br>
$PK<br>
F1=1<br>
IF (PREP.EQ.4) F1=THETA(3)<br>
CL=THETA(1)*X*EXP(ETA(1))<br>
F1 is computed correctly for the initiating dose records at times 0 and 10, and for the<br>additional dose at time 15, but incorrectly for the additional dose at time 5. Theta(3)<br>applies only to the ﬁrst dose having PRED=4. (The gradient for theta(3) is not 0.) The<br>same problem could have occurred with the dose having PREP=1, except that by an acci-<br>dent of coding, PREP=0 (on the record having TIME=20) is treated the same as PREP=1,<br>so that the additional dose at time 15 has F1=1 as it should.<br>
On the other hand, the values of X are presumably recorded so that 90 is valid for the<br>time 0 through 10 and 80 is valid for the time 10 through 20. Therefore, the model for<br>CL is correct in both examples.<br>
EX-41<br>
<hr>
<A name=696></a>BIND EXAMPLES<br>
Help Guide<br>
In either of these two examples, the model can be corrected by the insertion of $BIND<br>and CALLFL=-2:<br>
$INPUT ID TIME AMT DV PREP X II ADDL ; II &amp; ADDL only in case 2<br>
$BIND -<br>
-<br>
-<br>
- DOSE NEXT<br>
$PK<br>
CALLFL=-2<br>
Because of CALLFL=-2 in the abbreviated code, additional calls to PK are made at the<br>nonevent dose times (5 in case 1; 5 and 15 in case 2). Because of the $BIND record,<br>PREP has the value at these calls from the initiating dose record (4 at time 5, 1 at time<br>15). F1 is computed appropriately for the dose preparation. X still has values from the<br>next event record, so the computation of CL is unchanged, e.g., it is the same from<br>time=0 to time=5 as it is from time=5 to time=10.<br>
(See <b>$BIND</b>).<br>
REFERENCES: Guide IV, section V.C.2 , V.C.5<br>
REFERENCES: Guide VI, section III.B.2 , V.K<br>
EX-42<br>
<hr>
<A name=697></a>Help Guide<br>
EXAMPLES BIVARIATE<br>
BIVARIATE FUNCTION<br>
This is a fully-worked out example of the use of the $ABBREVIATED FUNCTION<br>option to declare a user-deﬁned function. In this example, the function BIVARIATE is<br>used to compute the integral of the bivariate normal distribution of two correlated data<br>points, DV1 and DV2, with correlation RHO.<br>
This is bivariate.ctl from the NONMEM 7 distribution medium. This ﬁle, the data ﬁle<br>bivariate.csv, and the function’s source code bivariate.f90 can be found in the examples<br>directory.<br>$PROB BIVARIATE EXAMPLE<br>
; THESE DECLARATIONS ALLOW ANY FUNCTION TO HAVE<br>
; ALTERNATIVE DIMENSIONS FOR THEIR ARRAYS<br>
; BUT, USER DEFINED DIMENSIONS ARE PASSED AS THE<br>
; LAST ARGUMENT TO FUNC, SUCH AS:<br>
; BV=BIVARIATE(VBI(1),FNC001_1(1,1),FNC001_2(1,1,1),5)<br>
$ABBR FUNCTION BIVARIATE(VBI,5)<br>
$INPUT SIM ID DOSE DV TIME<br>
$DATA bivariate.csv IGNORE=@<br>
$SUBROUTINES OTHER=bivariate.f90<br>
$PRED<br>
B1=THETA(1)<br>
B2=THETA(2)<br>
B3=THETA(3)<br>
K =LOG(2)/EXP(THETA(4))<br>
ED50=EXP(THETA(5))<br>
U =(1-EXP(-K*TIME ))<br>
MU_1=B1+B3*DOSE/(DOSE+ED50)<br>
MU_2=B2<br>
MXB=MU_1+ETA(1)<br>
MXU=MU_2+ETA(2)<br>
MX =MXB + MXU*U<br>
;***Current model prediction***;<br>
PHIMX=PHI(MX)<br>
IF(NEWIND.NE.2) THEN<br>
TIMEP=0<br>
MXP=0<br>
DVP=0<br>
PHIMXP=0.5<br>
ENDIF<br>
RHOB=(2/(1+EXP(-THETA(8)))-1)<br>
IF(RHOB&gt;0.0) RHO=RHOB**(TIME-TIMEP)<br>
IF(RHOB==0.0) RHO=0.0<br>
IF(RHOB&lt;0.0) RHO=-(-RHOB)**(TIME-TIMEP)<br>
EX-43<br>
<hr>
<A name=698></a>BIVARIATE EXAMPLES<br>
Help Guide<br>
PC =(1-PHIMX) *(1-DV ) + PHIMX*DV<br>
IF(PC.LE.0.0) EXIT<br>
V=SQRT(1+OMEGA(1,1)+OMEGA(2,2)*U**2)<br>
POPP = (B1+B2*U +B3*DOSE/(DOSE+ED50))/V ;*Population mean prediction*;<br>
IF (TIME.EQ.1) THEN<br>
JP=PC<br>
PCP=1.0<br>
ELSE<br>
;***Pass information to bivariate normal***;<br>
VBI(1)=RHO<br>
VBI(2)=MX<br>
VBI(3)=MXP<br>
VBI(4)=1 ;*0 = Upper tail as in Drezner &amp; Wesolowsky; 1 = Bottom tail*;<br>
VBI(5)=1 ;*0 = 3 pt approximation; 1 = 5 point approximation*;<br>
BV=BIVARIATE(VBI)<br>
JP=((DV-1)*(DVP-1)+(DV-1)*(1-2*DVP)*PHIMXP+(DVP-1) &amp;<br>
*(1-2*DV)*PHIMX+(1-2*DV)*(1-2*DVP)*BV)<br>
ENDIF<br>
IF(JP.LE.0.0) EXIT<br>
LOGL=LOG(JP/PCP)<br>
Y = -2*LOGL<br>
MXP=MX<br>
PCP=PC<br>
DVP=DV<br>
TIMEP=TIME<br>
PHIMXP=PHIMX<br>
$THETA<br>
-1.7 ; 1<br>
B1<br>
1.2 ; 2<br>
B2<br>
2.9 ; 3<br>
B3<br>
1.4 ; 4<br>
LOG(B4)<br>
1.2 ; 5<br>
LOG(B5)<br>
(0.0 FIXED)<br>
; 6   LOG SQRT VAR(ETA1)<br>
(0.0 FIXED)<br>
; 7   LOG SQRT VAR(ETA2)<br>
2.2 ; 8<br>
RHO parameter<br>
$OMEGA DIAGONAL(2)<br>
0.8 ; V1<br>
0.8 ; V2<br>
;$EST METHOD=IMP LAPLACE -2LL PRINT=1 NITER=300 ISAMPLE=300<br>
;SIGL=6 CTYPE=3 NOHABORT<br>
$EST MAX=0 PRINT=1 METHOD=1 LAPLACE -2LL SIGL=10 NOHABORT<br>
$COV COMPRESS MATRIX=R PRINT=E UNCONDITIONAL<br>
EX-44<br>
<hr>
<A name=699></a>Help Guide<br>
EXAMPLES BIVARIATE<br>
Here is a fragment of the data ﬁle bivariate.csv:<br>
SIM,ID,DOSE,DV,TIME<br>
1,1,0,0,1<br>
1,1,0,0,2<br>
1,1,0,0,4<br>
1,1,0,0,8<br>
1,1,0,0,16<br>
1,1,0,0,24<br>
1,1,0,0,36<br>
This is the ﬁle bivariate.f90. (The extension .f90 in the ﬁle name is not actually required<br>because the contents of the ﬁle is copied to FSUBS and compiled as part of FSUBS. It is<br>not compiled independently.)<br>
! Integral of Bivariate normal distribution of two correlated data points,<br>
! DV1, DV2, correlation RHO.<br>
! BV1, BV2 and GAUSS FROM Drezner and Wesolowsky,<br>
! J. Statistical Computat. Simul. 35, pp. 101-107, 1990.<br>
! BV2 is more accurate for extreme values of rho<br>
! Partial derivatives worked out by Robert Bauer.<br>
!<br>
! How to use in NONMEM 7.4<br>
! VBI is a suggested vector name.<br>
Could be any name.<br>
! But the function name must match what is in bivariate.f90<br>
! $ABBR FUNCTION BIVARIATE(VBI,5)<br>
! $SUBROUTINES ... OTHER=bivariate.f90<br>
! $PK<br>
! ...<br>
! DV1 AND DV2 SHOULD BE TWO SEPARATE DATA ITEMS ON EACH RECORD.<br>
!<br>
VBI(1)=RHO<br>
!<br>
VBI(2)=DV1 ! H<br>
!<br>
VBI(3)=DV2 !K<br>
!<br>
VBI(4)=DTYPE !=0 FOR H TO INF, K TO INF, OR 1 FOR -INF TO H, -INF TO K<br>
!<br>
VBI(5)=BVTYPE ! BVTYPE=0 USES SIMPLE INTEGRATOR, BVTYPE=1 USES MORE<br>
! ACCURATE ONE FOR LARGE VALUES OF RHO<br>
!<br>
F_FLAG=1<br>
! IT IS SAFER TO AVOID BV BEING EXACTLY 0, JUST MAKE SURE<br>
! IT IS REALLY SMALL, TO AVOID LOG() ERRORS<br>
!<br>
BV=BIVARIATE(VBI)+1.0D-30<br>
!<br>
IF YOU USE -2LL FORMAT (DEFAULT):<br>
!<br>
Y=-2.0D+00*LOG(BV)<br>
FUNCTION BIVARIATE(X,X1,X2,NDIM)<br>
! NDIM SHOULD EQUAL 5<br>
!<br>
IMPLICIT REAL*8 (A-H,O-Z)<br>
IMPLICIT NONE<br>
INTEGER NDIM<br>
REAL*8 X(NDIM),X1(NDIM),X2(NDIM,NDIM)<br>
REAL*8 R,H,K,ITYPE,PI,PI2,SPI2,R1,RSQR,HRK,KRH,PHRK,PKRH,XH,XK<br>
REAL*8 XHRK,XKRH,XC,BV,BV2,BIVARIATE,GAUSS,BV1<br>
EXTERNAL GAUSS,BV1,BV2<br>
INTEGER BVTYPE<br>
EX-45<br>
<hr>
<A name=700></a>BIVARIATE EXAMPLES<br>
Help Guide<br>
! unload the arguments<br>
R=X(1)<br>
H=X(2)<br>
K=X(3)<br>
ITYPE=X(4)<br>
BVTYPE=X(5)<br>
! ITYPE=0 INTGRATE H TO INF, K TO INF<br>
! ITYPE=1 INTGRATE -INF TO H -INF TO K<br>
! BVTYPE=0 USES THE SIMPLER BV1<br>
! BVTYPE=1 USES THE MORE ACCURATE BV2<br>
! SET UP SOME USEFUL CALCUATIONS FOR FIRST<br>
! AND SECOND DERIVATIVES OF THE ARGUMENTS<br>
! DERIVATIVES NOT NEEDED IF YOU USE IMP, SAEM, BAYES, OR IF<br>
! YOU USE LAPLACE OR ITS WITH OPTMAP=1 ETADER=3 (NONMEM 7.3), OR<br>
! DERIVATIVES NEEDED IF YOU USE STANDARD LAPLACE<br>
PI=3.141592653589793238D+00<br>
PI2=2.0D+00*pi<br>
spi2=sqrt(pi2)<br>
R1=1.0D+00-R*R<br>
RSQR=SQRT(ABS(R1))<br>
IF(RSQR.LE.0.0D+00) RSQR=1.0D-100<br>
IF(R1.LE.0.0D+00) R1=1.0D-100<br>
HRK=(H-R*K)/RSQR<br>
KRH=(K-R*H)/RSQR<br>
PHRK=1.0D+00-GAUSS(HRK)<br>
PKRH=1.0D+00-GAUSS(KRH)<br>
XH=EXP(-H*H/2.0D+00)/SPI2<br>
XK=EXP(-K*K/2.0D+00)/SPI2<br>
XHRK=EXP(-HRK*HRK/2.0D+00)/SPI2/RSQR<br>
XKRH=EXP(-KRH*KRH/2.0D+00)/SPI2/RSQR<br>
XC=EXP(-(H*H-2.0D+00*R*H*K+K*K)/2.0D+00/R1)/RSQR/PI2<br>
! parital F WRT RHO, from Drezner and Wesolowsky, equation (4)<br>
X1(1)=XC<br>
! parital F WRT H<br>
X1(2)=XH*PKRH+(ITYPE-1.0D+00)*XH<br>
! parital F WRT K<br>
X1(3)=XK*PHRK+(ITYPE-1.0D+00)*XK<br>
! 2ND parital F WRT RHO,RHO<br>
X2(1,1)=R/R1*XC+XC*(H*K*(1.0D+00-R)*(1.0D+00-R)-R*(H-K)*(H-K))/R1/R1<br>
! 2ND parital F WRT RHO,H<br>
X2(1,2)=XC*(R*K-H)/R1<br>
! 2ND parital F WRT RHO,K<br>
X2(1,3)=XC*(R*H-K)/R1<br>
X2(2,1)=X2(1,2)<br>
X2(3,1)=X2(1,3)<br>
! 2ND parital F WRT H,K<br>
X2(2,3)=XC<br>
X2(3,2)=X2(2,3)<br>
! 2ND parital F WRT H,H<br>
EX-46<br>
<hr>
<A name=701></a>Help Guide<br>
EXAMPLES BIVARIATE<br>
X2(2,2)=-X1(2)*H-XC*R<br>
! 2ND parital F WRT K,K<br>
X2(3,3)=-X1(3)*K-XC*R<br>
!<br>
write(50,*) ’A ’,x1(1),x1(2),x1(3)<br>
!<br>
write(50,*) ’B ’,x2(1,1),x2(1,2),x2(1,3),x2(2,1), &amp;<br>
!<br>
x2(2,2),x2(2,3),x2(3,1),x2(3,2),x2(3,3)<br>
! bV2 is more accurate for exterme rho values.<br>
IF(BVTYPE==0) THEN<br>
BV=BV1(H,K,R)<br>
ELSE<br>
BV=BV2(H,K,R)<br>
ENDIF<br>
IF(ITYPE==1.0D+00) BV=BV-GAUSS(H)-GAUSS(K)+1.0D+00<br>
BIVARIATE=BV<br>
RETURN<br>
END<br>
FUNCTION BV1(H1,H2,R)<br>
IMPLICIT NONE<br>
INTEGER I<br>
!<br>
IMPLICIT REAL*8 (A-H,O-Z)<br>
REAL*8 H1,H2,R,H12,BV,BV1,RR,RR2,H3,GAUSS<br>
EXTERNAL GAUSS<br>
REAL*8 X(5),W(5),DVAL<br>
DATA X/.04691008,.23076534,.5,.76923466,.95308992/<br>
DATA W/.018854042,.038088059,.0452707394,.038088059,.018854042/<br>
H12 =(H1*H1+ H2*H2)/2.0D+00<br>
H3 = H1*H2<br>
BV = 0.0D+00<br>
DO 1 I= 1,5<br>
RR = R*X(I)<br>
RR2= 1.0D+00-RR*RR<br>
IF(RR2.LE.0.0D+00) RR2=1.0D-100<br>
DVAL=(RR*H3 - H12)/RR2<br>
IF(DVAL.GT.300.0D+00) DVAL=300.0D+00<br>
BV = BV + W(I)*EXP(DVAL)/SQRT(RR2)<br>
1 CONTINUE<br>
BV = BV*R + GAUSS(H1)*GAUSS(H2)<br>
BV1=BV<br>
RETURN<br>
END<br>
FUNCTION BV2(H1,HK,R)<br>
IMPLICIT NONE<br>
!<br>
IMPLICIT REAL*8 (A-H,O-Z)<br>
REAL*8 X(5),W(5)<br>
REAL*8 H1,HK,R,H2,H12,BV,BV2,R2,R3,H3,H7,H6,H5,AA,AB,R1,RR,GAUSS,RR2<br>
EX-47<br>
<hr>
<A name=702></a>BIVARIATE EXAMPLES<br>
Help Guide<br>
REAL*8 DVAL,DVAL2<br>
EXTERNAL GAUSS<br>
INTEGER I<br>
DATA X/.04691008,.23076534,.5,.76923466,.95308992/<br>
DATA W/.018854042,.038088059,.0452707394,.038088059,.018854042/<br>
H2 = HK<br>
H12 = (H1*H1+ H2*H2)/2.0D+00<br>
BV = 0.0D+00<br>
IF(ABS(R).LT.0.7D+00)GO TO 4<br>
R2= 1.0D+00-R*R<br>
R3 = SQRT(R2)<br>
IF(R.LT.0.0D+00)H2 = -H2<br>
H3=H1*H2<br>
H7 = EXP( -H3/2.0D+00)<br>
IF(R2.EQ.0.0D+00) GO TO 3<br>
H6 = ABS(H1 - H2)<br>
H5 = H6*H6/2.0D+00<br>
H6 = H6/R3<br>
AA = 0.5D+00 - H3/8.0D+00<br>
AB = 3.0D+00 - 2.0D+00*AA*H5<br>
BV = .13298076D+00*H6*AB*GAUSS(H6) &amp;<br>
-EXP(-H5/R2)*(AB + AA*R2)*.053051647D+00<br>
DO 2 I= 1,5<br>
R1= R3*X(I)<br>
RR = R1*R1<br>
R2 = SQRT(DABS(1.0D+00 - RR))<br>
IF(R2.EQ.0.0D+00) R2=1.0D-100<br>
IF(RR.EQ.0.0D+00) RR=1.0D-100<br>
DVAL=-H5/RR<br>
IF(DVAL.GT.300.0D+00) DVAL=300.0D+00<br>
DVAL2=-H3/(1.0D+00 + R2)<br>
IF(DVAL2.GT.300.0D+00) DVAL2=300.0D+00<br>
BV = BV - W(I)*EXP(DVAL)*(EXP(DVAL2)/R2/H7 - 1.0D+00 - AA*RR)<br>
2 CONTINUE<br>
3 IF(R.GT.0.0D+00)BV = BV*R3*H7 + GAUSS(MAX(H1,H2))<br>
IF(R.LT.0.0D+00)BV = MAX(0.0D+00,GAUSS(H1) - GAUSS(H2)) - BV*R3*H7<br>
BV2=BV<br>
RETURN<br>
4 H3=H1*H2<br>
DO 1 I= 1,5<br>
R1= R*X(I)<br>
RR2= 1.0D+00-R1*R1<br>
IF(RR2.EQ.0.0D+00) RR2=1.0D-100<br>
1 BV = BV + W(I)*EXP((R1*H3 -H12)/RR2)/SQRT(RR2)<br>
BV2 =GAUSS(H1)*GAUSS(H2) + R*BV<br>
RETURN<br>
END<br>
FUNCTION GAUSS(Z)<br>
IMPLICIT NONE<br>
EX-48<br>
<hr>
<A name=703></a>Help Guide<br>
EXAMPLES BIVARIATE<br>
!<br>
IMPLICIT REAL*8 (A-H,O-Z)<br>
REAL*8 Z,GAUSS,X,G<br>
REAL*8 A(4)<br>
INTEGER I<br>
DATA A/ -.72657601,.71070688,-.142248368,.127414796/<br>
X= 1.0D+00/(1.0D+00 + .23164189D+00*ABS(Z))<br>
G = .53070271D+00<br>
DO 1 I= 1,4<br>
1 G=G*X+A(I)<br>
GAUSS = G*X*EXP( - Z*Z/2.0D+00)<br>
IF(Z.LT.0.0D+00)GAUSS = 1.0D+00 -GAUSS<br>
RETURN<br>
END<br>
! USE PROGRAM HEADER FOR STAND-ALONE EXECUTABLE TESTING<br>
!<br>
PROGRAM BIVTEST<br>
SUBROUTINE BIVTEST<br>
IMPLICIT REAL*8 (A-H,O-Z)<br>
REAL*8 A(9),A1(9),A2(9,9)<br>
REAL*8 AH(9),AH1(9),AH2(9,9)<br>
REAL*8 AJ(9),AJ1(9),AJ2(9,9)<br>
REAL*8 B(9),B1(9),B2(9,9)<br>
REAL*8 H,K<br>
HDEL=1.0D-04<br>
1 CONTINUE<br>
WRITE(*,*) ’ENTER RHO,H,K,INTEGRAND-TYPE,BVTYPE’<br>
READ(*,*) RHO,H,K,DTYPE,BVTYPE<br>
A(1)=RHO<br>
A(2)=H<br>
A(3)=K<br>
A(4)=DTYPE<br>
A(5)=BVTYPE<br>
BV=FUNCA(A,A1,A2)<br>
WRITE(*,*) ’VALUE ’,BV<br>
WRITE(*,*) GAUSS(-1.96D+00),GAUSS(1.96D+00)<br>
AH(1:5)=A(1:5)<br>
AH(1)=RHO-HDEL<br>
AJ(1:5)=A(1:5)<br>
AJ(1)=RHO+HDEL<br>
BVH=FUNCA(AH,AH1,AH2)<br>
BVJ=FUNCA(AJ,AJ1,AJ2)<br>
B1(1)=(BVJ-BVH)/2.0D+00/HDEL<br>
B2(1,1)=(AJ1(1)-AH1(1))/2.0D+00/HDEL<br>
B2(1,2)=(AJ1(2)-AH1(2))/2.0D+00/HDEL<br>
B2(1,3)=(AJ1(3)-AH1(3))/2.0D+00/HDEL<br>
WRITE(*,*)<br>
WRITE(*,*) ’ANALOG RHO’,A1(1),A2(1,1),A2(1,2),A2(1,3)<br>
WRITE(*,*) ’NUMER RHO’,B1(1),B2(1,1),B2(1,2),B2(1,3)<br>
AH(1:5)=A(1:5)<br>
EX-49<br>
<hr>
<A name=704></a>BIVARIATE EXAMPLES<br>
Help Guide<br>
AH(2)=H-HDEL<br>
AJ(1:5)=A(1:5)<br>
AJ(2)=H+HDEL<br>
BVH=FUNCA(AH,AH1,AH2)<br>
BVJ=FUNCA(AJ,AJ1,AJ2)<br>
B1(2)=(BVJ-BVH)/2.0D+00/HDEL<br>
B2(2,1)=(AJ1(1)-AH1(1))/2.0D+00/HDEL<br>
B2(2,2)=(AJ1(2)-AH1(2))/2.0D+00/HDEL<br>
B2(2,3)=(AJ1(3)-AH1(3))/2.0D+00/HDEL<br>
WRITE(*,*)<br>
WRITE(*,*) ’ANALOG H’,A1(2),A2(2,1),A2(2,2),A2(2,3)<br>
WRITE(*,*) ’NUMER H’,B1(2),B2(2,1),B2(2,2),B2(2,3)<br>
AH(1:5)=A(1:5)<br>
AH(3)=K-HDEL<br>
AJ(1:5)=A(1:5)<br>
AJ(3)=K+HDEL<br>
BVH=FUNCA(AH,AH1,AH2)<br>
BVJ=FUNCA(AJ,AJ1,AJ2)<br>
B1(3)=(BVJ-BVH)/2.0D+00/HDEL<br>
B2(3,1)=(AJ1(1)-AH1(1))/2.0D+00/HDEL<br>
B2(3,2)=(AJ1(2)-AH1(2))/2.0D+00/HDEL<br>
B2(3,3)=(AJ1(3)-AH1(3))/2.0D+00/HDEL<br>
WRITE(*,*)<br>
WRITE(*,*) ’ANALOG K’,A1(3),A2(3,1),A2(3,2),A2(3,3)<br>
WRITE(*,*) ’NUMER K’,B1(3),B2(3,1),B2(3,2),B2(3,3)<br>
GO TO 1<br>
END<br>
REFERENCES: Guide Introduction_7<br>
EX-50<br>
<hr>
<A name=705></a>Help Guide<br>
EXAMPLES CCONTR<br>
CCONTR EXAMPLE<br>
This example illustates the use of the CONTR and CCONTR stubs with NONMEM 7.<br>This example was developed by Bill Frame.<br>
$PROBLEM<br>
$DATA NMDATA7.CSV<br>
$INPUT ID DV<br>
$SUB CONTR=CONTR.txt CCONTR=CCONTR.txt<br>
$PRED<br>
W=THETA(2) ;SD<br>
CL=THETA(1)*EXP(ETA(1)) ;CL/F<br>
PRE=1/CL ;@ SS ASSUMING INPUT RATE = 1<br>
LAM=THETA(3)<br>
Y=(PRE**LAM-1)/LAM+EPS(1)*W<br>
RES1=(DV-PRE)/W<br>
$THETA<br>
(0,.1) ;CL/F<br>
(0,2) ;SD ADDITIVE<br>
(0,.251) ;BOX COX LAMBDA PARAMETER<br>
$OMEGA<br>
.003<br>
$SIGMA<br>
1 FIX<br>
$EST MAXEVALS=9999 METH=1 PRINT=1<br>
$COV PRINT=E<br>
Files CONTR.txt and CCONTR.txt are as follows:<br>
SUBROUTINE CONTR (ICALL,CNT,IER1,IER2)<br>
DOUBLE PRECISION CNT<br>
CALL NCONTR (CNT,IER1,IER2,L2R)<br>
RETURN<br>
END<br>
SUBROUTINE CCONTR(I,CNT,P1,P2,IER1,IER2)<br>
USE SIZES, ONLY: ISIZE,DPSIZE<br>
USE ROCM_REAL,<br>
ONLY: THETA=&gt;THETAC,Y=&gt;DV_ITM2<br>
USE NM_INTERFACE,ONLY: CELS<br>
IMPLICIT NONE<br>
INTEGER(KIND=ISIZE), INTENT(IN OUT) :: I,IER1,IER2<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: CNT,P1(:),P2(:,:)<br>
REAL(KIND=DPSIZE) :: ONE,TWO,W<br>
DATA ONE,TWO/1.00D+00,2.00D+00/<br>
SAVE<br>
IF (I.LE.1) RETURN<br>
W=Y(1)<br>
Y(1)=(Y(1)**THETA(3)-ONE)/THETA(3)<br>
CALL CELS (CNT,P1,P2,IER1,IER2)<br>
Y(1)=W<br>
EX-51<br>
<hr>
<A name=706></a>CCONTR EXAMPLES<br>
Help Guide<br>
CNT=CNT-TWO*(THETA(3)-ONE)*LOG(Y(1))<br>
RETURN<br>
END<br>
The ﬁrst individual’s data follows.<br>
id,dv<br>
1,223.28<br>
1,41.59<br>
1,87.6<br>
1,72.11<br>
1,216.32<br>
1,118.1<br>
1,232.29<br>
REFERENCES: Guide Introduction_7<br>
EX-52<br>
<hr>
<A name=707></a>Help Guide<br>
EXAMPLES CONTROL3<br>
CONTROL3 EXAMPLE<br>
This is ﬁle CONTROL3 from the NONMEM distribution medium.<br>
$PROBLEM THEOPHYLLINE<br>
SINGLE SUBJECT DATA<br>
$INPUT DOSE=AMT TIME CP=DV<br>
$DATA DATA3<br>
$SUBROUTINES ADVAN2<br>
$PK<br>
CALLFL=1<br>
KA=THETA(1)<br>
K=THETA(2)<br>
SC=THETA(3)<br>
$ERROR<br>
Y=F+ERR(1)<br>
$THETA (0,1.7) (0,.102) (0,29)<br>
$ESTIMATION MAXEVAL=240 PRINT=2<br>
$COVR<br>
$TABLE TIME<br>
$SCAT CP VS TIME<br>
$SCAT PRED VS TIME<br>
$SCAT RES VS TIME<br>
$SCAT PRED VS CP<br>
UNIT<br>
The data is ﬁle DAT A3 from the NONMEM distribution media.<br>
320 .0<br>
.<br>
.<br>
.27 1.71<br>
.<br>
.52 7.91<br>
.<br>
1.<br>
8.31<br>
.<br>
1.92 8.33<br>
.<br>
3.5 6.85<br>
.<br>
5.02 6.08<br>
.<br>
7.03 5.4<br>
.<br>
9.<br>
4.55<br>
.<br>
12. 3.01<br>
.<br>
24.3 .90<br>
REFERENCES: Guide III, section VI.1<br>
EX-53<br>
<hr>
<A name=708></a>CONTROL4 EXAMPLES<br>
Help Guide<br>
CONTROL4 EXAMPLE<br>
This is ﬁle CONTROL4 from NONMEM distribution media<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE TIME CP=DV WT<br>
$DATA THEO<br>
$PRED<br>
;THETA(1)=MEAN ABSORPTION RATE CONSTANT (1/HR)<br>
;THETA(2)=MEAN ELIMINATION RATE CONSTANT (1/HR)<br>
;THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;DOSE=WT-ADJUSTED DOSE (MG/KG)<br>
;DS=NON-WT-ADJUSTED DOSE (MG)<br>
IF (DOSE.NE.0) THEN<br>
DS=DOSE*WT<br>
W=WT<br>
ENDIF<br>
KA=THETA(1)+ETA(1)<br>
KE=THETA(2)+ETA(2)<br>
CL=THETA(3)*W+ETA(3)<br>
D=EXP(-KE*TIME)-EXP(-KA*TIME)<br>
E=CL*(KA-KE)<br>
F=DS*KE*KA/E*D<br>
Y=F+EPS(1)<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA BLOCK(3)<br>
6 .005 .0002 .3 .006 .4<br>
$SIGMA .4<br>
$EST MAXEVAL=450<br>
PRINT=5<br>
$COV<br>
$TABLE ID DOSE WT TIME<br>
$SCAT (RES WRES) VS TIME BY ID<br>
The data is ﬁle THEO from the NONMEM distribution media. The ﬁrst individual’s data<br>follows.<br>
1<br>
4.02 0.<br>
.74 79.6<br>
1<br>
.<br>
 <br>
0.25 2.84<br>
.<br>
1<br>
.<br>
 <br>
0.57 6.57<br>
.<br>
1<br>
.<br>
 <br>
1.12 10.5<br>
.<br>
1<br>
.<br>
 <br>
2.02 9.66<br>
.<br>
1<br>
.<br>
 <br>
3.82 8.58<br>
.<br>
1<br>
.<br>
 <br>
5.1 8.36 .<br>
1<br>
.<br>
 <br>
7.03 7.47<br>
.<br>
1<br>
.<br>
 <br>
9.05 6.89<br>
.<br>
1<br>
.<br>
12.12 5.94<br>
.<br>
1<br>
.<br>
24.37 3.28<br>
.<br>
REFERENCES: Guide III, section VI.3<br>REFERENCES: Guide IV, Appendix II<br>
EX-54<br>
<hr>
<A name=709></a>Help Guide<br>
EXAMPLES CONTROL5<br>
CONTROL5 EXAMPLE<br>
This is ﬁle CONTROL5 from NONMEM distribution media<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
$DATA THEOPP<br>
$SUBROUTINES ADVAN2<br>
$PK<br>
;THETA(1)=MEAN ABSORPTION RATE CONSTANT (1/HR)<br>
;THETA(2)=MEAN ELIMINATION RATE CONSTANT (1/HR)<br>
;THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;SCALING PARAMETER=VOLUME/WT SINCE DOSE IS WEIGHT-ADJUSTED<br>
CALLFL=1<br>
KA=THETA(1)+ETA(1)<br>
K=THETA(2)+ETA(2)<br>
CL=THETA(3)*WT+ETA(3)<br>
SC=CL/K/WT<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA BLOCK(3)<br>
6 .005 .0002 .3 .006 .4<br>
$ERROR<br>
Y=F+EPS(1)<br>
$SIGMA .4<br>
$EST MAXEVAL=450<br>
PRINT=5<br>
$COV<br>
$TABLE ID DOSE WT TIME<br>
$SCAT (RES WRES) VS TIME BY ID<br>
The data is ﬁle THEOPP from the NONMEM distribution media. The ﬁrst individual’s<br>data follows.<br>
1<br>
4.02 0.<br>
.<br>
79.6<br>
1<br>
.<br>
 <br>
0.<br>
.74 .<br>
1<br>
.<br>
 <br>
0.25 2.84<br>
.<br>
1<br>
.<br>
 <br>
0.57 6.57<br>
.<br>
1<br>
.<br>
 <br>
1.12 10.5<br>
.<br>
1<br>
.<br>
 <br>
2.02 9.66<br>
.<br>
1<br>
.<br>
 <br>
3.82 8.58<br>
.<br>
1<br>
.<br>
 <br>
5.1 8.36 .<br>
1<br>
.<br>
 <br>
7.03 7.47<br>
.<br>
1<br>
.<br>
 <br>
9.05 6.89<br>
.<br>
1<br>
.<br>
12.12 5.94<br>
.<br>
1<br>
.<br>
24.37 3.28<br>
.<br>
REFERENCES: Guide III, VI.3<br>REFERENCES: Guide IV, Appendix VI<br>
EX-55<br>
<hr>
<A name=710></a>CONTROL6 EXAMPLES<br>
Help Guide<br>
CONTROL6 EXAMPLE<br>
This is ﬁle CONTROL6 from NONMEM distribution media.<br>It is discussed in Guide IV, Appendix VIII.<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
$DATA THEOPP<br>
$SUBROUTINES ADVAN7<br>
$MODEL COMP=(DEPOT,INITIALOFF,DEFDOSE) COMP=(CENTRAL,DEFOBS,NOOFF)<br>
$PK<br>
;THETA(1)=MEAN ABSORPTION RATE CONSTANT (1/HR)<br>
;THETA(2)=MEAN ELIMINATION RATE CONSTANT (1/HR)<br>
;THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;SCALING PARAMETER=VOLUME/WT SINCE DOSE IS WEIGHT-ADJUSTED<br>
CALLFL=1<br>
K12=THETA(1)+ETA(1)<br>
K20=THETA(2)+ETA(2)<br>
CL=THETA(3)*WT+ETA(3)<br>
S2=CL/K20/WT<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA BLOCK(3)<br>
6 .005 .0002 .3 .006 .4<br>
$ERROR<br>
Y=F+EPS(1)<br>
$SIGMA .4<br>
$EST MAXEVAL=450<br>
PRINT=5<br>
$COV<br>
$TABLE ID DOSE WT TIME<br>
$SCAT (RES WRES) VS TIME BY ID<br>
The data is ﬁle THEOPP from the NONMEM distribution media. The ﬁrst individual’s<br>data follows.<br>
1<br>
4.02 0.<br>
.<br>
79.6<br>
1<br>
.<br>
 <br>
0.<br>
.74 .<br>
1<br>
.<br>
 <br>
0.25 2.84<br>
.<br>
1<br>
.<br>
 <br>
0.57 6.57<br>
.<br>
1<br>
.<br>
 <br>
1.12 10.5<br>
.<br>
1<br>
.<br>
 <br>
2.02 9.66<br>
.<br>
1<br>
.<br>
 <br>
3.82 8.58<br>
.<br>
1<br>
.<br>
 <br>
5.1 8.36 .<br>
1<br>
.<br>
 <br>
7.03 7.47<br>
.<br>
1<br>
.<br>
 <br>
9.05 6.89<br>
.<br>
1<br>
.<br>
12.12 5.94<br>
.<br>
1<br>
.<br>
24.37 3.28<br>
.<br>
REFERENCES: Guide III, VI.3<br>REFERENCES: Guide IV, Appendix VI , VIII<br>
EX-56<br>
<hr>
<A name=711></a>Help Guide<br>
EXAMPLES CONTROL7<br>
CONTROL7 EXAMPLE<br>
This is ﬁle CONTROL7 from NONMEM distribution media<br>It is discussed in Guide IV, Appendix VIII.<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
$DATA THEOPP<br>
$SUBROUTINES ADVAN6 TOL=5<br>
$MODEL COMP=(DEPOT,INITIALOFF,DEFDOSE) COMP=(CENTRAL,DEFOBS,NOOFF)<br>
$PK<br>
;THETA(1)=MEAN ABSORPTION RATE CONSTANT (1/HR)<br>
;THETA(2)=MEAN ELIMINATION RATE CONSTANT (1/HR)<br>
;THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;SCALING PARAMETER=VOLUME/WT SINCE DOSE IS WEIGHT-ADJUSTED<br>
CALLFL=1<br>
KA=THETA(1)+ETA(1)<br>
KE=THETA(2)+ETA(2)<br>
CL=THETA(3)*WT+ETA(3)<br>
S2=CL/KE/WT<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA BLOCK(3)<br>
6 .005 .0002 .3 .006 .4<br>
$DES<br>
DADT(1)=-KA*A(1)<br>
DADT(2)= KA*A(1)-KE*A(2)<br>
$ERROR<br>
Y=F+EPS(1)<br>
$SIGMA .4<br>
$EST MAXEVAL=450<br>
PRINT=5<br>
$COV<br>
$TABLE ID DOSE WT TIME<br>
$SCAT (RES WRES) VS TIME BY ID<br>
The data is ﬁle THEOPP from the NONMEM distribution media. The ﬁrst individual’s<br>data follows.<br>
1<br>
4.02 0.<br>
.<br>
79.6<br>
1<br>
.<br>
 <br>
0.<br>
.74 .<br>
1<br>
.<br>
 <br>
0.25 2.84<br>
.<br>
1<br>
.<br>
 <br>
0.57 6.57<br>
.<br>
1<br>
.<br>
 <br>
1.12 10.5<br>
.<br>
1<br>
.<br>
 <br>
2.02 9.66<br>
.<br>
1<br>
.<br>
 <br>
3.82 8.58<br>
.<br>
1<br>
.<br>
 <br>
5.1 8.36 .<br>
1<br>
.<br>
 <br>
7.03 7.47<br>
.<br>
1<br>
.<br>
 <br>
9.05 6.89<br>
.<br>
1<br>
.<br>
12.12 5.94<br>
.<br>
1<br>
.<br>
24.37 3.28<br>
.<br>
REFERENCES: Guide III, section VI.3<br>REFERENCES: Guide IV, Appendix VI , VIII<br>
EX-57<br>
<hr>
<A name=712></a>DATA AVERAGE EXAMPLES<br>
Help Guide<br>
DATA AVERAGE EXAMPLE<br>
A template record is a data record that contains a non-zero value for the raw-data<br>(RAW_) data item. Only the DV values with those observation records (i.e., records with<br>MDV=0) matching the template data record will be included in the average. This av erage<br>replaces the DV item in the template record, and it may be displayed in a table or scatter-<br>plot.<br>
An observation record matches a template if all its data items are identical to all those on<br>the template, except that the values of NONMEM data items do not affect the match.<br>(Any nonNONMEM data item type may in fact be excluded from the match (See <b>omit</b>)).<br>
Example 1<br>
Here is a fragment of a data set (which may or may not actually be for PREDPP):<br>
#ID TIME AMT WT AGE EVID MDV DV RAW_ GEND<br>
1<br>
5<br>
 <br>
0<br>
70 50<br>
0<br>
1<br>
2<br>
1<br>
 <br>
1<br>
template record<br>
4<br>
5<br>
 <br>
0<br>
70 50<br>
0<br>
0<br>
4<br>
0<br>
 <br>
1<br>
observation record<br>
These two records match. The NONMEM items are the ID, MDV, DV, and RAW_ items.<br>The DV item with the observation record will be included in the average. The DV item in<br>the template record is ignored for the purpose of computing the average (MDV=1); the<br>displayed DV item with this record will be the average value, and the displayed RES item<br>will be the difference between this average and the PRED item. The average is taken<br>over all records matching the TIME, AMT, WT, AGE, EVID, and GEND items of the<br>template record.<br>
If the omit record<br>
$OMIT GEND<br>
appears, then the two records<br>
#ID TIME AMT WT AGE EVID MDV DV RAW_ GEND<br>
1<br>
5<br>
 <br>
0<br>
70 50<br>
0<br>
1<br>
2<br>
1<br>
 <br>
1<br>
template record<br>
4<br>
5<br>
 <br>
0<br>
70 50<br>
0<br>
0<br>
4<br>
0<br>
 <br>
2<br>
observation record<br>
also match. In this case the average is taken over all records matching the TIME, AMT,<br>WT, AGE, and EVID items of the template record.<br>
Example 2<br>
Here is an example of categorical dose-response with four different bolus doses per indi-<br>vidual (separated by washouts), and data averages are formed for each of the four doses.<br>
#ID DOSE DV MDV RAW_<br>
100 5<br>
.<br>
1<br>
 <br>
1<br>
set DV item to avr. for DOSE=5<br>
100 10<br>
.<br>
1<br>
 <br>
1<br>
set DV item to avr. for DOSE=10<br>
100 20<br>
.<br>
1<br>
 <br>
1<br>
set DV item to avr. for DOSE=20<br>
100 40<br>
.<br>
1<br>
 <br>
1<br>
set DV item to avr. for DOSE=40<br>
1<br>
5<br>
 <br>
1<br>
0<br>
0<br>
1<br>
10<br>
1<br>
0<br>
0<br>
1<br>
20<br>
2<br>
0<br>
0<br>
1<br>
40<br>
2<br>
0<br>
0<br>
2<br>
5<br>
 <br>
1<br>
0<br>
0<br>
EX-58<br>
<hr>
<A name=713></a>Help Guide<br>
EXAMPLES DAT A AVERAGE<br>
2<br>
10<br>
1<br>
0<br>
0<br>
2<br>
20<br>
1<br>
0<br>
0<br>
2<br>
40<br>
1<br>
0<br>
0<br>
3<br>
5<br>
 <br>
1<br>
0<br>
0<br>
3<br>
10<br>
2<br>
0<br>
0<br>
3<br>
20<br>
2<br>
0<br>
0<br>
3<br>
40<br>
3<br>
0<br>
0<br>
.<br>
.<br>
Example 3<br>
An average of a PRED-deﬁned item may also be displayed.<br>
$ABBREV COMRES=1 COMSAV=1<br>
...<br>
$PRED<br>
COM(1)=LOG(DV)<br>
...<br>
$TABLE COM(1)=LDV<br>
For template records, the value of LDV displayed in the table is the average of LOG DV<br>over all observation records matching the template.<br>
(See <b>data average block, raw</b>).<br>
REFERENCES: none.<br>
EX-59<br>
<hr>
<A name=714></a>ENTERHEPATIC EXAMPLES<br>
Help Guide<br>
ENTERHEPATIC CIRCULATION EXAMPLES<br>
The help item &quot;Model Time examples&quot; gives a fragment of code for modelling EHC<br>(Enterohepatic Circulation, which is also called Enterohepatic Recycling). It illustrates<br>the use of MTIME parameters to model instantaneous changes in differential equations.<br>This help item, &quot;Enterhepatic circulation examples&quot;, describes two fully-worked out con-<br>trol streams in the examples directory. They demonstrate how to generalize the fragment<br>to multiple sequential doses.<br>
Both examples use the same data. (hillss.dat and mtimess.dat are identical). There is a<br>steady-state bolus dose at time 0. The interdose interval II is 12, and there are enough<br>additional doses (ADDL=100) to continue the dosing pattern throughout the data set.<br>There are &quot;other&quot; records every 4 units till time 140 to allow compartment amounts to be<br>displayed and there is a ﬁnal observation record at time 144.<br>
mtimess.ctl<br>
This example incorporates the fragment into a complete control stream. MTIME<br>parameters are used to turn on and off the EHC terms in the differential equations.<br>The variable FLAG is 1 between times MTIME(1) and MTIME(2) after each dose<br>ev ent and turns on the EHC terms. After time MTIME(2) is reached, a new set of<br>MTIME’s is deﬁned which affect the next dosing interval. MTIME parameters are<br>not dose-related parameters and have no effect on steady-state dose events. Even if<br>PK computes MTIME(i)&lt; II, this produces future changes in the system, and does<br>not apply retroactively to the preceding implied doses.<br>(See <b>Guide VI, Section V.F.4, Note 4</b>).<br>A steady-state dose record should not be used. Instead, the SS dose record is<br>described as a transient dose with SS=DROP on the $INPUT record.<br>
hillss.ctl<br>
This control stream does not use MTIME. Instead, a smooth step model using Hill<br>terms in a sigmoid emax model is used. The $DES code has to compute all the nec-<br>essary variables. Flag1 and ﬂag2 are continuous variables that change from 0 to 1 at<br>the times corresponding to the MTIME’s. The FLAG variable is similar to FLAG in<br>mtimess.ctl. The changes to the differential equations are not instantaneous, but<br>they are continuous. If the exponent in the Hill term is made larger, the predictions<br>approach those of the MTIME model. However, very large values of the exponent<br>can lead to numerical difﬁculties in PREDPP. Smaller values of the exponent may be<br>more realistic physiologically. A Steady-State dose event record is used with this<br>model.<br>
Note that SS dose records should only be used when the kinetics implemented in the<br>model coincides with the II (interdose interval) of the SS record. Just as MTIME’s<br>cannot affect the differential equations retroactively, changes to the differential equa-<br>tions that happen in the future cannot affect the Steady-state calculations. For exam-<br>ple, with II=12, then the kinetics should not be different in the interval of time 0 to<br>12 vs. time 12 to 24 or time 24 to 36, etc. In each interval, changes occur at theta(8)<br>and theta(8)+theta(9) after the start of the interval. $DES computes the ﬁrst change<br>time for each interval using the INT function:<br>mt1=II*INT(T/II)+theta(8)<br>
NM-TRAN gives a warning about the use of the INT function in $DES:<br>
EX-60<br>
<hr>
<A name=715></a>Help Guide<br>
EXAMPLES ENTERHEPATIC<br>
(WARNING 68) THE INT, MOD, MIN, OR MAX FUNCTION IS BEING USED OUTSIDE<br>
OF A<br>
SIMULATION BLOCK. IF THE FUNCTION VALUE AFFECTS THE VALUE OF THE<br>
OBJECTIVE FUNCTION, THEN AN ERROR WILL PROBABLY OCCUR.<br>
This warning may be disregarded. Discontinuties occur at the ends of the integra-<br>tion intervals, but the kinetics are unaffected. For example, when T&lt;12, the value of<br>12*INT(T/12) is 0. The values of FLAG1 and FLAG2 are initially 0 and FLAG is 0.<br>As T approaches the end point T=12, the values of FLAG1 and FLAG2 both become<br>1 and FLAG is 0. At the end point when T=12, the value of 12*INT(T/12) is 12 and<br>both FLAG1 and FLAG2 are 0. The discontinuity in mt1 and mt2 does not affect<br>the FLAG variable because FLAG1 and FLAG2 are both 0 or both 1 in the neighbor-<br>hood of the discontinuity, and the kinetics are continuous.<br>
In these examples, EHC is driven by the dose events. The EHC changes can also driven<br>by the clock. Suppose every 12 hours, a new EHC cycle begins. (The value 12 is chosen<br>so that the two versions will give the same predictions.) E.g., instead in mtimess.ctl,<br>instead of<br>
MTIME(1) = MTIME(1)+II<br>
compute<br>
MTIME(1) = MTIME(1)+12<br>
In hillss.ctl, instead of<br>
mt1=inter*INT(T/inter)+theta(8)<br>
compute<br>
mt1=12*INT(T/12)+theta(8)<br>
There is no difference in the results.<br>
REFERENCES: Guide VI, section III.F.9<br>REFERENCES: Guide VI, section V.F<br>REFERENCES: Guide IV, section V.C.5<br>
EX-61<br>
<hr>
<A name=716></a>EXAMPLES EXAMPLES<br>
Help Guide<br>
EXAMPLES USING MTIME TO MODEL PERIODIC DISCONTINUITIES IN $DES<br>
Some systems deﬁned with differential equations can be discontinuous with respect to<br>time. Discontinuities are typically introduced in the system by suddenly changing the<br>value of one or more model variables at speciﬁc points of time. Such changes can be<br>periodic due to e.g. a circadian rhythm. It is important to deﬁne discontinuous variables in<br>$PK using model event time (MTIME) variables rather than updating them in $DES<br>using IF-ELSE-ENDIF tests of T or using the discontinuous INT function. In fact, when<br>integrating from time ta to time tb, routines such as DVERK (ADVAN6) may go<br>slightly beyond time tb (i.e., it may happen that $DES is called at T&gt;tb). The values of<br>DADT should be continuous. If any element of DADT changes at T=b, this should hap-<br>pen at the next integration interval, integrating from time b to time c.<br>
Tw o examples are provided for the implementation of periodic discontinuities using<br>MTIME variables. The ﬁrst (step_circexa.ctl) shows how to model the daily reset of a<br>step function and illustrates how NONMEM update the MTIME and closely related<br>MNOW variables at and in between event records. The second (idr_circexa.ctl) applies<br>this step function in an indirect response model that describes a truncated sinusoidal<br>baseline reponse. It also shows how values of T that range from 0 to inﬁnity can be<br>transformed into repeated values of 0-24h. All ﬁles may be found in the examples direc-<br>tory. These examples were suggested by Sebastien Bihorel, Luann Phillips and Jill<br>Fiedler-Kelly.<br>
The data set used in both examples is circadian.csv. This data set has 4 subjects with<br>sparse data (one observation every 24 hours from time 0 to time 168) and 4 subjects with<br>ﬁnely-spaced data (every 0.5 hours from time 0 to time 48). It is with the second group<br>of subjects that scatters of the step function, variable T24, and indirect response vs. time<br>can best be seen.<br>There are no dose event records (i.e. AMT=0 for all records) because the step function<br>and indirect response are generated endogenously. If this model is incorporated in a<br>larger model, dose records can be used for other compartments.<br>
step_circexa.ctl<br>
This example illustrates how to turn on a step function, FLAG, at a certain time of<br>the day, SHIFT, turn it off after a certain duration, DUR, and repeat this every 24<br>hours.<br>
ˆ<br>
1 -|<br>
--------- --------- ---------<br>
|<br>
|<br>
 <br>
|<br>
|<br>
|<br>
|<br>
|<br>
|<br>
|<br>
 <br>
|<br>
|<br>
|<br>
|<br>
|<br>
0 -|--- -------- -------- -------- FLAG<br>
|<br>
---------------------------------------------------&gt; TIME<br>
|<br>
|<br>
 <br>
|<br>
 <br>
|<br>
SHIFT-24 0<br>
24 48<br>
&lt;- SHIFT -&gt;&lt;- DUR -&gt;<br>
The MTIME(1) and MTIME(2) variables respectively deﬁne the times at which<br>FLAG is set to 1 and 0, such as MTIME(2)-MTIME(1)=DUR. After MTIME(2)<br>is reached, both variables are incremented by 24, and the FLAG update process<br>perpetuates itself ev ery 24 hours. Compartment 1 is a dummy compartment<br>
EX-62<br>
<hr>
<A name=717></a>Help Guide<br>
EXAMPLES EXAMPLES<br>
intended to monitor the pro- per update of the FLAG variable: the amount A1 starts<br>at 0 and is incremented by DUR every day.<br>
Because the FLAG variable is not necessarily updated at the time of event records,<br>both $TABLE and WRITE statements within the ab- breviated code are used in<br>step_circexa.ctl to report the values of the variables of interest. WRITE statements<br>are used because lines in a table ﬁle are produced only for event records, but not<br>for nonevent times such as Model times (MTIMES) at which the variables com-<br>puted in $PK are of special interest here.<br>
Besides MTIME(1) and MTIME(2), the following variables are of interest in<br>step_circexa.ctl:<br>* MPAST(1) and MPAST(2): variables automatically updated based on MTIME(1)<br>and MTIME(2), and used to set FLAG in $DES. MPAST(i)=0 until the call to PK<br>subsequent to the one for which MNOW=i. At that call and until MTIME(i) is rede-<br>ﬁned, MPAST(i)=1.<br>* INTMTIME (&quot;interval MTIME&quot;) is the value of MTIME(1) for the entire inte-<br>gration interval during which FLAG=1, ie from MTIME(1) up to and including the<br>endpoint at MTIME(2). It is not speciﬁcally used in step_circexa.ctl, but will be in<br>the next example. INTMTIME is computed and displayed here so that it can be dis-<br>cussed with the other variables.<br>* TSTATE is a reserved variable giving the time at which the current state vector<br>(compartment amounts) was computed. It gives the time to which the system was<br>most recently advanced.<br>
The FLAG variable can be computed in either $PK or $DES, but the latter is pre-<br>ferred.<br>
Background details:<br>
Suppose that the values of TIME on the event records are t1 t2 t3 etc. and that PK is<br>called with every event record and NONEVENT (ADDITIONAL AND LAGGED)<br>DOSE TIMES AND AT MODEL TIMES.<br>
Suppose there are k MTIME variables with values<br>t1 &lt;= MTIME(1) &lt;= MTIME(2) &lt;= ... &lt;= MTIME(k) &lt;= t2<br>
The interval [t1,t2] is integrated by smaller intervals<br>[t1, MTIME(1)], [MTIME(1), MTIME(2)] ... [MTIME(k), t2].<br>
Calls to DES during any integration interval [ta, tb] will have ta &lt;= T, but it may<br>happen that T &gt; tb. For calls to PK and ERROR, the sequence of calls for the record<br>with TIME=t2 is:<br>* for each i from 1 to k: call PK with the record at MTIME(i)<br>(MNOW=i, TSTATE=MTIME(i-1)) (if i=1, TSTATE=t1)<br>* call PK with the record at t2<br>(MNOW=0; TSTATE=MTIME(k))<br>* call ERROR with the record at t2<br>(MNOW is set to 9 to identify the WRITE in $ERROR; TSTATE=t2)<br>
The same calls to PK occur even if MTIME(k) happens to corres- pond to t2. In<br>such a case, the call with MNOW=k precedes the call with MNOW=0, and the<br>values in the table ﬁle are from the second call.<br>
The lines of the ﬁle step_circexa.txt that corresponding to the second event record<br>(TIME=24) for ID 1 (set with SHIFT=0.9088 and DUR=20.8385), are:<br>
EX-63<br>
<hr>
<A name=718></a>EXAMPLES EXAMPLES<br>
Help Guide<br>
MNOW TIME MT1<br>
MT2 MP1 MP2 TSTATE INTMTIME<br>
(1) 1.0000 24.0000 0.9088 21.7473 0.0000 0.0000<br>
0.0000 0.9088<br>
(2) 2.0000 24.0000 24.9088 45.7473 1.0000 0.0000<br>
0.9088 0.9088<br>
(3) 0.0000 24.0000 24.9088 45.7473 0.0000 0.0000 21.7473 24.9088<br>
(4) 9.0000 24.0000 24.9088 45.7473 0.0000 0.0000 24.0000 24.9088<br>
where MTi and MPi stand for MTIME(i) and MPAST(i).<br>
At line 1, FLAG=0. This corresponds to the advance from time 0 to MTIME(1): no<br>update of MTIME variables is performed.<br>At line 2, FLAG=1. This corresponds to the<br>
advance from MTIME(1) to<br>
MTIME(2), at which point the MTIME(1) and MTIME(2) variables are updated,<br>but INTMTIME retains its value.<br>At line 3, FLAG=0. This corresponds to the advance from MTIME(2) to time 24,<br>i.e. the call to PK with MNOW=0, in which INMTIME is updated to the new value<br>of MTIME(1) deﬁned at the previous call to PK.<br>At line 4, FLAG=0. This corresponds to the call to ERROR.<br>
The corresponding line of the table ﬁle step_circexa_debug.tab is:<br>
TIME MT1 MT2 STS<br>
INTMTIME<br>
24.0000 24.9088 45.7473 21.7473 24.9088<br>
Note that TSTATE values are:<br>0 (time of 1st. event record)<br>0.9088 after advance to MTIME(1)=0.9088<br>21.7473 after advance to MTIME(2)=21.7473<br>24.0000 after advance to t2=24.<br>
There will be as many lines with MNOW=0.0 in step_circexa.txt, as there are lines<br>in step_circexa_debug.tab. These lines will be consistent except for the values of<br>MNOW.<br>
INMTIME retains the value of MTIME(1)=0.9088 that pertains to the entire integra-<br>tion interval, up to and including the end point at MTIME(2).<br>
It is set in $PK<br>
before the MTIME values are changed when MNOW=2. The values in the table are<br>those set in $PK when MNOW=0 (the ﬁnal call to PK with this data record) by<br>which time INTMTIME and the MTIME(i) have their new values for the next set of<br>advances.<br>
In this particular example, with simulated etas, it sometimes happens that<br>MTIME(1)&lt;t1. From a biological point of view, the step function (and the<br>response) likely started well before the data collection. The beginning of the data<br>collection may occur with FLAG=1 (in the next example, this is during the oscilla-<br>tion of the response) or with FLAG=0 (during the ﬂat part of the response).<br>When MTIME(1) &lt; t1, MTIME(1) is ignored during the set of calls to PK<br>described above.<br>
idr_circexa.ctl<br>
This example extends the concepts introduced in step_circexa.ctl and illustrates how<br>to apply the daily reset of the step function to model a process whose baseline is<br>characterized by a sinusoid function during part of the day and a ﬂat line for the<br>rest of the day. It also show how to create a 24h clock time variable T24 in $DES by<br>transforming the T variable ranging from 0 to inﬁnity into repeating intervals of con-<br>tinuous time between 0 and 24.<br>
ˆ<br>
Rmin+Amp -|<br>
--- --- ---<br>
EX-64<br>
<hr>
<A name=719></a>Help Guide<br>
EXAMPLES EXAMPLES<br>
|<br>
|<br>
|<br>
 <br>
|<br>
|<br>
 <br>
|<br>
|<br>
|<br>
|<br>
 <br>
|<br>
|<br>
|<br>
 <br>
|<br>
|<br>
| |   |<br>
|<br>
|<br>
|<br>
|<br>
Rmin -|--<br>
-------- -------- ---- Response R<br>
|<br>
-------------------------------------------------&gt; TIME<br>
|<br>
|<br>
 <br>
|<br>
 <br>
|<br>
SHIFT-24 0<br>
24 48<br>
&lt;- SHIFT -&gt;&lt;- DUR -&gt;<br>
The baseline response depicted above can be described by:<br>
R(t) = | Rmin + Amp*sin(z(t))<br>
for t in [SHIFT+n*24,SHIFT+DUR+n*24] (Eq.1)<br>
| Rmin for any other value of t<br>
where<br>
Rmin is the minimum response<br>
Amp is the amplitude of the sinusoid function of time<br>
z(t) is a circadian<br>
function of time which scales the time<br>
intervals [SHIFT+n*24, SHIFT+DUR+n*24] to [0, PI], that is<br>
an interval of x such that sin(x)&gt;=0:<br>
z(t) = PI * (t-(SHIFT+n*24))/DUR<br>
n<br>
is (-1,0,1,2,...) if (SHIFT+DUR)&gt;24<br>
is ( 0,1,2,...) if (SHIFT+DUR)&lt;=24<br>
The case when SHIFT+DUR&gt;24 is when the ﬂag function is already 1 at time 0, that<br>is it started before the ﬁrst event. Therefore, an offset of 24 is needed.<br>
z(t) is the function that drives the circadian rhythm of R and is implemented using<br>the INTMTIME variable described in the previous example and that represents<br>SHIFT+n*24. MTIME(1) and MTIME(2) are deﬁned as in step_circexa.ctl to peri-<br>odically update INTMTIME and the FLAG variable used later in the $DES block.<br>
The baseline function, R(t), can be ﬁtted using Eq.1 in absence of drug effect.<br>However, some biological processes which follow such circadian rhythms can be<br>inﬂuenced by drugs (eg, metabolic effects of corticoids). If the effect of the drug is<br>not direct, one can express the biological response and the drug effect in terms of<br>an indirect response model (IDR). Assuming that the drug stimulates the formation<br>of the biological response, one can parameterize the system using the following<br>differential equation:<br>
dR/dt = KIN(t)*(1+S(Cp)) - KOUT*R<br>
(Eq.2)<br>
where<br>
KOUT is the elimination rate of the biological response and<br>
is stationary<br>
KIN(t) is the formation rate of the biological response and is<br>
time-varying dependent on the step function FLAG:<br>FLAG = MPAST(1)-MPAST(2)<br>
S(Cp) is a stimulation function of the drug concentration.<br>
In absence of drug, there is no stimulation (i.e., S(Cp) = 0) and the baseline<br>response R(t) described in Eq.1 can be reparameterized as follows:<br>
dR/dt = KIN(t) - KOUT*R<br>
(Eq.3)<br>
EX-65<br>
<hr>
<A name=720></a>EXAMPLES EXAMPLES<br>
Help Guide<br>
The model is deﬁned such as, when FLAG=0, KIN(t) is constant and equal to<br>KOUT*Rmin, and such as, when FLAG=1, KIN(t) has a sinusoidal shape, increas-<br>ing from its minimum value to its maximum, and decreasing back to its minimum<br>within the duration DUR. One can obtain the explicit expression of KIN(t) within<br>the time when FLAG=1, by determining the ﬁrst derivative of R(t), as deﬁned in<br>the ﬁrst part of Eq.1 and solving for KIN(t) using Eq.3. This expression of KIN(t) is<br>used in $DES.<br>
The $DES block also includes an independent line of code meant to deﬁne a contin-<br>uous 24h clock time. This code is supported by the deﬁnition and circadian reset of<br>the MTIME(3) variable in $PK. More speciﬁcally, this code is dependent on INTM-<br>TIME3, the value of MTIME(3) for the 24-hour intervals.<br>
Note: Original idea for this example stems from Andreas Krause’s post on the<br>NMUsers email list dated from 5/26/2011, subject &quot;Coding INTEGER Function in<br>NONMEM&quot;. The original code was modiﬁed to use model event time variables.<br>
(See <b>mtime</b>).<br>
REFERENCES: None.<br>
EX-66<br>
<hr>
<A name=721></a>Help Guide<br>
EXAMPLES EXOGENOUS<br>
EXOGENOUS SUPPLEMENTATION EXAMPLE<br>
DISCUSSION:<br>
In this example, an oral &quot;drug&quot; is given exogenously, and it also exists as an endogenous<br>substance. There is an unknown dosing history prior to the observation period (i.e., prior<br>to time zero). This example illustrates how three sources of drug can be modeled: pre-<br>existing endogenous drug, pre-existing drug from an unknown prior dosing history, and<br>drug from known doses. Any combination of the three could be modeled without the oth-<br>ers.<br>
The rate of endogenous drug production is assumed to be constant, with no feedback con-<br>trol of production. Thus endogenous drug is at steady-state, and, with linear kinetics, its<br>effect is simply to add a constant increment to exogenous drug in the sampled compart-<br>ment (the increment is modeled as theta(7)).<br>
For the drug with unknown dosing history, it is assumed that the subject is at steady state<br>with respect to this drug. This part of total drug is modeled by a steady state infusion<br>dose into the depot compartment, ending at time 0, and having an unknown rate. The<br>result of the SS dose is to introduce drug into all compartments of the system (not just the<br>central compartment) because it is distributed throughout the system and is subject to<br>elimination from the system. The unknown rate is modeled as theta(5). NONMEM will<br>adjust theta(5) to best ﬁt not only the &quot;baseline&quot; observation at time 0, but also the later<br>observations.<br>
Note that if samples are not taken sufﬁciently long after the time of the last dose ( &gt; 4<br>half-lives), then theta(7) and theta(5) may not be separately identiﬁable. Note that the<br>value of theta(7) may be determined by the residual concentration after all exogenous<br>drug has disappeared.<br>
A combined additive and ccv error model is used. Theta(8) is the ratio of the C.V. of the<br>proportional component to the standard deviation of the additive component.<br>
Any ADVAN/TRANS combination could be used. Population data could also be mod-<br>eled in this manner, with eta variables in the $PK block.<br>
$PROBLEM Example of pre-existing drug.<br>
$INPUT ID TIME DV AMT SS II RATE<br>
$DATA DATA1<br>
$SUBROUTINES ADVAN4 TRANS5<br>
$PK<br>
AOB=THETA(1)<br>
ALPHA=THETA(2)<br>
BETA=THETA(3)<br>
KA=THETA(4)<br>
R1=THETA(5)<br>
S2=THETA(6)<br>
$ERROR<br>
FP=THETA(7)+F ; adds endogenous component<br>
W=(1+THETA(8)*THETA(8)*FP*FP)**.5<br>
Y=FP+W*ERR(1)<br>
EX-67<br>
<hr>
<A name=722></a>EXOGENOUS EXAMPLES<br>
Help Guide<br>
Note that, if there are other doses into the depot compartment with modeled rates, it is<br>necessary to assign a value to R1 conditionally. E.g.,<br>
IF (TIME.EQ.0) THEN<br>
R1=THETA(5) ; rate for SS infusion record at time 0<br>
ELSE<br>
R1=....; rate of other kind of dose<br>
ENDIF<br>
Note also that the combined additive and ccv error model can also be modeled using two<br>random variables:<br>
Y = F*(1+ERR(1)) + ERR(2)<br>
A fragment of the data follows. Record 1 speciﬁes the SS infusion for the pre-existing<br>drug, which ends at time 0. Record 2 gives the baseline observation. Record 3 speciﬁes<br>an oral bolus dose. Record 4 gives an observation.<br>
1<br>
0<br>
.<br>
0<br>
1<br>
0<br>
-1<br>
1<br>
0<br>
62.2 .<br>
.<br>
.<br>
.<br>
1<br>
0.01 .<br>
95 . . .<br>
1<br>
0.50 235.93<br>
.<br>
.<br>
.<br>
.<br>
REFERENCES: Guide V, section 8<br>REFERENCES: Guide VI, section III.F.5<br>
EX-68<br>
<hr>
<A name=723></a>Help Guide<br>
EXAMPLES EXPECTATION<br>
EXPECTATION EXAMPLE<br>
These are examples of the use of the Marginal (MRG_) data item. Example 1<br>
Suppose that the probability that a particular subject experiences a pain relief score of 2 is<br>computed. Suppose also one wants to compute the (posterior population) expectation of<br>the probability with each of 4 different bolus doses, not all of which are among those<br>used to obtain observations. A fragment of the control ﬁle follows.<br>
$INPUT ID DOSE MDV MRG_ ...<br>
$PRED<br>
....<br>
Y = likelihood of observation given ETA<br>
$EST METH=COND LAPLACE LIKELIHOOD<br>
$TABLE DOSE<br>
A fragment of the data follows, with comments following &quot;;&quot;.<br>
#ID DOSE DV MDV MRG_<br>
100 5<br>
2<br>
1<br>
 <br>
1<br>
; PRED item is set to expectation for DOSE=5<br>
100 10<br>
2<br>
1<br>
 <br>
1<br>
; PRED item is set to expectation for DOSE=10<br>
100 20<br>
2<br>
1<br>
 <br>
1<br>
; PRED item is set to expectation for DOSE=20<br>
100 40<br>
2<br>
1<br>
 <br>
1<br>
; PRED item is set to expectation for DOSE=40<br>
1<br>
3<br>
 <br>
1<br>
0<br>
0<br>
1<br>
10<br>
1<br>
0<br>
0<br>
1<br>
25<br>
2<br>
0<br>
0<br>
1<br>
30<br>
2<br>
0<br>
0<br>
2<br>
3<br>
 <br>
1<br>
0<br>
0<br>
2<br>
10<br>
1<br>
0<br>
0<br>
2<br>
25<br>
1<br>
0<br>
0<br>
2<br>
30<br>
1<br>
0<br>
0<br>
3<br>
3<br>
 <br>
1<br>
0<br>
0<br>
3<br>
10<br>
2<br>
0<br>
0<br>
3<br>
25<br>
2<br>
0<br>
0<br>
3<br>
30<br>
3<br>
0<br>
0<br>
... etc ...<br>
Example 2<br>
This example produces a plot of four residuals, formed by the differences between the<br>raw-data-averages and their (posterior population) expectations, versus the doses used to<br>obtain the data.<br>
$INPUT ID DOSE MDV MRG_ RAW_<br>
$PRED<br>
...<br>
IF (ICALL.EQ.5) THEN<br>
Y = expectation of observation given ETA<br>
ELSE<br>
Y = likelihood of observation given ETA<br>
ENDIF<br>
$EST METHOD=COND LAPLACE LIKELIHOOD<br>
EX-69<br>
<hr>
<A name=724></a>EXPECTATION EXAMPLES<br>
Help Guide<br>
$SCAT RES VS DOSE<br>
#ID DOSE DV MDV MRG_ RAW_<br>
100 5<br>
.<br>
1<br>
 <br>
1<br>
1<br>
100 10<br>
.<br>
1<br>
 <br>
1<br>
1<br>
100 20<br>
.<br>
1<br>
 <br>
1<br>
1<br>
100 40<br>
.<br>
1<br>
 <br>
1<br>
1<br>
1<br>
5<br>
 <br>
1<br>
0<br>
0<br>
 <br>
0<br>
1<br>
10<br>
1<br>
0<br>
0<br>
 <br>
0<br>
1<br>
20<br>
2<br>
0<br>
0<br>
 <br>
0<br>
1<br>
40<br>
2<br>
0<br>
0<br>
 <br>
0<br>
... etc ...<br>
Example 3<br>
This example produces a plot of four residuals, formed by the differences between the<br>proportion of subjects in the data set with pain relief score 2 and the (posterior popula-<br>tion) expectation of the probability that a subject experiences a pain score of 2, versus the<br>doses used to obtain the data.<br>
$INPUT ID DOSE MDV MRG_ RAW_<br>
$PRED<br>
...<br>
Y = likelihood of observation given ETA<br>
IF (ICALL.EQ.6) THEN<br>
DVR=DV<br>
DV=0<br>
IF (DVR.EQ.2) DV=1<br>
ENDIF<br>
$EST METHOD=COND LAPLACE LIKELIHOOD<br>
$SCAT RES VS DOSE<br>
#ID DOSE DV MDV MRG_ RAW_<br>
100 5<br>
2<br>
1<br>
 <br>
1<br>
1<br>
100 10<br>
2<br>
1<br>
 <br>
1<br>
1<br>
100 20<br>
2<br>
1<br>
 <br>
1<br>
1<br>
100 40<br>
2<br>
1<br>
 <br>
1<br>
1<br>
1<br>
5<br>
 <br>
1<br>
0<br>
0<br>
 <br>
0<br>
1<br>
10<br>
1<br>
0<br>
0<br>
 <br>
0<br>
1<br>
20<br>
2<br>
0<br>
0<br>
 <br>
0<br>
1<br>
40<br>
2<br>
0<br>
0<br>
 <br>
0<br>
2<br>
5<br>
 <br>
1<br>
0<br>
0<br>
 <br>
0<br>
2<br>
10<br>
1<br>
0<br>
0<br>
 <br>
0<br>
2<br>
20<br>
1<br>
0<br>
0<br>
 <br>
0<br>
2<br>
40<br>
3<br>
0<br>
0<br>
 <br>
0<br>
3<br>
5<br>
 <br>
1<br>
0<br>
0<br>
 <br>
0<br>
3<br>
10<br>
2<br>
0<br>
0<br>
 <br>
0<br>
3<br>
20<br>
2<br>
0<br>
0<br>
 <br>
0<br>
3<br>
40<br>
3<br>
0<br>
0<br>
 <br>
0<br>
... etc ...<br>
(See <b>mrg</b>, <b>expectation block</b>, <b>data average block</b>, <b>raw</b>).<br>
EX-70<br>
<hr>
<A name=725></a>Help Guide<br>
EXAMPLES EXPECTATION<br>
REFERENCES: none.<br>
EX-71<br>
<hr>
<A name=726></a>FINALIZATION EXAMPLES<br>
Help Guide<br>
FINALIZATION EXAMPLE ($PRED AND $INFN)<br>
This example contains abbreviated code which can be inserted in a $PRED or $INFN<br>block. This code outputs ﬁnal parameter estimates, standard errors, minimum value of<br>the objective function, and conditional estimates of etas to various user ﬁles. The return<br>codes from Estimation and Covariance steps (zero for normal termination) are also out-<br>put.<br>
IF (ICALL.EQ.3) THEN<br>
DO WHILE(DATA)<br>
IF (NEWIND.LE.1) WRITE (50,*) ETA<br>
ENDDO<br>
WRITE (51,*) OBJECT<br>
WRITE (52,*) THETA<br>
WRITE (52,*) THETAFR<br>
WRITE (53,*) SETHET<br>
WRITE (53,*) SETHETR<br>
WRITE (54,*) OMEGA(BLOCK)<br>
WRITE (55,*) SEOMEG(BLOCK)<br>
WRITE (56,*) SIGMA(BLOCK)<br>
WRITE (57,*) SESIGM(BLOCK)<br>
WRITE (58,*) IERE,IERC<br>
ENDIF<br>
REFERENCES: Guide VI, section VI.A<br>
EX-72<br>
<hr>
<A name=727></a>Help Guide<br>
EXAMPLES FINEDAT A<br>
FINEDAT A EXAMPLE<br>
This example is new to NONMEM 7. It is an example of the use of the ﬁnedata utility<br>program to ﬁll in missing values of an independent variable (covariate).<br>
Other examples (infn1, infn2) show the use of the INFN routines for interpolation. In<br>data ﬁle THEOPP used for CONTROL5, where only one value of WT is present, the<br>INFN routine is used to ﬁll in missing values of WT. Presumably these examples would<br>be part of a NONMEM run involving Estimation.<br>
In this example, ﬁnedata is used to ﬁll in the missing values of WT and create a new data<br>set, THEOPPfull. This data set can be used in subsequent NONMEM runs for estima-<br>tion.<br>
USAGE:<br>
finedata theofine.ctl<br>
Contents of theoﬁne.ctl are as follows:<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
$DATA THEOPP<br>
$FINEDATA AXIS=TIME FILE=THEOPPfull WT=LIN MISSING=. NEVAL=-1<br>
(See <b>control5</b>).<br>(See <b>infn1 example</b>).<br>(See <b>infn2 example</b>).<br>
REFERENCES: Guide Introduction_7<br>
EX-73<br>
<hr>
<A name=728></a>FOCE PARALLEL EXAMPLES<br>
Help Guide<br>
FOCE PARALLEL EXAMPLE<br>
The example control stream ﬁle foce_parallel.ctl is in the ..\examples directory.<br>
; Used for comparing single versus parallel computing for FOCE method.<br>
;$SIZES LVR=30<br>
;$SIZES LTH=15<br>
;$SIZES LIM1=100<br>
$PROB RUN# Example 1 (from samp5l)<br>
$INPUT C SET ID JID TIME<br>
DV=CONC AMT=DOSE RATE EVID MDV CMT CLX<br>
V1X QX V2X SDIX SDSX<br>
$DATA example1.csv IGNORE=C<br>
$SUBROUTINES ADVAN3 TRANS4<br>
$PK<br>
MU_1=THETA(1)<br>
MU_2=THETA(2)<br>
MU_3=THETA(3)<br>
MU_4=THETA(4)<br>
CL=DEXP(MU_1+ETA(1))<br>
V1=DEXP(MU_2+ETA(2))<br>
Q=DEXP(MU_3+ETA(3))<br>
V2=DEXP(MU_4+ETA(4))<br>
S1=V1<br>
$ERROR<br>
Y = F + F*EPS(1)<br>
; Initial values of THETA<br>
$THETA<br>
(0.001, 2.0) ;[LN(CL)]<br>
(0.001, 2.0) ;[LN(V1)]<br>
(0.001, 2.0) ;[LN(Q)]<br>
(0.001, 2.0) ;[LN(V2)]<br>
;INITIAL values of OMEGA<br>
$OMEGA BLOCK(4)<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.01 ;[F]<br>
0.15 ;[P]<br>
;Initial value of SIGMA<br>
$SIGMA<br>
(0.6 )<br>
;[P]<br>
EX-74<br>
<hr>
<A name=729></a>Help Guide<br>
EXAMPLES FOCE PARALLEL<br>
;$EST METHOD=CHAIN FILE=foce_parallel.chn ISAMPLE=3 NSAMPLE=0<br>
$EST METHOD=1 INTERACTION NSIG=3 PRINT=1<br>
NOABORT FORMAT=s1PE23.16 MAXEVAL=9999 ; PARAFILE=parallel_file.pnm<br>
$COV MATRIX=S PRINT=E UNCONDITIONAL ; PARAFILE=OFF<br>
REFERENCES: Guide Introduction_7<br>
EX-75<br>
<hr>
<A name=730></a>IGNORE ACCEPT EXAMPLES<br>
Help Guide<br>
IGNORE ACCEPT EXAMPLE<br>
The options IGNORE=(list) and ACCEPT=(list) of the $DAT A record allow for simple<br>selection criteria for records that are to be excluded or included, respectively, in the<br>NONMEM data set. A list has the format:<br>cond,cond,cond,...<br>where each cond is a test of a data item: &quot;label operator value&quot;. The commas are implied<br>.OR. operators. The .AND. and .NOT. operators are not permitted.<br>
Suppose an .AND. is needed. E.g.,<br>
IGNORE=(GEN.EQ.1.AND.AGE.GT.60)<br>
If the expressions are simple, this may be done by negating both sides:<br>
.NOT.IGNORE =.NOT.(GEN.EQ.1.AND.AGE.GT.60)<br>
ACCEPT=.NOT.GEN.EQ.1.OR..NOT.AGE.GT.60<br>
Thus,<br>
ACCEPT=(GEN.NE.1,AGE.LE.60)<br>
But logical operators inside parenthesis are not permitted, so that the following cannot be<br>coded:<br>$DATA ACCEPT=((A==1.OR.A==2).AND.B&lt;100)<br>Even if negated, this is:<br>IGNORE=(.NOT.(A==1.OR.A==2)).OR..NOT.B&lt;100)<br>which is:<br>IGNORE=((A.NE.1.AND.A.NE.2).OR.B&gt;=100)<br>
There is still an .AND. inside parentheses.<br>
There is a workaround that takes advantage of the fact that A takes numeric values and<br>there are no values between 1 and 2.<br>(A.NE.1.AND.A.NE.2)<br>can be implemented with an &quot;or&quot;:<br>(A.LT.1.OR.A.GT.2).<br>
The following are equivalent:<br>IGNORE=(B.GE.100) IGNORE=(A.LT.1) IGNORE=(A.GT.2)<br>
IGNORE=(B.GE.100,A.LT.1,A.GT.2)<br>
This workaround cannot handle continuous values of A or more complicated conditions.<br>
With NONMEM through 7.3, two separate NONMEM problems can be used, in two sep-<br>arate runs, for a complicated condition. In the ﬁrst problem, abbreviated code is used to<br>append a new variable to the data with a value indicating ignore/accept; in the second run<br>the variable is used in the $DAT A statement to choose from the data set.<br>
Suppose ACC is the variable that is to have values 0/1 for ignore/accept. The desired<br>code is:<br>
ACC=0<br>
IF ((A == 1.OR.A == 2).AND.B&lt;100) ACC=1<br>
The above can be coded using the FORTRAN language. But NM-TRAN abbreviated<br>code is a subset of FORTRAN. Logical operators .NOT., .AND., .OR. may not be used<br>within parentheses. There are two workarounds.<br>
One is to clear the parentheses:<br>
IF (A==1.AND.B&lt;100.OR.A==2.AND.B&lt;100) ACC=1<br>(this is always possible, no matter how complicted the conditional expression).<br>
EX-76<br>
<hr>
<A name=731></a>Help Guide<br>
EXAMPLES IGNORE ACCEPT<br>
The second is to use several statements. There are may ways to do this. In the following,<br>the .AND. of multiple conditions is false if any of the conditions is false.<br>ACC=1<br>
IF (A.NE.1.AND.A.NE.2) ACC=0<br>
IF (B.GE.100) ACC=0<br>
In prob1.ctl, the ﬁrst problem appends ACC to the (new) data set. In prob2.ctl, the<br>$DAT A record uses ACC to select records.<br>
All required data items for NONMEM (and PREDPP, if used) must be present in the orig-<br>inal data ﬁle testab.dat. The control stream for the ﬁrst run:<br>
$PROB test of accept Run #1<br>
; Example of implementation of<br>
; $DATA ACCEPT=((A == 1.OR.A == 2).AND.B&lt;100)<br>
$INPUT NO A B ID DV MDV<br>
$DATA testab.dat IGNORE C<br>
$PRED<br>
; Implements:<br>
; ACC=1 IF ((A == 1.OR.A == 2).AND.B &lt; 100)<br>
ACC=1<br>
IF (A.NE.1.AND.A.NE.2) ACC=0<br>
IF (B.GE.100) ACC=0<br>
; The model for this run is unimportant. Keep it simple.<br>
Y=THETA(1)+ETA(1)+EPS(1)<br>
$THETA 1<br>
$OMEGA 1<br>
$SIGMA .4<br>
$TABLE NO A B ID DV MDV ACC<br>
NOPRINT NOAPPEND NOHEADER FILE=run1.tab<br>
The control stream for the second run:<br>
$PROB test of accept Run #2<br>
$INPUT NO A B ID DV MDV ACC<br>
; Must do a numeric test for ACC==1, because it appears in<br>
; table file run1.tab as 1.0000E+00<br>
$DATA run1.tab ACCEPT=(ACC.EQN.1)<br>
$PRED<br>
; the model in this problem is the model<br>
; used for simulation, analysis, etc.<br>
Y=THETA(1)+ETA(1)+EPS(1)<br>
$THETA 1<br>
$OMEGA 1<br>
$SIGMA .4<br>
$TABLE NO A B ID DV MDV<br>
NOPRINT NOAPPEND NOHEADER FILE=run2.tab<br>
With NONMEM 7.4, it is possible to combine both problems into one NONMEM run<br>using the $TABLE record option &quot;EXCLUDE_BY list&quot;. If any variable in list is non-0,<br>the record is excluded from the table ﬁle probe.tab. The $DAT A ACCEPT/IGNORE<br>option is not needed. Because probe.tab does not exist when NM-TRAN processes the<br>second problem in the control stream, $DAT A .. NOOPEN is needed and a format speciﬁ-<br>cation is needed.<br>
EX-77<br>
<hr>
<A name=732></a>IGNORE ACCEPT EXAMPLES<br>
Help Guide<br>
$PROB test of NONMEM 7.4 exclude_by feature<br>
$INPUT NO A B ID DV MDV<br>
$DATA testab.dat IGNORE C<br>
$PRED<br>
; sets ACC=0 if (a==1.or.a==2).and.b&lt;100)<br>
; uses the clear the parenthesis approach.<br>
ACC=1<br>
IF (A==1.AND.B&lt;100.OR.A==2.AND.B&lt;100) ACC=0<br>
; The following is the model for both problems.<br>
; It may be more complicated than this.<br>
Y=THETA(1)+ETA(1)+EPS(1)<br>
$THETA 1<br>
$OMEGA 1<br>
$SIGMA .4<br>
; probe.tab has only those records that have ACC=0.<br>
$TABLE NO A B ID<br>
DV MDV EXCLUDE_BY ACC<br>
NOPRINT NOAPPEND NOHEADER FILE=probe.tab<br>
$PROB test of exclude_by #2<br>
$INPUT NO A B ID DV MDV<br>
$DATA probe.tab (10F12.0) NOOPEN<br>
$THETA 1<br>
$OMEGA 1<br>
$SIGMA .4<br>
; This problem should have $ESTIMATION and other tasks<br>
$TABLE NO A B ID DV NOAPPEND NOHEADER NOPRINT FILE=probe2.tab<br>
Here is a fragment of the data testab.dat<br>
C NO A B   ID DV MDV<br>
1 1 100 1<br>
0<br>
0<br>
2 2 100 1<br>
0<br>
0<br>
3 3 100 1<br>
0<br>
0<br>
4 1 101 1<br>
0<br>
0<br>
5 2 101 1<br>
0<br>
0<br>
6 3 101 1<br>
0<br>
0<br>
7 1   99<br>
1<br>
0<br>
0<br>
8 2   99<br>
1<br>
0<br>
0<br>
9 3   99<br>
1<br>
0<br>
0<br>
(See <b>$data, $table</b>).<br>
REFERENCES: none.<br>
EX-78<br>
<hr>
<A name=733></a>Help Guide<br>
EXAMPLES INFN INTERPOLATION<br>
INFN INTERPOLATION EXAMPLE 1<br>
This example is adapted from Guide VI (PREDPP), Figure 37.<br>It was revised for NONMEM 7.3. Earlier versions were untested and did not work cor-<br>rectly. This version allows both single-subject and population data. It requires a &quot;miss-<br>ing independent variable&quot; data item.<br>
In this example, the INFN subroutine is used to ﬁll in (interpolate) missing values of WT<br>in the THEOPPMV data set. THEOPPMV is a version of the data set THEOPP used in<br>CONTROL5,<br>(See <b>control5</b>).<br>
If WT is recorded on every record, then the $PK block can be simpler. The $PK block<br>can be called with every record (no need for CALLFL=1) and no special code is needed<br>to save the value of WT for subsequent records.<br>
Example infn2 shows how the INFN routine may be implemented in abbreviated code.<br>Example ﬁne1 shows how the ﬁnedata utility program can be used to ﬁll in the values<br>without the use of the INFN routine.<br>
USAGE:<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE=AMT TIME CP=DV WT MISS<br>
$DATA THEOPPMV<br>
$SUBROUTINES ADVAN2 INFN=infnsub<br>
The ﬁle infnsub contains the following:<br>
! THIS EXAMPLE IS ADAPTED FROM GUIDE VI (PREDPP), FIGURE 37.<br>
! FOR HELP FILE infn1.exa<br>
! MODIFIED BY AJB 9/2012<br>
! INFN ROUTINE FOR COMPUTING LINEARLY INTERPOLATED VALUES<br>
! OF AN INDEPENDENT VARIABLE V.<br>
ILLUSTRATES USE OF ROUTINE PASS.<br>
! USE FOR SINGLE-SUBJECT OR POPULATION DATA<br>
! WORKS WITH 1 OR MORE NON-MISSING VALUES.<br>
! A SINGLE SUCH VALUE MAY BE ANYWHERE IN DATA SET.<br>
! DATREC(UI)=TIME DATA ITEM<br>
! DATREC(VI)=INDEPENDENT VARIABLE DATA ITEM<br>
! DATREC(MI)=MISSING INDEPENDENT VARIABLE DATA ITEM<br>
!<br>
=0 INDEP VAR NOT MISSING<br>
!<br>
&gt;0 IF THIS DATA RECORD HAS MISSING INDEP VAR AND:<br>
!<br>
=1<br>
THIS DATA RECORD PRECEDES FIRST NON-MISSING VALUE<br>
!<br>
=3<br>
THIS DATA RECORD FOLLOWS LAST NON-MISSING VALUE<br>
!<br>
=2<br>
THIS DATA RECORD IS BETWEEN NON-MISSING VALUES<br>
!<br>
SUBROUTINE INFN (ICALL,THETA,DATREC,INDXS,NEWIN)<br>
USE SIZES, ONLY: ISIZE,DPSIZE,NO,MAXIDS<br>
! NOTE THAT NEWIND IS NOT OBTAINED FROM THE SUBROUTINE ARGUMENT<br>
USE NMPRD_INT, ONLY: NEWIND=&gt;NWIND<br>
INTEGER(KIND=ISIZE), INTENT(IN) :: ICALL,INDXS(*),NEWIN<br>
REAL(KIND=DPSIZE), INTENT(IN) :: THETA(*)<br>
REAL(KIND=DPSIZE), INTENT(IN OUT) :: DATREC(*)<br>
REAL(KIND=DPSIZE) :: U,V<br>
EX-79<br>
<hr>
<A name=734></a>INFN INTERPOLATION EXAMPLES<br>
Help Guide<br>
DIMENSION U(NO,MAXIDS),V(NO,MAXIDS),DEPVAR(MAXIDS),LASTI(MAXIDS)<br>
INTEGER UI,VI,MI,IS,LASTI<br>
! IMPORTANT: CHANGE UI, VI, MI ACCORDING TO LAYOUT OF DATA SET<br>
UI=3<br>
VI=5<br>
MI=6<br>
!<br>
IF (ICALL.NE.1) RETURN<br>
I=0<br>
IS=0<br>
! INITIALIZE PASS<br>
MODE=0<br>
CALL PASS (MODE)<br>
MODE=2<br>
! PASS THROUGH DATA<br>
5 CALL PASS (MODE)<br>
IF (MODE.EQ.0) GO TO 10<br>
IF (NEWIND&lt;2) THEN<br>
I=0<br>
IS=IS+1<br>
ENDIF<br>
! IF INDEP VAR IS PRESENT, STORE TIME AND VALUE<br>
IF (DATREC(MI).EQ.0.) THEN<br>
I=I+1<br>
U(IS,I)=DATREC(UI)<br>
V(IS,I)=DATREC(VI)<br>
LASTI(IS)=I<br>
ENDIF<br>
IF (I == 1) THEN<br>
! SAVE VALUE IN CASE ONLY RECORDED ONCE<br>
DEPVAR(IS)=V(IS,1)<br>
ENDIF<br>
GO TO 5<br>
! INITIALIZE PASS A SECOND TIME<br>
10 I=0<br>
IS=0<br>
MODE=0<br>
CALL PASS (MODE)<br>
MODE=2<br>
! PASS THROUGH DATA A SECOND TIME<br>
15 CALL PASS (MODE)<br>
IF (MODE.EQ.0) RETURN<br>
IF (NEWIND&lt;2) THEN<br>
I=0<br>
IS=IS+1<br>
ENDIF<br>
! IF INDEP VAR IS MISSING AND ONLY RECORDED ONCE, COPY IT<br>
IF (DATREC(MI).NE.0. .AND. LASTI(IS) == 1 ) THEN<br>
DATREC(VI)=DEPVAR(IS)<br>
GO TO 15<br>
ENDIF<br>
EX-80<br>
<hr>
<A name=735></a>Help Guide<br>
EXAMPLES INFN INTERPOLATION<br>
! IF INDEP VAR IS MISSING, STORE INTERPOLATED VALUE<br>
IF (DATREC(MI).EQ.0.) THEN<br>
I=I+1<br>
ELSE<br>
IF (DATREC(MI).EQ.1.) THEN<br>
! EXTRAPOL. FROM FIRST 2 VALUES<br>
K=1<br>
L=2<br>
ELSEIF (DATREC(MI).EQ.2.) THEN<br>
! INTERPOL. FROM BEFORE AND AFTER<br>
K=I<br>
L=I+1<br>
ELSEIF (DATREC(MI).EQ.3.) THEN<br>
! EXTRAPOL. FROM LAST 2 VALUES<br>
K=I-1<br>
L=I<br>
ENDIF<br>
B=(V(IS,K)-V(IS,L))/(U(IS,K)-U(IS,L))<br>
DATREC(VI)=V(IS,K)+B*(DATREC(UI)-U(IS,K))<br>
ENDIF<br>
GO TO 15<br>
END<br>
Data ﬁle THEOPPMV is identical to THEOPP, but has an extra data item MISS (Missing<br>Dependent Variable). The data for the ﬁrst subject is:<br>
1<br>
4.02 0.<br>
.<br>
79.6 0<br>
1<br>
.<br>
 <br>
0.<br>
.74 .<br>
3<br>
1<br>
.<br>
 <br>
0.25 2.84<br>
.<br>
3<br>
1<br>
.<br>
 <br>
0.57 6.57<br>
.<br>
3<br>
1<br>
.<br>
 <br>
1.12 10.5<br>
.<br>
3<br>
1<br>
.<br>
 <br>
2.02 9.66<br>
.<br>
3<br>
1<br>
.<br>
 <br>
3.82 8.58<br>
.<br>
3<br>
1<br>
.<br>
 <br>
5.1 8.36 .<br>
3<br>
1<br>
.<br>
 <br>
7.03 7.47<br>
.<br>
3<br>
1<br>
.<br>
 <br>
9.05 6.89<br>
.<br>
3<br>
1<br>
.<br>
12.12 5.94<br>
.<br>
3<br>
1<br>
.<br>
24.37 3.28<br>
.<br>
3<br>
(See <b>infn2 example</b>).<br>(See <b>ﬁne1 example</b>).<br>
REFERENCES: Guide VI, section VI.A , Figure 37<br>
EX-81<br>
<hr>
<A name=736></a>INFN INTERPOLATION EXAMPLES<br>
Help Guide<br>
INFN INTERPOLATION EXAMPLE 2<br>
This example is new to NONMEM 7. It is an improved version of infn1.exa. In this<br>example, instead of using a stand-alone INFN subroutine, $INFN abbreviated code is<br>used to ﬁll in missing values of WT in the THEOPP data set.<br>(See <b>control5</b>).<br>
If WT is recorded on every record, then the $PK block can be simpler. The $PK block<br>can be called with every record (no need for CALLFL=1) and no special code is needed<br>to save the value of WT for subsequent records.<br>
No &quot;missing independent variable&quot; data item is needed, so the THEOPP data ﬁle can be<br>used as-is. The $ABBR abbreviated code is located in ﬁle infnabbr for convenient re-use.<br>This is also an example of the $ABBR REPLACE feature, which allows easy replace-<br>ment of character strings in the included code, and is also an example of declared sub-<br>scripted variables.<br>
Example ﬁne1 shows how the ﬁnedata utility program can be used to ﬁll in the values<br>without the use of the INFN routine.<br>
USAGE:<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
$DATA THEOPP<br>
$SUBROUTINES ADVAN2<br>
$ABBR REPLACE INTVBL=WT<br>
$ABBR REPLACE NULLVAL=0.0<br>
INCLUDE ’infnabbr’<br>
The ﬁle infnabbr contains the following:<br>
; INFNABBR: ABBREVIATED CODE FOR HELP infn2.exa<br>
; THIS INFN BLOCK INTERPOLATES AND EXTRAPOLATES VALUES OF A SINGLE<br>
; DATA ITEM CALLED INTVBL.<br>
; BY DEFAULT, THE AXIS VARIABLE IS CALLED TIME.<br>
; THE CHARACTER STRING NULLVAL DENOTES A NULL VALUE.<br>
;<br>
; IF THERE IS ONLY ONE NON-NULL VALUE, THIS VALUE IS COPIED TO<br>
; ALL NULL VALUES. OTHERWISE:<br>
; LINEAR INTERPOLATION IS PERFORMED FOR NULL VALUES THAT<br>
; LIE BETWEEN TWO NON-NULL VALUES.<br>
; LINEAR EXTRAPOLATION IS PERFORMED FOR VALUES BEFORE THE<br>
; FIRST NON-NULL VALUE<br>
; LINEAR EXTRAPOLATION IS PERFORMED FOR VALUES AFTER THE<br>
; LAST NON-NULL VALUE<br>
; INFNABBR CAN BE USED WITH BOTH SINGLE<br>
; SUBJECT AND POPULATION DATA SET.<br>
; WRITTEN BY AJB 9/2012<br>
;<br>
; TYPICAL USAGE:<br>
; $ABBR REPLACE INTVBL=WT<br>
; $ABBR REPLACE NULLVAL=0.0<br>
; $ABBR REPLACE TIME=T<br>
(ONLY IF T IS THE AXIS VARIABLE RATHER THAN TIME)<br>
EX-82<br>
<hr>
<A name=737></a>Help Guide<br>
EXAMPLES INFN INTERPOLATION<br>
;<br>
INCLUDE ’INFNINTERP’<br>
;<br>
;<br>
$ABBR DECLARE U(MAXIDS,NO), V(MAXIDS,NO)<br>
$ABBR DECLARE INTEGER IS<br>
$ABBR DECLARE INTEGER I, INTEGER J, INTEGER L<br>
$ABBR DECLARE IVAL(NO)<br>
$INFN<br>
; $INFN FOR COMPUTING INTERPOLATED VALUES OF AN<br>
; INDEPENDENT VARIABLE NAMED INTVBL<br>
; E.g., INTVBL MIGHT BE WEIGHT<br>
; ASSUME THAT INTVBL = NULLVAL<br>
WHEN MISSING.<br>
; IS=SUBJECT #<br>
; IVAL(IS)= # OF NON-NULL VALUES OF THE INDEP VAR. FOR SUBJECT IS<br>
; VI(IS,I) = ITH. NON-NULL VALUE OF THE INDEPENDENT VARIABLE<br>
; UI(IS,I) = TIME OF THE ITH. NON-NULL VALUE OF THE INDEPENDENT VARIABLE<br>
IS=0<br>
IF (ICALL.EQ.1) THEN<br>
; FIRST PASS.<br>
SAVE VALUES OF TIME &amp; INDEP VAR. WHEN INDEP VAR. IS NON-NULL<br>
DO WHILE (DATA)<br>
IF (NEWIND &lt; 2) THEN<br>
; INITIALIZE NEW INDIVIDUAL<br>
IS=IS+1<br>
IVAL(IS)=0<br>
ENDIF<br>
IF (INTVBL /= NULLVAL) THEN<br>
; SAVE NON-NULL VALUE<br>
IVAL(IS)=IVAL(IS)+1<br>
I=IVAL(IS)<br>
U(IS,I)=TIME<br>
V(IS,I)=INTVBL<br>
ENDIF<br>
ENDDO<br>
; SECOND PASS<br>
IS=0<br>
DO WHILE (DATA)<br>
IF (NEWIND &lt; 2) THEN<br>
; INITIALIZE NEW INDIVIDUAL<br>
IS=IS+1<br>
I=0<br>
ENDIF<br>
; IF INDEP VAR IS MISSING AND WAS ONLY NON-NULL ONCE, COPY IT<br>
IF (INTVBL == NULLVAL .AND. IVAL(IS) == 1) THEN<br>
INTVBL=V(IS,1)<br>
ELSE<br>
IF (INTVBL /= NULLVAL) THEN<br>
; COUNT ANOTHER NON-NULL VALUE<br>
I=I+1<br>
ELSE ; CURRENT RECORD HAS NULL VALUE<br>
IF (I==0) THEN ; EXTRAPOLATE FROM FIRST 2 VALUES<br>
J=1<br>
L=2<br>
ELSEIF (I&gt;0 .AND. I&lt;IVAL(IS)) THEN ; INTERPOL. BEFORE AND AFTER<br>
EX-83<br>
<hr>
<A name=738></a>INFN INTERPOLATION EXAMPLES<br>
Help Guide<br>
J=I<br>
L=I+1<br>
ELSEIF (I==IVAL(IS)) THEN<br>
; EXTRAPOL. FROM LAST 2 VALUES<br>
J=I-1<br>
L=I<br>
ENDIF<br>
SLOPE=(V(IS,J)-V(IS,L))/(U(IS,J)-U(IS,L))<br>
INTVBL=V(IS,J)+SLOPE*(TIME-U(IS,J))<br>
ENDIF<br>
ENDIF<br>
ENDDO<br>
ENDIF<br>
(See <b>control5</b>).<br>(See <b>infn1 example</b>).<br>(See <b>ﬁne1 example</b>).<br>
REFERENCES: Guide VI, section VI.A , Figure 37<br>REFERENCES: Guide Introduction_7<br>
EX-84<br>
<hr>
<A name=739></a>Help Guide<br>
EXAMPLES INITIAL<br>
INITIAL STEADY STATE EXAMPLE<br>
This is an example of the use of the Initial Steady State (I_SS) reserved variable in $PK.<br>It was provided by Nick Holford, Dept Pharmacology &amp; Clinical Pharmacology, Univer-<br>sity of Auckland.<br>
Glucose and insulin are both endogenous substances, whose rates of formation are given<br>by terms RGLU and RINS in the differential equations. In the absence of dose events,<br>both glucose and insulin are assumed to be at steady state levels. Exogenous doses of<br>both glucose and insulin are also present in the ﬁrst subject’s data.<br>
It is possible to intialize the steady state condition with a dose record having AMT=0,<br>RATE=0, SS=1, but this is artiﬁcial. The initial condition that the system is at steady<br>state is a feature of the model, not of the data. In this example, the $PK block contains<br>the statement I_SS=1. This causes the system to be initialized appropriately. The state-<br>ment I_SS=1 could also have been placed among the $MODEL statements. However the<br>initialization is performed, the result is the same: non-zero concentrations GLU and INS<br>are computed at TIME=0.<br>
The SS data item need not be present in the data set for the I_SS computation. It is<br>present in this example in order to demonstrate that SS may also be computed using a<br>dose record (see the third and fourth subjects’ data).<br>
Note that SIGMA and OMEGA are ﬁxed to 0 for purposes of illustration, so that the sim-<br>ulated values are exactly equal to those that arise from the model without the random<br>variability due to ETA and EPS. NONMEM issues warning messages (&quot;INITIAL ESTI-<br>MATE OF WITHIN INDIVIDUAL VARIANCE IS ZER0&quot;). These may be ignored.<br>
This example also illustrates the use of A(n) on the right in the $ERROR block to obtain<br>the compartment amounts that are used for the computation of concentrations GLU and<br>INS.<br>
$PROB nicksiss6.ctl I_SS=1 in $PK ADVAN6<br>
$DATA Nicksiss.dat<br>
$INPUT ID TIME CMT AMT RATE SS DV<br>
$SIM (200070927) ONLYSIM NSUB=1<br>
;Silber HE, Jauslin PM, Frey N, Gieschke R, Simonsson US, Karlsson MO.<br>
;An integrated model for glucose and insulin regulation in healthy<br>
;volunteers and type 2 diabetic patients following intravenous glucose<br>
;provocations. J Clin Pharmacol. 2007 Sep;47(9):1159-71.<br>
$THETA<br>
40 ; POP_RGLU MMOL/H/70KG - glucose input rate<br>
40 ; POP_VGLU L/70KG - volume of distribution for glucose<br>
5 ; POP_CLGLU L/H/70KG - glucose clearance<br>
1 ; POP_EMXGLU - EMAX for effect of glucose on insulin input<br>
10 ; POP_C50GLU MMOL/L - EC50 for effect of glucose on Insulin input<br>
5 ; POP_HILGLU - Hill parameter for effect of glucose on Insulin input<br>
5000 ; POP_RINS PMOL/H/70KG - insulin input rate<br>
5 ; POP_VINS L/70KG - volume of distribution for insulin<br>
70 ; POP_CLINS L/H/70KG - insulin clearance<br>
EX-85<br>
<hr>
<A name=740></a>INITIAL EXAMPLES<br>
Help Guide<br>
2 ; POP_EMXINS - EMAX for effect of insulin on glucose clearance<br>
50 ; POP_C50INS PMOL/L - EC50 for effect of insulin on glucose clearance<br>
2 ; POP_HILINS - Hill parameter for effect of insulin on glucose clearance<br>
$OMEGA<br>
0 FIX ;PPV_RGLU<br>
0 FIX ;PPV_RINS<br>
$SIGMA<br>
0 FIXED ;0.1<br>
;G_EXP_RUV<br>
0 FIXED ;1<br>
;G_ADD_RUV MMOL/L<br>
0 FIXED ;0.1<br>
;I_EXP_RUV<br>
0 FIXED ;1<br>
;I_ADD_RUV PMOL/L<br>
$SUBR ADVAN6 TOL=3<br>
$MODEL<br>
COMP (GLUCOSE)<br>
COMP (INSULIN)<br>
$PK<br>
I_SS=1<br>
; GLUCOSE<br>
RGLU=THETA(1)*EXP(ETA(1))<br>
VGLU=THETA(2)<br>
CLGLU=THETA(3)<br>
EMXGLU=THETA(4)<br>
C50GLU=THETA(5)<br>
HILGLU=THETA(6)<br>
;INSULIN<br>
RINS=THETA(7)*EXP(ETA(2))<br>
VINS=THETA(8)<br>
CLINS=THETA(9)<br>
EMXINS=THETA(10)<br>
C50INS=THETA(11)<br>
HILINS=THETA(12)<br>
S1=VGLU<br>
S2=VINS<br>
$DES<br>
DGLU=A(1)/VGLU<br>
DINS=A(2)/VINS<br>
DGLUH=DGLU**HILGLU<br>
DGEFF=EMXGLU*DGLUH/(C50GLU**HILGLU+DGLUH) ; effect of glucose on insulin<br>
DINSH=DINS**HILINS<br>
DIEFF=EMXINS*DINSH/(C50INS**HILINS+DINSH) ; effect of insulin on glucose<br>
DADT(1)=RGLU - CLGLU*(1+DIEFF)*DGLU<br>
; glucose<br>
EX-86<br>
<hr>
<A name=741></a>Help Guide<br>
EXAMPLES INITIAL<br>
DADT(2)=RINS*(1+DGEFF)- CLINS*DINS<br>
; insulin<br>
$ERROR<br>
GLU=A(1)/VGLU ; glucose concentration<br>
INS=A(2)/VINS ; insulin concentration<br>
IF (CMT.EQ.1)THEN<br>
Y=GLU*(1+ERR(1))+ERR(2)<br>
ENDIF<br>
IF (CMT.EQ.2)THEN<br>
Y=INS*(1+ERR(3))+ERR(4)<br>
ENDIF<br>
$TABLE ID TIME CMT AMT RATE SS GLU INS<br>
ONEHEADER NOPRINT FILE=nicksiss6.tab<br>
The data (Nicksiss.dat) follows.<br>
#ID,TIME,CMT,AMT,RATE,SS,DV<br>
1<br>
0<br>
1<br>
0<br>
 <br>
0<br>
 <br>
0 .<br>
1<br>
0<br>
2<br>
0<br>
 <br>
0<br>
 <br>
0 .<br>
1<br>
.1<br>
1<br>
25<br>
0<br>
 <br>
0 .<br>
1<br>
1.0 2<br>
10 0<br>
0 .<br>
1<br>
3<br>
1<br>
0<br>
 <br>
0<br>
 <br>
0 .<br>
1<br>
3<br>
2<br>
0<br>
 <br>
0<br>
 <br>
0 .<br>
1<br>
100 1 .<br>
.<br>
. .<br>
1<br>
100 2 .<br>
.<br>
. .<br>
2<br>
0<br>
1<br>
0<br>
 <br>
0<br>
 <br>
0 .<br>
2<br>
0<br>
2<br>
0<br>
 <br>
0<br>
 <br>
0 .<br>
2<br>
100 1 .<br>
.<br>
. .<br>
2<br>
100 2 .<br>
.<br>
. .<br>
3<br>
0<br>
1<br>
0<br>
 <br>
0<br>
 <br>
1 .<br>
3<br>
100 1 .<br>
.<br>
. .<br>
3<br>
100 2 .<br>
.<br>
. .<br>
4<br>
0<br>
1<br>
0<br>
 <br>
0<br>
 <br>
1 .<br>
4<br>
100 1 .<br>
.<br>
. .<br>
4<br>
100 2 .<br>
.<br>
. .<br>
(See <b>Initial Steady State</b>,<b>I_SS,ISSMOD</b>)<br>(See <b>i_ss</b>, <b>initial_condition</b>).<br>
REFERENCES: none.<br>
EX-87<br>
<hr>
<A name=742></a>INTEROCCASION VARIABILITY EXAMPLES<br>
Help Guide<br>
INTEROCCASION VARIABILITY EXAMPLE<br>
This example is based on work described in Karlsson and Sheiner, JPB 21(6):735-750<br>(1994). The model accounts for random variability in a subject’s parameters between<br>study occasions.<br>
It illustrates a data ﬁle in which EVID data items are present. In the fragment of data<br>below, EVID has values 1 (dose event), 0 (observation event), and 3 (reset event).<br>
The reset event is present at the start of the subject’s second study occasion. It causes<br>PREDPP to re-initialize the kinetic system as if for a new individual, and permits time to<br>be reset to 0. Note that the subject has the same dosage regimen prior to both study occa-<br>sions (a bolus dose of AMT 1000 every 12 hours leading to steady state). However, it<br>would have been possible to specify a different dosing regimen prior to the second occa-<br>sion.<br>
In the abbreviated code, EXIT statements are used to constrain TVCL and TVV (typical<br>value of clearance and volume) to positive values. Because the models for TVCL and<br>TVV include both thetas and covariates, it is difﬁcult to bound the thetas so as to insure<br>that TVCL and TVV are non-negative for all subjects. The NOABORT option is present<br>on the $ESTIMATION record. Hence NONMEM will perform PRED error recovery,<br>and will avoid values of theta (subsequent to the initial values) that result in non-positive<br>TVCL or TVV for any subject.<br>
Explanation of user data items:<br>
AGE<br>
age<br>
RACE race (1 or 2)<br>HT height<br>HCTZ hydrochlorothiazide (0 or 1)<br>OCC occasion (0 or 1)<br>
;THIS IS A NMTRAN CONTROL STREAM For THE PRAZOSIN PK ANALYSIS<br>
$PROB prazosin data<br>
$INPUT ID AGE RACE HT HCTZ AMT TIME DV EVID SS II OCC<br>
$DATA praz21<br>
$SUBROUTINE ADVAN2 TRANS2<br>
$PK<br>
OCC2=1-OCC<br>
R=0<br>
IF (RACE.EQ.2) R=1<br>
TMP=(HT-160)*THETA(1)<br>
IF (TMP.LE.0.) TMP=0.0<br>
TMP2=(AGE-60)*THETA(2)<br>
IF (AGE.LE.60.) TMP2=0.0<br>
TVCL=THETA(3)+TMP-TMP2<br>
TVCL=TVCL+THETA(4)*R+THETA(5)*HCTZ<br>
IF (TVCL.LE.0.) EXIT 1 100<br>
TVV=THETA(6)+HCTZ*THETA(7)<br>
IF (TVV.LE.0.) EXIT 1 200<br>
TVKA=THETA(8)<br>
CL=TVCL*EXP(ETA(3)*OCC+ETA(5)*OCC2+ETA(1))<br>
EX-88<br>
<hr>
<A name=743></a>Help Guide<br>
EXAMPLES INTEROCCASION VARIABILITY<br>
V =TVV *EXP(ETA(4)*OCC+ETA(6)*OCC2+ETA(2))<br>
KA=TVKA*EXP(ETA(8)*OCC+ETA(9)*OCC2+ETA(7))<br>
S2=V<br>
$THETA (0,0.4) (0.,0.3) 20. 4 -4.<br>
$THETA 80 -25<br>
$THETA (0,1.)<br>
$OMEGA BLOCK(2) 0.2 0.1 0.2<br>
$OMEGA BLOCK(2) 0.2 0.1 0.2<br>
$OMEGA BLOCK(2) SAME<br>
$OMEGA 1.2<br>
$OMEGA BLOCK(1) .5<br>
$OMEGA BLOCK(1) SAME<br>
$ERROR<br>
Y=F*(1+EPS(1))<br>
$SIGMA 0.1<br>
$EST NOABORT SIG=3 MAX=3000 PRINT=10 POSTHOC<br>
$COVARIANCE<br>
$TABLE ID OCC ETA1 ETA3 ETA5 ETA2 ETA4 ETA6 NOPRINT FILE=praz32.tab<br>
Data for one subject follow.<br>
21 57<br>
1<br>
180 1<br>
1000 0<br>
0.62 1 1<br>
12 0<br>
21 57<br>
1<br>
180 1<br>
0.0 1 12.06 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 3<br>
6.81 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 4<br>
4.89 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 5<br>
4.04 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 6<br>
2.82 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 7<br>
2.72 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 8<br>
1.78 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 10<br>
1.07 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 12<br>
0.75 0 0 0 0<br>
21 57<br>
1<br>
180 1<br>
0.0 0<br>
2.83 3 0 0 0<br>
21 57<br>
1<br>
180 1<br>
1000 0<br>
2.83 1 1<br>
12 1<br>
21 57<br>
1<br>
180 1<br>
0.0 1<br>
6.27 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 2 12.72 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 3<br>
9.99 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 4<br>
6.90 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 5<br>
6.59 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 6<br>
4.07 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 7<br>
3.11 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 8<br>
2.79 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 10<br>
1.72 0 0 0 1<br>
21 57<br>
1<br>
180 1<br>
0.0 12<br>
1.17 0 0 0 1<br>
(See <b>$estimation</b>, <b>abbreviated code</b>, <b>evid</b>).<br>
REFERENCES: Guide VI, section V.B , VII.C.2<br>REFERENCES: Guide IV, section III.B.10 , IV.G<br>REFERENCES: Guide V, section 12.4.15<br>
EX-89<br>
<hr>
<A name=744></a>INTERPOLATION EXAMPLES<br>
Help Guide<br>
INTERPOLATION IN $DES<br>
This is an example of code that can be used in $DES to interpolate a covariate such as<br>WT between values that are recorded on the data records. This example is new to NON-<br>MEM 7.4, although the code can be used with previous versions.<br>
If D_WT is used in the model for volume of distribution, then this would allow a time-<br>varying volume of distribution to be integrated.<br>
All the code in $PK to compute OLDTIME and OLDWT and SLOPE, and the code for<br>D_WT in $DES, could be copied to user’s control stream. Additional code (for integrat-<br>ing D_WT in $DES and the geometric solution in $ERROR) is for testing and would not<br>be part of the user’s control stream.<br>
The code cannot be used when any WT values are missing. $PK sees only the previous<br>and current record. If WT is missing from the current record, $PK has no way of know-<br>ing what WT will be on the next record.<br>
The code in NONMEM 7.3 help ﬁle INFN_INTERPOLATION EXAMPLE 2 (infn2.exa)<br>can be used to ﬁll in missing WT values in the event records. The $INFN block makes<br>two passes through the data set. After the ﬁrst pass, it knows what the WT values are on<br>all the event records, so that it can interpolate to ﬁll in a missing WT.<br>
The ﬁnedata utility (ﬁne1.exa) can also be used to ﬁll in the missing values, and per-<br>forms interpolation if necessary.<br>
(See <b>infn2.exa</b>).<br>(See <b>ﬁne1.exa</b>).<br>
Here is the control ﬁle:<br>
$PROB INTERPOLATE WT IN $DES<br>
; this example shows how to interpolate WT in $DES.<br>
; it is assumed that WT is recorded on every data record.<br>
; As a test, the value of D_WT in $DES is integrated to obtain AUC of WT VS. T<br>
; This is also calculated geometrically in $ERROR.<br>
$INPUT ID TIME WT DV<br>
$DATA desinterp.dat<br>
$SUBROUTINES ADVAN6 TOL=5<br>
$MODEL<br>
COMP=(AUC_WT DEFOBS)<br>
$PK<br>
; initialize OLDTIME and OLDWT<br>
IF (NEWIND.LE.1) THEN<br>
OLDTIME=TIME<br>
OLDWT=WT<br>
ENDIF<br>
; calculate the slope for $DES<br>
DELTA_TIME=TIME-OLDTIME<br>
DELTA_WT=WT-OLDWT<br>
EX-90<br>
<hr>
<A name=745></a>Help Guide<br>
EXAMPLES INTERPOLATION<br>
IF (DELTA_TIME&gt;0) THEN<br>
SLOPE=DELTA_WT/DELTA_TIME<br>
ELSE<br>
SLOPE=0.<br>
ENDIF<br>
; save wt and time for next $PK record<br>
OLDTIME=TIME<br>
OLDWT=WT<br>
$DES<br>
D_WT=OLDWT+SLOPE*(T-OLDTIME) ; D_WT is the value of WT at time T<br>
DADT(1)=D_WT ; compute AUC of D_WT as a test<br>
$ERROR<br>
Y=F+ETA(1)+EPS(1)<br>
; Compute geometric solution as a test.<br>
; Does not use compartment amounts.<br>
; Use only the values of WT and TIME on event records.<br>
; Suppose WT vs T looks like this:<br>
;<br>
;<br>
;<br>
WT<br>
;<br>
|<br>
;<br>
|<br>
 <br>
w3<br>
w4<br>
;<br>
|<br>
w2<br>
w5<br>
;<br>
|<br>
w1<br>
;<br>
|<br>
;<br>
--------------------------------&gt; TIME<br>
;<br>
t1<br>
t2<br>
t3<br>
t4<br>
t5<br>
;<br>
; at t2, the contribution to the sum is<br>
;<br>
the rectangle<br>
w1 x (t2-t1)<br>
;<br>
plus the triangular piece<br>
;<br>
(w2-w1)/(t2-t1) / 2<br>
;<br>
;<br>
w2<br>
;<br>
/|<br>
;<br>
/ |<br>
;<br>
/__|<br>
;<br>
w1<br>
|<br>
;<br>
|<br>
|<br>
;<br>
|<br>
|<br>
;<br>
------------<br>
;<br>
t1<br>
t2<br>
IF (NEWIND.LE.1) THEN<br>
PREV_WT=WT ; Initialize WT from previous data record<br>
SUM=0<br>
EX-91<br>
<hr>
<A name=746></a>INTERPOLATION EXAMPLES<br>
Help Guide<br>
ELSE<br>
SUM=SUM+PREV_WT*DELTA_TIME+DELTA_WT*DELTA_TIME/2<br>
ENDIF<br>
PREV_WT=WT ; save WT from previous data record<br>
$OMEGA 1<br>
$SIGMA 1<br>
$TABLE ID TIME WT PRED=AUC_WT SUM FILE=desinterp.tbl NOPRINT NOAPPEND<br>
; The following two values should always be equal:<br>
; PRED (which is the AUC of WT obtained by integrating WT)<br>
; SUM (which is the geometric solution) computed in $ERROR<br>
Here is the data file for the first subject. Note that WT<br>
sometimes is constant and sometimes decreases:<br>
1 0.<br>
10<br>
0<br>
1 1.<br>
20<br>
0<br>
1 2.<br>
35<br>
0<br>
1 2.<br>
35<br>
0<br>
1 4.<br>
45<br>
0<br>
1 5.<br>
40<br>
0<br>
Here is the table ﬁle:<br>
TABLE NO.<br>
1<br>
ID TIME<br>
WT AUC_WT<br>
SUM<br>
1.0000E+00 0.0000E+00 1.0000E+01 0.0000E+00 0.0000E+00<br>
1.0000E+00 1.0000E+00 2.0000E+01 1.5000E+01 1.5000E+01<br>
1.0000E+00 2.0000E+00 3.5000E+01 4.2500E+01 4.2500E+01<br>
1.0000E+00 2.0000E+00 3.5000E+01 4.2500E+01 4.2500E+01<br>
1.0000E+00 4.0000E+00 4.5000E+01 1.2250E+02 1.2250E+02<br>
1.0000E+00 5.0000E+00 4.0000E+01 1.6500E+02 1.6500E+02<br>
REFERENCES:<br>
EX-92<br>
<hr>
<A name=747></a>Help Guide<br>
EXAMPLES LOGISTIC<br>
LOGISTIC REGRESSION EXAMPLE<br>
Here is a typical NM-TRAN control stream for dichotomous response population data.<br>Such data is referred to as &quot;odd-type&quot; data. Note that the eta is a population eta but there<br>are no epsilons.<br>
$PROB DICHOTOMOUS RESPONSE<br>
$DATA data<br>
$INPUT ID DOSE DV<br>
$PRED<br>
LOGIT=THETA(1)+THETA(2)*DOSE**THETA(3)+ETA(1)<br>
A=EXP(LOGIT)<br>
P=A/(1+A)<br>
IF (DV.EQ.1) THEN<br>
Y=P<br>
ELSE<br>
Y=1-P<br>
ENDIF<br>
$THETA .1 (25,100) (1,3,5)<br>
$OMEGA 1<br>
$ESTIMATION MET=COND LAPLACE LIKE MAX=500<br>
$SCAT ETA(1) VS DOSE<br>
Here is a typical NM-TRAN control stream when, one wants to ﬁrst simulate the data.<br>
$PROB DICHOTOMOUS RESPONSE<br>
$DATA data<br>
$INPUT ID DOSE DV<br>
$PRED<br>
LOGIT=THETA(1)+THETA(2)*DOSE**THETA(3)+ETA(1)<br>
A=EXP(LOGIT)<br>
P=A/(1+A)<br>
IF (ICALL.EQ.4) THEN<br>
CALL RANDOM (2,R)<br>
IF (R.LE.P) DV=1<br>
IF (R.GT.P) DV=0<br>
ENDIF<br>
IF (DV.EQ.1) Y=P<br>
IF (DV.EQ.0) Y=1-P<br>
$THETA .1 (25,100) (1,3,5)<br>
$OMEGA 1<br>
$SIMULATION (7755399) (45211 UNIFORM)<br>
$ESTIMATION MET=COND LAPLACE LIKE MAX=500<br>
$SCAT ETA(1) VS DOSE<br>
REFERENCES: None.<br>
EX-93<br>
<hr>
<A name=748></a>MICHAELIS MENTEN<br>
EXAMPLES Help Guide<br>
MICHAELIS MENTEN EXAMPLE<br>
The kinetic system in this example is composed of depot, peripheral, and central com-<br>partments, and includes Michaelis-Menten Elimination from the central compartment.<br>Either ADVAN6 or ADVAN8 could be used.<br>
As with any ADVAN, one or more doses could be input to any of the compartments.<br>Steady state doses are also possible.<br>
$PROBLEM EXAMPLE OF M-M ELIMINATION WITH DEPOT AND PERIPH<br>
$INPUT ID TIME AMT DV<br>
$DATA datafile<br>
$SUBROUTINES ADVAN6 TRANS1 TOL=4<br>
$MODEL COMP=(DEPOT,DEFDOS),COMP=(CENTRAL,DEFOBS) COMP=(PERIPH)<br>
$PK<br>
VM = THETA(1)*EXP(ETA(1))<br>
KM = THETA(2)*EXP(ETA(2))<br>
S2 = THETA(3)*EXP(ETA(3))<br>
K12 = THETA(4)*EXP(ETA(4))<br>
K23 = THETA(5)*EXP(ETA(5))<br>
K32 = THETA(6)*EXP(ETA(6))<br>
$ERROR<br>
Y = F + ERR(1)<br>
$DES<br>
C2 =<br>
A(2)/S2<br>
DADT(1) = -K12*A(1)<br>
DADT(2) =<br>
K12*A(1) -K23*A(2) +K32*A(3) -C2*VM/(KM+C2)<br>
DADT(3) =<br>
K23*A(2) -K32*A(3)<br>
; requires $THETA, $OMEGA, $SIGMA etc.<br>
If the units of KM is amount, rather than concentration, the $DES block need not com-<br>pute C2. The change is as follows:<br>
DADT(2) =<br>
K12*A(1) -K23*A(2) +K32*A(3) -A(2)*VM/(KM+A(2))<br>
(ADVAN10 assumes the units of KM is amount.)<br>
REFERENCES: Guide VI, section VII.C.6 , VII.C.10<br>
EX-94<br>
<hr>
<A name=749></a>Help Guide<br>
EXAMPLES MIXTURE MODEL<br>
MIXTURE MODEL EXAMPLE<br>
In this example of a mixture model, it is assumed that some unknown fraction of the pop-<br>ulation has one set of typical values of CL and Vd, and that the remaining fraction has<br>another set of typical values. Reserved variables of interest:<br>
MIXNUM<br>
NONMEM sets MIXNUM to 1 or 2 according to whether PK is to compute parame-<br>ter values for the 1st or 2nd subpopulations, respectively.<br>
MIXEST<br>
For each individual, NONMEM computes an estimate of the number of the subpop-<br>ulation of which each individual is a member, and stores this estimate in the integer<br>variable MIXEST.<br>
EST<br>
In the $PK block, MIXEST is stored in the PK-deﬁned variable EST, which enables<br>MIXEST to be displayed in tables and scatterplots.<br>
$PROB PHENOBARB POPULATION DATA<br>
MIXTURE MODEL<br>
$DATA DATA2 (6F7.0)<br>
$INPUT ID TIME AMT WT APGR CP=DV<br>
$SUBROUTINES ADVAN1 TRANS2<br>
$PK<br>
CALLFL=1<br>
EST=MIXEST<br>
IF (MIXNUM.EQ.2) THEN<br>
CL=THETA(2)*THETA(1)*EXP(ETA(3))<br>
V=THETA(4)*THETA(3)*EXP(ETA(4))<br>
ELSE<br>
CL=THETA(1)*EXP(ETA(1))<br>
V=THETA(3)*EXP(ETA(2))<br>
ENDIF<br>
S1=V<br>
$ERROR<br>
Y=F*EXP(EPS(1))<br>
$MIX<br>
P(1)=THETA(5)<br>
P(2)=1.-THETA(5)<br>
NSPOP=2<br>
$THETA (0,.0047) (0,1) (0,.99) (0,1) (0,.5,1)<br>
$OMEGA BLOCK(2) .05 .01 .03<br>
$OMEGA BLOCK(2) SAME<br>
$SIGMA .02<br>
$ESTM MAXEVAL=500 PRINT=5<br>
$TABLE ID<br>
EST FIRSTONLY NOAPPEND<br>
(See <b>displayed_values</b>, <b>$mix</b>, <b>mixnum mixest</b>).<br>
REFERENCES: Guide VI, section III.L.2 , Figures 6, 23<br>
EX-95<br>
<hr>
<A name=750></a>MODEL EXAMPLES<br>
Help Guide<br>
MODEL TIME EXAMPLES<br>
These are examples of the use of model times in PREDPP.<br>
Enterohepatic Recycling<br>
This fragment of abbreviated code may be used to model EHC. The transfer of drug<br>from compt. 4 to 1 is controlled by FLAG, which is 1 between the times speciﬁed by<br>MTIME(1) and MTIME(2), and is 0 otherwise.<br>
$PK<br>
MTIME(1)=THETA(8)<br>
MTIME(2)=MTIME(1)+THETA(9)<br>
....<br>
$DES<br>
FLAG=MPAST(1)-MPAST(2)<br>
DADT(1)=-KA*A(1)+K41*A(4)*FLAG<br>
DADT(4)=K1G*A(2)-K41*A(4)*FLAG<br>
....<br>
Flexible Input Rate<br>
This fragment of abbreviated code may be used to model a ﬂexible modeled infusion<br>rate R1.<br>
The rate is 400*EXP(ETA(1)) from time 0 to 1.5<br>The rate is 300*EXP(ETA(2)) from time 1.5 to 2.5<br>The rate is 200*EXP(ETA(3)) from time 2.5 till end of infusion.<br>
In the three assignment statments for R1, exactly one of the right-side expressions is<br>non-zero at each call to PK.<br>
$PK<br>
MTIME(1)=1.5<br>
MTIME(2)=2.5<br>
R1= 400*EXP(ETA(1))*(1-MPAST(1))<br>
R1=R1+300*EXP(ETA(2))*(MPAST(1)-MPAST(2))<br>
R1=R1+200*EXP(ETA(3))*MPAST(2)<br>
Changing a Model Time<br>
This fragment of abbreviated code shows how a model time parameter can be<br>changed. Suppose there are events at times 0 and 10 but one wants to advance in<br>increments of 1 with stops at times 1, 2, 3, .... , 9.<br>
IF (TIME.EQ.0) TEMP=0<br>
TEMP=TEMP+1<br>
MTIME(1)=TEMP<br>
MTDIFF=1<br>
EX-96<br>
<hr>
<A name=751></a>Help Guide<br>
EXAMPLES MODEL<br>
Changing Absorption Rate<br>
This fragment of abbreviated code shows how the Absorption Rate KA can be<br>changed.<br>KA is XKA1 from time 0 to THETA(5).<br>KA is XKA2 after time THETA(5).<br>
$PK<br>
MTIME(1)=THETA(5) ; change point for KA<br>
XKA1=THETA(3)*EXP(ETA(3))<br>
XKA2=THETA(4)*EXP(ETA(4))<br>
KA=XKA1*(1-MPAST(1))+XKA2*(MPAST(1))<br>
(See <b>mtime</b>).<br>
See also &quot;Cirdadian example: Examples Using MTIME to Model Periodic Discontinu-<br>ities in $DES&quot;.<br>
REFERENCES: None.<br>
EX-97<br>
<hr>
<A name=752></a>MOVING EXAMPLES<br>
Help Guide<br>
MOVING AREA UNDER THE CURVE EXAMPLE<br>
The following set of examples was developed in response to a question to the NONMEM<br>Users about modeling a moving value of the area under the curve.<br>
The original question (from Pav el Belo) asked:<br>
&quot;Efﬁcacy is frequently considered a function of AUC. A disadvantage of this model of<br>efﬁcacy is that the effect is irreversable because AUC of concentration can only increase;<br>it cannot decrease. In many cases, a more meaningful model is one where AUC is calcu-<br>lated from time t -a to t (kind of &quot;moving average&quot;), where t is time in the system of dif-<br>ferential equations (variable T in NONMEM).&quot;<br>
DUPLICATE SYSTEM METHOD<br>
Bob Bauer proposed a data set DELAYDAT A and control ﬁle for computing a moving<br>value of AUC. Bob wrote<br>
&quot;In the following simple absorption model example developed by me and Alison Boeck-<br>mann for illustration purposes, compartments 1, 2, and 3 are the &quot;real time&quot; depot, cen-<br>tral, auc, and compartments 4,5,6 are the &quot;delayed time&quot; depot, central, auc. So, the base<br>model (non-time delay) system (compartments 1,2,3) is replicated (compartments 4,5,6)<br>for the time delay portion. In addition, the data set duplicates the dose information of<br>compartment 1 into compartment 4, and setting ALAG4 to a non-zero value in the control<br>stream ﬁle provides a lag time to any doses inputted into compartment 4 (so this would<br>take care of multiple dose problems as well). This allows for assessment and availability<br>of AUC(t) and AUCT(t-time-delay) at any time t.&quot;<br>
DELAYDAT A and aucdelay1.ctl<br>
The data for one individual (DELAYDAT A) and the control ﬁle (aucdelay1.ctl) from the<br>email are provided in the examples directory of NONMEM 7.4 and higher. Note that<br>aucdelay1.ctl and all the examples discussed below may be used with data from more<br>than one individual and different numbers of event records per individual.<br>
In aucdelay1.ctl, the model for time delay is<br>
TDY=THETA(1)*EXP(ETA(1))<br>
and the variable DAUC (&quot;difference in area under the curve&quot;) gives the difference in the<br>area under the curve<br>
DAUC=A(3)-A(6) ; AUC(T)-AUC(T-TDY)<br>
One signiﬁcant modiﬁcation to the control ﬁle aucdelay1.ctl was made. The $ERROR<br>model was changed from Y=F+EPS(1) to<br>
Y=F+DAUC+EPS(1)<br>
This demonstrates that DAUC can modify Y (although the relationship would not usually<br>be this simple).<br>
SINGLE SYSTEM METHOD<br>
In aucdelay1.ctl the value of DAUC is available continuously at every time value T dur-<br>ing the integration, but in fact it is not used in the differential equations themselves.<br>DAUC is used only in the $ERROR block. In this case, an alternate method is possible.<br>Only the &quot;real time&quot; single system of differential equations is integrated, and the needed<br>values of AUC are captured &quot;on the ﬂy&quot; in the $PK block. This should result in faster run<br>times because fewer differential equations need to be numerically integreated.<br>
EX-98<br>
<hr>
<A name=753></a>Help Guide<br>
EXAMPLES MOVING<br>
The model event time variable (MTIME) is used instead of absorption lag (ALAG) and is<br>modelled with the same time delay variable TDY. For each event record, MTIME is used<br>to interrupt the integration at the time of interest TIME-TDY. Variables called SAVEA<br>are used to capture the value of A(3) at model event times for use in the $ERROR block.<br>
The general algorithm is rather complicated, so a simple algorithm will be described ﬁrst.<br>
SINGLE SYSTEM METHOD: SIMPLE MODEL<br>
A simple model is possible when TDY is always smaller than the time between any two<br>ev ent records.<br>
aucdelay1S.ctl<br>
This is identical to aucdelay1.ctl except that THETA(1) has initial estimate .5 and is con-<br>strained to be between 0 and 1, and TDY is constrained to be less than 1, which is the<br>change in time between any two event records.<br>
aucdelay2S.ctl<br>
This implements the simple model. Only the original (single) set of compartments 1-3<br>are deﬁned. aucdelay2S.ctl uses the same data ﬁle DELAYDAT A, but ignores records<br>with CMT=4 (doses into the delayed dose compartment). For each event record, it is nec-<br>essary to have available NEXTT, the TIME of the next event record. This data item is not<br>recorded in DELAYDAT A. Instead, NEXTT is listed in the $INPUT record as an extra<br>data item beyond the data items (columns) listed in the data ﬁle, and its entries and are<br>created (&quot;transgenerated&quot;) during each run by code in the $INFN block. The control<br>stream has the same constraints on THETA(1) and TDY as aucdelay1S.ctl.<br>
Only one model event time variable, MTIME(1) is needed. Model event time MTIME(1)<br>is modelled as NEXTT-TDY and changes with every event record. SAVEA is a variable<br>that saves the value of the AUC compartment A(3) when $PK is evaluated at the model<br>ev ent time. At such times, MTIME(1) is reset for the next record. The important lines of<br>code are relatively simple, and use TSTATE (&quot;State Time&quot;; the time at which the state-<br>vector A was last computed.)<br>
$PK<br>
TDY=THETA(1)*EXP(ETA(1))<br>
MTIME(1)=NEXTT-TDY<br>
IF (TSTATE==TIME-TDY) SAVEA=A(3)<br>
...<br>
$ERROR<br>
DAUC=A(3)-SAVEA<br>
...<br>
The two control ﬁles generate the same predictions.<br>
SINGLE SYSTEM METHOD: GENERAL MODEL<br>
The model is more complicated if TDY may be greater than the time between event<br>records, because each value of compartment A(3) must be saved until needed. For the<br>ith. event record, with TIME(i), the value of SAVEAi at TIME(i)-TDY is needed, and is<br>obtained by using a value of MTIME(i) equal to TIME(i)-TDY.<br>
aucdelay2.ctl and aucdelay3.ctl<br>
The general model is implemented in aucdelay2.ctl and aucdelay3.ctl, These versions<br>integrate a single system of differential equations. File aucdelay3.ctl is a short-hand ver-<br>sion of aucdelay2.ctl. After processing by the nmtemplate and doexpand utilites, it gives<br>a control stream that is essentially identical to aucdelay2.ctl. It may be easier to look at<br>
EX-99<br>
<hr>
<A name=754></a>MOVING EXAMPLES<br>
Help Guide<br>
the more compact code in aucdelay3.ctl.<br>
The maximum number of records in any individual record is set using nmtemplate.<br>DELAYDAT A contains 16 records. Commands to run aucdelay3.ctl are:<br>
nmtemplate aucdelay3.ctl temp1 maxrecs=16<br>
doexpand temp1 temp2<br>
nmfe74 temp2 aucdelay3.res<br>
(The most up-to-date doexpand and nmtemplate utilities are provided in<br>
https://nonmem.iconplc.com/utilities/)<br>
Like aucdelay2S.ctl, aucdelay3.ctl uses DELAYDAT A, and ignores records with CMT=4.<br>An $INFN block is used to save all values of TIME in an array TIMES(i). There is no<br>need for an explicit NEXTT variable because all values of TIME are available in this<br>array. Note that the TIMES array contains all TIME values in the data set, which typi-<br>cally contains more than one subject’s data. In the abbreviated code, reserved variable<br>IRECIDX gives the position in TIMES of the start of the current individual record.<br>(LIREC gives the number of records in the current individual record and is needed if dif-<br>ferent subjects have different numbers of data records so that maxrecs is too large for<br>some subjects.)<br>
At the start of an individual record, a value of MTIME(i) is computed for every data<br>record as TIMES(KREC)-TDY. (KREC uses reserved variable IRECIDX, the ﬁrst record<br>in the data set, and hence in TIMES, for the current individual record.) Some values of<br>MTIME(i) may be &lt;=0; such values are ignored by PREDPP.<br>
When PK is called at a model event time MTIME(i) the value of A(3) is stored as<br>SAVEAi. There may be several calls to PK for a given value of TSTATE and MTIME(i)<br>but SAVEAi must be assigned on only the ﬁrst of these calls because only at this call will<br>A(3) have derivaties with respect to ETA (if MTIME depends on ETA). This is why<br>MTIME(i)=0 is necessary after the value of A(3) (and its ETA derivatives, if any) has<br>been saved.<br>
REMARKS<br>
1. RECURSIVE CODE<br>
Random variables are saved for future use by using with recursive code, such as in<br>aucdelay2.ctl:<br>
IF (NEWIND.LE.1.AND.1&lt;=LIREC) THEN<br>
MTIME(1)=TIMES(KREC)-TDY ; SET NEW VALUE OF MTIME (TDY MAY DEPEND ON ETA)<br>
SAVEA1=0 ; ERASE OLD VALUE FROM PREVIOUS PASS<br>
ELSE<br>
MTIME(1)=MTIME(1)<br>
SAVEA1=SAVEA1<br>
ENDIF<br>
It is instructive to note that there is one warning that may be ignored:<br>
(WARNING 3) THERE MAY BE AN ERROR IN THE ABBREVIATED CODE. THE FOL-<br>
LOWING<br>
ONE OR MORE RANDOM VARIABLES ARE DEFINED WITH &quot;IF&quot; STATEMENTS THAT<br>
DO NOT<br>
PROVIDE DEFINITIONS FOR BOTH THE &quot;THEN&quot; AND &quot;ELSE&quot; CASES. IF ALL<br>
CONDITIONS FAIL, THE VALUES OF THESE VARIABLES WILL BE ZERO.<br>
SA<br>
EX-100<br>
<hr>
<A name=755></a>Help Guide<br>
EXAMPLES MOVING<br>
The code in $ERROR is such that SA is always given a value and SA never defaults<br>to zero. Recursive code for SA could be used to avoid this warning if desired:<br>
IF ([I]&lt;=LIREC.AND.TIME==TIMES(KREC)) THEN<br>
SA=SAVEA[I]<br>
ELSE<br>
SA=SA<br>
ENDIF<br>
2. SAVEA variables<br>
The variables SAVEAi save the value of compartment 3 (AUC) at TIME(i)-TDY.<br>They must be assigned individually because there is no true array feature in<br>NMTRAN for random variables.<br>
3. SIMULATION<br>
The control streams can be used to simulate values of DV. There will be a difference<br>between simulated values from aucdelay1.ctl vs. aucdelay2.ctl (2 and 3 are the<br>same). The extra record in aucdelay1.ctl’s FDATA causes an extra call to SIMEPS<br>(even though it is a dose record), so the simulated etas and eps are not identical. To<br>have identical simulated values, then do not use<br>
$DATA DELAYDATA IGNORE=@ IGNORE=(CMT==4)<br>
Instead, use a version of DELAYDAT A in which the second record has EVID=2<br>(&quot;other-type event record&quot;), so that it is physically present but does nothing. This<br>adds another record to the data set. Instead of<br>
nmtemplate aucdelay3.ctl temp1 maxrecs=16<br>
the value maxrecs=17 should be used.<br>
All ﬁles may be found in the examples directory:<br>
DELAYDAT A<br>aucdelay1S.ctl<br>aucdelay2S.ctl<br>aucdelay1.ctl<br>aucdelay2.ctl<br>aucdelay3.ctl<br>
REFERENCES: Guide Introduction_7<br>
EX-101<br>
<hr>
<A name=756></a>MULTIPLE DOSE<br>
EXAMPLES Help Guide<br>
MULTIPLE DOSE EXAMPLE<br>
This example is based on work described in Fattinger K. et al., Netilmicin in the neonate -<br>population pharmacokinetic analysis and dosing recommendations, Clinical Pharmacol-<br>ogy and Therapeutics, 1991, Jul, V50; N1:55-65. It illustrates a data ﬁle with multiple<br>doses of different kinds.<br>
A FORTRAN format statement is needed to describe the data ﬁle because each data<br>record spans two FORTRAN records and also because blanks are sometimes used for null<br>data items.<br>
Explanation of data items:<br>
TIME hours<br>KG bodyweight(kg)<br>LENG length(cm)<br>SEX 0 for female and 1 for male<br>GAGE gestational age at birth<br>AGE<br>
actual age (in days)<br>
AGE1 age at start of therapy<br>IMIV im or iv dose (1.0 is iv and 0.0 is im)<br>CREA creatinine value<br>TAD<br>
time after last dose (h)<br>
All doses are given as zero order infusions. The RATE data item is -2, indicating that<br>duration D1 is modeled in the $PK block. There are two types of doses: IV (intravenous)<br>and IM (intramuscular). The duration of IV doses is 2 minutes. The duration of IM<br>doses is unknown and is given by theta(7).<br>
The Estimation Step produces a Model Speciﬁcation File, which may be used in in a later<br>run; (See <b>$msﬁ</b>, <b>model speciﬁcation ﬁle</b>).<br>
$PROBLEM NETILMICIN<br>
$INPUT ID MDV TIME AMT RATE CP=DV KG LENG SEX<br>
GAGE AGE AGE1 IMIV CREA TAD<br>
$DATA data (6F7.0/7X,9F7.0)<br>
$SUBROUTINE ADVAN3,TRANS4<br>
$PK<br>
TVCL1=THETA(1)*KG<br>
GAGEN=GAGE/39.0<br>
PAN=(AGE+1.0)/7.0<br>
IF(GAGE.LT.39.0) THEN<br>
TVCL=TVCL1*(GAGEN**THETA(3))*(PAN**THETA(2))<br>
ELSE<br>
TVCL=TVCL1*(PAN**THETA(2))<br>
ENDIF<br>
CL=TVCL*EXP(ETA(1))<br>
TVV1=THETA(4)*KG<br>
V1=TVV1*EXP(ETA(2))<br>
Q=THETA(5)<br>
V2=THETA(6)*KG<br>
S1=V1<br>
EX-102<br>
<hr>
<A name=757></a>Help Guide<br>
EXAMPLES MULTIPLE DOSE<br>
IF(IMIV.GE.1.0) THEN<br>
D1=.0333333 ; 2./60.<br>
ELSE<br>
D1=THETA(7)<br>
ENDIF<br>
$ERROR<br>
Y=F*(1+EPS(1))<br>
$THETA (0,0.07) (0,0.1) (0,1.1) (0,0.4) (0,0.07) (0,0.8) (0,.033)<br>
$OMEGA 0.02 0.02<br>
$SIGMA 0.02<br>
$ESTIMATION PRINT=5 MSFO=msfo1<br>
$COVARIANCE<br>
$TABLE MDV ID KG LENG SEX GAGE AGE TAD BY MDV ID NOPRINT FILE=NTABLE.DAT<br>
$SCATTER PRED VS CP<br>
UNIT<br>
Data for one subject follow. This subject received both IM and IV doses.<br>
6.0 1.0 0.0<br>
13.0 -2.0<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 0.0 0.0 1.0<br>
56.0 0.0<br>
6.0 1.0<br>
24.0 10.4 -2.0<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 1.0 0.0 1.0<br>
56.0 0.0<br>
6.0 0.0<br>
26.0 0.0 0.0<br>
6.95<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 1.0 0.0 1.0<br>
56.0 2.0 0.0<br>
6.0 0.0<br>
32.0 0.0 0.0<br>
3.45<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 1.0 0.0 1.0<br>
56.0 8.0 0.0<br>
6.0 0.0<br>
40.0 0.0 0.0 1.8<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 2.0 0.0 1.0<br>
56.0 16.0<br>
0.0<br>
6.0 1.0<br>
48.0 10.4 -2.0<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 2.0 0.0 0.0<br>
56.0 0.0<br>
6.0 1.0<br>
72.0 10.4 -2.0<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 3.0 0.0 0.0<br>
56.0 0.0<br>
6.0 1.0<br>
96.0 10.4 -2.0<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 4.0 0.0 0.0<br>
56.0 0.0<br>
6.0 1.0<br>
120.0 10.4 -2.0<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 5.0 0.0 0.0<br>
56.0 0.0<br>
6.0 0.0<br>
122.0 0.0 0.0 5.9<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 5.0 0.0 0.0<br>
56.0 2.0 0.0<br>
6.0 0.0<br>
128.0 0.0 0.0 2.1<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 5.0 0.0 0.0<br>
56.0 8.0 0.0<br>
6.0 0.0<br>
136.0 0.0 0.0<br>
0.75<br>
6.0 2.590<br>
47.0 0.0<br>
36.0 6.0 0.0 0.0<br>
56.0 16.0<br>
0.0<br>
(See <b>duration</b>, <b>$data</b>).<br>
REFERENCES: Guide VI, section V.D<br>REFERENCES: Guide V, section 6.8 , 6.10<br>
EX-103<br>
<hr>
<A name=758></a>NONPARAMETRIC EXAMPLES<br>
Help Guide<br>
NONPARAMETRIC EXAMPLE<br>
DISCUSSION:<br>
Three examples are given of the NONPARAMETRIC step in NONMEM. In examples 1<br>and 2, it is assumed that there only two etas in the problem. With more than two etas,<br>insert the appropriate additional code.<br>
Example 1<br>
This example illustrates how the cumulative density can be plotted versus the conditional<br>etas.<br>
The following code is inserted in the $PRED or $PK block.<br>
DN1=CDEN_(1)<br>
DN2=CDEN_(2)<br>
The following control records are used. Note that with the $NONPARAMETRIC record,<br>the MARGINALS option is the default and need not be coded explicitly.<br>
$ESTIMATION POSTHOC PRINT=1<br>
$NONPARAMETRIC MARGINALS<br>
$SCAT DN1 VS ETA1<br>
$SCAT DN2 VS ETA2<br>
Example 2<br>
This example illustrates how both the conditional etas and the conditional nonparametric<br>etas (CNPE) can be obtained, and how they can be compared.<br>(See <b>comact</b>).<br>
The following code is inserted in the $PRED or $PK block:<br>
;CONDITIONAL PARAMETRIC ETAS<br>
IF (COMACT.EQ.2) ET1A=ETA(1)<br>
IF (COMACT.EQ.2) ET2A=ETA(2)<br>
;CONDITIONAL NONPARAMETRIC ETAS (CNPE)<br>
IF (COMACT.EQ.3) ET1=ETA(1)<br>
IF (COMACT.EQ.3) ET2=ETA(2)<br>
The following control statements may be used. The ﬁrst two are required; the $SCAT-<br>TER and $TABLE statements are examples of what can be used.<br>
$ESTIMATION POSTHOC<br>
$NONP ETAS<br>
; Examine distribution of nonparametric etas<br>
$SCAT ET1 VS ID<br>
$SCAT ET2 VS ID<br>
; Compare parametric and nonparametric etas<br>
$SCAT ET1A VS ET1<br>
$SCAT ET2A VS ET2<br>
$TABLE ID ET1A ET2A ET1 ET2 NOPRINT<br>
Example 3<br>
This example shows the speciﬁc statements needed to simulate from a nonparametric dis-<br>tribution using a Model Speciﬁcation ﬁle generated from a previous analysis using<br>$NONPARAMETRIC.<br>
EX-104<br>
<hr>
<A name=759></a>Help Guide<br>
EXAMPLES NONPARAMETRIC<br>
; Model specification file from a previous analysis using $NONPARAMETRIC<br>
$MSFI nonpfit.msf<br>
; Second seed will be used for simulation using the nonparametric density<br>
; Must include TRUE=FINAL, otherwise initial instead of final parameter<br>
; estimates will be used.<br>
$SIMULATION (3432192) (6348371 NONPARAMETRIC) TRUE=FINAL<br>
REFERENCES: None.<br>
EX-105<br>
<hr>
<A name=760></a>NWPRI EXAMPLES<br>
Help Guide<br>
NWPRI EXAMPLES<br>
These examples illustrate the use of the NONMEM utility routine NWPRI by the NM-<br>TRAN $PRIOR record, and also by an equivalent user-supplied routine PRIOR. For a<br>discussion of PRIOR: (See <b>prior</b>). For a discussion of the NWPRI routine and in particu-<br>lar, a discussion of the $THETA, $OMEGA, $SIGMA records: (See <b>nwpri</b>).<br>
Example 1<br>
Use of PRIOR and NWPRI and a control stream for single-subject data:<br>
This example obtains parameter estimates from single subject data, using a two-compart-<br>ment PK model, and it incorporates a frequentist prior of multivariate normal form for all<br>of the THETA vector.<br>
$PROB SINGLE SUBJECT DATA WITH PRIOR ON THETA<br>$INPUT ID DOSE TIME DV WT<br>$DATA data1<br>$PRIOR NWPRI NTHETA=3,NETA=1,NTHP=3,NPEXP=1<br>$PRED<br>;<br>;<br>
THETA(1)=MEAN ABSORPTION RATE CONSTANT<br>
;<br>
THETA(2)=MEAN ELIM. RATE CONSTANT (1/HR)<br>
;<br>
THETA(3)=CLEARANCE (LITERS/HR)<br>
;<br>
DOSE=WEIGHT-ADJUSTED DOSE (MG/KG)<br>
;<br>
IF (NEWIND.EQ.0) AMT=DOSE*WT<br>T1=THETA(1)<br>T2=THETA(2)<br>T3=THETA(3)<br>A=EXP(-T2*TIME)<br>B=EXP(-T1*TIME)<br>C=T1-T2<br>D=A-B<br>E=T3*C<br>Y=AMT*T1*T2/E*D+ETA(1)<br>
$THETA (.4,1.7,7) (.025,.102,.4) (.3,3,30)<br>;mode for prior with THETA:<br>$THETA 2.77 FIX .0781 FIX 2.63 FIX<br>$OMEGA .388<br>;var-cov for prior with THETA:<br>$OMEGA BLOCK (3) 5.55 .00524 .00024 -.128 .00911 .515 FIX<br>
$EST<br>
Instead of a $PRIOR record, the following may be used:<br>
$SUBROUTINE PRIOR=prior<br>
The prior routine is as follows:<br>
SUBROUTINE PRIOR (ICALL,CNT)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
REAL(KIND=DPSIZE) :: CNT<br>REAL(KIND=DPSIZE) :: PLEV<br>INTEGER(KIND=ISIZE) :: ICALL<br>NTHETA=3<br>NETA=1<br>NTHP=3<br>NPEXP=1<br>
EX-106<br>
<hr>
<A name=761></a>Help Guide<br>
EXAMPLES NWPRI<br>
PLEV=0.<br>ITYP=0<br>NSAM=0<br>ISS=0<br>NEPS=0<br>NETP=0<br>NEPP=0<br>CALL NWPRI(NTHETA,NETA,NEPS,NTHP,NETP,NEPP,NPEXP,ITYP,PLEV, &amp;<br>
NSAM,ISS,CNT)<br>
RETURN<br>END<br>
Example 2<br>
First example of use of PRIOR and NWPRI and a control stream for population data:<br>
This example obtains parameter estimates from population data, using a two-compart-<br>ment PK model, and it incorporates a frequentist prior of multivariate normal/inverse<br>Wishart form for all of the THETA vector and OMEGA matrix.<br>
$PROB POPULATION DATA WITH PRIOR ON THETA AND OMEGA<br>$INPUT ID DOSE TIME DV WT<br>$DATA data2<br>$PRIOR NWPRI NTHETA=3 NETA=3 NTHP=3 NETP=3 NPEXP=1<br>$PRED<br>;<br>;<br>
THETA(1)=MEAN ABSORPTION RATE CONSTANT - MEAN ELIM. RATE CONSTANT (l/HR)<br>
;<br>
THETA(2)=MEAN ELIM. RATE CONSTANT (1/HR)<br>
;<br>
THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;<br>
DOSE=WEIGHT-ADJUSTED DOSE (MG/KG)<br>
;<br>
IF (NEWIND.NE.2) THEN<br>
AMT=DOSE*WT<br>W=WT<br>
ENDIF<br>T0=THETA(1)*EXP(ETA(1))<br>T2=THETA(2)*EXP(ETA(2))<br>T1=T2+T0<br>T3=THETA(3)*W*EXP(ETA(3))<br>A=EXP(-T2*TIME)<br>B=EXP(-T1*TIME)<br>C=T1-T2<br>D=A-B<br>E=T3*C<br>Y=AMT*T1*T2/E*D+EPS(1)<br>
$THETA (0,4,5) (0,.09,.5) (.004,.01,.9)<br>;mode for prior on THETA:<br>$THETA 3 FIX .08 FIX .04 FIX<br>;df for prior on OMEGA:<br>$THETA 12 FIX<br>$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08<br>;var-cov for prior on THETA:<br>$OMEGA BLOCK (3) .494 .00207 .0000847 .000692 .0000471 .0000292 FIX<br>;mode for prior on OMEGA:<br>$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08 FIX<br>$SIGMA .4<br>
$EST<br>
Instead of a $PRIOR record, the following may be used:<br>
EX-107<br>
<hr>
<A name=762></a>NWPRI EXAMPLES<br>
Help Guide<br>
$SUBROUTINE PRIOR=prior<br>
The prior routine is as follows:<br>
SUBROUTINE PRIOR (ICALL,CNT)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
REAL(KIND=DPSIZE) :: CNT<br>REAL(KIND=DPSIZE) :: PLEV<br>INTEGER(KIND=ISIZE) :: ICALL<br>NTHETA=3<br>NETA=3<br>NTHP=3<br>NETP=3<br>NPEXP=1<br>PLEV=0.<br>ITYP=0<br>NSAM=0<br>ISS=0<br>NEPS=0<br>NEPP=0<br>CALL NWPRI(NTHETA,NETA,NEPS,NTHP,NETP,NEPP,NPEXP,ITYP,PLEV, &amp;<br>
NSAM,ISS,CNT)<br>
RETURN<br>END<br>
Example 3<br>
Second example of use of PRIOR and NWPRI and a control stream for population data:<br>
This example simulates the THETA and OMEGA parameters of the same two-compart-<br>ment population PK model, as well as the population data from this model. During prob-<br>lem ﬁnalization, the entire post-simulation theta vector and omega array in common<br>NMPR16 are written to external ﬁles.<br>
$PROB POPULATION DATA WITH PRIOR ON THETA AND OMEGA<br>$INPUT ID DOSE TIME DV WT<br>$DATA data2<br>$PRIOR NWPRI<br>
NTHETA=3 NETA=3 NTHP=3 NETP=3 NPEXP=1 ITYP=0 PLEV=.9999<br>
$PRED<br>;<br>;<br>
THETA(1)=MEAN ABSORPTION RATE CONSTANT - MEAN ELIM. RATE CONSTANT (l/HR)<br>
;<br>
THETA(2)=MEAN ELIM. RATE CONSTANT (1/HR)<br>
;<br>
THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;<br>
DOSE=WEIGHT-ADJUSTED DOSE (MG/KG)<br>
;<br>
IF (NEWIND.NE.2) THEN<br>
AMT=DOSE*WT<br>W=WT<br>
ENDIF<br>T0=THETA(1)*EXP(ETA(1))<br>T2=THETA(2)*EXP(ETA(2))<br>T1=T2+T0<br>T3=THETA(3)*W*EXP(ETA(3))<br>A=EXP(-T2*TIME)<br>B=EXP(-T1*TIME)<br>C=T1-T2<br>D=A-B<br>E=T3*C<br>Y=AMT*T1*T2/E*D+EPS(1)<br>IF (ICALL.EQ.3) THEN<br>
WRITE (97,*) THSIMP,THSIMPR<br>
EX-108<br>
<hr>
<A name=763></a>Help Guide<br>
EXAMPLES NWPRI<br>
WRITE (98,*) OMSIMP(BLOCK)<br>
ENDIF<br>
$THETA (0,4,5) (0,.09,.5) (.004,.01,.9)<br>;mode for prior on THETA:<br>$THETA 3 FIX .08 FIX .04 FIX<br>;df for prior on OMEGA:<br>$THETA 12 FIX<br>$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08<br>;var-cov for prior on THETA:<br>$OMEGA BLOCK (3) .494 .00207 .0000847 .000692 .0000471 .0000292 FIX<br>;mode for prior on OMEGA:<br>$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08 FIX<br>$SIGMA .4<br>
$SIM (547676) ONLY<br>
Suppose a $TABLE record is added to the above control stream. To obtain values of DV<br>computed with the simlulated values of eta, include the following code:<br>
IF (ICALL.EQ.4) THEN<br>T0=THSIMP(1)*EXP(ETA(1))<br>T2=THSIMP(2)*EXP(ETA(2))<br>T3=THSIMP(3)*W*EXP(ETA(3))<br>ELSE<br>T0=THETA(1)*EXP(ETA(1))<br>T2=THETA(2)*EXP(ETA(2))<br>T3=THETA(3)*W*EXP(ETA(3))<br>ENDIF<br>
Instead of a $PRIOR record, the following may be used:<br>
$SUBROUTINE PRIOR=prior<br>
The prior routine is as follows:<br>
SUBROUTINE PRIOR (ICALL,CNT)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
REAL(KIND=DPSIZE) :: CNT<br>REAL(KIND=DPSIZE) :: PLEV<br>INTEGER(KIND=ISIZE) :: ICALL<br>PLEV=.9999<br>NTHETA=3<br>NETA=3<br>NTHP=3<br>NETP=3<br>NPEXP=1<br>NEPS=0<br>NEPP=0<br>ITYP=0<br>NSAM=0<br>ISS=0<br>CALL NWPRI(NTHETA,NETA,NEPS,NTHP,NETP,NEPP,NPEXP,ITYP,PLEV, &amp;<br>
NSAM,ISS,CNT)<br>
RETURN<br>END<br>
REFERENCES: none.<br>
EX-109<br>
<hr>
<A name=764></a>OBJECTIVE EXAMPLES<br>
Help Guide<br>
OBJECTIVE FUNCTION VALUE INDIVIDUAL EXAMPLE<br>
Note: With NONMEM 7, the additional output ﬁle root.phi contains the same informa-<br>tion.<br>(See <b>additional_output_ﬁle</b>).<br>
This example illustrates how individual contributions to the objective function may be<br>obtained.<br>(See <b>Objective Function Value Individual</b>).<br>
This example is a modiﬁcation of CONTROL4 from the NONMEM distribution media.<br>It is for NONMEM VI 2.0 and later.<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE TIME CP=DV WT<br>
$DATA THEO<br>
$PRED<br>
;THETA(1)=MEAN ABSORPTION RATE CONSTANT (1/HR)<br>
;THETA(2)=MEAN ELIMINATION RATE CONSTANT (1/HR)<br>
;THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;DOSE=WT-ADJUSTED DOSE (MG/KG)<br>
;DS=NON-WT-ADJUSTED DOSE (MG)<br>
IF (DOSE.NE.0) THEN<br>
DS=DOSE*WT<br>
W=WT<br>
ENDIF<br>
KA=THETA(1)+ETA(1)<br>
KE=THETA(2)+ETA(2)<br>
CL=THETA(3)*W+ETA(3)<br>
D=EXP(-KE*TIME)-EXP(-KA*TIME)<br>
E=CL*(KA-KE)<br>
F=DS*KE*KA/E*D<br>
Y=F+EPS(1)<br>
IF (ICALL.EQ.3) THEN<br>
WRITE (70,*) IIDX,CNTID<br>
ENDIF<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA BLOCK(3)<br>
6 .005 .0002 .3 .006 .4<br>
$SIGMA .4<br>
$EST MAXEVAL=450<br>
PRINT=5<br>
Pairs of values are written, one pair per line, one pair for each individual record. Each<br>pair contains the ID data item and the contribution the objective function.<br>
1.000000000000000E+00 1.328986294492194E+01<br>
2.000000000000000E+00 2.071754196741930E+01<br>
...<br>
They may also be displayed in a table, using<br>$ABBR COMRES=2<br>
and code such as the following in the $ERROR or $PK block:<br>
IF (COMACT.EQ.1) THEN<br>
COM(1)=IIDX(NIREC)<br>
EX-110<br>
<hr>
<A name=765></a>Help Guide<br>
EXAMPLES OBJECTIVE<br>
COM(2)=CNTID(NIREC)<br>
ENDIF<br>
The following, for example, will produced a separate table for the values:<br>
$TABLE IID=COM(1) CNT=COM(2) FILE=comvals NOAPPEND NOPRINT FIRSTONLY<br>
Note: With earlier versions than NONMEM 7.3, verbatim code is needed:<br>&quot;<br>
COM(1)=IIDX(NIREC)<br>
&quot;<br>
COM(2)=CNTID(NIREC)<br>
REFERENCES: None.<br>
EX-111<br>
<hr>
<A name=766></a>PHENOBARB EXAMPLES<br>
Help Guide<br>
PHENOBARB EXAMPLE<br>
This example illustrates simple kinetics.<br>
$PROBLEM PHENOBARB<br>
SIMPLE MODEL<br>
$INPUT ID TIME AMT WGT APGR DV<br>
$DATA PHENO<br>
$SUBR ADVAN1 TRANS2<br>
$PK<br>
TVCL=THETA(1)<br>
TVV=THETA(2)<br>
CL=TVCL*EXP(ETA(1))<br>
V=TVV*EXP(ETA(2))<br>
S1=V<br>
$THETA (0,.0105) (0,1.05)<br>
$OMEGA .25<br>
.25<br>
$ERROR<br>
W=F<br>
Y=F+W*EPS(1)<br>
IPRED=F ;<br>
individual-specific prediction<br>
IRES=DV-IPRED ;<br>
individual-specific residual<br>
IWRES=IRES/W ;<br>
individual-specific weighted residual<br>
$SIGMA .04<br>
$ESTIMATION SIGDIGITS=4 POSTHOC<br>
$COVARIANCE<br>
$TABLE ID WGT APGR TIME AMT CL V ETA1 ETA2 IPRED IWRES<br>
NOPRINT ONEHEADER FILE=TABLE1<br>
$SCATTER DV VS PRED UNIT<br>
$SCATTER (RES,WRES) VS PRED<br>
$SCATTER (CL,V) VS (WGT,APGR)<br>
$SCATTER IWRES VS IPRED BY MDV ORDZERO<br>
Data for the ﬁrst individual follow.<br>
1<br>
0.<br>
25.0 1.4<br>
7<br>
.<br>
1<br>
2.0 .<br>
1.4 7<br>
17.3<br>
1<br>
12.5 3.5 1.4<br>
7<br>
.<br>
1<br>
24.5 3.5 1.4<br>
7<br>
.<br>
1<br>
37.0 3.5 1.4<br>
7<br>
.<br>
1<br>
48.0 3.5 1.4<br>
7<br>
.<br>
1<br>
60.5 3.5 1.4<br>
7<br>
.<br>
1<br>
72.5 3.5 1.4<br>
7<br>
.<br>
1<br>
85.3 3.5 1.4<br>
7<br>
.<br>
1<br>
96.5 3.5 1.4<br>
7<br>
.<br>
1<br>
108.5 3.5 1.4<br>
7<br>
.<br>
1<br>
112.5 .<br>
1.4 7<br>
31.0<br>
REFERENCES: Guide III, section VI.2<br>REFERENCES: Guide V, section 2.3<br>
EX-112<br>
<hr>
<A name=767></a>Help Guide<br>
EXAMPLES PK PD SEQUENTIAL 1<br>
PK PD SEQUENTIAL 1 EXAMPLE<br>
This is an example for analysis of direct PD using previously estimated individuals’ PK<br>parameters. (See <b>PK_PD_sequential_2 </b>example).<br>
$PROBLEM EMAX MODEL APPLIED TO EFFECT SITE CONCENTRATION<br>
; NOTE: INDIVIDUAL K, V ESTIMATED FROM PREVIOUS PK FIT<br>
;<br>
AND RECORDED IN DATA<br>
;<br>
; THE DATA FILE CONTAINS *ONLY* EFFECT OBSERVATIONS,<br>
; CMT = 2<br>
NEEDED TO TELL PREDPP TO SET F = CE<br>
$DATA data<br>
$INPUT ID TIME DV AMT=DOSE CMT<br>
KK V1<br>
;<br>
|---|<br>
;<br>
KK AND V1 ARE ESTIMATES OF K AND V<br>
$SUBROUTINES ADVAN3<br>
$PK<br>
K<br>
= KK<br>
K12= .001*K<br>
; TRIVIAL LOSS TO EFFECT COMPT.<br>
K21= THETA(1)*EXP(ETA(1))<br>
EMAX=THETA(2)*EXP(ETA(2))<br>
C50= THETA(3)*EXP(ETA(3))<br>
S2= V1*K12/K21<br>
; SO THAT CESS = CPSS<br>
$ERROR<br>
Y<br>
=EMAX*F/(C50+F)*EXP(ERR(1))<br>
; ADD APPROPRIATE $THETA, $OMEGA, $SIGMA, $ESTIMATION, ETC.<br>
If, moreover, an absorption lag (ALAG1) parameter is modeled in $PK with parameters<br>estimated from the PD data only, then this introduces a lag in the dose - Ce relationship.<br>Since this lag was not present in the dose - Cp relationship, it may be interpreted as a lag<br>in the Cp - Ce relationship.<br>
REFERENCES: Guide IV, section V.C.6<br>REFERENCES: Guide VI, section IV.B.2 , VII.C.3<br>
EX-113<br>
<hr>
<A name=768></a>PK PD SEQUENTIAL 2<br>
EXAMPLES Help Guide<br>
PK PD SEQUENTIAL 2 EXAMPLE<br>
This is an example for analysis of direct PD using previously estimated population PK<br>parameters. (See <b>PK_PD_sequential_1 </b>example).<br>
$PROBLEM EMAX MODEL APPLIED TO EFFECT SITE CONCENTRATION<br>
; THE DATA FILE CONTAINS *ONLY* EFFECT OBSERVATIONS,<br>
; POP PK PARAMS ESTIMATED IN PREVIOUS RUN &amp; FIXED HERE.<br>
; CMT = 2<br>
NEEDED TO TELL PREDPP TO SET F = CE<br>
;<br>
$DATA data<br>
$INPUT ID TIME DV AMT=DOSE CMT<br>
$SUBROUTINES ADVAN3<br>
$PK<br>
K<br>
= THETA(1)*EXP(ETA(1))<br>
K12= .001*K<br>
; TRIVIAL LOSS TO EFFECT COMPT.<br>
K21= THETA(2)*EXP(ETA(2))<br>
V1= THETA(3)*EXP(ETA(3))<br>
EMAX=THETA(4)*EXP(ETA(4))<br>
C50= THETA(5)*EXP(ETA(5))<br>
S2= V1*K12/K21<br>
;<br>
SO THAT CESS = CPSS<br>
$ERROR<br>
Y= EMAX*F/(C50+F)*EXP(ERR(1))<br>
$THETA<br>
.124 FIXED<br>
; K   - FIXED TO PREV EST<br>
.1 ; KEO - ESTIMATED<br>
28.6 FIXED<br>
; V1<br>
- FIXED TO PREV EST<br>
100 ; EMAX- ESTIMATED<br>
50 ; C50 - ESTIMATED<br>
$OMEGA<br>
.113 FIXED<br>
; OMEGA(K) - FIXED TO PREV EST<br>
.04<br>
.627 FIXED<br>
; OMEGA(V1)- FIXED TO PREV EST<br>
.04<br>
.04<br>
$SIGMA .16<br>
; ADD $ESTIMATION, ETC, AS DESIRED.<br>
If, moreover, an absorption lag (ALAG1) parameter is modeled in $PK with parameters<br>estimated from the PD data only, then this introduces a lag in the dose - Ce relationship.<br>Since this lag was not present in the dose - Cp relationship, it may be interpreted as a lag<br>in the Cp - Ce relationship.<br>
REFERENCES: Guide IV, section V.C.6<br>REFERENCES: Guide VI, section IV.B.2 , VII.C.3<br>
EX-114<br>
<hr>
<A name=769></a>Help Guide<br>
EXAMPLES PK PD SIMULTANEOUS 1<br>
PK PD SIMULTANEOUS 1 EXAMPLE<br>
This is an example for simultaneous analysis of PK and direct PD. Kinetics are one com-<br>partment. (See <b>PK_PD_simultaneous_2</b>, <b>PK_PD_simultaneous_3</b>).<br>
$PROBLEM SIMULT PK/PD - ADVAN3<br>
; THE DATA FILE CONTAINS BOTH CP AND EFFECT OBSERVATIONS.<br>
; WHEN DV IS A CP OBSERVATION, CMT = 1 (OR 0)<br>
; WHEN DV IS AN EFFECT OBSERVATION, CMT =2<br>
$DATA data<br>
$INPUT ID TIME DV AMT=DOSE CMT<br>
$SUBROUTINES ADVAN3<br>
$PK<br>
K<br>
= THETA(1)*EXP(ETA(1))<br>
K12= .001*K<br>
; TRIVIAL LOSS TO EFFECT CMPT<br>
K21= THETA(2)*EXP(ETA(2))<br>
; KEO<br>
S1= THETA(3)*EXP(ETA(3))<br>
; V1 FOR DRUG<br>
EMAX=THETA(4)*EXP(ETA(4))<br>
C50= THETA(5)*EXP(ETA(5))<br>
S2= S1*K12/K21<br>
; SO THAT CESS = CPSS<br>
$ERROR<br>
IF (CMT.EQ.2) THEN<br>
Y = EMAX*F/(C50+F)*EXP(ERR(2)) ; DV = EFFECT IF CMT=2<br>
ELSE<br>
Y = F*EXP(ERR(1)) ; DV = CP IF CMT=1 (OR 0)<br>
ENDIF<br>
; ADD APPROPRIATE $THETA, $OMEGA, $SIGMA, $ESTIMATION, ETC.<br>
REFERENCES: Guide IV, section V.C.6<br>REFERENCES: Guide VI, section IV.B.2 , VII.C.3<br>
EX-115<br>
<hr>
<A name=770></a>PK PD SIMULTANEOUS 2<br>
EXAMPLES Help Guide<br>
PK PD SIMULTANEOUS 2 EXAMPLE<br>
This is an example for simultaneous analysis of PK and PD. Kinetics are one-compart-<br>ment. (See <b>PK_PD_simultaneous_1</b>, <b>PK_PD_simultaneous_3</b>).<br>
$PROBLEM SIMULTANEOUS PK/PD - ADVAN6<br>
; NOTE: EXAMPLE USES 1-COMPT PK;<br>
;<br>
MORE COMPLEX COMPARTMENTAL MODEL CAN BE USED<br>
; CMT = 1 (OR 0) FOR DV = CP; CMT = 2 FOR DV = EFFECT<br>
$DATA data<br>
$INPUT ID TIME DV AMT=DOSE CMT<br>
$SUBROUTINE ADVAN6 TOL=5<br>
$MODEL<br>
COMP=(CENTRAL,DEFDOSE,DEFOBS)<br>
COMP=EFFECT<br>
$PK<br>
K10= THETA(1)*EXP(ETA(1))<br>
V1= THETA(2)*EXP(ETA(2))<br>
S1= V1<br>
K20= THETA(3)*EXP(ETA(3))<br>
C50= THETA(4)*EXP(ETA(4))<br>
EMAX=THETA(5)*EXP(ETA(5))<br>
$DES<br>
DADT(1)=-K10*A(1) ;NOTE NO LOSS TO A(2)<br>
DADT(2)= K20*(A(1)/V1-A(2))<br>
;A(2) IS CE<br>
$ERROR<br>
IF (CMT.EQ.2) THEN<br>
Y = EMAX*F/(C50+F)*EXP(ERR(2)) ; DV = EFFECT IF CMT=2<br>
ELSE<br>
Y = F*EXP(ERR(1)) ; DV = CP IF CMT=1 (OR 0)<br>
ENDIF<br>
; ADD APPROPRIATE $THETA, $OMEGA, $SIGMA, $ESTIMATION, ETC.<br>
REFERENCES: Guide IV, section V.C.6 , V.C.7<br>REFERENCES: Guide VI, section IV.B.2 , VII.C.6<br>
EX-116<br>
<hr>
<A name=771></a>Help Guide<br>
EXAMPLES PK PD SIMULTANEOUS 3<br>
PK PD SIMULTANEOUS 3 EXAMPLE<br>
This is an example for simultaneous analysis of PK and direct PD. Kinetics are two-com-<br>partment. Either ADVAN5 or ADVAN7 could be used. (See <b>PK_PD_simultane-<br>ous_1</b>, <b>PK_PD_simultaneous_2</b>).<br>
$PROBLEM SIMULTANEOUS PK/PD - ADVAN7<br>
; NOTE: MODEL FOR CP CAN BE MORE COMPLEX BY ADDING CMPTS<br>
;<br>
; THE DATA FILE CONTAINS BOTH CP AND EFFECT OBSERVATIONS.<br>
; WHEN DV IS A CP OBSERVATION, CMT = 1 (OR 0),<br>
; WHEN DV IS AN EFFECT OBSERVATION, CMT =3.<br>
$DATA data<br>
$INPUT ID TIME DV AMT=DOSE CMT<br>
$SUBROUTINES ADVAN7<br>
$MODEL<br>
COMP=(CENTRAL,DEFDOSE,DEFOBS)<br>
COMP=PERIPH<br>
COMP=EFFECT<br>
$PK<br>
K10= THETA(1)*EXP(ETA(1))<br>
K12= THETA(2)*EXP(ETA(2))<br>
K13= .001*K10<br>
; TRIVIAL LOSS TO EFFECT COMPT<br>
K21= THETA(3)*EXP(ETA(3))<br>
S1= THETA(4)*EXP(ETA(4))<br>
; V1 FOR DRUG<br>
K30= THETA(5)*EXP(ETA(5))<br>
; KEO<br>
EMAX=THETA(6)*EXP(ETA(6))<br>
C50= THETA(7)*EXP(ETA(7))<br>
S3=S1*K13/K30 ; SO THAT CESS = CPSS<br>
$ERROR<br>
IF (CMT.EQ.3) THEN<br>
Y =EMAX*F/(C50+F)*EXP(ERR(2)) ; CMT = 3; DV = EFFECT<br>
ELSE<br>
Y =   F*EXP(ERR(1)) ; CMT = 1 (OR 0); DV = CP<br>
ENDIF<br>
; ADD APPROPRIATE $THETA, $OMEGA, $SIGMA, $ESTIMATION, ETC.<br>
REFERENCES: Guide IV, section V.C.6<br>REFERENCES: Guide VI, section IV.B.2 , VII.C.7<br>
EX-117<br>
<hr>
<A name=772></a>PK PD SIMULTANEOUS 4<br>
EXAMPLES Help Guide<br>
PK PD SIMULTANEOUS 4 EXAMPLE<br>
This is an example for simultaneous analysis of PK and indirect PD, where the PREDPP<br>PK prediction is modiﬁed by $ERROR code.<br>
$PROB WARFARIN<br>
$INPUT ID TIME DV AMT CMT<br>
; DV = DRUG CONC OR<br>
EFFECT (PROTHROMBIN TIME)<br>
$DATA data<br>
$SUBROUTINE ADVAN6 TOL=5<br>
$MODEL<br>
COMP=(CENTRAL,DEFDOSE,DEFOBS)<br>
; CAN ADD ADD’L COMPARTMENTS IF PK MULTICOMPARTMENTAL<br>
COMP=(CLOTFAC)<br>
$PK<br>
K10= THETA(1)*EXP(ETA(1))<br>
;LOSS RATE DRUG<br>
S1= THETA(2)*EXP(ETA(2))<br>
;VD DRUG<br>
SYNTH=THETA(3)*EXP(ETA(3)) ;SYNTH RATE OF CLOTING FACTOR<br>
LOSS= SYNTH<br>
C50= THETA(4)*EXP(ETA(4))<br>
$DES<br>
DADT(1)=-K10*A(1)<br>
EFF = C50/(C50+A(1)/S1)<br>
DADT(2)= SYNTH*EFF - LOSS*A(2)<br>
;CF LEVEL<br>
$ERROR<br>
PT = THETA(5)/(THETA(6)+F)<br>
; HYPERBOLIC MODEL FOR PRO-TIME<br>
IF (CMT.EQ.2) THEN<br>
Y = PT*EXP(EPS(2)) ; OBS IS PRO-TIME<br>
ELSE<br>
Y = F*EXP(EPS(1)) ; OBS IS DRUG CONCENTRATION<br>
ENDIF<br>
; ADD APPROPRIATE $THETA, $OMEGA, $SIGMA, $ESTIMATION, ETC.<br>
The system should be initialized with a bolus dose of AMT=1 into compartment 2<br>(CLOTFAC) at time zero to establish the initial condition A(1)=0, A(2)=1 at time zero.<br>This is appropriate because, in the absence of drug, the system is assumed to be at steady-<br>state (DADT(2)=0).<br>
REFERENCES: Guide IV, section V.C.6 , V.C.7<br>REFERENCES: Guide VI, section IV.B.2 , VII.C.6<br>
EX-118<br>
<hr>
<A name=773></a>Help Guide<br>
EXAMPLES PLASMA<br>
PLASMA URINE EXAMPLE<br>
Here are several examples of simultaneous modelling of plasma and urine data. The<br>examples are adapted from a model for the analysis of Dextromethorphan data provided<br>by Khaled Mohammed Abduljalil. The ﬁrst involves data from the parent drug. The sec-<br>ond involves both parent and metabolite data. In the control streams of these examples<br>plasma and urine data are simulated. The same control streams could also be used for<br>analysis of the data. MU_ modelling is used for the simulation to maintain consistency<br>with subsequent analysis runs but MU_ modelling has no effect on simulation. If MU_<br>variables are renamed to avoid the character &quot;_&quot; (e.g., rename MU_1 as MU1), the same<br>control streams may be run with NONMEM VI.<br>
EXAMPLE 1 sim_parent_a2.ctl<br>
The data dextroparent.dat contains data from only the parent drug. The parent drug is eli-<br>mated directly to urine, and also via conversion to metabolite, but there are no measure-<br>ments of metabolite in plasma or urine. The fraction F0 of parent drug in the urine is<br>computed as in Guide V, Chapter 4, Section 3.1 equation (4.6) and Section 3.4.1 equation<br>(4.7).<br>(See <b>Guide V, Chapter 4.3)</b><br>
The L2 data item is not required, but is used because multiple observations at the same<br>TIME are in effect multivariate observations. Values of SIGMA corresponding to unused<br>elements EPS(3) and EPS(4) are deﬁned so that the EPS vector has the same length in<br>both examples. See Remarks below.<br>
Although ADVAN2 is used, the same control stream could be implemented with<br>ADVAN5 or ADVAN6 or ADVAN7, with minor changes.<br>
$PROBLEM Parent drug, using ADVAN2<br>
$INPUT ID TIME AMT UVOL DV CMT MDV EVID L2<br>
$DATA dextroparent.dat IGNORE=#<br>
$SUBROUTINES ADVAN2 TRANS1<br>
$PK<br>
K12=THETA(1)<br>
KA=K12<br>
MU_1=LOG(THETA(2))<br>
V2=EXP(MU_1+ETA(1))<br>
MU_2=LOG(THETA(3))<br>
CLP=EXP(MU_2+ETA(2)) ; RENAL CL FOR PARENT<br>
CLB=THETA(4) ; METABOLIC CL FOR METABOLIC<br>
K23=CLP/V2+CLB/V2<br>
K=K23<br>
F0=CLP/(CLP+CLB)<br>
S2=V2<br>
S3=UVOL<br>
$ERROR (EVERY EVENT)<br>
ACMT=ABS(CMT) ; output compt. may have neg. value of CMT<br>
IF(ACMT.EQ.2) Y=F*(1+EPS(1))<br>
IF(ACMT.EQ.3) Y=F*(1+EPS(2))<br>
$THETA<br>
(0.01,0.8,6) ;KA<br>
(0.01,43,1000);V2<br>
EX-119<br>
<hr>
<A name=774></a>PLASMA EXAMPLES<br>
Help Guide<br>
(0.0001,20,190);CLP<br>
(0.01,15,90);CLB<br>
$OMEGA<br>
0.05 0.05<br>
$SIGMA<br>
.01 .01<br>
.01 .01 ; eps(3), eps(4) for consistent EPS with sim_metab_a6 example<br>
$SIM (111111) ONLYSIM<br>
$TABLE ID TIME AMT UVOL DV SIMP=PRED CMT MDV<br>
EVID L2 NOAPPEND FILE=sim_parent_a2.tab<br>
A fragment of the data ﬁle is as follows:<br>
#<br>
ID TIME AMT<br>
UVOL DV<br>
CMT MDV<br>
EVID L2<br>
2.000 0.000 30000.000<br>
0.000 0.000 1.000 1.000 1.000 1<br>
2.000 0.171<br>
0.000 0.000 0.000 3.000 1.000 2.000 1<br>
2.000 2.000<br>
0.000 0.000 0.000 2.000 0.000 0.000 1<br>
2.000 2.000<br>
0.000 93.100 0.000 -3.000 0.000 0.000 1<br>
2.000 2.000<br>
0.000 0.000 0.000 3.000 1.000 2.000 2<br>
2.000 3.150<br>
0.000 0.000 0.000 2.000 0.000 0.000 2<br>
2.000 3.150<br>
0.000 133.600 0.000 -3.000 0.000 0.000 2<br>
There is a dose at TIME=0. At TIME=.171, the urine compartment (which is the default<br>compartment for output) is turned on. At TIME=2, there are observations of both plasma<br>and urine. The urine amount is reset to 0 and the compartment turned back on for the<br>start of a new urine collection. At TIME 3.15 there are observations of plasma and urine.<br>
In the model, different EPS variables are used for the two types of observations. In the<br>table, values of PRED (SIMP) are computed with ETA and EPS equal to 0. The DV val-<br>ues are computed with simulated ETA and EPS, and would be used as the DV in subse-<br>quent analysis runs.<br>
EXAMPLE 2 sim_metab_a6.ctl<br>
The data dextrometab.dat includes measurements of metabolite in plasma and urine. The<br>model also include predictions of the metabolite in both plasma (CMT=4) and urine<br>(CMT=5; the default compartment for output). Different compartments are used for par-<br>ent and metabolite in urine, but the same value of UVOL applies to both. The F0 parame-<br>ter is not needed because the model for K23 now uses only CLP, the clearance of the par-<br>ent drug. No analytic ADVAN model has two output compartments, so a general<br>ADVAN (ADVAN6 or ADVAN5 or ADVAN7) must be used.<br>
Note that Compartment 3 is no longer the default for output. Instead of being computed<br>by PREDPP using mass balance, it is computed explicitly by the ADVAN routine itself<br>(e.g., using a differential equation when ADVAN6 is used). If compartment 3 is deﬁned<br>in $MODEL with default attributes, e.g.,<br>COMP=(DEXURIN)<br>there is an error messsage from PREDPP:<br>SPECIFIED COMPARTMENT MAY NOT BE TURNED OFF WITH AN OBSERVATION RECORD<br>Instead, the compartment may be deﬁned as an output-type compartment:<br>COMP=(DEXURIN INITIALOFF NODOSE)<br>Now observations with CMT=-3 are permitted and no change to the original data records<br>is needed.<br>
EX-120<br>
<hr>
<A name=775></a>Help Guide<br>
EXAMPLES PLASMA<br>
$PROBLEM Parent drug and metabolite, using ADVAN6<br>
$INPUT ID TIME AMT UVOL DV CMT MDV EVID L2<br>
$DATA dextrometab.dat IGNORE=#<br>
$SUBROUTINES ADVAN6 TRANS1 TOL=4<br>
$MODEL<br>
COMP=(DEPOT)<br>
COMP=(PLASMA DEFOBS) ; PARENT IN PLASMA<br>
COMP=(DEXURIN INITIALOFF NODOSE)<br>
;PARENT IN URINE<br>
COMP=METAB ;METABOLITE IN PLASMA<br>
$PK<br>
K12=THETA(1)<br>
MU_1=LOG(THETA(2))<br>
V2=EXP(MU_1+ETA(1))<br>
MU_2=LOG(THETA(3))<br>
CLP=EXP(MU_2+ETA(2)) ; RENAL CL FOR PARENT<br>
CLB=THETA(4) ; METABOLIC CL FOR METABOLIC<br>
CLMR=THETA(5) ; RENAL CL FOR METABOLITE<br>
V4=1<br>
K24=CLB/V2<br>
K23=CLP/V2<br>
; F0=CLP/(CLP+CLB) Omit F0 because parent and<br>
; metab have different urine compts.<br>
K45=CLMR/V4<br>
S2=V2<br>
S4=V4<br>
S3=UVOL<br>
S5=UVOL<br>
$ERROR (EVERY EVENT)<br>
ACMT=ABS(CMT) ; output compart. may have neg. value of CMT<br>
IF(ACMT.EQ.2) Y=F*(1+EPS(1))<br>
IF(ACMT.EQ.3) Y=F*(1+EPS(2))<br>
IF(ACMT.EQ.4) Y=F*(1+EPS(3))<br>
IF(ACMT.EQ.5) Y=F*(1+EPS(4))<br>
$DES<br>
DADT(1)=-K12*A(1)<br>
DADT(2)=K12*A(1)-K23*A(2)-K24*A(2)<br>
DADT(3)=K23*A(2)<br>
DADT(4)=K24*A(2)-K45*A(4)<br>
$THETA<br>
(0.01,0.8,6) ;KA<br>
(0.01,43,1000);V2<br>
(0.0001,20,190);CLP<br>
(0.01,15,90);CLB<br>
(0.0001,5,90);CLMR<br>
$OMEGA<br>
0.05 0.05<br>
$SIGMA<br>
.01 .01 .01 .01<br>
$SIM (111111) ONLYSIM<br>
$TABLE ID TIME AMT UVOL DV SIMP=PRED CMT MDV EVID L2 NOAPPEND<br>
EX-121<br>
<hr>
<A name=776></a>PLASMA EXAMPLES<br>
Help Guide<br>
FILE=sim_metab_a6.tab<br>
A fragment of the data dextrometab.dat is:<br>
#<br>
ID<br>
TIME AMT<br>
UVOL DV<br>
CMT MDV<br>
EVID L2<br>
2.000 0.000 30000.000 0.000 0.000 1.000 1.000 1.000 1<br>
2.000 0.171<br>
0.000 0.000 0.000 3.000 1.000 2.000 1<br>
2.000 0.171<br>
0.000 0.000 0.000 5.000 1.000 2.000 1<br>
2.000 2.000<br>
0.000 0.000 0.000 2.000 0.000 0.000 1<br>
2.000 2.000<br>
0.000 0.000 0.000 4.000 0.000 0.000 1<br>
2.000 2.000<br>
0.000 93.100 0.000 -3.000 0.000 0.000 1<br>
2.000 2.000<br>
0.000 93.100 0.000 -5.000 0.000 0.000 1<br>
2.000 2.000<br>
0.000 0.000 0.000 3.000 1.000 2.000 2<br>
2.000 2.000<br>
0.000 0.000 0.000 5.000 1.000 2.000 2<br>
2.000 3.150<br>
0.000 0.000 0.000 2.000 0.000 0.000 2<br>
2.000 3.150<br>
0.000 0.000 0.000 4.000 0.000 0.000 2<br>
2.000 3.150<br>
0.000 133.600 0.000 -3.000 0.000 0.000 2<br>
2.000 3.150<br>
0.000 133.600 0.000 -5.000 0.000 0.000 2<br>
Observations of metabolite in plasma (CMT=4) and metabolite in urine (CMT=5) are<br>present at the same values of TIME as observations of parent in plasma (CMT=2) and<br>parent in urine (CMT=3), respectively, and have the same values of L2.<br>
Remarks:<br>
After the control streams are run, the predictions SIMP for compartments 2 and 3 are the<br>same in the two table ﬁles sim_parent_a2.tab and sim_metab_a6.tab, as expected,<br>because they are computed with EPS=0, i.e., they are not simulated values. Because of<br>the use of L2 and the same-length EPS vector in both examples, the simulated DV’s for<br>compartments 2 and 3 are also the same. This is useful for illustrative and debugging<br>purposes, but is not usually the case when the EPS structure is different, or the L2 data<br>item is not used.<br>To summarize:<br>With L2, during simulation SIMEPS generates a new set of values for EPS only when L2<br>changes value.<br>Without L2, during simulation SIMEPS generates a new set of values for EPS with every<br>record, even when MDV is 1 or the PREDPP item EVID is not 0.<br>
(See <b>simeps</b>).<br>
All control streams and data ﬁles are found in the NONMEM 7.4 examples\dextro direc-<br>tory.<br>
dextroparent.dat (also displayed here)<br>sim_parent_a2.ctl (also displayed here)<br>sim_parent_a5.ctl<br>sim_parent_a6.ctl<br>dextrometab.dat (also displayed here)<br>sim_metab_a5.ctl<br>sim_metab_a6.ctl (also displayed here)<br>
REFERENCES: None.<br>
EX-122<br>
<hr>
<A name=777></a>Help Guide<br>
EXAMPLES RECORDS<br>
RECORDS=ID EXAMPLE<br>
These examples illustrate the use of the RECORDS=ID option of the $DAT A record. (See <b>$data</b>).<br>
Example 1 - Data checkout<br>
During a checkout phase, one might want to see only the predictions for the ﬁrst individ-<br>ual record, and therefore, use a data set comprised only of the data records therein. With<br>RECS=ID, it is not necessary to count the number of records in the ﬁst individual record.<br>
$DATA filename RECS=ID<br>
Example 2 - Data Analysis<br>
One might want to analyze each subject’s data independently of the others. One way this<br>can be done is by creating a single control stream with as many problems as there are<br>individual records in the data, and including one each of the following series of $DAT A<br>records in the series of problem speciﬁcations:<br>
$DATA filename RECS=n1<br>
$DATA filename RECS=n2 NOREWIND<br>
$DATA filename RECS=n3 NOREWIND<br>
etc.<br>
where &quot;nk&quot; is the number of records in the kth individual record. It would be necessary<br>to count the exact number of records. Now, these records can simply be coded<br>
$DATA filename RECS=ID<br>
$DATA filename RECS=ID NOREWIND<br>
$DATA filename RECS=ID NOREWIND<br>
etc.<br>
Example 3 - Use of the INCLUDE record<br>
With the INCLUDE record, the ﬁlename may now be followed by an integer n, whose<br>default value is 1. Then NM-TRAN reads n copies of the named ﬁle.<br>
In the example above if the problem speciﬁcation for all subjects after the ﬁrst are com-<br>pletely identical, a compact way of writing the control stream is possible. The control<br>stream would contain the problem speciﬁcation for the ﬁrst individual, including the<br>$SUBROUTINES record, abbreviated code, and the $DAT A record for the ﬁrst subject,<br>and would end with (if there are e.g. 12 subjects in all)<br>
INCLUDE ctlfile2 11<br>
The ﬁle ctlﬁle2 would contain one problem speciﬁcation (including $PROBLEM) for one<br>subject, with no $SUBROUTINES record or abbreviated code, but would include<br>
$DATA filename RECS=ID NOREWIND<br>
A fully worked-out example is supplied as recid2.exa (See <b>recid2.exa</b>).<br>
An alternate approach for single-subject data is available with NONMEM 7. OMEGA<br>diagonal values are ﬁxed to a special value 1.0E+06.<br>See Guide Introduction_7 &quot;Single-Subject Analysis using Population with Unconstrained<br>ETAs &quot;.<br>
EX-123<br>
<hr>
<A name=778></a>RECORDS ID<br>
EXAMPLES<br>
REFERENCES: Guide Introduction_7<br>
EX-124<br>
<hr>
<A name=779></a>Help Guide<br>
EXAMPLES RECORDS<br>
RECORDS=ID EXAMPLE 2<br>
This fully-worked out example shows how the RECORDS=ID option of $DAT A and the<br>INCLUDE statement may be used to analyze the Theophyline data set THEOPP as separate indi-<br>viduals. The NONMEM control ﬁle is as follows.<br>
$PROB THEOPHYLLINE POPULATION DATA; Analysis of Individuals<br>
; Modification of CONTROL5 control steam<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
$DATA THEOPP RECS=ID<br>
;RECS=ID: Data set will be read until ID changes or end-of-file<br>
$SUBROUTINES ADVAN2<br>
$PK<br>
;THETA(1)=MEAN ABSORPTION RATE CONSTANT (1/HR)<br>
;THETA(2)=MEAN ELIMINATION RATE CONSTANT (1/HR)<br>
;THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;SCALING PARAMETER=VOLUME/WT SINCE DOSE IS WEIGHT-ADJUSTED<br>
CALLFL=1<br>
KA=THETA(1)<br>
K=THETA(2)<br>
CL=THETA(3)*WT<br>
SC=CL/K/WT<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA .4<br>
;For single subject data OMEGA is residual variance.<br>
$ERROR<br>
Y=F+ERR(1)<br>
;ERR must be used instead of EPS.<br>
$EST MAXEVAL=450<br>
PRINT=5<br>
$COV SPECIAL<br>
;SPECIAL is required to obtain the variance-covariance matrix for<br>
;single-subject data.<br>
$TABLE ID DOSE WT TIME NOPRINT ONEHEADER FILE=indest.tab<br>
$TABLE ID KA K CL SC NOPRINT FIRSTONLY ONEHEADER NOAPPEND<br>
FILE=indest.par<br>
INCLUDE indest.txt 11<br>
; INCLUDE: Inserts copies of the file named indest.txt for each<br>
; additional individual.<br>
The contents of ﬁle indest.txt are:<br>
$PROB THEOPHYLLINE POPULATION DATA; Analysis of Individuals<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
EX-125<br>
<hr>
<A name=780></a>RECORDS ID<br>
EXAMPLES<br>
$DATA THEOPP RECS=ID NOREWIND<br>
;NOREWIND: data set will be read starting after the previous individual<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA .4<br>
;For single subject data OMEGA is residual variance<br>
$EST MAXEVAL=450<br>
PRINT=5<br>
$COV SPECIAL<br>
;SPECIAL is required to obtain the variance-covariance matrix for<br>
;single-subject data<br>
$TABLE ID DOSE WT TIME NOPRINT ONEHEADER FORWARD FILE=indest.tab<br>
$TABLE ID KA K CL SC NOPRINT FIRSTONLY ONEHEADER FORWARD NOAPPEND<br>
FILE=indest.par<br>
An alternate approach for single-subject data is available with NONMEM 7. OMEGA<br>diagonal values are ﬁxed to a special value 1.0E+06.<br>See Guide Introduction_7 &quot;Single-Subject Analysis using Population with Unconstrained<br>ETAs &quot;.<br>
REFERENCES: Guide Introduction_7<br>
EX-126<br>
<hr>
<A name=781></a>Help Guide<br>
EXAMPLES REPETITION 1<br>
REPETITION 1 EXAMPLE<br>
This example illustrates the use of the repetition feature, and in particular, the use of the<br>variables RPTI and RPTO. For a discussion of these reserved variables: (See <b>Repetition<br>Variables</b>).<br>
We suppose that a compartment amount A2 at time t1 is given by a convolution, i.e. an<br>integral with respect to s, of the product D(t1-s) and r(s), where D is a unit distribution<br>function, and r is an input function. The integral is taken from 0 to t1. The amount in<br>question can be computed by integrating the differential equation<br>
dA2/ds=D(t1-s)r(s)<br>
from time 0 to time t1. For A2 at a later time t2, one integrates a different differential<br>equation:<br>
dA2/ds=D(t2-s)r(s)<br>
from time 0 to time t2. This equation differs from the ﬁrst in so far as the constant t2,<br>rather than t1, is used in D.<br>
Ordinarily, PREDPP will use a system of differential equations<br>
dA2/ds=f(A2,t)<br>
to obtain the value of a vector A2 of compartment amounts at times t1 and t2, by ﬁrst<br>integrating the system to time t1, and then by integrating the same or different system<br>from time t1 to time t2. This scheme cannot be used with the two equations described<br>above, because the second equation - with the constant t2 - applies throughout the time<br>interval 0 to t1, as well as throughout the interval t1 to t2.<br>
PREDPP requires the event records to be ordered chronologically in the data set, and with<br>its ordinary usage with differential equations (described above), these records are pro-<br>cessed sequentially, starting with the ﬁrst event record (which, for the purposes of this<br>discussion, can be thought to have time 0). The records are passed sequentially to the PK<br>routine.<br>
The differential equations used for the convolution requires something special. During a<br>regular sequential pass of the event records to the PK routine, when a record R with time t<br>- at which compartment amounts are desired - is initially processed and passed to the PK<br>routine for the ﬁrst time, the routine should set the output variable RPTO to -1. This sig-<br>nals to NONMEM that the regular pass should be interrupted and a second pass of the<br>records should be initiated, starting with the ﬁrst event record once again and ending with<br>record R (thus the pass of <i>these </i>records is &quot;repeated&quot;). Only at the end of the second<br>pass, after <i>all </i>ev ent records up to and including record R have once again been passed,<br>will the value for A2(t) be established. The amounts at times on preceeding records have<br>already been established, and they remain unchanged as the pass of these records is<br>repeated. After R has been passed for the second time, the ﬁrst pass will be continued,<br>the next event record will be passed for the ﬁrst time, and RPTO can again be set to -1.<br>Whenever an event record is passed for the ﬁrst time, f(s) should be set to D(t-s)r(s),<br>where t is the time on the record, so that during the second pass, the differential equation<br>that is used is the desired one. When an event record is passed, if the input variable to the<br>
EX-127<br>
<hr>
<A name=782></a>REPETITION 1<br>
EXAMPLES Help Guide<br>
PK routine, RPTI, has the value 0, this signals that the record is not being passed as a part<br>of a repeated pass, and so this can be used as a signal that the record is being passed for<br>the ﬁrst time.<br>
Suppose the kinetic system is a two-compartment system where drug absorption from a<br>depot compartment into a sampling compartment occurs in a ﬁrst-order manner, and drug<br>elimination from the sampling compartment occurs according to a Weibull unit disposi-<br>tion function D(s)=exp(-K(s**c)). Suppose too that the superposition principle is<br>assumed to hold. So drug amount is given by a convolution. Suppose the event records<br>for an individual are simply structured, e.g.<br>
# TIME AMT DV<br>
EVID<br>
.0 10<br>
.<br>
1<br>
 <br>
rec 1<br>
.25 .<br>
2.44 0<br>
rec 2<br>
.5 .<br>
5.24 0<br>
rec 3<br>
.75 .<br>
5.57 0<br>
rec 4<br>
1<br>
.<br>
5.85 0<br>
rec 5<br>
Then the control stream should look like:<br>
$PROB<br>$INPT TIME AMT DV EVID<br>$DATA data<br>$SUB ADVAN6 TOL=5<br>$MODEL COMP=(DEPOT DEFDOSE) COMP=(CENTRAL DEFOBS)<br>
$INFN<br>IF (ICALL.EQ.0) RPTO=1<br>
;enables use of repetition feature<br>
$PK<br>KA=THETA(1)*EXP(ETA(1))<br>K =THETA(2)*EXP(ETA(2))<br>C =THETA(3)<br>V =THETA(4)*EXP(ETA(4))<br>S2=V<br>IF (RPTI.EQ.0) TI=TIME<br>IF (NEWIND.EQ.2) RPTO=-1<br>
$DES<br>DADT(1)=-KA*A(1)<br>D=EXP(-K*(TI-T)**C)<br>DADT(2)=D*KA*A(1)<br>
etc.<br>
Note that when TIME= 0.25, RPTO need not have been set to -1; after the second event<br>record has been passed for the ﬁrst time, the kinetics are advanced from time 0 to time<br>0.25 using TI=0.25.<br>
(1) The above is supplied as repeat1.ctl and repeat1.dat in the examples directory<br>
The code<br>IF (ICALL.EQ.0) RPTO=1<br>
;enables use of repetition fea-<br>
ture<br>is needed to inform NONMEM that the repetition feature will be used.<br>
The code<br>IF (NEWIND.EQ.2) RPTO=-1<br>initiates a pass starting with the ﬁrst event record, which is the default with RPTO=-1.<br>
EX-128<br>
<hr>
<A name=783></a>Help Guide<br>
EXAMPLES REPETITION 1<br>
(2) Another example, repeat1t.ctl, demonstates that a repeated pass may start with any<br>designated record, not necessarily the ﬁrst record. The statement<br>
IF (NEWIND.NE.2) RPTO=1<br>is used to indicate explicitly that the ﬁrst record is a repetition base.<br>
(3) Example repeat1s.ctl uses the RPT_ data item for the same purpose. This is<br>repeat1s.ctl and repeat1s.dat in the examples directory. A non-zero value of RPT_ marks<br>a record as a repetition base. A statement setting RPTO=-n (where n is the value of the<br>RPT_ data item) requests repetition starting with the marked record. When RPT_ is used,<br>it automatically enables use of the repetition feature and the $INFN block may be omit-<br>ted.<br>
The data is augmented with the RPT_ item, as in this fragment:<br># TIME AMT DV<br>
EVID RPT_<br>
1<br>
.0<br>
10<br>
.<br>
 <br>
1<br>
1<br>
rec 1<br>
1<br>
.25 .<br>
2.44 0<br>
.<br>
rec 2<br>
and the control stream contains<br>
$INPT ID TIME AMT DV EVID RPT_<br>
(4) A different example of the use of RPT_ is given in repeatf.ctl and repeatf.dat.<br>Reserved variables RPTO=n and RPTO=-n are intended to mark and repeat a sequence of<br>more than 1 data records. If only one record is to be repeated, RPT_ must be used. The<br>example computes the factorial of a value supplied as KRPT in the data record. A frag-<br>ment of the data is<br>
ID TIME DV<br>
MDV RPT_ KRPT<br>
1<br>
1<br>
 <br>
1<br>
0<br>
.<br>
.<br>
1<br>
2<br>
 <br>
2<br>
0<br>
1<br>
4<br>
The code sets<br>
IF (RPT_.EQ.1) RPTO=-1<br>
RPTON=KRPT<br>
NONMEM calls PRED KRPT+1 times for each record with RPT_=1. This allows the<br>factorial to be computed. This is intended as an illustration of what can be done using<br>RPT_ data item. With NONMEM 7.3, factorials can be computed more quickly using the<br>DOWHILE feature and the GAMLN function.<br>
REFERENCES: none.<br>
EX-129<br>
<hr>
<A name=784></a>REPETITION 2<br>
EXAMPLES Help Guide<br>
REPETITION 2 EXAMPLE<br>
This example illustrates the use of the repetition feature, and in particular, the use of the<br>PRED output control ﬂag PRDFL. For a discussion of the reserved variables RPTO,<br>RPTI and PRDFL: (See <b>Repetition Variables</b>).<br>
This example computes a variable RS to be output in a table, deﬁned as the difference<br>between the observation in the data record and the average observation in the individual<br>record. User-deﬁned tabled quantities are computed during a copying pass through the<br>data set - signaled by COMACT=1 (See <b>comact</b>). In this example, during the copying<br>pass, the data records in each individual record are actually passed twice; the average is<br>computed during a ﬁrst pass through the individual record - signaled by RPTI=0, and the<br>difference is computed during a second (repeated) pass - signaled by RPTO=1.<br>
$PRED<br>Y=...<br>IF (COMACT.EQ.0) PRDFL=1<br>IF (ICALL.EQ.0) THEN<br>
RPTO=1 ;initiates use of repetition feature<br>PRDFL=1 ;initiates use of the PRED output control flag<br>N=0<br>AV=0<br>
ENDIF<br>IF (COMACT.EQ.1) THEN<br>
IF (RPTI.EQ.0.AND.NEWIND.LE.1) THEN<br>
N=0<br>AV=0<br>
ENDIF<br>IF (RPTI.EQ.0.AND.MDV.EQ.0) THEN<br>
N=N+1<br>AV=AV+DV<br>
ENDIF<br>IF (RPTI.EQ.1) THEN<br>
RS=0<br>PRDFL=1<br>
ENDIF<br>IF (RPTI.EQ.1.AND.MDV.EQ.0) RS=DV-AV<br>IF (NDREC.EQ.LIREC) THEN<br>
RPTO=-1 ;RPTO=-1 is a signal initiating<br>
;a second pass. As RPTON isn’t also set,<br>;there are no further passes.<br>
AV=AV/N<br>
ENDIF<br>
ENDIF<br>
$TABLE RS NOAPPEND<br>
The variable NDREC contains the index of the current data record within the current<br>individual record, and LIREC contains the index of the last data record within the current<br>individual record. (See <b>Record Counters: NIREC,NDREC</b>)<br>(See <b>Size of Individual Record</b>).<br>If a data record does not contain an observation (i.e. MDV=1), this code sets RS to 0.<br>
If a variable is to be used only during a copying pass, but recursively across data records<br>(such as N and AV), then it should be deﬁned in an initialization block (e.g. at<br>ICALL.EQ.0). Setting PRDFL=1 during a noncopying pass, assures that during such<br>passes, PRED output will be accepted in the usual way: data record by data record.<br>
EX-130<br>
<hr>
<A name=785></a>Help Guide<br>
EXAMPLES REPETITION 2<br>
Setting PRDFL=1 during a copying pass, but only with the second pass through the data<br>records, assures that PRED output (which includes the RS variable) will be accepted data<br>record by data record, but only during the repeated pass.<br>
REFERENCES: none.<br>
EX-131<br>
<hr>
<A name=786></a>SIMULATION 1<br>
EXAMPLES Help Guide<br>
SIMULATION 1 EXAMPLE<br>
This is an example of simulation with population data. The presence of the $SIMULA-<br>TION record causes NONMEM to generate DV data items. The data set in ﬁle<br>SIMORIG may contain nulls in the DV column.<br>
Table ﬁle SIMDAT A1 is created. It is similar to SIMORIG, except that the DV column<br>contains the simulated observations. Because of the option NOHEADER of $TABLE, ta-<br>ble header lines are not present, and, with the option NOPRINT, the table is not included<br>in the NONMEM output report. SIMDAT A1 can be used in subsequent runs as an input<br>ﬁle for NONMEM analysis without further modiﬁcation. These runs can involve differ-<br>ent initial estimates, different models, etc.<br>
$PROBLEM Simulation of population data<br>
$INPUT ID TIME WT AMT DV<br>
$DATA SIMORIG IGNORE=#<br>
$SUBROUTINE ADVAN1<br>
$PK<br>
CL=THETA(1)*EXP(ETA(1))<br>
V=THETA(2)*EXP(ETA(2))<br>
K=CL/V<br>
S1=V<br>
$ERROR<br>
Y=F+F*EPS(1)<br>
$THETA .0625 10<br>
$OMEGA .09 .05<br>
$SIGMA .01<br>
$SIMULATION (9215690) ; seed 1-7 digits<br>
$TABLE ID TIME WT AMT NOPRINT FILE=SIMDATA1 NOHEADER<br>
Contents of SIMORIG (for the ﬁrst two individuals) follow.<br>
#<br>
ID TIME WT AMT DV<br>
1<br>
0<br>
80 100<br>
.<br>
1<br>
1<br>
80 .<br>
.<br>
2<br>
0<br>
75 100<br>
.<br>
2<br>
2<br>
75 .<br>
.<br>
Contents of SIMDAT A1 follow, with ﬂoating-point notation converted to ﬁxed-point<br>notation for the convenience of the reader. With versions of NONMEM prior to 7.4, this<br>help item contained an incorrect set of values. The correct values are as follows.<br>
1. 0.<br>
80. 100.<br>
0.000 10.000<br>
0.000 0.000<br>
1. 1.<br>
80. 0.<br>
13.646 9.938 3.708 1.531<br>
2. 0.<br>
75. 100.<br>
0.000 10.000<br>
0.000 0.000<br>
2. 2.<br>
75. 0. 8.379 9.876<br>
-1.496 -0.625<br>
The last four columns are automatically included by NONMEM in every table (unless the<br>NOAPPEND option is used). They are: DV (simulated values), PRED (calculated using<br>zeros for etas and epsilons), RES, and WRES. The DV, RES, and WRES colunns are<br>zero for dose event records. The last three columns may be ignored (or the DROP option<br>of $INPUT may be used) when the ﬁle is subsequently used. Alternately, list DV on the<br>$TABLE record, and include the option NOAPPEND.<br>
EX-132<br>
<hr>
<A name=787></a>Help Guide<br>
EXAMPLES SIMULATION 1<br>
It is possible to display simulated values of PRED-deﬁned variables. With NM-TRAN,<br>simulated etas are automatically displayable.<br>
Add the following to the $ERROR block to capture simulated epsilons as ERROR-<br>deﬁned items:<br>
EP1=EPS(1)<br>
One may change the $SIMULATION and $TABLE records as follows.<br>
$SIMULATION (9215690) ONLYSIM<br>
$TABLE ID TIME WT AMT CL V ETA1 ETA2 EP1<br>
NOPRINT FILE=SIMDATA1 NOHEADER<br>
Displayed values of CL, V, ETA1, ETA2, and EP1 are simulated values. Without the<br>ONLYSIM option of $SIMULATION, the displayed values are typical values.<br>
(See <b>Simulation example 2</b>, <b>Simulation example 3</b>).<br>
REFERENCES: Guide IV, section III.B.13 , IV.I<br>REFERENCES: Guide V, section 12.4.8<br>REFERENCES: Guide VI, section III.C , III.E , IV.B , IV.G.1<br>
EX-133<br>
<hr>
<A name=788></a>SIMULATION 2<br>
EXAMPLES Help Guide<br>
SIMULATION 2 EXAMPLE<br>
This is an example of simulation with population data. It is a continuation of Simulation<br>Example 1.<br>
First, during the Simulation Step, values of the covariate WT are simulated, as well as<br>DV values, as PK-deﬁned items SIMWT. Normally-distributed values of ETA(3) are<br>used. Values of CL are calculated based on SIMWT. SIMWT replaces WT in the table<br>ﬁle, and, because the ONLYSIM option is used, tabled values of SIMWT are simulated<br>values.<br>
Second, this process is repeated 10 times, using the same model, by means of the SUB-<br>PROBLEMS option. The table ﬁle contains the concatenated output of all the subprob-<br>lems, and is the simulated data for 20 individuals.<br>
$PROBLEM Simulation of population data and weight<br>
$INPUT ID TIME WT AMT DV<br>
$DATA SIMORIG IGNORE=#<br>
$SUBROUTINE ADVAN1<br>
$PK<br>
SIMWT=70+70*ETA(3)<br>
CL=THETA(1)*SIMWT*EXP(ETA(1))<br>
V=THETA(2)*EXP(ETA(2))<br>
K=CL/V<br>
S1=V<br>
$ERROR<br>
Y=F+F*EPS(1)<br>
$THETA .0625 10<br>
$OMEGA .09 .05 .04<br>
$SIGMA .01<br>
$SIMULATION (9215690) ONLYSIM SUBPROBLEMS=10<br>
$TABLE ID TIME SIMWT AMT NOPRINT FILE=SIMDATA2 NOHEADER<br>
SIMORIG is the same as with Simulation Example 1. Contents of SIMORIG (for the<br>ﬁrst two individuals) follow.<br>
#<br>
ID TIME WT AMT DV<br>
1<br>
0<br>
80 100<br>
.<br>
1<br>
1<br>
80 .<br>
.<br>
2<br>
0<br>
75 100<br>
.<br>
2<br>
2<br>
75 .<br>
.<br>
Contents of SIMDAT A2 follow, with ﬂoating-point notation converted to ﬁxed-point for<br>the convenience of the reader.<br>
1. 0.<br>
77.486 100.<br>
0.000 10.000<br>
0.000 0.000<br>
1. 1.<br>
77.486 0. 6.825 6.457 0.369 0.000<br>
2. 0.<br>
72.882 100.<br>
0.000 10.000<br>
0.000 0.000<br>
2. 2.<br>
72.882 0. 3.515 4.169<br>
-0.653 0.000<br>
REFERENCES: Guide IV, section III.B.13 , IV.I<br>REFERENCES: Guide V, section 12.4.8<br>REFERENCES: Guide VI, section III.C , III.E , IV.B , IV.G.1<br>
EX-134<br>
<hr>
<A name=789></a>Help Guide<br>
EXAMPLES SIMULATION 3<br>
SIMULATION 3 EXAMPLE<br>
This is an example of simulation and estimation within the same NONMEM run. It is a<br>continuation of Simulation Example 2.<br>
As in Simulation Example 2, values of the covariate WT are simulated during the Simula-<br>tion Step. They also replace the original WT values in NONMEM’s internal copy of the<br>data set. This transgeneration makes them available in the Estimation and Table Steps.<br>
There are two models for V, illustrating the use of diferent models in the Simulation and<br>Estimation Steps:<br>
(simulated V) VS = THETA(2) * EXP(ETA(3))<br>(non-simulated V) VN = THETA(3) + ETA(4)<br>
There are two epsilons in the $ERROR block, illustrating the use of an of using an initial<br>estimate for estimation different from the value used to simulate.<br>
Because theta(2), eta(2), eta(3) and eps(1) are used only in the Simulation Step, the<br>FIXED attribute is speciﬁed for theta(2), omega(2,2), omega(3,3) and sigma(1,1) during<br>the Estimation Step.<br>
$PROBLEM Simulation of population data w/ covariates<br>
$INPUT ID TIME WT AMT DV<br>
$DATA SIMORIG IGNORE=#<br>
$SUBROUTINE ADVAN1<br>
$PK<br>
IF (ICALL.EQ.4) THEN<br>
WT=70+70*ETA(3)<br>
ENDIF<br>
CL=THETA(1)*WT*EXP(ETA(1))<br>
IF (ICALL.EQ.4) THEN<br>
V=THETA(2)*EXP(ETA(2)) ; Simulated V<br>
ELSE<br>
V=THETA(3)+ETA(4) ; Non-simulated V<br>
ENDIF<br>
K=CL/V<br>
S1=V<br>
$ERROR<br>
IF (ICALL.EQ.4) THEN<br>
Y=F+F*EPS(1)<br>
ELSE<br>
Y=F+F*EPS(2)<br>
ENDIF<br>
$THETA (0,.0625) (10 FIX) (0,12)<br>
$OMEGA .09 (.05 FIX) (.04 FIX) 4<br>
$SIGMA (.01 FIX) .03<br>
$SIMULATION (9215690) SUBPROBLEMS=10<br>
$ESTIMATION<br>
$TABLE ID TIME WT AMT NOPRINT FILE=SIMDATA3 NOHEADER<br>
REFERENCES: Guide IV, section III.B.13 , IV.I<br>REFERENCES: Guide V, section 12.4.8<br>
EX-135<br>
<hr>
<A name=790></a>SIMULATION 3<br>
EXAMPLES Help Guide<br>
REFERENCES: Guide VI, section III.C , III.E , IV.B , IV.G.1<br>
EX-136<br>
<hr>
<A name=791></a>Help Guide<br>
EXAMPLES STIELTJES<br>
STIELTJES EXAMPLE<br>
The following are examples of the speciﬁcation of the Stieltjes method.<br>
$EST PRINT=1 MET=1 STIELTJES<br>
$EST MAX=9999 METH=1 LAPLACE LIKE PRINT=1 STIELTJES<br>
$EST MAX=9999 METH=1 LAPLACE LIKE PRINT=1 STIELTJES GRID=(9,10,.1,.9)<br>
$EST MAX=500 MET=COND LAPLACE LIKE STIELTJES GRID=(20,2,.1,.9)<br>
REFERENCES: Guide Introduction_7<br>
EX-137<br>
<hr>
<A name=792></a>STOCHASTIC EXAMPLES<br>
Help Guide<br>
STOCHASTIC DIFFERENTIAL EQUATION EXAMPLES<br>
A number of examples are given of the use of Stochastic Differential Equations.<br>
sde6<br>
Example problem without sde<br>
sde7<br>
Example problem with SDE, using expanded data set that have repeated lines to re-<br>invoke PRED several times for each data record.<br>
sde8<br>
Use of XVID to re-invoke PRED several times per data record wthout requiring the<br>redundancy of sde7.csv.<br>
sde9<br>
Alternative method of sde programming, using add-on sde.f90<br>
They, along with the data ﬁles, can be found in the examples directory of the NONMEM<br>7 distribution medium.<br>
See <b>INTRODUCTION TO NONMEM 7, Repeated Observation Records<br></b>See <b>INTRODUCTION TO NONMEM 7, Stochastic Differential Equation Plug-In</b><br>
REFERENCES: Guide Introduction_7<br>
EX-138<br>
<hr>
<A name=793></a>Help Guide<br>
EXAMPLES SUPERPROBLEM 1<br>
SUPERPROBLEM 1 EXAMPLE<br>
There are four problems:<br>
Problem 1: The (true) probability that with an individual chosen at random, after a 200<br>mg dose, the true concentration at 5 hrs is above 5, is computed using simulation.<br>Problem 2: A population data set is simulated.<br>Problem 3: Parameter estimates are obtained.<br>Problem 4: The probability in question is estimated, using simulation and the parameter<br>estimates obtained in problem 3.<br>
Problems 2-4 comprise a superproblem. The bias in the estimator deﬁned by problem 4<br>is estimated by iterating this superproblem.<br>
$PROB COMPUTE PERCENTAGE OF POP. WITH CP&gt;5 AT DOSE=200, TIME=5<br>$INPUT ID TIME DOSE DV<br>$DATA dataB<br>$PRED<br>IF (ICALL.EQ.0) THEN<br>
BIAS=0 ; initialize<br>TRUE=0<br>OPEN (50,FILE=’BIAS’) ; Give the output file a name<br>
ENDIF<br>IF (ICALL.EQ.1) THEN<br>
IF (IPROB.EQ.1.OR.IPROB.EQ.4) N=0<br>
; see rocm14<br>
CALL SUPP (1,1)<br>
ENDIF<br>
KA=THETA(1)*EXP(ETA(1))<br>KE=THETA(2)*EXP(ETA(2))<br>V=THETA(3)*EXP(ETA(3))<br>A=EXP(-KE*TIME)<br>B=EXP(-KA*TIME)<br>C=KA-KE<br>D=A-B<br>E=KA*DOSE/(V*C)<br>F=E*D<br>Y=F+ERR(1)<br>
IF (ICALL.EQ.4) THEN<br>
IF (IPROB.EQ.1.OR.IPROB.EQ.4) THEN<br>
IF (F.GT.5) N=N+1<br>IF (IREP.EQ.NREP) THEN<br>
; see rocm10<br>
PER=100.*N/NREP<br>IF (IPROB.EQ.1) TRUE=PER<br>IF (IPROB.EQ.4) THEN<br>
BIAS=BIAS+(PER-TRUE)/TRUE<br>IF (S1IT.EQ.S1NIT) THEN<br>
BIAS=BIAS/S1NIT<br>WRITE (50,*) BIAS<br>
ENDIF<br>
ENDIF<br>
ENDIF<br>
ENDIF<br>
ENDIF<br>$THTA (.4,1.7,7) (.025,.102,.4) (10,29,80)<br>$OMEGA .04 .04 .04<br>$SIGMA 1.5<br>$SIM (5566898) ONLY SUB=1000<br>
EX-139<br>
<hr>
<A name=794></a>SUPERPROBLEM 1<br>
EXAMPLES Help Guide<br>
;<br>$SUPER SCOPE=3 ITERATIONS=10<br>$PROB SIMULATION<br>$INPUT ID TIME DOSE DV<br>$DATA dataA<br>$THTA (.4,1.7,7) (.025,.102,.4) (10,29,80)<br>$OMEGA .04 .04 .04<br>$SIGMA 1.5<br>$SIM (-1) ONLY<br>$TABLE ID TIME DOSE DV FILE=simulation NOHEADER NOPRINT NOFORWARD<br>;<br>$PROB ESTIMATION<br>$INPUT ID TIME DOSE DV<br>$DATA simulation (4E12.0) NRECS=500 NOOPEN<br>$THTA (.4,1.7,7) (.025,.102,.4) (10,29,80)<br>$OMEGA .04 .04 .04<br>$SIGMA 1.5<br>$EST PRINT=0 MSFO=msf<br>;<br>$PROB ESTIMATE PERCENTAGE OF POP. WITH CP&gt;5 AT DOSE=200, TIME=5<br>$INPUT ID TIME DOSE DV<br>$DATA dataB<br>$MSFI msf<br>$SIM (-1) ONLY SUB=100 TRUE=FINAL<br>
Comments:<br>
(1) Variables whose values are to be retained across problems (e.g. BIAS and<br>TRUE) should be deﬁned in initialization blocks. In this instance these variables are<br>deﬁned at ICALL=0, before any of the problems are implemented<br>
(2) IREP and NREP are the number of the current replication and number of<br>requested replications for the Simulation Step, respectively.<br>
(3) S1IT and S1NIT are the number of the current iteration and number of requested<br>iterations for the (level 1) superproblem, respectively.<br>
(4) Problems 2 &amp; 3 can, of course, be combined, making the control stream much<br>simpler. But separation can sometimes be useful, and here we illustrate how this can<br>be done.<br>
(5) The data set of problem 3 can be taken to be the internal data set created with<br>problem 2 simply by removing both the $TABLE record of problem 2 and the<br>$DAT A record of problem 3. But these records are included here to illustrate the<br>ability to use a table ﬁle as a data ﬁle in a subsequent problem of the same run.<br>When so doing, all the items in the $INPUT record of the subsequent problem<br>should be included in the $INPUT record of the problem with the $TABLE record.<br>(If a PRED-item in the table is to be used in the subsequent problem as a data item,<br>the PRED-item name can be different from the data item name.) The FORMAT and<br>NOOPEN options should be included in the $DAT A record of the subsequent prob-<br>lem. The NRECS option is not needed, but if it is also included, it should be set to<br>the number of records in the table ﬁle, i.e. to the number of data records in data set<br>A (assumed here to be 500).<br>
Contents of dataA (for individual 1 only) follow:<br>
1<br>
.27 320. .<br>
1<br>
.52 320. .<br>
1<br>
1.<br>
320. .<br>
1<br>
1.92 320. .<br>
EX-140<br>
<hr>
<A name=795></a>Help Guide<br>
EXAMPLES SUPERPROBLEM 1<br>
1<br>
3.5 320.<br>
.<br>
1<br>
5.02 320. .<br>
1<br>
7.03 320. .<br>
1<br>
9.<br>
320. .<br>
1<br>
12. 320.<br>
.<br>
1<br>
24.3 320.<br>
.<br>
This data set cannot be run as-is. File dataA must include more subjects. If not, the esti-<br>mation step in problem 3 will not terminate correctly. The ﬁnal problem will produce the<br>message:<br>
THE SIMULATION TASK REQUIRES THAT A BETTER FINAL ESTIMATE<br>
BE AVAILABLE IN THE MODEL SPECIFICATION FILE<br>
OR<br>
MULTIPLE SUB_PROBLEMS IS INCOMPATIBLE WITH OTHER INFORMATION<br>
IN THE CONTROL STREAM AND INPUT MSF<br>
This error message is related to an earlier message<br>
PARAMETER ESTIMATE IS NEAR ITS BOUNDARY<br>
THIS MUST BE ADDRESSED BEFORE THE COVARIANCE STEP CAN BE IMPLEMENTED<br>
A larger version of dataA can be found in the examples directory of the NONMEM distri-<br>bution medium. The content of dataA above is replicated 28 times. ID values 1 and 2<br>alternate so that there are 28 subjects.<br>
Contents of dataB follow:<br>
1<br>
5.0 200.<br>
.<br>
Comments on NONMEM 7 changes:<br>
In this example as distributed with earlier versions of NONMEM, the WRITE state-<br>ment speciﬁed unit 42:<br>
WRITE (42,*) BIAS<br>
With NONMEM 7, this must be changed to<br>
WRITE (50,*) BIAS<br>
This avoids a possible NONMEM error message<br>
FORTRAN UNIT BEING OPENED OR CLOSED IN PROBLEM<br>
1 IS OUTSIDE<br>
ACCEPTABLE RANGE (50-2000)<br>
A new statement is added:<br>
OPEN (50,FILE=’BIAS’)<br>
This causes the output to be written to a ﬁle named BIAS rather than fort.50 or the<br>like.<br>
REFERENCES: None.<br>
EX-141<br>
<hr>
<A name=796></a>SUPERPROBLEM 2<br>
EXAMPLES Help Guide<br>
SUPERPROBLEM 2 EXAMPLE<br>
Tw o problems, in order to effect a standard two-stage analysis:<br>
Problem 1: First stage analysis<br>Problem 2: Obtain simple population average of PK parameter.<br>
Problem 2 comprises a superproblem. It is implemented once for CL and once for V, and<br>can be implemented more times when there are more parameters of interest.<br>
$PROBLEM TWO-STAGE<br>
STAGE 1<br>
$DATA dataD<br>$INPUT ID DOSE TIME DV=CP<br>$PRED<br>IF (IPROB.EQ.1.AND.NEWIND.LE.1) D=DOSE<br>IF (IPROB.EQ.1) THEN<br>
CL=THETA(1)*EXP(ETA(1))<br>V =THETA(2)*EXP(ETA(2))<br>K=CL/V<br>F=D*EXP(-K*TIME)/V<br>Y=F+F*EXP(ETA(3))*ERR(1)<br>
ENDIF<br>IF (ICALL.EQ.4) THEN<br>; if S1IT &gt;= 1 then problem 2 is being implemented.<br>; see comment 1 below.<br>
IF (S1IT.GE.1) THEN<br>
&quot;<br>
IF (S1IT.EQ.1) DPV=DATREC(2)<br>
&quot;<br>
IF (S1IT.EQ.2) DPV=DATREC(3)<br>Y=DPV<br>RETURN<br>
ENDIF<br>
ENDIF<br>IF (S1IT.EQ.1) Y=THETA(1)+ERR(1)<br>IF (S1IT.EQ.2) Y=THETA(2)+ERR(2)<br>$THETA 5 50<br>$OMEGA 100 100 100<br>$SIGMA 1 FIX 0 FIX<br>$ESTIMATION MAXEVAL=0 POSTHOC METH=COND INTERACTION<br>$TABLE ID CL V<br>
FILE=stage2 NOHEADER NOPRINT FIRST NOFORWARD<br>
;<br>$SUPER SCOPE=1 ITERATION=2<br>$PROBLEM TWO-STAGE<br>
STAGE 2<br>
$INPT ID CLI VI DV<br>$DATA stage2 (4F12.0) NRECS=12 REWIND NOOPEN<br>$THETA 5 50<br>$OMEGA 0 FIX 0 FIX 0 FIX<br>$SIGMA 1 1<br>$SIMULATION (1)<br>$ESTIMATION ;population estimates are obtained<br>
Comment:<br>
(1) The simulation step in problem 2 is used to select the DV data item from one of<br>the several possibilities (CL or V) output by problem 1.<br>
(2) Using generated code, data item names that do not appear in the $INPUT record<br>of problem 1, such as CLI and VI, cannot be used in abbreviated or verbatim code.<br>DATREC is a vector-array of data items that can be referenced in verbatim code.<br>
EX-142<br>
<hr>
<A name=797></a>Help Guide<br>
EXAMPLES SUPERPROBLEM 2<br>
Contents of dataD (for individual 1 only) follow.<br>
1.000 4.020 0.000 0.091<br>
1.000 0.000 0.250 0.084<br>
1.000 0.000 0.570 0.105<br>
1.000 0.000 1.120 0.057<br>
1.000 0.000 2.020 0.038<br>
1.000 0.000 3.820 0.060<br>
1.000 0.000 5.100 0.046<br>
1.000 0.000 9.050 0.017<br>
1.000 0.000 7.030 0.024<br>
1.000 0.000 12.120 0.018<br>
1.000 0.000 24.370 0.002<br>
REFERENCES: None.<br>
EX-143<br>
<hr>
<A name=798></a>TDM EXAMPLES<br>
Help Guide<br>
TDM EXAMPLE<br>
This is an example of how F1 can be used to simplify the preparation of a data ﬁle when<br>the dose is changed often, e.g., for Therapeutic drug monitoring (TDM).<br>
Suppose the dosing pattern is consistent (e.g., every 12 hours) but the amount changes<br>often. Suppose also there are observation events at various times.<br>
In the following data set, there is only one dose record having AMT=1. ADDL and II are<br>used to specify an (effectively inﬁnite) number of additional doses, every 12 hours.<br>When the dose amount changes, it is sufﬁcient to supply a record giving the new dose<br>amount in the DOSE data item. Such records have EVID=2. There is no need to inter-<br>rupt the dosing pattern for an observation event, or to count the number of doses between<br>observation events.<br>
Suppose a fragment of the dose records looks like this:<br>
ID DAT1=DROP<br>
TIME EVID DV DOSE<br>
AMT II<br>
ADDL<br>
1<br>
01.01.2008 20 1<br>
0<br>
4<br>
1<br>
12<br>
99999<br>
1<br>
03.01.2008 8<br>
0<br>
6.1 0<br>
0<br>
0<br>
 <br>
0<br>
1<br>
04.01.2008 8<br>
0<br>
7.6 0<br>
0<br>
0<br>
 <br>
0<br>
1<br>
04.01.2008 20 2<br>
0<br>
3<br>
0<br>
0<br>
 <br>
0<br>
1<br>
06.01.2008 8<br>
0<br>
5.4 0<br>
0<br>
0<br>
 <br>
0<br>
Here is a fragment of the control stream:<br>
$INPUT ID DAT1=DROP TIME EVID DV DOSE AMT II ADDL<br>
...<br>
$PK (ADDITIONAL OR LAGGED)<br>
...<br>
IF (DOSE&gt; 0) SAVEDOSE=DOSE<br>
F1=SAVEDOSE<br>
In $PK, the value of DOSE is saved, and used on subsequent calls to PK as the value of<br>F1. Although F1 is usually used to model the bio-availability of doses to compartment 1,<br>in this example it is the actual dose amount.<br>
REFERENCES: Guide V, section 7.4.4<br>
EX-144<br>
<hr>
<A name=799></a>Help Guide<br>
EXAMPLES THREE COMPARTMENT<br>
THREE COMPARTMENT EXAMPLE<br>
This example shows how to implement a three Compartment Linear Model with First-<br>order Absorption using PREDPP, where elimination occurs from a central compartment<br><i>and </i>one of two peripheral compartments.<br>
As with any ADVAN, one or more doses could be input to any of the compartments.<br>Steady state doses are also possible.<br>
The use of the DEFDOSE attribute on the following $MODEL record speciﬁes that if the<br>CMT data item is null on a given dose event record, then the dose(s) speciﬁed by that<br>record are to be placed in the depot compartment. The use of the INITIALOFF attribute<br>speciﬁes that the depot compartment is to be off until a dose is placed in it.<br>
The use of the DEFOBS attribute on the $MODEL record speciﬁes that if the CMT data<br>item is null on a given observation event record, then the quantity F which is available as<br>a right-hand quantity in $ERROR is to be the scaled drug amount in the central compart-<br>ment. (See <b>CMT PCMT data item</b>).<br>
$PROBLEM EXAMPLE OF A THREE COMPARTMENT MODEL WITH ABSORPTION<br>
$INPUT ID TIME AMT DV CMT<br>
$DATA datafile<br>
$SUBROUTINES ADVAN7<br>
$MODEL COMP = (DEPOT,DEFDOSE,INITIALOFF)<br>
COMP = (CENTRAL,DEFOBS)<br>
COMP = PERIPH1,<br>
COMP = PERIPH2<br>
$PK<br>
K12 = THETA(1)*EXP(ETA(1))<br>
; depot to central<br>
K23 = THETA(2)<br>
; central to periph1<br>
K32 = THETA(3)<br>
; periph1 to central<br>
K30 = THETA(4)*EXP(ETA(2))<br>
K24 = THETA(5)<br>
; central to periph2<br>
K42 = THETA(6)<br>
; periph2 to central<br>
K20 = THETA(7)*EXP(ETA(3))<br>
; elimination from central<br>
S2 = THETA(8)*EXP(ETA(4)) ; scale for central<br>
;There are other reasonable ways that etas can be assigned.<br>
;Elaborate these expressions for the K’s as is appropriate.<br>
;Add $ERROR, parameter and task records as is necessary/desired.<br>
Other parameterizations are possible, as long as the above set of micro-constants is<br>deﬁned. E.g., the deﬁnitions of K20 and S2 can be replaced by the following.<br>
CL = THETA(7)*EXP(ETA(3))<br>
V<br>
= THETA(8)*EXP(ETA(4))<br>
K20 = CL/V<br>
S2 = V<br>
If the depot compartment is not needed, it can be omitted. The numberings of the com-<br>partments, the thetas and etas must then be adjusted.<br>
REFERENCES: Guide VI, section VII.C.5 , VII.C.7<br>
EX-145<br>
<hr>
<A name=800></a>TIME EXAMPLES<br>
Help Guide<br>
TIME AFTER DOSE (TAD) EXAMPLE<br>
This fully-worked out example shows how Time After Dose (TAD) may be computed in $PK<br>abbreviated code. It works with transient and steady-state doses, and also with additional and<br>lagged doses.<br>
It is based on suggestions from the NONMEM tip directory<br>
https://nonmem.iconplc.com/nonmem/tips<br>
tip3-2-25-02.txt<br>tip4-3-04-02.txt<br>tip4update-10-11-13.txt<br>
but is not identical to any of them. See updates to these tips for nonmem 7.4.2.<br>
$PROB Based on RUN# 705 nonmem coding challenge #1<br>
$INPUT C ID TIME DV AMT WT AGE CRCL SMK ADDL II EVID<br>
$DATA 704.csv IGNORE=C<br>
$SUBROUTINE ADVAN2 TRANS2<br>
$PK<br>
; initialize for new individual or reset record<br>
IF (NEWIND.LT.2.OR.EVID.EQ.3) THEN<br>
TDOS=-999 ; Time of most recent dose. -999 if no previous dose.<br>
TAD=0 ; Time After Dose<br>
ENDIF<br>
;<br>
ALAG1=0 ;<br>
ALAG1 could be set to another value<br>
;<br>
; record TDOS (time of last dose) and compute TAD (time after dose)<br>
; General case: ADDL doses and ALAG may be modelled<br>
IF (EVID.EQ.1.and.ALAG1.EQ.0.OR.EVID.EQ.4.and.ALAG1.EQ.0) TDOS=TIME<br>
IF (DOSTIM.GT.0) TDOS=DOSTIM<br>
IF (TDOS.GT.-999) TAD=TIME-TDOS<br>
; If no ALAG or ADDL doses, the above three lines become:<br>
;<br>
IF (EVID.EQ.1.OR.EVID.EQ.4) TDOS=TIME<br>
;<br>
IF (TDOS.GT.-999) TAD=TIME-TDOS<br>
CL=THETA(1)*EXP(ETA(1))<br>
TVV=THETA(2)<br>
V=TVV*EXP(ETA(2))<br>
TVKA=THETA(3)<br>
KA=TVKA*EXP(ETA(3))<br>
S2=V<br>
$THETA<br>
(0, 10)<br>
(0, 100)<br>
(0, 0.5)<br>
$ERROR<br>
Y=F+ERR(1)<br>
IPRED=F<br>
$OMEGA<br>
EX-146<br>
<hr>
<A name=801></a>Help Guide<br>
EXAMPLES TIME<br>
0.04 ;[P] INTERIND VAR IN CL<br>
0.04 ;[P] INTERIND VAR IN V<br>
0.04 ;[P] INTERIND VAR IN KA<br>
$SIGMA<br>
0.2 ;[A] ADDITIVE COMPONENT<br>
$EST MAXEVAL=0 PRINT=2 NOABORT ;POSTHOC<br>
$TABLE ID TIME EVID TDOS TAD IPRED<br>
NOAPPEND NOPRINT ONEHEADER FILE=tadexa.tab<br>
FORMAT=SF11.7<br>
The data for the ﬁrst subject is:<br>
C,Data Desc: test of TAD for ADDL,,,,,,,,,,<br>
C,ID,TIME,DV,AMT,WT,AGE,CRCL,SMK,ADDL,II,EVID<br>
,1,0,0,0,58.4,51,4.49,1,0,0,2<br>
,1,0.1,0,500,58.4,51,4.49,1,1,24,1<br>
,1,1.1,1.67538,0,58.4,51,4.49,1,0,0,0<br>
,1,4.1,2.79283,0,58.4,51,4.49,1,0,0,0<br>
,1,10.1,0.583263,0,58.4,51,4.49,1,0,0,0<br>
,1,24.1,0.146255,0,58.4,51,4.49,1,0,0,0<br>
,1,25.1,1.67538,0,58.4,51,4.49,1,0,0,0<br>
The complete data set may be found in the tip directory.<br>
Note 1.<br>
It is assumed that TAD is displayed in tables for the purpose of graphical display of<br>the data. It is not a random variables, and is not intended to be part of the prediction<br>model.<br>
Note 2.<br>
If there are non-dose records prior to the ﬁrst dose record of the Individual record,<br>TAD is set to zero for these records. These is an arbitrary conventions; the user<br>could use different values, especially if these conditions might signal an error in the<br>data set.<br>
Note 3.<br>
ALAG1 is used in the example, but a different dosing compartment could be used,<br>e.g., ALAG2 for doses into compartment 2. The code would need modiﬁcation to<br>compute TAD for doses into two or more compartments.<br>
Note 4.<br>
This code can handle random DOSTIM (Eta on ALAG or ETA on modelled duration<br>or rate.)<br>
Note 5.<br>
The code does not use INFN. The information is developed with passes through the<br>data set at ICALL=2, in which NONMEM calls PREDPP. If INFN is used,<br>PREDPP is not called. The abbreviated code would have to account for additional<br>and lagged dose times.<br>
Note 6.<br>
TDOS=-999 until the ﬁrst dose. TDOS=0 when the ﬁrst dose is at TIME 0. This<br>makes it possible to dispense with a ﬂag variable whose only function is to say &quot;a<br>dose has occurred&quot;. If there are negative time values in the data set and any time<br>value is smaller than -999, then<br>
EX-147<br>
<hr>
<A name=802></a>TIME EXAMPLES<br>
Help Guide<br>
Note 7.<br>
The code is intended to compute TAD for multiple individual doses or one initiating<br>dose. (An initiating dose has ADDL&gt;0,II&gt;0).<br>
REFERENCES: None<br>
EX-148<br>
<hr>
<A name=803></a>Help Guide<br>
EXAMPLES TNPRI<br>
TNPRI EXAMPLES<br>
These examples illustrate the use of the NONMEM utility routine TNPRI by the NM-<br>TRAN $PRIOR record, and also by an equivalent user-supplied routine PRIOR. For a<br>discussion of PRIOR: (See <b>prior</b>). For a discussion of the TNPRI: (See <b>tnpri</b>).<br>
Example 1<br>
Use of PRIOR and TNPRI and a control stream for population data:<br>
This example obtains parameter estimates from population data, using a two-compart-<br>ment PK model, and it incorporates a frequentist prior of transformed normal form for all<br>of THETA, OMEGA and SIGMA. The prior information is found in model speciﬁcation<br>ﬁle msf1.<br>
$PROB READ THE MODEL SPECIFICATION FILE<br>$DATA data<br>$INPUT ID DOSE TIME DV WT<br>$PRIOR TNPRI (PROBLEM 2)<br>$MSFI msf1 ONLYREAD<br>$PRED<br>;<br>;<br>
THETA(1)=MEAN ABSORPTION RATE CONSTANT - MEAN ELIM. RATE CONSTANT (l/HR)<br>
;<br>
THETA(2)=MEAN ELIM. RATE CONSTANT (1/HR)<br>
;<br>
THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;<br>
DOSE=WEIGHT-ADJUSTED DOSE (MG/KG)<br>
;<br>
IF (NEWIND.NE.2) THEN<br>
AMT=DOSE*WT<br>W=WT<br>
ENDIF<br>T0=THETA(1)*EXP(ETA(1))<br>T2=THETA(2)*EXP(ETA(2))<br>T1=T2+T0<br>T3=THETA(3)*W*EXP(ETA(3))<br>A=EXP(-T2*TIME)<br>B=EXP(-T1*TIME)<br>C=T1-T2<br>D=A-B<br>E=T3*C<br>Y=AMT*T1*T2/E*D+EPS(1)<br>
$PROB POPULATION DATA WITH PRIOR ON THETA, OMEGA AND SIGMA<br>$INPUT ID DOSE TIME DV WT<br>$DATA data<br>
REWIND<br>
$THETA (0,4,5) (0,.09,.5) (.004,.01,.9)<br>$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08<br>$SIGMA .4<br>
$EST<br>
Instead of a $PRIOR record, the following may be used:<br>
$SUBROUTINE PRIOR=prior<br>
The prior routine is as follows:<br>
SUBROUTINE PRIOR (ICALL,CNT)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
EX-149<br>
<hr>
<A name=804></a>TNPRI EXAMPLES<br>
Help Guide<br>
USE NMPRD_INT, ONLY: IPROB<br>REAL(KIND=DPSIZE) :: CNT<br>REAL(KIND=DPSIZE) :: PLEV<br>INTEGER(KIND=ISIZE) :: ICALL<br>IF (IPROB==2) THEN<br>PLEV=0.<br>ITYP=0<br>NSAM=0<br>ISS=0<br>IFND=0<br>MODE=0<br>IVAR=0<br>CALL TNPRI(IFND,MODE,ITYP,PLEV,NSAM,ISS,IVAR,CNT)<br>ENDIF<br>RETURN<br>END<br>
Example 2<br>
Use of PRIOR and TNPRI and a control stream for population data:<br>
This example obtains parameter estimates from population data, using a two-compart-<br>ment PK model, and it incorporates a frequentist prior of transformed normal form for all<br>of THETA and OMEGA, but for only the ﬁrst element of a diagonal SIGMA, which is a<br>prior-speciﬁc parameter. Prior information for these parameters is found in model speci-<br>ﬁcation ﬁle msf1.<br>
$PROB READ THE MODEL SPECIFICATION FILE<br>$DATA data<br>$INPUT ID DOSE TIME DV WT<br>$PRIOR TNPRI (PROBLEM 2)<br>$MSFI msf1 ONLYREAD<br>$PRED<br>;<br>;<br>
THETA(1)=MEAN ABSORPTION RATE CONSTANT - MEAN ELIM. RATE CONSTANT (l/HR)<br>
;<br>
THETA(2)=MEAN ELIM. RATE CONSTANT (1/HR)<br>
;<br>
THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;<br>
DOSE=WEIGHT-ADJUSTED DOSE (MG/KG)<br>
;<br>
IF (NEWIND.NE.2) THEN<br>
AMT=DOSE*WT<br>W=WT<br>
ENDIF<br>T0=THETA(1)*EXP(ETA(1))<br>T2=THETA(2)*EXP(ETA(2))<br>T1=T2+T0<br>T3=THETA(3)*W*EXP(ETA(3))<br>A=EXP(-T2*TIME)<br>B=EXP(-T1*TIME)<br>C=T1-T2<br>D=A-B<br>E=T3*C<br>Y=AMT*T1*T2/E*D+EPS(2)<br>
$PROB POPULATION DATA WITH PRIOR ON THETA AND OMEGA<br>$INPUT ID DOSE TIME DV WT<br>$DATA data REWIND<br>$THETA (0,4,5) (0,.09,.5) (.004,.01,.9)<br>$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08<br>$SIGMA .4 FIX .5<br>
EX-150<br>
<hr>
<A name=805></a>Help Guide<br>
EXAMPLES TNPRI<br>
$EST<br>
Instead of a $PRIOR record, use the same $SUBROUTINE record and the same subrou-<br>tine prior as in Example 1.<br>
Example 3<br>
Use of PRIOR and TNPRI and a control stream for population data:<br>
This example simulates the THETA and OMEGA parameters of the same two-compart-<br>ment population PK model, as well as the population data from this model. As with<br>Example 2, the ﬁrst element of SIGMA is prior-speciﬁc, and so its value need not be sim-<br>ulated. The value .5 is used for the value of the second element of SIGMA. The default<br>variance-covariance matrix from the prior problem is used for the hyperparameter vari-<br>ance-covariance matrix (IVAR=1).<br>
$PROB READ THE MODEL SPECIFICATION FILE<br>$DATA data<br>$INPUT ID DOSE TIME DV WT<br>$PRIOR TNPRI (PROBLEM 2) PLEV=.9999 IVAR=1<br>$MSFI msf1 ONLYREAD<br>$PRED<br>;<br>;<br>
THETA(1)=MEAN ABSORPTION RATE CONSTANT - MEAN ELIM. RATE CONSTANT (l/HR)<br>
;<br>
THETA(2)=MEAN ELIM. RATE CONSTANT (1/HR)<br>
;<br>
THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;<br>
DOSE=WEIGHT-ADJUSTED DOSE (MG/KG)<br>
;<br>
IF (NEWIND.NE.2) THEN<br>
AMT=DOSE*WT<br>W=WT<br>
ENDIF<br>T0=THETA(1)*EXP(ETA(1))<br>T2=THETA(2)*EXP(ETA(2))<br>T1=T2+T0<br>T3=THETA(3)*W*EXP(ETA(3))<br>A=EXP(-T2*TIME)<br>B=EXP(-T1*TIME)<br>C=T1-T2<br>D=A-B<br>E=T3*C<br>Y=AMT*T1*T2/E*D+EPS(2)<br>
$PROB POPULATION DATA WITH PRIOR ON THETA AND OMEGA<br>$INPUT ID DOSE TIME DV WT<br>$DATA data REWIND<br>$THETA (0,4,5) (0,.09,.5) (.004,.01,.9)<br>$OMEGA BLOCK (3) .7 .04 .05 .02 .06 .08<br>$SIGMA .4 FIX .5<br>
$SIM (547676) ONLY TRUE=PRIOR<br>
Instead of a $PRIOR record, the following may be used:<br>
$SUBROUTINE PRIOR=prior<br>
The prior routine is as follows:<br>
SUBROUTINE PRIOR (ICALL,CNT)<br>USE SIZES,<br>
ONLY: DPSIZE,ISIZE<br>
USE NMPRD_INT, ONLY: IPROB<br>REAL(KIND=DPSIZE) :: CNT<br>REAL(KIND=DPSIZE) :: PLEV<br>
EX-151<br>
<hr>
<A name=806></a>TNPRI EXAMPLES<br>
Help Guide<br>
INTEGER(KIND=ISIZE) :: ICALL<br>IF (IPROB==2) THEN<br>PLEV=.9999<br>IVAR=1<br>ITYP=0<br>NSAM=0<br>ISS=0<br>IFND=0<br>MODE=0<br>CALL TNPRI(IFND,MODE,ITYP,PLEV,NSAM,ISS,IVAR,CNT)<br>ENDIF<br>RETURN<br>END<br>
REFERENCES: none.<br>
EX-152<br>
<hr>
<A name=807></a>Help Guide<br>
EXAMPLES TRANSIT<br>
TRANSIT COMPARTMENT EXAMPLES<br>
A number of examples are provided for the implementation of dose superimposition into<br>a transit compartment.<br>
BACKGROUND:<br>
These examples are based on the following two papers:<br>
Implementation of a transit compartment model for describing drug absorption in<br>pharmacokinetic studies<br>J Pharmacokinet Pharmacodyn (2007) 34:711-726 DOI 10.1007/s10928-007-9066-0<br>Radojka M. Savic, Daniel M. Jonker, Thomas Kerbusch, Mats. O. Karlsson<br>
Implementation of dose superimposition to introduce multiple doses for a mathemat-<br>ical absorption model (transit compartment model)<br>J Pharmacokinet Pharmacodyn (2012) 39:251-262 DOI 10.1007/s10928-012-9247<br>Jun Shen, Alison Boeckmann &amp; Andrew Vick<br>
The ﬁrst paper deﬁnes what a transit compartment is, and gives a model for a single dose<br>into such a compartment. The second paper gives sev eral ways that multiple dosing with<br>dose superimposition can be modelled with NONMEM 7.<br>
Files on ftp site and NONMEM 7<br>
The ﬁles for the second paper are provided on the IDS ftp site:<br>
ftp://nonmem.iconplc.com/Public/nonmem/transit_compartment/<br>
The same ﬁles are also provided with NONMEM 7 in directory<br>
examples\transit_compartment<br>
The general solution (Appendix 4; sumdosetf.ctl) is of particular interest in that it<br>gives an example of the use of vectors (e.g., VECTRA(n), VECTRB(n)) and user-<br>written functions (FUNCA, FUNCB) in abbreviated code.<br>
NEW FILES FOR NONMEM 7:<br>
The following ﬁles may be found in the examples directory.<br>
sumdosetn.ctl, sumdosetf.dat<br>
With NONMEM 7, it is also possible to code the general solution directly in abbre-<br>viated code, using the DO WHILE statement, user-declared arrays, and subscripted<br>variables.<br>
Note that data ﬁle sumdosetf.csv is identical to data ﬁle sall6.csv on the ftp site.<br>
As noted in the INTRODUCTION TO NONMEM 7, this includes abbreviated code<br>for summation such as:<br>
$abbr declare dosetime(100),dose(100)<br>
$abbr declare dowhile i<br>
$DES<br>
INPT=0<br>
I=1<br>
DOWHILE (I&lt;=NDOSE)<br>
IPT=0<br>
IF (T&gt;=dosetime(I)) &amp;<br>
IPT=DOSE(I)*(T-dosetime(I))**NN*EXP(-KTR*(T-dosetime(I)))<br>
INPT=INPT+IPT<br>
EX-153<br>
<hr>
<A name=808></a>TRANSIT EXAMPLES<br>
Help Guide<br>
I=I+1<br>
ENDDO<br>
ssmultidose.ctl, ssmultidose.dat<br>
This is an example of a steady state reached using multiple transient bolus doses.<br>The abbreviated code is the same as sumdosetn.ctl, but the data ﬁle ssmultidose.dat<br>has nine identical bolus doses, at 12 hour intervals, leading to steady state (to the<br>number of signiﬁcant digits printed).<br>
ssonedose.ctl, ssonedose.dat<br>
This is an example of a steady state computed with a single dose record having SS=1<br>and II=12. The data ﬁle is ssonedose.dat. The $PK block saves the values of AMT<br>and II from the dose record. Abbreviated code in the $DES block contains a DO<br>WHILE loop that adds drug from each implied dose, going back in time till the<br>amount from the implied dose is negligible.<br>
REFERENCES: Guide Introduction_7<br>
EX-154<br>
<hr>
<A name=809></a>Help Guide<br>
EXAMPLES USER-DEFINED<br>
USER-DEFINED RESERVED FUNCTION EXAMPLE<br>
If you wish to deﬁne your own function, and have the information about its proper use of<br>arguments be conveyed upon its execution, so the compiler may detect errors, then one<br>method is to package the deﬁnition of the function in a USE module. The function must<br>be listed in an include ﬁle whose name starts with the characters<br>nonmem_reserved<br>
Caution: NMTRAN will permit the use of such a function but will not compute eta<br>deriatives with respect to the arguments. Do not use such functions to compute any vari-<br>able that affects the objective function!<br>
Here is an example.<br>
Myfuncmodule.f90 deﬁnes the functions mymin and mymax:<br>
MODULE MYFUNCS<br>
contains<br>
function mymin(a,b,c,d,e)<br>
integer mymin<br>
integer a,b,c,d,e<br>
mymin=min(a,b,c,d,e)<br>
end function<br>
function mymax(a,b,c,d,e)<br>
integer mymax<br>
integer a,b,c,d,e<br>
mymax=max(a,b,c,d,e)<br>
end function<br>
END MODULE MYFUNCS<br>
Nonmem_reserved_myfunc is the include ﬁle that declares its use:<br>
&quot; USE myfuncs, only: mymin,mymax<br>
The following control stream ﬁle uses the function:<br>
$PROB THEOPHYLLINE<br>
POPULATION DATA<br>
$INPUT ID DOSE=AMT TIME CP=DV WT<br>
$DATA THEOPP<br>
$SUBROUTINES ADVAN2 OTHER=myfuncmodule<br>
$PK<br>
;THETA(1)=MEAN ABSORPTION RATE CONSTANT (1/HR)<br>
;THETA(2)=MEAN ELIMINATION RATE CONSTANT (1/HR)<br>
;THETA(3)=SLOPE OF CLEARANCE VS WEIGHT RELATIONSHIP (LITERS/HR/KG)<br>
;SCALING PARAMETER=VOLUME/WT SINCE DOSE IS WEIGHT-ADJUSTED<br>
include &quot;nonmem_reserved_myfunc&quot;<br>
CALLFL=1<br>
KA=THETA(1)+ETA(1)<br>
K=THETA(2)+ETA(2)<br>
CL=THETA(3)*WT+ETA(3)<br>
SC=CL/K/WT<br>
I=mymin(1,2,3,4,5.0)<br>
print *,’I ’,I<br>
EX-155<br>
<hr>
<A name=810></a>USER-DEFINED EXAMPLES<br>
Help Guide<br>
$THETA (.1,3,5) (.008,.08,.5) (.004,.04,.9)<br>
$OMEGA BLOCK(3)<br>
6 .005 .0002 .3 .006 .4<br>
$ERROR<br>
Y=F+EPS(1)<br>
$SIGMA .4<br>
If you use the wrong argument type (real instead of integer), or perhaps use the wrong<br>number of arguments, the compiler will readily ﬂag this.<br>
REFERENCES: Guide Introduction_7<br>
EX-156<br>
<hr>
<A name=811></a>Help Guide<br>
EXAMPLES YLO<br>
YLO EXAMPLE<br>
In this example, blood concentrations below a known quantiﬁcation limit (BQL) have<br>been eliminated from the analysis. A one-sided interval with lower boundary equal to the<br>quantiﬁcation limit is deﬁned. The conditional likelihood for an observation is &quot;condi-<br>tioned&quot; on values of the population parameters and also on the condition that the observa-<br>tion is inside the one-sided interval.<br>(See <b>pr_y</b>, <b>YLO YUP</b>)<br>(See <b>YLO YUP Probability: PR_Y</b>).<br>
Here is an NM-TRAN control stream.<br>
$PROB YLO example<br>
$INPUT ID TIME DV AMT EVID MDV<br>
$DATA ylow.dat IGNORE=C<br>
$SUBROUTINES ADVAN=1 TRANS=2<br>
$PK<br>
CL=THETA(1)*EXP(ETA(1))<br>
V=THETA(2)*EXP(ETA(2))<br>
K=CL/V<br>
S1=V<br>
$ERROR<br>
; Limit of Quantification (LOQ) is 1<br>
; DV’s below LOQ are given MDV=1 in dataset<br>
; PR_Y (PRB) is probability that DV is &gt; LOQ<br>
; PR_Y (PRB) is provided even if MDV is 1<br>
YLO=1<br>
PRB=PR_Y<br>
Y = F+ERR(1)<br>
$THETA<br>
(0,0.693); CL<br>
(0,24); V<br>
$OMEGA<br>
0.09<br>
0.09<br>
$SIGMA<br>
.5<br>
$ESTIMATION<br>
MAXEVAL=9999<br>
NSIG=4<br>
METHOD=COND INTERACTION LAPLACIAN<br>
PRINT=5<br>
$TABLE ID TIME AMT MDV EVID PRB<br>
NOPRINT<br>
ONEHEADER<br>
FILE=ylo.tab<br>
EX-157<br>
<hr>
<A name=812></a>YLO EXAMPLES<br>
Help Guide<br>
Here is a segment of the dataset for a subject with last DV &lt; LOQ<br>
ID TIME<br>
DV AMT<br>
EVID MDV<br>
.<br>
.<br>
 <br>
.<br>
 <br>
.<br>
.<br>
 <br>
.<br>
.<br>
.<br>
 <br>
.<br>
 <br>
.<br>
.<br>
 <br>
.<br>
.<br>
.<br>
 <br>
.<br>
 <br>
.<br>
.<br>
 <br>
.<br>
2<br>
0<br>
0<br>
100 1<br>
1<br>
2<br>
0.333 2.47<br>
0<br>
0<br>
 <br>
0<br>
2<br>
2<br>
3.26 0<br>
0<br>
0<br>
2<br>
6<br>
2.32 0<br>
0<br>
0<br>
2<br>
15.917 2.46<br>
0<br>
0<br>
 <br>
0<br>
2<br>
24<br>
0<br>
100 1<br>
1<br>
2<br>
48<br>
0<br>
100 1<br>
1<br>
2<br>
72<br>
0<br>
100 1<br>
1<br>
2<br>
95.917 4.04<br>
0<br>
0<br>
 <br>
0<br>
2<br>
96<br>
0<br>
100 1<br>
1<br>
2<br>
96.08 8.85<br>
0<br>
0<br>
 <br>
0<br>
2<br>
120 3.16<br>
0<br>
0<br>
 <br>
0<br>
C Last observation record (below) has DV &lt; LOQ (LOQ = 1) and MDV = 1<br>
C This observation does not contribute to the -2LL estimate. However,<br>
C probability that DV is &gt; LOQ can be tabled using PRB=PR_Y.<br>
2<br>
168 0.163<br>
0<br>
0<br>
 <br>
1<br>
REFERENCES: None.<br>
EX-158<br>
<hr>
</BODY>
</HTML>
