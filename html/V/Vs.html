<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><HTML>
<HEAD>
<TITLE></TITLE>
</HEAD>
<BODY>
<A name=1></a>NONMEM Users Guide - Part V<br>
Introductory Guide<br>
April 2011<br>
by<br>
Alison J. Boeckmann<br>
Lewis B. Sheiner<br>
Stuart L. Beal<br>
NONMEM Project Group<br>University of California at San Francisco<br>
ICON Development Solutions Ellicott City, Maryland<br>
Copyright by the Regents of the University of California<br>1994,2011<br>All rights reserved<br>
<hr>
<A name=2></a><b>Preface</b><br>
This edition of &quot;NONMEM Users Guide - Part V Introductory Guide&quot; is distributed with NONMEM 7.2. It<br>is the ﬁrst new edition since 1994. Details that have changed since the previous edition have been cor-<br>rected, and some new features have been added.<br>
Signiﬁcant changes are marked with bars.<br>
Examples of NONMEM outputs have not been updated. They remain as they were in 1994 and are from<br>NONMEM IV. With later versions of NONMEM there are changes in the outputs. In some cases the<br>wording has been changed; there is new content; and the numerical results may have changed slightly. But<br>none of this affects the features and methodology that Lewis Sheiner described in chapters 2, 10, and 11.<br>
True to its purpose as an instructional guide for new users of NONMEM, this Guide remains oriented to the<br>classic NONMEM methods and basic features (through NONMEM VI). References to even earlier ver-<br>sions of NONMEM and PREDPP have been deleted.<br>
<hr>
<A name=3></a><b>Table of Contents</b><br>
Chapter 1 - Introduction to NONMEM, PREDPP, and NM-TRAN . . . . . . . . . . . . . . .<br>
1<br>
What This Chapter is About<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
1<br>
Introducing NONMEM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
1<br>
What is NONMEM?<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
1<br>
What is PREDPP? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
1<br>
What is NM-TRAN? . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
1<br>
Scope of this Introductory Guide<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
2<br>
Contents of this Introductory Guide<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
2<br>
How to Read this Guide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
3<br>
A Brief Technical Overview<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
3<br>
NONMEM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
3<br>
PREDPP and the PREDPP Library<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
4<br>
Subroutines PK and ERROR . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
4<br>
Building an Executable Module for NONMEM . . . . . . . . . . . . . . . . . . . . . .<br>
4<br>
NM-TRAN . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
4<br>
Control Language Translation<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
4<br>
Model Speciﬁcation via Abbreviated Code<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
5<br>
Partial Differentiation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
5<br>
Data Preprocessor<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
5<br>
Additional Documentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
5<br>
Chapter 2 - NONMEM Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
7<br>
What This Chapter is About<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
7<br>
An Individual’s Theophylline Kinetics . . . . . . . . . . . . . . . . . . . . . . . . .<br>
7<br>
The NM-TRAN Control Records . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
7<br>
The Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .<br>
8<br>
The Output<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
9<br>
A Population Model for Phenobarbital<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
11<br>
The NM-TRAN Control Records . . . . . . . . . . . . . . . . . . . . . . . . . . 12<br>The Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12<br>The Output<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
13<br>
Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20<br>
Chapter 3 - Models for Individual Data . . . . . . . . . . . . . . . . . . . . . . . . 22<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22<br>Pharmacokinetic Structural Models for Individual Data . . . . . . . . . . . . . . . . 22<br>Alternative Parameterizations<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
23<br>
The Scale Parameter, <b>S </b>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23<br><b>S </b>Depends on a Known Constant . . . . . . . . . . . . . . . . . . . . . . . . . . 23<br><b>S </b>Depends on a Parameter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24<br><b>S </b>Depends on an Element of <b>x </b>. . . . . . . . . . . . . . . . . . . . . . . . . . . 24<br>Statistical Model for an Individual’s Observations<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
24<br>
The Additive Error Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25<br>The Constant Coefﬁcient of Variation and Exponential Models . . . . . . . . . . . . . 26<br>Combined Additive and CCV Error Model . . . . . . . . . . . . . . . . . . . . . . 27<br>The Power Function Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
28<br>
Tw o Different Types of Measurements<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
28<br>
Use of an Indicator Variable . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28<br>Tw o Different Types of Observations . . . . . . . . . . . . . . . . . . . . . . . . 29<br>More Than One Indicator Variable . . . . . . . . . . . . . . . . . . . . . . . . . 29<br>The General Mixed Effects Model for an Individual . . . . . . . . . . . . . . . . . . 30<br>
<hr>
<A name=4></a>Chapter 4 - Models for Population Data . . . . . . . . . . . . . . . . . . . . . . . . 31<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31<br>General . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31<br>Structural Parameter Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31<br>Linear Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32<br>Multiplicative Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32<br>Saturation Models<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
33<br>
Models with Indicator Variables<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
33<br>
Combinations<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
34<br>
Time Varying <i>z </i>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34<br>Structural Kinetic Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34<br>Population Random Effects Models . . . . . . . . . . . . . . . . . . . . . . . . . 34<br>Models for Interindividual Errors . . . . . . . . . . . . . . . . . . . . . . . . . . 35<br>Additive/Multiplicative Models and the Exponential Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
36<br>
Other Models<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
36<br>
General Form for the Parameter Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
37<br>
Statistical Models for an Individual’s Observations . . . . . . . . . . . . . . . . . . 37<br>The Population Mixed Effects Model . . . . . . . . . . . . . . . . . . . . . . . . 37<br>
Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests . . . . . . . . . . . . 40<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40<br>Model Fitting Criterion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40<br>Least Squares for Individual Data with an Additive Error Model . . . . . . . . . . . . 40<br>Least Squares for Individual Data with Other Types of Error Models<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
40<br>
Least Squares for Population Data<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
41<br>
Parameter Estimates<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
41<br>
Precision of Parameter Estimates . . . . . . . . . . . . . . . . . . . . . . . . . . 42<br>Distribution of Parameters vs Distribution of Parameter Estimates<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
43<br>
Conﬁdence Interval for a Single Parameter . . . . . . . . . . . . . . . . . . . . . . 43<br>Estimating a Parameter’s Standard Error . . . . . . . . . . . . . . . . . . . . . . . 43<br>Relating the Conﬁdence Interval to the <b>SE </b>. . . . . . . . . . . . . . . . . . . . . . 44<br>A Conﬁdence Interval for a Function of a Single Parameter<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
44<br>
Multiple Parameters<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
44<br>
Correlation of Parameter Estimates . . . . . . . . . . . . . . . . . . . . . . . . . 44<br>Conﬁdence Intervals for a Function of Several Parameters . . . . . . . . . . . . . . . 44<br>Hypothesis Testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45<br>Hypothesis Testing Using the <b>SE </b>. . . . . . . . . . . . . . . . . . . . . . . . . . 45<br>Hypothesis Testing Using the Likelihood Ratio . . . . . . . . . . . . . . . . . . . . 46<br>Deﬁnition — Full/Reduced Models . . . . . . . . . . . . . . . . . . . . . . . . . 46<br>Reduced/Full Models Express the Null/Alternative Hypotheses . . . . . . . . . . . . . 46<br>The Likelihood Ratio Test . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46<br>Choosing Among Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47<br>
Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor . . . . . . 49<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49<br>Data Sets for NONMEM<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
49<br>
Data Records<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
49<br>
Data Items . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49<br>Clinical Data and Data Conversion . . . . . . . . . . . . . . . . . . . . . . . . . 50<br>Data Sets for PREDPP<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
51<br>
The $DAT A Record . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51<br>The $INPUT Record . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53<br>
<hr>
<A name=5></a>Data Item Labels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53<br>Reserved Labels and Synonyms<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
53<br>
Dropping Data Items via DROP<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
54<br>
NONMEM Data Items<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
54<br>
DV Data Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54<br>ID Data Item for Population Data . . . . . . . . . . . . . . . . . . . . . . . . . . 54<br>MDV data item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54<br>PREDPP Data Items<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
54<br>
TIME Data Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54<br>AMT, RATE, SS, II: Dose-related Data Items<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
55<br>
EVID Data Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55<br>CMT and PCMT Data Items . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55<br>CALL Data Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56<br>Describing Doses to PREDPP . . . . . . . . . . . . . . . . . . . . . . . . . . . 56<br>Dose-related Data Items . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56<br>Different Kinds of Doses<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
57<br>
Instantaneous Bolus Doses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57<br>Infusions<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
58<br>
Steady-State Doses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58<br>Steady-State with Multiple Bolus Doses . . . . . . . . . . . . . . . . . . . . . . . 58<br>Steady-State with Multiple Infusions . . . . . . . . . . . . . . . . . . . . . . . . 59<br>Steady-State with Constant Infusion<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
60<br>
Multiple Steady-State Doses . . . . . . . . . . . . . . . . . . . . . . . . . . . . 61<br>Combining Non-Steady-State Doses with Steady-State Doses<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
62<br>
The Output Compartment: Urine Collections and Observations . . . . . . . . . . . . . 62<br>The Data Preprocessor<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
63<br>
Day-time Translation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63<br>TIME Data Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63<br>DATE Data Item . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64<br>Calendar Dates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64<br>Converting Hours to Days . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65<br>The Year 2000 - LAST20 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65<br>Leap Year Warning - LYWARN<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
65<br>
Interdose Interval (II) Conversion . . . . . . . . . . . . . . . . . . . . . . . . . . 66<br>Data Items Generated by the Data Preprocessor . . . . . . . . . . . . . . . . . . . . 66<br>When Must a Format Speciﬁcation be Included or Omitted? . . . . . . . . . . . . . . 67<br>Skipping Data Items<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
67<br>
Chapter 7 - $SUBROUTINE Record and $PK Record . . . . . . . . . . . . . . . . . . 68<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68<br>The $SUBROUTINE Record<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
68<br>
Choosing an ADVAN Subroutine: Standard Pharmacokinetic Models . . . . . . . . . . 68<br>Choosing a TRANS Subroutine: Alternative Parameterizations . . . . . . . . . . . . . 69<br>$PK Abbreviated Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70<br>Syntax<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
70<br>
When are $PK Statements Evaluated?<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
70<br>
Time Varying PK parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71<br>$PK Statements for Individual Data . . . . . . . . . . . . . . . . . . . . . . . . . 71<br>Basic and Additional Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . 71<br>Alternative Parameterizations using $PK Statements<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
72<br>
Scale Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73<br>
<hr>
<A name=6></a>Scaling by a Known Constant<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
73<br>
Scaling by a Parameter: Conditional Statements and Indicator Variables . . . . . . . . . 74<br>Scaling by a Data Item<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
74<br>
Bioavailability Fraction Parameters . . . . . . . . . . . . . . . . . . . . . . . . . 75<br>Output Fraction<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
76<br>
$PK Statements for Population Data<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
76<br>
Structural Part of Parameter Models . . . . . . . . . . . . . . . . . . . . . . . . . 76<br>Linear Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76<br>Multiplicative Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77<br>Saturation Models<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
77<br>
Models with Indicator Variables<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
77<br>
Population Random Effect Models . . . . . . . . . . . . . . . . . . . . . . . . . 77<br>Models for Interindividual Errors . . . . . . . . . . . . . . . . . . . . . . . . . . 78<br>Additive/Multiplicative Models . . . . . . . . . . . . . . . . . . . . . . . . . . . 78<br>Other Models<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
78<br>
Restrictions on Random Variables<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
78<br>
Chapter 8 - $ERROR Record<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
80<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80<br>$ERROR Abbreviated Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80<br>Syntax<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
80<br>
When are $ERROR Statements Evaluated?<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
80<br>
Error Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80<br>The Additive Error Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81<br>The Constant Coefﬁcient of Variation and Exponential Models . . . . . . . . . . . . . 81<br>Combined Additive and CCV Error Model . . . . . . . . . . . . . . . . . . . . . . 81<br>The Power Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
81<br>
Tw o Different Types of Measurements<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
81<br>
Tw o Different Types of Observations . . . . . . . . . . . . . . . . . . . . . . . . 82<br>More than One Indicator Variable . . . . . . . . . . . . . . . . . . . . . . . . . . 82<br>
Chapter 9 - Additional NM-TRAN Records . . . . . . . . . . . . . . . . . . . . . . 83<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83<br>Providing Initial Estimates For θ : The $THETA Record . . . . . . . . . . . . . . . . 83<br>Providing Initial Estimates For Elements Of θ<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
83<br>
Providing Constraints for Elements of θ . . . . . . . . . . . . . . . . . . . . . . . 83<br>Fixing Elements of θ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84<br>How to Obtain Initial Estimates for θ . . . . . . . . . . . . . . . . . . . . . . . . 84<br>Providing Initial Estimates for Ω and Σ: the $OMEGA and $SIGMA Records . . . . . . 84<br>$OMEGA Record With Individual Data . . . . . . . . . . . . . . . . . . . . . . . 85<br>$OMEGA Record With Population Data . . . . . . . . . . . . . . . . . . . . . . . 85<br>The $SIGMA Record . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85<br>Fixing Elements of Ω or Σ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85<br>How to Obtain Initial Estimates for Ω and Σ . . . . . . . . . . . . . . . . . . . . . 86<br>Specifying Optional Tasks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87<br>Requesting the Estimation Step: the $ESTIMATION Record . . . . . . . . . . . . . . 87<br>Requesting the Covariance Step: the $COVARIANCE Record . . . . . . . . . . . . . 88<br>Specifying Optional Output . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88<br>Requesting the Table Step: the $TABLE Record<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
88<br>
Requesting Scatterplots: the $SCATTERPLOT Record<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
88<br>
Placement and Order of Records . . . . . . . . . . . . . . . . . . . . . . . . . . 89<br>INCLUDE records . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89<br>
<hr>
<A name=7></a>Chapter 10 - Reading the Output . . . . . . . . . . . . . . . . . . . . . . . . . . . 91<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91<br>NONMEM Describes its Inputs<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
91<br>
PREDPP Describes Its Inputs<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
93<br>
Diagnostic Output from the Estimation Step . . . . . . . . . . . . . . . . . . . . . 95<br>Intermediate Output from the Estimation Step . . . . . . . . . . . . . . . . . . . . 95<br>Summary Output from the Estimation Step<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
97<br>
Minimum Value of the Objective Function and Final Parameter Estimates . . . . . . . . 97<br>Output from the Covariance Step . . . . . . . . . . . . . . . . . . . . . . . . . . 97<br>Additional Output: Tables and Scatterplots . . . . . . . . . . . . . . . . . . . . . . 99<br>Output from the Table Step<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
99<br>
Output from the Scatterplot Step . . . . . . . . . . . . . . . . . . . . . . . . . . 100<br>
Chapter 11 - Model Building<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 101<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101<br>The Stages of Model Building . . . . . . . . . . . . . . . . . . . . . . . . . . . 101<br>Check-out — Index Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103<br>Building the Structural Part of the Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 108<br>
A General Approach<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 108<br>
The Minimal Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 109<br>
Use of Constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110<br>Diagnostic Tools . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110<br>Plot of DV vs PRED<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 110<br>
Residual Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111<br>Index Plots of Residuals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112<br>Plot of WRES vs Independent Variable . . . . . . . . . . . . . . . . . . . . . . . 113<br>Judging Goodness of Fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114<br>A Global Measure — Change in the Objective Function . . . . . . . . . . . . . . . . 115<br>Decrease in Unexplained Variability<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 115<br>
Improvement in Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115<br>Using the Tools: Further Improvement . . . . . . . . . . . . . . . . . . . . . . . 117<br>An Additional Effect of WT . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117<br>The Effect of APGR<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 119<br>
Building the Statistical Model . . . . . . . . . . . . . . . . . . . . . . . . . . . 121<br>Judging Among Alternatives . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121<br>Unexplained Variability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122<br>Residual Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122<br>Reﬁne Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 124<br>
Use of Standard Errors and Conﬁdence Intervals . . . . . . . . . . . . . . . . . . . 125<br>A Model Reﬁnement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126<br>Testing the Model<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 127<br>
Chapter 12 - Brief Descriptions of Other Features<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 128<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128<br>Advanced Features of PREDPP<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 128<br>
Pharmacodynamic Modeling Using the $ERROR Record<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 128<br>
Other Pharmacokinetic Models: ADVAN5 through ADVAN9 and ADVAN13<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 129<br>
Zero-Order Bolus Doses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130<br>The Additional Dose Data Item: ADDL . . . . . . . . . . . . . . . . . . . . . . . 130<br>Lagged doses: the ALAG Parameter<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 130<br>
Model Event Times: MTIME<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 130<br>
Controlling Calls to PK and ERROR<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 131<br>
<hr>
<A name=8></a>Transgeneration of Input Data: the INFN Subroutine<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 132<br>
User-written PRED Subroutines<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 132<br>
Required Data Items<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 132<br>
An Example of $PRED Statements: Pharmacodynamic Modeling . . . . . . . . . . . . 133<br>Advanced Features of NONMEM<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 133<br>
Full Covariance Matrices: $OMEGA BLOCK and $SIGMA BLOCK . . . . . . . . . . 133<br>Grouping Related Observations: The L1 and L2 Data Items<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 134<br>
Continuing a NONMEM Run: MSFO and MSFI . . . . . . . . . . . . . . . . . . . 134<br>NONMEM Can Obtain Initial Estimates for θ , Ω, Σ . . . . . . . . . . . . . . . . . . 135<br>Improving Parameter Estimates: REPEAT and RESCALE . . . . . . . . . . . . . . . 135<br>The Covariance Step: <b>R</b>−<b>1</b>, <b>S</b>−<b>1</b>, Special Computation . . . . . . . . . . . . . . . . . 135<br>Multiple Problems in a Single NONMEM Run . . . . . . . . . . . . . . . . . . . . 136<br>Simulation Using NONMEM: The $SIMULATION Record . . . . . . . . . . . . . . 136<br>Files for Subsequent Processing: the $TABLE Record . . . . . . . . . . . . . . . . . 137<br>Data Checkout Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137<br>Obtaining Individual Parameter Estimates - Conditional Estimates of ηs . . . . . . . . . 137<br>Population Conditional Estimation Methods . . . . . . . . . . . . . . . . . . . . . 138<br>Displaying PRED-Deﬁned Variables and Conditional Estimates of ηs . . . . . . . . . . 138<br>Mixture Models<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 138<br>
PRED Error Return Codes and Error Messages in File PRDERR . . . . . . . . . . . . 139<br>User-Written Subroutines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139<br>PRIOR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139<br>Observations of Two Different Types . . . . . . . . . . . . . . . . . . . . . . . . 140<br>NONMEM 7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142<br>
Chapter 13 - Errors in NONMEM Runs . . . . . . . . . . . . . . . . . . . . . . . . 143<br>
What This Chapter is About . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143<br>Abnormal Termination of the Estimation Step<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 143<br>
&quot;DUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED&quot; . . . . . . . . . . . . . . . 143<br>&quot;DUE TO ROUNDING ERRORS (ERROR=134)&quot; . . . . . . . . . . . . . . . . . . . . . . 143<br>Abnormal Termination of the Covariance Step . . . . . . . . . . . . . . . . . . . . 144<br>Miscellaneous Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145<br>Proportional Error Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145<br>Errors in the Pharmacokinetic Model . . . . . . . . . . . . . . . . . . . . . . . . 145<br>Errors with PREDPP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145<br>Error Messages from a TRANS Routine . . . . . . . . . . . . . . . . . . . . . . . 145<br>Error Messages from ADVAN Routines . . . . . . . . . . . . . . . . . . . . . . . 146<br>Numeric difﬁculties in PREDPP . . . . . . . . . . . . . . . . . . . . . . . . . . 146<br>
Index<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
.<br>
. 152<br>
<hr>
<A name=9></a><b>Chapter 1 - Introduction to NONMEM, PREDPP, and NM-TRAN</b><br>
<b>1. What This Chapter is About</b><br>
This chapter introduces a computer program called NONMEM. It also introduces two programs that are<br>distributed with NONMEM and make it easier to use: PREDPP and NM-TRAN. The scope of this text<br>itself is described, and suggestions are made for reading it. A somewhat detailed technical description of<br>the components of NONMEM is then given. The ﬁnal section is a list of additional references.<br>
<b>2. Introducing NONMEM</b><br>
<b>2.1. What is NONMEM?</b><br>
NONMEM stands for &quot;Nonlinear Mixed Effects Model.&quot; NONMEM is a computer program, written in<br>FORTRAN 90/95, designed to ﬁt general statistical (nonlinear) regression-type models to data.<br>
NONMEM was developed by the NONMEM Project Group at the University of California at San Fran-<br>cisco for analyzing population pharmacokinetic data in particular.† These are data typically collected from<br>clinical studies of pharmaceutic agents, involving the administration of a drug to individuals and the subse-<br>quent observation of drug levels (most often in the blood plasma). Proper modeling of these data involves<br>accounting for both unexplainable inter- and intra-subject effects (random effects), as well as measured<br>concomitant effects (ﬁxed effects). NONMEM allows this mixed effect modeling. Such modeling is espe-<br>cially useful when there are only a few pharmacokinetic measurements from each individual sampled in the<br>population, or when the data collection design varies considerably between these individuals. However,<br>NONMEM is a general program which can be used to ﬁt models to a wide variety of data.<br>
Like many nonlinear regression programs, NONMEM does not have any &quot;built in&quot; models (such as the lin-<br>ear model) with which it can compute a predicted value given the current values of the regression parame-<br>ters. Instead, NONMEM calls a subroutine having entry name PRED (&quot;prediction&quot;) to obtain a predicted<br>value. PRED also must compute for NONMEM partial derivatives with respect to certain random vari-<br>ables. Depending on the model and the kinds of doses, PRED may be very simple or may be very compli-<br>cated. A user can write his own PRED subroutine. This can be as simple or complicated as is necessary,<br>and may involve calls to its own subprograms.<br>
<b>2.2. What is PREDPP?</b><br>
PREDPP stands for &quot;PRED for Population Pharmacokinetics&quot;. It is a PRED subroutine for use with NON-<br>MEM and is the second major component distributed with NONMEM. Whereas NONMEM is a general<br>nonlinear regression tool, PREDPP is specialized to the kinds of predictions which arise in pharmacokinetic<br>data analysis. It can compute predictions according to many different pharmacokinetic models, according<br>to a great variety of dosing regimens. Almost all the examples in this guide use PREDPP.<br>
<b>2.3. What is NM-TRAN?</b><br>
NM-TRAN stands for &quot;NONMEM Translator&quot;. It is the third major component distributed with NON-<br>MEM. It is a separate, &quot;stand-alone&quot; control language translator and data preprocessor. When NM-TRAN<br>is used, a NONMEM run includes two separate steps: ﬁrst the NM-TRAN step, in which a ﬁle of NM-<br>TRAN records (which begin with &quot;$&quot;) are translated into several NONMEM input ﬁles, and second the<br>NONMEM step itself. All the examples in this guide use NM-TRAN. We strongly recommend its use.<br>
Note that neither NM-TRAN nor NONMEM-PREDPP run interactively. Files of commands and data are<br>created by means of (say) the operating system editor. Then NM-TRAN and NONMEM are executed,<br>using these ﬁles as input. Figure 1.1 shows the relationship between NONMEM, PREDPP, and NM-<br>TRAN.<br>
† NONMEM versions up through VI are the property of the Regents of the University of California, but ICON<br>Development Solutions has exclusive rights to license their use. NONMEM 7 is the current version of the soft-<br>ware and is the property of ICON Development Solutions.<br>
-1-<br>
<hr>
<A name=10></a>Chapter 1 - Introduction to NONMEM, PREDPP, and NM-TRAN<br>
A file of NM-TRAN<br>
A data file<br>
records<br>
NM-TRAN<br>
Control and data<br>files for NONMEM<br>
NONMEM<br>
PREDPP<br>
NONMEM output report<br>
Fig 1.1. NONMEM, PREDPP, and NM-TRAN. A user-written PRED subroutine could be included instead of PREDPP.<br>
<b>2.4. Scope of this Introductory Guide</b><br>
This Guide is intended to be read by new users of NONMEM-PREDPP. Typically, such users have phar-<br>macokinetic data, either from a population or from a single individual, to be ﬁt to a standard pharmacoki-<br>netic model (e.g., a one or two compartment linear mammillary model). However, new users with nonstan-<br>dard models, or with pharmacokinetic/pharmacodynamic data, may also ﬁnd this guide helpful.<br>
It is assumed that NONMEM and its components are already installed on the user’s computer and that the<br>user wants to learn to use them as quickly as possible. This guide does not tell how to perform the installa-<br>tion or how to run an installed NONMEM under a particular operating system; the new user will have to<br>ask experienced users what the local commands are. However, someone who is installing NONMEM at a<br>new site may ﬁnd it useful to review this guide to get a quick overview of NONMEM, its component pro-<br>grams, its inputs, and its outputs.<br>
This guide is not a text book in pharmacokinetics or statistics. Readers should be familiar with basic con-<br>cepts in pharmacokinetics and statistical data analysis. We also assume a very basic familiarity with FOR-<br>TRAN.<br>
<b>2.5. Contents of this Introductory Guide</b><br>
<b>Chapter 2 </b>contains two examples of the use of NONMEM. The ﬁrst presents data from a single individ-<br>ual; estimates are obtained of his pharmacokinetic parameters. The second presents data from a group of<br>individuals; estimates are obtained of the pharmacokinetic parameters of the population which this group<br>represents. The examples serve to introduce NONMEM notation, input and output, and to provide an idea<br>of what is possible using the system.<br>
<b>Chapter 3 </b>presents the notation and deﬁnitions we will use to discuss models for individual data. The rela-<br>tionship of these models to data is discussed, and the distinction between so-called ﬁxed effects and random<br>effects is made.<br>
<b>Chapter 4 </b>extends this discussion to models for population data.<br>
<b>Chapter 5 </b>discusses NONMEM’s ﬁtting criterion, the parameter estimates obtained by using this criterion,<br>and the standard errors of these estimates. It then discusses how to do hypothesis tests with NONMEM.<br>
<b>Chapter 6 </b>tells how to create data ﬁles for NONMEM-PREDPP and how to describe them using the<br>$DAT A and $INPUT records of NM-TRAN. It also discusses the Data Preprocessor feature of NM-TRAN.<br>
<b>Chapter 7 </b>tells how to use NM-TRAN to write simple $SUBROUTINE records for PREDPP, how to write<br>$PK records for individual data, and how to write $PK records for population data.<br>
-2-<br>
<hr>
<A name=11></a>Chapter 1 - Introduction to NONMEM, PREDPP, and NM-TRAN<br>
<b>Chapter 8 </b>tells how to write simple $ERROR records for PREDPP. Chapters 7 and 8 are meant to be read<br>in parallel with Chapters 3 and 4.<br>
<b>Chapter 9 </b>tells how to use NM-TRAN to specify the remaining choices for an analysis. It tells how to<br>assign initial values to parameters ($THETA, $OMEGA, $SIGMA records), how to specify what analysis<br>tasks to perform ($ESTIMATION, $COVARIANCE records), and how to specify certain additional output<br>($TABLE, $SCATTERPLOT records).<br>
<b>Chapter 10 </b>describes NONMEM’s output in detail.<br>
<b>Chapter 11 </b>outlines the process of model building, showing how a simple model can be made more com-<br>plex to better ﬁt the data.<br>
<b>Chapter 12 </b>brieﬂy describes a variety of features of PREDPP and NONMEM that are somewhat advanced<br>for this text but are of interest to most users of NONMEM. References are given to other documents in<br>which additional information can be found.<br>
<b>Chapter 13 </b>discusses errors that can occur during a NONMEM run.<br>
<b>Appendix 1 </b>describes PREDPP’s most commonly used pharmacokinetic models (ADVAN subroutines).<br>
<b>Appendix 2 </b>describes alternative parameterizations (TRANS subroutines) for these models.<br>
<b>Appendix 3 </b>is a list of NM-TRAN records.<br>
<b>2.6. How to Read this Guide</b><br>
Readers who are completely new to NONMEM should read this guide starting with Chapter 2; the exam-<br>ples presented are used again in the later chapters. Chapters 2-5 are theoretical in nature. Chapters 6-12<br>describe the details of building the input for NONMEM-PREDPP and interpreting the output. Readers who<br>have non-pharmacokinetic data to ﬁt can skip (or skim) Chapters 3, 4, 7, and 8. Readers who already have<br>some familiarity with certain topics (e.g., who have used other nonlinear analysis programs to analyze data)<br>can concentrate on the chapters of interest to them. In time, readers who are comfortable with NONMEM<br>may be able to work entirely from Appendix 3. We strongly recommend that such users &quot;graduate&quot; to the<br>more thorough NONMEM documentation listed in Section 4 of this chapter.<br>
Throughout the guide, examples are given of NM-TRAN records. These examples appear in boldface:<br>
<b>$THETA .01</b><br>
Examples are also given of (fragments) of input data ﬁles. They appear as follows:<br>
<b>ID AMT</b><br>
<b>TIME DV</b><br>
<b>2</b><br>
<b>320. 0.</b><br>
<b>0.</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>.27 1.71</b><br>
Alphabetic characters such as ID, AMT, etc., are shown for descriptive purposes. They are <i>not </i>part of the<br>actual data ﬁle.<br>
<b>3. A Brief Technical Overview</b><br>
In this section we discuss the components of NONMEM in some detail. First-time readers may prefer to<br>skip this section and go directly to Chapter 2, which gives an example of a NONMEM run, and return to<br>this section later (if at all).<br>
<b>3.1. NONMEM</b><br>
NONMEM is written (almost) entirely in ANSI FORTRAN 90/95. It is distributed on CD-ROM as FOR-<br>TRAN source code, some of which is encrypted. It can be compiled and run on any computer which has a<br>FORTRAN 90/95 compiler and sufﬁcient memory and speed to run a large, computationally intensive pro-<br>gram.<br>
NONMEM consists of a main program and many subroutines, all of which are required for each NON-<br>MEM run. As discussed above, one subroutine, PRED, is not included in NONMEM itself.<br>
-3-<br>
<hr>
<A name=12></a>Chapter 1 - Introduction to NONMEM, PREDPP, and NM-TRAN<br>
<b>3.2. PREDPP and the PREDPP Library</b><br>
PREDPP is not a single subroutine. It is a collection of FORTRAN subroutines. Some of these are always<br>needed but must be supplied by the user himself (see PK and ERROR below). Others are always needed<br>and are supplied; these are called the kernel routines. Others (subroutines ADVAN and TRANS, for exam-<br>ple) are also always needed, and are supplied, but are chosen from different versions corresponding to dif-<br>ferent pharmacokinetic models. The collection of supplied routines constitutes the PREDPP Library.<br>
<b>3.3. Subroutines PK and ERROR</b><br>
Tw o very important subroutines of PREDPP are called PK and ERROR. PK computes the values of the<br>population or individual pharmacokinetic parameters (e.g., CL and V) of a given model and accounts for<br>the &quot;differences&quot; between individual and population values. ERROR accounts for the &quot;differences&quot;<br>between predicted and observed values. These two subroutines are where the basic task of modelling is<br>carried out; this task is the user’s responsibility. Chapters 7 and 8 are devoted to a description of these sub-<br>routines.<br>
Figure 1.2 shows the major components of PREDPP.<br>
PREDPP kernal subroutines<br>
ADVAN  and TRANS<br>
PK<br>
ERROR<br>
Figure 1.2. Components of PREDPP. ADVAN and TRANS are chosen from the PREDPP library. PK and ERROR are user-supplied.<br>
<b>3.4. Building an Executable Module for NONMEM</b><br>
Whether PREDPP is used or a special purpose PRED subroutine is written, the PRED subroutine must be<br>combined (&quot;linked&quot;) with NONMEM; this process (which is sometimes is called &quot;link editing&quot; or &quot;load-<br>ing&quot;) must take place before the actual NONMEM run. The NONMEM-PRED combination is generally<br>called a &quot;load module&quot; or &quot;executable module&quot;. Compiling and linking are processes which are operating<br>system dependent; each installation must supply its own commands and procedures for these tasks. They<br>may be done before the NM-TRAN step or between it and the NONMEM step. This choice is discussed in<br>Section 3.7 below. For certain platforms, a front-end interface provided by the NONMEM Project Group<br>(nmfe72.bat for MS/DOS; nmfe72 C-shell script for Unix-type) can be used to perform these steps, and can<br>create all both types of load modules described below: generated subroutines and user-written subroutines.<br>
<b>3.5. NM-TRAN</b><br>
NM-TRAN provides the following services: control language translation, model speciﬁcation via FOR-<br>TRAN-like statements (called abbreviated code), partial differentiation, and preprocessing of the data.<br>They are discussed separately.<br>
<b>3.6. Control Language Translation</b><br>
NM-TRAN includes a language for communicating control information to NONMEM. NM-TRAN records<br>are free-form (i.e., spacing between options within a record and the order of the records and their options is<br>ﬂexible) and use English words (or their abbreviations) for options. For example, the record name $ESTI-<br>MATION may be abbreviated to $EST; the option name SIGDIGITS may be abbreviated to SIG. Either<br>spaces or commas may be used to separate options. Defaults are understood for most options, allowing the<br>records to be relatively compact. Considerable error checking is performed by NM-TRAN. This reduces<br>the number and severity of the errors that can occur during the NONMEM run. NM-TRAN also produces<br>messages that warn the user of possible errors in the data and/or control stream.<br>
-4-<br>
<hr>
<A name=13></a>Chapter 1 - Introduction to NONMEM, PREDPP, and NM-TRAN<br>
NM-TRAN translates a ﬁle of NM-TRAN control records into NONMEM control records, which use a<br>ﬁxed-ﬁeld, predominately numerical control language.<br>
<b>3.7. Model Speciﬁcation via Abbreviated Code</b><br>
With PREDPP, FORTRAN subroutines PK and ERROR are needed to specify parts of the pharmacostatisti-<br>cal model. In most cases, these speciﬁcations can be directly expressed within NM-TRAN records $PK<br>and $ERROR, using FORTRAN-like assignment and conditional statements called abbreviated code.<br>These statements are implemented by NM-TRAN as complete FORTRAN subroutines in ﬁle FSUBS,<br>incorporating the abbreviated code. An intermediate step between the NM-TRAN and NONMEM steps is<br>needed to compile these subroutines and link them with NONMEM-PREDPP.<br>
The message &quot;Recompiling certain components&quot; will be displayed at the console at this step.<br>
Figure 1.3 shows how the compile and link step relates to the two steps of Figure 1.1.<br>
A file of NM-TRAN<br>
A data file<br>
records<br>
NM-TRAN<br>
A file of<br>FORTRAN  subroutines:<br>
FORTRAN<br>
PK and ERROR<br>
compiler  and<br>
Control and data<br>
loader<br>
files for NONMEM<br>
NONMEM<br>
PREDPP<br>
Generated<br>PK,ERROR<br>
NONMEM output report<br>
Figure 1.3. Building a NONMEM load module with generated FORTRAN subroutines. An intermediate step is placed between the<br>
two steps of Figure 1.1.<br>
If the user supplies complete PK and ERROR subroutines (i.e., $PK and $ERROR records are not used),<br>then the NONMEM load module can be built at any time.<br>
Note that even when PREDPP is not used, the same options exist. For example, if the desired model can be<br>expressed via a $PRED record, then NM-TRAN will generate a complete PRED subroutine. However,<br>whereas NM-TRAN’s FORTRAN-like syntax is sufﬁcient for most purposes of writing PK and ERROR<br>subroutines, it is not sufﬁcient for writing any but the simplest of PRED subroutines.<br>
<b>3.8. Partial Differentiation</b><br>
NONMEM requires that PRED (whether PREDPP or user-written) compute more than just predicted val-<br>ues. It must also compute certain partial derivatives with respect to the random variables η and ε described<br>in Chapters 3 and 4. When $PK, $ERROR, or $PRED records are used, NM-TRAN performs symbolic<br>differentiation to generate the code needed to compute these derivatives. This relieves the user of a major<br>burden.<br>
<b>3.9. Data Preprocessor</b><br>
NM-TRAN includes a Data Preprocessor program which allows the user greater ﬂexibility in constructing<br>his data ﬁle than is allowed in a data ﬁle input directly into NONMEM. This is discussed in Chapter 6.<br>
<b>4. Additional Documentation</b><br>
More information can be found in the other parts of the NONMEM Users Guide, all of which may be found<br>as pdf ﬁles on the NONMEM distribution medium.<br>
-5-<br>
<hr>
<A name=14></a>Chapter 1 - Introduction to NONMEM, PREDPP, and NM-TRAN<br>
<b>Part I - Users Basic Guide</b><br>
A thorough, step by step discussion of the various features and some of the statistical concepts<br>involved in using NONMEM, including many examples.<br>
<b>Part II - Users Supplemental Guide</b><br>
A continuation of Part I which includes advanced features of NONMEM.<br>
<b>Part III - NONMEM Installation Guide</b><br>
A guide for installing NONMEM, PREDPP, and NM-TRAN.<br>
<b>Part IV - NM-TRAN Guide</b><br>
A complete reference guide to NM-TRAN and the Data Preprocessor.<br>
<b>Part V - Introductory Guide</b><br>
The present document.<br>
<b>Part VI - PREDPP Guide</b><br>
A complete reference guide to PREDPP.<br>
<b>Part VII - Conditional Estimation Methods</b><br>
A description of these methods and some guidelines for their use.<br>
<b>Part VIII - Help Guide</b><br>
A fast way to locate information on a given word or topic. The content of the Help Guide is also sup-<br>plied on the NONMEM distribution medium as both text ﬁles (&quot;on-line help&quot;) and html ﬁles for on-<br>line searching.<br>
<b>NONMEM V Supplemental Guide</b><br>
Describes new features of NONMEM V.<br>
<b>Introduction to Version VI</b><br>
Describes new features of NONMEM VI.<br>
<b>Introduction to NONMEM Version 7.</b><br>
Describes new features of NONMEM 7.<br>
-6-<br>
<hr>
<A name=15></a><b>Chapter 2 - NONMEM Examples</b><br>
<b>1. What This Chapter is About</b><br>
In this chapter, two examples of the use of NONMEM will be given. The ﬁrst estimates pharmacokinetic<br>parameters of an individual from his data; the second estimates so-called population parameters from data<br>from a group of individuals. The examples serve to introduce NONMEM notation, input and output, and to<br>provide an idea of what is possible using the system. The second example will be discussed again in Chap-<br>ter 11.<br>
<b>2. An Individual’s Theophylline Kinetics</b><br>
Figure 2.1 shows the input used to ﬁt a model to observations of theophylline plasma concentration <i>vs </i>time<br>in a single individual after a single dose of 320 mg.<br>
<b>$PROB SIMPLE NONLINEAR REGRESSION - THEOPHYLINE<br>$INPUT ID AMT TIME DV<br>$DATA P2DATA<br>$SUBROUTINE ADVAN2<br>$PK</b><br>
<b>KA=THETA(1)<br>K=THETA(2)<br>V=THETA(3)<br>S2=V</b><br>
<b>$ERROR</b><br>
<b>Y=F+ERR(1)</b><br>
<b>$THETA (0, 1.7) (0, .102) (0, 29.)<br>$OMEGA 1.2<br>$ESTIMATION PRINT=5<br>$COVARIANCE<br>$TABLE ID AMT TIME<br>$SCATTER PRED VS DV</b><br>
<b>UNIT</b><br>
Figure 2.1. The input (i.e., NM-TRAN control records) for analysis of some individual theophylline data.<br>
The ﬁrst line (record) gives a name to the problem. The rest of the lines (records) discuss the<br>data, the model, and the desired output. Before going into these in some greater detail, you may<br>want to look right now at ﬁgures 2.1 and 2.2, and then 2.4 and 2.5. Figure 2.2 shows the data for<br>this problem, and ﬁgures 2.4 and 2.5 show some of NONMEM’s output. All you need to know to<br>get a good idea of what this analysis shows is that the one-compartment model with ﬁrst-order<br>absorption has been used; the observed concentrations and the times of observation after the bolus<br>dose are in columns 4 and 3, respectively, of ﬁgure 2.2; and that the symbol DV stands for depen-<br>dent variable (the observed concentrations, in this case). You should, for example, even at this<br>point, be able to tell that the estimate of Volume of Distribution (V in ﬁgure 2.1, and THETA(3)<br>in ﬁgure 2.4) is 32 liters (L), with a standard error of ±1. 26 L. Now consider the ﬁgures in<br>greater detail.<br>
<b>2.1. The NM-TRAN Control Records</b><br>
The second record of ﬁgure 2.1 names the data items that appear on each data record, and the<br>third record gives the name of the ﬁle containing the data records, P2DAT A in this example. Fig-<br>ure 2.2 shows the contents of P2DAT A.<br>
-7-<br>
<hr>
<A name=16></a>Chapter 2 - NONMEM Examples<br>
<b>2</b><br>
<b>320. 0.</b><br>
<b>0.</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>.27 1.71</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>.52 7.91</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>1.</b><br>
<b>8.31</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>1.92 8.33</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>3.5 6.85</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>5.02 6.08</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>7.03 5.4</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>9.</b><br>
<b>4.55</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>12. 3.01</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>24.3 .90</b><br>
Figure 2.2. The contents of the data ﬁle containing the data records.<br>
According to the second record of ﬁgure 2.1, the third data item (column) of a data record is<br>TIME, the time associated with the event described by that data record. The event at a given time<br>(for this simple data set) can either be the administration of a dose or the acquisition of an obser-<br>vation. The second data item of a data record is AMT, amount (in this case in mg) of the dose<br>given at TIME, the time of the record. Apparently, 320 mg is given at time zero (ﬁrst record of<br>ﬁgure 2.2), and no further doses are given (all zeros in column 2 thereafter). The fourth data item<br>(column) in P2DAT A is named DV, for Dependent Variable (the measured plasma theophylline<br>concentration), as already mentioned. So, all of the data records, except the ﬁrst, give the time<br>after the 320 mg dose, and the concentration of theophylline (in mg/L) measured in a plasma<br>sample drawn at that time. The ﬁrst data item is labelled ID for the IDentiﬁcation number of the<br>patient. Here it happens to be 2.<br>
<b>2.2. The Model</b><br>
The fourth record of ﬁgure 2.1 identiﬁes the pharmacokinetic model PREDPP is to use: the one-<br>compartment model with ﬁrst-order absorption. It is implemented by an ADVAN subroutine (see<br>Chapter 1, Section 3.2) which is called ADVAN2 (See Chapter 7). Figure 2.3 shows the part of<br>the output of NONMEM for this problem that veriﬁes the user’s choice of model. It also<br>describes the features of the model in terms of its compartments. Of relevance to this problem<br>are the DEPOT compartment (where the dose goes, and from which drug enters the central com-<br>partment by a ﬁrst order process), and the CENTRAL compartment itself. Note, for example,<br>that the default compartment for doses (i.e., where PREDPP will add doses if not otherwise<br>instructed) is the DEPOT compartment, as it should be.<br>
<b>ONE COMPARTMENT MODEL WITH FIRST-ORDER ABSORPTION (ADVAN2)</b><br>
<b>MAXIMUM NO. OF BASIC PK PARAMETERS:</b><br>
<b>3</b><br>
<b>BASIC PK PARAMETERS (AFTER TRANSLATION):</b><br>
<b>ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.:</b><br>
<b>1</b><br>
<b>ABSORPTION RATE (KA) IS BASIC PK PARAMETER NO.:</b><br>
<b>3</b><br>
<b>COMPARTMENT ATTRIBUTES<br>COMPT. NO.</b><br>
<b>FUNCTION INITIAL</b><br>
<b>ON/OFF DOSE DEFAULT</b><br>
<b>DEFAULT</b><br>
<b>STATUS ALLOWED</b><br>
<b>ALLOWED FOR DOSE FOR OBS.</b><br>
<b>1</b><br>
<b>DEPOT OFF YES YES YES NO</b><br>
<b>2</b><br>
<b>CENTRAL ON</b><br>
<b>NO YES</b><br>
<b>NO YES</b><br>
<b>3</b><br>
<b>OUTPUT OFF</b><br>
<b>YES NO</b><br>
<b>NO NO</b><br>
Figure 2.3. The PREDPP output that veriﬁes the user’s choice of model. Features of the model are discussed, such as<br>the names and numbering of parameters, and the attributes of the various compartments in the model.<br>
The ﬁfth input record (ﬁgure 2.1) signals the start of the user’s speciﬁcation of the model for the<br>pharmacokinetic parameters. This speciﬁcation is given in the next 4 lines of so-called<br>
-8-<br>
<hr>
<A name=17></a>Chapter 2 - NONMEM Examples<br>
abbreviated code (the $PK record, along with this abbreviated code is called the $PK block).<br>Some of the parameters that NONMEM estimates are denoted by θ herein, and are labeled<br>THETA in NONMEM input and output. The model speciﬁed in ﬁgure 2.1 is very simple. It says<br>that a different unknown constant (NONMEM parameter) is to be assigned to each pharmacoki-<br>netic parameter: ﬁrst-order absorption rate, KA (line 1 of the PK block, after the $PK record -<br>THETA(1)), rate constant of elimination, K (line 2 - THETA(2)), and volume of distribution, V<br>(line 3 - THETA(3)). The S2 parameter (a so-called scale parameter) is discussed in Chapter 3,<br>Section 2.2.<br>
The sixth input record (ﬁgure 2.1 - 11<i>th </i>line) signals the start of the user’s speciﬁcation of the<br>(statistical) model for the lack of ﬁt of the pharmacokinetic model to the data. This speciﬁcation<br>is given in the next line of abbreviated code (the $ERROR record, along with this line of abbrevi-<br>ated code is called the $ERROR block). The model here says that observations differ from pre-<br>dictions by an additive error (ERR(1)).<br>
Record 7 ($THETA) gives NONMEM information about possible values of each element of θ in<br>the format: lower bound, initial estimate, upper bound. When, as in this particular record, only<br>two numbers are given for an element of θ , these are understood to mean the lower bound and ini-<br>tial estimate; the upper bound is unlimited. Record 8 ($OMEGA) gives NONMEM an initial esti-<br>mate of the variance of ERR(1). This statistical parameter is often denoted by σ 2 in statistical<br>discussions, but with data from a single individual, it is denoted by Ω in NONMEM documenta-<br>tion, and by OMEGA in NONMEM input and output. It is understood that a variance parameter<br>is always nonnegative. The $OMEGA record is further discussed in Chapter 9, Section 3.<br>
<b>2.3. The Output</b><br>
Record 9 ($ESTIMATION) instructs NONMEM to obtain estimates of the parameters, and the<br>next record ($COVARIANCE) asks that it also obtain standard errors of the parameter estimates.<br>The output is shown in ﬁgure 2.4. It requires little discussion. The ﬁrst item, the minimum value<br>of the objective function, is a goodness of ﬁt statistic, much like a sum of squares (and as with a<br>sum of squares, the lower the value, the better the ﬁt). The parameter estimates (the parameter<br>values at which the objective function is minimized) and their standard errors follow. Note that<br>the estimate of OMEGA, too, has a standard error. Unlike most ﬁtting programs, NONMEM<br>treats this parameter like any other.<br>
-9-<br>
<hr>
<A name=18></a>Chapter 2 - NONMEM Examples<br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** MINIMUM VALUE OF OBJECTIVE FUNCTION</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>************************************************** 8.940</b><br>
<b>**************************************************</b><br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** FINAL PARAMETER ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>TH 3</b><br>
<b>1.94E+00 1.02E-01 3.20E+01</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1</b><br>
<b>ETA1 8.99E-01</b><br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** STANDARD ERROR OF ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>TH 3</b><br>
<b>6.28E-01 7.35E-03 1.25E+00</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1</b><br>
<b>ETA1 5.44E-01</b><br>
Figure 2.4. NONMEM output giving the goodness of ﬁt statistic (the minimum value of the objective function) the<br>
parameter estimates, and their standard errors.<br>
The next to last control record asks NONMEM to print a table displaying the input data and cer-<br>tain computed quantities. A portion of a NONMEM table is shown in ﬁgure 10.10 of Chapter 10.<br>The last control record asks NONMEM to make a scatterplot of the prediction of each plasma<br>concentration (PRED) VS the observed value (DV) and to draw the line of identity (UNIT, for<br>&quot;unit slope&quot; line) on the plot. The plot is shown in ﬁgure 2.5.<br>
-10-<br>
<hr>
<A name=19></a>Chapter 2 - NONMEM Examples<br>
<b>PRED VS.</b><br>
<b>DV</b><br>
<b>8.00E-01 2.34E+00 3.88E+00</b><br>
<b>PRED 5.42E+00</b><br>
<b>6.96E+00 8.50E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>7.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.*. .<br>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>2.26E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>3.82E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>DV .</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.38E+00. *</b><br>
<b>.</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>6.94E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*.</b><br>
<b>8.50E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 2.5. A scatterplot of the observed data (DV) vs the predictions of the best-ﬁtting model parameters (PRED).<br>
The line of identity (intercept = 0; slope = 1) is drawn. If all points fell on that line, the ﬁt would be perfect.<br>
<b>3. A Population Model for Phenobarbital</b><br>
About 60 infants were given phenobarbital therapeutically. A plasma concentration was mea-<br>sured in each some hours after the ﬁrst (loading) dose, followed by multiple maintenance doses.<br>A second, and sometimes a third concentration were measured later. In all, 155 concentrations<br>were observed. Figure 2.6 gives the NM-TRAN control records. The data are too lengthy to<br>show in full, but ﬁgure 2.7 shows the data for the ﬁrst individual†. Figures 2.8 - 2.10 have some<br>relevant output. Again, most of the analysis results are apparent from the ﬁgures, and you should<br>try to see if you can ﬁgure them out before going further. Note that the $INPUT record now<br>deﬁnes a new data item, WT, the patient weight. It’s value is given on every data record for an<br>individual, in the column indicated. This is so despite the fact that WT may not change within an<br>individual. This is a bit repetitious, but convenient.<br>
† File PHENO of NONMEM distribution medium contains the complete data set.<br>
-11-<br>
<hr>
<A name=20></a>Chapter 2 - NONMEM Examples<br>
<b>$PROBLEM PHENOBARB<br>$INPUT ID TIME AMT WT APGR DV<br>$DATA PHENO<br>$SUBROUTINE ADVAN1<br>$PK</b><br>
<b>TVCL=THETA(1)<br>CL=TVCL+ETA(1)<br>TVVD=THETA(2)<br>V=TVVD+ETA(2)</b><br>
<b>; THE FOLLOWING ARE REQUIRED BY PREDPP</b><br>
<b>K=CL/V<br>S1=V</b><br>
<b>$ERROR</b><br>
<b>Y=F+ERR(1)</b><br>
<b>$THETA (0,.0047) (0,.99)<br>$OMEGA .0000055, .04<br>$SIGMA 25<br>$ESTIMATION PRINT=5<br>$TABLE ID TIME AMT WT APGR<br>$COVARIANCE<br>$SCATTER PRED VS DV</b><br>
<b>UNIT</b><br>
<b>$SCATTER RES</b><br>
<b>VS WT</b><br>
Figure 2.6. NM-TRAN control records for analysis of some population phenobarbital data.<br>
<b>1</b><br>
<b>0.</b><br>
<b>25.0 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>2.0 .</b><br>
<b>1.4 7</b><br>
<b>17.3</b><br>
<b>1</b><br>
<b>12.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>24.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>37.0 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>48.0 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>60.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>72.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>85.3 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>96.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>108.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>1</b><br>
<b>112.5 .</b><br>
<b>1.4 7</b><br>
<b>31.0</b><br>
Figure 2.7. The ﬁrst individual’s phenobarbital data.<br>
<b>3.1. The NM-TRAN Control Records</b><br>
The records are very similar to those for the theophylline problem. The new features are that the<br>model has changed (it is implemented by ADVAN1, not ADVAN2), the model for the pharma-<br>cokinetic parameters is more complicated, and an additional scatterplot is requested. The data for<br>each infant is similar to those shown in ﬁgure 2.7; however, now all of the data records for each<br>infant start with the <i>same </i>value for the ID data item (column 1), but this value differs <i>between<br></i>infants.<br>
<b>3.2. The Model</b><br>
ADVAN1 implements the one-compartment (monoexponential) model, without ﬁrst order absorp-<br>tion. No absorption model was needed for this problem because all concentrations were mea-<br>sured many hours after the last (oral) dose, so absorption could be considered to be complete,<br>and, for the purposes of data analysis, immediate.<br>
The parameters of the one-compartment model are deﬁned by the abbreviated code following the<br>$PK statement: Clearance (CL) and Volume of Distribution (V). However, here each parameter is<br>not simply equal to one of NONMEM’s parameters (an element of THETA). Rather, CL, for<br>example, is equal to a parameter (THETA(1)) plus a new term, ETA(1). The latter expresses<br>
-12-<br>
<hr>
<A name=21></a>Chapter 2 - NONMEM Examples<br>
interindividual variability, and stands for the deviation of the individual’s true clearance (CL)<br>from the population value (TVCL, Typical Value of CLearance, which, in turn, is simply<br>THETA(1)). This model is essentially different from the theophylline model, because it incorpo-<br>rates interindividual variability (something that an individual model need not do). Note that since<br>PREDPP ultimately needs the values of microconstants, rather than physiological-based pharma-<br>cokinetic parameters such as clearance, code must be given for K, the rate constant of elimina-<br>tion. There is, though, a simple alternative to writing this additional line of code. It is discussed<br>in Chapter 3 Section 2.1.<br>
The abbreviated code after the $ERROR record is exactly the same as that with the theophylline<br>data and expresses the same model for lack-of ﬁt between observations and predictions for an<br>individual. The $OMEGA and $SIGMA records, which give NONMEM information about the<br>estimated variances of the ETA and ERR variables, are discussed in Chapter 9, Section 3. Previ-<br>ously the initial estimate of the variance of ERR(1) was given on a $OMEGA record. Here it is<br>given on a $SIGMA record. This difference in NONMEM conventions between individual type<br>data and population type data will be discussed more fully in Chapters 3 and 4.<br>
<b>3.3. The Output</b><br>
NONMEM is again instructed to estimate the parameters and their standard errors. The results<br>are shown in ﬁgures 2.8 and 2.9.<br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** MINIMUM VALUE OF OBJECTIVE FUNCTION</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>************************************************** 717.203</b><br>
<b>**************************************************</b><br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** FINAL PARAMETER ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>5.48E-03 1.40E+00</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1 ETA2</b><br>
<b>ETA1 6.85E-06</b><br>
<b>ETA2 0.00E+00</b><br>
<b>2.86E-01</b><br>
<b>SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS</b><br>
<b>****</b><br>
<b>EPS1</b><br>
<b>EPS1 8.01E+00</b><br>
Figure 2.8. NONMEM output giving the goodness of ﬁt statistic (the minimum value of the objective function) and the<br>
parameter estimates for the phenobarbital problem.<br>
-13-<br>
<hr>
<A name=22></a>Chapter 2 - NONMEM Examples<br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** STANDARD ERROR OF ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>4.86E-04 7.84E-02</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1 ETA2</b><br>
<b>ETA1 2.27E-06</b><br>
<b>ETA2 .........</b><br>
<b>8.34E-02</b><br>
<b>SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS</b><br>
<b>****</b><br>
<b>EPS1</b><br>
<b>EPS1 1.49E+00</b><br>
Figure 2.9. NONMEM output giving the standard errors of the parameter estimates for the phenobarbital problem.<br>
Note that now there are estimates of the variances of the interindividual differences in CL<br>(OMEGA - ETA1) and V (OMEGA - ETA2), as well as of the residual error variance (denoted by<br>SIGMA in NONMEM output when the data are from a population; again, see Chapters 3 and 4).<br>There are also standard errors for these estimates.<br>
The next-to-last control record asks NONMEM to make the same kind of scatterplot as in the<br>theophylline problem: a plot of the predictions vs the observations. Here, a prediction for an indi-<br>vidual’s observation is based on typical (population) values of the pharmacokinetic parameters<br>(see ﬁgure 2.8), rather than the values of the pharmacokinetic parameters for the speciﬁc individ-<br>ual. The plot is shown in ﬁgure 2.10.<br>
-14-<br>
<hr>
<A name=23></a>Chapter 2 - NONMEM Examples<br>
<b>PRED VS.</b><br>
<b>DV</b><br>
<b>0.00E+00 2.60E+01 5.20E+01</b><br>
<b>PRED 7.80E+01</b><br>
<b>1.04E+02 1.30E+02</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>**</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* ** * *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*3 *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.80E+01. *</b><br>
<b>*** *2</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* 3*2 *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2 *</b><br>
<b>. *2 2* *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*2 **2*. * *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*2* 2 . * *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*2</b><br>
<b>*</b><br>
<b>** *   **</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>** *** 3. *</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>. 2   *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* 2</b><br>
<b>. ** *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *.2 * *</b><br>
<b>.</b><br>
<b>3.10E+01. * **** 2**</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>22* * *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>DV .</b><br>
<b>* *   **</b><br>
<b>* *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>4.40E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>5.70E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 2.10. A scatterplot of the observed data (DV) vs the predictions with the best ﬁtting model parameters (PRED).<br>
The line of identity (intercept = 0; slope = 1) is drawn. If all points fell on that line, the ﬁt would be perfect. Here, in<br>
contrast to ﬁgure 2.5, the data arise from many different individuals. One cannot tell which data came from which<br>
infant.<br>
Although the ﬁt is fairly good, the points far to the right of the line of identity of ﬁgure 2.10 indi-<br>cate that there are many predictions (PRED) that are much higher than their corresponding obser-<br>vations (DV). This is seen from another point of view in the second scatterplot. This scatterplot<br>plots residuals (RES) vs patient weight (from the data item, WT — see ﬁgure 2.6). A residual is<br>the difference between an observed concentration and its prediction (the same prediction used in<br>the scatterplot of ﬁgure 2.10). The residuals reﬂect not only lack of ﬁt between observations and<br>predictions for a given individual (the variance SIGMA), but also interindividual variability (the<br>variances comprising OMEGA). They can be thought of as reﬂecting the part of the data that the<br>model does not explain. As can be seen from ﬁgure 2.11, there is a clear relationship between the<br>sign and magnitude of the residuals and patient weight. Here, the patients with the largest<br>weights have the most negative residuals; i.e., their predictions are much larger than their observa-<br>tions. These are the same points that fell on the far right of ﬁgure 2.10.<br>
-15-<br>
<hr>
<A name=24></a>Chapter 2 - NONMEM Examples<br>
<b>RES VS.</b><br>
<b>WT</b><br>
<b>-9.00E+01 -6.60E+01 -4.20E+01</b><br>
<b>RES -1.80E+01</b><br>
<b>6.00E+00 3.00E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*. *** 2</b><br>
<b>*</b><br>
<b>**2 .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* 2   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>23 2*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* **. **23*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>22 **2 4*3*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.14E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.*2*42*** .</b><br>
<b>.</b><br>
<b>*** 34**</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>***222224* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** ** ******</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * ***3 *</b><br>
<b>.</b><br>
<b>1.78E+00. **2</b><br>
<b>** 2*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>WT .</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2.42E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.06E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 2.11. A scatterplot of the residuals (RES) vs patient weight (WT). The pattern suggests that observations are<br>
underpredicted in infants with low weight, and overpredicted in those with higher weights.<br>
An obvious explanation is that Clearance or Volume, or both, increase with weight, so that with-<br>out weight being taken into account, too high a prediction is being made for a larger infant and<br>too low a prediction is being made for a smaller infant, all other things (i.e., dose) being equal.<br>To see if accounting for weight improves the ﬁt, the run speciﬁed in ﬁgure 2.12 can be done.<br>
-16-<br>
<hr>
<A name=25></a>Chapter 2 - NONMEM Examples<br>
<b>$PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V<br>$INPUT ID TIME AMT WT APGR DV<br>$DATA PHENO<br>$SUBROUTINE ADVAN1<br>$PK</b><br>
<b>TVCL=THETA(1)+THETA(3)*WT<br>CL=TVCL+ETA(1)<br>TVVD=THETA(2)+THETA(4)*WT<br>V=TVVD+ETA(2)</b><br>
<b>; THE FOLLOWING ARE REQUIRED BY PREDPP</b><br>
<b>K=CL/V<br>S1=V</b><br>
<b>$ERROR</b><br>
<b>Y=F+ERR(1)</b><br>
<b>$THETA (0,.0027) (0,.70) .0018</b><br>
<b>.5</b><br>
<b>$OMEGA .000007, .3<br>$SIGMA 8<br>$ESTIMATION PRINT=5<br>$COVARIANCE<br>$TABLE ID TIME AMT WT APGR DV<br>$SCATTER PRED VS DV</b><br>
<b>UNIT</b><br>
<b>$SCATTER RES</b><br>
<b>VS WT</b><br>
Figure 2.12. NM-TRAN control records for ﬁtting a model taking into account the effect of patient weight to the popu-<br>lation phenobarbital data.<br>
Now both TVCL and TVVD are linear functions of weight with, in the case of TVCL, for exam-<br>ple, intercept THETA(1), and slope THETA(3). Both slope and intercept are &quot;population&quot; param-<br>eters since they relate weight to typical population values of the pharmacokinetic parameter. Now<br>we see why WT is giv en in every data record: the abbreviated PK code may need to be evaluated<br>at each event time. If WT did not change over time within any patient, it could be given only on<br>the ﬁrst data record for each patient, but then slightly more complicated abbreviated code would<br>be needed. The output from running the input of ﬁgure 2.12 is shown in ﬁgures 2.13 - 2.16.<br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** MINIMUM VALUE OF OBJECTIVE FUNCTION</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************<br>************************************************** 609.134</b><br>
<b>**************************************************</b><br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** FINAL PARAMETER ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>TH 3</b><br>
<b>TH 4</b><br>
<b>1.43E-11 1.21E-01 4.77E-03 9.18E-01</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1 ETA2</b><br>
<b>ETA1 1.36E-06</b><br>
<b>ETA2 0.00E+00</b><br>
<b>7.51E-02</b><br>
<b>SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS</b><br>
<b>****</b><br>
<b>EPS1</b><br>
<b>EPS1 8.71E+00</b><br>
Figure 2.13. The minimum objective function value and parameter estimates for the phenobarbital data, using the<br>
model of ﬁgure 2.12, which takes into account the effect of patient weight.<br>
-17-<br>
<hr>
<A name=26></a>Chapter 2 - NONMEM Examples<br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** STANDARD ERROR OF ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>TH 3</b><br>
<b>TH 4</b><br>
<b>9.49E-11 1.46E-01 2.24E-04 1.13E-01</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1 ETA2</b><br>
<b>ETA1 7.24E-07</b><br>
<b>ETA2 .........</b><br>
<b>3.63E-02</b><br>
<b>SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS</b><br>
<b>****</b><br>
<b>EPS1</b><br>
<b>EPS1 1.71E+00</b><br>
Figure 2.14. The standard errors of the parameter estimates for the phenobarbital data, using the model of ﬁgure 2.12,<br>
which takes into account the effect of patient weight.<br>
Note the improvement in the minimum objective function value (it drops 108 points), and the pro-<br>found decreases in the sizes of the estimates of the interindividual variances; now that weight is in<br>the model, there is less unexplained interindividual variability. As will be discussed in Chapter 5,<br>the decrease in the objective function can be used for a formal hypothesis test of the appropriate-<br>ness of the new model (ﬁgure 2.12) for the effect of weight on the pharmacokinetic parameters.<br>
Note also the very small values estimated for THETA(1) and for its standard error. The intercept<br>term of TVCL does not appear to be an important part of the model. This model is reﬁned in<br>Chapter 10, Section 6.2, where it is seen that deleting THETA(1) and THETA(3) produces a<br>model that ﬁts as well as the model including them.<br>
-18-<br>
<hr>
<A name=27></a>Chapter 2 - NONMEM Examples<br>
<b>PRED VS.</b><br>
<b>DV</b><br>
<b>9.00E+00 1.78E+01 2.66E+01</b><br>
<b>PRED 3.54E+01</b><br>
<b>4.42E+01 5.30E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.. .<br>. * .   .<br>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>** **</b><br>
<b>.</b><br>
<b>. *   * . *</b><br>
<b>*</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*** *2</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.80E+01. *.**3*</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>2*32 .</b><br>
<b>.</b><br>
<b>*22* *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*4** * .</b><br>
<b>*</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*2</b><br>
<b>* *</b><br>
<b>.*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>2*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**2 2</b><br>
<b>*</b><br>
<b>. ** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* 2</b><br>
<b>.*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** 2</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * *   *</b><br>
<b>* *   *</b><br>
<b>.</b><br>
<b>3.10E+01. *</b><br>
<b>*</b><br>
<b>2*</b><br>
<b>*</b><br>
<b> </b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>..</b><br>
<b>.</b><br>
<b>**</b><br>
<b>.*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>** ** *   ** *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>DV .</b><br>
<b>* *   *</b><br>
<b>** .</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>4.40E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.70E+01. ..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 2.15. A scatterplot of predictions vs observations for the phenobarbital data, using the model of ﬁgure 2.12,<br>
which takes into account the effect of patient weight. Compare to ﬁgure 2.10.<br>
The scatterplots (ﬁgures 2.15 and 2.16) conﬁrm that the new model is an improvement: the group<br>of points far to the right of the line of identity have disappeared from the PRED vs DV plot, and<br>the plot of residuals vs weight no longer shows a pattern.<br>
-19-<br>
<hr>
<A name=28></a>Chapter 2 - NONMEM Examples<br>
<b>RES VS.</b><br>
<b>WT</b><br>
<b>-1.70E+01 -1.00E+01 -3.00E+00</b><br>
<b>RES 4.00E+00</b><br>
<b>1.10E+01 1.80E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>2* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*** .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*.* *</b><br>
<b>* *   *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>***** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>**</b><br>
<b>*</b><br>
<b>*. *</b><br>
<b>** 22</b><br>
<b>*2 * 2</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.14E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>* **** * * *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>**</b><br>
<b>* 3</b><br>
<b>. 2* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>***2. ** *</b><br>
<b>2* *</b><br>
<b>** **</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>3</b><br>
<b>*.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*** . * *</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.78E+00. *</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>2*</b><br>
<b>** *   *</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   **</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>WT .</b><br>
<b>*. *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>2.42E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>3.06E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 2.16. A scatterplot of residuals (RES) vs patient weight (WT) for the phenobarbital data, using the model of ﬁg-<br>
ure 2.12, which takes into account the effect of patient weight. Compare to ﬁgure 2.11.<br>
<b>4. Overview</b><br>
The examples in this chapter illustrate some of the most important and useful features of NON-<br>MEM.<br>
°<br>
NONMEM can ﬁt both individual and population models.<br>
°<br>
NONMEM has a menu of pharmacokinetic models from which the one appropriate to the<br>problem at hand can be chosen.<br>
°<br>
The user speciﬁes the relationship of pharmacokinetic parameters to independent variables<br>(such as WT in the phenobarbital example), using &quot;population&quot; parameters that will be esti-<br>mated.<br>
°<br>
The user also speciﬁes which parameters vary between individuals, and the form (model)<br>for this variability, as well as the form (model) for the differences between observations<br>from an individual and their predictions for this individual.<br>
°<br>
NONMEM estimates parameters describing both kinds of variability.<br>
°<br>
NONMEM provides estimates (standard errors) of the precision of its parameter estimates,<br>including those describing variability.<br>
°<br>
NONMEM provides a means of deciding whether one model (e.g., that including weight’s<br>effect on CL and V) ﬁts the data better than another using the minimum objective function<br>
-20-<br>
<hr>
<A name=29></a>Chapter 2 - NONMEM Examples<br>
value, a goodness-of-ﬁt statistic.<br>
°<br>
NONMEM provides (limited) graphics, useful in judging the adequacy of the model cur-<br>rently ﬁt to the data.<br>
-21-<br>
<hr>
<A name=30></a><b>Chapter 3 - Models for Individual Data</b><br>
<b>1. What This Chapter is About</b><br>
In this chapter, the notation and deﬁnitions we will use to discuss models for individual data will<br>be presented. The relationship of these models to data will be discussed, and a distinction<br>between pharmacokinetic structural models (that describe the underlying shape and form of the<br>data) and statistical error models (that describe the &quot;errors&quot; or differences between observations<br>and structural model predictions) will be made. Several error models will be discussed, as will a<br>useful modelling device, the indicator variable.<br>
<b>2. Pharmacokinetic Structural Models for Individual Data</b><br>
By individual data we usually mean data from a single individual (animal or human). One could<br>also be concerned with data comprised of a pharmacokinetic response at just one time point from<br>each of a number of individuals. Call this type of data single- response population data. This<br>name comes from the fact that data such as these can, of course, be regarded as a particular in-<br>stance of the more general data type, population data; i.e., data comprised of one <i>or more </i>pharma-<br>cokinetic responses at different time points from a number of individuals sampled from a popula-<br>tion. Although one can discuss the treatment of single-response population data as population da-<br>ta, they are often treated just as are individual data.<br>
A simple pharmacokinetic model for data from a single individual is the monoexponential (&quot;one-<br>compartment&quot;) model:<br>
<i>A </i>=<br>
<i>j</i><br>
<i>De</i>−<i>kt j</i><br>
(3.1)<br>
This model describes the typical time course of amount of drug in the body ( <i>A</i>), as a function of<br>initial dose (<i>D</i>), time (<i>t</i>), and a <i>parameter</i>, <i>k</i>. As we may be interested in <i>A </i>at several possible<br>times, we explicitly note this by the subscript <i>j </i>which indexes a list of times, <i>t</i>0, <i>t</i>1, . . . , <i>t j</i>, . . . , <i>tn</i>.<br>A way to write a generic form for a structural model, omitting details of its structure, is<br>
<i>y </i>=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ )<br>
(3.2)<br>
where <i>y </i>stands for some &quot;response&quot; (dependent variable) of interest ( <i>A </i>in (3.1)), the symbol <i>f<br></i>stands for the unspeciﬁed form of the model (a monoexponential such as in (3.1)), which is a<br>function of known quantities, <i>x </i>(<i>t j </i>and <i>D </i>in (3.1)), and <i>parameters</i>, φ (<i>k </i>in (3.1)). The quantities<br>in x are <i>known</i>, because they are either measured or controlled, and therefore, are called ﬁxed<br>effects, in contrast to effects which are not known and are regarded as random (see below). The<br>parameters in the parameter vector φ are called ﬁxed effect parameters because they quantify the<br>inﬂuence of the ﬁxed effects on the dependent variable. Each one of an individual’s pharmacoki-<br>netic parameters is a particular type of ﬁxed effect parameter. With NONMEM, parameters com-<br>prising θ are (usually) ﬁxed effect parameters, but these may or may not be an individual’s phar-<br>macokinetic parameters (contrast ﬁgures 2.1 and 2.6). Here we shall use the symbol φ for the pa-<br>rameter vector comprised speciﬁcally of an individual’s pharmacokinetic parameters (although<br>there will be some exception to this).<br>
Aside from the fact that the values given by a structural model are usually not the values observed<br>due to measurement error or model misspeciﬁcation, an amount of drug ( <i>A </i>of (3.1)) is usually not<br>itself observable. Instead, we may observe a concentration (<i>C</i>) of drug. We need an &quot;observation<br>scaling&quot; model to describe the relationship between <i>A </i>and <i>C</i>. This might be<br>
<i>˜</i><br>
<i>C </i>= <i>A j</i><br>
<i>j</i><br>
(3.3)<br>
<i>V</i><br>
-22-<br>
<hr>
<A name=31></a>Chapter 3 - Models for Individual Data<br>
where V is another parameter, Volume of Distribution. (We denote the concentration in model<br>(3.3) by the symbol <i>˜</i><br>
<i>C</i>, to distinguish it, the model-predicted value, from the actually observed<br>
value, <i>C</i>. This will soon be discussed further.) PREDPP assumes that there is always an obser-<br>vation scaling model like (3.3) that relates an amount of drug (in some compartment of the body)<br>to the observation, and therefore always expects a parameter, <i>Sn </i>that scales (i.e. divides) the pre-<br>dicted amount in the <i>nth </i>compartment. In the example above, <i>S</i>1 is simply <i>V </i>. In other examples,<br>to be discussed later, <i>Sn </i>can be more complicated. If a value for <i>Sn </i>is not speciﬁed, it is taken to<br>be 1. For the rest of this discussion, it is convenient to assume that φ itself includes a scaling<br>parameter (if such is needed, and even though such a parameter is not usually regarded as one of<br>an individual’s pharmacokinetic parameters) and that <i>f </i>actually includes observational scaling.<br>Note, considering the example of (3.3), that <i>x </i>≡ (<i>D</i>, <i>t</i>), and φ ≡ (<i>k</i>, <i>V </i>). Thus <i>x </i>and φ of (3.1) are<br>in general lists of things (vectors), not single things (scalars).<br>
PREDPP implements a number of pharmacokinetic models, such as the one-compartment model<br>(3.1), (3.3). These will be discussed more fully in Chapter 7. There is no need for further general<br>discussion of kinetic models, as we assume the readers of this document are familiar with phar-<br>macokinetics. However, two modelling features deserve further comment, alternative parameteri-<br>zations and the special parameter, <i>Sn </i>.<br>
<b>2.1. Alternative Parameterizations</b><br>
Recall the phenobarbital example of Chapter 2. For the ﬁrst run, the input contained, among<br>other things, some lines of code deﬁning the variables <i>CL </i>and <i>V </i>, and then the line<br>
<b>K = CL/V</b><br>
This line was needed because PREDPP expects the one-compartment model to be parameterized<br>using the parameter <i>K </i>, the rate constant of elimination, not clearance and volume of distribution.<br>However, we chose to estimate typical population values for <i>CL </i>and <i>V </i>, so we had to relate these<br>parameters to THETA and then relate <i>K </i>to <i>CL </i>and <i>V </i>. This is an example of reparametrization of<br>a model so that the pharmacokinetic parameters used are those of primary interest to the modeler.<br>In fact, we may use any parameterization we wish, so long as we are willing to include the repa-<br>rameterization line(s) that translate our parameters into those expected by PREDPP. (Chapter 7<br>discusses the parameters PREDPP expects for the various models it implements.) However, there<br>is a program called TRANS which automatically does this translation. Different versions of<br>TRANS exist in the PREDPP Library and correspond to translations of different parameteriza-<br>tions into that expected by PREDPP.<br>
<b>2.2. The Scale Parameter, S</b><br>
Usually, observations are concentrations. So, as in model (3.3), <i>S </i>will usually be set identical to<br><i>V </i>. Howev er, <i>S </i>is not always simply <i>V </i>. Some examples should clarify this point. (In the discus-<br>sion below, we avoid the notation <i>Sn</i>, and use <i>S</i>, to refer to the scale term for the amount in the<br>compartment in which concentrations are being measured.)<br>
<b>2.2.1. S Depends on a Known Constant</b><br>
This almost trivial case occurs when one wishes to match the units of predicted responses to those<br>of the data. For example, suppose <i>D </i>is in milligrams, but concentrations are in ng/ml. If no scal-<br>ing is done, the units of <i>V </i>will be kiloliters (i.e., <i>V </i>=1 corresponds to <i>V </i>=1000 liters). To avoid<br>this, one might choose the model<br>
<i>S </i>= <i>V </i>/1000<br>
thereby converting the units of <i>A </i>into micrograms, and since mcg/L ≡ ng/ml, the units of <i>V</i><br>
-23-<br>
<hr>
<A name=32></a>Chapter 3 - Models for Individual Data<br>
become liters. Of course, one could recode one’s data, dividing all concentrations by 1000 (or<br>multiplying the dose by 1000) and avoid this, but that may not be convenient.<br>
<b>2.2.2. S Depends on a Parameter</b><br>
Later in this chapter we will discuss a model used when the data arise from two different assays<br>(call them assay 1 and assay 2). In such a case, there may be a systematic (multiplicative) bias of<br>one assay relative to the other. If we wish to allow for this possibility, we might need a model<br>such as<br>
<i>V</i>,<br>
if <i>assay is </i>1<br>
<i>S </i>= <i>hV</i>, if <i>assay is </i>2<br>
where <i>h </i>is a new parameter that measures the proportional bias of the assays (i.e., bias causes the<br>apparent volume of distribution to be different for data from the two assays). The parameter <i>h </i>is<br>not really a pharmacokinetic parameter, but for the purpose of this discussion it can be included in<br>φ.<br>
<b>2.2.3. S Depends on an Element of x</b><br>
Later in this chapter we will describe a model useful when two kinds of responses are measured,<br>plasma and urine concentrations. In the case of urine concentrations, the predicted total drug in<br>the urine during a time period (available from an &quot;output&quot; compartment present in all models<br>implemented by PREDPP; see Chapter 7) would have to be scaled by the actual urine volume<br>during that time period. This volume would be an element of <i>x</i>, and <i>S </i>would be set equal to it.<br>
<b>3. Statistical Model for an Individual’s Observations</b><br>
One does not, in fact, ever observe the predicted plasma concentration (or any other predicted<br>response). What one observes is a measured value which differs from the predicted value by<br>some (usually small) amount called a residual error (also called intra-individual error). We reg ard<br>this error as a random quantity (see below). We will want NONMEM to ﬁt our model to our data,<br>and in so doing, provide us with estimates of the model parameters. The way NONMEM’s ﬁt fol-<br>lows the data is determined largely by what we tell it about the nature of the errors (see Chapter<br>5). We must therefore provide NONMEM with another model, an error model.<br>
There are many reasons that the actual observation may not correspond to the predicted value<br>(e.g. <i>˜</i><br>
<i>C </i>as given by the right side of (3.3)) The structural model may only be approximate, or the<br>
quantities in <i>x </i>may have been measured with error, or, as is always true, pharmacokinetic<br>responses may be measured with some error (assay error). It is too difﬁcult to model all these<br>sources of error separately, so we usually make the simplifying assumption that each difference<br>between an observation and its <i>prediction </i>(i.e. each error) is a randomly occurring number. When<br>the data are from a single individual, and the error model is the Additive error model (see Section<br>3.1, below), the error is denoted by η herein, by ETA in NONMEM output, and by ETA or ERR<br>in NM-TRAN input. (When data are from a population, and the same error model is used, this<br>error will be denoted ε ; see Chapter 4.) Therefore a model for the jth observation, <i>y j</i>, could be<br>written<br>
<i>y </i>=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + η <i>j</i><br>
(3.4)<br>
Implicit in using the symbol η in this way is the assumption that all residual errors come from<br>probability distributions with mean zero and the same (usually unknown) variance. (The error<br>variance is the mean <i>squared </i>error.) More complicated error models involving η can be written<br>(see below). A schematic of model (3.4) is shown for the structural model of (3.1), (3.3) in ﬁgure<br>3.1. Because this model describes the inﬂuence of both ﬁxed effects (<i>x j</i>) <i>and </i>random effects<br>
-24-<br>
<hr>
<A name=33></a>Chapter 3 - Models for Individual Data<br>
(η <i>j</i>), it is called a Mixed Effects Model (hence the name, NONMEM: <i>NON</i>linear <i>M</i>ixed <i>E</i>ffects<br><i>M</i>odel). Mixed effects models, in general, may have more than one random effect, and more than<br>one type of random effect (Chapter 4); (3.4) is only a particularly simple example.<br>
error<br>
C<br>
t<br>
Figure 3.1. <i>C </i>vs <i>t </i>for a monoexponential model. The solid line is <i>f </i>(<i>x</i>, φ ); the circles are the observed data points. An<br>
error is indicated.<br>
Even though errors are unpredictable random quantities, some information about them is usually<br>assumed, and some can be estimated. First, it is assumed that the mean error is zero. This simply<br>means that were the true values for the parameters in φ known, the model would have no system-<br>atic overall bias (e.g., be systematically below or above the data points, on average).<br>
A second aspect of the error, one that can be estimated by NONMEM, is its typical size. Since<br>errors may be positive or neg ative, their typical size is not given by their mean (which is zero),<br>but by their standard deviation, the square root of their variance. One can always simply convert<br>the variance into the standard deviation, and conversely. NONMEM output gives estimates of the<br>error variance. With individual data this variance is denoted in this text by ω 2, and by OMEGA<br>in NONMEM input and output. The standard deviation (SD) of the error is denoted ω herein.<br>The reason that OMEGA, rather than, for example, OMEGA SQ stands for ω 2 in NONMEM<br>input and output will be discussed in Section 3.8. (We will see, in Chapter 4, that when the error<br>is symbolized by ε , not η, its variance will be denoted σ 2 in this text, and SIGMA, not OMEGA,<br>in NONMEM input and output.) Here, the parameter ω 2 quantiﬁes the inﬂuence of the random<br>effect, η on the observations, <i>y</i>. It is therefore called a random effects parameter.<br>
<b>3.1. The Additive Error Model</b><br>
The symbol η is always used to denote a random quantity whose probability distribution has<br>mean zero and variance ω 2. Model (3.4) says that the errors themselves can be so regarded, and<br>since an observation equals its prediction (under the structural model) plus an error, model (3.4) is<br>called the Additive error model. This model is illustrated in ﬁgure 3.2.<br>
-25-<br>
<hr>
<A name=34></a>Chapter 3 - Models for Individual Data<br>
C<br>
t<br>
Figure 3.2. <i>C </i>vs <i>t </i>for a monoexponential model. The middle line is <i>f </i>(<i>x</i>, φ ); the outer lines give the approximate &quot;enve-<br>
lope&quot; for additive errors. Don’t be fooled by the apparent widening of the gap between the upper and lower curves as<br>
time increases: the vertical distance from the middle line to either outer line is everywhere the same.<br>
<b>3.2. The Constant Coefﬁcient of Variation and Exponential Models</b><br>
NONMEM allows an error model which can be more complicated than that of (3.4). One such<br>more complicated, but useful model is the Constant Coefﬁcient of Variation (CCV), or<br>Proportional error model,<br>
<i>y </i>=<br>
=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + <i>f </i>(<i>x j</i>, φ )η <i>j</i><br>
<i>f </i>(<i>x j</i>, φ )(1 + η <i>j</i>)<br>
(3.5)<br>
A fractional error is an error expressed as a fraction of the corresponding prediction. The CCV<br>model says that a fractional error can be written as an η, i.e. as a random quantity with mean zero<br>and variance ω 2. Under this model, the variance of an error itself is proportional to the squared<br>prediction, with ω 2 being the proportionality factor, and so is not constant over observations.<br>Since, under this model, the standard deviation of the error, and also of <i>y</i>, is ω <i>f </i>(<i>x</i>, φ ), and since<br>the mean of <i>y </i>is <i>f </i>(<i>x</i>, φ ) (when φ assumes its true value), the coefﬁcient of variation of <i>y </i>is just<br>the constant ω (the coefﬁcient of variation of a random quantity is deﬁned as its standard devia-<br>tion divided by its mean). This is the reason the CCV error model is so named. Also for this rea-<br>son, ω 2 is dimensionless, in contrast to having units equal to those of the squared observation as<br>with the Additive model. This error model is illustrated in ﬁgure 3.3.<br>
-26-<br>
<hr>
<A name=35></a>Chapter 3 - Models for Individual Data<br>
C<br>
t<br>
Figure 3.3. <i>C </i>vs <i>t </i>for a monoexponential model. The middle line is <i>f </i>(<i>x</i>, φ ); the outer lines give the approximate &quot;enve-<br>
lope&quot; for constant coefﬁcient of variation errors.<br>
The exponential error model is<br>
<i>y </i>=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) exp(η <i>j</i>)<br>
(3.5a)<br>
This model is sometimes referred to as the log-normal model, because it it is additive if logs are<br>taken (and because eta sj is assumed to be normally distributed):<br>
log <i>y </i>=<br>
<i>j</i><br>
log <i>f </i>(<i>x j</i>, φ ) + η <i>j</i><br>
(3.5b)<br>
See Chapter 8, Section 3.2 for a discussion of this model.<br>
<b>3.3. Combined Additive and CCV Error Model</b><br>
When most observations obey the CCV model but some observations may be near the lower limit<br>of detection of an assay, a model which may be useful is one which is a combination of both the<br>Additive and CCV error models:<br>
<i>y </i>=<br>
+ η<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + <i>f </i>(<i>x j</i>, φ )η1 <i>j</i><br>
2 <i>j</i>.<br>
(3.6)<br>
Here there are two types of η’s, η1 and η2. The ﬁrst has variance ω 21; the second has a possibly<br>different variance, ω 22. NONMEM permits several types of η’s. Under this model, the variance of<br>the error portion of the model is ω 21 <i>f </i>(<i>x j</i>, φ)2 + ω 22. When the prediction is near zero, the variance<br>is approximately constant, namely ω 22. This is the smallest variance possible and corresponds,<br>perhaps, to the limit of assay precision. When the prediction is considerably greater than zero,<br>the variance is approximately proportional to the squared prediction.<br>
-27-<br>
<hr>
<A name=36></a>Chapter 3 - Models for Individual Data<br>
<b>3.4. The Po wer Function Model</b><br>
A model that has both the additive and the CCV error models as special cases, and smoothly<br>interpolates between them in other cases is the Power Function model:<br>
<i>y </i>=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + <i>f </i>(<i>x j</i>, φ )<i>p</i>η <i>j</i>.<br>
(3.7)<br>
Here <i>f </i>(<i>x</i>, φ ) is raised to the <i>pth </i>power in the error model, rather than the 0<i>th </i>power (Additive<br>error model; note <i>a</i>0 = 1 for any number, <i>a</i>) or the ﬁrst power (CCV model). The parameter <i>p </i>is<br>a ﬁxed effects parameter, even though its role in the overall model is to modify the variance<br>model, not the structural model. With NONMEM all ﬁxed effect parameters must be elements of<br>the general parameter vector θ . If we want the Power Function Model to interpolate between the<br>additive and CCV models, <i>p </i>must be constrained to lie between 0 and 1. NONMEM allows this<br>(see Chapter 9). While one might be tempted to combine the Power Function model with the<br>Additive model, much as the CCV and Additive model were combined above, such a combination<br>model can lead to identiﬁability difﬁculties, and for this reason such a combination should be<br>avoided.<br>
<b>3.5. Two Different Types of Measurements</b><br>
Another more complicated error model can arise when more than one type of measurement is<br>made. Suppose, for sake of illustration, that the observations are drug concentrations, but that<br>they are measured with two different assays. If one assay may be more precise than the other,<br>then this is equivalent to saying that one assay has a smaller ω 2 than the other. We would like to<br>be able to take this into account in the analysis (i.e., not pay as much attention to the less precise<br>observations), and perhaps (if we have enough data) estimate the relative precision of the assays<br>as well. To do this in the notation we have introduced, an independent variable indicating which<br>observations are obtained with which assay is needed: we call such an independent variable an<br>indicator variable.<br>
<b>3.5.1. Use of an Indicator Variable</b><br>
Let one of the data items (an element of <i>x</i>) be labeled <i>ASY </i>, and let <i>ASY j </i>take the value 1 if the<br>assay used for <i>y j </i>was of the ﬁrst type, and the value 0, if it was of the 2nd type. The variable,<br>
<i>ASY </i>is an indicator variable, and it allows us to write an additive type error model, say, as<br>
<i>y </i>=<br>
η<br>
+<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + <i>ASY j </i>1 <i>j</i><br>
(1 − <i>ASY j</i>)η2 <i>j</i><br>
(3.8)<br>
Here there are two types of η’s, η1 and η2. The ﬁrst applies to the ﬁrst type of assay, and has<br>variance ω 21; the second applies to the second type of assay, and has a possibly different variance,<br>
ω 22. NONMEM permits several types of η’s. Different types of η’s can be correlated, and NON-<br>MEM can allow this. However, this is something we would only need to consider in the example<br>at hand if the same blood sample were measured by both assays. We will not emphasize this pos-<br>sibility in this introductory guide. (This possibility also applies to random variables describing<br>unexplained interindividual differences with population data; see Chapter 4)<br>
When the assay is done by the ﬁrst method, <i>ASY </i>will be unity, and (3.8) becomes<br>
<i>y </i>=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + η1 <i>j</i><br>
(3.8a)<br>
so that the variance of the error is ω 21. When the assay is done by the second method, <i>ASY </i>will be<br>zero, and (3.7) becomes<br>
<i>y </i>=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + η2 <i>j</i><br>
(3.8b)<br>
so that the variance of the error is now ω 22. Both ω 21 and ω 22 are random effect parameters.<br>
-28-<br>
<hr>
<A name=37></a>Chapter 3 - Models for Individual Data<br>
An equivalent form of the model that can be implemented easily is<br>
 <i>f </i>(<i>x</i><br>
if <i>ASY</i><br>
<i>y </i>=<br>
<i>j </i>, φ ) + η 1 <i>j </i>,<br>
<i>j is </i>1<br>
<i>j</i><br>
<br>
(3.8c)<br>
 <i>f </i>(<i>x j</i>, φ) + η2<i>j</i>, if <i>ASY j is </i>0<br>
<b>3.6. Two Different Types of Observations</b><br>
The same need for separate scales for different measurements can arise when more than one type<br>of observation is made. Suppose both plasma concentrations (<i>C</i>) and urine concentrations (<i>Cu</i>)<br>are measured. The structural model for <i>C j </i>might be (3.1), (3.3). If we assume that urine is col-<br>lected between each observation of <i>C</i>, then the structural model for <i>Cu j</i>, the drug concentration in<br>the urine collected between time <i>t j</i>−1 and time <i>t j </i>might be<br>
<i>D</i><br>
<i>˜</i><br>
<i>Cu </i>=<br>
<i>j</i><br>
<i>fo</i><br>
(<i>e</i>−<i>kt j</i>−1 − <i>e</i>−<i>kt j </i>)<br>
(3.9)<br>
<i>Vu j</i><br>
where <i>fo </i>is the fraction of drug excreted unchanged (a parameter), and <i>Vu j </i>is the urine volume<br>collected between time <i>t j</i>−1 and <i>t j </i>(a data item)†. Assuming again, for sake of the example, that<br>we want to use an additive type error model for the observations, the problem is that urine con-<br>centrations can be orders of magnitude larger than plasma concentrations, so that, while an addi-<br>tive error model might be appropriate for either type of observation alone, the two types of obser-<br>vations must have different typical error magnitudes; i.e., different variances (ω 2’s).<br>
An indicator variable can again be used. Let the indicator variable <i>TYP </i>be unity if the <i>jth </i>observa-<br>tion is a <i>C</i>, and 0 if it is a <i>Cu</i>. We now need to use it for both the structural and error models, so<br>that:<br>
<i>y </i>= <i>TYP ˜ </i>+<br>
+<br>
η<br>
+<br>
<i>j C j</i><br>
(1 − <i>TYP j</i>) <i>˜</i><br>
<i>Cu j</i><br>
<i>TYP j </i>1 <i>j</i><br>
(1 − <i>TYP j</i>)η2 <i>j</i><br>
(3.10)<br>
A little thought shows that the indicator variable selects the correct prediction ( <i>˜</i><br>
<i>C </i>or <i>˜</i><br>
<i>Cu</i>) and the<br>
correct error term for each observation (<i>y</i>).<br>
An equivalent form of the model that can be implemented easily is<br>
 <i>˜C </i>+ η1<br>
if <i>TYP</i><br>
<i>y </i>=  <i>j</i><br>
<i>j </i>,<br>
<i>j is </i>1<br>
(3.10a)<br>
 <i>˜</i><br>
<i>Cu </i>+ η<br>
<i>j</i><br>
2 <i>j</i>, if <i>TYP j is </i>0<br>
<b>3.7. More Than One Indicator Variable</b><br>
Of course, there could be three types of assays, or more, and similarly, more than two types of<br>observations. One usually needs one less indicator variable than types of things to be distin-<br>guished. So, if there were three assays, one would deﬁne <i>ASY </i>1 and <i>ASY </i>2. <i>ASY </i>1 would be 1 if<br>the assay were of the ﬁrst type, and zero otherwise; <i>ASY </i>2 would be 1 if the assay were of the sec-<br>ond type, and zero otherwise. The error model for the data would require three types of η’s, η1,<br>
η2, and η3.<br>
<i>y </i>=<br>
η<br>
+<br>
η<br>
+<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + <i>ASY </i>1 <i>j </i>1 <i>j</i><br>
<i>ASY </i>2 <i>j </i>2 <i>j</i><br>
(1 − <i>ASY </i>1 <i>j</i>)(1 − <i>ASY </i>2 <i>j</i>)η3 <i>j</i><br>
(3.11)<br>
Equation (3.11) results in the following:<br>
Assay<br>
<i>ASY </i>1<br>
<i>ASY </i>2<br>
Type of η<br>
var(<i>y j</i>)<br>
† With all PREDPP pharmacokinetic models there is an output compartment for which the total amount of drug<br>leaving the system is computed automatically. The concentration in the urine is then obtained by setting the<br>scaling parameter for the output compartment to <i>Vu</i>.<br>
-29-<br>
<hr>
<A name=38></a>Chapter 3 - Models for Individual Data<br>
1<br>
1<br>
0<br>
η1<br>
ω 21<br>
2<br>
0<br>
1<br>
η2<br>
ω 22<br>
3<br>
0<br>
0<br>
η3<br>
ω 23<br>
An equivalent form of the model that can be implemented easily is<br>
<br> <i>f </i>(<i>x j</i>, φ) + η1<i>j</i>, if <i>ASY</i>1<i>j is </i>1<br>
<i>y </i>=<br>
<i>j</i><br>
 <i>f </i>(<i>x j</i>, φ) + η2<i>j</i>, if <i>ASY</i>2<i>j is </i>1<br>
(3.10a)<br>
<br> <i>f </i>(<i>x j</i>, φ) + η3<i>j</i>, if <i>ASY</i>1<i>j is </i>0 and <i>ASY</i>2<i>j is </i>0<br>
<b>3.8. The General Mixed Effects Model for an Individual</b><br>
We hav e just seen examples of more complicated error models than the simple Additive model.<br>We here give a mathematical form for the most general mixed effects model that is considered<br>within the scope of this document:<br>
<i>y </i>=<br>
<i>j</i><br>
<i>f </i>(<i>x j</i>, φ ) + <i>h</i>′(<i>x j</i>, φ )η <i>j</i><br>
(3.12)<br>
where <i>h </i>is a vector valued function of <i>x </i>and parameters φ (where the latter is interpreted broadly<br>to contain parameters such as <i>p </i>of (3.7)), and η is a vector of different different η types. The<br>notation <i>h</i>′ denotes vector transpose. When there is more than one η type, there will be several<br>
ω 2’s, one for each type. The collection of these is denoted Ω and is labeled OMEGA in NON-<br>MEM input and output. This collection is regarded as a diagonal matrix (diagonal for now; but<br>see Chapter 4), rather than as a vector. We will use the symbol ω 2<i>k </i>and ω <i>kk </i>interchangeably in this<br>text to denote the (diagonal) element of this matrix found in position <i>k</i>, <i>k</i>.<br>
-30-<br>
<hr>
<A name=39></a><b>Chapter 4 - Models for Population Data</b><br>
<b>1. What This Chapter is About</b><br>
In this chapter, models for data from (animal or human) populations will be discussed. These<br>models describe observations from a number of individuals sampled from the population. The<br>distinguishing feature of the data to which such models apply is that there is <i>more than one </i>obser-<br>vation from some (usually most) individuals. A population model includes the structural model<br>of Chapter 3, but also a new model, which shall be called the parameter model, for each individu-<br>al’s kinetic parameters. The parameter model can have both ﬁxed and random effects. A popula-<br>tion model also includes the error model of Chapter 3.<br>
<b>2. General</b><br>
Individuals differ, and the types, degrees and causes of these differences are often what we want<br>to learn. NONMEM was designed to help us learn these things. These individual differences can<br>be due to ﬁxed and/or random effects, but they all manifest themselves by affecting the value of<br>an individual’s parameters, φ . That is, ﬁrst, each individual is regarded as having his own particu-<br>lar value of φ . If the data come from <i>i </i>= 1, . . . , <i>N </i>individuals, then we may rewrite the (not com-<br>pletely) general mixed effects model, (3.4) for <i>yij</i>, the <i>jth </i>observation from the <i>ith </i>individual, as<br>
<i>y </i>=<br>
<i>ij</i><br>
<i>f </i>(<i>xij</i>, φ<i>i</i>) + ε<i>ij</i><br>
(4.1)<br>
Eq (4.1) is now (part of) a population model because it explicitly recognizes, through the sub-<br>script, <i>i</i>, that the data come from distinct individuals. Note too that we have written ε , rather than<br>
η. According to NONMEM conventions, when modeling data from a <i>population</i>, the random<br>
effects in the residual errors are denoted by ε , their individual variances by σ 2, and the collection<br>of the variances by the matrix Σ, denoted SIGMA in NONMEM input and output. We also adopt<br>the same convention here as we did for Ω: the <i>kth </i>diagonal element of Σ is interchangeably<br>denoted σ 2<i>k </i>or σ <i>kk</i>.<br>When dealing with population data, the symbol η is reserved for random effects inﬂuencing the<br>vectors φ <i>i</i>, as is now explained. We can write a general model (but not yet as general a model as<br>we will present later) for φ <i>i</i>:<br>
φ =<br>
<i>i</i><br>
<i>g</i>(<i>zi</i>, θ ) + η<i>i</i><br>
(4.2)<br>
It is called the parameter model. Here, <i>g </i>is a structural (though non-kinetic) type model (of which<br>examples will be given shortly), which is a function of ﬁxed effects, <i>zi</i>, and ﬁxed effects parame-<br>ters, θ . Note that since, in general, φ is a vector, <i>g </i>must be a vector-valued function, and for the<br>same reason, η is usually a vector. This will be discussed further later. All ﬁxed effects, whether<br>they are part of the kinetic structural model, or are part of the parameter model, are input to NON-<br>MEM in a uniform way. For the purposes of this discussion, the symbol <i>z </i>is used for the particu-<br>lar ﬁxed effects in <i>g</i>, such as the individual’s height, weight, and so forth (this will be discussed<br>further in a moment). Even though most often φ is regarded as time invariant, as is done in most<br>of the discussion in this document, ﬁxed effects can change with time, and thus kinetic parameters<br>within φ can change with time. This will be discussed further in Section 3.4.2.<br>
<b>3. Structural Parameter Models</b><br>
The symbol in (4.2) for the ﬁxed effects parameter vector is θ , not φ . As mentioned in Chapter 3,<br>we reserve the symbol φ , in this document, for an individual’s ﬁxed effect parameters and use the<br>symbol θ for a vector of <i>population </i>(ﬁxed effects and possibly random effects) parameters.<br>
-31-<br>
<hr>
<A name=40></a>Chapter 4 - Models for Population Data<br>
Recall the phenobarbital example of Chapter 2. For the second run, the input contained the line<br>of code<br>
<b>TVCL = THETA(1) + THETA(3)*WT</b><br>
Translated into the symbols we are using here, this is<br>
<i>˜</i><br>
<i>Cl </i>= θ + θ<br>
<i>i</i><br>
1<br>
3<i>WTi</i><br>
(4.3)<br>
In (4.3), θ 1 and θ3 are the ﬁrst and third elements of the parameter vector θ , and <i>WTi </i>is an ele-<br>ment of <i>zi </i>(recall that this value of weight appears as a data item). The tilde over <i>CL </i>is meant to<br>distinguish this typical population value of clearance from the <i>ith </i>individual’s actual value of<br>clearance. According to this model, <i>˜</i><br>
<i>CLi </i>will be the same for any two individuals both of whom<br>
have the same value of weight. Equation (4.3) deﬁnes an element (the one associated with clear-<br>ance) of the vector-valued function <i>g</i>. Note that in (4.3), we use the subscript <i>i </i>to stress that this<br>equation applies to the <i>ith </i>individual, but there is no confusion when, as in the NM-TRAN input,<br>and in the following, the subscript is omitted. It should always be understood that all variables<br>and data items used in the parameter model deﬁnition refer to the same individual. Many differ-<br>ent models are possible to describe the dependence of individual parameters on ﬁxed effects.<br>However, certain model forms are simple, easy to use, and cover most cases. An assortment of<br>these will be discussed brieﬂy next.<br>
<b>3.1. Linear Models</b><br>
The simplest form that <i>g </i>can take, and the most common, is one that is linear in θ . An example is<br>(4.3): all elements of θ appear as linear coefﬁcients of terms involving data items. The data items<br>themselves can appear nonlinearly, without affecting the linearity with respect to θ . For example,<br>if clearance is the sum of renal and non-renal components, and renal clearance is believed to be<br>proportional to renal function as described according to a standard formula involving the elements<br>of <i>z</i>: age ( <i>AGE</i>), serum creatinine (<i>SECR</i>), and weight (<i>WT </i>), then one might write<br>
<i>˜</i><br>
<i>CL</i><br>
= θ<br>
<i>met</i><br>
1<i>WT</i><br>
(4.4)<br>
1. 66−. 011 <i>AGE</i><br>
<i>RF </i>= <i>WT</i><br>
(4.5a)<br>
<i>SECR</i><br>
<i>˜</i><br>
<i>CL</i><br>
= θ<br>
<i>ren</i><br>
4 <i>RF</i><br>
(4.5b)<br>
<i>˜</i><br>
<i>Cl </i>= <i>˜</i><br>
<i>CL</i><br>
+ <i>˜</i><br>
<i>met</i><br>
<i>CLren</i><br>
(4.6)<br>
Clearly, <i>RF </i>is a nonlinear function of <i>SECR</i>, for example, and so, therefore, is <i>˜</i><br>
<i>Cl</i>, but <i>˜</i><br>
<i>Cl </i>is linear<br>
in θ , and (4.4 - 4.6) is still considered a linear model. (Do not worry about the non-consecutive<br>numbering of the elements of θ ; a model for <i>˜</i><br>
<i>CL </i>is being developed (an alternative to 4.3), and the<br>
missing elements θ 2 and θ3 will appear presently.)<br>
<b>3.2. Multiplicative Models</b><br>
Multiplicative models are linear models, but on a logarithmic scale. For example, if patients cov-<br>ering a very wide range of weights are studied, metabolic clearance might vary with weight, but<br>not linearly, and a substitute for (4.4) might be<br>
<i>˜</i><br>
<i>LCl</i><br>
= θ + θ<br>
<i>met</i><br>
1<br>
2<i>log</i>(<i>WT </i>)<br>
(4.4.1)<br>
<i>˜</i><br>
<i>Cl</i><br>
=<br>
<i>met</i><br>
<i>exp</i>( <i>˜</i><br>
<i>LCLmet</i>)<br>
-32-<br>
<hr>
<A name=41></a>Chapter 4 - Models for Population Data<br>
Note that the logarithm of <i>˜</i><br>
<i>CLmet </i>( <i>˜</i><br>
<i>LCLmet</i>) is linear in θ , but <i>˜</i><br>
<i>CLmet </i>itself is not. Of course, (4.4.1)<br>
can also be written<br>
<i>˜</i><br>
<i>Cl</i><br>
= θ<br>
<i>met</i><br>
1<i>WT </i>θ 2<br>
(4.4.2)<br>
Models (4.4.1) and (4.4.2) are equivalent so far as <i>˜</i><br>
<i>Cl </i>is concerned, but θ 1 of (4.4.2) corresponds<br>
to exp(θ 1) of (4.4.1).<br>
<b>3.3. Saturation Models</b><br>
A useful model for processes reaching a maximum is a hyperbolic model. For example, if a sec-<br>ond drug, (whose steady-state plasma concentration, <i>Cpss</i>2 is known and available in the data<br>set), is present in some individuals and it is believed that this second drug is an inhibitor of the<br>metabolism of the study drug, one might wish to use<br>
θ<br>
<i>˜</i><br>
<br>
<br>
<i>Cl</i><br>
=<br>
−<br>
2<i>Cpss</i>2<br>
<i>met</i><br>
<i>WT </i>θ1 θ +<br>
<br>
(4.4.3)<br>
3<br>
<i>Cpss</i>2<br>
This model is shown in ﬁgure 4.1. The inhibition is expressed by the ratio occurring within the<br>brackets and is a concave hyperbola, asymptoting to a maximum value equal to θ 2. It is identical<br>in form to the familiar Michaelis-Menten model.<br>
θ1<br>
CL met<br>
WT<br>
θ - θ<br>
1<br>
2<br>
θ3<br>
Cpss2<br>
Figure 4.1. A hyperbolic model for metabolic clearance of drug on the ordinate, as inhibited by another drug at steady-<br>
state concentration <i>Cpss</i>2 on the abscissa.<br>
<b>3.4. Models with Indicator Variables</b><br>
Indicator variables were discussed in Chapter 3 in connection with the error model. They can be<br>quite useful when modelling individual parameters. They are usually used in a linear model. For<br>example, if the clinical condition, heart failure, is noted as &quot;present&quot; or &quot;absent&quot;, one can deﬁne<br>an indicator variable, <i>HF </i>which equals 0 if heart failure is absent, and 1 if it is present. If meta-<br>bolic clearance is thought to be affected by heart failure, one might choose<br>
<i>˜</i><br>
<i>Cl</i><br>
=<br>
− θ<br>
<i>met</i><br>
(θ 1<br>
2 <i>HF </i>)<i>WT</i><br>
(4.4.4)<br>
-33-<br>
<hr>
<A name=42></a>Chapter 4 - Models for Population Data<br>
Here, the non-heart-failure cases will have <i>˜</i><br>
<i>Cl</i><br>
= θ<br>
<i>met</i><br>
1<i>WT </i>, while the heart-failure cases will have<br>
<i>˜</i><br>
<i>Cl</i><br>
=<br>
− θ<br>
<i>met</i><br>
(θ 1<br>
2)<i>WT </i>†.<br>
<b>3.4.1. Combinations</b><br>
Given the basic building blocks of linear, multiplicative and saturation models, these can be com-<br>bined in the usual algebraic ways (usually by addition) to make more complex models. For<br>example, one could use (4.4.3), (4.5), and (4.6) as a model for <i>˜</i><br>
<i>Cl</i>. A non-additive example arises<br>
if plasma and urine concentrations are both observed and (kinetic) model (3.6) is to be used for<br>the latter. The parameter <i>fo</i>, the fraction of drug excreted unchanged into the urine might be<br>modeled as<br>
<i>˜</i><br>
<i>Cl</i><br>
<i>f </i>=<br>
<i>ren</i><br>
<i>o</i><br>
(4.7)<br>
<i>˜</i><br>
<i>Cl</i><br>
where <i>˜</i><br>
<i>Clren </i>is given by (4.5) and <i>˜</i><br>
<i>Cl </i>by (4.6) (using any of the (4.4) variants).<br>
<b>3.4.2. Time Varying </b><i>z</i><br>
As mentioned in Section 2, although most of the time the data items affecting an individual’s φ do<br>not change over the course of his data, they occasionally do, and PREDPP can handle this. For<br>example, if an individual had heart failure for part of his observation period, but not the rest,<br>
<i>˜</i><br>
<i>Clmet</i>, according to (4.4.4) should change. Or, if acute renal failure occurred during a patient’s<br>observation period, <i>˜</i><br>
<i>Clren </i>would change, according to model (4.5).<br>
PREDPP implements its kinetic model recursively: given the state of the system at time <i>t j </i>(by<br>state we mean the amounts of drug in all the compartments), it updates (i.e. advances) the state to<br>that at time <i>t j</i>+1, using the value of <i>z </i>(and in general, the value of <i>x</i>) at time <i>t j</i>+1 to compute a<br>value of φ holding between times <i>t j </i>and <i>t j</i>+1. The value of <i>z </i>used to compute this φ is that value<br>found on the data record with time <i>t j</i>+1. So, in order to have φ change appropriately as <i>z </i>does,<br>one places a value of <i>z </i>which is typical for the time period <i>t j </i>to <i>t j</i>+1 on the data record associated<br>with the time point <i>t j</i>+1. This will not always be easy since the relevant element(s) of <i>z </i>may not<br>be measured at, for example, the midpoint of the time interval (the value at the <i>midpoint </i>of the<br>time interval is a good choice for the <i>typical </i>value for the interval). If not, one will have to use<br>some interpolation method to arrive at the typical value. The important point is that the values of<br>the independent variables at time <i>t j</i>+1 determine the values of the individual’s parameters apply-<br>ing to the entire period <i>t j </i>to <i>t j</i>+1.<br>
<b>3.5. Structural Kinetic Models</b><br>
The kinetic models (i.e., the models for responses such as drug concentrations) used when per-<br>forming a population analysis do not differ at all from those used for an individual analysis. One<br>still needs a model for the relationship of <i>y </i>to φ and <i>x</i>, and this relationship does not depend on<br>whether φ changes from individual to individual or with time within an individual.<br>
<b>4. Population Random Effects Models</b><br>
Under NONMEM conventions, there are two lev els of random effects, and η and ε are the sym-<br>bols used for the vectors of ﬁrst and second level random effects, respectively. With data from a<br>single individual, only ﬁrst-level random effects are needed. However, with data from a popula-<br>tion of individuals, both ﬁrst- and second-level random effects are needed. First-level effects are<br>
† Heart failure is expected to decrease metabolic clearance. If it does, using a minus sign in (4.4.4) allows the<br>more pleasing result that θ 2 will be estimated as positive. The model is identical to one with a positive sign, but<br>then θ 2 would probably be negative. If θ 2 were constrained to be non-negative, then the sign chosen in the<br>model statement would, of course, be important.<br>
-34-<br>
<hr>
<A name=43></a>Chapter 4 - Models for Population Data<br>
needed in the parameter model to help model unexplainable interindividual differences in φ , and<br>second-level effects are needed in the (intraindividual) error model. For example, in (4.2) there is<br>an element of η<i>i</i>, η<i>Vi </i>, that is the difference between the individual value <i>Vi </i>(an element of φ) and<br>
<i>˜</i><br>
<i>Vi</i>, the typical value of <i>Vi</i>. This is a ﬁrst-level random effect. In (4.1) ε<i>ij </i>is the error between <i>yij<br></i>and <i>f </i>(<i>xij</i>, φ<i>i</i>). This is a second-level random effect.<br>
<b>4.1. Models for Interindividual Errors</b><br>
The difference between φ <i>i </i>and <i>g</i>(<i>zi</i>, θ ) is called an interindividual error. It arises from a few<br>sources: the function <i>g </i>may be only approximate, and/or <i>z </i>may be measured with error. It is re-<br>garded as a random quantity, and it may be modeled in terms of η variables. As usual, each of<br>these variables is assumed to have mean 0 and a variance denoted by ω 2 which may be estimated.<br>This variance describes biological population variability.<br>
The difference between <i>yij </i>and <i>f </i>(<i>xij</i>, φ<i>i</i>) is called an intraindividual error. It has been discussed at<br>some length in Chapter 3. Although in that discussion about individual data, this difference was<br>modeled in terms of η variables, in this discussion about population data, it is modeled in terms of<br>ε variables. Each ε variable is assumed to have mean 0 and a variance denoted by σ 2 which also<br>may be estimated.<br>
Each pair of elements in η has a covariance, and NONMEM can also estimate this, although often<br>we choose to assume that the covariance is zero (we made this same assumption for the different<br>elements of η in Chapter 3, Section 3.5.1).<br>A covariance between two elements of η, η<i>k </i>and η<i>m</i>, say, is a measure of statistical association<br>between these two random variables. Their covariance is related to their correlation, ρ <i>km<br></i>(ρ<br>
≡ ρ<br>
<i>km</i><br>
<i>mk </i>) by<br>
<i>cov</i>(η<br>
ω ω<br>
<i>k </i>, η <i>m </i>) = ρ <i>km</i><br>
<i>k</i><br>
<i>m</i><br>
(4.8)<br>
(Note that now that we are suppressing the subscript <i>i </i>on η, we may, without confusion, use the<br>subscript position to designate elements of η.)<br>
The variances and covariances among the elements of η are laid out in a covariance matrix, called<br>
Ω, and labeled OMEGA in NONMEM input and output. This matrix was deﬁned in Chapter 3,<br>Section 3.8, but some additional comment here may be helpful. If η has, for example, 3 elements,<br>
Ω has the following form:<br>
ω<br>
ω<br>
ω<br>
11<br>
12<br>
13<br>
ω<br>
ω<br>
ω<br>
21<br>
22<br>
23<br>
ω<br>
ω<br>
ω<br>
31<br>
32<br>
33<br>
Here, as previously, ω <i>kk </i>is another way of writing the variance ω 2<i>k</i>, and ω <i>km </i>(<i>k </i>≠ <i>m</i>) is the covari-<br>ance between η<i>k </i>and η<i>m</i>.<br>The elements ω 11, ω22, ω33 are called the diagonal elements of the matrix. If the nondiagonal ele-<br>ments (the covariances) are all zero, i.e. the correlation among all pairs of η elements is zero, the<br>matrix is called a diagonal matrix. The lower triangular elements of the matrix are the elements<br>
ω11<br>
ω<br>
ω<br>
21<br>
22<br>
ω<br>
ω<br>
ω<br>
31<br>
32<br>
33<br>
To specify the matrix only its lower triangular elements need be given (and these are all NON-<br>MEM does give), since from (4.8) it is clear that for all <i>k</i>, <i>m</i>, ω<br>
= ω<br>
<i>km</i><br>
<i>mk </i>.<br>
-35-<br>
<hr>
<A name=44></a>Chapter 4 - Models for Population Data<br>
<b>4.1.1. Additive/Multiplicative Models and the Exponential Model</b><br>
Frequently, the model for an interindividual error is the simple additive one (as in (4.2)), such as<br>
<i>V </i>= <i>˜</i><br>
<i>V </i>+ η2<br>
(4.9)<br>
A feature of (4.9) is that the resulting units for ω 2 depend on the units of the parameter (<i>V </i>in this<br>case). For example, this model was used in the theophylline problem of Chapter 2 (Figure 2.6).<br>The ﬁnal estimate of ω 22 is .286 (Figure 2.8). Assuming that the units of V are liters, we interpret<br>this to mean that the standard deviation of V between individuals is .53 Liters ( .53 = √<br>
 .<br>
286).<br>
Perhaps even more often, a multiplicative model equivalent to the Constant Coefﬁcient of Varia-<br>tion (CCV) error model (3.5) is used, such as<br>
<i>V </i>= <i>˜</i><br>
<i>V </i>(1 + η2)<br>
(4.10)<br>
This model is also referred to as the proportional error model.<br>A feature of (4.10) is that the resulting units for ω 2 are independent of the units of the parameter<br>(<i>V </i>in this case). When this model is used in the theophylline problem instead of the additive<br>model, so that Figure 2.6 contains the code<br>
V=TVVD*(1+ETA(2))<br>
instead of<br>
V=TVVD+ETA(2), then NONMEM estimates ω 22 to be .146. We interpret this to mean that the<br>coefﬁcient of variation of V in the population is 38% (.38 = √<br>
 .<br>
146).<br>
The exponential model is<br>
<i>V </i>= <i>˜</i><br>
<i>V </i>exp(η2)<br>
(4.10a)<br>
During simulation, the exponential and proportional models give different results. During estima-<br>tion by the ﬁrst-order method, the exponential model and proportional models give identical<br>results, i.e., NONMEM cannot distinguish between them. During estimation by a conditional<br>estimation method,<br>
the exponential and proportional models for inter-individual variability<br>
give different results. The exponential model is preferred for conditional estimation methods.<br>(See NONMEM User’s Guide Part VII, Conditional Estimation Methods.)<br>
<b>4.1.2. Other Models</b><br>
Occasionally, a model for an individual’s pharmacokinetic parameter might involve scaling an η,<br>as in (3.6), or two or more η’s as in (3.10). For example, a study might involve patients in the<br>intensive care unit (ICU) and others on non-acute care units. It might be reasonable to suppose<br>that some aspects of the kinetics of ICU patients (e.g., metabolic clearance of drug) are more vari-<br>able, due to unmeasured factors (e.g., hepatic function) that vary greatly among acutely ill<br>patients. Even though the variation is, in reality, due to a potentially measurable ﬁxed effect (he-<br>patic function), if information on this ﬁxed effect is not available, differences caused by it must be<br>assigned to random factors (η). In this case, one might wish to use an indicator variable, <i>ICU<br></i>(which equals 1 if the patient is in the ICU, and 0, otherwise), and a model such as<br>
<i>Cl</i><br>
= <i>˜</i><br>
+<br>
+<br>
<i>met</i><br>
<i>Clmet</i><br>
(1 − <i>ICU</i>)η1<br>
<i>ICU</i>η2<br>
(4.11)<br>
In addition to model (4.11) we might have, for example,<br>
<i>Cl</i><br>
= <i>˜</i><br>
+ <i>˜ </i>η<br>
<i>ren</i><br>
<i>Clren</i><br>
<i>Clren </i>3<br>
(4.12a)<br>
<i>Cl </i>= <i>Cl</i><br>
+<br>
<i>ren</i><br>
<i>Clmet</i>.<br>
(4.12b)<br>
Models (4.11) and (4.12) together, along with suitable models for <i>˜</i><br>
<i>Clren </i>and <i>˜</i><br>
<i>Clmet</i>, form a com-<br>
plete model for an individual’s <i>Cl </i>parameter, and involve 3 η’s.<br>
-36-<br>
<hr>
<A name=45></a>Chapter 4 - Models for Population Data<br>
<b>4.1.3. General Form for the Parameter Model</b><br>
As we have just seen in (4.10) and in (4.11)-(4.12), an element of η need not act in a simple addi-<br>tive way and may act solely on an intermediate variable (e.g. <i>Clmet</i>). Indeed, there may be more<br>or fewer elements in η than in φ , the elements in η may act in nonlinear ways to inﬂuence φ , and<br>one element of η may inﬂuence more than a single element of φ . We now giv e a more general<br>form for the parameter model than (4.2) and then an example illustrating it.<br>
The general form of the parameter model is<br>
φ =<br>
<i>i</i><br>
<i>g</i>(<i>zi</i>, θ , η<i>i</i>)<br>
(4.13)<br>
Here, <i>g </i>is a very general function of ﬁxed effects, <i>zi</i>, ﬁxed effects parameters, θ , and a vector of<br>
η’s, η<i>i</i>. The dimensions of the vectors φ<i>i </i>and η<i>i </i>need not be the same. An individual’s kinetic<br>
parameter may change with time. As explained in Section 1.6, with NONMEM-PREDPP<br>changes can occur only at discrete time points. Therefore, the parameter actually can be regarded<br>as being a number of parameters, each one applying to a different time period. The parameter φ <i>i<br></i>in (4.13), being a vector of all the kinetic parameters for the <i>ith </i>individual, can be regarded as<br>encompassing these time-interval-speciﬁc parameters.<br>
An example utilizing this generality is provided by a model for observations of both plasma and<br>urine drug concentrations, similar to the one presented previously. Ignoring the details of the<br>structural part of the model, consider the following model<br>
<i>Cl</i><br>
= <i>˜</i><br>
+ η<br>
<i>met</i><br>
<i>Clmet</i><br>
1<br>
<i>Cl</i><br>
= <i>˜</i><br>
+ η<br>
<i>ren</i><br>
<i>Clren</i><br>
2<br>
<i>Cl </i>= <i>Cl</i><br>
+<br>
<i>met</i><br>
<i>Clren</i><br>
(4.14)<br>
<i>f </i>= <i>Clren</i><br>
<i>o</i><br>
<i>Cl</i><br>
<i>V </i>= <i>˜</i><br>
<i>V </i>+ η3<br>
In this model, φ = (<i>V </i>, <i>Cl</i>, <i>fo</i>); the parameters <i>Clmet </i>and <i>Clren </i>are regarded as intermediate param-<br>eters. We hav e η = (η<br>
η<br>
1, η 2,<br>
3), where both η 1 and η 2 inﬂuence both <i>Cl </i>(linearly) and <i>fo </i>(nonlin-<br>
early).<br>
<b>4.2. Statistical Models for an Individual’s Observations</b><br>
Model (4.1) can be generalized by incorporating a model like those given in Chapter 3 for the<br>residual errors, i.e. for the differences between the <i>yij </i>and <i>f </i>(<i>xij</i>, φ<i>i</i>), rather than using just the<br>simple Additive model. A particular instance of such a model may have sev eral types of ε ’s, and<br>as mentioned in Section 2, the variances of these ε ’s are denoted by σ 2’s. With a population<br>model these variances could change from individual to individual. With NONMEM, they are<br>considered as constants over individuals. The ε ’s can co-vary. A covariance matrix Σ, like the Ω<br>matrix given in Section 4.1, gives the variances and covariances of the ε ’s, as already discussed at<br>the end of Chapter 3. This does not preclude the magnitudes of the errors from being affected by<br>ﬁxed effects. A model such as (3.8) can still be used. This is shown explicitly by the general<br>model given in the next section.<br>
<b>5. The Population Mixed Effects Model</b><br>
We hav e now presented all of the parts needed to fully deﬁne a population model. It may be use-<br>ful to recap this information by stating the entire general model here:<br>
-37-<br>
<hr>
<A name=46></a>Chapter 4 - Models for Population Data<br>
<i>y </i>=<br>
<i>ij</i><br>
<i>f </i>(<i>xij</i>, φ<i>i</i>) + <i>h</i>′(<i>xij</i>, φ<i>i</i>)ε<i>ij</i><br>
(4.15a)<br>
φ =<br>
<i>i</i><br>
<i>g</i>(<i>xij</i>, θ , η<i>i</i>)<br>
(4.15b)<br>
<i>cov</i>(ε <i>ij</i>) = Σ;<br>
<i>cov</i>(η<i>i</i>) = Ω<br>
ε<i>ij</i>, ε<i>kl </i>independent for (<i>i</i>, <i>j</i>) ≠ (<i>k</i>, <i>l</i>)<br>
η<i>i</i>, η<i>k </i>independent for <i>i </i>≠ <i>k</i><br>
ε<i>ij</i>, η<i>k </i>independent for all <i>i</i>, <i>j</i>, <i>k</i>,<br>
where here, ε <i>ij </i>is a vector, along with <i>xij</i>, φ<i>i</i>, θ and η<i>i</i>, and Σ and Ω are square matrices with<br>dimensions equal to those of ε <i>ij </i>and η<i>i</i>.<br>To try to represent the relationship between all the ﬁxed and random effects of a population model<br>graphically, consider ﬁgure 4.2. The model corresponding to this ﬁgure is<br>
<i>y </i>= <i>D</i><br>
<i>ij</i><br>
<i>exp</i>[−(<i>Cl</i><br>
<i>V</i><br>
<i>i </i>/<i>Vi </i>)<i>tij </i>] + ε <i>ij</i><br>
<i>i</i><br>
<i>Cl </i>= θ + θ<br>
+ η<i>Cl</i><br>
<i>i</i><br>
1<br>
2 <i>RFi</i><br>
<i>i</i><br>
(4.16)<br>
<i>V </i>=<br>
<i>i</i><br>
<i>V</i><br>
<i>var</i>(ε <i>ij</i>) = σ 2;<br>
<i>var</i>(η<i>Cl</i><br>
<i>i </i>) = ω 2<br>
<i>Cl</i><br>
where the <i>Vi </i>are all equal to a constant <i>V </i>, i.e. there is no random interindividual variability in the<br>volume of distribution, so that for the sake of this example, η<i>i </i>is just a scalar.<br>
-38-<br>
<hr>
<A name=47></a>Chapter 4 - Models for Population Data<br>
±ω<br>
±σ<br>
<i>Cl</i><br>
|<br>
|<br>
0<br>
0<br>
Cl<br>
η <i>Cl</i><br>
C<br>
ε<br>
<i>i</i><br>
<i>i j</i><br>
θ<br>
θ<br>
2<br>
1<br>
<i>  RF i</i><br>
RF<br>
<i>tij</i><br>
time<br>
Figure 4.2. Random and ﬁxed effects inﬂuence observation, <i>Cij</i>, from the population point of view. Open circle, lower<br>left, is population parameter predicted clearance, closed circle is true clearance for <i>ith </i>individual which differs from<br>
population prediction by η<i>Cl</i><br>
<i>i </i>, chosen randomly from a distribution (upper left) with mean 0 and SD ω <i>Cl </i>. Similarly,<br>
lower right, the observed <i>C </i>at time <i>tij </i>(open square) differs by ε<i>ij </i>from the true value (closed circle) by an error ε<i>ij</i>, cho-<br>sen independently from a distribution with mean 0 and SD σ ε . The <i>C </i>corresponding to the population-based prediction<br>is also shown (upper curve, open circle).<br>
-39-<br>
<hr>
<A name=48></a><b>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests</b><br>
<b>1. What This Chapter is About</b><br>
In this chapter, we discuss the ﬁtting criterion that NONMEM uses, parameter estimates, and<br>standard error estimates. We then discuss how to form conﬁdence intervals for parameters and do<br>hypothesis tests with NONMEM.<br>
<b>2. Model Fitting Criterion</b><br>
In principle, all ﬁtting procedures attempt to adjust the values of the parameters of the model to<br>give a &quot;best ﬁt&quot; of the predictions to the actual observations. The set of parameters that accom-<br>plish this are called the parameter estimates, and are denoted here as ˆ<br>
θ , ˆΩ, and ˆΣ. Methods differ<br>
in how they deﬁne &quot;best&quot;. The criterion that NONMEM uses is a Least Squares (LS) type crite-<br>rion. The form of this criterion varies as the error model varies, and as population models with<br>multiple random effects must be considered. We brieﬂy discuss these various criteria next, to<br>give the reader a feel for what NONMEM is doing. A detailed knowledge of the statistical basis<br>for the choice of ﬁtting criterion is not necessary either to use or interpret NONMEM ﬁts. In this<br>chapter, a ﬁxed effects parameter will be denoted by a θ ; the distinction between individual ﬁxed<br>effects parameters (φ ) and population ﬁxed effects parameters will not be important here.<br>
<b>2.1. Least Squares for Individual Data with an Additive Error Model</b><br>
For the Additive error model (3.4), the Ordinary Least Squares criterion (OLS) chooses the esti-<br>mate ˆ<br>
θ so as to make the sum of squared (estimated) errors as small as possible. These estimates<br>
cause the prediction, here denoted <i>˜y</i>, to be an estimate of the mean value of <i>y</i>, which is intuitively<br>appealing. The prediction is obtained by computing the value for y under the model with parame-<br>ters set to their estimated values and η set to zero†.<br>
<b>2.2. Least Squares for Individual Data with Other Types of Error Models</b><br>
The simple OLS criterion just deﬁned becomes inefﬁcient and is no longer the &quot;best&quot; one to use<br>when the error model is other than the Additive error model. It treats all estimated errors as<br>equally important (i.e. a reduction in the magnitude of either of two estimated errors that are of<br>the same magnitude is equally valuable in that either reduction decreases the sum of squared<br>errors by the same amount), and this results in parameter estimates that cause all errors to have<br>about the same typical magnitude, as assumed under the Additive model. The CCV error model,<br>though, says that the typical magnitude of an error varies monotonically with the magnitude of<br>the (true) prediction of y. In principle, Weighted Least Squares (WLS) gives a ﬁt more commen-<br>surate with the CCV or other non-Additive error model. WLS chooses ˆ<br>
θ as that value of θ mini-<br>
mizing<br>
<i>O</i><br>
Σ<br>
−<br>
<i>WLS </i>(θ ) =<br>
<i>w j</i>(<i>y j</i><br>
<i>˜y j</i>)2<br>
(5.1)<br>
<i>j</i><br>
Each <i>w j </i>is a weight which, ideally, is set proportional to the inverse of the variance of <i>y j</i>. In the<br>CCV model this variance is proportional to <i>˜y</i>2<i>j </i>(evaluated at the true value of θ ). Use of such<br>weights will down-weight the importance of estimated squared errors associated with large values<br>of <i>˜y </i>and promote the relative contribution of those associated with small values of <i>˜y</i>.<br>
In many cases, users can supply approximate weights, and the WLS objective function can be<br>used as stated in (5.1). When, as with the CCV model for example, the ideal weights depend on<br>
† η, not ε , since we follow the NONMEM convention and, when discussing individual type data as here, use η<br>to denote the random effects of a single level that appear in the model, those in the residual error model.<br>
-40-<br>
<hr>
<A name=49></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
the true values of parameters, these true values can be replaced by initial estimates, and then the<br>WLS objective function as given in (5.1) can be minimized. Alternatively, instead of viewing<br><i>OWLS </i>as a function of θ only through the estimated error’s dependence on θ , it can be viewed as a<br>function of θ through both that dependence and <i>also </i>through the ideal weights’ dependence on θ .<br>The entire function can then be minimized with respect to θ . That this creates a problem is most<br>easily seen when the error model contains a parameter which is not itself a parameter of the struc-<br>tural model, but which, nonetheless, must be regarded as an element of θ . Such an error model is<br>the Power Function model of (3.7), and the &quot;extra&quot; parameter is <i>p</i>. The WLS objective function<br>with the reciprocal variance of <i>y j </i>substituted for <i>w j </i>is†<br>
(<i>y </i>−<br>
<br>
<i>j</i><br>
<i>˜y j</i>)2<br>
<i>O</i>∗<br>
Σ<br>
<i>WLS </i>(θ ) =<br>
 ω<br>
<br>
(5.2)<br>
2<br>
<i>j </i><br>
<i>˜y pj</i><br>
<br>
In this case if <i>p </i>were set to a very large number, while the other parameters in θ were only such<br>as to make all <i>˜y j </i>&gt; 1, then all <i>˜y p </i>would be very large, and the summation would attain a very<br>
<i>j</i><br>
small value. (The value of ω 2 is irrelevant to the minimization with respect to θ .) Thus, all ele-<br>ments in θ other than <i>p </i>would be indeterminate (as long as they were such that all <i>˜y </i>were greater<br>than 1); a most unsatisfactory state of affairs.<br>
There is a way to deal with this problem that preserves the spirit of least-squares ﬁtting, and<br>NONMEM uses it. In essence, it adds to the WLS objective function a term proportional to the<br>sum of the logarithms of the error variances. Thus a penalty is paid for increasing the error vari-<br>ances without a concomitant decrease in the estimated errors themselves. This modiﬁed objective<br>function is called the Extended Least Squares (ELS) objective function. It is minimized with<br>respect to all parameters of the structural and error models simultaneously (in the current exam-<br>ple, θ and ω 2, as <i>p </i>can be considered an element of θ ). Note that the objective function may be<br>negative. This has no particular signiﬁcance.<br>
<b>2.3. Least Squares for Population Data</b><br>
The complications arising from a population model are due entirely to the random interindividual<br>effects occurring in the parameter model. To deal with this, NONMEM uses an approximation to<br>the true model. The approximate model is linear in all the random effects. For this linearized<br>model, the vector of mean values for the observations from the <i>ith </i>individual is the vector of true<br>predictions for these observations. These predictions are obtained from the model by setting the<br>parameters to their true values and by setting all the elements of both ε and η to zero. In other<br>words, these are the true predictions for the mean individual with ﬁxed effects equal to those of<br>the <i>ith </i>individual. For this linearized model it is also possible to write a formula for the variance-<br>covariance matrix of the observations from the <i>ith </i>individual. This matrix is a function of the<br>individual’s ﬁxed effects and the population parameters θ , Ω, and Σ. Finally, the ELS objective<br>function discussed above is generalized to be a sum over individuals, rather than observations,<br>and where the <i>ith </i>term of the sum involves a squared error between a vector of observations and<br>an associated vector of predictions, weighted by the reciprocal of the associated variance-covari-<br>ance matrix for the <i>ith </i>individual.<br>
<b>3. Parameter Estimates</b><br>
It is useful to consider how to estimate parameters that do not appear in the model we use to ﬁt<br>the data, but are, instead, functions of them (e.g. the half-life parameter <i>t </i>1 = . 693 /<i>k</i>, when the rate<br>
2<br>
constant of elimination <i>k </i>is the model parameter).<br>
† Again, we call attention to the symbols used for the random effects parameter: the term ω 2 appears in the<br>objective function, (5.2), not σ 2, because we are discussing individual type data, not population type data.<br>
-41-<br>
<hr>
<A name=50></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
It is always possible, of course, to parameterize the model in the function of interest. For exam-<br>ple, we have already seen (Chapters 2 &amp; 3) that we may use the function (parameter) <i>Cl </i>in the<br>one-compartment model instead of <i>k</i>. Howev er, we may be interested in the values of several<br>alternative parameterizations (e.g., we may want to know k, clearance, and half-life). Rather than<br>rerun the same problem with several alternative parameterizations, we can use the fact that the LS<br>estimate of a function of the parameters is given by the same function of the LS parameter esti-<br>mates. Formally, if θ ′ = <i>q</i>(θ ) is the function of interest, then ˆ<br>
θ ′ =<br>
<i>LS</i><br>
<i>q</i>( ˆ<br>
θ <i>LS</i>). E.g. Letting θ ′ = <i>t</i>1 ,2<br>
θ = <i>k</i>, and <i>q</i>(θ ) = . 693 /θ , then ˆ<i>t</i>1 = . 693 / ˆ<i>k</i>.<br>
2<br>
<b>4. Precision of Parameter Estimates</b><br>
Clearly, it is almost impossible for the estimates to actually be the true values. The question is:<br>how far are the true values from the estimates? To discuss this question, imagine replicating the<br>entire experiment (gathering new data, but keeping <i>x </i>ﬁxed) multiple times. Also, for simplicity,<br>imagine that the model has only one scalar parameter, θ , and that its true value, θ<i>T </i>is known. If,<br>after each replication, the estimate of θ is recorded, and a histogram of these values is plotted, one<br>might see something like ﬁgure 5.1A or 5.1B.<br>
A.<br>
B.<br>
θ<br>
θ<br>
T<br>
T<br>
Figure 5.1. Tw o hypothetical histograms of estimates of a single parameter upon replication of a given experiment.<br>
Left panel (A): The estimates have small variance (spread) but are biased (the mean of the estimates differs from the<br>
true value, θ <i>T </i>); Right panel: The estimates have large variance but are relatively unbiased.<br>
The difference between the estimate and the true value, θ<i>T </i>, obviously differs from replication to<br>replication. Let this difference be called the estimation error. We cannot know the estimation er-<br>ror of any particular estimate (if we could, we could know the true value itself, by subtraction),<br>but we can hope to estimate the mean error magnitude. Since errors can be positive or neg ative, a<br>measure of magnitude that is unaffected by sign is desirable. This is traditionally the Mean<br>Squared Error (<i>MSE</i>). The MSE can be factored into two parts:<br>
<i>MSE </i>= <i>B</i>2 + <i>SE</i>2<br>
(5.2)<br>
where <i>B </i>is the bias of the estimates (mean (signed) difference between the estimates and the true<br>value) and <i>SE </i>is the standard error of the estimates (<i>SE</i>2 is the variance of the estimates). As<br>illustrated in ﬁgure 5.1, the <i>MSE </i>can be about the same for two types of estimates while both<br>their bias and <i>SE </i>differ. It is very hard to estimate the bias of an estimator unless the true param-<br>eter value is, in fact, known. This is not true of the <i>SE</i>: the standard deviation of the distribution<br>of estimates of a parameter on replication is the <i>SE</i>; no knowledge of the true value of the<br>
-42-<br>
<hr>
<A name=51></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
parameter is required. In many situations, LS estimators of ﬁxed effects parameters are unbiased,<br>although in nonlinear problems, such as most pharmacokinetic ones, this cannot be assured.<br>
<b>4.1. Distribution of Parameters vs Distribution of Parameter Estimates</b><br>
Figure 5.1 illustrates the distribution of parameter estimates that might result if an experiment<br>were replicated. The bias and spread depend on the estimation method, the design of the experi-<br>ment (<i>x</i>, which implicitly includes <i>n</i>) and on the true parameter values, including the variances<br>(and covariances) of the random effects inﬂuencing <i>y</i>. If, for example, more observations were<br>obtained in each experiment (more individuals in a population study), the spread of the estimates<br>(one from each experiment) would decrease until, in the limit, if an inﬁnite number of observa-<br>tions were obtained in each experiment, every estimate would be the same (equal to the true value<br>plus the bias of the estimator). Thus, the distribution of the estimate tells us nothing about biol-<br>ogy or measurement error, but only about the <i>precision </i>of the estimate itself.<br>
In contrast, Ω and Σ tell us about unexplained (or random) interindividual variability (biology) or<br>error magnitude (biology plus measurement error), not about how precisely we know these things.<br>No matter how many observations we make, interindividual variability will remain the same size<br>(but the variability of our estimate of its size will decrease), as will the measurement error vari-<br>ability of a particular instrument.<br>
It is very important not to confuse variability (e.g., between individuals) in a model parameter<br>with variability in the estimate of that parameter, despite the fact that the terms we use to describe<br>both variabilities are similar. Thus an element of η, say η1 has a <i>variance</i>, ω 11, while the esti-<br>mate of ω 11, ˆ<br>
ω11, also has a <i>variance </i>given by the square of the standard error for ˆω11. Indeed,<br>
the use of the term &quot;standard error&quot; rather than &quot;standard deviation&quot; to name a measure of the<br>spread in the distribution of the parameter <i>estimate </i>rather than in the parameter helps call atten-<br>tion to the distinction between these two types of things.<br>
<b>4.2. Conﬁdence Interval for a Single Parameter</b><br>
Acknowledging that any particular estimate from any particular experiment is unlikely to equal<br>the true parameter value implies that we should be interested in &quot;interval&quot; estimates of parameters<br>as well as (instead of?) point estimates. An interval estimate of a parameter is usually a range of<br>values for the parameter, often centered at the point estimate, such that the range contains the true<br>parameter value with a speciﬁed probability. The probability chosen is often 95%, in which case<br>the interval estimate is called the 95% Conﬁdence Interval (CI).<br>
A CI is often based only on the parameter estimate and its <i>SE</i>. In the next sections we discuss<br>three questions about such CIs a little further. (i) How to estimate the <i>SE </i>from a single set of data<br>(we cannot replicate our experiment many times and construct a histogram as in ﬁgure 5.1). (ii)<br>Given an estimate of <i>SE</i>, how to use that number to compute a (95% conﬁdence) interval with<br>95% chance of containing the true parameter value. (iii) Given an estimate of <i>SE</i>, how to com-<br>pute a conﬁdence interval for a function of the parameter.<br>
<b>4.2.1. Estimating a Parameter’s Standard Error</b><br>
Remarkably, the <i>SE </i>of a parameter estimate can be estimated using only the data from a single<br>experiment. The idea is that the data give us estimates of the variances of all random effects in<br>our model, from which we can estimate the variability in future data (if we were to replicate the<br>experiment). That is, the SE of the estimates on replication depends only on quantities we either<br>know or hav e estimates of: the <i>x</i>, the number of <i>y </i>observed (<i>n</i>), and the variances of all random<br>effects.<br>
-43-<br>
<hr>
<A name=52></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
It is a little beyond the scope of this discussion to give the method by which NONMEM actually<br>estimates the <i>SE </i>of a parameter estimate; however, examples of how this can be done are found in<br>any statistical textbook on regression. NONMEM presents the estimated standard error for each<br>parameter of the model (including the random effects parameters, Ω and Σ) as part of its output.<br>
<b>4.2.2. Relating the Conﬁdence Interval to the SE</b><br>
Statistical theory tells us not only how to compute the <i>SE </i>of a parameter estimate, but also that<br>for a LS estimate (and many other kinds of estimates), the shape of the distribution of the esti-<br>mates is approximately Normal if the data set is large enough. This means that we may use per-<br>centiles of the Normal distribution, to compute conﬁdence interval bounds (when <i>n </i>is small, the <i>t<br></i>distribution is often used instead; this is discussed in statistics texts). In general, a 100(1-α )%<br>conﬁdence interval for a single parameter, θ say, is computed as ˆ<br>
θ ± <i>Z</i>1−α/2<i>SE</i>. Here <i>Z</i>1−α/2<br>
denotes the 1 − α /2 percentile of the Normal distribution. As previously noted, α is often chosen<br>to be .05, in which case <i>Z </i>is approximately 2.<br>
<b>4.2.3. A Conﬁdence Interval for a Function of a Single Parameter</b><br>
As discussed above, one can reparameterize the model in terms of the new parameter, and NON-<br>MEM will then estimate its standard error. If re-running the ﬁt presents a problem, there is a sim-<br>ple way to compute a conﬁdence interval for a function <i>q </i>of a single parameter. If the lower and<br>upper bounds of a 100(1-α )% conﬁdence interval for ˆ<br>
θ are denoted <i>bl </i>and <i>bu</i>, respectively, then a<br>
100(1-α )% conﬁdence interval for <i>q</i>( ˆ<br>
θ ) has lower and upper bounds <i>q</i>(<i>bl</i>) and <i>q</i>(<i>bu</i>), respectively.<br>
This conﬁdence interval, however, is not necessarily centered at <i>q</i>( ˆ<br>
θ ).<br>
<b>4.3. Multiple Parameters</b><br>
<b>4.3.1. Correlation of Parameter Estimates</b><br>
A truly new feature introduced by multiple parameters is the phenomenon of correlation among<br>parameter estimates. NONMEM outputs a correlation matrix for the parameter estimates. The<br>(<i>i</i>, <i>j</i>) element of the matrix is the correlation between the ith and jth parameter estimates. A large<br>correlation (e.g. ≥ . 95) means that the conditional distribution of the ith estimate, given a ﬁxed<br>value of the jth estimate, depends considerably on this ﬁxed value. Sometimes each parameter<br>estimate of a pair that is highly correlated has a large standard error, meaning that neither parame-<br>ter can be well-estimated. This problem may be caused by data that do not distinguish among the<br>parameters very well, while a simpler model, or a different design, or more data might permit<br>more precise estimates of each.<br>
As a simple example, imagine a straight line ﬁt to just two points, both at the same value of <i>x</i>:<br>neither slope nor intercept can be estimated at all as long as the other is unknown, but ﬁxing<br>either one (simplifying the model) determines the other. Both parameters could be estimated by<br>observing another point at some other value of <i>x </i>(more data), or, still using just 2 points, by plac-<br>ing these points at two different values of <i>x </i>(modifying the design). Thus, when standard errors<br>are large, it is useful to examine the correlation matrix of parameter estimates to see, in particular,<br>if some simpliﬁcation of the model may help.<br>
<b>4.3.2. Conﬁdence Intervals for a Function of Several Parameters</b><br>
There is an approximate formula for computing a standard error, and hence a conﬁdence interval<br>for a function of several parameters (e.g., a conﬁdence interval for half-life when the estimated<br>parameters are <i>Cl </i>and <i>V </i>). It uses the standard errors of the parameter estimates and the correla-<br>tions between the parameter estimates. However, discussion of this formula is beyond the scope<br>of this introduction. If a conﬁdence interval for a function of several parameters is desired, it is<br>
-44-<br>
<hr>
<A name=53></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
often more convenient to re-ﬁt the data with the model reparameterized to include the function as<br>an explicit parameter.<br>
<b>5. Hypothesis Testing</b><br>
Before going into details, a note of caution is in order about hypothesis testing in general. The<br>logic of hypothesis testing is that one sets up a hypothesis about a parameter’s value, called the<br>null hypothesis, and asks if the data are sufﬁciently in conﬂict with it to call it into question. If<br>they are, one rejects the null hypothesis. However, logically, if they are not, one has simply failed<br>to reject the null hypothesis; one does not necessarily have sufﬁcient data to accept it. An ex-<br>treme example will make this clear. Let the null hypothesis be any assertion at all about the state<br>of nature. Gather no evidence bearing on the question. Clearly, the evidence (which is void) is<br>insufﬁcient to reject the null hypothesis, but just as clearly, in this case the evidence provides no<br>support for it either.<br>
In less extreme cases there is a way to view failure to reject as lending some support to the null<br>hypothesis, but the matter is problematic. It is somewhat less problematic to use a conﬁdence<br>interval to quantify support for a null hypothesis. A null hypothesis is an assertion that a parame-<br>ter’s true value is found among a set of null values. A conﬁdence interval puts reasonable bounds<br>on the possible values of a parameter. One can then say that the evidence (the data from which<br>the parameter estimate is derived) <i>does </i>support a null hypothesis (about the value of the parame-<br>ter) if the null values are included in the interval and that the evidence fully support the null hy-<br>pothesis if all nonnull values lie outside. An example will help make this clear.<br>
Consider that mean drug clearance in adults varies linearly with the weight of the individual to a<br><i>clinically </i>signiﬁcant degree. Formally, this can be put as a statement about a regression coefﬁ-<br>cient in a model such as<br>
<i>Cl </i>= θ + θ<br>
1<br>
2(<i>WT </i>− 70), (5.3)<br>
The null hypothesis might be that θ 2 is close to zero, i.e. that it is not so different from zero as to<br>be clinically signiﬁcant. To make this precise, suppose that we know that mean clearance for a 70<br>kg person (i.e., θ 1) is about 100 ml/min. If θ2 were .20 ml/min/kg or less, a 50 kg increment<br>(decrement) in weight from 70 kg would be associated with less than a 10% change in total clear-<br>ance. This is clinically insigniﬁcant, so the appropriate null values for θ 2 might be 0.0 to .20,<br>assuming, of course, that a physical lower bound for the parameter is zero. (More usually in sta-<br>tistical discussions a set of null values consists of a single number, e.g. 0.) If the conﬁdence inter-<br>val for θ 2 only includes null values (e.g., it is .10 to .15), one might then safely conclude that<br>weight, if it has any effect at all, has no <i>clinically </i>signiﬁcant effect, and that the data fully support<br>the null hypothesis. If the conﬁdence interval includes null values and others (e.g., it is 0.0 to<br>.60), one would conclude that there is some support for the null hypothesis, but that there is also<br>some support for rejecting it. In this case the data are insufﬁcient to allow outright acceptance or<br>rejection. If the conﬁdence interval includes no null values (e.g., it is .80 to 1.3), one would reject<br>the null hypothesis and conclude that weight has a clinically signiﬁcant (linear) effect on clear-<br>ance.<br>
For these reasons, we urge caution when performing hypothesis tests and suggest that conﬁdence<br>intervals are often more useful. None the less, the popularity of hypothesis tests requires that they<br>be done, and we now describe two methods for so doing, the ﬁrst somewhat more approximate<br>and less general than the second, but easier to do.<br>
<b>5.1. Hypothesis Testing Using the SE</b><br>
A straight-forward way to test a null hypothesis about the value of a parameter is to use a conﬁ-<br>dence interval for this purpose. In other words, if the conﬁdence interval excludes the null values,<br>
-45-<br>
<hr>
<A name=54></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
then the null hypothesis is rejected. As described in Section 4.2.2, such a conﬁdence interval is<br>based on the estimated standard error. This method generalizes to a hypothesis about the values<br>of several parameters simultaneously, but this is beyond the scope of this introduction.<br>
<b>5.2. Hypothesis Testing Using the Likelihood Ratio</b><br>
An approach that involves the extra effort of re-ﬁtting the data has the advantage of being less<br>approximate than the one that uses a conﬁdence interval based on the SE. This method is the so-<br>called Likelihood Ratio Test.<br>
The basic idea is to compare directly the goodness of ﬁt (as indicated by the minimum value of<br>the extended least squares objective function) obtained between using a model in which the<br>parameter is ﬁxed to the hypothesized value (the <i>reduced </i>model) and a model in which the<br>parameter must be estimated (the <i>full </i>model).<br>
<b>5.2.1. Deﬁnition — Full/Reduced Models</b><br>
A model is a reduced model of a full model if it is identical to the full model except that one or<br>more parameters of the latter have been ﬁxed to hypothesized values (usually 0). Consider the<br>examples:<br>
E.g. #1. Valid Full/Reduced Pair:<br>
Full model: <i>˜</i><br>
<i>Cl </i>= θ + θ<br>
1<br>
2<i>WT</i><br>
Reduced model: <i>˜</i><br>
<i>Cl </i>= θ 1<br>
E.g. #2. Invalid Full/Reduced Pair:<br>
Full model: <i>˜</i><br>
<i>Cl </i>= θ 1<i>WT</i><br>
Reduced model: <i>˜</i><br>
<i>Cl </i>= θ 1<br>
In example #1, ﬁxing θ 2 to 0 produces the reduced model, while in example #2, no parameter of<br>the full model can be ﬁxed to a particular value to yield the &quot;reduced&quot; model. It will always be<br>true that if the models are set up correctly, the number of parameters that must be estimated will<br>be greater in the full model than in the reduced model. Note that this is not so for example #2.<br>
<b>5.2.2. Reduced/Full Models Express the Null/Alternative Hypotheses</b><br>
The reduced model expresses the <i>null hypothesis</i>; the full model expresses an <i>alternative hypothe-<br>sis</i>. In example #1 above, the null hypothesis is &quot;typical value of clearance is independent of<br>weight&quot;, and the alternative is &quot;typical value of clearance depends linearly on weight.&quot;<br>
Note an important point here: the alternative hypothesis represents a <i>particular </i>alternative, and<br>the likelihood ratio test using it will most sensitively reject the null hypothesis <i>only when </i>this par-<br>ticular alternative holds. If the full model were that &quot;the typical value of clearance is inversely<br>proportional to weight&quot; (so that as weight increases, the typical value of clearance decreases, a<br>situation which rarely holds), the likelihood ratio test using the alternative we hav e stated would<br>not be particularly sensitive to rejecting the null hypothesis, and we might fail to do so. In con-<br>trast, we might succeed in rejecting the null hypothesis if we used some other alternative model<br>closer to the truth.<br>
<b>5.2.3. The Likelihood Ratio Test</b><br>
Part of the NONMEM output is the &quot;Minimum Value of the Objective Function&quot; (see Chapter 2).<br>Denote this by <i>l</i>. If NONMEM’s approximate model were the true model, then <i>l </i>would be minus<br>twice the maximum logarithm of the likelihood of the data (for those readers unfamiliar with like-<br>lihoods, and curious as to what they are, we suggest consulting a statistics textbook). Statistical<br>theory tells us that the difference in minus twice the maximum log likelihoods between a full and<br>
-46-<br>
<hr>
<A name=55></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
reduced model can be referenced to a known distribution. Thus, to perform the Likelihood Ratio<br>Test, one proceeds as follows.<br>
Let <i>l f </i>be the minimum value of the objective function from the ﬁt to the full model, and let <i>lr </i>be<br>the corresponding quantity from the ﬁt to the reduced model. Fit both models separately yielding<br><i>l f </i>and <i>lr</i>, and form the statistic,<br>
<i>C</i>2 = <i>l </i>−<br>
<i>r</i><br>
<i>l f</i><br>
This statistic is approximately distributed chi-square ( χ 2) with <i>q </i>degree of freedom, where <i>q </i>is<br>the number of parameters whose values are ﬁxed in the reduced model. For an α -level test, com-<br>pare <i>C</i>2 to χ 21−α (<i>q</i>), the 100(1-α ) percentile of the χ 2 distribution.<br>In particular, when exactly one parameter of the full model is ﬁxed in the reduced model, a<br>decrease of 3.84 in the minimum value of the objective function is signiﬁcant at <i>p </i>&lt; . 05.<br>
If NONMEM’s approximate model (linear in the random effects) were the true model, and in<br>addition, <i>f </i>were linear in the ﬁxed effects, then <i>C</i>2/<i>q </i>would be (approximately) distributed<br>according to the <i>F </i>distribution with <i>q</i>, and <i>n </i>− <i>p </i>degrees of freedom (<i>F</i>(<i>q</i>, <i>n </i>− <i>p</i>)). Since<br><i>qF</i>(<i>q</i>, <i>n </i>− <i>p</i>) is equal to χ 2(<i>q</i>) only when <i>n </i>is &quot;large&quot;, and is greater otherwise, it is more conser-<br>vative to reference <i>C</i>2 to <i>qF</i>(<i>q</i>, <i>n </i>− <i>p</i>) in all instances, even when <i>f </i>is nonlinear.<br>
<b>6. Choosing Among Models</b><br>
An idea related to hypothesis testing is this: when faced with alternative explanations (models) for<br>some data, how does one use the data to determine which model(s) is (are) most plausible? When<br>one of the models is a reduced sub-model of the other, and there is some <i>a priori </i>reason to prefer<br>the reduced model to the alternative, then the Likelihood Ratio test can be used to test whether<br>this a priori preference must be rejected (at the α level). However, when one gives the matter<br>some thought, there is usually little <i>objective </i>reason to prefer one model over another on a priori<br>grounds. For example, although possibly more convenient, a monoexponential model is, if any-<br>thing, less likely on biological grounds than a biexponential.<br>
Not only may there not be a clear <i>a priori </i>probability favoring one contending model over<br>another, but the two models may not form a full and reduced model pair. In such circumstances,<br>one must rely on some goodness-of-ﬁt criterion to distinguish between the models. Consider<br>choosing between just two models (the ideas to be discussed readily generalize to more than two),<br>denoted model <i>A </i>and model <i>B</i>. If the number of free parameters in model <i>A </i>( <i>pA</i>) is the same as<br>that of <i>B </i>( <i>pB</i>), then here is a reasonable criterion: favor the model with the better ﬁt. Note that<br>there is no <i>p </i>value associated with this statement; no hypothesis is being tested.<br>
Unfortunately, if <i>p </i>≠<br>
<i>A</i><br>
<i>pB </i>one cannot simply compare <i>l A </i>and <i>lB </i>and choose the one with the<br>
smaller value. The reason is best understood when <i>A </i>and <i>B </i>are a full and reduced model pair.<br>The full model will <i>always </i>ﬁt the data better (i.e., have a smaller <i>l</i>) as it has more free parameters<br>to adjust its shape to the data. While the same is not always true for any pair of non-linear models<br>with different numbers of parameters, it is often true: the model with the greater number of<br>parameters will ﬁt a given data set better than the model with fewer parameters. Yet the larger<br>(more parameters) model may not really be better; it may, in fact, ﬁt an entirely new data set<br>worse than the simpler model if its better ﬁt to the original data was simply because it exploited<br>the ﬂexibility of its extra parameter(s) to better ﬁt some random aspect of that data.<br>
Based on the above intuitive argument, it seems that one should penalize the larger model in some<br>way before comparing the likelihoods. This intuition is formally realized in the Akaike Informa-<br>tion Criterion (AIC) which says that one should compute <i>AIC </i>= <i>l </i>−<br>
−<br>
<i>A</i><br>
<i>lB </i>+ 2( <i>pA</i><br>
<i>pB</i>), and<br>
choose model <i>B </i>if <i>AIC </i>is &gt;0, and model <i>A </i>if <i>AIC </i>is &lt;0. The second term penalizes model <i>A </i>if<br>
<i>p</i><br>
=<br>
<i>A </i>&gt; <i>pB </i>, and vice versa. When <i>p A</i><br>
<i>pB</i>, the <i>AIC </i>reduces to the comparison of <i>l A </i>and <i>lB</i><br>
-47-<br>
<hr>
<A name=56></a>Chapter 5 - Estimates, Conﬁdence Intervals, and Hypothesis Tests<br>
described previously.<br>
-48-<br>
<hr>
<A name=57></a><b>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor</b><br>
<b>1. What This Chapter is About</b><br>
This chapter tells how to create data for analysis by NONMEM-PREDPP. It tells how to describe<br>the data using $DAT A and $INPUT records. The requirements for formatting the data for NON-<br>MEM-PREDPP are somewhat more stringent than are the requirements for formatting the data<br>for NM-TRAN. The Data Preprocessor is a component of NM-TRAN which modiﬁes the data so<br>that it becomes formatted appropriately for NONMEM-PREDPP.<br>
<b>2. Data Sets for NONMEM</b><br>
<b>2.1. Data Records</b><br>
A data set for NONMEM analysis consists of a series of records (&quot;lines&quot; in the terminology of<br>editing programs). Each record must consist of a ﬁxed number of data items and each must have<br>the same format. Figure 6.1 shows how such a data set may be pictured. In data base terminol-<br>ogy, this is a &quot;ﬂat&quot; structure.<br>
Data Data Data<br>
Data<br>
item item item ...<br>
item<br>
#1 #2 #3<br>
#n<br>
Record #1<br>
Record #2<br>
Record #3<br>
.<br>.<br>
Figure 6.1. A NONMEM input data set. Each data record is a row; each type of data item is in a different column.<br>
NONMEM imposes no limit on the number of records in the data set. It does not (nor does<br>PREDPP or NM-TRAN) sort the data records before processing them, so the data records must<br>already be in the correct sequence. NONMEM itself cannot be instructed to delete or drop<br>records from the data set, but see the DROP and IGNORE options of the $DAT A record, below.<br>
<b>2.2. Data Items</b><br>
NONMEM reads records from the data set with a FORTRAN FORMAT speciﬁcation, and so<br>each data item must occupy a ﬁxed number of character positions. Data items are always num-<br>bers. However, if no particular number is appropriate for a given data item on a given record, the<br>data item is called a null data item; it may be given the numerical value 0 or the nonnumerical<br>value &quot;.&quot;, or left blank. Zero’s were used in the ﬁrst two lines of the Theophylline example of<br>Chapter 2, which appeared as follows:<br>
<b>2</b><br>
<b>320. 0.</b><br>
<b>0.</b><br>
<b>2</b><br>
<b>0.</b><br>
<b>.27 1.71</b><br>
The Data Preprocessor allows each value in the data set to occupy only as many character posi-<br>tions as it needs, so long as the data items are separated by blanks (spaces) or commas. Tab char-<br>acters may also be used as separators if they are stored as explicit characters, e.g., ASCII 011, al-<br>
-49-<br>
<hr>
<A name=58></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
though this is platform-dependent and should be tested carefully. When there are no commas or<br>tabs, the value &quot;.&quot; or 0 <i>must </i>be used to hold the place of a null data item. The two lines above<br>could have been entered as follows:<br>
<b>2 320. 0. 0.</b><br>
<b>2,,.27,1.71</b><br>
(Note the use in the second line of adjacent commas &quot;,,&quot; to denote a null data item.)<br>
The contents of the data items must be purely numeric; i.e., character values such as Y, N, M or F<br>may not be recorded. Instead, numeric codes such as 0 or 1 must be used.<br>
With NONMEM VI, the number of data items per data record is given by constant PD in ﬁle<br>SIZES. The default value is 20. With NONMEM 7.1, the default value is 50. With NONMEM<br>7.2, there is no limit on the number of data items per data record.<br>
<b>2.3. Clinical Data and Data Conversion</b><br>
Clinical data often has a &quot;hierarchical&quot; ﬁle structure, with (say) two record formats: a patient<br>record, containing ﬁxed information about a patient (ID number, sex, age, prior history of smok-<br>ing or drug use, etc), followed by one or more visit records, containing doses and physical obser-<br>vations during the course of the study. Visit records may not even contain the same number of<br>items as patient records, nor have the same format. The hierarchy is shown schematically in ﬁg-<br>ure 6.2.<br>
<b>Patient record</b><br>
<b>Visit record</b><br>
<b>Visit record</b><br>
<b>...</b><br>
<b>Patient record</b><br>
<b>Visit record</b><br>
<b>Visit record</b><br>
<b>...</b><br>
Figure 6.2. A hierarchical data ﬁle. Patient and visit records have different formats.<br>
NONMEM cannot accept such data. For NONMEM, the (ﬁxed) information on the &quot;patient&quot;<br>record must be copied onto every &quot;visit&quot; record, and the &quot;patient&quot; records must be eliminated.<br>This is the user’s responsibility and is typically done in a one-time data conversion step using the<br>system editor and/or a specially written computer program. If an individual’s data is to be deleted<br>because he did not complete the study or had an adverse outcome, it should be done at this time.<br>In addition, numeric codes should be substituted for alphabetic codes. Clinical data sometimes<br>includes multi-digit, non-consecutive patient identiﬁcation numbers drawn from some patient<br>identiﬁcation system. Such patient identiﬁcation numbers can be used with NONMEM as the<br>identiﬁcation data item described in Section 6.2. However, it is preferable to append to each<br>patient’s data records numbers from the sequence 1, 2, 3, ..., for use as the ID data item. This will<br>make it easier to read a scatterplot which includes ID along one of the axes (e.g., residual vs ID).<br>
When there is a large amount of data, we strongly suggest that a small amount of data (from one<br>or two individuals) be prepared for NONMEM-PREDPP analysis and a run in which only tables<br>and scatterplots are output be made to check that the data is correctly prepared before a great deal<br>of labor is expended on the remainder.<br>
-50-<br>
<hr>
<A name=59></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
<b>3. Data Sets for PREDPP</b><br>
When PREDPP is used with NONMEM, the data must meet additional requirements. First,<br>PREDPP is concerned with time-ordered events such as dose events, which introduce drug into<br>the system at particular times, and observation events, which report observations taken at particu-<br>lar times. PREDPP insists that these events be recorded on separate records. That is, dosing<br>information cannot be recorded on the same record as an observed value. Second, PREDPP<br>requires that the time of each event be recorded on each data record, and that the physical<br>sequence of the data records be the same as their sequence in time. (E.g., if a dose event immedi-<br>ately precedes an observation event in time, then the dose event record must immediately precede<br>the observation event record.) Again, neither PREDPP nor the Data Preprocessor will physically<br>sort or resequence the data records.<br>
<b>4. The $DAT A Record</b><br>
The $DAT A record describes the characteristics of the external data ﬁle to be processed by NON-<br>MEM. NONMEM is not a data base management system and does not store a data set between<br>runs; once a ﬁle has been prepared for NONMEM, it must be re-read each time it is to be ana-<br>lyzed. The ﬁrst character string appearing after $DAT A is the name of the ﬁle containing the<br>data. Since it is to be used in a FORTRAN OPEN statement, this name may not include embed-<br>ded special characters such as slashes (/ or \), commas, semi-colons, parentheses, equal signs or<br>spaces unless it is surrounded by single quotes ’ or double quotes &quot;. The ﬁlename may contain<br>80 characters. (If a ﬁle is to be opened by NONMEM rather than by NM-TRAN, the ﬁlename<br>may not contain embedded spaces, and may contain at most 71 characters.) A FORTRAN for-<br>mat speciﬁcation suitable to read the data may follow the ﬁle name; this is optional and can be<br>supplied by the Data Preprocessor. The choice is discussed more fully in Section 10.4 of this<br>chapter.<br>
Certain options may be speciﬁed if desired. Among these are:<br>
RECORDS=n<br>
This tells the number of records to be read from the data ﬁle. If omitted, the records are<br>read to the end-of-ﬁle or to a NONMEM FINISH record (Users Guide II). The RECORDS<br>option may be used to limit NONMEM processing to the initial portion of the ﬁle and is<br>useful during the early stages of debugging.<br>
RECORDS=label<br>
&quot;Label&quot; is a data item label. The data records for the problem will start at the place where<br>the ﬁle is positioned before data records are read and include all contiguous data records<br>having the same value for the data item. In particular, the ID label may be used (or alterna-<br>tively,<br>
the option may be coded RECORDS=IR, RECORDS=INDREC, or<br>
RECORDS=INDIVIDUALRECORD) to obtain the data for a single individual.<br>
IR,INDREC,INDIVIDUALRECORD.<br>
NOREWIND|REWIND<br>
With the ﬁrst problem speciﬁcation in a control stream, the ﬁle is positioned at its initial<br>point so that the ﬁrst record in the ﬁle is used. The options REWIND and NOREWIND<br>apply only with a $DAT A record in a subsequent problem speciﬁcation.<br>REWIND: Reposition the ﬁle at the start.<br>NOREWIND: Leave the ﬁle at its current position so that the next record in the ﬁle is read.<br>Used when the $DAT A record with the previous problem speciﬁcation included the<br>RECORDS option so that NM-TRAN did not read to a physical end-of-ﬁle. This is the<br>default.<br>
-51-<br>
<hr>
<A name=60></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
LRECL=n<br>
This tells the length of the physical data records. It is required if the operating system asso-<br>ciates a ﬁxed physical record length with every disk ﬁle <i>and </i>considers it a fatal I/O error if a<br>READ command requests more characters than the records contain. If this is true of your<br>operating system, the operating system will issue an error message when you ﬁrst run NM-<br>TRAN without the LRECL option in the $DAT A record.<br>
WIDE<br>
This requests that the NONMEM data set produced by NM-TRAN always contain single-<br>line records, and that these records always include at least one space between data items.<br>Such a data set can be further processed by other programs. (The default is NOWIDE, in<br>which case NM-TRAN limits the records to 80 characters by creating multi-line records<br>and/or eliminating spaces between data items if necessary.) It may not be used if a FOR-<br>TRAN format speciﬁcation is present. It also provides an extra character for relative times<br>computed by the Data Preprocessor.<br>
NULL=c<br>
This requests that the NONMEM data set produced by NM-TRAN contain the character c<br>in place of null data items. For example, NULL=0 requests that all null data items be<br>replaced by 0. The syntax NULL=’c’ and NULL=&quot;c&quot; is also permitted. The default is<br>NULL=’ ’. It may not be used if a FORTRAN format speciﬁcation is present.<br>
IGNORE=c<br>
This instructs NM-TRAN to ignore data records having character c in the ﬁrst character<br>position (&quot;column 1&quot;) of the record. This allows the use of &quot;comment&quot; records in the NM-<br>TRAN data set. The syntax IGNORE=’c’ and IGNORE=&quot;c&quot; is also permitted. It may be<br>used even if a FORTRAN format speciﬁcation is present.<br>The character @ has a special meaning. It signiﬁes that any data record containing an<br>alphabetic character (or special characters @ or #) as its ﬁrst non-blank character (not just in<br>column 1) should be ignored. Alphabetic characters are the letters A-Z and a-z. Thus, a ta-<br>ble ﬁle produced by NONMEM in an earlier run can be used as an NM-TRAN data set.<br>Any header lines included in this table can be dropped by specifying IGNORE=@.<br>
When the IGNORE option is omitted, any records containing the character # in column 1<br>are ignored.<br>
IGNORE=(list), ACCEPT=(list)<br>
This form of the IGNORE option allows records to be dropped based on the values of data<br>items. For example,<br>
<b>IGNORE=(GEN.EQ.1,AGE.GT.60).</b><br>
Records having GEN equal to 1 or AGE greater than 60 are dropped. All others are<br>accepted. The ACCEPT option allows records to be accepted based on the values of data<br>items. See Guide VIII for more information.<br>
LAST20=nn<br>
&quot;nn&quot; is a 2 digit number that speciﬁes the highest 2-digit year that is assumed to be in the<br>21st. century, i.e., that represents 20nn rather than 19nn. See Section 10.1.5 below.<br>
TRANSLATE<br>
The translate option must be followed by parentheses enclosing a list of one or more trans-<br>late speciﬁcations. For example,<br>
<b>$DATA filename TRANSLATE(TIME/24,II/24)</b><br>
-52-<br>
<hr>
<A name=61></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
Translate speciﬁcation TIME/24 causes the value of TIME to be divided by 24, whether or<br>not day-time translation occurs (i.e., whether or not relative times are being computed).<br>This has the effect of changing the unit of TIME from hours to days. Similarly, translate<br>speciﬁcation II/24 causes the value of II (interdose interval) to be divided by 24 whether<br>or not &quot;:&quot; appears in any II value. See Section 10.1.4 below.<br>
<b>5. The $INPUT Record</b><br>
This record describes how many data items there are on each data record, the order of the data<br>items, and tells what the labels of the data items are.<br>
<b>5.1. Data Item Labels</b><br>
A data item label is one to four letters (A-Z) or numerals (0-9). With NONMEM 7 a label con-<br>sists of 1-24 letters (A-Z), numerals (0-9), and the character ’_’. (The length 24 is speciﬁed by<br>constant SDF in SIZES)<br>The ﬁrst character must be a letter. These labels are the ones which will be used in other records<br>(such as $PK or $SCATTERPLOT), and will appear in NONMEM’s output. The order of the<br>data items on the data records is not important, but must be the same on all data records in the<br>data set. In both the examples of Chapter 2, the ID data items happened to be the ﬁrst ones in the<br>data records, and the DV data items happened to be the last ones. This order was arbitrary.<br>
<b>5.2. Reserved Labels and Synonyms</b><br>
Certain data item labels are reserved in that they identify data items which are recognized speciﬁ-<br>cally by NONMEM, PREDPP, or NM-TRAN. The data items they label are themselves called<br>NONMEM, PREDPP, or NM-TRAN data items, respectively.<br>
•<br>
Reserved NONMEM data item labels are: ID, L2, DV, and MDV. They are discussed in<br>Section 6 of this chapter and in Section 4.2 of Chapter 12. Additional reserved NONMEM<br>data item labels are: MRG_, RAW_, and RPT_. See Guide VIII for a discussion of these<br>items.<br>
•<br>
Reserved PREDPP data item labels are: TIME, EVID, AMT, RATE, SS, II, ADDL, CMT,<br>PCMT, CALL, and CONT. They are discussed in Section 7 of this chapter and in Section<br>2.4 of Chapter 12. Additional reserved PREDPP data items are the extra EVID labels,<br>XVID1, XVID2, XVID3, XVID4, and XVID5. See Guide VIII for a discussion of these<br>items.<br>
•<br>
Reserved NM-TRAN data item labels are: DATE, DAT1, DAT2, DAT3, and L1. DATE,<br>DAT1, DAT2, and DAT3 are discussed in Section 10.1 of this chapter; L1 is discussed in<br>Section 4.2 of Chapter 12.<br>
If you do not want to use the reserved label, you can supply two labels: the reserved label and a<br>&quot;synonym&quot;. Either label can be used in subsequent records, but only the synonym will appear in<br>NONMEM output. For example,<br>
<b>$INPUT PNO=ID,CONC=DV,DOSE=AMT,WT,....</b><br>
The ﬁrst three data items are given the labels PNO, CONC, and DOSE. These labels are syn-<br>onyms for the NONMEM data items ID and DV and for the PREDPP data item AMT. The last<br>data item is given the label WT and is not a reserved data item; it is an example of ﬁxed effect<br>(&quot;concomitant&quot;) data <i>x</i><br>
When $PK and $ERROR records are present, certain labels may not be used at all as data item<br>labels. These are: the labels for the basic and additional PK parameters for the pharmacokinetic<br>model, as listed in Appendices 1 and 2 (e.g., for ADVAN1 and TRANS2: CL, V, S1, S2, F1, F0),<br>and speciﬁc labels for the arguments of the PK and ERROR subroutines: IDEF, IREV, N, GG,<br>
-53-<br>
<hr>
<A name=62></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
IRGG, HH, and G.<br>
<b>5.3. Dropping Data Items via DROP</b><br>
If no format speciﬁcation is included on the $INPUT record, then another synonym, DROP, may<br>be used with any data item. DROP may be used as a synonym more than once. It identiﬁes data<br>items to be dropped (i.e. eliminated) from the NM-TRAN data set by the Data Preprocessor while<br>constructing the NONMEM data set. This provides a way to limit the number of data items in the<br>NONMEM data set and to eliminate non-numeric data items.<br>
<b>6. NONMEM Data Items</b><br>
<b>6.1. DV Data Item</b><br>
There must always be a Dependent Variable data item labeled DV. This is a value of an observa-<br>tion. There can be only one DV data item per data record. The position of the DV data item (and<br>the ones described below) is not important. However, its position must be the same on all<br>records.<br>
<b>6.2. ID Data Item for Population Data</b><br>
When the data is from a population, NONMEM expects the Identiﬁcation data item, labeled ID,<br>and expects the data to be organized into two or more &quot;individual records&quot;. An individual record<br>is a group of contiguous data records having the same value for the ID data item and presumably<br>containing data from the same individual. ID data item values need not be consecutive, increas-<br>ing, unique, nor begin with 1. E.g., 3, 5, 6, 10, 3, etc. is a possible sequence of ID values. Note<br>the two instances of 3 as ID data item values. As long as these two instances are separated by dif-<br>ferent ID data item values (e.g. 5, 6, 10), they represent different individuals.<br>
<b>6.3. MDV data item</b><br>
If there are records in an input data set which do not contain values of observations, then NON-<br>MEM needs to be informed of this fact. This is done using the Missing Dependent Variable data<br>item labeled MDV. The values of MDV are:<br>
0<br>
The DV data item of the data record contains a value of an observation. The record is<br>referred to as an observation record.<br>
1<br>
The DV data item of the data record does <i>not </i>contain a value of an observation.<br>
NONMEM limits the number of observation records per individual record to 250. To change this<br>limit, see Users Guide III.<br>
When PREDPP is used, the Data Preprocessor is able to recognize which records contain<br>observed values and which do not, and it can supply the MDV data item if it is not already present<br>in the data set, i.e. if the label MDV does not occur in the $INPUT record. (When PREDPP is not<br>used, the Data Preprocessor cannot do this.)<br>
<b>7. PREDPP Data Items</b><br>
<b>7.1. TIME Data Item</b><br>
PREDPP will in general need the<br>Time data item, labeled TIME. The value of TIME must be non-negative. Within an individual<br>record, values of TIME may not decrease. (Exceptions exist for reset and reset-dose events; see<br>Section 7.3.) The units are optional (e.g., minutes or hours), but should be consistent with other<br>
-54-<br>
<hr>
<A name=63></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
units used in the problem. The TIME of the ﬁrst event record may be zero or non-zero. (If non-<br>zero, then PREDPP in effect subtracts this value from all other TIME values within the same indi-<br>vidual record, so that PREDPP always works with relative time values.) The Data Preprocessor<br>permits TIME to be expressed as clock time (e.g., 8:30, representing the time, half-past 8<br>o’clock). Such times are converted by the Data Preprocessor into relative times. Details are giv-<br>en in Section 10.1 below.<br>
<b>7.2. AMT, RATE, SS, II: Dose-related Data Items</b><br>
Doses are described using one or more of these four data items, depending on the kind of dose. A<br>detailed discussion of these data items and of dose records in general is deferred to Section 8<br>below.<br>
<b>7.3. EVID Data Item</b><br>
When PREDPP is used, all data records are also called event records. Every event record must<br>contain an Event Identiﬁcation data item identifying the kind of event described by the record,<br>and labeled EVID. The values of EVID and the ﬁve kinds of event records are:<br>
0<br>
Observation event. This record contains an observed value (in the DV data item). Dose-<br>related data items such as RATE and AMT must be 0.<br>
1<br>
Dose event. This record describes a dose. The contents of the DV data item are ignored.<br>
2<br>
Other event. This record is used for a variety of purposes. It can be used to obtain a pre-<br>dicted value at a point in time at which no actual observation or dose event took place; it can<br>be used to turn a compartment off or on at a point in time; it can be used to mark a time at<br>which a change in a physiological data item (e.g. weight) occurs (as well as give the new<br>value of the data item). Dose-related data items must be 0. The contents of the DV data<br>item are ignored.<br>
3<br>
Reset event. This record is used to reset the kinetic system at some point in time, without<br>actually starting a new individual record: time is set to <i>whatever </i>time appears in the event<br>record, the amounts in each compartment are set to zero, prior doses are cancelled, and the<br>on/off status of each compartment is set to its initial status. It is in all other respects identi-<br>cal to an other event type record. It is typically used within an individual record, when the<br>individual had a course of drug treatment, followed by a wash-out period, followed by<br>another course of drug treatment. It should appear prior to the start of the second course.<br>
4<br>
Reset-dose event. This record combines EVID types 3 (reset) and 1 (dose). First the sys-<br>tem is reset, and then a dose is introduced. It is in all other respects identical to an ordinary<br>dose event type record.<br>
If only dose and observation event records are present in the NM-TRAN data set, and if EVID is<br>not already present in the data set (i.e. EVID does not appear in the INPUT record), then EVID<br>will be supplied automatically by the Data Preprocessor. This is what was done in the examples<br>of Chapter 2. If other or reset type event records are present in the data set, then the $INPUT<br>record must include the EVID data item, and the data set must include the appropriate values for<br>EVID on <i>all </i>the data records.<br>
<b>7.4. CMT and PCMT Data Items</b><br>
The Compartment data item (CMT) and Prediction Compartment data item (PCMT) are similar.<br>Both contain the number of a compartment in the model. (Compartments and compartment num-<br>bers are discussed in Chapter 7 and Appendix 1, as are default compartments. It may help to look<br>at Chapter 7 and Appendix 1 at this time.) If CMT or PCMT is not deﬁned in the data set (i.e.,<br>not listed in the $INPUT record), or has the value 0 on a given event record, the appropriate de-<br>
-55-<br>
<hr>
<A name=64></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
fault compartment is used, except as noted below. This is what was done in the examples of<br>Chapter 2. The meaning of the two data items depends on the particular kind of event record.<br>
•<br>
Observation event: CMT speciﬁes the compartment from which the predicted value of the<br>observation is obtained. PCMT is ignored. When CMT speciﬁes the output compartment,<br>it is allowed to have a neg ative sign (e.g., with the One-compartment model, CMT may be<br>-2). This signals that <i>after </i>the prediction is computed the output compartment is to be<br>turned off, i.e. the amount in the compartment is to be set to zero. The amount remains zero<br>until the compartment is subsequently turned on. This is quite useful with urine observa-<br>tions; see Section 9 below.<br>
•<br>
Dose event: CMT speciﬁes the compartment into which the dose is introduced. The com-<br>partment is turned on if it was previously off. PCMT speciﬁes the compartment for which a<br>predicted observation is computed. This predicted value is not associated with an observa-<br>tion, but it can be useful because it will appear in tables or scatterplots.<br>
•<br>
Other event: A positive value of CMT speciﬁes that the compartment is to be turned on if it<br>is off. A negative value of CMT speciﬁes that the compartment is to be turned off if it is on.<br>(If CMT is 0, no compartment is turned on or off.) PCMT is the same as for dose events.<br>
•<br>
Reset event: CMT is ignored. PCMT is the same as for dose events.<br>
•<br>
Reset-dose event: CMT and PCMT are the same as for dose events.<br>
<b>7.5. CALL Data Item</b><br>
The Call data item (CALL) is used to force a call to either or both of the PK and ERROR subrou-<br>tines with the event record when such a call would not normally occur. A call to the PK or ER-<br>ROR subroutine causes the code speciﬁed by the $PK or $ERROR records, respectively, to be ex-<br>ecuted with the event record. This is discussed in Chapters 7 ($PK) and 8 ($ERROR).) When not<br>deﬁned in the data set, CALL is assumed to be 0 always. The values are:<br>
0<br>
No forced call; PREDPP takes its normal action.<br>
1<br>
Force a call to ERROR.<br>
2<br>
Force a call to PK.<br>
3<br>
Force a call to both PK and ERROR.<br>
10 Force a call to ADVAN9. May be combined with other values. E.g., the value 12 means<br>
&quot;Force a call to PK and to ADVAN9&quot;.<br>
<b>8. Describing Doses to PREDPP</b><br>
Doses are described using one or more of the data items discussed below. A detailed discussion<br>of the actual kinds of doses that PREDPP recognizes follows in Section 8.2, including a precise<br>deﬁnition of what is meant by the term &quot;steady-state dose&quot; (Section 8.2.3). A data item that is not<br>needed to describe the kinds of doses used in the study need not be deﬁned in the data set; it will<br>in effect always have the value 0. Only AMT (Dose amount) was used in the examples of Chap-<br>ter 2, for example. The values of dose-related data items should be 0 for non-dose events and for<br>those dose events to which they are not relevant.<br>
<b>8.1. Dose-related Data Items</b><br>
<b>AMT data item</b><br>
The Amount data item (AMT) gives the amount of a bolus dose or of an infusion of ﬁnite dura-<br>tion. This amount should be a positive number.<br>
-56-<br>
<hr>
<A name=65></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
<b>RATE data item</b><br>
The Rate data item (RATE) gives the rate of an infusion. This rate should be a positive number.<br>(Negative values are discussed in Chapter 12, Section 2.3.)<br>
<b>SS data item</b><br>
The Steady-state data item (SS) can take four values.<br>
0<br>
This record does not describe a steady-state dose.<br>
1<br>
This record describes a steady-state dose. If this is not the ﬁrst event record for the individ-<br>ual, then the system is ﬁrst reset as if by a reset event record (except that the on/off status of<br>the compartments is unchanged from what it was prior to the event record and the time on<br>the event record must not be less than the time on the previous event record). The compart-<br>ment amounts are then computed using steady-state kinetic formulas.<br>
2<br>
This record describes a steady-state dose. No reset of the kinetic system occurs. Compart-<br>ment amounts are computed using steady-state kinetic formulas and are then added to the<br>amounts already present at the event time. The use of SS=2 will be discussed further in<br>Section 8.2.7, below.<br>
3<br>
This record describes a steady-state dose. It is exactly like a steady-state dose with SS data<br>item = 1, except that existing compartment amounts and derivatives are retained and used as<br>initial estimates. The computed steady-state levels replace these compartment amounts and<br>derivatives. This value of SS may be speciﬁed only with SS6 and SS9 (the General Nonlin-<br>ear Models).<br>
<b>II data item</b><br>
The Interdose Interval data item labeled II gives the time between implied doses (see Section<br>8.2.3 and Chapter 12, Section 2.4). For a steady-state infusion, it should be 0. For other steady-<br>state doses, it should be a positive number whose units are the same as the TIME data item.<br>
<b>8.2. Different Kinds of Doses</b><br>
Any of the doses described here may be introduced into any compartment of the model except the<br>output compartment. Examples are given below that are fragments of data records, identifying<br>the data items of interest and showing their contents on the dose record. The units of various data<br>items are presumed to be appropriate for some actual data.<br>
<b>8.2.1. Instantaneous Bolus Doses</b><br>
All the examples in Chapter 2 involve instantaneous bolus doses, which we shall refer to simply<br>as bolus doses. (There is also such a thing as a &quot;zero-order bolus dose&quot;, see Chapter 12, Section<br>2.3.) These are dose records having AMT&gt;0, RATE=0 and SS=0. (Recall that if RATE and SS<br>are not deﬁned on the $INPUT record, they are effectively 0.) If the $PK record computes a<br>bioavailability fraction parameter for the compartment into which the dose is introduced, then the<br>contents of the AMT data item is multiplied by the current value of this parameter before the<br>amount is added to the compartment. A bolus dose enters the dose compartment immediately;<br>the predicted (scaled) amount in the dose compartment, if displayed in a table or scatterplot, will<br>include the dose.<br>Example:<br>
<b>TIME AMT</b><br>
<b>4. 10.</b><br>
This is a dose of 10 to be added to the default dose compartment at time 4.<br>
A bolus dose to the central compartment might be interpreted as an IV bolus dose; to the depot it<br>might be an oral tablet; to a peripheral compartment it might be an intra-muscular injection.<br>
-57-<br>
<hr>
<A name=66></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
<b>8.2.2. Infusions</b><br>
Infusions are doses having AMT&gt;0 and RATE&gt;0. The duration of the infusion is computed by<br>PREDPP by dividing the AMT by the RATE. As with bolus doses, AMT is ﬁrst multiplied by the<br>bioavailability parameter for the dose compartment, if any. There is no explicit &quot;end of infusion&quot;<br>record. Drug amounts in the system cannot be affected in a detectable way at the time an infusion<br>begins by any drug introduced by the infusion; the predicted (scaled) amount in the dose compart-<br>ment, if displayed in a table or scatterplot, will not include the dose. Infusions may overlap. That<br>is, subsequent dose records may start new infusions before old ones have ﬁnished. It is not an<br>error if an infusion’s duration is so large as to extend beyond the time of the last event record for<br>the individual; the remainder of the drug is ignored. A reset or reset-dose event, or a steady-state<br>dose event with SS=1, will also terminate any infusions in progress.<br>Example:<br>
<b>TIME AMT RATE</b><br>
<b>4. 10.</b><br>
<b>2.</b><br>
The duration of the infusion will be computed as 10./2., and so the infusion, which begins at time<br>4, will terminate at time 9. (=4.+5.).<br>
An infusion to the central compartment might be interpreted as an IV infusion; to the depot it<br>might be a sustained release tablet; to a peripheral compartment it might be an implant or skin<br>patch which releases drug at a known constant rate. It is possible for NONMEM-PREDPP to<br>estimate the input rate of a constant-rate drug delivery system (see Chapter 12, Section 2.3).<br>
<b>8.2.3. Steady-State Doses</b><br>
A steady-state dose can be regarded as the last one of a series of doses just like the one speciﬁed<br>in the dose event record, which have been given at a   regular interdose interval since time −∞, and<br>
such that they hav e led to a steady-state periodic pattern of drug amounts in the system by the<br>time this last dose has been administered. The doses of similar kind that precede it are called<br>implied doses, because their existence is not described by separate dose records in the data set,<br>but rather is implied by the description of the single steady-state dose. By stipulating that a dose<br>is a steady-state dose, the user instructs PREDPP to update the drug amounts in the system at the<br>time the dose is given by using steady-state kinetic formulas. This can take less computational<br>time than using separate dose records to describe the implied doses and using transient kinetic<br>formulas to advance the system from one dose time to the next (as well as requiring fewer dose<br>records). The formulas used to compute the steady-state amounts at the time the steady-state dose<br>is introduced use the values of the basic and additional pharmacokinetic parameters in effect at<br>this time; any values in effect at earlier times are ignored. Moreover, when using a steady-state<br>dose, the user is assuming that under reasonable values of the pharmacokinetic parameters,<br>steady-state is in fact effectively reached by the time the dose is introduced; PREDPP does not<br>check this assumption. The output compartment must be off when a steady state dose record is<br>encountered in the data set.<br>
<b>8.2.4. Steady-State with Multiple Bolus Doses</b><br>
These are dose events having AMT&gt;0, RATE=0, SS=1, and II&gt;0. The II data item (interdose<br>interval) tells how many time units apart the doses were given. As with non-steady-state bolus<br>doses, AMT is ﬁrst multiplied by the bioavailability parameter for the dose compartment, if any.<br>Figure 6.3 shows how drug levels vary with time. The concentration-time proﬁles over each<br>interdose interval look the same since, in principle, there is an <i>inﬁnite </i>number of implied doses.<br>
-58-<br>
<hr>
<A name=67></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
Predicted level at time<br>
L<br>
of steady-state dose event<br>
E<br>V<br>E<br>L<br>
 Steady-state<br>
 interdose levels<br>
t-3I<br>
t-2I<br>
t-I<br>
t<br>
t+I<br>
TIME<br>
Figure 6.3. Steady-state with multiple bolus doses. The dose is given at time t. The interdose interval is I. Steady-state<br>
levels can be predicted between times t and t+I.<br>
Example:<br>
<b>TIME AMT SS II</b><br>
<b>8</b><br>
<b>10. 1 12</b><br>
Here, an inﬁnite number of bolus doses, 10 units each, are assumed to have been given 12 hours<br>apart, with the last of these given at time 8AM, at which time steady-state is reached. The fact<br>that TIME is 8 has no effect on the computed amounts, but is important in relation to the records<br>that follow. Steady-state levels can be predicted at any time between the time on the dose record<br>(8) and the end of the succeeding interdose interval (12) (provided there are no further doses<br>introduced <i>during </i>this interval). If another (steady-state or <i>non-steady-state</i>) dose just like the<br>steady-state one is introduced at time 20, then predictions in the interdose interval following this<br>time will also be steady-state levels.<br>
<b>8.2.5. Steady-State with Multiple Infusions</b><br>
These are dose events having AMT&gt;0, RATE&gt;0, SS=1, and II&gt;0. Each such event describes the<br>last of a series of regularly spaced infusions, all of the same amount and rate. As with a non-<br>steady-state infusion, the duration of each infusion is given by AMT/RATE. The bioavailability<br>fraction applies to each infusion of the series.<br>Figure 6.4 shows how drug levels vary with time. The concentration-time proﬁles over each<br>interdose interval look the same since, in principle, there is an <i>inﬁnite </i>number of implied doses.<br>
-59-<br>
<hr>
<A name=68></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
Predicted level at time<br>
L<br>
of steady-state dose event<br>
E<br>V<br>E<br>L<br>
 Steady-state<br>
 interdose levels<br>
t-3I<br>
t-2I<br>
t-I<br>
t<br>
t+I<br>
TIME<br>
Figure 6.4. Steady-state with multiple infusions. The dose is given at time t. The interdose interval is I. Steady-state<br>
levels can be predicted between times t and t+I.<br>
Example:<br>
<b>TIME AMT RATE SS II</b><br>
<b>16 10. 5.</b><br>
<b>1</b><br>
<b>6</b><br>
Here, infusions, each 10 units and of duration 2 (=10/5), are assumed to have been given 6 hours<br>apart, with the last of these started at time 4PM, at which time steady-state is reached. The daily<br>dose times were 4 AM, 10 AM, 4 PM, and 10 PM. Again, the value of TIME has no effect on the<br>computed amounts but is important in relation to the records that follow. Steady-state levels can<br>be predicted between times 16 (4 PM) and 22 (10 PM) (provided there are no further doses intro-<br>duced <i>during </i>this interval).<br>
<b>8.2.6. Steady-State with Constant Infusion</b><br>
These are dose events having AMT=0, RATE&gt;0, SS=1, and II=0. Such an event consists of infu-<br>sion with the stated rate, starting at time −∞, and <i>ending </i>at the time on the dose event record.<br>
Bioavailability fractions do not apply to these doses.<br>Figure 6.5 shows how drug levels vary with time.<br>
Predicted level at time<br>
L<br>
of steady-state dose event<br>
E<br>V<br>E<br>L<br>
t-3I<br>
t-2I<br>
t-I<br>
t<br>
t+I<br>
TIME<br>
Figure 6.5. Steady-state with constant infusion. Steady-state level can be predicted only at time t.<br>
Example:<br>
<b>TIME RATE SS</b><br>
<b>16 2. 1</b><br>
Here, a steady-state infusion at rate 2 is speciﬁed as ending at 4 PM. A steady-state level can be<br>
-60-<br>
<hr>
<A name=69></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
predicted only at this time.<br>
<b>8.2.7. Multiple Steady-State Doses</b><br>
Doses with SS=2 are exactly like doses with SS=1. Doses with SS=2 are similar to non-steady-<br>state doses in that compartment amounts are computed in two steps. First, compartment amounts<br>are computed at the time on the dose event record based on the prior dosing history of the system.<br>Second, steady-state amounts are computed from the dosing information on the record and added<br>to the existing compartment amounts. Thus, if the kinetics are linear, this results in an application<br>of the superposition principle wherein the amounts in the system resulting from doses described<br>by dose event records preceding the time of the steady-state dose are superposed on the (steady-<br>state) amounts in the system resulting from the steady-state dose and the implied doses.<br>
As with any steady-state dose, the steady-state amounts are obtained using the values of the phar-<br>macokinetic parameters computed from the information on the steady-state dose record. In the<br>case that SS=2, though, if these values differ from those computed from the information on the<br>previous dose record(s), then the compartment amounts at the time in the steady-state dose record<br>are not truly steady-state amounts, and the computed steady-state levels are not valid predictions.<br>PREDPP will not detect this error. We emphasize that superposition is only valid with linear<br>kinetic systems; all the kinetic systems (ADVANs) discussed in this text are linear.<br>
SS=2 records can be used to achieve the speciﬁcation of complicated dosing regimens. For exam-<br>ple, Figure 6.6 shows how drug levels vary with time when two different doses are alternated. In<br>this illustration, two steady-state doses are speciﬁed, each with interdose interval I and with time<br>between the two steady-state doses equal to I/2. Even more complex patterns are possible.<br>
Predicted level at time<br>
of steady-state dose event<br>
L<br>E<br>V<br>E<br>L<br>
 Steady-state<br>
 interdose levels<br>
t-3I<br>
t-2I<br>
t-I<br>
t<br>
t+I<br>
TIME<br>
Figure 6.6. Multiple steady-state doses. Tw o separate steady-state doses are given. As pictured, they are each bolus<br>
doses, but they do not have to be. The ﬁrst dose event record is at time t. The second dose event record is at time t+I/2.<br>
They each have interdose interval I. Steady-state levels can be predicted between times t+I/2 and and t+I.<br>
Example:<br>
<b>TIME AMT SS II</b><br>
<b>8</b><br>
<b>10. 1 24</b><br>
<b>20 15. 2 24</b><br>
This describes the following dosing regimen: a dose of 10 units every morning at 8 AM and a<br>dose of 15 units every evening at 8 PM (20 hours is 12 hours past 8). Note that steady-state is not<br>truly established until <i>after </i>the second dose record; any observation events interposed between<br>the two dose records will reﬂect only the ﬁrst steady-state dosage (i.e., 10 units every 8 AM).<br>
-61-<br>
<hr>
<A name=70></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
Another way to achieve the same steady-state is by the following:<br>Example:<br>
<b>TIME AMT SS II</b><br>
<b>20 10. 1 12</b><br>
<b>20 5.</b><br>
<b>2 24</b><br>
This describes doses of 10 units every 12 hours, the last of which is given at 8 PM (i.e. at 8 AM<br>and 8 PM daily), plus additional doses of 5 units at 8 PM daily. In both examples, the steady-<br>state levels can be predicted from time 20 hours to time 32 hours.<br>
<b>8.2.8. Combining Non-Steady-State Doses with Steady-State Doses</b><br>
Non-steady-state dose records may appear before, among, or after steady-state dose records.<br>Such a dose record may occur <i>before </i>a steady-state dose record to reﬂect a transient dose given<br>among a series of regular doses leading to steady-state, but which is not a part of this series. E.g.,<br>a patient who has been maintained at steady-state takes an extra dose by mistake shortly before<br>his appointment. A non-steady-state dose record may occur <i>after </i>a steady-state dose record in<br>order to continue the pattern of doses beyond the steady-state dose. Ordinarily, steady-state levels<br>can only be predicted between <i>t</i>1, the time on the steady-state dose record, and <i>t</i>2, the sum of <i>t</i>1<br>and the interdose interval. If it is not only necessary to compute a steady-state prediction between<br><i>t</i>1 and <i>t</i>2, but also after <i>t</i>2, then there must also occur one or more non-steady-state dose records at<br><i>t</i><br>
+<br>
2, <i>t</i>2<br>
<i>I </i>, etc. with doses just like the steady-state dose. (The &quot;additional doses&quot; data item,<br>
labeled ADDL, is especially useful for this purpose; see Chapter 12, Section 2.4.)<br>Example:<br>
<b>TIME AMT SS II</b><br>
<b>8</b><br>
<b>10. 1 24</b><br>
<b>20 15. 2 24</b><br>
<b>32 10. 0 0</b><br>
<b>44 15. 0 0</b><br>
Here, the last two records continue the steady-state pattern of the ﬁrst two. Steady-state levels<br>may be predicted between times 20 and 56.<br>
Similarly, a steady-state constant infusion may be extended with a non-steady-state infusion. In<br>the example below, steady-state levels can be predicted from time 0 to time 100.<br>
<b>TIME RATE</b><br>
<b>AMT SS</b><br>
<b>0</b><br>
<b>30</b><br>
<b>0.</b><br>
<b>1</b><br>
<b>0</b><br>
<b>30 3000. 0</b><br>
<b>9. The Output Compartment: Urine Collections and Observations</b><br>
In this section we show how urine collections and observations of urine concentration, <i>Cu</i>, can be<br>described. The ﬁrst-time reader may prefer to return to this section after reading Section 4.3.3 of<br>Chapter 7. As an example, consider the one-compartment model with ﬁrst-order absorption<br>(ADVAN2). The sequence of events is:<br>
6:00 AM A bolus dose of 100 is given.<br>8:00 AM A urine collection is started.<br>9:30 AM <i>Cu </i>and urine volume (UVOL) are measured and a new collection is started.<br>
11:45 AM <i>C p</i>, <i>Cu</i>, and urine volume are measured.<br>
The $INPUT record is:<br>
<b>$INPUT ID TIME EVID UVOL DV CMT AMT</b><br>
The data records appear as follows:<br>
-62-<br>
<hr>
<A name=71></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
<b>ID TIME EVID UVOL</b><br>
<b>DV CMT</b><br>
<b>AMT</b><br>
<b>1</b><br>
<b>6.00 1</b><br>
<b>0</b><br>
<b>0</b><br>
<b> </b><br>
<b>1</b><br>
<b>100</b><br>
<b>1</b><br>
<b>8.00 2</b><br>
<b>0</b><br>
<b>0</b><br>
<b> </b><br>
<b>3</b><br>
<b>0</b><br>
<b>1</b><br>
<b>9.50 0 75</b><br>
<b>.058 -3</b><br>
<b>0</b><br>
<b>1</b><br>
<b>9.50 2</b><br>
<b>0</b><br>
<b>0</b><br>
<b> </b><br>
<b>3</b><br>
<b>0</b><br>
<b>1 11.75 0</b><br>
<b>100 .067</b><br>
<b>-3 0</b><br>
<b>1 11.75 0</b><br>
<b>100 5.80</b><br>
<b>2</b><br>
<b>0</b><br>
Notice that urine collections start with an other type event record (EVID=2) whose CMT contains<br>the number of the output compartment, the effect of which is to turn this compartment on at<br>8AM, i.e. to begin accounting for the amount of drug appearing in this compartment from 8AM.<br>Because other type event records are included, the EVID data item <i>must </i>be present in the data.<br>The CMT data item must be present in all event records since it is needed to refer to the output<br>compartment in at least one record. Care must be taken to use correct values for the CMT data<br>item; default values used when this data item is not present are not relevant in this case. The DV<br>value on the observation record at 9:30 is the measured <i>Cu</i>. Because the value of CMT is nega-<br>tive, the output compartment is also turned off at 9:30. Since the collection is to continue, the<br>compartment must be explicitly turned on again (the fourth record). Note that UVOL is recorded<br>on both observation records at time 11:45. Strictly speaking, it need only be recorded on the sec-<br>ond (<i>Cu </i>observation). This point is discussed further in Chapter 7, Section 4.3.3.<br>
<b>10. The Data Preprocessor</b><br>
This section discusses in more detail the ways in which the Data Preprocessor can modify data,<br>and discusses when a format speciﬁcation should be included in the $DAT A record.<br>
<b>10.1. Day-time Translation</b><br>
<b>10.1.1. TIME Data Item</b><br>
Sometimes the data contains clock times hh:mm (e.g., the time 1:30 PM is recorded as 13:30).<br>These times must be converted to decimal-valued times (e.g., 13.5). The Data Preprocessor can<br>perform this task when it is processing unformatted data. Within an individual record, the Data<br>Preprocessor replaces the TIME value in the ﬁrst data record with 0, and then replaces subsequent<br>records’ TIME values with the relative time (i.e., the number of hours elapsed since the ﬁrst<br>record). (The TIME value is also reset to 0 on a reset (EVID=3) or reset-dose (EVID=4) record.)<br>Here is an example of relative time calculation:<br>
<b>Contents of original file:</b><br>
<b>Contents of new file:</b><br>
<b>ID TIME</b><br>
<b>ID TIME</b><br>
<b>1</b><br>
<b>9:15 1</b><br>
<b>0.00</b><br>
<b>1</b><br>
<b>9:30 1</b><br>
<b>0.25</b><br>
<b>1</b><br>
<b>10</b><br>
<b>1</b><br>
<b>0.75</b><br>
<b>1</b><br>
<b>14:40 1</b><br>
<b>5.42</b><br>
<b>1</b><br>
<b>32.5 1</b><br>
<b>23.25</b><br>
<b>2</b><br>
<b>8</b><br>
<b> </b><br>
<b>2</b><br>
<b>0.00</b><br>
<b>2</b><br>
<b>8.0 2</b><br>
<b>0.00</b><br>
<b>2</b><br>
<b>44:50 2</b><br>
<b>36.83</b><br>
<b>2</b><br>
<b>58</b><br>
<b>2</b><br>
<b>50.00</b><br>
The presence of the colon &quot;:&quot; in the TIME data item of at least one record of the data causes the<br>Data Preprocessor to convert all the TIME values to elapsed values. Elapsed times are also called<br>relative times. Note that recorded data (lines 5, 8, and 9 of the original ﬁle) spanned more than<br>one day. The user had to add 24 to the TIME values on each day subsequent to the ﬁrst to com-<br>municate the correct times to the Data Preprocessor.<br>
-63-<br>
<hr>
<A name=72></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
<b>10.1.2. DATE Data Item</b><br>
Here is another way the above data could have been recorded, using a data item called DATE<br>whose value is 1 for the ﬁrst day, 2 for the second day, and so on. This allows TIME values to be<br>recorded more naturally using values in the range 0-24.<br>
<b>Contents of original file:</b><br>
<b>Contents of new file:</b><br>
<b>ID DATE</b><br>
<b>TIME ID</b><br>
<b>DATE TIME</b><br>
<b>1</b><br>
<b>1</b><br>
<b>9:15 1</b><br>
<b>1</b><br>
<b>0.00</b><br>
<b>1</b><br>
<b>1</b><br>
<b>9:30 1</b><br>
<b>1</b><br>
<b>0.25</b><br>
<b>1</b><br>
<b>1</b><br>
<b>10 1</b><br>
<b>1</b><br>
<b>0.75</b><br>
<b>1</b><br>
<b>1</b><br>
<b>14:40 1</b><br>
<b>1</b><br>
<b>5.42</b><br>
<b>1</b><br>
<b>2</b><br>
<b>8.5 1</b><br>
<b>2</b><br>
<b>23.25</b><br>
<b>2</b><br>
<b>1</b><br>
<b>8</b><br>
<b>2</b><br>
<b>1</b><br>
<b>0.00</b><br>
<b>2</b><br>
<b>1</b><br>
<b>8.0 2</b><br>
<b>1</b><br>
<b>0.00</b><br>
<b>2</b><br>
<b>2</b><br>
<b>20:50 2</b><br>
<b>2</b><br>
<b>36.83</b><br>
<b>2</b><br>
<b>3</b><br>
<b>10 2</b><br>
<b>3</b><br>
<b>50.00</b><br>
The DATE data item is of signiﬁcance only to the Data Preprocessor; NONMEM-PREDPP will<br>not make use of it. Even if there are no &quot;:&quot; characters among the TIME values, the existence of a<br>DATE data item will cause the Data Preprocessor to replace TIME values by relative times.<br>
<b>10.1.3. Calendar Dates</b><br>
The Date data item (DATE) can also be used to record calendar dates in month-day-year format.<br>Any alphabetic character (e.g., / or -) can be used to separate the components. Here is a third way<br>the same example could be recorded:<br>
<b>Contents of original file:</b><br>
<b>Contents of new file:</b><br>
<b>ID DATE=DROP TIME</b><br>
<b>ID TIME</b><br>
<b>1</b><br>
<b>10-1-86 9:15</b><br>
<b>1</b><br>
<b>0.00</b><br>
<b>1</b><br>
<b>10-1-86 9:30</b><br>
<b>1</b><br>
<b>0.25</b><br>
<b>1</b><br>
<b>10-1-86 10</b><br>
<b>1</b><br>
<b>0.75</b><br>
<b>1</b><br>
<b>10-1-86 14:40</b><br>
<b>1</b><br>
<b>5.42</b><br>
<b>1</b><br>
<b>10-2-86 8.5</b><br>
<b>1</b><br>
<b>23.25</b><br>
<b>2</b><br>
<b>10-12 8</b><br>
<b>2</b><br>
<b>0.00</b><br>
<b>2</b><br>
<b>10-12 8.0</b><br>
<b>2</b><br>
<b>0.00</b><br>
<b>2</b><br>
<b>10-13 20:50</b><br>
<b>2</b><br>
<b>36.83</b><br>
<b>2</b><br>
<b>10-14 10</b><br>
<b>2</b><br>
<b>50.00</b><br>
This example illustrates two features. First, when calendar dates are used, the DATE item should<br>be speciﬁed as &quot;DATE=DROP&quot;, so that the data item is omitted from the new data ﬁle (see Sec-<br>tion 5.3). Otherwise, the alphabetic characters which separate the components will cause read er-<br>rors when NONMEM reads the data. Second, the year value is optional; only month and date<br>were actually needed. (Within a single individual record, however, either all dates should specify<br>a year, or none should.)<br>
Data labels DAT1, DAT2, and DAT3 are also recognized by the Data Preprocessor and can be<br>used instead of DATE. The label given to the Date data item describes its format:<br>
DATE month day year<br>DAT1 day month year<br>DAT2 year month day<br>DAT3 year day month<br>
If only one of the three components is present, it is assumed to be the day†. If only two<br>
† In this case <i>only</i>, the Date data item may be zero or negative. Day -1 means one day prior to day 0.<br>
-64-<br>
<hr>
<A name=73></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
components are present, they are assumed to be month and day (with DATE and DAT2) or day<br>and month (with DAT1 and DAT3). The year may be omitted or given as 1, 2, 3, or 4 digits.<br>
<b>10.1.4. Converting Hours to Days</b><br>
The units of the relative TIME values resulting from the Data Preprocessor’s day-time translation<br>are hours. If the correct units for relative time should be days, then the TRANSLATE option of<br>the $DAT A record may be used to request that hours to be converted to days. For example,<br>
<b>$DATA filename TRANSLATE(TIME/24)</b><br>
or<br>
<b>$DATA filename TRANSLATE(TIME/24.000)</b><br>
With the former, values of TIME have two signiﬁcant digits, e.g., xxxx.xx. With the latter, they<br>have three signiﬁcant digits, e.g., xxxx.xxx.<br>
<b>10.1.5. The Year 2000 - LAST20</b><br>
The user may supply 4 digit years starting (e.g.) &quot;19&quot; and &quot;20&quot;, and such dates are processed cor-<br>rectly. (Three digit years &quot;000&quot;-&quot;999&quot; are permitted, but would represent exactly those years, and<br>should not normally be used.) If the year is omitted, it is assumed to be a non-leap year. A prob-<br>lem arises when the year supplied, but has only 1 or 2 digits. Such years are assumed by default<br>to be in the 1900’s. If this is not a correct assumption, two errors may be made by the Data Pre-<br>processor when computing relative times. First, 1900 was not a leap year, but 2000 is a leap year.<br>Hence, if consecutive dates in a data ﬁle are 02-28-00 and 03-01-00 (signifying February 28 and<br>March 1, 2000), an elapsed time of 24 hours, rather than 48 hours, is computed. Second, if con-<br>secutive dates have years 99 and 00, the computed elapsed time is negative and an error message<br>is generated.<br>
With NONMEM V and later versions there is a constant LAST20. The value of LAST20 is a 2<br>digit number nn that speciﬁes the highest 2-digit year that is assumed to be in the 21st. century,<br>i.e., to represent 20nn rather than 19nn. For example, with LAST20=50, then 1 and 2 digit years<br>are interpreted as follows:<br>
00-50 represents 2000-2050<br>51-99 represents 1951-1999<br>
The elapsed time between 02-28-00 and 03-01-00 is calculated to be 48 hours, and the elapsed<br>time calculated between the years 99 (1999) and 00 (2000) is positive.<br>
There are two ways that a value for LAST20 can be speciﬁed.<br>
First, when NM-TRAN is installed, a value is given to constant LAST20 in TrGlobal.f90 (in the<br>resource directory):<br>
DATA LAST20<br>
The default value of this constant in the distribution medium is 50. Please ask your system sup-<br>port department if they modiﬁed the LAST20 constant when NM-TRAN was installed.<br>
Regardless of what value was assigned to the LAST20 constant in TrGlobal.f90, there is an option<br>LAST20 of the $DAT A record that may be used to specify the value of the constant for the cur-<br>rent run. For example:<br>
<b>$DATA filename LAST20=50</b><br>
This insures that all 1 and 2 digit years are interpreted as above (2000-2050; 1951-1999).<br>
<b>10.1.6. Leap Year Warning - LYWARN</b><br>
There may be two circumstances such that 1 or 2 digit years are recorded as 00, 01, ... (equiva-<br>lently, 0, 1, ...). First, these may represent the years 2000, 2001, etc. Or, they may represent<br>years 0, 1, etc., of a study. Suppose the latter is the case, and that none of the years of the study<br>
-65-<br>
<hr>
<A name=74></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
was a leap year. Then if LAST20 is set to a value greater than -1, the year 0 is assumed incor-<br>rectly to be the leap year 2000, and elapsed times may be computed incorrectly. The Data Pre-<br>processor issues a warning message under the following circumstances:<br>
1) The year is recorded as &quot;00&quot; or &quot;0&quot;,<br>
2) The value of LAST20 is greater than -1 by default (so that the year is understood to be<br>
2000), and<br>
3) The LAST20 option of the $DAT A record was not used to modify LAST20 for this run.<br>
The warning message is as follows:<br>
<b>(DATA WARNING</b><br>
<b>3) RECORD</b><br>
<b>3, DATA ITEM</b><br>
<b>3: 01-01-00</b><br>
<b>THE YEAR IS ASSUMED TO BE 2000 (A LEAP YEAR). IF THIS IS INCORRECT, USE</b><br>
<b>$DATA’S LAST20 OPTION TO OVERRIDE THE DEFAULT VALUE OF LAST20 IN NMTRAN’S</b><br>
<b>ABLOCK, OR CHANGE THE DEFAULT: 50</b><br>
Suppose these warning messages are appropriate, that is, year &quot;00&quot; (or &quot;0&quot;) should not be a leap<br>year. The LAST20 option of the $DAT A record may be used to specify that such years are in the<br>1900’s for the current data set:<br>
<b>$DATA filename LAST20=-1</b><br>
A constant LYWARN is deﬁned in NM-TRAN’s ABLOCK module. The default value of<br>LYWARN is 1 (&quot;data warning message 3 enabled&quot;). If the value of LYWARN is set to 0 (&quot;data<br>warning message 3 disabled&quot;) and NM-TRAN is recompiled, then the warning message is sup-<br>pressed for all runs.<br>
<b>10.2. Interdose Interval (II) Conversion</b><br>
When the input data is unformatted and PREDPP is being used, the Interdose Interval (II) data<br>item is checked for values containing a colon (:). Any such value is assumed to signal a clock<br>time hh:mm. The minutes portion is converted to a decimal number containing as many decimal<br>places as digits in the original. E.g., the value &quot;:30&quot; is replaced by &quot;.50&quot;. This conversion is per-<br>formed whether or not day-time translation is also being done.<br>
<b>10.3. Data Items Generated by the Data Preprocessor</b><br>
When the data is from a single individual, the Data Preprocessor will almost always generate an<br>ID data item‡. It does this whether or not PREDPP is used. This is done because, when the data<br>is from a single individual, the ID data item must take on very special non-constant values for<br>NONMEM. The generated ID data item is given the label &quot;.ID.&quot; (i.e., ID surrounded by dots). If<br>this data item is to be shown in any NONMEM output (e.g., in a table), it must be referred to on<br>subsequent NM-TRAN records by this label.<br>
When PREDPP is used, the Data Preprocessor will always generate the required EVID data item<br>if it is not already listed on the $INPUT record. (This was discussed in Section 7.3 above.)<br>
When PREDPP is used, the Data Preprocessor will always generate the MDV (Missing Depen-<br>dent Variable) data item if it is not already listed on the $INPUT record.<br>
These data items are generated by the Data Preprocessor whether or not a format speciﬁcation<br>was coded on the $INPUT record. They are appended to the end of each data record.<br>
‡ Section 4.2 of Chapter 12 discusses the L1 data item, which is used to prevent NM-TRAN from generating an<br>Identiﬁcation data item for individual data.<br>
-66-<br>
<hr>
<A name=75></a>Chapter 6 - Data Sets, $DAT A and $INPUT Records, and the Data Preprocessor<br>
<b>10.4. When Must a Format Speciﬁcation be Included or Omitted?</b><br>
When coding the $DAT A record, you will need to decide whether to include a FORTRAN format<br>speciﬁcation describing the data ﬁle or to omit it and let the Data Preprocessor construct it. Here<br>are some guidelines in making this decision.<br>
A format speciﬁcation is <i>required </i>when:<br>
Some data values are left blank on some data records, without having the value 0 or . (or a<br>pair of commas) to hold the place of the missing value.<br>
Some data values are adjacent on some data records; they are not separated by a space or a<br>comma.<br>
The data records span multiple physical records; that is, the character / is needed in the for-<br>mat speciﬁcation. (The Data Preprocessor may generate such a format speciﬁcation for the<br>NONMEM data set; we are speaking here of the NM-TRAN data set.)<br>
A format speciﬁcation should <i>not </i>be present when:<br>
The $INPUT record includes DROP as a data item label or synonym.<br>
Day-time translation is desired.<br>
II conversion is desired.<br>
Commas are used to separate the data items.<br>
The data values are not lined up into columns with uniform width, so that no format speciﬁ-<br>cation can be written to describe the ﬁle.<br>
Many data ﬁles do not fall in either category. A format speciﬁcation is optional for such ﬁles.<br>
<b>10.5. Skipping Data Items</b><br>
It is always possible to omit (skip) data items that are not of interest for a given NONMEM run.<br>When a format speciﬁcation is coded, two things must be done: ﬁrst, replace the data item’s spec-<br>iﬁcation by an &quot;X&quot; speciﬁcation (e.g., replace F8.0 by 8X) and second, delete the data item’s label<br>from the $INPUT record. When no format speciﬁcation is coded, all that need be done is to<br>replace the data item’s label in the $INPUT record by DROP (or include DROP as a synonym).<br>
-67-<br>
<hr>
<A name=76></a><b>Chapter 7 - $SUBROUTINE Record and $PK Record</b><br>
<b>1. What This Chapter is About</b><br>
This chapter tells how to write a $SUBROUTINE record and how to write a simple $PK record<br>for both individual and population data. This chapter is meant to be read in parallel with Chapters<br>3 and 4.<br>
<b>2. The $SUBROUTINE Record</b><br>
The $SUBROUTINE record describes which pharmacokinetic model is to be used. Recall that<br>NONMEM calls a subroutine named PRED to compute the predicted value. The user must<br>choose to use his own PRED subroutine or to use the PREDPP package. In this text it is assumed<br>that the PREDPP package is chosen.<br>
<b>2.1. Choosing an ADVAN Subroutine: Standard Pharmacokinetic Models</b><br>
The PREDPP Library includes subroutines which are pre-preprogrammed, each for a speciﬁc<br>pharmacokinetic model. They are:<br>
ADVAN1 (One Compartment Linear Model)<br>ADVAN2 (One Compartment Linear Model with First Order Absorption)<br>ADVAN3 (Two Compartment Linear Model)<br>ADVAN4 (Two Compartment Linear Model with First Order Absorption)<br>ADVAN10 (One Compartment Model with Michaelis-Menten Elimination)<br>ADVAN11 (Three Compartment Linear Model)<br>ADVAN12 (Three Compartment Linear Model with First Order Absorption)<br>
PREDPP calls only one subroutine, ADVAN; the different names above are external names distin-<br>guishing different instances of the ADVAN routine in the PREDPP Library. The name ’ADVAN’<br>is used because the routine advances (i.e. updates the state of) the kinetic system from one point<br>in time to the next. There are additional ADVAN routines in the Library which implement more<br>general types of pharmacokinetic models; see Chapter 12, Section 2.2. Each of the ADVAN’s can<br>be used for either individual or population data. The (external) name of the ADVAN to be used is<br>coded on the $SUBROUTINE record; this also implies that PREDPP is to be used. As an exam-<br>ple, the following record speciﬁes the One Compartment Linear Model:<br>
<b>$SUBROUTINE ADVAN1</b><br>
The ADVAN’s are described in Appendix 1. They share certain features.<br>
1. The compartments are numbered. These numbers are used in two places. First, they are<br>
used in the CMT and PCMT data items to describe speciﬁc compartments. Second, the<br>compartment number n is part of the name of PK parameters such as compartment scale<br>(Sn), as discussed below.<br>
2. Each model has a default observation compartment, which for each of the above ADVAN’s<br>
happens to be the central compartment. If an event record contains an observation (i.e. is an<br>observation event record), the prediction associated with that record will be the scaled drug<br>amount in this compartment, unless the CMT data item on the record speciﬁes differently.<br>The prediction associated with a non-observational event record will again be the scaled<br>drug amount in this compartment, unless the PCMT data item on the record speciﬁes differ-<br>ently.<br>
3. Each model has a default dose compartment. Unless speciﬁed differently by the CMT data<br>
item, it is understood that a dose is input into this compartment. With ADVAN1, ADVAN3,<br>and ADVAN10, this is the central compartment. With ADVAN2 and ADVAN4, a drug de-<br>
-68-<br>
<hr>
<A name=77></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
pot compartment is part of the model and is the default dose compartment. In these cases, if<br>a dose is to go directly into the central compartment, its compartment number (2) must be<br>present in the CMT data item of the dose record. Note that it is never <i>required </i>that there be<br>doses into the depot compartment. In a study involving mixed oral and IV doses, for exam-<br>ple, some patients may receive only IV doses. All dose event records for such patients will<br>have the value 2 in the CMT data item.<br>
4. Each model has an output compartment. The amount of drug in this compartment is the<br>
accumulated amount of drug eliminated from the system and typically represents the<br>amount of drug which accumulates in the urine. This compartment is special. It may not<br>receive a dose. It is initially off, and it remains off (so that the amount therein remains zero)<br>until it is explicitly turned on by an other type event record which has the output compart-<br>ment’s number in the CMT data item. It is computed by &quot;mass balance&quot;, as follows.<br>Between any two points in time, it increases by an amount equal to the amount of drug in<br>the other compartments at the ﬁrst point in time, plus the amount added via doses between<br>the two time points, less the amount remaining in the other compartments at the second<br>point in time. (This difference is multiplied by an output fraction (F0) parameter, if F0 is<br>computed by the PK routine.) The output compartment can be turned off (i.e. its amount<br>reset to zero). If the compartment is interpreted as a urine compartment, this is equivalent to<br>&quot;emptying&quot; the compartment. This is done by putting the <i>negative </i>of its number in the<br>CMT data item of an other type or observation event record.<br>
On event records, the output compartment is referred to by the compartment number given<br>in Appendix 1. A PK parameter which refers to the output compartment may use either this<br>number or 0 (zero). Thus, F0 and F2 both denote the output fraction for ADVAN1; simi-<br>larly, S0 and S4 both denote the scale for ADVAN4’s output compartment. SC denotes the<br>scale for any ADVAN’s central compartment.<br>
5. Each model has a set of basic (required) pharmacokinetic (PK) parameters, which are the<br>
microconstants used to compute the amounts of drug via the kinetic equations for the<br>model. Each one also has a set of additional (optional) PK parameters, including compart-<br>ment scales (Sn), bioavailability fractions (Fn), and output fraction (F0). Compartment<br>scales are typically used to convert amounts to concentrations, but they also can be used for<br>other purposes. Bioavailability fractions multiply dose amounts. The output fraction is<br>described above.<br>
6. Each model’s basic and additional pharmacokinetic parameters must be computed for it by a<br>
subroutine named PK. The error model must be described by a subroutine named ERROR.<br>$PK and $ERROR abbreviated code provide an easy way to specify the essential computa-<br>tions that must occur in these subroutines.<br>
<b>2.2. Choosing a TRANS Subroutine: Alternative Parameterizations</b><br>
As discussed in Chapter 3, we may prefer to use pharmacokinetic parameters in our PK routine<br>other than the microconstants used by PREDPP. Appendix 2 shows several commonly-used<br>parameterizations. The PREDPP package includes a family of subroutines called TRANS rou-<br>tines which are pre-programmed to translate (reparameterize) from these commonly used parame-<br>terizations to the ones expected by PREDPP. Appendix 2 also gives the TRANS routine for each<br>alternative parameterization. As with ADVAN, TRANS is the name of the routine. The names<br>given in Appendix 2 are instances of external subroutine names used in the PREDPP Library.<br>The ﬁrst member of the family, TRANS1, simply translates a set of microconstants into these<br>same microconstants and must be included in the NONMEM load module in lieu of the others<br>when the $PK abbreviated code computes the microconstants.<br>
-69-<br>
<hr>
<A name=78></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
The user must describe on the $SUBROUTINE record which TRANS routine is to be used. For<br>example, the following record requests the One Compartment Linear Model parameterized (in the<br>PK routine) in terms of clearance and volume.<br>
<b>$SUBROUTINE ADVAN1,TRANS2</b><br>
When a TRANS other than TRANS1 is used, only the alternative parameters listed in column 1<br>need be assigned values in the $PK abbreviated code. In this example, these are CL, V, and KA.<br>
Note that TRANS1 is the default. That is, if no TRANS routine is listed on the $SUBROUTINE<br>record, it is assumed that TRANS1 is intended. This is the case in the examples of Chapter 2.<br>Alternative parameterizations using TRANS1 are discussed later in this chapter in Section 4.2.<br>
<b>3. $PK Abbreviated Code</b><br>
$PK abbreviated code consists of a block of $PK statements, one per line, which look much like<br>FORTRAN statements. In fact, they are a subset of FORTRAN: simple assignment statements,<br>certain kinds of conditional (IF) statements, and certain kinds of CALL, WRITE, PRINT, RE-<br>TURN, OPEN, CLOSE, REWIND statements. The $PK abbreviated code must be preceded by a<br>record containing the characters &quot;$PK&quot;. This record and the abbreviated code constitute the $PK<br>record.<br>
$PK statements must include assignment statements giving a value to every basic PK parameter<br>for the given ADVAN and TRANS combination, as listed in Appendix 1 (when TRANS1 is used)<br>or column 1 of Appendix 2 (when a different TRANS is used). They may also include assign-<br>ment statements giving values to one or more of the additional PK parameters.<br>
<b>3.1. Syntax</b><br>
We assume the readers of this document are familiar with writing FORTRAN assignment and<br>conditional statements. If not, the examples in this and the following chapter should give ade-<br>quate guidance. FORTRAN statement numbers are not used, and the statements may start in any<br>column. As with all NM-TRAN records, blank lines are permitted, and all text following a semi-<br>colon (;) is ignored and may be used for comments. FORTRAN continuation lines are not per-<br>mitted.<br>
The statements are built using the following: elements of the THETA array (e.g., THETA(1));<br>constants; names of input data items appearing on the $INPUT record; names of previously-<br>assigned variables; FORTRAN library functions SQRT, LOG, LOG10, EXP, SIN, COS, ABS,<br>TAN, ASIN, ACOS, ATAN and INT. arithmetic operators +, -, *, /, **; and arithmetical and logi-<br>cal expressions using all of the above. In addition, statements may include representations for<br>random variables such as ETA(1) and EPS(3). Input data items have the values appearing on the<br>current event record, and thus these values may change from one event record to the next. A user-<br>deﬁned variable name follows the usual FORTRAN rules (1-6 letters and digits, starting with a<br>letter) and may not be subscripted. It is deﬁned (&quot;declared&quot;) by being assigned a value (i.e., by<br>appearing to the left of = in an assignment statement).<br>
Nested parentheses and nested IF statements are allowed. A pair of parentheses enclosing a sub-<br>script may be nested within another pair of parentheses. All subscripts must be constants (e.g.<br>THETA(1)). The statements are evaluated sequentially, in the order in which they appear.<br>
All variables, constants, and expressions are evaluated using ﬂoating-point (not integer) arith-<br>metic. Single or double precision function names and constants may be used interchangeably.<br>
<b>3.2. When are $PK Statements Evaluated?</b><br>
$PK statements are normally evaluated with every event record for both population and individual<br>data. This enables the amounts in the compartments to be updated from event time to event time<br>
-70-<br>
<hr>
<A name=79></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
using current values of the data items. This may be more frequent than is necessary. In the theo-<br>phylline example of Chapter 2, no data item is used in the $PK statements. In the phenobarbital<br>example, the data item used, WT, is constant within any individual’s data. In these cases, it is suf-<br>ﬁcient, and it can save noticeable amounts of run time, to evaluate the $PK statements once per<br>individual record. PREDPP can be instructed that the set of event records with which the $PK<br>statements are evaluated are to be limited in some way (see Chapter 12, Section 2.7). The CALL<br>data item can be used to force the statements to be evaluated with any event records.<br>
Certain advanced forms of dosing (additional and lagged doses; see Chapter 12, Sections 2.4 and<br>2.5) introduce doses at times which do not necessarily coincide with any event record. PREDPP<br>does not normally evaluate the $PK statements at such times, but can be instructed to do so<br>(Chapter 12, Section 2.7). Model event time parameters can be used to instruct PREDPP to eval-<br>uate the $PK statements at speciﬁed times (Chapter 12, Section Section 2.7)<br>
<b>3.3. Time Varying PK parameters</b><br>
The state of the kinetic system at a given event time is obtained using PK parameter values com-<br>puted with the data items on the event record. Using these parameter values the system is<br>advanced to the event time from the last event time. Population models sometimes use data items<br>which change value within individual records and thus give rise to PK parameters whose values<br>change within individual records. In Chapter 4, Section 3.1.6, it is pointed out that it is desirable<br>for the value of such a data item on the event record to be that value holding at the midpoint of the<br>interval between the current event time and the last previous event time, since the system is<br>advanced over this interval using the PK parameters determined with this value.<br>
If the data item changes too rapidly for this value to fairly represent the data item over the entire<br>time period, it is possible to subdivide the interval into smaller intervals. Event records with<br>EVID=2 (other type event records) can be introduced for this purpose. For example, between two<br>consecutive event records <i>r j </i>and <i>r j</i>+1, with event times <i>t j </i>and <i>t j</i>+1, one might introduce two new<br>other type event records <i>R</i>1 and <i>R</i>2, with event times <i>T</i>1 and <i>T</i>2, into the data set. The value of<br>the data item in <i>R</i>1 will be used to compute the PK parameters used to advance the system over<br>the interval <i>t j </i>to <i>T</i>1 and should be the value of the data item holding at the midpoint of this inter-<br>val. Similarly, the value of the data item in <i>R</i>2 will be used to compute the PK parameters used to<br>advance the system over the interval <i>T</i>1 to <i>T</i>2 and should be the value of the data item holding at<br>the midpoint of this interval, and so on.<br>
<b>4. $PK Statements for Individual Data</b><br>
<b>4.1. Basic and Additional Parameters</b><br>
With individual data, the parameters to be estimated are (usually) the individual’s PK parameters,<br>and therefore, elements of θ should be associated with these PK parameters. (NONMEM esti-<br>mates the elements of the θ vector.) By an individual’s PK parameters, we mean here the basic<br>PK parameters and, possibly, some additional PK parameters (e.g. a bioavailability fraction, or<br>volume of distribution when the latter is not a basic PK parameter). To illustrate, in the theo-<br>phylline example of Chapter 1 there occur these $PK statements<br>
<b>$PK</b><br>
<b>KA=THETA(1)</b><br>
<b>K=THETA(2)</b><br>
The parameters KA and K are the basic PK parameters for ADVAN2 and TRANS1 (the default<br>TRANS routine). They are used to compute the amounts in the compartments. Typically, how-<br>ev er, the observations are concentrations. A scale parameter is used to convert the amount into a<br>concentration. Thus, in the theophylline example we see two additional $PK statements:<br>
-71-<br>
<hr>
<A name=80></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
<b>V=THETA(3)</b><br>
<b>S2=V</b><br>
Here, V is a user-deﬁned variable standing for the volume of distribution of the central compart-<br>ment. It is neither a basic nor additional parameter. The parameter S2 is the scale parameter for<br>the central compartment; upon dividing the amount in that compartment by S2, the concentration<br>results. (An observation is usually predicted by an amount for a compartment divided by that<br>compartment’s scale parameter). In fact, these two statements could be replaced by the single<br>statement<br>
<b>S2=THETA(3)</b><br>
However, it may be helpful to the user to distinguish in his code between the calculation of the<br>central volume itself and the calculation of the scale parameter.<br>
There is no particular need for certain elements of θ to be associated with certain PK parameters.<br>In the above example, the roles of θ 1 and θ2 could have been reversed. NONMEM’s θ vector<br>may contain more or fewer elements than there are PK parameters, depending on how these<br>parameters are modeled.<br>
PK parameters must be explicitly modeled, usually in terms of parameters to be estimated and<br>user-deﬁned data items; the user communicates this model with the $PK statements. If a certain<br>parameter’s value is known a priori (say, S2 has the known value 500), there are several ways the<br>value can be incorporated into the $PK statements. The following examples show how it can be<br>done via a constant, via a ﬁxed element of θ , and via a (differently-named) data item:<br>
1.<br>
<b>S2=500</b><br>
2.<br>
<b>$THETA .6 9. (500 FIXED)</b><br>
<b>$PK</b><br>
<b>S2=THETA(3)</b><br>
Here, rather than be estimated, θ 3 is constrained to the value 500. This is discussed in<br>Chapter 9.<br>
3.<br>
<b>$INPUT ... VOL ..</b><br>
<b>$PK</b><br>
<b>S2=VOL</b><br>
Here, VOL is assumed to have the value 500 on the data records. When the data is from a<br>population, this third technique allows a unique value of VOL to be supplied for each indi-<br>vidual.<br>
<b>4.2. Alternative Parameterizations using $PK Statements</b><br>
It is possible to use an alternative parameterization while still using TRANS1. The reparameteri-<br>zation is performed within the $PK statements by explicitly computing the microconstants from<br>the alternative parameters. Such &quot;reparameterization&quot; statements are given in column 2 of Ap-<br>pendix 2. They must follow the assignment statements that give the alternative parameters their<br>values, as in the phenobarbital example of Chapter 2.<br>
The advantage of using $PK statements to reparameterize, rather than using a TRANS subroutine,<br>is that the NONMEM-PREDPP load module will then always consist of the same set of subrou-<br>tines for a given choice of ADVAN, which simpliﬁes the job of creating and running it. It will<br>also run slightly faster. We assume in this document that this approach is taken.<br>
Other parameterizations are possible besides the ones in Appendix 2. For example, with<br>ADVAN1 and TRANS1, one might code:<br>
<b>CL=THETA(1)</b><br>
<b>K=THETA(2)</b><br>
<b>V=CL/K</b><br>
-72-<br>
<hr>
<A name=81></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
<b>S1=V</b><br>
The ability to express a large variety of modeling possibilities with NONMEM-PREDPP provides<br>great freedom and ﬂexibility, but as always with ﬂexible modeling capability, certain pitfalls arise.<br>Suppose, for example, that with a one compartment system the compartment amount, rather than<br>the concentration is observed. With ADVAN1 and TRANS1 the statements<br>
<b>CL=THETA(1)</b><br>
<b>V=THETA(2)</b><br>
<b>K=CL/V</b><br>
will lead to difﬁculty because only the ratio of θ 1 to θ2 affects the amount in the compartment,<br>and therefore, the data do not allow θ 1 and θ2 to be separately estimated. The statements should<br>read:<br>
<b>K=THETA(1)</b><br>
It is important to remember that only those elements of θ which affect the predictions of observa-<br>tions will be estimated by NONMEM. Here is some problematic code using ADVAN1 with<br>TRANS1:<br>
<b>K=THETA(1)</b><br>
<b>V=THETA(2)</b><br>
<b>CL=THETA(3)</b><br>
<b>S1=V</b><br>
Once again, NONMEM will be unable to produce separate estimates of all elements of θ . The<br>kinetics of a simple one compartment system cannot be determined by three independent parame-<br>ters. With TRANS1, PREDPP itself does not &quot;know&quot; about the relationship K=CL/V which<br>deﬁnes a dependency among the parameters. Indeed, the parameters CL and V are both regarded<br>as user-deﬁned variables. The value of θ 3 has no effect on the prediction. Were it not for the fact<br>that S1 is set equal to V, the value of θ 2 would have no effect on the prediction either. With<br>TRANS2 this code is also incorrect for essentially the same reason. Here, K is regarded as a<br>user-deﬁned variable, and the relationship CL=K*V is not &quot;known&quot; to PREDPP. (PREDPP does<br>know that CL/V is the rate constant of elimination, but it does not recognize the variable K as<br>denoting this rate constant, and θ 1 has no effect on the prediction.)<br>
<b>4.3. Scale Parameters</b><br>
Scale parameters are mentioned in Section 2.1. Predicted compartment amounts are divided by<br>them and are thus converted to predicted concentrations. They are only needed for those com-<br>partments whose concentrations are directly observed. With ADVAN3, for example, the periph-<br>eral compartment’s scale S2 does need to be computed explicitly if there are no observation<br>ev ents giving measured values of concentrations in the peripheral compartment. Predicted values<br>for this compartment may still be plotted against time, for example, but these values need not be<br>scaled drug amounts; the (unscaled) amount alone is sufﬁcient to show the shape of the curve.<br>(The various volume parameters shown in Appendix 2 must be modeled when they are used as<br>basic parameters, but they need not be assigned as values to compartment scale parameters.) Any<br>scale parameter which is not modeled by $PK statements is assumed to be 1 (i.e., predicted values<br>are always amounts).<br>
<b>4.3.1. Scaling by a Known Constant</b><br>
In Chapter 3, Section 2.2.1, the units of V were changed from kiloliters to liters using the model:<br>
<i>S </i>= <i>V </i>/1000<br>
This can be coded in a $PK statement similar to the way it appears here, except that the compart-<br>ment number must be speciﬁed:<br>
-73-<br>
<hr>
<A name=82></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
<b>S1=V/1000</b><br>
Basic PK parameters may also be rescaled in this manner.<br>
<b>4.3.2. Scaling by a Parameter: Conditional Statements and Indicator Variables</b><br>
In Chapter 3, Section 2.2.2, the following model appeared:<br>
<i>V</i>,<br>
if <i>assay is </i>1<br>
<i>S </i>= <i>hV</i>, if <i>assay is </i>2<br>
There are two ways this can be coded in $PK statements. The <i>assay </i>data item can be tested<br>directly, or an indicator variable can be used. An indicator variable is a variable whose value is 0<br>or 1. It may be identiﬁed with an input data item, or it may be a user-deﬁned variable in the $PK<br>statements. For example, suppose variable ASY is to be used as an indicator variable. If some<br>input data item is given value 1 when assay 1 was used and value 0 when assay 2 was used, then<br>this data item could simply be named ASY on the $INPUT record. Suppose, however, that the<br>assay number itself (1 or 2) was recorded in the data and that we have named the data item<br>ANUM on the $INPUT record. We must compute the user-deﬁned variable ASY for use as an<br>indicator variable. There are two ways this can be done: using a logical IF and using a block IF.<br>
1.<br>
<b>ASY=1</b><br>
<b>IF (ANUM.EQ.2) ASY=0</b><br>
Here, ASY is &quot;provisionally&quot; given the value 1. The value is changed to 0 if the data indi-<br>cates assay 2.<br>
2.<br>
<b>IF (ANUM.EQ.1) THEN</b><br>
<b>ASY=1</b><br>
<b>ELSE</b><br>
<b>ASY=0</b><br>
<b>ENDIF</b><br>
The choice between these forms of IF is purely a matter of style. Now let us assume that the<br>compartment to be scaled is compartment 2, and that <i>h </i>is to be identiﬁed with θ 5. The parameter<br>S2 can now be coded unconditionally:<br>
<b>S2=ASY*V+(1-ASY)*THETA(5)*V</b><br>
Alternatively, ANUM can be tested and ASY avoided altogether:<br>
1.<br>
<b>S2=V</b><br>
<b>IF (ANUM.EQ.2) S2=THETA(5)*V</b><br>
2.<br>
<b>IF (ANUM.EQ.1) THEN</b><br>
<b>S2=V</b><br>
<b>ELSE</b><br>
<b>S2=THETA(5)*V</b><br>
<b>ENDIF</b><br>
<b>4.3.3. Scaling by a Data Item</b><br>
If observations of urine concentration <i>Cu </i>are included in the data (see e.g. Chapter 6, Section 9),<br>it is necessary to provide urine volume as a scale for the output compartment. Presumably, this<br>volume varies between urine observations and is recorded in the data records. Suppose this data<br>item is called UVOL in the $INPUT record. (The name given to the data item has no special sig-<br>niﬁcance; any name could be chosen.) An additional $PK statement is necessary:<br>
<b>S0=UVOL</b><br>
UVOL need be recorded on only those observation events to which it applies, although it does no<br>harm to record it on other event records. For example, it may well happen that both plasma and<br>
-74-<br>
<hr>
<A name=83></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
urine responses are measured at the same time, so that there are two observation event records<br>with the same value of TIME, one for each compartment observed at that time. As described in<br>Section 3.2 above, $PK statements are normally evaluated with every event record. Consider, for<br>example, the sample data below. Assume that the Central compartment is compartment 2 and the<br>output compartment is compartment 3. (Note the use of -3 to signify that compartment 3 is to be<br>turned off after the observation time. The compartment will remain off until the time another<br>urine collection begins, as indicated with an other type record; see Chapter 6, Section 7.4). Either<br>1. or 2. will produce the correct value of S0:<br>
1. Record UVOL on the event record to which it applies. The order of the records does not<br>
matter.<br>
<b>TIME UVOL DV</b><br>
<b>CMT</b><br>
<b>10. 0</b><br>
<b>5.80 2</b><br>
<b>10. 100 .067</b><br>
<b>-3</b><br>
2. Record UVOL on all event records having the same value of TIME. The order of the<br>
records does not matter.<br>
<b>TIME UVOL DV</b><br>
<b>CMT</b><br>
<b>10. 100 5.80</b><br>
<b>2</b><br>
<b>10. 100 .067</b><br>
<b>-3</b><br>
The following will not produce the correct value of S0 unless PREDPP is instructed to evaluate<br>the $PK statements only once for each distinct value of TIME:<br>
<b>TIME UVOL DV</b><br>
<b>CMT</b><br>
<b>10. 100 5.80</b><br>
<b>2</b><br>
<b>10. 0</b><br>
<b>.067 -3</b><br>
<b>4.4. Bioavailability Fraction Parameters</b><br>
PK parameters of the form Fn, where n is the number of a compartment into which a dose may be<br>introduced, are bioavailability fractions. If a dose record speciﬁes a dose for compartment n, the<br>dose amount given on the event record is multiplied by the value of Fn computed from the $PK<br>statements evaluated with this record, and this product is the dose amount introduced into the sys-<br>tem. For example, F1 multiplies the amount of dose which is to be added to compartment 1. Any<br>Fn which is not computed by $PK statements is assumed to be 1 (i.e., the dose is 100% available).<br>
As an example, suppose two different preparations of the same drug are administered, and it is<br>assumed that they differ only in their bioavailability. The indicator variable (or data item) PREP<br>has value 1 for the ﬁrst preparation and 0 for the second. The ratio of the bioavailability of the<br>second preparation to that of the ﬁrst preparation is identiﬁed with θ 6. Usually, the method of<br>drug administration permits this ratio to be estimated, but not the separate bioavailabilities. With-<br>out loss of generality, the bioavailability of the ﬁrst preparation can be taken to be 1. Assuming<br>the drug enters compartment 1 of the model, there are three ways this can be coded:<br>
1.<br>
<b>F1=PREP+(1-PREP)*THETA(6)</b><br>
2.<br>
<b>F1=1</b><br>
<b>IF (PREP.EQ.0) F1=THETA(6)</b><br>
3.<br>
<b>IF (PREP.EQ.0) THEN</b><br>
<b>F1=THETA(6)</b><br>
<b>ELSE</b><br>
<b>F1=1</b><br>
<b>ENDIF</b><br>
-75-<br>
<hr>
<A name=84></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
Again, the choice is a matter of style.<br>
Once a dose is introduced into the dose compartment, it begins to distribute into the other com-<br>partments. Whether or not the original dose was 100% available, it is assumed that none of the<br>dose appearing in the dose compartment, and in other compartments after the dose is introduced,<br>is further reduced due to bioavailability effects. PREDPP cannot model &quot;bioavailability effects&quot;<br>between compartments.<br>
<b>4.5. Output Fraction</b><br>
The Output Fraction parameter, F0, is an optional additional PK parameter of every model. As<br>discussed in Section 2 above, every model contains an output compartment. If this compartment<br>has been turned on prior to the advance from time <i>t j</i>−1 to time <i>t j</i>, then the amount of drug lost<br>from the system during this interval via elimination is multiplied by F0 and added to the prior<br>contents of the output compartment. If the $PK statements do not include an assignment state-<br>ment giving a value to F0, it is taken to be 1 (i.e., 100% of the drug excreted goes to the output<br>compartment). In model (4.7), an example of the use of F0 is given. Assuming that the variables<br>CLREN (renal clearance) and CL (total clearance) have been calculated with earlier $PK state-<br>ments, the statement<br>
<b>F0=CLREN/CL</b><br>
can be used to compute F0.<br>
<b>5. $PK Statements for Population Data</b><br>
With population data, the structural models for the PK parameters tend to be more complicated<br>than with individual data. In addition, the inﬂuence of interindividual random effects needs to be<br>described. These will involve differences in the $PK statements, but the same $SUBROUTINE<br>record and the same ADVAN and TRANS subroutines are used, and the same general require-<br>ments and examples of the earlier sections of this chapter still mostly apply. In this section, the<br>models of Chapter 4 are implemented via $PK statements. Many of these models could be imple-<br>mented in a variety of ways; an experienced programmer may prefer to code them differently.<br>
With population data, we must distinguish between the typical value of a PK parameter in the<br>population and the value of that parameter for a given individual, the individual’s value. The typi-<br>cal value is computed by a structural model involving only ﬁxed effects. We hav e chosen to<br>denote it with the use of a tilde: e.g. <i>˜</i><br>
<i>Cl</i>. The individual’s value is computed by a model including<br>
random interindividual effects (represented by random variables) and is denoted without a tilde:<br>e.g., <i>Cl</i>. There is no tilde character in the FORTRAN character set, and with NM-TRAN we do<br>not need to distinguish typical and individual values. However, for purposes of clarity, in all the<br>examples which follow we will include the letters TV (Typical Value) at the start of those variable<br>names which we think of as having a tilde (e.g., TVCL). This is a matter of style.<br>
<b>5.1. Structural Part of Parameter Models</b><br>
In models such as (4.3), the subscript <i>i </i>indicates that the model applies to the <i>ith </i>individual. As<br>noted in Chapter 4, the subscript is not needed and, indeed, is not used in $PK statements.<br>
<b>5.1.1. Linear Models</b><br>
Models (4.4), (4.5a), (4.5b) and (4.6) can be coded as they appear. Assuming that WT, AGE, and<br>SECR are input data items or have been calculated with earlier $PK statements, the code is:<br>
<b>TVCLM=THETA(1)*WT</b><br>
<b>RF=WT*(1.66-.011*AGE)/SECR</b><br>
<b>TVCLR=THETA(4)*RF</b><br>
<b>TVCL=TVCLM+TVCLR</b><br>
-76-<br>
<hr>
<A name=85></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
<b>5.1.2. Multiplicative Models</b><br>
Model (4.4.1) can be coded as follows:<br>
<b>TVLCLM=THETA(1)+THETA(2)*LOG(WT)</b><br>
<b>TVCLM=EXP(TVLCLM)</b><br>
Model (4.4.2) can also be coded as it appears:<br>
<b>TVCLM=THETA(1)*WT**THETA(2)</b><br>
<b>5.1.3. Saturation Models</b><br>
Model (4.4.3) presents a problem. Subscripted variables that can appear in $PK statements are<br>few; naturally, they include THETA and (as seen below) ETA. The variable CPSS cannot be sub-<br>scripted, and a variable name such as CPSS2 (rather than CPSS(2)) must be used for <i>Cpss</i>2. The<br>model can be coded exactly as it appears:<br>
<b>TVCLM=WT*(THETA(1)-THETA(2)*CPSS2/(THETA(3)+CPSS2))</b><br>
<b>5.1.4. Models with Indicator Variables</b><br>
When dealing with typical values, indicator variables (0/1 variables) can be used interchangeably<br>with conditional (IF) statements, as we have already seen. Model (4.4.4) can be coded in a vari-<br>ety of ways, two of which are:<br>
1.<br>
<b>TVCLM=(THETA(1)-THETA(2)*HF)*WT</b><br>
2.<br>
<b>IF (HF.EQ.0) THEN</b><br>
<b>TVCLM=THETA(1)*WT</b><br>
<b>ELSE</b><br>
<b>TVCLM=(THETA(1)-THETA(2))*WT</b><br>
<b>ENDIF</b><br>
<b>5.2. Population Random Effect Models</b><br>
Random variables η are used in the models for interindividual errors. (With population models,<br>random variables ε are used in the models for intraindividual errors; see Chapter 4, Section 2.) In<br>$PK statements they are denoted by ETA(1), ETA(2), etc. Even if there is only once such vari-<br>able it must still be subscripted. It is the presence of one or more such variables that indicates to<br>NM-TRAN that the data is from a population. Just as there is no particular need for certain θ ele-<br>ments to be identiﬁed with certain PK parameters, there is no particular need for certain θ ele-<br>ments to be associated with certain η variables, and any association need not be one-to-one. The<br>following models are both valid:<br>
1.<br>
<b>CL=THETA(1)+ETA(1)</b><br>
<b>V=THETA(2)+ETA(2)</b><br>
2.<br>
<b>CL=THETA(1)+ETA(2)</b><br>
<b>V=THETA(2)+ETA(1)</b><br>
However, it will be easier to keep things straight if the ﬁrst model is used.<br>
Here are three different ways of coding a model for an individual’s value of clearance:<br>
1.<br>
<b>TVCL=THETA(1)</b><br>
<b>CL=TVCL+ETA(1)</b><br>
2.<br>
<b>CL=THETA(1)</b><br>
<b>CL=CL+ETA(1)</b><br>
3.<br>
<b>CL=THETA(1)+ETA(1)</b><br>
-77-<br>
<hr>
<A name=86></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
We prefer the ﬁrst way because it clearly distinguishes the model for the typical value from the<br>model for the individual’s value. With any of the three ways for coding the model the typical<br>value of the parameter can be computed as follows: The η variables are set to 0, and the parame-<br>ter is computed. Any variable whose value depends on η variables is called a random variable.<br>
Random variables are called true-value variables in the ﬁrst edition of this guide. This is because,<br>in principle, a random variable can assume an individual’s true value under the model. Such a<br>variable is in contrast to a variable which assumes only a typical value for the population.<br>
An individual’s true value is never actually known, although an estimate of it can be obtained.<br>See Chapter 12, Sections 4.11-4.13.<br>
<b>5.3. Models for Interindividual Errors</b><br>
Here we show how to express the most commonly used models for interindividual errors with<br>$PK statements. In addition, all the error models described in Chapter 8 may also be used in $PK<br>statements.<br>
<b>5.3.1. Additive/Multiplicative Models</b><br>
This is the error model of (4.9):<br>
<b>K=TVK+ETA(1)</b><br>
This is the error model of (4.10):<br>
<b>K=TVK*(1+ETA(1))</b><br>
This model can also be coded as:<br>
<b>K=TVK+TVK*ETA(1)</b><br>
Here, the variable TVK has been &quot;multiplied through&quot;. The choice is a matter of style.<br>
<b>5.3.2. Other Models</b><br>
The model (4.11) may be coded as written.<br>
<b>CLM=TVCLM+(1-ICU)*ETA(1)+ICU*ETA(2)</b><br>
It may also be coded with an IF statement.<br>
<b>IF (ICU.EQ.0) THEN</b><br>
<b>CLM=TVCLM+ETA(1)</b><br>
<b>ELSE</b><br>
<b>CLM=TVCLM+ETA(2)</b><br>
<b>ENDIF</b><br>
The choice is a matter of style.<br>
Note that, under the parameterizations given in Appendices 1 and 2, CLM is neither a basic nor<br>an additional PK parameter, yet its model involves an η variable. This is legitimate: any variable<br>can be deﬁned in terms of an η variable. However, just as with θ ’s, the values assigned to the η<br>variables must somehow affect the predictions of observations. Otherwise, the variance of some<br>
η variable cannot be estimated, and consequently, none of the variances of these variables can be<br>
estimated. Presumably, within the $PK statements, CLM is used to compute CL, and (either<br>within the $PK statements or within the TRANS routine) CL is used to compute K.<br>
<b>5.4. Restrictions on Random Variables</b><br>
This section discusses the use of random variables in some depth and may be skipped by the<br>casual reader. The remarks here apply to all random variables: both the ETA variables of this<br>chapter and the ERR/EPS variables of Chapter 8.<br>
In general, ETA variables can be used like any other variables.<br>
-78-<br>
<hr>
<A name=87></a>Chapter 7 - $SUBROUTINE Record and $PK Record<br>
Any variable whose value is affected by an ETA variable is a random variable, whether the ETA<br>variable occurs explicitly in the deﬁning expression for the random variable or whether another<br>random variable occurs in this expression. For example, consider the following:<br>
<b>TVCLM=THETA(2)*WT</b><br>
<b>CLM=TVCLM+ETA(2)</b><br>
<b>RF=WT*(1.66-.011*AGE)/SECR</b><br>
<b>TVCLR=THETA(4)*RF</b><br>
<b>CLR=TVCLR+ETA(1)</b><br>
<b>CL=CLM+CLR</b><br>
CL is a random variable, because it is computed from random variables. It depends on both η1<br>and η2.<br>Random variables may be changed and may be assigned conditionally, subject to the following<br>restrictions.<br>
A random variable may not appear anywhere within a nested if structure.<br>
A random variable deﬁned in the $PK block may not be redeﬁned in the $ERROR block.<br>
As an example of the ﬁrst restriction, suppose in the model (4.11) it is also believed that, for ICU<br>patients, age affects CLM. The following code expresses the model, but is not permitted:<br>
<b>IF (ICU.EQ.1) THEN</b><br>
<b>IF (AGE.GE.50) THEN</b><br>
<b>TVCLM=THETA(1)</b><br>
<b>ELSE</b><br>
<b>TVCLM=THETA(2)</b><br>
<b>ENDIF</b><br>
<b>CLM=TVCLM+ETA(1)</b><br>
<b>ELSE</b><br>
<b>TVCLM=THETA(3)</b><br>
<b>CLM=TVCLM+ETA(2)</b><br>
<b>ENDIF</b><br>
An alternate code follows, in which the calculation of TVCLM (which involves a nested IF) pre-<br>cedes the calculation of CLM (which does not require a nested IF). This code is permitted.<br>
<b>IF (ICU.EQ.1) THEN</b><br>
<b>IF (AGE.GT.50) THEN</b><br>
<b>TVCL=THETA(1)</b><br>
<b>ELSE</b><br>
<b>TVCL=THETA(2)</b><br>
<b>ENDIF</b><br>
<b>ELSE</b><br>
<b>TVCL=THETA(3)</b><br>
<b>ENDIF</b><br>
<b>IF (ICU.EQ.1) THEN</b><br>
<b>CL=TVCL+ETA(1)</b><br>
<b>ELSE</b><br>
<b>CL=TVCL+ETA(2)</b><br>
<b>ENDIF</b><br>
Indentations are used in the above code for clarity, but have no affect on NM-TRAN’s processing<br>of the abbreviated code.<br>
-79-<br>
<hr>
<A name=88></a><b>Chapter 8 - $ERROR Record</b><br>
<b>1. What This Chapter is About</b><br>
This chapter tells how to write a simple $ERROR record for PREDPP. This chapter is meant to<br>be read in parallel with Chapters 3 and 4.<br>
<b>2. $ERROR Abbreviated Code</b><br>
$ERROR abbreviated code consists of a block of $ERROR statements, one per line. The $ER-<br>ROR abbreviated code must be preceded by a record containing the characters &quot;$ERROR&quot;. This<br>record and the abbreviated code constitute the $ERROR record.<br>
$ERROR statements describe the error model for PREDPP. These statements are very similar for<br>individual data and for population data. In fact, by making use of variables called ERR variables,<br>the $ERROR statements are identical for both kinds of data.<br>
<b>2.1. Syntax</b><br>
The syntax of a $ERROR record is very similar to that of a $PK record. Certain differences will<br>be mentioned here.<br>
There must be an assignment statement giving a value to a special (reserved) variable Y. Y is a<br>random variable representing the random variable y (the modeled observation). Y is usually<br>deﬁned in terms of a special (reserved) variable F, which represents the prediction for Y. When<br>the data are from a population, F is a random variable. With individual data, ETA variables may<br>be used in the deﬁnition of Y. With population data, EPS variables may be used in the deﬁnition<br>of Y. There are also special random variables called ERR variables. The variable ERR(I) is the<br>same as ETA(I) or EPS(I), depending on whether the data are individual or population, respec-<br>tively. For the purpose of giving a general discussion, applying equally to both individual and<br>population data, ERR will be used in all the examples in this chapter. (It is also useful to use<br>ERR in $ERROR statements as a practical matter. Sometimes the same data is analyzed from<br>both the population and the individual point of view. By using ERR variables, changes to the NM-<br>TRAN input ﬁle are minimized.) An ERR variable (as with ETA and EPS variables) must always<br>include a subscript (e.g., ERR(1)), even when there is only one such variable in the model.<br>
Variables computed within $PK statements may be used in $ERROR statements, but not vice<br>versa.<br>
<b>2.2. When are $ERROR Statements Evaluated?</b><br>
$ERROR statements are normally evaluated with every event record. This may be more frequent<br>than is necessary. PREDPP can be instructed that the set of event records with which the<br>$ERROR statements are evaluated is to be limited to only observation events, once per individual<br>record, or once per problem. Such limitation does not apply to the Simulation Step (Chapter 12,<br>Section 4.8). With the additive (3.4) and constant coefﬁcient of variation (3.5) error models, and<br>with the exponential error model, NM-TRAN instructs PREDPP to evaluate the $ERROR state-<br>ments only once per problem. Again, the CALL data item can be used to force evaluation of the<br>$ERROR statements with any event records.<br>
<b>3. Error Models</b><br>
The following sections show how the error models of Chapter 3 are expressed using $ERROR<br>statements.<br>
-80-<br>
<hr>
<A name=89></a>Chapter 8 - $ERROR Record<br>
<b>3.1. The Additive Error Model</b><br>
This is the error model (3.4):<br>
<b>Y=F+ERR(1)</b><br>
Both examples in Chapter 2 use this error model.<br>
<b>3.2. The Constant Coefﬁcient of Variation and Exponential Models</b><br>
This is the CCV error model (3.5):<br>
<b>Y=F*(1+ERR(1))</b><br>
This error model can also be coded as:<br>
<b>Y=F+F*ERR(1)</b><br>
Here, the variable F has been &quot;multiplied through&quot;. The choice is a matter of style.<br>
This is the exponential error model (3.5a):<br>
<b>Y=F*EXP(ERR(1))</b><br>
When the $ERROR statements consist solely of one of these statements (in any of the forms), the<br>output from PREDPP will include the message:<br>
<b>ERROR IN LOG Y IS MODELED</b><br>
This is done because during data analysis NONMEM cannot distinguish between the CCV error<br>model <i>y </i>= <i>˜f </i>+ <i>˜f</i>ε and the exponential error model <i>y </i>= <i>˜f </i>exp(ε ), for which log(<i>y</i>) = log( <i>˜f</i>) + ε †.<br>By using the latter model and modelling the error in log(<i>y</i>) rather than in <i>y</i>, NM-TRAN enables<br>PREDPP to achieve an improvement in run time.<br>
<b>3.3. Combined Additive and CCV Error Model</b><br>
This is the error model (3.6):<br>
<b>Y=F+F*ERR(1)+ERR(2)</b><br>
<b>3.4. The Po wer Model</b><br>
This is the error model (3.7):<br>
<b>Y=F+F**P*ERR(1)</b><br>
The variable P must be assigned a value before its use above. P is typically identiﬁed with an ele-<br>ment of θ so that it can be estimated in the ﬁtting process. Let us assume that θ 4 is chosen for this<br>purpose. Then an alternative coding is:<br>
<b>Y=F+F**THETA(4)*ERR(1)</b><br>
<b>3.5. Two Different Types of Measurements</b><br>
We hav e already seen how an indicator variable, e.g., ASY, can be used in $PK statements for a<br>variety of purposes. The same technique is used in $ERROR statements. Consider model (3.8)<br>where the variable ASY has the value 1 or 0, corresponding to assay 1 or assay 2. ASY is a data<br>record item. Then the error model (3.8) is coded:<br>
<b>Y=F+ASY*ERR(1)+(1-ASY)*ERR(2)</b><br>
This model can also be coded in several ways, the choice of which is a matter of style.<br>
1)<br>
<b>IF (ASY.EQ.1) THEN</b><br>
<b>Y=F+ERR(1)</b><br>
<b>ELSE</b><br>
<b>Y=F+ERR(2)</b><br>
<b>ENDIF</b><br>
† During Simulation, NONMEM does distinguish between the CCV and exponential error models.<br>
-81-<br>
<hr>
<A name=90></a>Chapter 8 - $ERROR Record<br>
2)<br>
<b>IF (ASY.EQ.1) Y=F+ERR(1)</b><br>
<b>IF (ASY.NE.1) Y=F+ERR(2)</b><br>
3)<br>
<b>Y=F+ERR(2)</b><br>
<b>IF (ASY.EQ.1) Y=F+ERR(1)</b><br>
<b>3.6. Two Different Types of Observations</b><br>
In Chapter 3, Section 3.6, an example is given in which there are two kinds of observations,<br>plasma (<i>C</i>) and urine (<i>Cu</i>). With PREDPP, measurements from different compartments of the<br>model are recorded in the DV data item of different observation event records. The CMT data<br>item identiﬁes the compartment from which the prediction associated with the event record is to<br>be obtained. When the $ERROR statements are evaluated for a given event record, the variable F<br>contains the prediction from the compartment speciﬁed for that event record. All that need be<br>done is to select the correct error model, depending on the compartment. Suppose, for example,<br>that ADVAN2 is used, so that the central compartment is compartment 2 and the output (urine)<br>compartment is compartment 3. Then the error model (3.10) can be coded:<br>
<b>TYP=0</b><br>
<b>IF (CMT.EQ.2) TYP=1</b><br>
<b>Y=F+TYP*ERR(1)+(1-TYP)*ERR(2)</b><br>
This model can also be coded in several ways, one of which is shown here:<br>
<b>IF (CMT.EQ.2) THEN</b><br>
<b>Y=F+ERR(1)</b><br>
<b>ELSE</b><br>
<b>Y=F+ERR(2)</b><br>
<b>ENDIF</b><br>
<b>3.7. More than One Indicator Variable</b><br>
In Chapter 3, Section 3.7, an example is given in which there are three kinds of observations.<br>Suppose that there are two data items, ASY1 and ASY2. ASY1 is 1 if assay 1 is used and 0 oth-<br>erwise. ASY2 is 1 if assay 2 is used and 0 otherwise. This is the error model (3.11):<br>
<b>Y=F+ASY1*ERR(1)+ASY2*ERR(2)+(1-ASY1)*(1-ASY2)*ERR(3)</b><br>
This model can also be coded in several ways, one of which is shown here:<br>
<b>Y=F+ERR(3)</b><br>
<b>IF (ASY1.EQ.1) Y=F+ERR(1)</b><br>
<b>IF (ASY2.EQ.1) Y=F+ERR(2)</b><br>
-82-<br>
<hr>
<A name=91></a><b>Chapter 9 - Additional NM-TRAN Records</b><br>
<b>1. What This Chapter is About</b><br>
This chapter tells how to giv e initial estimates to NONMEM’s parameters ($THETA, $OMEGA,<br>$SIGMA records); how to tell NONMEM what tasks to perform ($ESTIMATION, $COVARI-<br>ANCE records); and how to tell NONMEM what additional output to produce ($TABLE, $SCAT-<br>TERPLOT records).<br>
<b>2. Providing Initial Estimates For </b>θ <b>: The $THETA Record</b><br>
This record provides an initial estimate (and, optionally, provides lower and upper bounds) for<br>ev ery element of NONMEM’s θ vector.<br>
<b>2.1. Providing Initial Estimates For Elements Of </b>θ<br>
The $THETA record contains a list of values, separated by spaces or commas, which are the ini-<br>tial estimates for the θ ’s used in the $PK and $ERROR statements. The position of a value in the<br>list corresponds to its position (subscript) in the θ vector. For example, consider the following<br>statement:<br>
<b>$THETA 1.7 .102 29.</b><br>
This says that the initial estimate for θ 1 is 1.7, the initial estimate for θ2 is .102, and the initial<br>estimate for θ 3 is 29. Some users of NONMEM prefer to code each value on a separate line so<br>that they can include comments to themselves describing the signiﬁcance of the θ ’s. The above<br>record could have been coded as follows:<br>
<b>$THETA 1.7 ; RATE CONSTANT OF ABSORPTION</b><br>
<b>.102 ;</b><br>
<b>RATE CONSTANT OF ELIMINATION</b><br>
<b>19. ; VOLUME OF DISTRIBUTION</b><br>
This is a matter of style.<br>
<b>2.2. Providing Constraints for Elements of </b>θ<br>
When NONMEM is told to estimate the parameters (Section 4.1, the Estimation Step, below), it<br>varies the elements of θ to ﬁnd values which cause the model to ﬁt the observations best. The<br>values on the $THETA record are the initial estimates of θ for this search. When only an initial<br>estimate is provided, NONMEM is free to chose any positive or neg ative value for that element of<br>
θ . We then say that the θ element is <i>unconstrained</i>, which means that its lower bound (lower<br>
limit) is −∞ and its upper bound (upper limit) is +∞. When ﬁnite bounds are desired, the initial<br>
estimate and its bounds must be enclosed in parentheses and speciﬁed in the order (lower, initial,<br>upper). When the upper bound needn’t be ﬁnite, the initial estimate and its lower bound are<br>enclosed in parentheses and speciﬁed in the order (lower, initial). Note that when no estimation is<br>performed, upper and lower bounds have no effect.<br>
In the theophylline example of Chapter 2, for example, negative θ values are physiologically<br>impossible. Each θ element was given a lower bound of 0, which constrained it to be non-nega-<br>tive:<br>
<b>$THETA (0, 1.7) (0, .102) (0, 29.)</b><br>
It is possible to mix constrained and unconstrained θ s; this was done in Chapter 2, ﬁgure 2.12:<br>
<b>$THETA (0,.0027) (0,.70) .0018</b><br>
<b>.5</b><br>
An upper bound of +∞ may be stated explicitly using the value 1000000 or the word INFIN-<br>ITY. Similarly, a lower bound of −∞ may be stated explicitly as -1000000 or -INFINITY.<br>
-83-<br>
<hr>
<A name=92></a>Chapter 9 - Additional NM-TRAN Records<br>
<b>2.3. Fixing Elements of </b>θ<br>
When estimation is performed, it is sometimes desirable to hold one or more elements of θ to a<br>constant value. One example is when a full model is reduced to a simpler model, as discussed in<br>Chapter 5, Section 2.1; usually this is done by holding some θ element to 0. In fact, the value 0<br>may not be used as an initial estimate for an element of θ unless this element is ﬁxed to this value.<br>A θ element is held constant by inserting the word FIXED <i>after </i>the initial estimate. For example,<br>the following statement allows θ 1 and θ3 to vary, but holds θ2 to the value .102:<br>
<b>$THETA 1.7 .102 FIXED</b><br>
<b>29.</b><br>
Parentheses may be used to make the statement easier to read:<br>
<b>$THETA 1.7 (.102 FIXED) 29.</b><br>
If the lower, initial, and upper values for an element of θ are identical, the element of θ is under-<br>stood to be ﬁxed, even if the word FIXED does not appear.<br>
<b>2.4. How to Obtain Initial Estimates for </b>θ<br>
When estimating parameters, good initial estimates for θ are sometimes important. Poor initial<br>estimates may occasionally cause the NONMEM run to take excessive amounts of computer time,<br>to produce parameter estimates that are not physiologically reasonable, or to fail to produce any<br>parameter estimates at all. For some drugs and models, initial estimates for θ can be obtained<br>from published literature describing prior studies with the drug. For some studies, very accurate<br>values may have been obtained by prior runs with NONMEM or other regression programs.<br>Highly accurate values should be perturbed (modiﬁed) by about 10% before being used as initial<br>estimates in a NONMEM run. (Initial estimates that are too close to what may be the actual ﬁnal<br>estimates will cause problems in a NONMEM run; see Chapter 13.) Sometimes, however, there<br>is little guidance in choosing initial estimates for some elements of θ .<br>
One approach with population data, where there is a reasonable amount of data for each individ-<br>ual, is as follows. It is often easier to guess at appropriate parameter values for individual data<br>than for population data. So, ﬁrst estimate each individual’s parameter values using only the data<br>from the individual. The mean values of the individuals’ parameter estimates can then be used as<br>the initial parameter estimates in the population analysis. Results from individual runs can also<br>be used to obtain initial estimates for elements of Ω and Σ; see below.<br>
Another approach is simply to let NONMEM ﬁnd an initial estimate. NONMEM has an auto-<br>matic strategy for so doing; see Chapter 12, Section 4.4.<br>
<b>3. Providing Initial Estimates for </b>Ω <b>and </b>Σ<b>: the $OMEGA and $SIGMA Records</b><br>
Recall that Ω and Σ are variance/covariance matrices for the following random variables:<br>
Individual Model<br>
Ω (OMEGA) for η (Random Intraindividual Variability)<br>
Population Model<br>
Ω (OMEGA) for η (Random Interindividual Variability)<br>
Σ (SIGMA) for ε (Random Intraindividual Variability)<br>
In all the examples in this document, Ω and Σ are <i>diagonal </i>matrices, in which covariance ele-<br>ments such as ω<br>
η<br>
12 (which is <i>cov</i>(η 1, 2)) are assumed to be zero. NONMEM also allows full vari-<br>
ance/covariance matrices; this is beyond the scope of this text, but see Chapter 12, Section 4.1.<br>
Initial estimates for the variances must be provided to NONMEM via the $OMEGA and<br>$SIGMA records. Initial estimates of <i>all model parameters </i>(θ , Ω, and Σ) must be provided even<br>if estimation is not requested. $OMEGA and $SIGMA records each contain a list of values, sepa-<br>rated by spaces or commas, which are the estimates for the corresponding variances. As in the<br>$THETA record, the position of a value in the list corresponds to the position (subscript) of the<br>
-84-<br>
<hr>
<A name=93></a>Chapter 9 - Additional NM-TRAN Records<br>
corresponding variance (along the diagonal) in the matrix.<br>
<b>3.1. $OMEGA Record With Individual Data</b><br>
With individual data, η variables are used in $ERROR records, where they are called either ERR<br>or ETA. For example, in the theophylline problem of Chapter 2 (ﬁgure 2.1) there appear the<br>records:<br>
<b>$ERROR</b><br>
<b>Y=F+ERR(1)</b><br>
<b>$OMEGA 1.2</b><br>
Here, ERR(1) corresponds to η1, and the initial estimate for its variance is 1.2: i.e.,<br>
Ω = ω2 =<br>
11<br>
1<br>
<i>var</i>(η1) = 1. 2.<br>
<b>3.2. $OMEGA Record With Population Data</b><br>
With population data, η variables are used in $PK statements. For example, in the phenobarbital<br>problem of Chapter 2 (ﬁgure 2.6) there appear the lines:<br>
<b>CL=TVCL+ETA(1)</b><br>
<b>V=TVVD+ETA(2)</b><br>
<b>$OMEGA .0000055, .04</b><br>
The $OMEGA record says that the initial estimate for the variance of η1 is 5. 5<i>x</i>10−6, and of η2 is<br>.04: i.e., Ω<br>
= ω2 =<br>
= ω2 =<br>
11<br>
1<br>
<i>var</i>(η1) = 5. 5<i>x</i>10−6 and Ω22<br>
2<br>
<i>var</i>(η2) = . 04. Some users of NON-<br>
MEM prefer to code each value on a separate line so that they can include comments:<br>
<b>$OMEGA .0000005 ; VARIANCE IN CL</b><br>
<b>.04 ; VARIANCE IN V</b><br>
<b>3.3. The $SIGMA Record</b><br>
This record is used only with population data, and is similar to the $OMEGA record. It gives the<br>initial estimates of the variances of the ε variables used in the $ERROR statements, where they<br>are called either ERR or EPS. For example, in Figure 2.6, there also appears the records:<br>
<b>$ERROR</b><br>
<b>Y=F+ERR(1)</b><br>
<b>$SIGMA 25</b><br>
Here, ERR(1) corresponds to ε 1, and the initial estimate for its variance is 25: i.e.,<br>
Σ = σ 2 =<br>
11<br>
1<br>
<i>var</i>(ε 1) = 25.<br>
<b>3.4. Fixing Elements of </b>Ω <b>or </b>Σ<br>
It is sometimes desirable to hold one or more elements of Ω or Σ to constant value(s). In the pop-<br>ulation example of Chapter 2 it is possible to ignore interindividual variability in CL by ﬁxing η1<br>to 0†. The variance of an η or ε variable is held constant by inserting the word FIXED <i>after </i>the<br>initial estimate:<br>
<b>$OMEGA 0 FIXED .0225</b><br>
Parentheses may be used to make the statement easier to read:<br>
<b>$OMEGA (0 FIXED) .0225</b><br>
As with θ , the value 0 may not be used as an initial estimate for any element of Ω or Σ unless the<br>element is ﬁxed to this value.<br>
† One could also re-write the $PK statements to eliminate ETA(1) in the model for CL, which also requires that<br>ETA(2) in the model for V be re-numbered as ETA(1). It is easier to modify only $OMEGA.<br>
-85-<br>
<hr>
<A name=94></a>Chapter 9 - Additional NM-TRAN Records<br>
<b>3.5. How to Obtain Initial Estimates for </b>Ω <b>and </b>Σ<br>
The initial estimates for the variances will depend on the particular (interindividual and/or intrain-<br>dividual) error models chosen. The estimates do not have to be particularly accurate, although<br>values which are much too small can cause difﬁculties for NONMEM. In general, it is better to<br>over-estimate the variances rather than to under-estimate them. As with initial estimates for θ ,<br>initial estimates can sometimes be obtained from published literature or from prior runs with<br>NONMEM or other regression programs.<br>
Initial estimates can also be obtained by an approach which we illustrate with examples for both<br>intraindividual and interindividual error models. The standard deviation of a physiological quan-<br>tity is generally some fraction <i>r </i>of its typical value <i>t</i>: σ =<br>
<i>y</i><br>
<i>rt</i>.<br>
For the additive model:<br>
<i>y </i>= <i>f </i>+ ε<br>
σ = σ<br>
<i>y</i><br>
ε = <i>rt</i><br>
<i>var</i>ε = σ 2ε = (<i>rt</i>)2 = <i>r</i>2<i>t</i>2<br>
Some ambiguity exists about what we mean by &quot;the typical value&quot; of y. For the purpose of<br>obtaining an initial estimate of the variance, we need not be too particular about this. For the<br>theophylline example (Figure 2.1), we may choose the mean of the observed values as the typical<br>value. This<br>
value is approximately 5.4.<br>
Assuming 20% error,<br>
i.e.<br>
<i>r </i>= . 2,<br>
then<br>
σ 2ε = (. 2<i>x</i>5. 4)2 = 1. 2. Similarly, in the ﬁrst phenobarbital example (Figure 2.6), the mean of the<br>
observations is approximately 25.<br>
Again assuming 20% error,<br>
then<br>
<i>r </i>= . 2,<br>
and<br>
σ 2ε = (. 2<i>x</i>25)2 = 25. For that same example, the typical value of CL was estimated according to<br>
the model for the parameter: TVCL=THETA(1). We used the initial estimate of θ 1, .0047, as the<br>typical value of CL, and assumed 50% error: Ω<br>
=<br>
11<br>
(. 5<i>x</i>. 0047)2 = 5. 5<i>x</i>10−6. The model for V is<br>
TVVD=THETA(2). Again, we used the initial estimate of θ 2, .99, as the typical value of V, but<br>assumed 20% error: Ω<br>
=<br>
22<br>
(. 2<i>x</i>. 99)2 = . 04. Note ﬁnally that in the second phenobarbital exam-<br>
ple (Figure 2.12), we used as initial estimates of variance the ﬁnal estimates obtained from the<br>ﬁrst example (understanding that these estimates could be somewhat large due to some of the<br>variability being explained in this example by a systematic inﬂuence of weight).<br>
For the constant coefﬁcient of variation model:<br>
<i>y </i>= <i>f </i>+ <i>f </i>ε<br>
σ =<br>
<i>y</i><br>
<i>f </i>σ ε = <i>rt</i><br>
<i>var</i>ε = σ 2ε = <i>r</i>2<i>t</i>2<br>
<i>f </i>2<br>
If we identify t with the value of f (whatever it may be), we have:<br>
<i>var</i>ε = <i>r</i>2<br>
In other words, using the CCV model, we do not need to estimate the typical value of the vari-<br>able. For example, assuming 20% error, <i>var</i>ε = . 22 = . 04.<br>As with θ , it is possible for NONMEM itself to obtain initial estimates of Ω and Σ automatically;<br>see Chapter 12, Section 4.4.<br>
-86-<br>
<hr>
<A name=95></a>Chapter 9 - Additional NM-TRAN Records<br>
<b>4. Specifying Optional Tasks</b><br>
Tw o main tasks of NONMEM, the Estimation Step and the Covariance Step, are optional and<br>must be speciﬁcally requested by including the $ESTIMATION and $COVARIANCE records.<br>To skip the Estimation Step, simply omit the $ESTIMATION record. To skip the Covariance<br>Step, simply omit the $COVARIANCE record.<br>
In every run NONMEM computes and prints the value of the objective function and the ﬁnal<br>parameter estimates. The values printed are based on the ﬁnal parameter estimates if the Estima-<br>tion Step is requested, and are based on the initial estimates if it is not.<br>
<b>4.1. Requesting the Estimation Step: the $ESTIMATION Record</b><br>
In the Estimation Step, NONMEM performs a search to obtain those values of θ , Ω, and (for pop-<br>ulation studies) Σ which give the lowest value of the objective function. The output of this step is<br>the pages whose titles are &quot;MONITORING OF SEARCH:&quot;, &quot;MINIMUM VALUE OF OBJECTIVE FUNC-<br>TION&quot;, and &quot;FINAL PARAMETER ESTIMATE&quot;. This step is requested by the presence of the follow-<br>ing statement:<br>
<b>$ESTIMATION</b><br>
There are several options, which are described in the NONMEM Users Guide, Part IV. The most<br>frequently used ones are as follows.<br>
METHOD=0<br>
NONMEM always sets etas to 0 during the computation of the objective function. Also<br>called the &quot;ﬁrst order (FO) method.&quot; This is the default. It may also be coded as<br>METHOD=ZERO.<br>
METHOD=1<br>
NONMEM uses conditional estimates for the etas during the computation of the objective<br>function. METHOD=1 is also called the &quot;ﬁrst order conditional estimation (FOCE)<br>method.&quot; It may also be coded as METHOD=CONDITIONAL. When the option INTERACTION<br>is also present, the method is called the &quot;FOCE with INTERACTION method&quot;. It is recom-<br>mended for continuous variables unless the data are very sparse. These methods are dis-<br>cussed in Guide VII, Conditional Estimation Methods.<br>
SIGDIGITS=n<br>
By default, the search continues until the estimates of all elements of θ , Ω, and Σ have been<br>determined to at least 3 signiﬁcant ﬁgures. Because only 3 signiﬁcant digits are used to<br>print parameter estimates in the output, and for other reasons as well, this amount of accu-<br>racy is often sufﬁcient. However, the SIGDIGITS option can be used to request a different<br>number (n) of signiﬁcant digits.<br>
MAXEVAL=n<br>
The Estimation Step always runs with a speciﬁc limit on the number of objective function<br>evaluations allowed during the search, as a protection against inﬁnite loops and excessively<br>long runs. The default maximum is computed according to the number of parameters being<br>estimated. The MAXEVALS option can be used to request a different number (n) for the<br>maximum number of function evaluations.<br>
PRINT=n<br>
As the Estimation Step progresses, by default it prints intermediate output summarizing the<br>progress of the search. The search proceeds in stages, called iterations. At the end of cer-<br>tain iterations a summarization is printed which consists of the values of the objective func-<br>tion, its gradient vector with respect to the parameters, and the parameter values themselves.<br>By default, this summarization is only printed for the ﬁrst and last iterations. The PRINT<br>option can be used to request a number (n) such that starting from the ﬁrst iteration, only<br>
-87-<br>
<hr>
<A name=96></a>Chapter 9 - Additional NM-TRAN Records<br>
n-1 iterations are skipped before another summarization is printed†.<br>
An example of the use of these options is:<br>
<b>$EST SIG=6,MAX=900,PRI=5</b><br>
In addition to the ﬁrst and last iterations, summarizations are printed every 5th iteration. Notice<br>that abbreviations of the record and option names were used; this is a matter of style.<br>
<b>4.2. Requesting the Covariance Step: the $COVARIANCE Record</b><br>
In the Covariance Step, NONMEM obtains information on the precision of the parameter esti-<br>mates obtained in the Estimation Step. The output of this step are pages with titles &quot;STANDARD<br>ERROR OF ESTIMATE&quot;, &quot;COVARIANCE MATRIX OF ESTIMATE&quot;, &quot;CORRELATION MATRIX OF ESTI-<br>
MATE&quot;, and &quot;INVERSE COVARIANCE MATRIX OF ESTIMATE&quot;. This step is requested by the presence<br>of the following record:<br>
<b>$COVARIANCE</b><br>
There are several options, which are discussed in NONMEM Users Guide, Part IV. The Covari-<br>ance Step cannot be requested by itself; the Estimation Step must precede it‡.<br>
<b>5. Specifying Optional Output</b><br>
$TABLE and $SCATTERPLOT records are used to request NONMEM steps which generate<br>additional output. If one of these records is omitted, NONMEM does not produce the corre-<br>sponding additional output. Tables and scatterplots are generated <i>after </i>all other tasks have been<br>performed. This affects the values displayed for PRED, RES, and WRES. If the Estimation Step<br>is <i>not </i>run, then the <i>initial </i>estimates of the parameters are used to compute these quantities. If the<br>Estimation Step <i>is </i>run, then the <i>ﬁnal </i>parameter estimates are used. Residuals (RES) and<br>weighted residuals (WRES) are deﬁned in Chapter 11, Section 4.4.2.<br>
The UNCONDITIONAL option of the $TABLE and $SCATTERPLOT records requests that out-<br>put of this type be generated even if the Estimation Step terminates unsuccessfully, and is the<br>default. The CONDITIONAL option of these records requests that output of this type be gener-<br>ated only if the Estimation Step terminates successfully.<br>
<b>5.1. Requesting the Table Step: the $TABLE Record</b><br>
The values of DV, PRED, RES, and WRES are always printed in every table. Other data items to<br>be printed should be listed on the record. The data items are printed in the order in which they<br>are listed. This does not have to be the same order as in the data ﬁle, nor does every data item<br>have to be listed. For example, the following record appears in Chapter 2, ﬁgure 2.12:<br>
<b>$TABLE ID TIME AMT WT APGR</b><br>
Figure 10.10 in Chapter 10 shows a portion of the resulting output.<br>
It is possible for the lines of a table to be sorted into a different order than that of the original<br>input ﬁle; this is discussed in the NONMEM Users Guide, Part IV.<br>
More than one table can be printed. A separate $TABLE record is used to request each one.<br>
<b>5.2. Requesting Scatterplots: the $SCATTERPLOT Record</b><br>
Chapter 2 contained many examples of $SCATTERPLOT records and the resulting output. Here,<br>for example, are the records from ﬁgure 2.6:<br>
<b>$SCATTERPLOT PRED VS DV</b><br>
<b>UNIT</b><br>
† The PRINT option can also be used to suppress intermediate printout altogether, but this should usually not be<br>done because the information is often of value. See Chapter 10, Section 4.<br>
‡ The Estimation Step may be omitted when the run is continued from a prior run using a Model Speciﬁcation<br>input ﬁle; see Chapter 12, Section 4.3, and Chapter 13, Section 3.2.<br>
-88-<br>
<hr>
<A name=97></a>Chapter 9 - Additional NM-TRAN Records<br>
<b>$SCATTERPLOT RES</b><br>
<b>VS WT</b><br>
The word UNIT requests a unit-slope line, which is the line PRED=DV. Figures 2.10 and 2.11<br>show the resulting output.<br>
Similarly, the word ORD0 can be used to request a zero line on the ordinate axis.<br>
It is possible to generate several scatterplots with a single record, by using a list of data item<br>names:<br>
<b>$SCATTERPLOT (PRED,RES,WRES) VS WT</b><br>
This produces three scatterplots, and has the same effect as the three records:<br>
<b>$SCATTERPLOT PRED VS WT</b><br>
<b>$SCATTERPLOT RES</b><br>
<b>VS WT</b><br>
<b>$SCATTERPLOT WRES VS WT</b><br>
Sometimes it is desirable to partition a scatterplot into a number of separate scatterplots. For<br>example, if the data contain both plasma and urine observations, it would be better to separate the<br>scatterplot of PRED vs. DV into one scatterplot where the DV values are the plasma observations,<br>and another one where the DV values are the urine observations. To do this, it is necessary to<br>specify a partitioning data item, in this case, the CMT data item, which gives the compartment<br>number of the observation. The following record could be used.<br>
<b>$SCATTERPLOT PRED VS DV BY CMT UNIT</b><br>
This will produce separate scatterplots: one with plasma observations (CMT=1 if ADVAN1 is<br>used), and one with urine observations (CMT=2 if ADVAN1 is used).<br>
Tw o partitioning items can also be speciﬁed:<br>
<b>$SCATTERPLOT PRED VS DV BY CMT SEX UNIT</b><br>
One scatterplot is produced for each unique <i>combination </i>of values of the two partitioning data<br>items.<br>
<b>6. Placement and Order of Records</b><br>
Tw o main rules control the placement and order of records within a NM-TRAN control ﬁle:<br>
The $INPUT record must appear <i>before </i>any records which contain data item names ($PK,<br>$ERROR, $TABLE, $SCATTERPLOT)<br>
The $SUBROUTINE, $PK, and $ERROR records should appear in the indicated order, but<br>do not have to be consecutive.<br>
The records $DAT A, $THETA, $OMEGA, $SIGMA, $ESTIMATION, $COVARIANCE, $TA-<br>BLE, and $SCATTERPLOT can be placed anywhere among the control records, in any order.<br>However, NONMEM always performs its tasks in a ﬁxed order:<br>
Estimation Step<br>Covariance Step<br>Table Step<br>Scatterplot Step<br>
Thus, even if the $TABLE record precedes the $ESTIMATION record, the values of PRED, RES,<br>and WRES in the table will be based on the ﬁnal parameter estimates.<br>
<b>7. INCLUDE records</b><br>
One or more records of the form<br>
<b>INCLUDE filename n</b><br>
may appear anywhere among the NM-TRAN control records. The characters INCLUDE may be<br>upper- or lower-case. &quot;n&quot; is an optional integer, and gives the number of copies (default is 1).<br>
-89-<br>
<hr>
<A name=98></a>Chapter 9 - Additional NM-TRAN Records<br>
NMTRAN opens the named ﬁle and reads it to end-of-ﬁle. The contents of the named ﬁle may be<br>any portion of an NM-TRAN control stream, e.g., NM-TRAN control records and/or abbreviated<br>code. After reaching end-of-ﬁle, if the number of copies is greater than 1, NM-TRAN rewinds<br>the ﬁle and re-reads it the speciﬁed number of times. After reaching end-of-ﬁle on the ﬁnal (or<br>only) copy, NMTRAN resumes reading the original control stream after the include record.<br>
There may be more than one INCLUDE record, but they may not be nested. That is, an included<br>ﬁle may not contain INCLUDE records.<br>
For example,<br>
<b>$PROBLEM Model &quot;a&quot; with data set 27, proportional error</b><br>
<b>INCLUDE data27.def</b><br>
<b>INCLUDE modela.def</b><br>
<b>$ERROR Y=F+F*ERR(1)</b><br>
<b>$THETA 1.3 4</b><br>
<b>$OMEGA .04</b><br>
<b>$SIGMA 1</b><br>
<b>$ESTIMATION</b><br>
The ﬁle data27.def contains the $INPUT and $DAT A records.<br>The ﬁle modela.def contains the $SUBROUTINE record and $PK block.<br>
-90-<br>
<hr>
<A name=99></a><b>Chapter 10 - Reading the Output</b><br>
<b>1. What This Chapter is About</b><br>
This chapter describes NONMEM’s output in detail. Each page of a NONMEM-PREDPP output<br>ﬁle is shown and discussed.<br>
The input ﬁle to NM-TRAN is that of ﬁgure 2.12, which is reproduced here as ﬁgure 10.1 for<br>convenience.<br>
<b>1</b><br>
<b>$PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V</b><br>
<b>2</b><br>
<b>$INPUT ID TIME AMT WT APGR DV</b><br>
<b>3</b><br>
<b>$DATA INDATA</b><br>
<b>4</b><br>
<b>$SUBROUTINE ADVAN1</b><br>
<b>5</b><br>
<b>$PK</b><br>
<b>6</b><br>
<b>TVCL=THETA(1)+THETA(3)*WT</b><br>
<b>7</b><br>
<b>CL=TVCL+ETA(1)</b><br>
<b>8</b><br>
<b>TVVD=THETA(2)+THETA(4)*WT</b><br>
<b>9</b><br>
<b>V=TVVD+ETA(2)</b><br>
<b>10 ; THE FOLLOWING ARE REQUIRED BY PREDPP<br>11 K=CL/V<br>12 S1=V<br>13 $ERROR<br>14 Y=F+ERR(1)<br>15 $THETA</b><br>
<b>(0,.0027) (0,.70) .0018</b><br>
<b>.5</b><br>
<b>16 $OMEGA</b><br>
<b>.000007, .3</b><br>
<b>17 $SIGMA</b><br>
<b>8</b><br>
<b>18 $ESTIMATION PRINT=5<br>19 $COVARIANCE<br>20 $TABLE ID TIME AMT WT APGR DV<br>21 $SCATTER</b><br>
<b>PRED VS DV</b><br>
<b>UNIT</b><br>
<b>22 $SCATTER</b><br>
<b>RES VS WT</b><br>
Figure 10.1. The NM-TRAN input ﬁle (same as ﬁgure 2.12). The line numbers on the left are not actually part of the<br>ﬁle.<br>
<b>2. NONMEM Describes its Inputs</b><br>
The ﬁrst page of NONMEM’s output is shown in ﬁgure 10.2. In this page, NONMEM repeats<br>(&quot;echos&quot;) the instructions it was given in the control ﬁle and describes the data ﬁle. The ﬁrst page<br>of the output should be checked carefully. Problems in a NONMEM run can often be traced to<br>errors in the problem speciﬁcation. For example, always check that the initial parameter esti-<br>mates were entered correctly.<br>
-91-<br>
<hr>
<A name=100></a>Chapter 10 - Reading the Output<br>
<b>1 NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM)</b><br>
<b>DOUBLE PRECISION NONMEM</b><br>
<b>VERSION IV LEVEL 1.0</b><br>
<b>2 DEVELOPED AND PROGRAMMED BY STUART BEAL AND LEWIS SHEINER<br>3<br>4 PROBLEM NO.</b><br>
<b>1</b><br>
<b>5 PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V<br>6<br>7 DATA CHECKOUT RUN:</b><br>
<b>NO</b><br>
<b>8 DATA SET LOCATED ON UNIT NO.:</b><br>
<b>2</b><br>
<b>9 THIS UNIT TO BE REWOUND:</b><br>
<b>NO</b><br>
<b>10 NO. OF DATA RECS IN DATA SET:</b><br>
<b>744</b><br>
<b>11 NO. OF DATA ITEMS IN DATA SET:</b><br>
<b>8</b><br>
<b>12 ID DATA ITEM IS DATA ITEM NO.:</b><br>
<b>1</b><br>
<b>13 DEP VARIABLE IS DATA ITEM NO.:</b><br>
<b>6</b><br>
<b>14 MDV DATA ITEM IS DATA ITEM NO.:</b><br>
<b>8</b><br>
<b>15<br>16 INDICES PASSED TO SUBROUTINE PRED ARE:<br>17 7</b><br>
<b>2</b><br>
<b>3</b><br>
<b>0</b><br>
<b>0</b><br>
<b>0</b><br>
<b>0</b><br>
<b>0</b><br>
<b>0</b><br>
<b>18 0</b><br>
<b>0</b><br>
<b>19<br>20 LABELS FOR DATA ITEMS ARE:<br>21 ID</b><br>
<b>TIME AMT</b><br>
<b>WT APGR</b><br>
<b>DV EVID</b><br>
<b>MDV</b><br>
<b>22<br>23 FORMAT FOR DATA IS:<br>24 (6E6.0,2F2.0)<br>25<br>26 TOT. NO. OF OBS RECS:</b><br>
<b>155</b><br>
<b>27 TOT. NO. OF INDIVIDUALS:</b><br>
<b>59</b><br>
<b>28<br>29 LENGTH OF THETA:</b><br>
<b>4</b><br>
<b>30<br>31 OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:</b><br>
<b>2</b><br>
<b>32<br>33 SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:</b><br>
<b>1</b><br>
<b>34<br>35 INITIAL ESTIMATE OF THETA:<br>36 LOWER BOUND INITIAL EST UPPER BOUND<br>37 0.0000E+00</b><br>
<b>0.2700E-02 0.1000E+07</b><br>
<b>38 0.0000E+00</b><br>
<b>0.7000E+00 0.1000E+07</b><br>
<b>39 -0.1000E+07</b><br>
<b>0.1800E-02 0.1000E+07</b><br>
<b>40 -0.1000E+07</b><br>
<b>0.5000E+00 0.1000E+07</b><br>
<b>41<br>42 INITIAL ESTIMATE OF OMEGA:<br>43 0.7000E-05<br>44 0.0000E+00</b><br>
<b>0.3000E+00</b><br>
<b>45<br>46 INITIAL ESTIMATE OF SIGMA:<br>47 0.8000E+01<br>48<br>49 ESTIMATION STEP OMITTED:</b><br>
<b>NO</b><br>
<b>50 NO. OF FUNCT. EVALS. ALLOWED:</b><br>
<b>360</b><br>
<b>51 NO. OF SIG. FIGURES REQUIRED:</b><br>
<b>3</b><br>
<b>52 INTERMEDIATE PRINTOUT: YES<br>53 MSF OUTPUT: NO<br>54<br>55 COVARIANCE STEP OMITTED:</b><br>
<b>NO</b><br>
<b>56 EIGENVLS. PRINTED: NO<br>57 SPECIAL COMPUTATION: NO<br>58<br>59 TABLES STEP OMITTED:</b><br>
<b>NO</b><br>
<b>60 NO. OF TABLES:</b><br>
<b>1</b><br>
<b>61 TABLES PRINTED: YES<br>62<br>63 USER-CHOSEN DATA ITEMS FOR TABLE</b><br>
<b>1,</b><br>
<b>64 IN THE ORDER THEY WILL APPEAR IN THE TABLE, ARE:<br>65 ID</b><br>
<b>TIME AMT</b><br>
<b>WT APGR</b><br>
<b>66<br>67 SCATTERPLOT STEP OMITTED:</b><br>
<b>NO</b><br>
<b>68 NO. OF PAIRS OF ITEMS GENERATING<br>69 FAMILIES OF SCATTERPLOTS:</b><br>
<b>2</b><br>
<b>70<br>71 ITEMS TO BE SCATTERED ARE:</b><br>
<b>DV PRED</b><br>
<b>72 UNIT SLOPE LINE INCLUDED<br>73 ITEMS TO BE SCATTERED ARE:</b><br>
<b>WT RES</b><br>
Figure 10.2. The ﬁrst page of the output report. The line numbers on the left are not actually part of the report.<br>
Line 5 is an identiﬁcation line for the output report. The contents of the $PROBLEM record are<br>shown here.<br>
Line 7 indicates that this is not a data checkout run. (Data checkout mode is discussed in Chapter<br>12 Section 4.10.) Lines 8 through 27 describe the input data ﬁle. Lines 10 and 11 describe the<br>numbers of rows and columns in the input ﬁle, as shown in ﬁgure 6.1. Speciﬁcally, line 10 shows<br>how many data records were read according to the FORTRAN format speciﬁcation given in line<br>24. Line 11 describes the number of data items per record, which is the number of data items<br>listed in the $INPUT record, less any that were dropped by the Data Preprocessor, plus any that it<br>added (see Chapter 6). Lines 12, 13, and 14 describe the locations of those data items of interest<br>
-92-<br>
<hr>
<A name=101></a>Chapter 10 - Reading the Output<br>
to NONMEM itself (i.e. NONMEM data items). Lines 16 through 18 are discussed in Section 3.<br>Line 21 gives the labels for all the data items. The ﬁrst six labels are those of the data items spec-<br>iﬁed in the $INPUT record and the next two (EVID, MDV) are those of two data items added to<br>the data set by the Data Preprocessor. (NONMEM itself supplies labels PRED, RES, and WRES<br>for the prediction, residual, and weighted residual data items.) In the terminology of Chapter 4<br>(e.g. (4.15a)), ID, TIME, AMT, WT, and APGR are the elements of <i>x</i>; DV is <i>y</i>; PRED is <i>f </i>(eval-<br>uated for the typical individual in the population). Line 24 shows the format used to read each<br>data record. In this example, the format was generated by the Data Preprocessor and describes<br>the data ﬁle after processing by the Data Preprocessor.† Line 26 gives the number of observation<br>records. Line 27 gives the number of individual records; that is, one less than the number of<br>times that the ID data item changed value.<br>
Lines 29 through 47 describe the contents of the $THETA, $OMEGA and $SIGMA records.<br>First, the number of elements of θ , Ω and Σ are given (lines 29, 31 and 33), then their initial esti-<br>mates are displayed. In lines 38-41, notice the values 0.1000e+07 and -0.1000e+07. These are<br>NONMEM’s way of expressing the values +∞ and −∞; i.e., of describing θ s which are<br>
unbounded on one or both sides. Another FORTRAN system may display these numbers differ-<br>ently (e.g., 1.0000e+06), but the absolute value will always be 1,000,000. In lines 43 and 44,<br>notice that the variances from the $OMEGA record appear along the diagonal of the Ω matrix,<br>and that the off-diagonal element <i>cov</i>(η1, η2) is zero. Line 31 states that NONMEM understands<br>
Ω to be diagonal; the off-diagonal element(s) are automatically ﬁxed at zero.<br>The remaining lines of ﬁgure 10.2 describe the tasks that NONMEM will perform. Lines 49<br>through 53 describe the $ESTIMATION record. Lines 50 through 53 show the defaults (set by<br>NM-TRAN) for various options, all of which could have been speciﬁed explicitly on the $ESTI-<br>MATION record. In line 50 for example, NONMEM displays the maximum number of times it<br>will evaluate the objective function during the Estimation Step (this number can be slightly<br>exceeded). The value 360 was supplied by NM-TRAN. It is a function of the sizes of θ , Ω, and<br>
Σ. Line 51 displays the desired number of signiﬁcant digits in the ﬁnal parameter estimate; the<br>value 3 is the default number requested by NM-TRAN.<br>
Lines 55 through 59 describe the $COVARIANCE record, giving the default options chosen by<br>NM-TRAN.<br>
Lines 59 through 61 describe the $TABLE record. Lines 67 through 73 describe the $SCATTER-<br>PLOT records.<br>
<b>3. PREDPP Describes Its Inputs</b><br>
The next two pages are produced by PREDPP and will not appear if $PRED statements (or a<br>user-written PRED subroutine) are used. PREDPP uses these pages to repeat (&quot;echo&quot;) the<br>instructions it was given in the control ﬁle, and to identify the ADVAN and TRANS routines cho-<br>sen by the user. The ﬁrst page of PREDPP’s output is shown in ﬁgure 10.3.<br>
In its ﬁrst page of output, PREDPP describes the features of the pharmacokinetic model and its<br>parameterization encoded into the ADVAN and TRANS routines speciﬁed on the $SUBROU-<br>TINE record. The information displayed here includes the kind of information summarized in<br>Appendices 1 and 2. In the particular output of Figure 10.3 no information concerning an alter-<br>nate parameterization appears because TRANS1 was speciﬁed. The information concerning basic<br>parameters and compartments is displayed in a format similar to that used in NONMEM Users<br>Guide, Part VI, which is the complete reference for PREDPP.<br>
† When a format speciﬁcation is supplied on the $DAT A record, and no data items are dropped or added by the<br>Data Preprocessor, the original format speciﬁcation is used unchanged and appears here.<br>
-93-<br>
<hr>
<A name=102></a>Chapter 10 - Reading the Output<br>
<b>1 DOUBLE PRECISION PRED</b><br>
<b>VERSION III LEVEL 1.0</b><br>
<b>2<br>3 ONE COMPARTMENT MODEL (ADVAN1)<br>4<br>5 MAXIMUM NO. OF BASIC PK PARAMETERS:</b><br>
<b>2</b><br>
<b>6<br>7 BASIC PK PARAMETERS (AFTER TRANSLATION):<br>8</b><br>
<b>ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.:</b><br>
<b>1</b><br>
<b>9</b><br>
<b>10<br>11 COMPARTMENT ATTRIBUTES<br>12 COMPT. NO. FUNCTION INITIAL</b><br>
<b>ON/OFF DOSE DEFAULT</b><br>
<b>DEFAULT</b><br>
<b>13 STATUS</b><br>
<b>ALLOWED ALLOWED FOR DOSE FOR OBS.</b><br>
<b>14 1</b><br>
<b>CENTRAL ON</b><br>
<b>NO YES</b><br>
<b>YES YES</b><br>
<b>15 2</b><br>
<b>OUTPUT OFF</b><br>
<b>YES NO</b><br>
<b>NO NO</b><br>
Figure 10.3. The ﬁrst page of PREDPP’s output. The line numbers on the left are not actually part of the report.<br>
Lines 5 and 8 describe the basic PK parameters, which in this example is the single microconstant<br>K. If a translator other than TRANS1 had been requested, an additional line would appear<br>describing the translation. E.g., with TRANS2, this line would read:<br>
<b>TRANSLATOR WILL CONVERT PARAMETERS CLEARANCE (CL) AND VOLUME (V) to K</b><br>
Lines 10 through 14 describe the compartment attributes. Even though the output compartment is<br>never turned on by the data of this example, its attributes are described here because it is part of<br>the model.<br>
The information presented so far describes the model for computing drug amounts. For a giv en<br>choice of ADVAN and TRANS, the contents of this page are completely ﬁxed. PREDPP’s sec-<br>ond page of output describes user choices related to the given ADVAN routine, including choices<br>for the scale parameters (and thus, to the model for computing concentrations). This page is<br>shown in ﬁgure 10.4.<br>
<b>1 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG<br>2 COMPT. NO.</b><br>
<b>INDICES</b><br>
<b>3</b><br>
<b>SCALE BIOAVAIL.</b><br>
<b>ZERO-ORDER ZERO-ORDER ABSORB</b><br>
<b>4</b><br>
<b>FRACTION RATE</b><br>
<b>DURATION LAG</b><br>
<b>5</b><br>
<b>1</b><br>
<b> </b><br>
<b>3</b><br>
<b> </b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>6</b><br>
<b>2</b><br>
<b> </b><br>
<b>*</b><br>
<b> </b><br>
<b>-</b><br>
<b> </b><br>
<b>-</b><br>
<b> </b><br>
<b>-</b><br>
<b> </b><br>
<b>-</b><br>
<b>7</b><br>
<b>- PARAMETER IS NOT ALLOWED FOR THIS MODEL</b><br>
<b>8</b><br>
<b>* PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;</b><br>
<b>9</b><br>
<b>WILL DEFAULT TO ONE IF APPLICABLE</b><br>
<b>10<br>11 DATA ITEM INDICES USED BY PRED ARE:<br>12 EVENT ID DATA ITEM IS DATA ITEM NO.:</b><br>
<b>7</b><br>
<b>13 TIME DATA ITEM IS DATA ITEM NO.:</b><br>
<b>2</b><br>
<b>14 DOSE AMOUNT DATA ITEM IS DATA ITEM NO.:</b><br>
<b>3</b><br>
<b>15<br>16<br>17 PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.<br>18 PK SUBROUTINE NOT CALLED AT ADDITIONAL DOSE OR LAGGED DOSE TIMES.<br>19<br>20 DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.<br>21 OTHERWISE, ERROR SUBROUTINE CALLED ONCE IN THIS PROBLEM.</b><br>
Figure 10.4. The second page of PREDPP’s output. The line numbers on the left are not actually part of the report.<br>
Lines 2 through 9 describe the additional PK parameters that are computed by the $PK statements<br>(or PK subroutine). In line 5, the position marked with &quot;3&quot; corresponds to the scale parameter for<br>compartment number 1. Thus, we know that the $PK statements contained an assignment state-<br>ment for S1. From the prior page we can see that compartment number 1 is the central compart-<br>ment. The value &quot;3&quot; is a row number within GG, an array used for communication between<br>PREDPP and the PK subroutine. With the use of NM-TRAN and $PK statements, row numbers<br>are of no interest to the user. With a user-written PK subroutine, it is important to check their cor-<br>rectness. Positions marked with &quot;*&quot; correspond to additional PK parameters that are allowed by<br>the model but that are not assigned a value by $PK statements; an example is F1, the bioavailabil-<br>ity fraction for compartment 1. Positions marked with &quot;-&quot; correspond to additional parameters<br>that may not be computed; for instance, dose-related parameters are not allowed for the output<br>compartment, because (as shown on the preceding page) this compartment cannot receive doses.<br>
Lines 11 through 14 describe the locations in the input data record of those data items of interest<br>to PREDPP (PREDPP data items). (NM-TRAN causes the locations of these data items in the<br>
-94-<br>
<hr>
<A name=103></a>Chapter 10 - Reading the Output<br>
data set to be passed by NONMEM to PREDPP, as indicated in lines 15 through 17 of ﬁgure 10.2.<br>NONMEM is not concerned with the signiﬁcance of these data items.) Note that data item 7,<br>Event ID, was appended by the Data Preprocessor.<br>
Line 17 reﬂects the fact that, by default, $PK statements are evaluated with every event record†.<br>Lagged and additional doses are discussed in Chapter 12, Sections 2.4 and 2.5. They are not used<br>in this example.<br>
Line 21 reﬂects the fact that the $ERROR statements describe the simple error model (3.4). This<br>model uses no data items and no elements of θ whatsoever (directly or indirectly). NM-TRAN<br>has instructed PREDPP that the $ERROR statements need be evaluated only once at the begin-<br>ning of the problem. Line 20 indicates that, should the Simulation Step be implemented,<br>PREDPP will disregard this limitation and evaluate the $ERROR statements with every event<br>record, so that randomly-generated values of intra-individual error can be applied at every obser-<br>vation event. (This example does not involve simulation, but the PK and ERROR routines which<br>implement the $PK and $ERROR statements are capable of supporting all NONMEM tasks,<br>including simulation.)<br>
Finally, note that the $PK and $ERROR models (ﬁgure 10.1, lines 5-14) are not documented in<br>the NONMEM-PREDPP output. It is a good idea to attach a printed copy of the NM-TRAN<br>input records to the corresponding NONMEM output. MS/DOS batch ﬁle nmfe72.bat and Unix<br>C-shell script nmfe72 (supplied with NONMEM) do this automatically.<br>
<b>4. Diagnostic Output from the Estimation Step</b><br>
The next page of output, ﬁgure 10.5, is produced during the running of the Estimation Step.<br>
<b>4.1. Intermediate Output from the Estimation Step</b><br>
Lines 1 through 42 are referred to as the intermediate output. Lines 4 through 7 give numbers<br>summarizing the 0-th iteration, which are based on the initial parameter estimates. Line 4 shows<br>the initial value of the objective function. The value following &quot;NO. OF FUNC. EVALS.&quot; is the<br>number of objective function evaluations which were needed during the iteration. Line 5 gives<br>the cumulative number of function evaluations including this and all prior iteration summaries.<br>Line 6 gives the unconstrained parameter (UCP) estimates. The search is carried out in a differ-<br>ent parameter space. The parameters are transformed to unconstrained parameters (UCP). In<br>the transformation process a scaling occurs so that the initial estimate of each of the UCP is 0.1.<br>Thus, in line 6, all parameters are .1 at the 0-th iteration. Parameters are printed in the following<br>order: elements of θ , elements of Ω, elements of Σ. In this example, reading from left to right,<br>the parameters are θ 1, θ2, θ3, θ4, Ω11, Ω22, and Σ11.<br>Tw o points should be noted. First, ﬁxed parameters do not appear in the list. Therefore, the off-<br>diagonal element Ω12, which is effectively ﬁxed to 0, does not appear. Second, when off-diagonal<br>elements of Ω are being estimated, then as many additional UCP’s appear as there are off-diago-<br>nal elements of Ω being estimated. However, a 1-1 correspondence between each of the elements<br>of Ω and an UCP does not exist. The same is true for elements of Σ and the UCP’s for Σ when<br>off-diagonal elements of Σ are estimated.<br>
With NONMEM 7, the parameter estimates are also displayed in their natural (unscaled)<br>space. These lines are identiﬁed as NPARAMETR and precede the PARAMETER lines, which<br>display the UCP values.<br>
† In this example, the $PK statements (lines 5 through 12 of the input ﬁle, ﬁgure 10.1) involve only WT, which<br>is constant for each individual. It is possible to limit the event records with which the $PK statements are evalu-<br>ated to the ﬁrst event record of each individual, in order to reduce run time. This decision is left to the user.<br>
-95-<br>
<hr>
<A name=104></a>Chapter 10 - Reading the Output<br>
<b>1 MONITORING OF SEARCH:<br>2<br>3<br>4 ITERATION NO.:</b><br>
<b>0</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6757E+03 NO. OF FUNC. EVALS.: 8</b><br>
<b>5 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>8</b><br>
<b>6 PARAMETER: 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00<br>7 GRADIENT: -0.7986E+03 -0.1594E+04 -0.4294E+03 -0.1000E+04</b><br>
<b>0.1542E+03 0.5269E+03 0.9128E+02</b><br>
<b>8<br>9 ITERATION NO.:</b><br>
<b>5</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6502E+03 NO. OF FUNC. EVALS.:10</b><br>
<b>10 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>58</b><br>
<b>11 PARAMETER:</b><br>
<b>0.8878E-01 0.1003E+00 0.2055E+00 0.1296E+00 0.6695E-01 0.7822E-01 0.1071E+00</b><br>
<b>12 GRADIENT:</b><br>
<b>0.1060E+04 0.2567E+04 0.3675E+03 0.8472E+03 -0.1807E+03 -0.5093E+03</b><br>
<b>0.9841E+02</b><br>
<b>13<br>14 ITERATION NO.: 10</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6153E+03 NO. OF FUNC. EVALS.: 9</b><br>
<b>15 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>107</b><br>
<b>16 PARAMETER:</b><br>
<b>0.5008E-01 0.6626E-01 0.2425E+00 0.1663E+00 -0.6718E-01 0.6382E-01 0.1004E+00</b><br>
<b>17 GRADIENT:</b><br>
<b>0.9732E+02 0.3034E+03 0.3185E+02 0.1228E+03 -0.1162E+03 0.1252E+03 0.6450E+02</b><br>
<b>18<br>19 ITERATION NO.: 15</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6108E+03 NO. OF FUNC. EVALS.: 9</b><br>
<b>20 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>152</b><br>
<b>21 PARAMETER:</b><br>
<b>0.4235E-01 0.4508E-01 0.2462E+00 0.1831E+00 -0.5721E-01 0.5237E-01 0.1008E+00</b><br>
<b>22 GRADIENT:</b><br>
<b>0.3989E+02 0.7394E+02 -0.1782E+01 0.8527E+02 -0.9309E+02 0.1867E+02 -0.1773E+02</b><br>
<b>23<br>24 ITERATION NO.: 20</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6095E+03 NO. OF FUNC. EVALS.: 9</b><br>
<b>25 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>197</b><br>
<b>26 PARAMETER:</b><br>
<b>0.1927E-01 0.3153E-01 0.2615E+00 0.1898E+00 -0.4458E-01 0.4904E-01 0.1047E+00</b><br>
<b>27 GRADIENT:</b><br>
<b>0.1609E+02 -0.3621E+02</b><br>
<b>0.5228E+01 0.9614E+00 -0.1740E+02 0.1329E+02 0.3111E+01</b><br>
<b>28<br>29 ITERATION NO.: 25</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6091E+03 NO. OF FUNC. EVALS.: 9</b><br>
<b>30 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>242</b><br>
<b>31 PARAMETER:</b><br>
<b>0.2389E-02 0.4171E-01 0.2652E+00 0.1833E+00 -0.4413E-01 0.4998E-01 0.1043E+00</b><br>
<b>32 GRADIENT:</b><br>
<b>0.2273E+01 -0.5333E+01</b><br>
<b>0.3914E+01 -0.5397E+01</b><br>
<b>0.1271E+01 0.2610E+01 0.3584E+00</b><br>
<b>33<br>34 ITERATION NO.: 30</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6091E+03 NO. OF FUNC. EVALS.:16</b><br>
<b>35 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>299</b><br>
<b>36 PARAMETER: -0.1278E-03 0.4166E-01 0.2650E+00 0.1835E+00 -0.4414E-01 0.5003E-01 0.1043E+00<br>37 GRADIENT:</b><br>
<b>-0.1120E+00 -0.9411E+00 -0.3719E+00 -0.2540E+01 -0.5135E-01</b><br>
<b>0.1420E+00 -0.9524E-01</b><br>
<b>38<br>39 ITERATION NO.: 32</b><br>
<b>OBJECTIVE VALUE:</b><br>
<b>0.6091E+03 NO. OF FUNC. EVALS.: 0</b><br>
<b>40 CUMULATIVE NO. OF FUNC. EVALS.:</b><br>
<b>315</b><br>
<b>41 PARAMETER: -0.7284E-05 0.4150E-01 0.2650E+00 0.1836E+00 -0.4411E-01 0.5003E-01 0.1043E+00<br>42 GRADIENT:</b><br>
<b>-0.6416E-02 0.9336E-01 0.4548E-01 0.4826E-01 0.1263E-02 0.9652E-01 0.4629E-01</b><br>
<b>43<br>44 MINIMIZATION SUCCESSFUL<br>45 NO. OF FUNCTION EVALUATIONS USED:</b><br>
<b>315</b><br>
<b>46 NO. OF SIG. DIGITS IN FINAL EST.:</b><br>
<b>3.9</b><br>
Figure 10.5. The output from the Estimation Step. The line numbers on the left are not actually part of the report.<br>
Line 7 shows the gradient for each parameter, which may be thought of as the partial derivative of<br>the objective function with respect to that parameter.<br>
The Estimation Step proceeds in a series of stages called iterations. In this example, intermediate<br>printout is produced for each of every 5 iterations, as well as for the 0-th and ﬁnal iterations, for<br>which intermediate printout is always printed by default. This printout consists of the same four<br>lines as for the 0-th iteration, but using the parameters estimates obtained at the end of the itera-<br>tion.<br>
In lines 4, 9, 14, 19, 24, 29, 34, and 39, observe that the objective function drops quickly at ﬁrst,<br>and then more slowly. After iteration number 25, there is no change above the fourth signiﬁcant<br>digit.<br>
In lines 6, 11, 16, 21, 26, 31, 36, and 41, observe that each parameter also changes rapidly at ﬁrst<br>and then more slowly as it converges to its ﬁnal value. (The ﬁrst parameter, θ 1, is an exception.<br>It is clearly approaching a very small value close to its lower bound, 0. In Chapter 12, we shall<br>see that both θ 1 and θ2 are best ﬁxed at 0.)<br>Finally, in lines 7, 12, 17, 22, 27, 32, 37, and 42, observe that the gradients also approach 0,<br>another sign that a minimum of the objective function has been located.<br>
The values computed for the gradients are very sensitive to differences in computer arithmetic<br>and precision. If a given NONMEM run is repeated on a different computer, or on the same com-<br>puter with different machine precision or a different FORTRAN compiler, it is likely that the gra-<br>dients will be different. This will cause the search to follow a different path to the minimum, so<br>that lines 4 through 42 may be quite different. However, each ﬁnal estimate of a UCP should<br>always be the same to the number of requested signiﬁcant digits. (Minor differences may also be<br>
-96-<br>
<hr>
<A name=105></a>Chapter 10 - Reading the Output<br>
observed in the output of the Covariance Step, below; this output is also sensitive to computa-<br>tional differences.)<br>
<b>4.2. Summary Output from the Estimation Step</b><br>
Lines 44, 45 and 46 are always printed, even when intermediate printout is suppressed. Line 44,<br>&quot;MINIMIZATION SUCCESSFUL&quot;, signiﬁes that the search appears to have located a minimum<br>of the objective function. Before one can be certain that a minimum has been located, or one<br>which corresponds to a reasonable parameter estimate (there can be a number of &quot;local minima&quot;),<br>the ﬁnal parameter estimates must be examined in their (untransformed) state; see Section 5<br>below. The Estimation Step is not always successful. Chapter 13 discusses two other messages<br>that sometimes appear instead of line 44.<br>
In line 45, note that the number of function evaluations used, 315, is a total value and includes all<br>iterations (not just those for which intermediate printout was displayed). This is under the limit<br>of 360 supplied by NM-TRAN (ﬁgure 10.2, line 57).<br>
The number of signiﬁcant digits in the ﬁnal estimate is given in line 34 as 3.9. This can be inter-<br>preted as meaning that no (transformed) <i>parameter estimate </i>is actually determined to less than<br>3.9 signiﬁcant digits. More speciﬁcally, when the UCP estimates were compared between the last<br>two iterations, none differed in the ﬁrst (almost) 4 signiﬁcant ﬁgures <i>including </i>leading zeros after<br>the decimal point. Note that the ﬁnal θ 1 UCP estimate is -0.7284E-05, and so the 7284 are not<br>signiﬁcant digits at all! Because NONMEM displays only 3 signiﬁcant digits in the printed<br>parameter estimates, and for other reasons as well, by default NM-TRAN requests only 3 signiﬁ-<br>cant digits. However, more signiﬁcance can be requested, as was discussed in Chapter 9, Section<br>4.1.<br>
<b>5. Minimum Value of the Objective Function and Final Parameter Estimates</b><br>
The next two pages in the NONMEM output are produced whether or not the Estimation Step<br>was implemented and, if it was, whether or not the search terminated successfully. They giv e the<br>values of the objective function and the parameter estimates, using the ﬁnal parameter estimates if<br>the Estimation Step was implemented (whether or not the search terminated successfully), and<br>using the initial parameter estimates otherwise. These pages have already been shown in Chapter<br>2, ﬁgure 2.13. Even when the minimization routine is successful in locating a minimum of the<br>objective function, the ﬁnal (untransformed) parameter estimates must be carefully checked. Is<br>any parameter’s ﬁnal estimate physiologically unreasonable? Is any parameter’s ﬁnal estimate<br>near its upper or lower constraint? If either answer is yes, the model, the constraints on θ ’s, or the<br>data may be incorrect; see Chapter 11.<br>
Sometimes the ﬁnal estimates do not match anticipated values, e.g., values obtained by some<br>other system of analysis. Additional reﬁnement of the model may be needed, as discussed in<br>Chapter 11. However, the discrepancy may well be traceable to an error in model speciﬁcation,<br>such as an error in specifying a compartment’s scale. Along with the Estimation Step, it is impor-<br>tant to obtain a scatterplot of PRED vs DV and make sure the unit slope line is visible. See Chap-<br>ter 13, Section 4.4.<br>
<b>6. Output from the Covariance Step</b><br>
Figures 10.6 through 10.7 show the output of the Covariance Step, which was requested via the<br>$COVARIANCE record. Figure 10.6 has already been displayed as ﬁgure 2.14, but is included<br>here for completeness. This page displays the standard errors of the parameter estimates. Stan-<br>dard errors are discussed extensively in Chapters 5 and 11. A detailed discussion of the remain-<br>ing three pages, containing the covariance, correlation, and inverse covariance matrices, is beyond<br>the scope of this text. Note, however, the use of the notation &quot;........&quot;. Each sequence of dots<br>
-97-<br>
<hr>
<A name=106></a>Chapter 10 - Reading the Output<br>
denotes a value (such as the standard error in the estimate of Ω12) that is 0 by deﬁnition, rather<br>than due to a computation.<br>
<b>1 ************************************************************************************************************************<br>2 ******************** ********************<br>3 ******************** STANDARD ERROR OF ESTIMATE</b><br>
<b>********************</b><br>
<b>4 ******************** ********************<br>5 ************************************************************************************************************************<br>6<br>7<br>8<br>9 THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>10<br>11<br>12 TH 1</b><br>
<b>TH 2   TH 3   TH 4</b><br>
<b>13<br>14 9.49E-11</b><br>
<b>1.46E-01 2.24E-04 1.13E-01</b><br>
<b>15<br>16<br>17<br>18 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>19<br>20<br>21 ETA1</b><br>
<b>ETA2</b><br>
<b>22<br>23 ETA1</b><br>
<b>7.24E-07</b><br>
<b>24<br>25 ETA2</b><br>
<b>......... 3.63E-02</b><br>
<b>26<br>27<br>28<br>29 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS</b><br>
<b>****</b><br>
<b>30<br>31<br>32 EPS1<br>33<br>34 EPS1</b><br>
<b>1.71E+00</b><br>
Figure 10.6. Standard error of the estimate. The line numbers on the left are not actually part of the report.<br>
<b>1 ************************************************************************************************************************<br>2 ******************** ********************<br>3 ******************** COVARIANCE MATRIX OF ESTIMATE</b><br>
<b>********************</b><br>
<b>4 ******************** ********************<br>5 ************************************************************************************************************************<br>6<br>7<br>8</b><br>
<b>TH 1   TH 2   TH 3   TH 4   OM11 OM12 OM22 SG11</b><br>
<b>9</b><br>
<b>10 TH 1</b><br>
<b>9.02E-21</b><br>
<b>11<br>12 TH 2</b><br>
<b>3.93E-12 2.14E-02</b><br>
<b>13<br>14 TH 3</b><br>
<b>-5.23E-15 -1.45E-05</b><br>
<b>5.00E-08</b><br>
<b>15<br>16 TH 4</b><br>
<b>-3.69E-12 -1.57E-02</b><br>
<b>1.04E-05 1.27E-02</b><br>
<b>17<br>18 OM11</b><br>
<b>-1.11E-17 2.13E-08 -6.39E-12 -1.52E-08</b><br>
<b>5.24E-13</b><br>
<b>19<br>20 OM12</b><br>
<b>......... ......... ......... ......... ......... .........</b><br>
<b>21<br>22 OM22</b><br>
<b>-1.79E-14 4.40E-04 -5.30E-07 5.58E-04 6.27E-10 ......... 1.32E-03</b><br>
<b>23<br>24 SG11</b><br>
<b>1.04E-11 -5.69E-02</b><br>
<b>1.12E-04 4.45E-02 -3.74E-07 ......... -1.03E-02</b><br>
<b>2.92E+00</b><br>
Figure 10.7. Covariance matrix of the estimate. The line numbers on the left are not actually part of the report.<br>
-98-<br>
<hr>
<A name=107></a>Chapter 10 - Reading the Output<br>
<b>1 ************************************************************************************************************************<br>2 ******************** ********************<br>3 ******************** CORRELATION MATRIX OF ESTIMATE</b><br>
<b>********************</b><br>
<b>4 ******************** ********************<br>5 ************************************************************************************************************************<br>6<br>7<br>8</b><br>
<b>TH 1   TH 2   TH 3   TH 4   OM11 OM12 OM22 SG11</b><br>
<b>9</b><br>
<b>10 TH 1</b><br>
<b>1.00E+00</b><br>
<b>11<br>12 TH 2</b><br>
<b>2.83E-01 1.00E+00</b><br>
<b>13<br>14 TH 3</b><br>
<b>-2.46E-01 -4.44E-01</b><br>
<b>1.00E+00</b><br>
<b>15<br>16 TH 4</b><br>
<b>-3.45E-01 -9.53E-01</b><br>
<b>4.13E-01 1.00E+00</b><br>
<b>17<br>18 OM11</b><br>
<b>-1.61E-01 2.01E-01 -3.95E-02 -1.86E-01</b><br>
<b>1.00E+00</b><br>
<b>19<br>20 OM12</b><br>
<b>......... ......... ......... ......... ......... .........</b><br>
<b>21<br>22 OM22</b><br>
<b>-5.21E-03 8.29E-02 -6.53E-02 1.37E-01 2.39E-02 ......... 1.00E+00</b><br>
<b>23<br>24 SG11</b><br>
<b>6.44E-02 -2.28E-01</b><br>
<b>2.94E-01 2.31E-01 -3.02E-01 ......... -1.66E-01</b><br>
<b>1.00E+00</b><br>
Figure 10.8. Correlation matrix of the estimate. The line numbers on the left are not actually part of the report.<br>
<b>1 ************************************************************************************************************************<br>2 ******************** ********************<br>3 ******************** INVERSE COVARIANCE MATRIX OF ESTIMATE</b><br>
<b>********************</b><br>
<b>4 ******************** ********************<br>5 ************************************************************************************************************************<br>6<br>7<br>8</b><br>
<b>TH 1   TH 2   TH 3   TH 4   OM11 OM12 OM22 SG11</b><br>
<b>9</b><br>
<b>10 TH 1</b><br>
<b>1.56E+20</b><br>
<b>11<br>12 TH 2</b><br>
<b>1.46E+11 1.25E+03</b><br>
<b>13<br>14 TH 3</b><br>
<b>1.35E+13 4.42E+04 2.80E+07</b><br>
<b>15<br>16 TH 4</b><br>
<b>2.32E+11 1.63E+03 3.98E+04 2.23E+03</b><br>
<b>17<br>18 OM11</b><br>
<b>3.04E+15 -3.96E+06 -7.46E+08 -1.76E+06</b><br>
<b>2.26E+12</b><br>
<b>19<br>20 OM12</b><br>
<b>......... ......... ......... ......... ......... .........</b><br>
<b>21<br>22 OM22</b><br>
<b>-1.56E+11 -1.14E+03 -2.82E+04 -1.55E+03</b><br>
<b>2.82E+06 .........</b><br>
<b>1.86E+03</b><br>
<b>23<br>24 SG11</b><br>
<b>-1.93E+09 -7.14E+00 -1.06E+03 -1.03E+01</b><br>
<b>2.67E+05 .........</b><br>
<b>9.91E+00 4.78E-01</b><br>
Figure 10.9. Inverse covariance matrix of the estimate. The line numbers on the left are not actually part of the report.<br>
<b>7. Additional Output: Tables and Scatterplots</b><br>
The use of $TABLE and $SCATTERPLOT records to request tables and scatterplots is discussed<br>in Chapter 9.<br>
<b>7.1. Output from the Table Step</b><br>
The ﬁrst 12 lines of the table produced by the $TABLE record are shown in ﬁgure 10.10. This is<br>the data for the ﬁrst individual.<br>
Each row in the table corresponds to a record of the input ﬁle, and the rows appear in the same<br>order as do the corresponding records of the input data ﬁle. Note that the values of RES and<br>WRES are always shown as zero for non-observation records†, whereas a (possibly) nonzero<br>value of PRED is printed for every record.<br>
If there are more than 900 data records, separate tables are produced for groups of 900 records.<br>The last table contains the remaining records. If the rows of the table are sorted, each group of<br>records is sorted separately. When the input data ﬁle is large, the table will require many pages to<br>print. Therefore, the $TABLE record should be omitted unless needed for diagnostic purposes<br>(such as when initially checking a new data set or model).<br>
† Strictly speaking, RES and WRES are always zero for records having MDV=1. With PREDPP, this is the<br>same thing.<br>
-99-<br>
<hr>
<A name=108></a>Chapter 10 - Reading the Output<br>
<b>1 TABLE NO.</b><br>
<b>1</b><br>
<b>2<br>3<br>4<br>5 LINE NO.</b><br>
<b>ID TIME</b><br>
<b>AMT WT</b><br>
<b>APGR DV</b><br>
<b>PRED RES</b><br>
<b>WRES</b><br>
<b>6<br>7</b><br>
<b>1</b><br>
<b> </b><br>
<b>1.00E+00 0.00E+00 2.50E+01 1.40E+00 7.00E+00 0.00E+00 1.78E+01 0.00E+00 0.00E+00</b><br>
<b>8<br>9</b><br>
<b>2</b><br>
<b> </b><br>
<b>1.00E+00 2.00E+00 0.00E+00 1.40E+00 7.00E+00 1.73E+01 1.76E+01 -3.14E-01 -2.92E-01</b><br>
<b>10<br>11 3</b><br>
<b>1.00E+00 1.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 1.92E+01 0.00E+00 0.00E+00</b><br>
<b>12<br>13 4</b><br>
<b>1.00E+00 2.45E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.07E+01 0.00E+00 0.00E+00</b><br>
<b>14<br>15 5</b><br>
<b>1.00E+00 3.70E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.20E+01 0.00E+00 0.00E+00</b><br>
<b>16<br>17 6</b><br>
<b>1.00E+00 4.80E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.33E+01 0.00E+00 0.00E+00</b><br>
<b>18<br>19 7</b><br>
<b>1.00E+00 6.05E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.45E+01 0.00E+00 0.00E+00</b><br>
<b>20<br>21 8</b><br>
<b>1.00E+00 7.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.56E+01 0.00E+00 0.00E+00</b><br>
<b>22<br>23 9</b><br>
<b>1.00E+00 8.53E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.66E+01 0.00E+00 0.00E+00</b><br>
<b>24<br>25 10</b><br>
<b>1.00E+00 9.65E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.77E+01 0.00E+00 0.00E+00</b><br>
<b>26<br>27 11</b><br>
<b>1.00E+00 1.08E+02 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.87E+01 0.00E+00 0.00E+00</b><br>
<b>28<br>29 12</b><br>
<b>1.00E+00 1.12E+02 0.00E+00 1.40E+00 7.00E+00 3.10E+01 2.81E+01 2.88E+00 6.88E-01</b><br>
Figure 10.10. A portion of a NONMEM table. The line numbers on the left are not actually part of the report.<br>
<b>7.2. Output from the Scatterplot Step</b><br>
Many examples of scatterplots are present in Chapters 2 and 11. They are not reproduced here.<br>Whereas all the records in the input data ﬁle correspond to rows of a table, this is not true of a<br>scatterplot that includes one or more of the items RES, WRES, and DV. When one of these three<br>is being plotted, then only observation records contribute points to the scatterplot†. In ﬁgure 2.5,<br>there are exactly 10 points &quot;*&quot;, corresponding to the 10 observation records in ﬁgure 2.2; the dose<br>record does not contribute a point.<br>
NONMEM displays only the ﬁrst 900 records of the appropriate type in a scatterplot. This limit<br>applies before any partitioning. For example, in a plot of DV VS ID, the ﬁrst 900 observation<br>records are displayed; in a plot of WT vs ID, the ﬁrst 900 records of the data ﬁle are displayed.<br>Additional scatterplots can be requested, showing additional points, using options &quot;FROM=&quot; and<br>&quot;TO=&quot; of the $SCATTERPLOT record. See NONMEM Users Guide, Part IV.<br>
† Strictly speaking, it is only the records having MDV=0 that contribute points. With PREDPP, this is the same<br>thing.<br>
-100-<br>
<hr>
<A name=109></a><b>Chapter 11 - Model Building</b><br>
<b>1. What This Chapter is About</b><br>
In this chapter, the simple phenobarbital example begun in Chapter 2 will be continued to illus-<br>trate how NONMEM is used to build a model for population data. The topic of model building,<br>diagnosis and veriﬁcation is a large one. This chapter can only give a very abbreviated example.<br>
<b>2. The Stages of Model Building</b><br>
To analyze a population data set and build a model for it, one must proceed in logical stages.<br>There are ﬁve stages, and their relationship to one another is presented diagrammatically in ﬁgure<br>11.1. One begins by checking the data. One then tries to ﬁnd an adequate model incorporating<br>the ﬁxed effects; then an adequate model incorporating the random effects and describing random<br>inter- and intra-individual variability. After a reasonably complete model is found, attempts are<br>made to reﬁne it, and ﬁnally, if desired, the various parts of the models (which often, in effect,<br>simply assert the existence of certain relationships between independent variables and the depen-<br>dent variable) can be subject to formal hypothesis tests, as described in Chapter 5. (However, it is<br>well known by statisticians that formal hypothesis testing undertaken <i>after </i>model building is just<br>an approximation for the type of hypothesis testing described in textbooks, which assumes that<br>the model is the correct model).<br>
-101-<br>
<hr>
<A name=110></a>Chapter 11 - Model Building<br>
Simple Basic<br>
Model<br>
OK<br>
NONMEM<br>
Not<br>
   Tables<br>
Fix Problems<br>
1. Check-out<br>
OK<br>
     Scatters<br>
OK<br>
NONMEM<br>
Add Structural<br>
   Tables<br>
Not<br>
2. Build Struct<br>
Features as<br>
     Scatters<br>
OK<br>
 Model<br>
Indicated<br>
  Estim<br>
OK<br>
NONMEM<br>
Add Statistical<br>
   Tables<br>
Not<br>
3. Build Stat<br>
Model Features<br>
     Scatters<br>
OK<br>
Model<br>
as Indicated<br>
  Estim<br>
OK<br>
NONMEM<br>
   Tables<br>
Remove/Change<br>
Not<br>
     Scatters<br>
Suspicious<br>
4. Refine Model<br>
OK<br>
  Estim<br>
Features<br>
Cov<br>
OK<br>
Test Major<br>
NONMEM<br>
5. Formally Test<br>
Features:<br>
   Estim<br>
Model<br>
Delete 1 by 1<br>
No<br>
More<br>
Done<br>
-102-<br>
<hr>
<A name=111></a>Chapter 11 - Model Building<br>
Figure 11.1. Stages in model building.<br>
<b>3. Check-out — Index Plots</b><br>
The goal of this stage is to assure that the data are correct. There is no point to trying to model<br>the data when gross errors are present. Most gross errors are encoding errors that cause certain<br>values to be different from the intended value by a considerable amount (for example, a mis-<br>placed decimal point changes a value by a factor of 10), so that graphical display of the data is<br>usually adequate to detect these. No numerical or statistical approaches are needed. Indeed, they<br>are not usually useful, even for more subtle errors, as such errors cannot easily be detected by any<br>means (how is a 10% error to be distinguished from inter- or intra-individual variability?).<br>
To detect gross errors, then, one makes scatterplots of different data item types vs individuals’<br>identiﬁcation numbers (i.e. the ID data item, or, if the values of this data item are arbitrary,<br>another data item that identiﬁes patients using sequential integer values; call this the sequence<br>data item: SEQ). Such plots (of one data item versus ID or SEQ) are called here index plots, and<br>are quite useful for revealing the structure of the data, as will be noted below, as well as for ﬁnd-<br>ing gross errors.<br>
If NONMEM is used to make index plots, it will also be useful to implement the Tables Step, so<br>that if a problem is noted in a scatterplot, one can refer to the table to try to ﬁnd the datum that<br>might account for the problem. To run NONMEM some model must be speciﬁed, even if all that<br>is desired is an index plot. In such case, it makes little difference what model is used. It is easiest<br>and useful to (i) start with a simple ADVAN that is likely to provide at least a roughly satisfactory<br>ﬁt, (ii) set each PK parameter to a (different) element of θ , (iii) use only one η variable, modify-<br>ing the scale parameter only, and one ε variable, and (iv) use roughly reasonable ﬁxed initial esti-<br>mates.<br>
For the phenobarbital example, one might use ADVAN1 with <i>K </i>= θ<br>
+ θ η<br>
1, <i>V </i>= θ 2<br>
2 1, and<br>
<i>y </i>= <i>f </i>+ <i>f </i>ε 1. Initial estimates might be: <i>K </i>= .0057 hr −1 (half-life = 5 days, a typical value for<br>
adults); <i>V </i>= 1.44 L. (the ﬁrst patient has a concentration of 17.3 mg/L some few hours after an ini-<br>tial loading dose of 25 mg; 1.44 times 17.3 = 25); ω = .25 (50% variability); σ 2 = .04 (20% vari-<br>ability).<br>
Figures 11.2 and 11.3 show index plots that might be seen in a check-out run (gross errors have<br>been added). In ﬁgure 11.2, DV is plotted vs ID (here ID and SEQ are the same), and a gross<br>error occurring at about patient #13 is seen (an observation of about 24 mcg/ml was erroneously<br>recorded as 240 mcg/ml). In ﬁgure 11.3, AMT is plotted vs ID, and patient #3 appears to have a<br>grossly erroneous value (again, a decimal point error; a dose of 18 was misrecorded as 180).<br>
-103-<br>
<hr>
<A name=112></a>Chapter 11 - Model Building<br>
<b>DV VS.</b><br>
<b>ID</b><br>
<b>0.00E+00 5.00E+01 1.00E+02</b><br>
<b>DV 1.50E+02</b><br>
<b>2.00E+02 2.50E+02</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* ** .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*** .</b><br>
<b>.</b><br>
<b>2*** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.14E+01. **</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>3</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>2* 2 *   .</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2*2 .</b><br>
<b>2.38E+01. 2 *</b><br>
<b>..</b><br>
<b>.</b><br>
<b>* * *   ** *   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>ID .</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>3.62E+01. *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>..</b><br>
<b>.</b><br>
<b>* *** **</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>** *   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>4.86E+01. *</b><br>
<b>* *   *22 ..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>**</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * 2* *   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2 ** * *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.2. A scatterplot of the dependent variable, DV, vs the patient’s ID number (a type of index plot). Note the<br>
outlier at about ID = 13.<br>
Actually, ﬁgure 11.3 reveals a considerable amount about the data structure (this will be seen bet-<br>ter in ﬁgure 11.4, below, when the outlier has been removed). Many points lie along the line<br>AMT = 0, where one sees integers 5, 3, 3, 6, etc, as one proceeds along the ID axis, each integer<br>indicating the corresponding number of points over-plotted at that location. They correspond to<br>the observation records, since the doses on these records are all zero. Thus one can see how many<br>observations each individual contributes (other type records would also plot at AMT=0, however).<br>Proceeding to the next highest &quot;line&quot; of doses (where many points over-plot for each patient), one<br>&quot;sees&quot; the event records giving the maintenance dose amount since this amount stays constant<br>within a individual (many maintenance doses were given per individual), and this amount is<br>approximately the same across individuals. Last, at the highest doses (except for the outlier), one<br>has mostly single points. These are the loading doses. There is occasional over-plotting of load-<br>ing-dose points. These points represent overlapping patient ID numbers (at the resolution of the<br>NONMEM plot ), not multiple loading doses to the same patient.<br>
-104-<br>
<hr>
<A name=113></a>Chapter 11 - Model Building<br>
<b>AMT VS.</b><br>
<b>ID</b><br>
<b>-1.00E+01 3.00E+01 7.00E+01</b><br>
<b>AMT 1.10E+02</b><br>
<b>1.50E+02 1.90E+02</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5 K</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 B</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3A</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 A</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>6CB * *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 C</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>4 C</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 B</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.14E+01. 4 E* 2*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>2C</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>4C</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2 B</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 D</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>7M</b><br>
<b>2*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>32A 2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 B</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 C</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>5 3 B   2</b><br>
<b>*</b><br>
<b>.</b><br>
<b>2.38E+01. 3 C</b><br>
<b>*</b><br>
<b>2</b><br>
<b> </b><br>
<b>..</b><br>
<b>.</b><br>
<b>6B **</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>9</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b>6</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*3</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>ID . 2 B</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5 4 6   2</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2 6</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>7</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>3.62E+01. 3 B</b><br>
<b>*</b><br>
<b> </b><br>
<b>..</b><br>
<b>.</b><br>
<b>6 R</b><br>
<b>**</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b>B</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2 *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 6</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b>6</b><br>
<b>*</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3 A</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>38</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>4</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>4.86E+01. 86C</b><br>
<b>* *   *</b><br>
<b>..</b><br>
<b>.</b><br>
<b>494 *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3A</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3A</b><br>
<b>3</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>6 B *   4</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* 6</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>8</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>6 M</b><br>
<b>2</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.3. An index plot of the independent variable, dose amount (AMT). Note the outlier at about ID = 3.<br>
Figure 11.4 replots the same data as ﬁgure 11.3 but with the misrecorded values of the data items<br>corrected. Figures 11.5 and 11.6 show the index plots for the other two data items of interest to<br>this data analysis: weight (WT) and Apgar score (APGR).<br>
-105-<br>
<hr>
<A name=114></a>Chapter 11 - Model Building<br>
<b>AMT VS.</b><br>
<b>ID</b><br>
<b>-1.00E+00 1.34E+01 2.78E+01</b><br>
<b>AMT 4.22E+01</b><br>
<b>5.66E+01 7.10E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.5 9B</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 B</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.3 A</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.3 A</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.6 CB</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 C</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.4 C</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.3 B</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.14E+01.4 E *</b><br>
<b>2</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.2 C</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.4 C</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.2 B</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.3 C*</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.7 M</b><br>
<b>2</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 2A</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.3 B</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.3 C</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.5 3</b><br>
<b>B</b><br>
<b>2</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>2.38E+01.3 C</b><br>
<b>*</b><br>
<b>2</b><br>
<b>..</b><br>
<b>.6 47</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.2 9</b><br>
<b>*.</b><br>
<b>.3 6</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.* 3</b><br>
<b>*</b><br>
<b>.</b><br>
<b>ID .2 B</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.* *</b><br>
<b>.</b><br>
<b>.5 4</b><br>
<b>6</b><br>
<b>2</b><br>
<b> </b><br>
<b>*</b><br>
<b>*.</b><br>
<b>.2 6</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.2 7</b><br>
<b>2</b><br>
<b>.</b><br>
<b>3.62E+01.3 B</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.6 R</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 B</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.2 *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 6</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.3 6</b><br>
<b>*</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 A</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.3 8</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.* 2</b><br>
<b>.</b><br>
<b>.* 4</b><br>
<b>*</b><br>
<b>.</b><br>
<b>4.86E+01.8 6 C</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>..</b><br>
<b>.4 94</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 A</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.3 A</b><br>
<b>*2 .</b><br>
<b>.6 38</b><br>
<b>*</b><br>
<b>22</b><br>
<b>.</b><br>
<b>.* 6</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.* *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.2 5 3</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.6 M</b><br>
<b>2</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.4. See ﬁgure 11.3; the outlier has been corrected.<br>
-106-<br>
<hr>
<A name=115></a>Chapter 11 - Model Building<br>
<b>WT VS.</b><br>
<b>ID</b><br>
<b>5.00E-01 1.14E+00 1.78E+00</b><br>
<b>WT 2.42E+00</b><br>
<b>3.06E+00 3.70E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>C</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>E</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>E</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>H</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.14E+01. 6</b><br>
<b>G</b><br>
<b>..</b><br>
<b>.</b><br>
<b>G</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>H</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>E</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>I</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b>G</b><br>
<b>.</b><br>
<b>.</b><br>
<b>H</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>H</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>7</b><br>
<b> </b><br>
<b>F</b><br>
<b>.</b><br>
<b>2.38E+01. I</b><br>
<b>..</b><br>
<b>.</b><br>
<b>K</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>C</b><br>
<b>.</b><br>
<b>.</b><br>
<b>9</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5</b><br>
<b> </b><br>
<b>.</b><br>
<b>ID .</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>8</b><br>
<b> </b><br>
<b>B</b><br>
<b>.</b><br>
<b>.</b><br>
<b>9</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>B</b><br>
<b>.</b><br>
<b>3.62E+01. F</b><br>
<b>..</b><br>
<b>.</b><br>
<b>G</b><br>
<b>J</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>5</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>A</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b> </b><br>
<b>A</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>C</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>6</b><br>
<b>.</b><br>
<b>4.86E+01. D</b><br>
<b>G</b><br>
<b>..</b><br>
<b>.</b><br>
<b>J</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>8</b><br>
<b>E</b><br>
<b>.</b><br>
<b>.</b><br>
<b>8</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>C</b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.5. Index plot for weight (WT)<br>
-107-<br>
<hr>
<A name=116></a>Chapter 11 - Model Building<br>
<b>APGR VS.</b><br>
<b>ID</b><br>
<b>9.00E-01 2.74E+00 4.58E+00</b><br>
<b>APGR 6.42E+00</b><br>
<b>8.26E+00 1.01E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>C</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>E</b><br>
<b>.</b><br>
<b>.</b><br>
<b>E</b><br>
<b>.</b><br>
<b>.</b><br>
<b>V</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b>.</b><br>
<b>.</b><br>
<b>H</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b>.</b><br>
<b>1.14E+01. G</b><br>
<b>6</b><br>
<b>..</b><br>
<b>.</b><br>
<b>G</b><br>
<b>.</b><br>
<b>.</b><br>
<b>H</b><br>
<b>.</b><br>
<b>.</b><br>
<b>E</b><br>
<b>.</b><br>
<b>.</b><br>
<b>I</b><br>
<b>.</b><br>
<b>.</b><br>
<b>W</b><br>
<b> </b><br>
<b>.</b><br>
<b>.H .<br>.</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>H</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b> </b><br>
<b>7</b><br>
<b>.</b><br>
<b>2.38E+01. I</b><br>
<b>..</b><br>
<b>.K .<br>.</b><br>
<b>C</b><br>
<b>.</b><br>
<b>.</b><br>
<b>9</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5</b><br>
<b>.</b><br>
<b>ID .</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>8</b><br>
<b>B</b><br>
<b>.</b><br>
<b>.</b><br>
<b>9</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>B</b><br>
<b> </b><br>
<b>.</b><br>
<b>3.62E+01. F</b><br>
<b>..</b><br>
<b>.</b><br>
<b>J</b><br>
<b>G</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F.</b><br>
<b>.</b><br>
<b>5</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>A</b><br>
<b>.</b><br>
<b>.2 A</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>C</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6</b><br>
<b>.</b><br>
<b>4.86E+01. T</b><br>
<b>..</b><br>
<b>.</b><br>
<b>J</b><br>
<b>.</b><br>
<b>.</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b>.</b><br>
<b>.</b><br>
<b>M</b><br>
<b>.</b><br>
<b>.</b><br>
<b>8</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>C</b><br>
<b>.</b><br>
<b>.</b><br>
<b>G</b><br>
<b>F</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.6. Index plot for Apgar score (APGR)<br>
These plots will be useful in the next stage of model building.<br>
<b>4. Building the Structural Part of the Model</b><br>
One must ﬁrst consider the choice of the structural kinetic model. For the phenobarbital data, a<br>monoexponential kinetic model has been chosen. Presumably, the basic structural kinetics are<br>already known well enough for this well studied drug, and it is not necessary to explore the ﬁts of<br>other possible structural kinetic models to the data at hand. Rather, in this section we focus on<br>the newer task to most users of NONMEM, the task of building the structural part of the model<br>for the PK parameters.<br>
<b>4.1. A General Approach</b><br>
It is generally advisable to start from the simplest reasonable model, and proceed toward greater<br>complexity, stopping whenever further additions fail to improve the model ﬁt. Thus, one needs<br>several types of tools: (i) those to choose a &quot;minimal&quot; model, (ii) those to indicate what part of a<br>current model needs to be altered or elaborated (called model diagnosis or model criticism), and<br>(iii) those to judge whether an alteration or elaboration has led to an improved model.<br>
With such tools, one proceeds step by step from the minimal model, running NONMEM and<br>using the diagnostic tools at each step to suggest a single addition for the next step. The process<br>will terminate when the judgement tools indicate no improvement by any of the additions sug-<br>gested by the diagnostic tools, or when the diagnostic tools fail to suggest any more additions.<br>
-108-<br>
<hr>
<A name=117></a>Chapter 11 - Model Building<br>
The NONMEM runs at this stage, since there will be many of them, should be made as short as<br>possible. To do so, only the estimation, table and scatterplot features need be used; the Covari-<br>ance Step need not, in general, be run.<br>
<b>4.2. The Minimal Model</b><br>
As suggested above, the minimal model involves the simplest pharmacokinetic model (ADVAN)<br>likely to ﬁt the data, and the simplest possible structural PK parameter model: each parameter is<br>simply identiﬁed with a separate element of θ .<br>
At this stage, the statistical model should also be very simple. Only one, or at most two η vari-<br>ables should be deﬁned. These will usually affect (ﬁrst) the scale parameter (which itself, is often<br>a volume of distribution parameter) and (second) some other parameter inﬂuencing the overall<br>kinetics. Since the overall kinetics exhibited in the data will usually be dominated by elimination,<br>the second η should usually modify the rate constant of elimination or clearance. However, some<br>(kinetic) data sets are dominated by absorption or distribution, and in such cases, the second η<br>should probably modify the parameter most affecting these processes. A single ε should usually<br>sufﬁce. Both inter- and intra-individual errors can conveniently be modeled as proportional, so<br>that the determination of initial estimates of variances is made easier, and all such estimates are<br>on the same scale, but this is a matter of taste. The model for the phenobarbital data deﬁned in<br>Chapter 2 (ﬁgure 2.6) almost fulﬁlls the spirit of these restrictions. However, the inter- and intra-<br>individual error models there are additive, rather than proportional. The minimal model used on<br>the phenobarbital data in this chapter is therefore a modiﬁed version of that used in Chapter 2. It<br>is:<br>
<i>CL </i>= θ 1(1 + η1)<br>
(11.1a)<br>
<i>V </i>= θ 2(1 + η2)<br>
(11.1b)<br>
<i>y </i>= <i>F</i>(1 + ε 1)<br>
(11.1c)<br>
In (11.1), it is understood that <i>S </i>= <i>V </i>, and that <i>F </i>is the prediction of <i>y </i>from ADVAN1 using <i>CL<br></i>and <i>V </i>. A control ﬁle to NM-TRAN that speciﬁes this model, and instructs NONMEM to produce<br>the desired output is:<br>
-109-<br>
<hr>
<A name=118></a>Chapter 11 - Model Building<br>
<b>$PROBLEM PHENOBARB</b><br>
<b>SIMPLE MODEL (#1)</b><br>
<b>$INPUT ID TIME AMT WT APGR DV</b><br>
<b>$DATA PHENO</b><br>
<b>$SUBROUTINE ADVAN1</b><br>
<b>$PK</b><br>
<b>TVCL=THETA(1)</b><br>
<b>CL=TVCL*(1+ETA(1))</b><br>
<b>TVVD=THETA(2)</b><br>
<b>V=TVVD*(1+ETA(2))</b><br>
<b>K=CL/V</b><br>
<b>S1=V</b><br>
<b>$ERROR</b><br>
<b>Y=F*(1+ERR(1))</b><br>
<b>$THETAS (0,.0105) (0,1.05)</b><br>
<b>$OMEGAS .25</b><br>
<b>.25</b><br>
<b>$SIGMAS .04</b><br>
<b>$ESTIMATION</b><br>
<b>$TABLE ID TIME AMT WT APGR</b><br>
<b>$SCATTERPLOT PRED VS DV UNIT</b><br>
<b>$SCATTERPLOT RES</b><br>
<b>VS (PRED,WT,APGR)</b><br>
<b>$SCATTERPLOT WRES VS (PRED,WT,APGR)</b><br>
<b>4.3. Use of Constraints</b><br>
It is important to realize that constraints on elements of θ or Ω may be part of a model.<br>
For example, constraining clearance to be positive is a modelling choice. One might implement<br>this constraint in NONMEM using a lower bound on the $THETA record, and this would assure<br>that the estimate of clearance will be positive. It may not be necessary to do this; even without<br>the lower bound, the data might clearly force the estimate to be positive.<br>
Often, however, analysts will constrain the range of a parameter in the belief that doing so will<br>shorten computing time or stabilize the search for the minimum of the objective function. While<br>this beneﬁt may be gained, the data may force the parameter estimate to the constraint boundary<br>ev en though this boundary may not, in fact, represent a true modeling choice. In this case the<br>proper action is to relax the constraint and rerun the problem. To do otherwise, and leave the<br>parameter estimate to be the boundary value, implies that at the outset the user assumes that the<br>parameter must be within the boundary and elevates the constraint to the status of a modeling<br>choice. If an estimate lies on a boundary, NONMEM will print a warning message (along with<br>the standard message regarding the status of the termination of the Estimation Step). The reader<br>is cautioned to look for such a message, and in general, it is a good idea to check the values of the<br>ﬁnal estimates against the boundary values. Alternatively, the implementation of constraints that<br>are not intended to represent modeling choices might be used cautiously and only if they really<br>seem necessary to stabilize a search.<br>
<b>4.4. Diagnostic Tools</b><br>
<b>4.4.1. Plot of DV vs PRED</b><br>
Most useful diagnostic tools are graphical. For an overall sense of the ﬁt, a useful diagnostic plot<br>is DV vs PRED. When there are substantial and systematic deviations from the line of identity,<br>
-110-<br>
<hr>
<A name=119></a>Chapter 11 - Model Building<br>
this plot suggests that there are problems with the ﬁt, but it does not suggest what exactly these<br>problems might be or what to do about them. This plot for the ﬁt of the phenobarbital data to<br>model (11.1) is seen in ﬁgure 11.7.<br>
<b>PRED VS.</b><br>
<b>DV</b><br>
<b>0.00E+00 2.60E+01 5.20E+01</b><br>
<b>PRED 7.80E+01</b><br>
<b>1.04E+02 1.30E+02</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>**</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* 2 * *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*2* *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.80E+01. *</b><br>
<b>.*** 2*</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *23 *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2 *</b><br>
<b>.</b><br>
<b>*2 **** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*2 ***** * *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>22</b><br>
<b>2. *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b>*</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>** *2</b><br>
<b>3</b><br>
<b>*</b><br>
<b> </b><br>
<b>* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>2</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* ** . * *   *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>3.10E+01. ** *2 22</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>22*.* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>DV .</b><br>
<b>* *   2   *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>4.40E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>5.70E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.7. Predictions from ﬁt of model (11.1) to phenobarbital data vs observations themselves. The line of identity<br>
(...) shows where the points should, ideally, fall.<br>
Figure 11.7 reveals that there is a group of points where the observation is much lower than the<br>prediction. To begin to determine why this is so, it will be useful to look at residual plots. Such<br>plots are the basis of the most important of the diagnostic tools.<br>
<b>4.4.2. Residual Plots</b><br>
As mentioned in Chapter 2, a residual is the difference between an observation and its prediction.<br>The prediction in this case (the same prediction as denoted by PRED) is the population predic-<br>tion, i.e. the prediction for the typical individual having the given values for all the concomitant<br>variables.<br>
With population data, weighted residuals are often more informative than (plain) residuals. The<br>weighted residuals for an individual are formed by transforming the individual’s residuals so that<br>under the population model, and assuming the true values of the population parameters are given<br>by the estimates of those parameters, all weighted residuals have unit variance and are uncorre-<br>lated. Weighted residuals are more informative for several reasons. First, since they hav e unit<br>variance, or what is the same, unit standard deviation, &quot;large&quot; weighted residuals are those with<br>absolute values greater than 3 or so. Second, loosely speaking, although plain residuals remove<br>
-111-<br>
<hr>
<A name=120></a>Chapter 11 - Model Building<br>
the structural model from the data, allowing one to see what part of the data is not (yet) modeled,<br>they do not remove the statistical model (formally, they are still correlated). Weighted residuals<br>have both models ’removed’ so any pattern in these is deﬁnitely not accounted for by the current<br>model. This provides a more secure basis for future model building choices.<br>
<b>4.4.2.1. Index Plots of Residuals</b><br>
Figure 11.8 is an index plot of residuals, which is a useful plot when combined with index plots<br>of other data items. One can look for an association between unusual residuals and values of<br>another data item. E.g. Are the largest discrepancies between model and data associated with cer-<br>tain (possibly extreme) values of the data item?<br>
<b>RES VS.</b><br>
<b>ID</b><br>
<b>-9.00E+01 -6.60E+01 -4.20E+01</b><br>
<b>RES -1.80E+01</b><br>
<b>6.00E+00 3.00E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2*</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.* 3*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* **</b><br>
<b>.</b><br>
<b>.</b><br>
<b>. 22 .</b><br>
<b>.</b><br>
<b>2 *</b><br>
<b>.</b><br>
<b>1.14E+01. *</b><br>
<b>**.* ..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**. .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>*** . *</b><br>
<b>3</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.*</b><br>
<b>**</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*2 .</b><br>
<b>.</b><br>
<b>* * *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>**</b><br>
<b>.</b><br>
<b>2.38E+01. * *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>..</b><br>
<b>.</b><br>
<b>* . * * 2   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>ID .</b><br>
<b>** .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>. *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>3.62E+01. *</b><br>
<b>*</b><br>
<b>.*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>**</b><br>
<b>**** .</b><br>
<b>.</b><br>
<b>* * *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2* .   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*** .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>4.86E+01. *</b><br>
<b>2 *   *2* ..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * 22</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*. ** *   **</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.8. Index plot of residuals from ﬁt of model (11.1) to phenobarbital data.<br>
In the phenobarbital example, this is clearly so: The large negative residuals (i.e., predictions<br>greater than observations), ﬁrst noted in ﬁgure 11.7, are here seen to be associated with patients<br>22 to 32 or thereabouts. In ﬁgures 11.4 and 11.5 it is clear that these same patients are those who<br>received the highest doses and who weigh the most. An obvious explanation, then, of the over-<br>predictions is that they are in the patients who weigh the most, and because weight is not in the<br>model, neither volume nor clearance is adjusted to be larger in such individuals, so that predic-<br>tions are strictly proportional to dose alone and may be too large for these heavier patients.<br>
-112-<br>
<hr>
<A name=121></a>Chapter 11 - Model Building<br>
<b>4.4.2.2. Plot of WRES vs Independent Variable</b><br>
Another way to see the association between weight (or dose) and the large residuals is to plot the<br>residual against weight, say. Figure 11.9 is this plot, but where, for reasons already discussed,<br>weighted residuals, rather than plain residuals, are used.<br>
<b>WRES VS.</b><br>
<b>WT</b><br>
<b>-3.10E+00 -1.92E+00 -7.40E-01</b><br>
<b>WRES 4.40E-01</b><br>
<b>1.62E+00 2.80E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*.</b><br>
<b>. *   *</b><br>
<b>.</b><br>
<b>** * *   *</b><br>
<b>*</b><br>
<b>* 2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>. *</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>* * *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   **</b><br>
<b>*</b><br>
<b> </b><br>
<b>* *2 * .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>** 2   ** ** * * **** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.14E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>** 2*</b><br>
<b>* ** ****</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * **</b><br>
<b>*</b><br>
<b>** *.</b><br>
<b>** * *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>****2*** .22**2</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2 *</b><br>
<b>** **.* *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*** ** *.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.78E+00. * * * **</b><br>
<b>*</b><br>
<b>*** ..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*2 .</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>WT .</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2.42E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.06E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* ** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.9. Plot of weighted residuals vs weight for ﬁt of minimal model to phenobarbital data.<br>
It is clear from ﬁgure 11.9, in a way that is particularly compelling, that it is precisely those indi-<br>viduals with the largest weight whose residuals are large and negative. This type of residual plot,<br>where (weighted) residuals are plotted against some independent variable, is the single most use-<br>ful diagnostic tool.<br>
Systematic patterns of weighted residuals, then, suggest possible model improvements. For an<br>independent variable that already appears in the model, such a pattern may suggest that the way in<br>which it enters the model is incorrect; e.g., it might appear as having a linear inﬂuence on a PK<br>parameter, and a curvilinear inﬂuence might be better, or it might affect additional PK parameters,<br>beyond those it affects in the current model. An example of this will be seen shortly. For a vari-<br>able that does not yet appear in the model, as in ﬁgure 11.9, such a pattern suggests that the ele-<br>ment should appear.<br>
Before examining what happens if patient weight is added to the model, a caution about residual<br>plots is in order. Neither residuals, nor weighted residuals, should ever be plotted against the<br>observations themselves. Such a plot will always show a correlation, spuriously suggesting a<br>problem with the model. This is most easily appreciated by considering the simple model that<br>gives rise to the constant-valued prediction given by the the mean of the observations. All<br>
-113-<br>
<hr>
<A name=122></a>Chapter 11 - Model Building<br>
positive residuals (observations greater than prediction) must then be associated with observations<br>greater than the mean, while all negative residuals must be associated with observations less than<br>the mean. Clearly, then, the residuals plotted against the observations must show a line with posi-<br>tive slope. This same type of association, although to a lesser degree, holds true, even in less<br>extreme cases. The phenomenon is illustrated in ﬁgure 11.10.<br>
Y<br>
Res<br>
(lnCp)<br>
3<br>
1<br>
3<br>
4<br>
6<br>
1<br>
4<br>
6<br>
0<br>
2<br>
pred y<br>
5<br>
5 2<br>
time<br>
Y<br>
Figure 11.10. Residuals always correlate with the observations themselves; the more so, the less the model explains the<br>
data!<br>
<b>4.5. Judging Goodness of Fit</b><br>
A more complex model is acceptable only if the complexity can be justiﬁed by some signiﬁcant<br>improvement in the ﬁt. To evaluate whether this has been accomplished, several measures should<br>be examined; no single measure sufﬁces.<br>
In the phenobarbital example, based on the ﬁnding in ﬁgure 11.9, a modiﬁed model is suggested.<br>This model, (11.2), has (11.2b)=(11.1b), and (11.2c)=(11.1c), but<br>
<i>Cl </i>= (θ + θ<br>
1<br>
3<i>WT </i>)(1 + η 1)<br>
(11.2a)<br>
which is a full model relative to the reduced model (11.1a), whence (11.2) is a full model relative<br>to the reduced model (11.1).<br>
The model-deﬁning statements to NM-TRAN ($PK and $ERROR) now become:<br>
<b>$PK</b><br>
<b>TVCL=THETA(1)+THETA(3)*WT</b><br>
<b>CL=TVCL*(1+ETA(1))</b><br>
<b>TVVD=THETA(2)</b><br>
<b>V=TVVD*(1+ETA(2))</b><br>
<b>K=CL/V</b><br>
<b>S1=V</b><br>
<b>$ERROR</b><br>
<b>Y=F*(1+ERR(1))</b><br>
We now examine some measures of goodness of ﬁt, and see how (11.2) fares relative to (11.1).<br>
-114-<br>
<hr>
<A name=123></a>Chapter 11 - Model Building<br>
<b>4.5.1. A Global Measure — Change in the Objective Function</b><br>
A global measure of goodness of ﬁt is, of course, the objective function value based on the ﬁnal<br>parameter estimates, which, in the case of NONMEM, is minus twice the log likelihood of the<br>data (see Chapter 5, Section 5.2.3). As noted in Chapter 5, if the new model differs from the pre-<br>vious model only by the addition of some new variable(s) (so that the two models form a<br>full/reduced model pair), then the difference in objective function values has a known (approxi-<br>mate) statistical distribution. More informally, during model-building, a fall in objective function<br>value of 4 when a single new parameter is introduced (and no old ones are eliminated) indicates<br>that the new model has substantially improved the overall goodness of ﬁt. Model (11.2) shows a<br>decrease in objective function of 35.2 relative to (11.1), indicating considerable improvement.<br>
<b>4.5.2. Decrease in Unexplained Variability</b><br>
The purpose of adding independent variables to the model is usually to explain kinetic differences<br>among individuals. This means that prior to adding a variable, such differences were not<br>&quot;explained&quot; by the model, and hence were part of random interindividual variability, although<br>these differences could also have been reﬂected as a part of random intraindividual variability.<br>Accordingly, elaboration of the model should be accompanied by a decrease in the estimates of<br>the variances in Ω and/or Σ.<br>
The estimates of ω 2<i>CL</i>, ω 2<i>V </i>, and σ 2 from the ﬁt to Model (11.2) are .057, .12, and .0196, corre-<br>sponding to coefﬁcients of variation of 24%, 35%, and 14%, respectively. The corresponding val-<br>ues from the ﬁt to (11.1) are .25 (CV=50%), .14 (CV=37%), and .016 (CV=13%), so that a con-<br>siderable reduction in the variance of clearance is seen.<br>
<b>4.5.3. Improvement in Plots</b><br>
The last, and most useful, evidence conﬁrming the value of elaborating a model is to ﬁnd that the<br>pattern(s) in the PRED vs DV and weighted residual plot(s) that suggested the need for the addi-<br>tion have now disappeared. Indeed, when a model is relatively complete, all weighted residual<br>plots should show no pattern: the &quot;unexplained&quot; part of the data should have become featureless<br>random noise.<br>
Figures 11.11 and 11.12 correspond to 11.7 and 11.9, but are from the ﬁt to model (11.2).<br>
-115-<br>
<hr>
<A name=124></a>Chapter 11 - Model Building<br>
<b>PRED VS.</b><br>
<b>DV</b><br>
<b>6.00E+00 2.40E+01 4.20E+01</b><br>
<b>PRED 6.00E+01</b><br>
<b>7.80E+01 9.60E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.. *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.* * *** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>***** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.80E+01. *</b><br>
<b>*.** ** ** ..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>2*2 *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>** **</b><br>
<b>.</b><br>
<b> </b><br>
<b>3</b><br>
<b>** *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*2</b><br>
<b>** 2 *   **</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>22</b><br>
<b>**. * *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>** **</b><br>
<b>.2</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * *   ** 2*</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.** **</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* 2</b><br>
<b>.*</b><br>
<b>* 2</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>2* *   *</b><br>
<b>.</b><br>
<b>3.10E+01. *</b><br>
<b>*</b><br>
<b>4*2. ..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*******. .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>DV .</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>** .</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>4.40E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.70E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.11. Predictions from ﬁt of model (11.2) to phenobarbital data vs observations.<br>
Compared to ﬁgures 11.7 and 11.9, ﬁgures 11.11 and 11.12 indicate an improvement in that the<br><i>number </i>of large negative residuals is clearly reduced in both plots.<br>
-116-<br>
<hr>
<A name=125></a>Chapter 11 - Model Building<br>
<b>WRES VS.</b><br>
<b>WT</b><br>
<b>-3.50E+00 -2.22E+00 -9.40E-01</b><br>
<b>WRES 3.40E-01</b><br>
<b>1.62E+00 2.90E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.* *</b><br>
<b>*</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>*** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>2</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* .</b><br>
<b>2</b><br>
<b>** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* ** *2</b><br>
<b>* *   2* 2 *   **</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.14E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>* ** 2**</b><br>
<b>** ***</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * 2   ** *.2 *</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*2** **3 *** ***</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   *</b><br>
<b>3.* *</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>* *</b><br>
<b>2</b><br>
<b> </b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.78E+00. *</b><br>
<b>***2* .</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>2 .</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>WT .</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2.42E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.06E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.12. Plot of weighted residuals vs weight for ﬁt of model (11.2) to phenobarbital data.<br>
<b>4.6. Using the Tools: Further Improvement</b><br>
<b>4.6.1. An Additional Effect of WT</b><br>
While all of the above suggests that model (11.2) is superior to model (11.1), ﬁgure 11.12 shows<br>a persistent linear relationship between weight and residuals. Thus, the addition of weight to the<br>model for clearance does not fully exploit the information in the variable, weight. An obvious<br>modiﬁcation to model (11.2) that might deal with this is to have weight affect <i>V </i>as well as <i>CL</i>.<br>Accordingly, deﬁne model (11.3) such that (11.3a)=(11.2a), (11.3c)=(11.2c), but<br>
<i>V </i>= (θ + θ<br>
2<br>
4<i>WT </i>)(1 + η 2)<br>
(11.3b)<br>
The model-deﬁning portion of the control stream now becomes:<br>
-117-<br>
<hr>
<A name=126></a>Chapter 11 - Model Building<br>
<b>$PK</b><br>
<b>TVCL=THETA(1)+THETA(3)*WT</b><br>
<b>CL=TVCL*(1+ETA(1))</b><br>
<b>TVVD=THETA(2)+THETA(4)*WT</b><br>
<b>V=TVVD*(1+ETA(2))</b><br>
<b>K=CL/V</b><br>
<b>S1=V</b><br>
<b>$ERROR</b><br>
<b>Y=F*(1+ERR(1))</b><br>
When model (11.3) is ﬁt to the data, the objective function decreases fully 126 relative to model<br>(11.2). Moreover, the estimates of ω 2<i>CL</i>, ω 2<i>V </i>, and σ 2 are now .050 (CV=22%), .028 (CV=17%),<br>and .011 (CV=10%), indicating a further substantial decrease in unexplained variation. The plots<br>corresponding to 11.7/11.11 and 11.9/11.12 are shown as ﬁgures 11.13 and 11.14.<br>
<b>PRED VS.</b><br>
<b>DV</b><br>
<b>9.00E+00 1.78E+01 2.66E+01</b><br>
<b>PRED 3.54E+01</b><br>
<b>4.42E+01 5.30E+01</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.. .<br>. * .   .<br>.</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*2* .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*. *   *</b><br>
<b>* *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.2</b><br>
<b>*2* *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.80E+01. * *22 *</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>**5 *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*22* . *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*4** *.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2*</b><br>
<b>* *. *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>** * .   *</b><br>
<b>2</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *2 **</b><br>
<b>*</b><br>
<b>.</b><br>
<b>2</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* ** . *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** 2</b><br>
<b>* .   *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   *</b><br>
<b>*. *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>3.10E+01. *</b><br>
<b>* *2</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>**</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>2 *</b><br>
<b>** * .   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>DV .</b><br>
<b>* *   *</b><br>
<b>2 .   *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>4.40E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.70E+01. ..</b><br>
<b>.</b><br>
<b>* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.13. Predictions from ﬁt of model (11.3) to phenobarbital data vs observations.<br>
Now there are no obvious discrepancies, and the plot of weighted residuals vs <i>WT </i>shows no pat-<br>tern, so that it is likely that no further use of weight in the model is required.<br>
-118-<br>
<hr>
<A name=127></a>Chapter 11 - Model Building<br>
<b>WRES VS.</b><br>
<b>WT</b><br>
<b>-3.00E+00 -1.88E+00 -7.60E-01</b><br>
<b>WRES 3.60E-01</b><br>
<b>1.48E+00 2.60E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>. * *   *</b><br>
<b>* **</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>. *</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>** 2</b><br>
<b>*</b><br>
<b>**</b><br>
<b>**</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>2*</b><br>
<b>2* 2   *</b><br>
<b>* *   *** **</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.14E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.2* 2 *</b><br>
<b>2</b><br>
<b>*</b><br>
<b>**</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*** *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>**** *** .</b><br>
<b>2</b><br>
<b>***2 *</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>** *.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>2*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.78E+00. *</b><br>
<b>*</b><br>
<b>.*</b><br>
<b>*** * *</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* .   *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>WT .</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2.42E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>. *</b><br>
<b>* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.06E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.14. Plot of weighted residuals vs weight for ﬁt of model (11.3) to phenobarbital data.<br>
<b>4.6.2. The Effect of APGR</b><br>
The structural model building stage is not over until all available independent variables have been<br>examined for inﬂuence, and there is one additional variable, the Apgar score, that has not yet been<br>seriously considered. A plot of the weighted residuals from the ﬁt to model (11.3) vs <i>APGR </i>is<br>shown in ﬁgure 11.15.<br>
-119-<br>
<hr>
<A name=128></a>Chapter 11 - Model Building<br>
<b>WRES VS. APGR</b><br>
<b>-3.00E+00 -1.88E+00 -7.60E-01</b><br>
<b>WRES 3.60E-01</b><br>
<b>1.48E+00 2.60E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>* **</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>**</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2.68E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>4.56E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>*</b><br>
<b>2</b><br>
<b>**</b><br>
<b>. * 2   *</b><br>
<b>2</b><br>
<b>**</b><br>
<b>2</b><br>
<b> </b><br>
<b>* .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>APGR .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* 2* **2* 2 2</b><br>
<b>2 *** **</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.44E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2* *</b><br>
<b>*</b><br>
<b>**** *** ***2*22</b><br>
<b>** *</b><br>
<b>** *</b><br>
<b>* *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>. *   *</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>**</b><br>
<b>*</b><br>
<b>* *2 * 2*** 2*223</b><br>
<b>* * *   *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>8.32E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>**</b><br>
<b>*</b><br>
<b>* * * **</b><br>
<b>*</b><br>
<b>.* *** * * *   *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* .   *</b><br>
<b>.</b><br>
<b>1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.15. Plot of weighted residuals vs Apgar score for ﬁt of model (11.3) to phenobarbital data.<br>
There is a weak suggestion from ﬁgure 11.15 that for <i>APGR </i>less than 3, the weighted residuals<br>tend to be negative. Accordingly, a new model (11.4) can be proposed, which is identical to<br>(11.3) except that<br>
 θ + θ<br>
if APGR &gt; 2<br>
<i>V </i>=  2<br>
4<i>WT </i>,<br>
(1 + η2)<br>
(11.4b)<br>
 (θ + θ<br>
2<br>
4<i>WT </i>)θ 5, if APGR ≤ 2<br>
The relevant statements for NM-TRAN now become:<br>
<b>$PK</b><br>
<b>TVCL=THETA(1)+THETA(3)*WT</b><br>
<b>CL=TVCL*(1+ETA(1))</b><br>
<b>TVVD=THETA(2)+THETA(4)*WT</b><br>
<b>IF (APGR.LE.2) TVVD=TVVD*THETA(5)</b><br>
<b>V=TVVD*(1+ETA(2))</b><br>
<b>K=CL/V</b><br>
<b>S1=V</b><br>
<b>$ERROR</b><br>
<b>Y=F*(1+ERR(1))</b><br>
-120-<br>
<hr>
<A name=129></a>Chapter 11 - Model Building<br>
When this model is ﬁt to the data, θ 5 is estimated to be 1.18, implying that indeed, the volumes of<br>distribution for infants with Apgar scores less than 3 are typically 18% higher than those of<br>infants (of the same weight) with higher Apgar scores. The measures of improvement are now<br>marginal, however: the objective function decreases only 3.7, and the decreases in the variances<br>are all less than 10% of their previous values, with the variance of ε actually increasing a few per-<br>cent. Inspection of ﬁgure 11.6 suggests a reason for this: note that only 5 distinct individuals<br>(separate symbols) have Apgar scores less than 3. There is simply not very much information<br>about babies with low Apgar scores in this data set.<br>
For completeness, ﬁgure 11.16 corresponds to ﬁgure 11.5, but using model (11.4), and now shows<br>no distinct pattern.<br>
<b>WRES VS. APGR</b><br>
<b>-3.00E+00 -1.88E+00 -7.60E-01</b><br>
<b>WRES 3.60E-01</b><br>
<b>1.48E+00 2.60E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>2</b><br>
<b>*</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>* * . *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2.68E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>4.56E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>** *</b><br>
<b>*</b><br>
<b>. 3</b><br>
<b>*</b><br>
<b>2</b><br>
<b>** * *</b><br>
<b>*.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>APGR .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* * 2**2* 22</b><br>
<b>*2 **</b><br>
<b>2</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>6.44E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*2 *</b><br>
<b>*</b><br>
<b>* 2* * * 2 3.*23</b><br>
<b>2 *   * *</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>. *   *</b><br>
<b>*</b><br>
<b>* *</b><br>
<b>**</b><br>
<b>*</b><br>
<b>**2. ***2* 2*2*3* *</b><br>
<b>** *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>8.32E+00. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>** *</b><br>
<b>* * *   **</b><br>
<b>*</b><br>
<b>.* * *** * *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.16. Plot of weighted residuals vs Apgar score for ﬁt of model (11.4) to phenobarbital data.<br>
The stage of building the structural model is now complete.<br>
<b>5. Building the Statistical Model</b><br>
<b>5.1. Judging Among Alternatives</b><br>
NONMEM can provide estimates of the η variables for each individual (see Chapter 12, Sections<br>4.11-4.13). Plots of the estimated interindividual differences, which can be regarded as interindi-<br>vidual residuals, can be obtained. Plots of these residuals (associated with a particular PK param-<br>eter) versus the values of an independent variable provide further help in building the structural<br>part of the parameter model. Moreover, a plot of these residuals versus the typical values of the<br>
-121-<br>
<hr>
<A name=130></a>Chapter 11 - Model Building<br>
parameter (whose values depend on covariates) also provides help in building the model for<br>interindividual differences themselves. For example, if interindividual differences are modeled<br>with the additive model, but the plot shows a linear trend (in the boundaries enveloping the resid-<br>uals), this suggests that a proportional model be tried.<br>
Lastly, help can be provided in the selection of a model for intraindividual error. Predictions of<br>concentrations, and hence residuals, based on estimates of individuals’ ηs, can be computed, and<br>the residuals can be plotted versus the predictions. (This requires advanced techniques.) Again,<br>if intraindividual errors are modeled with the additive model, but the plot shows a linear trend in<br>the envelope, this suggests that a proportional model be tried.<br>
The statistical model is usually of less interest than the structural model, so that frequently all that<br>is sought is an adequate model, not necessarily the correct one, nor does one care whether the<br>estimates of the random effects parameters (the elements of Ω and Σ) are particularly precise.<br>Sometimes, however, the variability in the random effects is of genuine primary interest. In such<br>cases more attention must be paid to building the random effects model. This, however, may not<br>be easy because it is an unfortunate, but unavoidable fact, that a great deal more data is needed to<br>estimate random effects parameters with a given precision than is needed to estimate ﬁxed effect<br>parameters with comparable precision.<br>
The tools used to elaborate the statistical model are similar to those used for elaborating the struc-<br>tural model: alternative models are assessed using (available) residual plots, especially ones like<br>those just discussed, and relative changes in the objective function.<br>
<b>5.1.1. Unexplained Variability</b><br>
When the statistical model is developed, a new η variable may be added, or an old η variable used<br>differently. Then differences in the ω s between models cannot really be used to judge the beneﬁt<br>of the addition, and this evaluation tool becomes less useful. On the other hand, an addition of an<br>
η might be conﬁrmed by a reduction in the estimates of the variances in Σ, the variances of the<br>
random components in the model for residual error. Howev er, there is one sure sign that too<br>many η’s are in the model: NONMEM may estimate one or more of the ω s to be zero, or very<br>nearly zero. This can be disconcerting, particularly if the η variable is the only such variable<br>affecting Volume, for instance, as then this estimate seems to suggest that with respect to Volume,<br>there is no interindividual variability in the population whatsoever! The result should not be<br>interpreted this way, howev er. Rather, assuming the η affecting Volume is the one most recently<br>added, it indicates that given the previous statistical model, no <i>additional </i>variability <i>needs </i>to be<br>ascribed to volume to explain all the variability seen. The data cannot support such an elaborate<br>statistical model, and a simpler model, such as the previous one, must be used.<br>
<b>5.1.2. Residual Plots</b><br>
The most important residual plot is now a plot of the weighted residuals against predictions,<br>where a pattern in the shape of the outer envelope of points can indicate deﬁciencies in the statis-<br>tical model (recall that a distinct pattern in the local &quot;average&quot; residual vs the predictions would<br>indicate a defect in the structural model). This can be illustrated using the phenobarbital data.<br>Figure 11.17 shows the plot of weighted residuals vs predictions for model (11.4), and ﬁgure<br>11.18 shows the same plot for a modiﬁed model, (11.5), identical to (11.4) except for<br>
<i>y </i>= <i>F </i>+ ε 1<br>
(11.5c)<br>
Only the $ERROR statements of the control stream change:<br>
-122-<br>
<hr>
<A name=131></a>Chapter 11 - Model Building<br>
<b>$ERROR</b><br>
<b>Y=F+ERR(1)</b><br>
<b>WRES VS. PRED</b><br>
<b>-3.00E+00 -1.88E+00 -7.60E-01</b><br>
<b>WRES 3.60E-01</b><br>
<b>1.48E+00 2.60E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>2</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* .   *</b><br>
<b>.</b><br>
<b>1.82E+01. * ** .</b><br>
<b>*</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>2</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>. *   *</b><br>
<b>*</b><br>
<b>2 2* *2</b><br>
<b>2</b><br>
<b>*3. 2*2 ***</b><br>
<b>*** **</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>* * *   * *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>. *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*. *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>. * *   2</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>. *</b><br>
<b>*</b><br>
<b>* * *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>** *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*.</b><br>
<b>2.74E+01. *</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* *.* *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>2</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>PRED .</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>** * ** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>* 2   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>3.66E+01. * .</b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>4.58E+01. *</b><br>
<b>.</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>5.50E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.17. Plot of weighted residuals vs predictions for ﬁt of model (11.4) to phenobarbital data (proportional<br>
intraindividual error).<br>
Although the plots do not differ greatly, there is a small suggestion in ﬁgure 11.18 that the enve-<br>lope of weighted residuals is somewhat V-shaped with the apex of the V at PRED=0 (but which<br>does not show on the plot), while in ﬁgure 11.17 the weighted residuals seem more homogeneous,<br>and their magnitude seems less dependent on that of the predictions. That this impression is valid<br>is suggested also by the increase in objective function of 7.6 in going from model (11.4) to (11.5).<br>
-123-<br>
<hr>
<A name=132></a>Chapter 11 - Model Building<br>
<b>WRES VS. PRED</b><br>
<b>-3.20E+00 -2.04E+00 -8.80E-01</b><br>
<b>WRES 2.80E-01</b><br>
<b>1.44E+00 2.60E+00</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>**. .</b><br>
<b>.</b><br>
<b>* . *   .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.* *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>.</b><br>
<b>1.80E+01. *</b><br>
<b>*</b><br>
<b>. *</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>* *</b><br>
<b>* *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* ** * *   *</b><br>
<b>2</b><br>
<b>**2* 3*</b><br>
<b>*** * *</b><br>
<b>** .</b><br>
<b>.</b><br>
<b>**</b><br>
<b>2 * **</b><br>
<b>2* * *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.* .</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>2 *</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>*.</b><br>
<b>2</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* ** *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.2 *</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>2.70E+01. *</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>* ..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.*</b><br>
<b>*</b><br>
<b>* *   *</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>2</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.* *</b><br>
<b>* .   *</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>* * *   *</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>PRED .</b><br>
<b>*</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>* **</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>. *</b><br>
<b>2</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>. *   .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>*</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>3.60E+01. *</b><br>
<b>*</b><br>
<b>.</b><br>
<b> </b><br>
<b>*</b><br>
<b>..</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b> </b><br>
<b>*</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>4.50E+01. .</b><br>
<b>..</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>*</b><br>
<b>.</b><br>
<b>5.40E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
<b>.</b><br>
Figure 11.18. Plot of weighted residuals vs predictions for ﬁt of model (11.5) to phenobarbital data (additive intraindi-<br>
vidual error).<br>
<b>6. Reﬁne Model</b><br>
The goal of this stage is to check whether the model is as parsimonious as reasonable, since if it is<br>not, certain important parameters may not be estimated with as good precision as can be achieved.<br>Although up to this stage, one tries to avoid adding parts to the model which are not well sup-<br>ported by the data, it is nonetheless possible that a part added at one stage may seem unnecessary<br>after adding another part at a later stage. Perhaps, for example, weight affects V, and V and CL<br>are correlated in the population (independent of weight), but ﬁrst the inﬂuence of weight on CL is<br>examined, and later its inﬂuence on V is examined (this was the order illustrated above). Then<br>initially, weight might appear to inﬂuence CL, although this inﬂuence might only derive from the<br>correlation between the two PK parameters. Later, after the inﬂuence of weight on V is a part of<br>the model, the inﬂuence of weight on CL might disappear. One wants to check this possibility<br>and, if indicated, eliminate the inﬂuence of weight on CL from the model at the stage now being<br>described. The basic technique at this stage, is to run the Covariance Step with the best model<br>thus far, and look for parameters with conﬁdence intervals that include the parameter’s null value,<br>i.e., the value that causes the parameter to be effectively deleted from the model. A null value is<br>usually zero (for a parameter quantifying an additive portion of the model), and sometimes unity<br>(for a parameter quantifying a multiplicative part of the model). If such parameters are found,<br>then one at a time, each can be set to its null value and the consequences examined as discussed<br>above for the earlier model building stages.<br>
-124-<br>
<hr>
<A name=133></a>Chapter 11 - Model Building<br>
Figures 11.19 and 11.20 show two pages of NONMEM output from a run ﬁtting model (11.4) to<br>the phenobarbital data, and implementing the Covariance Step. Figure 11.19 shows the ﬁnal<br>parameter estimates, and 11.20, their standard errors.<br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** FINAL PARAMETER ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>TH 3</b><br>
<b>TH 4</b><br>
<b>TH 5</b><br>
<b>7.50E-05 2.66E-02 4.62E-03 9.53E-01 1.18E+00</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1 ETA2</b><br>
<b>ETA1 4.59E-02</b><br>
<b>ETA2 0.00E+00</b><br>
<b>2.63E-02</b><br>
<b>SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS</b><br>
<b>****</b><br>
<b>EPS1</b><br>
<b>EPS1 1.10E-02</b><br>
Figure 11.19. Parameter estimates from ﬁt of model (11.4) to phenobarbital data.<br>
<b>************************************************************************************************************************<br>******************** ********************<br>******************** STANDARD ERROR OF ESTIMATE</b><br>
<b>********************</b><br>
<b>******************** ********************<br>************************************************************************************************************************</b><br>
<b>THETA - VECTOR OF FIXED EFFECTS</b><br>
<b>*********************</b><br>
<b>TH 1</b><br>
<b>TH 2</b><br>
<b>TH 3</b><br>
<b>TH 4</b><br>
<b>TH 5</b><br>
<b>9.59E-04 9.24E-02 7.33E-04 7.48E-02 8.36E-02</b><br>
<b>OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS</b><br>
<b>********</b><br>
<b>ETA1 ETA2</b><br>
<b>ETA1 2.25E-02</b><br>
<b>ETA2 .........</b><br>
<b>7.08E-03</b><br>
<b>SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS</b><br>
<b>****</b><br>
<b>EPS1</b><br>
<b>EPS1 2.01E-03</b><br>
Figure 11.20. Standard errors of parameter estimates from ﬁt of model (11.4) to phenobarbital data.<br>
<b>6.1. Use of Standard Errors and Conﬁdence Intervals</b><br>
The null values of θ 1 through θ4 are zero, while the null value of θ5 is unity. Using the numbers<br>from the ﬁgures, it is easily seen that for θ 1 and θ2, the parameter estimate minus the null value is<br>a fraction of one standard error, and hence θ 1 and θ2 may not be different from their null values.<br>As indicated in Chapter 5 (Section 4.2.2), an approximate (two-sided) 95% conﬁdence interval<br>for a parameter estimate is<br>
-125-<br>
<hr>
<A name=134></a>Chapter 11 - Model Building<br>
ˆ<br>
θ ± <i>Z</i>.975<i>SE</i><br>
where <i>Z</i>.975 is the 97.5 percentile of the normal distribution (≈ 2) and <i>SE </i>is the standard error of<br>the parameter estimate.<br>
Therefore, for θ 5, a 95% conﬁdence interval is given by<br>
1. 18 ± (2)(. 0836), which is 1.01 - 1.35. This range only barely misses including the null value,<br>unity, indicating, as did the marginal change in the objective function associated with going from<br>(11.3) to (11.4), that one cannot be very sure of the inﬂuence of Apgar score on volume.<br>
Finally, note the magnitudes of the standard errors of the other parameters’ estimates. For θ 3 it is<br>16% of the estimate (i.e., the CV of the estimation error is 16%), for θ 4 it is 7.8%, while for the 2<br>elements of Ω it is 49% and 27%. This pattern is typical: the precision of the ﬁxed effect parame-<br>ter estimates is considerably greater than that of the random effects parameter estimates, except<br>when the number of individuals sampled is enormous.<br>
<b>6.2. A Model Reﬁnement</b><br>
Based on the observation that θ 1 and θ2 may be equal to their null values, these parameters are<br>next set to their null values, deﬁning a new (and ﬁnal) model,<br>
<i>Cl </i>= θ 3<i>WT </i>(1 + η1)<br>
(11.6a)<br>
 θ<br>
if APGR &gt; 2<br>
<i>V </i>=  4<i>WT </i>,<br>
(1 + η2)<br>
(11.6b)<br>
 (θ4<i>WT</i>)θ5, if APGR ≤ 2<br>
<i>y </i>= <i>F</i>(1 + ε 1)<br>
(11.6c)<br>
which is communicated to NM-TRAN without changing the $PK or $ERROR statements, but<br>simply by ﬁxing the values of θ 1 and θ2 to 0, using the FIXED option in the $THETA record:<br>
<b>$PK</b><br>
<b>TVCL=THETA(1)+THETA(3)*WT</b><br>
<b>CL=TVCL*(1+ETA(1))</b><br>
<b>TVVD=THETA(2)+THETA(4)*WT</b><br>
<b>IF (APGR.LE.2) TVVD=TVVD*THETA(5)</b><br>
<b>V=TVVD*(1+ETA(2))</b><br>
<b>K=CL/V</b><br>
<b>S1=V</b><br>
<b>$ERROR</b><br>
<b>Y=F*(1+ERR(1))</b><br>
<b>$THETAS (0 FIXED) (0 FIXED) (0,.0018) (0,.43) 1.0</b><br>
When this model is ﬁt to the data, the objective function increases only .12 (a trivial change).<br>However, now the CV’s of the estimation errors in θ 3 and θ4 are 4.4% and 2.5% respectively.<br>This is the main point of this section on model reﬁnement; deletion of imprecisely estimated<br>parameters can improve the precision of other parameter estimates. This is related to the correla-<br>tion between parameter estimation errors, mentioned in Chapter 5. With little data from patients<br>who weigh virtually nothing, θ 1 and θ2, the values of CL and V for such patients, are not well<br>estimated (regardless of the fact that one might rationally model the values of these parameters to<br>be 0), and so their parameter estimates are largely dependent on the estimates of the slope param-<br>eters θ 3, θ4, and θ5. The correlation between the estimates of θ1 and θ3 is -.96, and that between<br>
θ2 and θ4 is -.95. Of course, since slope itself can only be well determined when the intercept is<br>
well determined, the parameter estimates of θ 3, θ4, and θ5 themselves largely depend on the<br>
-126-<br>
<hr>
<A name=135></a>Chapter 11 - Model Building<br>
estimates of θ 1 and θ2; correlations are symmetric. In other words, neither type of parameter<br>(intercept or slope) is very precisely estimated since the estimate of each depends on the value<br>assigned to the other. But if one of the parameters can be eliminated from the model (i.e., ratio-<br>nally assigned a ﬁxed value), then the other can be more precisely determined.<br>
<b>7. Testing the Model</b><br>
This step is undertaken when it is desirable to assign p-values to the hypothesis test of one or<br>more parameter values against null values. The procedure is as follows: Beginning with the ﬁnal<br>model resulting from all previous steps, each parameter to be tested is set, in turn, to its null<br>value, and the reduced model is ﬁt to the data (only the Estimation Step need be run; no tables,<br>graphs or covariance output are necessary). A likelihood ratio test is done using the difference in<br>minimum objective function values obtained with both the full (original) and reduced models. In<br>doing this one must be careful that in the Estimation Step with a reduced model, no parameter<br>other than the one under test (and those which are already constrained to ﬁxed values under the<br>full model) be constrained to a ﬁxed value.<br>
-127-<br>
<hr>
<A name=136></a><b>Chapter 12 - Brief Descriptions of Other Features</b><br>
<b>1. What This Chapter is About</b><br>
This chapter brieﬂy describes a variety of features of PREDPP and NONMEM that are somewhat<br>advanced for this text but are of interest to most users of NONMEM. References are given to<br>other documents where additional information can be found. Section 2 is concerned with<br>PREDPP, Section 3 is concerned with user-written PREDs, and Section 4 describes general NON-<br>MEM features. Section 5 contains an example that includes several of the advanced features.<br>Note that wherever $PK, $ERROR, $DES, $AES, $MODEL, $MIX and $PRED statements are<br>referred to below, user-written subroutines PK, ERROR, DES, AES, MODEL, MIX and PRED<br>can be used instead.<br>
<b>2. Advanced Features of PREDPP</b><br>
<b>2.1. Pharmacodynamic Modeling Using the $ERROR Record</b><br>
$ERROR statements may modify the value of F, the scaled drug concentration. They may also<br>introduce new θ and η variables. This allows pharmacodynamic modeling to be performed using<br>PREDPP. Such models occur when a study involves measurement of a drug effect, such as blood<br>pressure. A proposed model might relate the predicted effect to a pharmacokinetic quantity such<br>as plasma level. PREDPP can be used to model <i>C p </i>as is usual, and the predicted effect can be<br>computed in the $ERROR statements.<br>
For example, suppose that a modiﬁed version of the phenobarbital data of Chapter 2 includes<br>observations of some drug effect (in this case, perhaps a measure of the degree of sedation) but<br>none of the concentration observations. The dose event records are the same as those of the ear-<br>lier example. Suppose that the drug concentrations from each individual have been used to esti-<br>mate that individual’s K and V parameters, and that these estimates are now included on every<br>ev ent record for the individual. Finally, suppose that the proposed structural model for the effect,<br>E, is an &quot;E-max&quot; model:<br>
<i>C p</i><br>
<i>E </i>= <i>E</i>max <i>C </i>+<br>
50<br>
<i>C p</i><br>
where here <i>C p </i>is understood to mean the prediction of an individual’s drug concentration in the<br>plasma, and <i>E</i>max and <i>C</i>50 are PD (pharmacodynamic parameters) modeled as<br>
<i>E</i><br>
= θ + η<br>
max<br>
1<br>
1<br>
<i>C</i><br>
= θ + η<br>
50<br>
2<br>
2<br>
To ﬁt this data we can use the control statements of ﬁgure 12.1. To obtain initial parameter esti-<br>mates, let us assume that the following is observable in the data. The average value of all effect<br>measurements is about 50. Across individuals, the average value of the largest effect measure-<br>ment within each individual’s data is about 100, and the average value of the individual’s<br>observed concentration at about half this largest measurement is about 20. (This is seen when<br>concentration measurements and effect measurements are examined together.) Let us also assume<br>20% random interindividual variability in <i>E</i>max and <i>C</i>50 and 4% intraindividual variability in the<br>observation. From this we obtain initial estimates of 100 and 20 for θ 1 and θ2, (100×. 2)2 for Ω11,<br>(20×. 2)2 for Ω22, and (50×. 04)2 for Σ.<br>This example is examined again in in Section 3.2, which shows the use of $PRED statements, and<br>in Section 5, which shows how observed concentrations and effects can be ﬁt simultaneously.<br>
-128-<br>
<hr>
<A name=137></a>Chapter 12 - Brief Descriptions of Other Features<br>
References: Users Guide VI (PREDPP) IV.B.2<br>
<b>$PROBLEM PHARMACODYNAMIC MODEL USING $ERROR STATEMENTS<br>$INPUT ID TIME AMT INDK INDV DV<br>$DATA EFFDATA<br>$SUBROUTINE ADVAN1<br>$PK</b><br>
<b>K=INDK<br>V=INDV<br>S1=V</b><br>
<b>$ERROR</b><br>
<b>EMAX=THETA(1)+ETA(1)<br>C50=THETA(2)+ETA(2)<br>E=EMAX*F/(C50+F)<br>Y=E+ERR(1)</b><br>
<b>$THETA 100</b><br>
<b>20</b><br>
<b>$OMEGA 400</b><br>
<b>16</b><br>
<b>$SIGMA 4<br>$ESTIMATION</b><br>
Figure 12.1. The input to NONMEM-PREDPP for analysis of effect observations.<br>
<b>2.2. Other Pharmacokinetic Models: ADVAN5 through ADVAN9 and ADVAN13</b><br>
Appendix 1 lists ADVAN routines for the most commonly-used pharmacokinetic models. Other<br>ADVAN routines are:<br>
ADVAN5 (General Linear)<br>ADVAN6 (General Nonlinear)<br>ADVAN7 (General Linear with Real Eigenvalues)<br>ADVAN8 (General Nonlinear Kinetics with Stiff Equations)<br>ADVAN9 (General Nonlinear Kinetics with Equilibrium Compartments)<br>ADVAN13 (General Nonlinear Kinetics using LSODA)<br>
With the general methods the user deﬁnes a model of up to 99 compartments using special<br>options of the $MODEL record. For a linear model (ADVAN5 and ADVAN7), it is sufﬁcient to<br>specify (directed) compartmental connections and to compute their rate constant parameters with<br>$PK statements. ADVAN 5 and 7 make use of numerical approximations to the matrix exponen-<br>tial. For a nonlinear model (ADVAN6, ADVAN8, ADVAN9, and ADVAN13), differential equa-<br>tions must be supplied to govern the kinetics, via $DES statements. It is possible to specify initial<br>conditions for the differential equations using the I_SS (Initial Steady State) feature. For<br>ADVAN9, algebraic equations may also be supplied via $AES statements. The use of the term<br>’nonlinear’ with ADVAN 6, 8, 9, and 13 only indicates that a system of any type of ﬁrst-order dif-<br>ferential equations is allowed; such equations could be linear or non-linear.<br>
In all cases, the basic features of PREDPP described in Chapter 7 are still available, such as the<br>ability to introduce doses of any kind to any compartment of the model. It should be noted that<br>the general ADVAN routines are relatively slow. For example, when a general method is used for<br>a model identical to that of an analytic method (ADVAN1 through ADVAN4 or ADVAN10<br>through ADVAN12) the run time increases, usually by an order of magnitude.<br>
Some ADVAN and SS routines must be told the number of accurate digits that are required in the<br>computation of drug amounts, i.e., the relative tolerance. This is speciﬁed either by the TOL<br>option of the $SUBROUTINES record or by the $TOL record.<br>
References: Users Guide VI (PREDPP) VI, VII<br>References: Users Guide IV (NM-TRAN) V.C.3, 4, 7-10<br>
-129-<br>
<hr>
<A name=138></a>Chapter 12 - Brief Descriptions of Other Features<br>
<b>2.3. Zero-Order Bolus Doses</b><br>
Instantaneous bolus doses, which have AMT&gt;0 and RATE=0, are described in Chapter 6. Such<br>doses appear instantaneously in the dose compartment. Zero-order bolus doses are doses that<br>enter the dose compartment via a zero-order process (in the same manner as do infusions) except<br>that the rate or duration of the process is computed with $PK statements. When the RATE data<br>item has the value -1, then the $PK statements must include an assignment statement for an addi-<br>tional PK parameter, Rn (the &quot;modeled rate for compartment n&quot;), whose value gives the rate of<br>entry of the drug during the interval of time between the last event record and the current one.<br>There is a different such parameter for every compartment receiving a zero-order bolus dose.<br>When the RATE data item has the value -2, then the $PK statements must include an assignment<br>statement for an additional PK parameter, Dn (the &quot;modeled duration for compartment n&quot;), whose<br>value at the time of the dose event gives the duration time of the dose. The rate and duration<br>parameters can be modeled like any other PK parameters; in particular, the assignment statements<br>can involve θ ’s which are to be estimated. These parameters can be used to model the drug<br>release rate or dissolution time of a tablet or capsule.<br>
Steady-state levels involving zero-order bolus doses can be computed.<br>
Steady-state with constant infusion was described in Chapter 6. Steady-state infusions may also<br>have modeled rates (i.e., the RATE data item may be -1).<br>
References: Users Guide VI (PREDPP) III.F.3, F.4<br>
<b>2.4. The Additional Dose Data Item: ADDL</b><br>
ADDL is a dose-related data item that is used to request that a given number of additional doses,<br>just like the dose speciﬁed on the event record, be added to the system at a regular time interval,<br>starting from the time on the event record. PREDPP itself adds these doses at the appropriate<br>future times; no actual dose event record is generated by the Data Preprocessor or by PREDPP. A<br>positive integer value in ADDL speciﬁes how many additional doses (i.e., in addition to that<br>already speciﬁed in the event record) are to be given, and the value in the II (interdose interval)<br>data item (which is required) speciﬁes the time interval between doses.<br>
ADDL may be non-zero on a steady-state dose event record (except for steady-state infusions), in<br>which case additional doses are given, maintaining the dosing regimen into the future. Non-<br>steady-state kinetic formulas are used to advance the system between each additional dose. See<br>also Section 2.6 below.<br>
References: Users Guide VI (PREDPP) V.K<br>
<b>2.5. Lagged doses: the ALAG Parameter</b><br>
PREDPP permits an additional PK parameter called an absorption lag time. One such parameter<br>can be deﬁned for each compartment and applies to all doses to that compartment. It gives the<br>amount of time that a dose is held as a &quot;pending&quot; dose. When the absorption lag time has expired,<br>the dose is input into the system. In effect, the value of the absorption lag time parameter is<br>added to the value of the TIME data item on the dose event record. With NM-TRAN, recognized<br>names for absorption lag time parameters have the form ALAGn, where n is the compartment<br>number. See also Section 2.6 below.<br>
References: Users Guide VI (PREDPP) III.F.6<br>References: Users Guide IV (NM-TRAN) V.C.5<br>
<b>2.6. Model Event Times: MTIME</b><br>
Model event times MTIME(i) are additional PK parameters deﬁned in the PK routine or $PK<br>block. A model event time is not associated with any compartment, but, like an absorption lag<br>
-130-<br>
<hr>
<A name=139></a>Chapter 12 - Brief Descriptions of Other Features<br>
time, deﬁnes a time to which the system is advanced. When the time is reached, indicator vari-<br>ables are set and a call to PK is made. At this call (and/or subsequent to this call) PK or DES or<br>AES or ERROR can use the indicator variables to change some aspect of the system, e.g., a<br>term in a differential equation, or the rate of an infusion.<br>
<b>2.7. Controlling Calls to PK and ERROR</b><br>
In order to evaluate the $PK and $ERROR statements, PREDPP calls the PK and ERROR subrou-<br>tines. By default, the subroutines are called with every event record. PREDPP may be instructed<br>to limit calls to certain event records in order to save the computing time involved with unneces-<br>sary calls (e.g. when the PK parameters do not vary from event record to event record within an<br>individual). It is also possible to cause the PK subroutine to be called at times which do not cor-<br>respond to any actual event record.<br>
Using NM-TRAN, calls to PK are controlled by the presence of one of the following pseudo-<br>statements, at the start of the $PK block:<br>CALLFL=-2:<br>
call with every event record, at additional and lagged dose times, and at modeled event<br>times.<br>
CALLFL=-1:<br>
call with every event record (default).<br>
CALLFL=0:<br>
call with the ﬁrst event record of each individual record and with new values of TIME.<br>
CALLFL=1:<br>
call once per individual record.<br>
A calling protocol phrase may be used instead of a pseudo-statement. A calling protocol phrase<br>may use upper- or lower-case characters. It must be enclosed in parentheses. NM-TRAN can un-<br>derstand minor variations in the wording. E.g., the word &quot;CALL&quot; and prepositions such as WITH<br>can be omitted. Here are calling protocol phrases equivalent to the above four pseudo-statements,<br>respectively.<br>(CALL WITH NON-EVENT TIMES)<br>
(CALL WITH EVERY EVENT RECORD)<br>
(CALL WITH FIRST EVENT RECORD AND NEW TIME)<br>
(CALL ONCE PER INDIVIDUAL RECORD)<br>
The choice CALLFL=-2 (CALL WITH NON-EVENT TIMES) is intended to be used when<br>PK parameters Dn and/or Fn apply to additional or lagged doses <i>and </i>the model for these parame-<br>ters depends on some time-varying concomitant variable such as type of drug preparation or<br>patient weight. By default, the values of the PK parameters which apply to the dose are those val-<br>ues computed by PK with the ﬁrst event record having a value of TIME greater than the time at<br>which the dose actually enters the system (the additional or lagged dose time). However, if<br>PREDPP is instructed to also call PK at the additional or lagged dose time, then the values of the<br>PK parameters are those values computed at these special calls. At such calls, PK has available to<br>it information from the initiating dose event record itself, and information from the two event<br>records whose TIME values bracket the additional or lagged dose time. Along with CALLFL=-2<br>in the $PK block, the NM-TRAN $BIND record may be useful; see Users Guide IV.<br>
Using NM-TRAN, calls to ERROR are controlled by the presence of one of the following<br>pseudo-statements at the start of the $ERROR block:<br>CALLFL=-1:<br>
call with every event record (default).<br>
CALLFL=0:<br>
call with observation events only.<br>
-131-<br>
<hr>
<A name=140></a>Chapter 12 - Brief Descriptions of Other Features<br>
CALLFL=1:<br>
call once per individual record.<br>
A calling protocol phrase may be used instead of a pseudo-statement. As in the $PK block, the<br>calling protocol phrase may use upper- or lower-case characters and must be enclosed in paren-<br>theses.<br>
Here are calling protocol phrases equivalent to the above three pseudo-statements, respectively.<br>
(CALL WITH EVERY EVENT RECORD)<br>
(CALL WITH OBSERVATION EVENTS)<br>
(CALL ONCE PER INDIVIDUAL RECORD)<br>
NM-TRAN automatically instructs PREDPP to limit calls to ERROR to once per <i>problem </i>for the<br>simple error models discussed in Chapter 8, Sections 3.1 and 3.2:<br>
<b>Y=F+ERR(1)</b><br>
<b>Y=F+F*ERR(1)</b><br>
<b>Y=F*(1+ERR(1))</b><br>
<b>Y=F*EXP(ERR(1))</b><br>
During the Simulation Step, PREDPP ignores any limitation and calls the ERROR subroutine<br>with every event record.<br>
Even when calls to PK and/or ERROR are limited, the CALL input data item can be used to force<br>additional calls for speciﬁc event records as needed.<br>
References: Users Guide VI (PREDPP) III.B.2, III.H, IV.C, V.J<br>References: Users Guide IV (NM-TRAN) V.C.5, C.6<br>
<b>2.8. Transgeneration of Input Data: the INFN Subroutine</b><br>
NONMEM may be used to modify the data records before any computations are performed and<br>also after all computations have been performed. This is referred to as transgeneration of the da-<br>ta. Transgeneration at the beginning of a problem can be used, for example, to change weight-<br>normalized doses to unnormalized doses. PREDPP allows the user to supply a subroutine called<br>INFN (&quot;initialization/ﬁnalization&quot;) in which transgeneration can be performed. (The PREDPP li-<br>brary includes a default INFN subroutine which does nothing.)<br>
References: Users Guide VI (PREDPP) VI.A<br>
<b>3. User-written PRED Subroutines</b><br>
It is not necessary to use PREDPP with NONMEM. Either $PRED statements or a user-written<br>PRED subroutine may be used in place of PREDPP to supply NONMEM with predicted values<br>for the DV data item according to some (not necessarily pharmacokinetic) model. An example<br>using $PRED statements is given here. A special caveat applies to user-written PRED subrou-<br>tines that are recursive: see 4.6 below.<br>
References: Users Guide I (Basic) C.2<br>
<b>3.1. Required Data Items</b><br>
The only required data items when PREDPP is not used are the NONMEM data items DV, MDV,<br>and ID. When PREDPP is used, the Data Preprocessor is able to recognize which records contain<br>observed values and which do not, and it supplies the MDV data item if it is not already present in<br>the data ﬁle. When PREDPP is not used, the Data Preprocessor cannot do this. The input data<br>ﬁle must already contain the MDV data item if it is needed, i.e., if the DV item of some data<br>record does not contain a value of an actual observation.<br>
-132-<br>
<hr>
<A name=141></a>Chapter 12 - Brief Descriptions of Other Features<br>
If $PRED statements are used, they must calculate a variable called Y, using input data items and<br>NONMEM’s θ , η, and (for population models) ε vectors in the calculation.<br>
References: Users Guide I (Basic) B.1<br>References: Users Guide IV (NM-TRAN) III.B.8<br>
<b>3.2. An Example of $PRED Statements: Pharmacodynamic Modeling</b><br>
The syntax of $PRED statements is essentially the same as discussed for $PK and $ERROR state-<br>ments. $PRED statements can be used for simple pharmacokinetic and pharmacodynamic mod-<br>els. In ﬁgure 12.1 above an example was given of pharmacodynamic modeling using $ERROR<br>statements. Suppose that in that example, drug concentration is always measured at the same<br>time as drug effect. Suppose too, that rather than input the individuals’ values of K and V and use<br>them to compute a predicted drug concentration for the individual, the observed drug concentra-<br>tion itself is used in the Emax model. This means that the the observed concentrations are again<br>incorporated into the data, but now as values of an independent variable, rather than as the DV<br>data item. This also means that a pharmacokinetic model is not needed, and therefore, PREDPP<br>is not needed either. Figure 12.2 shows the control stream for this new example.<br>
<b>$PROBLEM A SIMPLE PHARMACODYNAMIC MODEL<br>$INPUT ID TIME CP DV<br>$DATA EFFDATA<br>$PRED</b><br>
<b>EMAX=THETA(1)+ETA(1)<br>C50=THETA(2)+ETA(2)<br>E=EMAX*CP/(C50+CP)<br>Y=E+ERR(1)</b><br>
<b>$THETA 100 20<br>$OMEGA 400 16<br>$SIGMA 4<br>$ESTIMATION</b><br>
Figure 12.2. The input to NONMEM including $PRED statements for analysis of effect data.<br>
<b>4. Advanced Features of NONMEM</b><br>
<b>4.1. Full Covariance Matrices: $OMEGA BLOCK and $SIGMA BLOCK</b><br>
In the examples of Chapter 2 and 9, there appeared statements such as:<br>
<b>$OMEGA .0000055, .04</b><br>
This is an example of the speciﬁcation of initial parameter estimates for a variance-covariance Ω<br>matrix which is constrained to be <i>diagonal</i>. Initial estimates are given for the variances of η1 and<br>of η<br>
=<br>
2.<br>
The covariance between η1 and η2 is constrained to be 0, i.e., ω12<br>
<i>cov</i>(η1, η2) = 0.<br>
Another way of writing this statement is:<br>
<b>$OMEGA DIAGONAL(2)</b><br>
<b>.0000055, .04</b><br>
The option DIAGONAL(2) states explicitly that the block contains two ηs and that it has diago-<br>nal form.<br>
If the data supports the possibility that η1 and η2 covary with each other, it may be useful to<br>model Ω as being unconstrained and allow NONMEM to estimate the covariance. A special form<br>of the $OMEGA record is used, in which initial values are supplied for both variances and the<br>covariance. For example:<br>
<b>$OMEGA BLOCK(2)</b><br>
<b>.0000055, .0000001, .04</b><br>
The option BLOCK(2) states that there are two η variables in the block, and that covariance is to<br>be estimated. The new element is ω<br>
= ω =<br>
12<br>
21<br>
<i>cov</i>(η1, η2) = <i>cov</i>(η2, η1) = 1 × 10−7.<br>
-133-<br>
<hr>
<A name=142></a>Chapter 12 - Brief Descriptions of Other Features<br>
$OMEGA BLOCK is used for both population and individual studies, i.e., it is the same whether<br>
η is used in the ﬁrst case in a model for residual error or is used in the second case in a model for<br>
random interindividual error. In a population study, if there is more than one ε variable, and the<br>model allows these variables to covary, then $SIGMA BLOCK is used in a similar manner.<br>
The initial estimates of even more complicated Ω and Σ matrices may be given using multiple<br>$OMEGA and $SIGMA records. For example, the initial estimates of a mixture of correlated and<br>uncorrelated random variables may given. Also, in this context (as with the simple form of the<br>$OMEGA and $SIGMA records described in Chapter 9, Section 3) variances-covariances may be<br>constrained to ﬁxed values by means of the FIXED option. Finally, some variances-covariances<br>may be constrained to equal others by means of the BLOCK SAME option. The ability to ﬁx all<br>variances-covariances in both Ω and Σ allows Bayesian estimates to be obtained of the pharma-<br>cokinetic parameters of a single individual, based on the individual’s data and a prior population<br>distribution for the parameters.<br>
References: Users Guide IV (NM-TRAN) III.B.10<br>
<b>4.2. Grouping Related Observations: The L1 and L2 Data Items</b><br>
The $ERROR statements for a problem may sometimes involve more than one random variable.<br>For example, there may be two types of observations. One type may be an observation from one<br>compartment of a PK system, or with one assay or preparation, and another type may be an obser-<br>vation from a different compartment or with a different assay or preparation. The model for the<br>two types of observations would typically involve at least two ε variables (e.g. (3.8)). If all obser-<br>vations are made at sufﬁciently separated times, there may be little reason to be concerned about<br>correlation between the two random errors. However, if the two types of observations are taken at<br>the same or very close to the same time, it is possible that correlation will exist; whatever circum-<br>stance has inﬂuenced one observation to be different from the predicted level may also have some<br>inﬂuence on the other observation. In this case a covariance between the two ε variables should<br>be allowed, as described above in Section 4.1. Then the two types of observations at the same<br>time point are regarded as two elements of a multivariate observation.<br>
In the case of population data, there exists a NONMEM data item, L2, which is used to identify<br>the elements of a multivariate observation. In effect, L2 acts in a similar way as ID, but grouping<br>observations <i>within </i>individual records.<br>
In the case of individual data, the ID data item already serves this purpose: it forms groups of<br>observations whose η variables may be correlated. Thus, in the input data ﬁle, the ID data item<br>should be the same for those observations which may have correlated ηs. However, for individual<br>data, the Data Preprocessor normally replaces the ID data item with a new set of values which<br>describe every observation as being independent of the others. To prevent the Data Preprocessor<br>from doing this, L1 should be included in the $INPUT record as the name or synonym for the<br>user-supplied ID data item.<br>
References: Users Guide IV (NM-TRAN) II.C.4, III.B.2<br>References: Users Guide II (Supplemental) D.3<br>
<b>4.3. Continuing a NONMEM Run: MSFO and MSFI</b><br>
The MSFO (Model Speciﬁcation Output File) option of the $ESTIMATION record instructs<br>NONMEM to write a Model Speciﬁcation File (MSF). It is created when NONMEM writes the<br>ﬁrst iteration summary to the intermediate output ﬁle, and is re-written when every subsequent it-<br>eration summary is written. This ﬁle can then be read in a subsequent NONMEM run using a<br>$MSFI (Model Speciﬁcation File Input) record. This ﬁle has much of the information about the<br>model used in the previous run, thus the name &quot;Model Speciﬁcation File&quot;. It also contains all the<br>
-134-<br>
<hr>
<A name=143></a>Chapter 12 - Brief Descriptions of Other Features<br>
information that allows the Estimation Step from the previous run (which may have terminated,<br>for example, due to the number of function evaluations exceeding its limit or a computer crash or<br>some other externally-caused interruption of the NONMEM run) to be continued in the subse-<br>quent run. There are a number of beneﬁts to using a MSF. First, what might be a long Estimation<br>Step (due to a very lengthy search) can be split over a series of runs, each with a limited number<br>of function evaluations. Any run which terminates prematurely due to computer failure can be<br>restarted from the MSF output in the previous run. (This provides a &quot;checkpoint/restart&quot; capabili-<br>ty.) The progress made in the Estimation Step can also be evaluated between runs, and a decision<br>made as to whether it is worth continuing a search which is consuming excessive amounts of<br>computer time. Second, the Covariance, Tables, and Scatterplot Steps can be performed in later<br>runs, each using the MSF from the ﬁnal run with the Estimation Step. It is advisable to perform<br>the Covariance Step only after satisfactory results have been obtained from the Estimation Step.<br>
References: Users Guide I (Basic) C.4.4<br>References: Users Guide IV (NM-TRAN) III.B.6, B.12<br>
<b>4.4. NONMEM Can Obtain Initial Estimates for </b>θ <b>, </b>Ω<b>, </b>Σ<br>
NONMEM can be directed to obtain initial estimates for one or more elements of θ , Ω, or Σ.<br>This is done in a separate Initial Estimates Step. For an element of θ , omit the initial estimate but<br>include lower and upper bounds, e.g., (1, ,50) in the $THETA record. (The NUMBERPOINTS<br>option may be used to control the number of points in θ space examined by NONMEM during<br>the search for initial estimates of θ .) For a block of Ω or Σ, omit all initial estimates on the<br>$OMEGA BLOCK (or DIAGONAL) record, or $SIGMA BLOCK (or DIAGONAL) record,<br>respectively.<br>
Note that when $PK and $ERROR statements are present but the $OMEGA and/or $SIGMA<br>records are absent, NONMEM will be directed to obtain initial estimates for the variances of the<br>random variables in question, assuming the diagonal form of the matrix.<br>
References: Users Guide IV (NM-TRAN) III.B.9-11<br>
<b>4.5. Improving Parameter Estimates: REPEAT and RESCALE</b><br>
The Estimation Step can be immediately repeated after the search has terminated successfully, by<br>including the REPEAT option on the $ESTIMATION record. This can improve the accuracy of<br>the parameter estimates when one or more initial estimates are wrong by a few orders of magni-<br>tude. The ﬁnal estimates from the ﬁrst implementation of the Estimation Step are used as the ini-<br>tial estimates of the second implementation, and thus the scaling used with the STP is different<br>from that with the ﬁrst implementation, allowing fewer leading zeros after the decimal point in<br>the STP. When the Estimation Step is continued by means of a Model Speciﬁcation File, similar<br>rescaling can be requested using the RESCALE option of the $MSFI record.<br>
References: Users Guide IV (NM-TRAN) III.B.12, B.14<br>References: Users Guide II (Supplemental) F<br>
<b>4.6. The Covariance Step: R</b>−<b>1, S</b>−<b>1, Special Computation</b><br>
The Covariance Step, which computes standard errors of the parameter estimates, ﬁrst computes a<br>covariance matrix of the parameter estimates. (This is not the same as the Ω or Σ matrix). It is<br>possible to request that this covariance matrix be computed in one of three different ways: either<br>as <i>R</i>−1, <i>S</i>−1, or <i>R</i>−1<i>SR</i>−1 (the default), where <i>R </i>and <i>S </i>are two matrices from statistical theory, the<br>Hessian and Cross-Product Gradient matrices, respectively. Options MATRIX=R and MATRIX=S<br>of the $COVARIANCE record are used to request the <i>R</i>−1 and <i>S</i>−1 matrices, respectively. The<br>Covariance Step can produce additional output. When the default covariance matrix is used, <i>R</i>−1<br>
-135-<br>
<hr>
<A name=144></a>Chapter 12 - Brief Descriptions of Other Features<br>
and/or <i>S</i>−1 can be printed. This is requested by options PRINT=R and/or PRINT=S. Eigenval-<br>ues are be printed if requested by option PRINT=E. Multiple PRINT options can be speciﬁed.<br>
A special computation is <i>required </i>when the data are from a single individual and a recursive<br>PRED is used. A recursive PRED is one which stores the results of certain computations using<br>the values from one event record, and uses these results in later computations with the values<br>from a later event record. PREDPP advances the kinetic system from one time point to the next<br>and therefore is an example of a recursive PRED. When PREDPP is used and the data is from a<br>single individual, NM-TRAN automatically requests the special computation. When a recursive<br>user-written PRED is used and the data are from a single individual, the SPECIAL option of the<br>$COVARIANCE record <i>must </i>be used.<br>
The CONDITIONAL option of the $COVARIANCE record requests that the Covariance Step be<br>implemented only if Estimation Step terminates successfully, and is the default. The UNCONDI-<br>TIONAL option can be used to request that it be implemented no matter how the Estimation Step<br>terminates.<br>
References: Users Guide IV (NM-TRAN) III.B.15<br>References: Users Guide II (Supplemental) D.2.5<br>
<b>4.7. Multiple Problems in a Single NONMEM Run</b><br>
NONMEM can implement more than one problem in a single run. That is, the input control<br>stream can contain more than one $PROBLEM record, each followed by its own set of problem<br>speciﬁcation statements. This feature can be useful in a variety of situations. A series of what<br>otherwise would be separate runs, each analyzing a single individual’s data within a population<br>data ﬁle, can be performed conveniently without building separate data ﬁles for each individual.<br>Also, more than one data set can be analyzed using the same model and the same problem speciﬁ-<br>cation. Multiple problems are also useful with NONMEM’s Simulation Step, described below.<br>
Note that abbreviated code such as $PK and $ERROR statements cannot appear after the ﬁrst<br>problem. If the $DAT A record is omitted or the ﬁlename is speciﬁed as * on a $DAT A record in a<br>problem subsequent to the ﬁrst, the previous data set is re-used.<br>
A sequence of problems may be deﬁned to be a superproblem by means of the NM-TRAN $SU-<br>PER record, and NONMEM may also be directed to repeat them a speciﬁc number of times.<br>
References: Users Guide IV (NM-TRAN) III.B.1<br>
<b>4.8. Simulation Using NONMEM: The $SIMULATION Record</b><br>
The term simulation refers to the generation of data points according to some model. A simple<br>form of simulation is performed when the Estimation Step is omitted but the Table Step is imple-<br>mented. The PRED column of the table contains predictions based on the information in the data<br>records and the initial estimates of θ , under the model speciﬁed in the PRED (PREDPP) subrou-<br>tine. Random variables η and ε (if any) have no effect on the predictions and may be omitted. If<br>the only purpose of the run is to obtain simulated values, and these variables are present, it is best<br>(but not required) that their variances be ﬁxed to 0. NONMEM does not compute the objective<br>function in this circumstance, which has certain advantages.<br>
NONMEM can also perform a Simulation Step, in which another type of simulation is performed.<br>In the Simulation Step, each value of the DV data item of each record with MDV=0 is replaced by<br>a simulated observation generated from the model, but including statistical variability†. The<br>PRED (PREDPP) routine uses η and ε values that are supplied by NONMEM according to user-<br>
† During the Simulation Step, values of F computed by PRED or PREDPP for records having MDV=1 are irrel-<br>evant and are ignored by NONMEM.<br>
-136-<br>
<hr>
<A name=145></a>Chapter 12 - Brief Descriptions of Other Features<br>
speciﬁed random distributions (e.g., with variances given by the initial estimates of Ω and Σ). If<br>
Ω and Σ matrices are ﬁxed to zero, for example, the simulated values are the same as the predic-<br>tions described above.<br>
If the data are then displayed by the Table Step, the DV column for records with MDV=0 contains<br>the simulated observations obtained from the Simulation Step. For records having MDV=1, the<br>DV column contains whatever was in the original data record. The PRED column of the table<br>contains predictions as described above. If the Estimation Step was not implemented, the values<br>of θ used for these predictions are the initial values. If the Estimation Step was implemented, the<br>values of θ used for the predictions in the PRED column are the ﬁnal parameter estimates. Note<br>that the observations that are ﬁt during the search are the simulated values obtained by the Simu-<br>lation Step.<br>
Often data are simulated using the Simulation Step, then analyzed using one or more other steps<br>(e.g. Estimation and Covariance Steps), and this process is repeated a ﬁxed number of times,<br>using the same model. The Simulation Step accommodates this easily with the notion of a<br>NONMEM subproblem, whereby these steps are repeated within the same NONMEM problem.<br>However, on occasion it can be useful to have multiple problems (see Section 4.7), where one<br>problem implements the Simulation Step, and the subsequent problem implements other steps.<br>For example, this is one way to obtain different initial parameter estimates for the Estimation Step<br>than for the Simulation Step.<br>
The ONLYSIMULATION option causes NONMEM to suppress evaluation of the objective func-<br>tion. With this option, PRED-deﬁned variables displayed in tables and scatterplots (see Section<br>4.13) are simulated values, i.e., use simulated ηs and initial θ s, and weighted residual values in<br>tables and scatterplots are always 0.<br>
References: Users Guide IV (NM-TRAN) III.B.13<br>References: Users Guide VI (PREDPP) III.E.2, L.1 , IV.B.1-2, C, G.1<br>
<b>4.9. Files for Subsequent Processing: the $TABLE Record</b><br>
NONMEM can write the data for a table to an external formatted ﬁle, as requested by the FILE<br>option of the $TABLE record. Other computer programs can read these ﬁles. Such programs can<br>perform further analysis or provide improved graphical displays. These ﬁles normally contain<br>header lines similar to those in a printed table, but the header lines can be suppressed entirely or<br>in part by means of the NOHEADER or ONEHEADER options, respectively.<br>
Tables may be written to the same or to different table ﬁles.<br>
References: Users Guide IV (NM-TRAN) III.B.16<br>
<b>4.10. Data Checkout Mode</b><br>
NONMEM’s data checkout mode is intended for preliminary display of data without the use of a<br>model. In data checkout mode, the PRED routine is not called. Predictions, the objective func-<br>tion, residuals, and weighted residuals are not computed. Only the Table and Scatterplot Steps<br>can be implemented in the problem. With NM-TRAN, this mode is requested by coding the<br>option CHECKOUT on the $DAT A record. A $SUBROUTINES record and abbreviated code are<br>required, but they hav e no effect and need only be syntactically correct.<br>
References: Users Guide IV (NM-TRAN) III.B.6<br>
<b>4.11. Obtaining Individual Parameter Estimates - Conditional Estimates of </b>η<b>s</b><br>
With population data, NONMEM can obtain estimates of individual-speciﬁc true values of η from<br>any giv en set of values of θ , Ω, Σ, and the individual’s data. These are called conditional esti-<br>
-137-<br>
<hr>
<A name=146></a>Chapter 12 - Brief Descriptions of Other Features<br>
mates of η. When the conditional estimates are obtained after estimation is carried out by the<br>First-Order method, they are referred to as &quot;posthoc&quot; estimates. With NM-TRAN, they are re-<br>quested by the option POSTHOC on the $ESTIMATION record.<br>
References: Users Guide IV (NM-TRAN) III.B.14<br>
<b>4.12. Population Conditional Estimation Methods</b><br>
NONMEM can obtain conditional estimates of η variables as part of the computation of popula-<br>tion parameter estimates. These are called conditional estimation methods. With NM-TRAN,<br>such methods are requested by including the option METHOD=CONDITIONAL (or METHOD=1)<br>on the $ESTIMATION record. (The option METHOD=ZERO, or METHOD=0, requests the con-<br>ventional First-Order method and is the default.) There are two conditional estimation methods.<br>If NONMEM uses only ﬁrst-order approximations, this is the First-Order Conditional Estimation<br>Method. This has one variation, interaction, which takes into account η-ε interaction and is re-<br>quested by the additional option INTERACTION on the $ESTIMATION record. If NONMEM<br>uses a certain second-order approximation, this is the Laplacian method, which is requested by<br>the additional option LAPLACIAN on the $ESTIMATION record. Interaction cannot be speciﬁed<br>with the Laplacian method.<br>
Note that this usage of the term CONDITIONAL is different from the usage on the $SCATTER-<br>PLOT, $TABLE, and $COVARIANCE records, in which it refers to the circumstances under<br>which the step in question is implemented.<br>
References: Users Guide IV (NM-TRAN) III.B.14<br>
<b>4.13. Displaying PRED-Deﬁned Variables and Conditional Estimates of </b>η<b>s</b><br>
NONMEM can display PRED-deﬁned variables in table and scatterplots. With NM-TRAN, any<br>variable appearing on the left-hand side of an assignment statement in abbreviated code can be<br>displayed by listing it in a $TABLE or $SCATTER record. If the data are population, NONMEM<br>can also display conditional estimates of η. With NM-TRAN, variables ETA(1), ETA(2), etc.,<br>can be simply listed in $TABLE and $SCATTER records. When conditional estimation is not<br>performed, the values displayed are zero. Displayed values of PRED-deﬁned random variables<br>will use conditional estimates of η if they hav e been obtained, otherwise they will be typical val-<br>ues. This feature is available with PREDPP, as well as with user-written PRED routines. For<br>example, the following records could replace the $ESTIMATION record in Figure 12.2:<br>
<b>$ESTIMATION POSTHOC</b><br>
<b>$TABLE ETA(1) EMAX</b><br>
The $ABBREVIATED record can be used to limit the number of variables available for display<br>when the number is excessive.<br>
References: Guide III (Installation) V.2.4<br>References: Guide IV (NM-TRAN) III.B.16-17<br>References: Guide VI (PREDPP) III.J, IV.E<br>
<b>4.14. Mixture Models</b><br>
A mixture model is a model that explicitly assumes that the population consists of two or more<br>sub-populations, each having its own model. For example, with two sub-populations, one might<br>assume that some fraction p of the population has one set of typical values of the PK parameters,<br>and the remaining fraction 1-p has another set of typical values. Both sets of typical values and<br>the mixing fraction p may be estimated. For each individual, NONMEM also computes an esti-<br>mate of the number of the subpopulation of which the individual is a member. The user must<br>supply a FORTRAN subroutine called MIX or a $MIX block of abbreviated code to compute the<br>
-138-<br>
<hr>
<A name=147></a>Chapter 12 - Brief Descriptions of Other Features<br>
fractions p and 1-p.<br>
References: Users Guide VI (PREDPP) III.L.2<br>
<b>4.15. PRED Error Return Codes and Error Messages in File PRDERR</b><br>
A PRED routine can return a PRED error return code (1 or 2) to NONMEM, indicating that it is<br>unable to compute a prediction for a given data record with the current values of θ ’s and η’s. For<br>example, PREDPP returns error return code 1 when a basic or additional PK parameter has a val-<br>ue that is physically impossible (e.g., a scale parameter which is zero or negative). Error return<br>codes can also be speciﬁed by the user in user-written code or in abbreviated code using the EXIT<br>statement. One reason for doing this is to constrain parameters in order to avoid ﬂoating point<br>machine interrupts. The PRED error recovery option determines what action NONMEM will<br>take. With NM-TRAN, the PRED error recovery option is either ABORT (which is the default) or<br>NOABORT, and is speciﬁed on the $ESTIMATION and $THETA records.<br>
If an error return code is returned during the Simulation, Covariance, Table or Scatterplot Step, or<br>during computation of the initial value of the objective function, NONMEM will abort. If the<br>error return code is returned during the Estimation or Initial Estimates Step, NONMEM will try<br>to avoid those values of θ and η for which the error occurs. If they cannot be avoided, NON-<br>MEM’s actions depend on the error return code value, as follows:<br>
1<br>
If NOABORT is speciﬁed on $ESTIM or $THETA, try to avoid the current values of θ and<br>
η. If ABORT is speciﬁed on $ESTIM or $THETA, then abort.<br>
2<br>
Abort in all cases.<br>
PRED routines may optionally provide text accompanying the error return code. NONMEM<br>writes all text associated with error return codes to a ﬁle, PRDERR. The contents of this ﬁle<br>should always be carefully reviewed.<br>
References: Users Guide III (Installation) III.2.1.1<br>References: Users Guide IV (NM-TRAN) IV.A, IV.C.5-6<br>References: Users Guide VI (PREDPP) III.K, IV.F<br>
<b>4.16. User-Written Subroutines</b><br>
Although most NONMEM applications can be accomplished using NM-TRAN abbreviated code,<br>there are cases in which user-written FORTRAN subroutines are needed. The $SUBROUTINES<br>record allows the user to specify the names of user-written routines that are needed in the NON-<br>MEM load module. A user may choose to write his own PRED, PK, ERROR, MODEL, DES, or<br>AES subroutine. Some subroutines that are distributed with NONMEM are dummy, or &quot;stub&quot;<br>routines, that do nothing. Of these, subroutines CCONTR, CONPAR, CONTR, and CRIT can be<br>replaced to obtain an objective function different from the default. NONMEM subroutine MIX<br>must be replaced for mixture models. PREDPP subroutine INFN may be replaced by user-writ-<br>ten code. The names of all such routines are speciﬁed using the identically named options of the<br>$SUBROUTINES record, e.g., PRED=subname, CONTR=subname, etc. User-written routines<br>may call other FORTRAN subroutines, which can be speciﬁed for inclusion in the load module<br>using the option OTHER=subname.<br>
With user-written CONTR routines, the NM-TRAN $CONTR record may be useful.<br>
References: Users Guide IV (NM-TRAN) III.B.4, B.6<br>
<b>4.17. PRIOR</b><br>
The PRIOR subroutine and $PRIOR record allows a Bayesian penalty function to be added to<br>the NONMEM objective function. This serves as a constraint on the estimates of THETA,<br>
-139-<br>
<hr>
<A name=148></a>Chapter 12 - Brief Descriptions of Other Features<br>
OMEGA, and SIGMA and thus as a way for stable estimates to be obtained with insufﬁcient<br>data.<br>
References: Introduction to NONMEM Version VI<br>
<b>5. Observations of Two Different Types</b><br>
An NM-TRAN control stream is shown in Figure 12.3, for the analysis of a data set which con-<br>tains observations of two different types. A fragment of the data set, shown in Figure 12.4, con-<br>tains the data for one individual. This example illustrates how concentration and effect data can<br>be ﬁt simultaneously, and includes many of the advanced features described in this chapter, such<br>as pharmacodynamic modeling in the $ERROR statements, correlation between elements of Σ,<br>and the L2 data item.<br>
Suppose that the data set for the phenobarbital example of Chapter 2 is modiﬁed to include both<br>concentration and effect observations, and that a data item called TYPE is used to distinguish<br>between them. When TYPE is 1, DV contains an effect measurement. When TYPE is 2, DV<br>contains a concentration. The $PK statements are the same as those of Figure 2.12. The<br>$ERROR statements are the same as those of Figure 12.1, except that the elements of θ and η are<br>renumbered to follow those used in the $PK statements. The (random) variable Y1 is assigned<br>the same value as Y in the $ERROR statements of Figure 12.1 The (random) variable Y2 is<br>assigned the same value as Y in the $ERROR statements of Figure 2.12, except that ε 2 is used<br>rather than ε 1.<br>The input data ﬁle contains observations of both types which were made at the same time value.<br>The event records therefore include the L2 data item. Figure 12.4, like Figure 2.7, shows the data<br>for the ﬁrst individual, but includes TYPE and L2 data items and effect observations. Note that<br>the L2 data item has a different value for each multivariate observation within the individual<br>record. (The values 1 and 2 are chosen arbitrarily and may be re-used for the L2 data items in the<br>next individual’s data, if desired.)<br>
The $THETA, $OMEGA, and $SIGMA records contain the values shown in Figures 2.12 and<br>12.1 and one other value, 2.8, for the covariance Σ<br>
=<br>
12<br>
<i>cov</i>(ε 1, ε2). The estimate 2.8 is chosen so<br>
1<br>
1<br>
that the correlation is, arbitrarily, .5 (2. 8 = Σ<br>
=<br>
Σ 2<br>
2<br>
12<br>
(Σ11 22) <i>corr </i>= (8 × 4) . 5).<br>
-140-<br>
<hr>
<A name=149></a>Chapter 12 - Brief Descriptions of Other Features<br>
<b>$PROBLEM COMBINED PK/PD MODEL<br>$INPUT ID TIME AMT WT APGR DV TYPE L2<br>$DATA COMBDATA<br>$SUBROUTINE ADVAN1<br>$PK</b><br>
<b>TVCL=THETA(1)+THETA(3)*WT<br>CL=TVCL+ETA(1)<br>TVVD=THETA(2)+THETA(4)*WT<br>V=TVVD+ETA(2)</b><br>
<b>; THE FOLLOWING ARE REQUIRED BY PREDPP</b><br>
<b>K=CL/V<br>S1=V</b><br>
<b>$ERROR</b><br>
<b>EMAX=THETA(5)+ETA(3)<br>C50=THETA(6)+ETA(4)<br>E=EMAX*F/(C50+F)<br>Y1=E+ERR(1)<br>Y2=F+ERR(2)<br>Q=1<br>IF (TYPE.EQ.2) Q=0<br>Y=Q*Y1+(1-Q)*Y2</b><br>
<b>$THETA (0,.0027) (0,.70) .0018 .5 100 20<br>$OMEGA .000007 .3 400 16<br>$SIGMA BLOCK(2) 4 2.8 8<br>$ESTIMATION</b><br>
Figure 12.3. The input to NONMEM-PREDPP for analysis of the population phenobarbital data, including both con-<br>centration and effect observations.<br>
<b>1</b><br>
<b>0.</b><br>
<b>25.0 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>0</b><br>
<b>1</b><br>
<b>2.0 .</b><br>
<b>1.4 7</b><br>
<b>6.0 1 1</b><br>
<b>1</b><br>
<b>2.0 .</b><br>
<b>1.4 7</b><br>
<b>17.3 2 1</b><br>
<b>1</b><br>
<b>12.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>0</b><br>
<b>1</b><br>
<b>24.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>1</b><br>
<b>1</b><br>
<b>37.0 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>0</b><br>
<b>1</b><br>
<b>48.0 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>1</b><br>
<b>1</b><br>
<b>60.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>0</b><br>
<b>1</b><br>
<b>72.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>1</b><br>
<b>1</b><br>
<b>85.3 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>0</b><br>
<b>1</b><br>
<b>96.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>1</b><br>
<b>1</b><br>
<b>108.5 3.5 1.4</b><br>
<b>7</b><br>
<b>.</b><br>
<b>2</b><br>
<b>0</b><br>
<b>1</b><br>
<b>112.5 .</b><br>
<b>1.4 7</b><br>
<b>8.0 1 2</b><br>
<b>1</b><br>
<b>112.5 .</b><br>
<b>1.4 7</b><br>
<b>31.0 2 2</b><br>
Figure 12.4. The ﬁrst individual’s phenobarbital data, including both concentration and effect<br>observations.<br>
The above $ERROR statements can be coded more simply.<br>
<b>$ERROR</b><br>
<b>EMAX=THETA(5)+ETA(3)<br>C50=THETA(6)+ETA(4)<br>E=EMAX*F/(C50+F)<br>IF (TYPE.EQ.2) THEN<br>Y=F+ERR(2)<br>ELSE<br>Y=E+ERR(1)<br>ENDIF</b><br>
Figure 12.5. Alternate $ERROR statements<br>
-141-<br>
<hr>
<A name=150></a>Chapter 12 - Brief Descriptions of Other Features<br>
<b>6. NONMEM 7</b><br>
With NONMEM 7 there are many new features, including new Estimation Methods. A descrip-<br>tion is beyond the scope of this guide.<br>
References: Introduction to NONMEM 7<br>
-142-<br>
<hr>
<A name=151></a><b>Chapter 13 - Errors in NONMEM Runs</b><br>
<b>1. What This Chapter is About</b><br>
This chapter describes error messages that can appear in NONMEM’s output and discusses some<br>possible causes and remedies. It is not encyclopedic; only selected messages are discussed. NM-<br>TRAN messages are meant to be self-explanatory, as are many PREDPP messages, and important<br>NONMEM messages are documented in NONMEM Users Guide, Part I, Chapter G. Unlike cer-<br>tain other regression programs, NONMEM-PREDPP will not try to mask what is perceived as a<br>real problem and to which attention must be given by the user before the computation can pro-<br>ceed; an error message results and often, the program terminates.<br>
The Estimation and Covariance Steps do not always terminate successfully. This is a normal part<br>of the process of model building.<br>
<b>2. Abnormal Termination of the Estimation Step</b><br>
Normal termination of the Estimation Step is indicated by the message:<br>
<b>MINIMIZATION SUCCESSFUL</b><br>
Even when this message is seen, it is possible that the Estimation Step has not run correctly.<br>Final estimates should be different from initial estimates. If the initial and ﬁnal estimates are the<br>same and the gradients for a parameter are zero at every iteration†, this is a sign of a modelling<br>error. The parameter does not affect any predictions, as discussed in Chapter 7, Section 4.2. If<br>there were bounds, estimates should be well away from the bounds. A ﬁnal estimate which is<br>close to a bound is discussed in Chapter 11, Section 4.3.<br>
Abnormal termination of the Estimation Step is indicated by a message whose ﬁrst line is:<br>
<b>MINIMIZATION TERMINATED</b><br>
One of several messages will follow, indicating the type of failure. The messages are listed in<br>Users Guide I.<br>
Tw o of the most common are discussed here separately.<br>
<b>2.1. &quot;DUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED&quot;</b><br>
If after any iteration the total number of evaluations of the objective function (Chapter 10, ﬁgure<br>10.5, line 33) is equal to or greater than the maximum allowed (Chapter 10, ﬁgure 10.2, line 51),<br>the minimization search is halted with this message. If the $ESTIMATION record requested that<br>a Model Speciﬁcation File be written, it is possible to continue the search from this point in a sub-<br>sequent NONMEM run. In Chapter 12, Section 4.3, a strategy is discussed by which the number<br>of function evaluations is deliberately set to a low value in order to structure a lengthy run as a<br>series of shorter runs.<br>
Whenever this message is obtained, it is important to examine the intermediate output and evalu-<br>ate the progress made so far. A poorly-speciﬁed model, for example, may cause very slow con-<br>vergence of the minimization search. Raising the maximum number of function evaluations<br>(using the MAXEVAL option of the $ESTIMATION record) may not be advisable.<br>
<b>2.2. &quot;DUE TO ROUNDING ERRORS (ERROR=134)&quot;</b><br>
This message will be accompanied in the intermediate output by a message beginning: NUM-<br>SIGDIG: .... which gives the approximate number of signiﬁcant digits obtained in each of the<br>
† A   gradient may reach zero at or near the ﬁnal iteration; this is not an error. Note also that no gradient is com-<br>puted or printed for a parameter whose value is ﬁxed, so if a gradient is always zero, it is not for this reason.<br>
-143-<br>
<hr>
<A name=152></a>Chapter 13 - Errors in NONMEM Runs<br>
parameters being estimated. At least one such number will be less than the number requested.<br>
The number of signiﬁcant digits obtained should be examined. If it is at least 2, and the gradient<br>vector appears stable throughout the last few iterations, a satisfactory minimum may well have<br>been obtained. (It may be desirable to re-run the problem with the print interval for iteration sum-<br>marization set to 1 (PRINT=1 in the $ESTIMATION record) so that the progress made at every<br>iteration can be examined.) The ﬁnal parameter estimates should be examined, and if they appear<br>reasonable, they might be accepted. Although the user may have requested more than 2 signiﬁ-<br>cant digits, the data may only support about 2 digits, given the precision of the arithmetic being<br>used. By examining the gradients carefully, it is often possible to obtain further information<br>about which parameter estimates are less-well determined.<br>
Even though the ﬁnal parameter estimates may be adequate, it is unlikely that the minimum is<br>sufﬁciently well-determined to allow the Covariance Step to run successfully, at least with the<br>number of signiﬁcant ﬁgures requested in the Estimation Step. The Estimation Step may need to<br>be rerun, requesting only 2 signiﬁcant ﬁgures, followed by the Covariance Step.<br>
If the number of signiﬁcant digits is less than 2 (or even neg ative), then the ﬁnal estimates should<br>not be trusted. The problem may be model misspeciﬁcation or insufﬁcient data.<br>
Model misspeciﬁcation is a very general problem involving some mismatch between the model<br>and the data. This can result in particularly large values of the objective function or slow conver-<br>gence of the minimization search. Sometimes the model is overparameterized. This means that<br>the model has more parameters than can be well-enough estimated from the data (e.g., a biexpo-<br>nential model is ﬁt to monoexponential data). When model misspeciﬁcation occurs due to over-<br>parameterization, then the Estimation Step will usually proceed smoothly, but terminate with<br>fewer than 2 signiﬁcant digits. It is best to start with simple models (see Chapter 11).<br>
A related problem arises when a covariance element, e.g., Ω12 (or Σ12), is being estimated. If the<br>ID (or L2 data item) is not used correctly, it may appear as though the covariance does not affect<br>objective function values, and then this parameter will not be well estimated. In other words, it<br>may appear as though the model is overparameterized due to the inclusion of this parameter. See<br>Chapter 12, Section 4.2.<br>
<b>3. Abnormal Termination of the Covariance Step</b><br>
It is possible for the Estimation Step to terminate successfully, and yet the Covariance Step gener-<br>ates an error message. Error messages from the Covariance Step are printed immediately after<br>line 46 of Figure 10.5. The messages are listed in Users Guide I.<br>
When a message arises, often it is:<br>
<b>R MATRIX ALGORITHMICALLY NON-POSITIVE-SEMIDEFINITE</b><br>
<b>BUT NONSINGULAR</b><br>
<b>COVARIANCE STEP ABORTED</b><br>
In order for the minimization routine to terminate successfully, it needs to determine that the ﬁnal<br>gradient vector is sufﬁciently small, which is a necessary condition for a minimum to have been<br>achieved. This condition, however, is not sufﬁcient. A sufﬁcient condition, that the R matrix be<br>positive deﬁnite (and therefore, that the apparent minimum not be a saddle point) is only checked<br>in the Covariance Step. The message means that the sufﬁcient condition appears not to be satis-<br>ﬁed. The ﬁnal estimate is, therefore, in doubt.<br>
Sometimes the message is:<br>
<b>R MATRIX ALGORITHMICALLY SINGULAR</b><br>
<b>COVARIANCE STEP UNOBTAINABLE</b><br>
<b>S MATRIX ALGORITHMICALLY SINGULAR</b><br>
-144-<br>
<hr>
<A name=153></a>Chapter 13 - Errors in NONMEM Runs<br>
This arises when there exists a parameter whose values do not actually affect the predictions and<br>whose gradient in the intermediate output is always 0.<br>
In general, successful completion of the Covariance Step requires a better deﬁned minimum than<br>does the successful completion of the Estimation Step.<br>
<b>4. Miscellaneous Problems</b><br>
This section discusses a few simple errors which prevent NONMEM-PREDPP from running suc-<br>cessfully.<br>
<b>4.1. Proportional Error Model</b><br>
A common error is to use the proportional error model while some predicted values for actual<br>observations are zero or close to zero. (For example, if the ﬁrst dose is an infusion and there is a<br>&quot;baseline&quot; observation at the start of the infusion, the predicted level will be zero.)<br>
With individual data this will lead to an error message similar to the following (the individual<br>number may be different from 1):<br>
PROGRAM TERMINATED BY OBJ, ERROR IN ELS<br>
WITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)<br>
VAR-COV OF DAT A FROM INDIVIDUAL RECORD ESTIMATED TO BE SINGULAR<br>
With population data this will lead to an error message similar to the following (the individual<br>and record numbers may be different than 1):<br>
PROGRAM TERMINATED BY OBJ, ERROR IN CELS<br>
WITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)<br>
INTRAINDIVIDUAL VARIANCE OF DAT A FROM OBS RECORD 1 ESTIMATED TO BE 0<br>
<b>4.2. Errors in the Pharmacokinetic Model</b><br>
When using a new model, a run should done in which the Estimation Step is not run, and a scat-<br>terplot of PRED vs DV with unit slope line is produced, to verify that the model and the initial<br>parameter estimates are reasonable. It is much harder to diagnose errors in the model or the ini-<br>tial estimates after the Estimation Step fails. Make sure that the initial value of the objective<br>function is not excessively large, and that the unit slope line shows on the plot: scaling errors can<br>easily go undetected! E.g., if the units are incorrect at some point in the model (L vs ml), the pre-<br>dictions may be wrong by a factor of 1000. Similarly, if no scale was speciﬁed for the compart-<br>ment being observed, the predictions for the observations are compartment amounts rather than<br>concentrations. In both cases, the shape of the PRED vs DV plot may appear linear, but the axes<br>may be labeled quite differently. When observations from two different compartments are present<br>in the data (e.g., <i>C p </i>and <i>Cu</i>), some of the observations may be scaled incorrectly. This is dis-<br>cussed in Chapter 6, Section 9, and Chapter 7, Section 4.3.3.<br>
<b>5. Errors with PREDPP</b><br>
<b>5.1. Error Messages from a TRANS Routine</b><br>
TRANS routines can produce error messages. Here is one from TRANS2:<br>ERROR IN TRANS2 ROUTINE: V IS ZERO<br>Appendix 2 shows that TRANS2 normally computes K=CL/V. The routine checks that V is not<br>zero, and upon ﬁnding that it is, it prints the informative message, and terminates the run (thus<br>avoiding a machine &quot;division by zero&quot; interrupt by the operating system). This error usually<br>occurs with the initial parameter estimates. E.g., suppose the relevant $PK statement is:<br>
-145-<br>
<hr>
<A name=154></a>Chapter 13 - Errors in NONMEM Runs<br>
<b>V=THETA(1)+WT*THETA(2)</b><br>
For some values of θ 1, θ2, and WT, a value of zero is being computed for V. The initial estimates<br>of θ 1 and θ2 should be checked. The intercept θ1 might have been ﬁxed to zero, in which case<br>then, the values of WT should also be checked. If WT is recorded only on the ﬁrst event record<br>of each individual’s data, careful coding is required to insure that a value of zero is not used when<br>the $PK record is evaluated with subsequent event records.<br>
<b>5.2. Error Messages from ADVAN Routines</b><br>
A similar error message can be generated in PREDPP, e.g.<br>PK PARAMETER FOR OBSERVA TION COMPARTMENT’S SCALE IS ZERO<br>Some scale parameter is modeled in such a way as to produce a zero. Again, the code for that<br>scale parameter, and the initial estimates for the θ ’s used therein, should be checked. Perhaps the<br>scale parameter is being set equal to a volume parameter, and as described above, the volume<br>parameter is being set to zero. When TRANS1 is used, the volume parameter is neither recog-<br>nized nor checked.<br>
<b>5.3. Numeric difﬁculties in PREDPP</b><br>
Numeric difﬁculties can occur with linear pharmacokinetic models (e.g., ADVAN1-4) in the<br>process of computing certain exponentials. They can occur from an error in the units of either a<br>rate constant and/or the TIME data items. They can also occur from inordinately large values for<br>a rate constant which arise during the minimization search. This might be avoided by placing<br>appropriate constraints on θ ’s.<br>
They can also occur when the system is advanced over an excessively long period of time. This<br>can happen within an individual record, when the individual had a course of drug treatment, fol-<br>lowed by a wash-out period, followed by another course of drug treatment. The ﬁrst dose record<br>of treatment courses other than the ﬁrst should have EVID data item equal to 4 (reset-dose) rather<br>than 1 (dose), to avoid computing excessively small compartment amounts (see Chapter 6, Sec-<br>tion 7.3), and to reduce computational cost.<br>
Difﬁculties can occur in the process of computing predictions with ADVAN2 and ADVAN4 when<br>values of KA and K arise during the minimization search that are very close to one another. The<br>models encoded into the ADVAN routines assume that KA and K have fairly distinct values, and<br>the formulas for the predictions have the term KA-K in the denominator. If, for example, the typ-<br>ical values of K and KA are associated with θ 1 and θ2, respectively, then one might try reparame-<br>terizing. The typical values of K and KA-K can be associated with θ 1 and θ2, so that <i>˜</i><br>
<i>K </i>= θ 1 and<br>
<i>˜</i><br>
<i>KA </i>= <i>˜</i><br>
<i>K </i>+ θ 2. A lower bound of zero should be placed on θ2†.<br>
A similar situation occurs with TRANS3, where VSS-V occurs in the denominator of the expres-<br>sion for K21. As above, reparameterization and a constraint on an element of θ may help.<br>
† This technique also prevents a &quot;ﬂip-ﬂop&quot; from occurring. (In the original parameterization, the ﬁnal estimates<br>of θ 1 and θ 2 can be the ﬁnal estimates of the typical values of KA and K, respectively).<br>
-146-<br>
<hr>
<A name=155></a><b>Appendix 1 - Standard Pharmacokinetic Models and Parameters</b><br>
ADVAN<br>
Compartments Basic and additional PK parameters<br>
ADVAN1 1 = Central K<br>
Rate constant of elimination<br>
2 = Output S1<br>
Scale for central compartment<br>
S2 Scale for output compartment<br>F1 Bioavailability for central compartment<br>F0 Output Fraction<br>
ADVAN2 1 = Depot KA<br>
Absorption rate constant<br>
2 = Central K<br>
Rate constant of elimination<br>
3 = Output S1<br>
Scale for depot compartment<br>
S2 Scale for central compartment<br>S3 Scale for output compartment<br>F1 Bioavailability for depot compartment<br>F2 Bioavailability for central compartment<br>F0 Output Fraction<br>
ADVAN3 1 = Central K<br>
Rate constant of elimination<br>
2 = Peripheral K12<br>
Rate constant from central to peripheral<br>
3 = Output K21<br>
Rate constant from peripheral to central<br>
S1 Scale for central compartment<br>S2 Scale for peripheral compartment<br>S3 Scale for output compartment<br>F1 Bioavailability for central compartment<br>F2 Bioavailability for peripheral compartment<br>F0 Output Fraction<br>
ADVAN4 1 = Depot KA<br>
Absorption rate constant<br>
2 = Central K<br>
Rate constant of elimination<br>
3 = Peripheral K23<br>
Rate constant from central to peripheral<br>
4 = Output K32<br>
Rate constant from peripheral to central<br>
S1 Scale for depot compartment<br>S2 Scale for central compartment<br>S3 Scale for peripheral compartment<br>S4 Scale for output compartment<br>F1 Bioavailability for depot compartment<br>F2 Bioavailability for central compartment<br>F3 Bioavailability for peripheral compartment<br>F0 Output Fraction<br>
ADVAN10 1 = Central VM<br>
Maximum Rate<br>
2 = Output KM<br>
Michaelis Constant<br>
S1 Scale for central compartment<br>S2 Scale for output compartment<br>F1 Bioavailability for central compartment<br>F0 Output Fraction<br>
-147-<br>
<hr>
<A name=156></a>Appendix 1 - Standard Pharmacokinetic Models and Parameters&quot;<br>
ADVAN<br>
Compartments Basic and additional PK parameters<br>
ADVAN11 1 = Central K<br>
Rate constant of elimination<br>
2 = Peripheral 1<br>
K12 Rate constant from central to periph. 1<br>
3 = Peripheral 2<br>
K21 Rate constant from periph. 1 to central<br>
4 = Output K13<br>
Rate constant from central to periph. 2<br>
K31 Rate constant from periph. 2 to central<br>
S1 Scale for central compartment<br>S2 Scale for peripheral 1 compartment<br>S3 Scale for peripheral 2 compartment<br>S4 Scale for output compartment<br>F1 Bioavailability for central compartment<br>F2 Bioavailability for periph. 1 compartment<br>F3 Bioavailability for periph. 2 compartment<br>F0 Output Fraction<br>
ADVAN12 1 = Depot KA<br>
Absorption rate constant<br>
2 = Central K<br>
Rate constant of elimination<br>
3 = Peripheral 1<br>
K23 Rate constant from central to periph. 1<br>
4 = Peripheral 2<br>
K32 Rate constant from periph. 1 to central<br>
5 = Output K24<br>
Rate constant from central to periph. 2<br>
K42 Rate constant from periph. 2 to central<br>
S1 Scale for depot compartment<br>S2 Scale for central compartment<br>S3 Scale for peripheral 1 compartment<br>S4 Scale for peripheral 2 compartment<br>S5 Scale for output compartment<br>F1 Bioavailability for depot compartment<br>F2 Bioavailability for central compartment<br>F3 Bioavailability for periph. 1 compartment<br>F4 Bioavailability for periph. 2 compartment<br>F0 Output Fraction<br>
-148-<br>
<hr>
<A name=157></a><b>Appendix 2 - Alternative Parameterizations</b><br>
Alternative Parameters Reparameterization Lines<br>
<b>ADVAN1 TRANS2</b><br>
CL<br>
Clearance<br>
K=CL/V<br>
V<br>
Volume of distribution<br>
<b>ADVAN2 TRANS2</b><br>
CL<br>
Clearance<br>
K=CL/V<br>
V<br>
Volume of distribution<br>
KA=KA<br>
KA<br>
Absorption rate<br>
<b>ADVAN3 TRANS3</b><br>
CL<br>
Clearance<br>
K=CL/V<br>
V<br>
Central Volume<br>
K12=Q/V<br>
Q<br>
Intercompartmental clearance<br>
K21=Q/(VSS-V)<br>
VSS<br>
Volume of distribution at steady state<br>
<b>ADVAN3 TRANS4</b><br>
CL<br>
Clearance<br>
K=CL/V1<br>
V1<br>
Central volume<br>
K12=Q/V1<br>
Q<br>
Intercompartmental clearance<br>
K21=Q/V2<br>
V2<br>
Peripheral volume<br>
<b>ADVAN3 TRANS5</b><br>
AOB<br>
A/B<br>
K21=(AOB*BETA+ALPHA)/(AOB+1)<br>
ALPHA<br>
alpha<br>
K=ALPHA*BETA/K21<br>
BETA<br>
beta<br>
K12=ALPHA+BETA-K21-K<br>
<b>ADVAN3 TRANS6</b><br>
ALPHA<br>
alpha<br>
K=ALPHA*BETA/K21<br>
BETA<br>
beta<br>
K12=ALPHA+BETA-K21-K<br>
K21<br>
Rate constant from periph. to central<br>
K21=K21<br>
<b>ADVAN4 TRANS3</b><br>
CL<br>
Clearance<br>
K=CL/V<br>
V<br>
Central Volume<br>
K23=Q/V<br>
Q<br>
Intercompartmental clearance<br>
K32=Q/(VSS-V)<br>
VSS<br>
Volume of distribution at steady state<br>
KA=KA<br>
KA<br>
Absorption rate<br>
<b>ADVAN4 TRANS4</b><br>
CL<br>
Clearance<br>
K=CL/V2<br>
V2<br>
Central volume<br>
K23=Q/V2<br>
Q<br>
Intercompartmental clearance<br>
K32=Q/V3<br>
V3<br>
Peripheral volume<br>
KA=KA<br>
KA<br>
Absorption rate<br>
-149-<br>
<hr>
<A name=158></a>Appendix 2 - Alternative Parameterizations&quot;<br>
<b>ADVAN4 TRANS5</b><br>
AOB<br>
A/B<br>
K32=(AOB*BETA+ALPHA)/(AOB+1)<br>
ALPHA<br>
alpha<br>
K=ALPHA*BETA/K32<br>
BETA<br>
beta<br>
K23=ALPHA+BETA-K32-K<br>
KA<br>
Absorption rate<br>
KA=KA<br>
<b>ADVAN4 TRANS6</b><br>
ALPHA<br>
alpha<br>
K=ALPHA*BETA/K32<br>
BETA<br>
beta<br>
K23=ALPHA+BETA-K32-K<br>
K32<br>
Rate constant from periph. to central<br>
K32=K32<br>
KA<br>
Absorption rate<br>
KA=KA<br>
<b>ADVAN11 TRANS4</b><br>
CL<br>
Clearance<br>
K=CL/V1<br>
V1<br>
Central volume<br>
K12=Q2/V1<br>
Q2<br>
Intercompartmental clearance 1<br>
K21=Q2/V2<br>
V2<br>
Peripheral volume 1<br>
K13=Q3/V1<br>
Q3<br>
Intercompartmental clearance 2<br>
K31=Q3/V3<br>
V3<br>
Peripheral volume 2<br>
V3=V3<br>
<b>ADVAN11 TRANS6</b><br>
ALPHA<br>
alpha<br>
K=ALPHA*BETA*GAMMA/(K21*K31)<br>
BETA<br>
beta<br>
V1=ALPHA+BETA+GAMMA<br>
GAMMA<br>
gamma<br>
V2=ALPHA*BETA+ALPHA*GAMMA<br>
K21<br>
Rate constant from periph. 1 to central<br>
+BETA*GAMMA<br>
K31<br>
Rate constant from periph. 2 to central<br>
K13=(V2+K31*K31-K31*V1-K*K21)/(K21-K31)<br>
K12=V1-K-K13-K21-K31<br>
<b>ADVAN12 TRANS4</b><br>
CL<br>
Clearance<br>
K=CL/V2<br>
V2<br>
Central volume<br>
K23=Q3/V2<br>
Q3<br>
Intercompartmental clearance 1<br>
K32=Q3/V3<br>
V3<br>
Peripheral volume 1<br>
K24=Q4/V2<br>
Q4<br>
Intercompartmental clearance 2<br>
K42=Q4/V4<br>
V4<br>
Peripheral volume 2<br>
V4=V4<br>
KA<br>
Absorption rate<br>
KA=KA<br>
<b>ADVAN12 TRANS6</b><br>
ALPHA<br>
alpha<br>
K=ALPHA*BETA*GAMMA/(K32*K42)<br>
BETA<br>
beta<br>
V2=ALPHA+BETA+GAMMA<br>
GAMMA<br>
gamma<br>
V3=ALPHA*BETA+ALPHA*GAMMA<br>
K32<br>
Rate constant from periph. 1 to central<br>
+BETA*GAMMA<br>
K42<br>
Rate constant from periph. 2 to central<br>
K24=(V3+K42*K42-K42*V2-K*K32)/(K32-K42)<br>
K23=V2-K-K24-K32-K42<br>
KA<br>
Absorption rate<br>
KA=KA<br>
-150-<br>
<hr>
<A name=159></a><b>Appendix 3 - NM-TRAN Control Records</b><br>
The following is an alphabetic list of NM-TRAN control records.<br>
See Guide VIII, On-line Help, or On-line HTML for the options and for more information.<br>
<b>$ABBREVIATED</b><br>
<b>$AES</b><br>
<b>$AESINIT</b><br>
<b>$BIND</b><br>
<b>$CHAIN</b><br>
<b>$CONTR</b><br>
<b>$COVARIANCE</b><br>
<b>$DATA</b><br>
<b>$DES</b><br>
<b>$ERROR</b><br>
<b>$ESTIMATION</b><br>
<b>$INDEX</b><br>
<b>$INFN</b><br>
<b>$INPUT</b><br>
<b>$MIX</b><br>
<b>$MODEL</b><br>
<b>$MSFI</b><br>
<b>$NONPARAMETRIC</b><br>
<b>$OMEGA</b><br>
<b>$OMIT</b><br>
<b>$PK</b><br>
<b>$PRED</b><br>
<b>$PRIOR</b><br>
<b>$PROBLEM</b><br>
<b>$SCATTER</b><br>
<b>$SIGMA</b><br>
<b>$SIMULATION</b><br>
<b>$SIZES</b><br>
<b>$SUBROUTINES</b><br>
<b>$SUPER</b><br>
<b>$TABLE</b><br>
<b>$THETA</b><br>
<b>$TOL</b><br>
<b>$WARNING</b><br>
-151-<br>
<hr>
<A name=160></a>/home/bauerr/DOCS.dir/makeindex2_home/index.head<br>
<b>INDEX</b><br>
2000 52<br>
CI 43, 125<br>CL, clearance 12, 23<br>clearance CL 12, 23<br>clock time 55, 63, 66<br>
<b>- A -</b><br>
CMT data item 55, 68<br>coefﬁcient of variation 26<br>
α -level test 47<br>
colon &quot;:&quot; in II data item 66<br>
abbreviated code 5, 9<br>
colon &quot;:&quot; in TIME data item 63<br>
$ABBREVIATED record 138<br>
command, operating system 4<br>
ABORT 139<br>
compartment, central 8, 68<br>
absorption, ﬁrst-order 7<br>
compartment 8<br>
Absorption lag parameter 130<br>
compartment, default dose 8, 68-69<br>
absorption rate KA 9<br>
compartment, depot 8, 58, 69<br>
additional dose 71<br>
compartment, dose 56-57<br>
additional PK parameter 53, 69<br>
compartment, equilibrium 129<br>
additive error model 25, 36, 40, 81, 86<br>
compartment number 55, 68, 89<br>
ADDL data item 130<br>
compartment, output 24, 56, 58, 62, 69<br>
ADVAN13 129<br>
compartment, prediction 56<br>
ADVAN1 12<br>
compartment, zero-out a 69<br>
ADVAN2 8<br>
concentration 22<br>
ADVAN5-9 129<br>
concentration, plasma 7, 24, 29, 34<br>
ADVAN 4, 68<br>
concentration, urine 24, 29, 34, 37, 62<br>
advance 34, 68, 71<br>
concomitant data 53<br>
$AES record 129<br>
conditional estimate 137<br>
AES subroutine 128<br>
conditional estimation method 138<br>
ALAGn 130<br>
conditional estimation method, ﬁrst-order 138<br>
AMT data item 55-56<br>
CONDITIONAL option of $COVARIANCE record 136<br>
ANSI FORTRAN 3<br>
CONDITIONAL option of $SCATTERPLOT record 88<br>
assay 28<br>
CONDITIONAL option of $TABLE record 88<br>
assay, bias of 24<br>
conditional statement 74<br>conﬁdence interval 43-44, 125<br>CONPAR subroutine 139<br>constant coefﬁcient of variation (CCV) error model 26, 36,<br>40, 81, 86<br>
<b>- B -</b><br>
constant infusion 60<br>
basic PK parameter 53, 69<br>
constraint, parameter 9, 83, 110<br>
bias of assay 24<br>
control language, NONMEM 5<br>
bias of estimate 42<br>
$CONTR record 139<br>
$BIND record 131<br>
CONTR subroutine 139<br>
bioavailability 57-60, 69, 75<br>
correlation 35<br>
BLOCK option of $OMEGA record 133<br>
correlation matrix of estimate 88, 97<br>
BLOCK option of $SIGMA record 133<br>
correlation of parameter estimate 44<br>
bolus dose, instantaneous 57<br>
correlation of residual vs y 113<br>
bolus dose, multiple 58<br>
covariance 35, 84, 133<br>
bolus dose, zero-order 130<br>
covariance matrix 35, 37, 98-99<br>covariance matrix, full 133<br>covariance matrix of estimate 88<br>$COVARIANCE record 9, 83, 87-88, 93, 97<br>covariance step 87-88, 97, 143<br>
<b>- C -</b><br>
CRIT subroutine 139<br>
calendar date 64<br>CALL data item 56, 71, 80, 132<br>calling protocol phrase 131-132<br>call to ERROR subroutine 56, 131<br>
<b>- D -</b><br>
call to PK subroutine 56, 131<br>CCONTR subroutine 139<br>
DAT1,DAT2,DAT3 data item 64<br>
CCV error model 26, 36, 40, 81, 86<br>
data checkout 92, 137<br>
central compartment 8, 68<br>
data, effect 128, 140<br>
CHECKOUT option of $DAT A record 137<br>
data ﬁle name 51<br>
checkpoint-restart 135<br>
data, individual 7, 22, 66<br>
chi-square 47<br>
data item 7, 28, 49<br>
-152-<br>
<hr>
<A name=161></a>data item, dropping 54, 64, 67<br>
error message, TRANSLATOR 145<br>
data item label 53<br>
error model, additive 25, 36, 40, 81, 86<br>
data item, null 49<br>
error model, CCV 26, 36, 40, 81, 86<br>
data items, maximum number of 50, 54<br>
error model, constant coefﬁcient of variation (CCV) 26, 36,<br>
data item, steady-state 57<br>
40, 81, 86<br>
data, population 54, 85<br>
error model 24, 80, 86<br>
Data Preprocessor 63<br>
error model, exponential 27, 36, 81<br>
data record 49<br>
error model, log-normal 27, 36, 81<br>
$DAT A record 51, 63, 93, 136<br>
error model, power function 28, 41, 81<br>
data set 49<br>
error model, proportional 26, 36<br>
data set, deleting records from 49-50<br>
error model, statistical 22<br>
data set, sequence of 49, 51<br>
error, MSE mean squared 42<br>
data set, size of 49<br>
$ERROR record 5, 13, 53, 140<br>
data, single-response population 22<br>
$ERROR record 80, 82<br>
date, calendar 64<br>
error recovery option 139<br>
DATE data item 64<br>
error return code 139<br>
days 52, 65<br>
ERROR subroutine, call to 56, 131<br>
day-time translation 63, 66<br>
ERROR subroutine 4-5, 53, 69, 128<br>
default dose compartment 8, 68-69<br>
error variance 14, 24-25<br>
degrees of freedom 47<br>
ERR variable 24, 80, 85<br>
deleting records from data set 49-50<br>
estimate, bias of 42<br>
dependent variable 7-8, 22<br>
estimate, conditional 137<br>
depot compartment 8, 58, 69<br>
estimate, initial 9, 128<br>
$DES record 129<br>
estimate of ETA, individual 137<br>
DES subroutine 128<br>
estimate of theta, initial 83<br>
diagonal elements of OMEGA 35<br>
estimate of variance, initial 86, 135, 140<br>
DIAGONAL option of $OMEGA record 133<br>
estimate, perturbed initial 84<br>
DIAGONAL option of $SIGMA record 133<br>
estimation error 42<br>
diagonal variance-covariance matrix 84, 133<br>
estimation method, ﬁrst-order conditional with interaction<br>
distribution of parameter estimate 43<br>
138<br>
dose, additional 71<br>
estimation method, ﬁrst-order 138<br>
dose amount 56<br>
estimation method, laplacian 138<br>
dose compartment, default 8, 68-69<br>
$ESTIMATION record 9, 83, 87, 93<br>
dose compartment 56-57<br>
estimation step 87, 97, 135, 143<br>
dose event record 55-56<br>
η 24<br>
dose, implied 58<br>
ETA, individual estimate of 137<br>
dose, infusion 58<br>
ETA variable 13, 24, 80, 85<br>
dose, instantaneous bolus 57<br>
ev ent record, dose 55-56<br>
dose, lagged 71<br>
ev ent record 55<br>
dose, multiple bolus 58<br>
ev ent record, observation 54-55, 80<br>
dose, multiple 11<br>
ev ent record, other 55-56, 71<br>
dose-related data item 56<br>
ev ent record, reset-dose 55<br>
doses, multiple steady-state 61<br>
ev ent record, reset 55<br>
dose, steady-state 58<br>
EVID data item 55, 63<br>
dose, zero-order bolus 130<br>
EVID data item, generated 66<br>
DROP option of $INPUT record 54, 64, 67, 92<br>
exception, ﬂoating-point 139<br>
dropping data item 54, 64, 67<br>
EXIT statement 139<br>
drug level 59<br>
experiment, replication of 42<br>
duration, modeled 130<br>
exponential error model 27, 36, 81<br>
duration of infusion 58<br>
extended least squares ELS 41<br>
DV data item 7, 54-55<br>
external table ﬁle 137<br>
<b>- E -</b><br>
<b>- F -</b><br>
effect data 128, 140<br>
F distribution 47<br>
eigenvalue 129, 136<br>
ﬁlename option of $DAT A record 51<br>
elimination rate K 9, 23<br>
FILE option of $TABLE record 137<br>
ELS, extended least squares 41<br>
ﬁnal parameter estimate 87<br>
Emax model 128<br>
FINISH record 51<br>
end of infusion 58<br>
ﬁrst-order absorption 7<br>
ε 31<br>
ﬁrst-order conditional estimation method 138<br>
EPS variable 80, 85<br>
ﬁrst-order conditional with interaction estimation method 138<br>
equilibrium compartment 129<br>
ﬁrst-order estimation method 138<br>
error, estimation 42<br>
ﬁxed effects 22, 53<br>
error, interindividual 35<br>
ﬁxed effects parameter 22, 31<br>
error, intraindividual 24, 35<br>
FIXED option of $OMEGA record 85, 95, 134<br>
error message, operating system 52<br>
FIXED option of $SIGMA record 85, 95, 134<br>
error message, PREDPP 146<br>
FIXED option of $THETA record 84, 95<br>
-153-<br>
<hr>
<A name=162></a>ﬂip-ﬂop 146<br>
initial estimate 9, 128<br>
ﬂoating-point exception 139<br>
initial estimate of theta 83<br>
FOCE method 87<br>
initial estimate of variance 86, 135, 140<br>
FO method 87<br>
initial estimate, perturbed 84<br>
format speciﬁcation 49, 51, 63, 67<br>
initial estimate step 84, 86, 135<br>
FORTRAN 5, 49<br>
initialization/ﬁnalization 132<br>
FORTRAN OPEN statement 51<br>
initial parameter estimate 135<br>
FORTRAN READ statement 52<br>
$INPUT record 53, 57, 92<br>
fraction, output 69, 76<br>
installation of NONMEM 2-3<br>
FROM option of $SCATTERPLOT record 100<br>
instantaneous bolus dose 57<br>
FSUBS 5<br>
INTERACTION method 87<br>
full covariance matrix 133<br>
INTERACTION option of $ESTIMATION record 138<br>
full model 46, 114<br>
interdose interval 57, 66, 130<br>
function of parameters 41<br>
interindividual error 35<br>interindividual variability 35<br>interrupt 139<br>intraindividual error 24, 35<br>
<b>- G -</b><br>
intraindividual variability 24, 35<br>inverse covariance matrix of estimate 88<br>
general mixed effects model 37<br>
I_SS 129<br>
generated EVID data item 66<br>
iteration 96, 143<br>
generated ID data item 66<br>generated MDV data item 66<br>generated subroutine 5<br>GG array 94<br>
<b>- J -</b><br>
goodness of ﬁt 9, 46, 114<br>gradient 96, 143<br>
joint hypotheses 46<br>
<b>- H -</b><br>
<b>- K -</b><br>
half-life 41, 44<br>
KA, absorption rate 9<br>
hierarchical ﬁle 50<br>
K, elimination rate 9, 23<br>
hours 52, 65<br>hyperbolic model 33<br>hypotheses, joint 46<br>hypothesis, null 45<br>
<b>- L -</b><br>
hypothesis test 18, 45, 101<br>
L1 data item 134<br>L2 data item 134, 140, 144<br>labels, reserved 53<br>
<b>- I -</b><br>
lagged dose 71<br>laplacian estimation method 138<br>
ID data item, generated 66<br>
LAPLACIAN option of $ESTIMATION record 138<br>
ID data item 50, 54, 134, 144<br>
LAST20 option of $DAT A record 52<br>
identiﬁcation number, patient 50<br>
least squares criterion 40<br>
IGNORE option of $DAT A record 52<br>
least squares ELS, extended 41<br>
II/24 52<br>
least squares OLS, ordinary 40<br>
II data item, colon &quot;:&quot; in 66<br>
least squares WLS, weighted 40<br>
II data item 55, 57, 66, 130<br>
likelihood ratio test 46, 127<br>
implied dose 58<br>
linear model 32<br>
INCLUDE record 89<br>
linear system 61<br>
index plot 103, 112<br>
link editing 4<br>
indicator variable 28, 33, 74, 77, 81-82<br>
load module 4<br>
individual data 7, 22, 66<br>
log likelihood 46, 115<br>
individual estimate of ETA 137<br>
log-normal error model 27, 36, 81<br>
individual parameter estimate 137<br>
lower triangular elements of OMEGA 35<br>
individual record 54<br>
LRECL option of $DAT A record 52<br>
inﬁnite infusion 60<br>INFINITY 83, 93<br>INFN subroutine 132<br>infusion, constant 60<br>
<b>- M -</b><br>
infusion dose 58<br>infusion, duration of 58<br>
mass balance 69<br>
infusion, end of 58<br>
MATRIX option of $COVARIANCE record 135<br>
infusion, inﬁnite 60<br>
MAXEVAL option of $ESTIMATION record 87, 143<br>
infusion, multiple 59<br>
maximum number of data items 50, 54<br>
infusion, rate of 57<br>
maximum number of observation records 54<br>
Initial condition 129<br>
MDV data item, generated 66<br>
-154-<br>
<hr>
<A name=163></a>MDV data item 54, 132<br>
null value of parameter 124-125<br>
mean squared error, MSE 42<br>
number of signiﬁcant digits 93<br>
METHOD option of $ESTIMATION record 87, 138<br>
NUMBERPOINTS option of $THETA record 135<br>
Michaelis-Menten model 33, 68<br>microconstant 69<br>minimal model 108<br>minimum value of objective function 9, 46, 87, 96-97<br>
<b>- O -</b><br>
mixed effects model, general 37<br>mixed effects model 25, 30<br>
objective function, minimum value of 9, 46, 87, 96-97<br>
$MIX record 138<br>
objective function 41, 87, 115<br>
MIX subroutine 128, 138-139<br>
observation event record 54-55, 80<br>
mixture model 138-139<br>
observation records, maximum number of 54<br>
model building 101<br>
observed value 4, 54-55, 86<br>
modeled duration 130<br>
OLS, ordinary least squares 40<br>
modeled rate 130<br>
OMEGA, diagonal elements of 35<br>
model, Emax 128<br>
ˆ<br>
ω 40<br>
model, full 46, 114<br>
OMEGA, lower triangular elements of 35<br>
model, general mixed effects 37<br>
Ω 35, 84<br>
model, linear 32<br>
OMEGA 9, 25, 35<br>
model, Michaelis-Menten 33, 68<br>
$OMEGA record 9, 13, 84-85, 93, 133<br>
model, minimal 108<br>
one-compartment model 7, 12, 22<br>
model misspeciﬁcation 97<br>
ONEHEADER option of $TABLE record 137<br>
model, mixed effects 25, 30<br>
ONLYSIMULATION option of $SIMULATION record 137<br>
model, mixture 138-139<br>
on/off status 55-56, 63, 75<br>
model, multiplicative 32, 77<br>
operating system command 4<br>
model, one-compartment 7, 12, 22<br>
operating system error message 52<br>
model, parameter 31<br>
ORD0 option of $SCATTERPLOT record 89<br>
model, pharmacodynamic 128, 133, 140<br>
ordinary least squares OLS 40<br>
model, pharmacokinetic 2, 68, 129<br>
other event record 55-56, 71<br>
model, population 31<br>
OTHER option of $SUBROUTINE record 139<br>
model, random effects 122<br>
outlier 104<br>
$MODEL record 129<br>
output compartment 24, 56, 58, 62, 69<br>
model, reduced 46, 114<br>
output fraction 69, 76<br>
model speciﬁcation ﬁle 88, 134-135<br>model, statistical 121-122<br>model, structural 22, 34, 93, 108<br>MODEL subroutine 128<br>model, user-deﬁned 129<br>
<b>- P -</b><br>
monitoring of search 87<br>
parameter, Absorption lag 130<br>
MSE mean squared error 42<br>
parameter, additional PK 53, 69<br>
$MSFI record 88, 134<br>
parameter, basic PK 53, 69<br>
MSFO option of $ESTIMATION record 134, 143<br>
parameter constraint 9, 83, 110<br>
MTIME 130<br>
parameter estimate, correlation of 44<br>
multiple bolus dose 58<br>
parameter estimate, distribution of 43<br>
multiple dose 11<br>
parameter estimate, ﬁnal 87<br>
multiple infusion 59<br>
parameter estimate, individual 137<br>
multiple steady-state doses 61<br>
parameter estimate, initial 135<br>
multiplicative model 32, 77<br>
parameter estimate 40<br>
multivariate observation 134<br>
parameter estimate, precision of 42, 88, 124, 126<br>parameter, ﬁxed effects 22, 31<br>parameterization 23, 42, 45, 69, 72<br>parameter model 31<br>
<b>- N -</b><br>
parameter, null value of 124-125<br>parameter, PK 9, 68<br>
negative objective function 41<br>
parameter, random effects 25, 122<br>
nested if 70<br>
parameter, scale 9, 23, 68, 73<br>
nested parentheses 70<br>
parameters, function of 41<br>
nmfe72 4<br>
parameter, time varying 34<br>
nmfe 4<br>
partial derivative 5<br>
NM-TRAN deﬁned 1<br>
partitioned scatterplot 89, 100<br>
NOABORT 139<br>
patient identiﬁcation number 50<br>
NOHEADER option of $TABLE record 137<br>
PCMT data item 55, 68<br>
NONMEM7 142<br>
perturbed initial estimate 84<br>
NONMEM control language 5<br>
pharmacodynamic model 128, 133, 140<br>
NONMEM 1<br>
pharmacokinetic model 2, 68, 129<br>
NOREWIND 51<br>
phenobarbital example 11, 23, 85-86, 101, 128, 141<br>
null data item 49<br>
φ 22<br>
null hypothesis 45<br>
PK parameter, additional 53, 69<br>
NULL option of $DAT A record 52<br>
PK parameter, basic 53, 69<br>
null value 45<br>
PK parameter 9, 68<br>
-155-<br>
<hr>
<A name=164></a>$PK record 5, 9, 53, 68<br>
$SCATTERPLOT record 83, 88, 93<br>
PK subroutine, call to 56, 131<br>
scatterplot 10, 50, 56-58, 88<br>
PK subroutine 4-5, 53, 69, 128<br>
scatterplot step 100<br>
plasma concentration 7, 24, 29, 34<br>
sdf 53<br>
plot, index 103, 112<br>
sequence of data set 49, 51<br>
population data 54, 85<br>
SE (standard error) 42<br>
population data, single-response 22<br>
SIGDIGITS option of $ESTIMATION record 87<br>
population model 31<br>
ˆ<br>
σ 40<br>
POSTHOC option of $ESTIMATION record 137<br>
$SIGMA record 13, 83-85, 93, 133<br>
power function error model 28, 41, 81<br>
SIGMA 14, 31<br>
PRDERR 139<br>
Σ 31, 84<br>
precision of parameter estimate 42, 88, 124, 126<br>
signiﬁcant digits, number of 93<br>
PRED error recovery option 139<br>
$SIMULATION record 136<br>
PRED error return code 139<br>
simulation step 95, 136<br>
predicted value 4, 55<br>
single-response population data 22<br>
predicted value PRED 10, 88<br>
size of data set 49<br>
prediction compartment 56<br>
sizes 53<br>
PREDPP error message 146<br>
SPECIAL option of $COVARIANCE record 136<br>
PREDPP library 4<br>
SS data item 55, 57<br>
PREDPP 1, 68<br>
S−1 covariance matrix 135<br>
PRED, predicted value 10, 88<br>
standard deviation 26, 86, 111<br>
$PRED record 5, 93<br>
standard error of estimate 88<br>
PRED subroutine 1, 68, 93, 128, 132<br>
standard error 7, 9, 42-43, 97, 125, 135<br>
PRED subroutine, recursive 34, 136<br>
standard error vs. standard deviation 43<br>
PRINT option of $COVARIANCE record 135<br>
statistical error model 22<br>
PRINT option of $ESTIMATION record 87, 144<br>
statistical model 121-122<br>
$PROBLEM record 7, 92, 136<br>
steady-state data item 57<br>
proportional error model 26, 36<br>
steady-state doses, multiple 61<br>
p-value 127<br>
steady-state dose 58<br>steady-state level 59-60, 62<br>steady-state 130<br>structural model 22, 34, 93, 108<br>
<b>- R -</b><br>
SUBPROBLEM option of $SIMULATION record 136<br>subroutine, generated 5<br>
random effects model 122<br>
$SUBROUTINE record 129<br>
random effects parameter 25, 122<br>
$SUBROUTINE record 68, 70, 93<br>
random effects 25, 31, 76<br>
$SUBOUTINES record 139<br>
random variable 5, 70, 77, 80<br>
subroutine, user-supplied 5<br>
random variable 78<br>
subroutine, user-written 139<br>
RATE data item 55, 57<br>
sum of squares 9, 40<br>
rate, modeled 130<br>
superposition 61<br>
rate of infusion 57<br>
superproblem 136<br>
record length 52<br>
$SUPER record 136<br>
RECORDS option of $DAT A record 51<br>
synonym 53<br>
recovery option, error 139<br>
system, linear 61<br>
recursive PRED subroutine 34, 136<br>reduced model 46, 114<br>relative time 55, 63<br>REPEAT option of $ESTIMATION record 135<br>replication of experiment 42<br>
<b>- T -</b><br>
RESCALE option of $MSFI record 135<br>
table ﬁle, external 137<br>
reserved labels 53<br>
$TABLE record 83, 88, 93<br>
reset-dose event record 55<br>
table step 99<br>
reset event record 55<br>
table 56-58, 88<br>
residual error 24, 31<br>
theophylline example 7<br>
residual RES 15, 88, 111<br>
ˆ<br>
θ<br>
residual vs y, correlation of 113<br>
40<br>
RES, residual 15, 88, 111<br>
theta, initial estimate of 83<br>
return code, error 139<br>
$THETA record 9, 83, 93<br>
REWIND 51<br>
THETA 9, 70<br>
R−1<br>
TIME/24 52, 65<br>
covariance matrix 135<br>
TIME data item, colon &quot;:&quot; in 63<br>TIME data item 54<br>time, relative 55, 63<br>time varying parameter 34<br>
<b>- S -</b><br>
TOL option of $SUBROUTINE record 129<br>$TOL record 129<br>
SAME option of $SIGMA record 134<br>
TO option of $SCATTERPLOT record 100<br>
saturation model 33, 77<br>
TRANS1 69<br>
scale parameter 9, 23, 68, 73<br>
transgeneration 132<br>
scatterplot, partitioned 89, 100<br>
TRANSLATE option of $DAT A record 52, 65<br>
-156-<br>
<hr>
<A name=165></a>translation 23, 69, 94<br>
zero-out a compartment 69<br>
TRANSLATOR error message 145<br>TRANSLATOR warning message 4<br>TRANS 4, 23, 69<br>true-value variable 78<br>typical value 35, 76, 86<br>
<b>- U -</b><br>
UNCONDITIONAL option of $COVARIANCE record 136<br>UNCONDITIONAL option of $SCATTERPLOT record 88<br>UNCONDITIONAL option of $TABLE record 88<br>unexplained variability 115, 122<br>UNIT option of $SCATTERPLOT record 89<br>unit slope line 10, 89<br>units 23, 73<br>urine collection 29, 62<br>urine concentration 24, 29, 34, 37, 62<br>urine volume 24, 29, 62<br>user-deﬁned model 129<br>user-supplied subroutine 5<br>user-written subroutine 139<br>
<b>- V -</b><br>
value, null 45<br>value, observed 4, 54-55, 86<br>value, predicted 4, 55<br>value, typical 35, 76, 86<br>variability, interindividual 35<br>variability, intraindividual 24, 35<br>variability, unexplained 115, 122<br>variable, dependent 7-8, 22<br>variable, indicator 28, 33, 74, 77, 81-82<br>variable, random 5, 70, 77, 80<br>variance-covariance matrix, diagonal 84, 133<br>variance-covariance matrix 41<br>variance 9, 35<br>volume of distribution V 7, 23-24<br>V, volume of distribution 7, 23-24<br>
<b>- W -</b><br>
warning message, TRANSLATOR 4<br>weighted least squares WLS 40<br>weighted residual 88<br>weighted residual WRES 88, 111, 113<br>WIDE option of $DAT A record 52<br>WLS, weighted least squares 40<br>WRES, weighted residual 88, 111, 113<br>
<b>- Y -</b><br>
year 2000 52<br>
˜y 40<br>
y 22<br>
<b>- Z -</b><br>
zero-order bolus dose 130<br>
<hr>
</BODY>
</HTML>
