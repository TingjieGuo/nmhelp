<!-- Creator     : groff version 1.21 -->
<!-- CreationDate: Sun Jul 24 01:30:24 2011 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<a href="#1. What This Chapter is AboutThis chapter introduces a computer program called NONMEM.It also introduces two programs that are distributed withNONMEM and make it easier to use: PREDPP and NM-TRAN. Thescope of this text itself is described, and suggestions aremade for reading it. A somewhat detailed technicaldescription of the components of NONMEM is then given. Thefinal section is a list of additional references.2. Introducing NONMEM2.1. What is NONMEM?NONMEM stands for &quot;Nonlinear Mixed Effects Model.&quot; NONMEMis a computer program, written in FORTRAN 90/95, designed tofit general statistical (nonlinear) regression-type modelsto data.NONMEM was developed by the NONMEM Project Group at theUniversity of California at San Francisco for analyzingpopulation pharmacokinetic data in particular.&dagger;<cite>&dagger; NONMEM versions up through VI are the property of the &#9474;Regents of the University of California, but ICON &#9474;Development Solutions has exclusive rights to license their &#9474;use. NONMEM 7 is the current version of the software and is &#9474;the property of ICON Development Solutions. </cite>These are data typically collected from clinical studies ofpharmaceutic agents, involving the administration of a drugto individuals and the subsequent observation of drug levels(most often in the blood plasma). Proper modeling of thesedata involves accounting for both unexplainable inter- andintra-subject effects (random effects), as well as measuredconcomitant effects (fixed effects). NONMEM allows thismixed effect modeling. Such modeling is especially usefulwhen there are only a few pharmacokinetic measurements fromeach individual sampled in the population, or when the datacollection design varies considerably between theseindividuals. However, NONMEM is a general program which canbe used to fit models to a wide variety of data.Like many nonlinear regression programs, NONMEM does nothave any &quot;built in&quot; models (such as the linear model) withwhich it can compute a predicted value given the currentvalues of the regression parameters. Instead, NONMEM callsa subroutine having entry name PRED (&quot;prediction&quot;) to obtaina predicted value. PRED also must compute for NONMEMpartial derivatives with respect to certain randomvariables. Depending on the model and the kinds of doses,PRED may be very simple or may be very complicated. A usercan write his own PRED subroutine. This can be as simple orcomplicated as is necessary, and may involve calls to itsown subprograms.2.2. What is PREDPP?PREDPP stands for &quot;PRED for Population Pharmacokinetics&quot;.It is a PRED subroutine for use with NONMEM and is thesecond major component distributed with NONMEM. WhereasNONMEM is a general nonlinear regression tool, PREDPP isspecialized to the kinds of predictions which arise inpharmacokinetic data analysis. It can compute predictionsaccording to many different pharmacokinetic models,according to a great variety of dosing regimens. Almost allthe examples in this guide use PREDPP.2.3. What is NM-TRAN?NM-TRAN stands for &quot;NONMEM Translator&quot;. It is the thirdmajor component distributed with NONMEM. It is a separate,&quot;stand-alone&quot; control language translator and datapreprocessor. When NM-TRAN is used, a NONMEM run includestwo separate steps: first the NM-TRAN step, in which a fileof NM-TRAN records (which begin with &quot;$&quot;) are translatedinto several NONMEM input files, and second the NONMEM stepitself. All the examples in this guide use NM-TRAN. Westrongly recommend its use.Note that neither NM-TRAN nor NONMEM-PREDPP runinteractively. Files of commands and data are created bymeans of (say) the operating system editor. Then NM-TRANand NONMEM are executed, using these files as input. Figure1.1 shows the relationship between NONMEM, PREDPP, andNM-TRAN.Fig 1.1. NONMEM, PREDPP, and NM-TRAN. A user-written PREDsubroutine could be included instead of PREDPP.2.4. Scope of this Introductory GuideThis Guide is intended to be read by new users ofNONMEM-PREDPP. Typically, such users have pharmacokineticdata, either from a population or from a single individual,to be fit to a standard pharmacokinetic model (e.g., a oneor two compartment linear mammillary model). However, newusers with nonstandard models, or withpharmacokinetic/pharmacodynamic data, may also find thisguide helpful.It is assumed that NONMEM and its components are alreadyinstalled on the user&rsquo;s computer and that the user wants tolearn to use them as quickly as possible. This guide doesnot tell how to perform the installation or how to run aninstalled NONMEM under a particular operating system; thenew user will have to ask experienced users what the localcommands are. However, someone who is installing NONMEM ata new site may find it useful to review this guide to get aquick overview of NONMEM, its component programs, itsinputs, and its outputs.This guide is not a text book in pharmacokinetics orstatistics. Readers should be familiar with basic conceptsin pharmacokinetics and statistical data analysis. We alsoassume a very basic familiarity with FORTRAN.2.5. Contents of this Introductory GuideChapter 2 contains two examples of the use of NONMEM. Thefirst presents data from a single individual; estimates areobtained of his pharmacokinetic parameters. The secondpresents data from a group of individuals; estimates areobtained of the pharmacokinetic parameters of the populationwhich this group represents. The examples serve tointroduce NONMEM notation, input and output, and to providean idea of what is possible using the system.Chapter 3 presents the notation and definitions we will useto discuss models for individual data. The relationship ofthese models to data is discussed, and the distinctionbetween so-called fixed effects and random effects is made.Chapter 4 extends this discussion to models for populationdata.Chapter 5 discusses NONMEM&rsquo;s fitting criterion, theparameter estimates obtained by using this criterion, andthe standard errors of these estimates. It then discusseshow to do hypothesis tests with NONMEM.Chapter 6 tells how to create data files for NONMEM-PREDPPand how to describe them using the $DATA and $INPUT recordsof NM-TRAN. It also discusses the Data Preprocessor featureof NM-TRAN.Chapter 7 tells how to use NM-TRAN to write simple$SUBROUTINE records for PREDPP, how to write $PK records forindividual data, and how to write $PK records for populationdata.Chapter 8 tells how to write simple $ERROR records forPREDPP. Chapters 7 and 8 are meant to be read in parallelwith Chapters 3 and 4.Chapter 9 tells how to use NM-TRAN to specify the remainingchoices for an analysis. It tells how to assign initialvalues to parameters ($THETA, $OMEGA, $SIGMA records), howto specify what analysis tasks to perform ($ESTIMATION,$COVARIANCE records), and how to specify certain additionaloutput ($TABLE, $SCATTERPLOT records).Chapter 10 describes NONMEM&rsquo;s output in detail.Chapter 11 outlines the process of model building, showinghow a simple model can be made more complex to better fitthe data.Chapter 12 briefly describes a variety of features of PREDPPand NONMEM that are somewhat advanced for this text but areof interest to most users of NONMEM. References are givento other documents in which additional information can befound.Chapter 13 discusses errors that can occur during a NONMEMrun.Appendix 1 describes PREDPP&rsquo;s most commonly usedpharmacokinetic models (ADVAN subroutines).Appendix 2 describes alternative parameterizations (TRANSsubroutines) for these models.Appendix 3 is a list of NM-TRAN records. &#9474;2.6. How to Read this GuideReaders who are completely new to NONMEM should read thisguide starting with Chapter 2; the examples presented areused again in the later chapters. Chapters 2-5 aretheoretical in nature. Chapters 6-12 describe the detailsof building the input for NONMEM-PREDPP and interpreting theoutput. Readers who have non-pharmacokinetic data to fitcan skip (or skim) Chapters 3, 4, 7, and 8. Readers whoalready have some familiarity with certain topics (e.g., whohave used other nonlinear analysis programs to analyze data)can concentrate on the chapters of interest to them. Intime, readers who are comfortable with NONMEM may be able towork entirely from Appendix 3. We strongly recommend thatsuch users &quot;graduate&quot; to the more thorough NONMEMdocumentation listed in Section 4 of this chapter.Throughout the guide, examples are given of NM-TRAN records.These examples appear in boldface:$THETA .01Examples are also given of (fragments) of input data files.They appear as follows:ID AMT TIME DV2 320. 0. 0.2 0. .27 1.71Alphabetic characters such as ID, AMT, etc., are shown fordescriptive purposes. They are not part of the actual datafile.3. A Brief Technical OverviewIn this section we discuss the components of NONMEM in somedetail. First-time readers may prefer to skip this sectionand go directly to Chapter 2, which gives an example of aNONMEM run, and return to this section later (if at all).3.1. NONMEMNONMEM is written (almost) entirely in ANSI FORTRAN 90/95. &#9474;It is distributed on CD-ROM as FORTRAN source code, some of &#9474;which is encrypted. It can be compiled and run on anycomputer which has a FORTRAN 90/95 compiler and sufficientmemory and speed to run a large, computationally intensiveprogram.NONMEM consists of a main program and many subroutines, allof which are required for each NONMEM run. As discussedabove, one subroutine, PRED, is not included in NONMEMitself.3.2. PREDPP and the PREDPP LibraryPREDPP is not a single subroutine. It is a collection ofFORTRAN subroutines. Some of these are always needed butmust be supplied by the user himself (see PK and ERRORbelow). Others are always needed and are supplied; theseare called the kernel routines. Others (subroutines ADVANand TRANS, for example) are also always needed, and aresupplied, but are chosen from different versionscorresponding to different pharmacokinetic models. Thecollection of supplied routines constitutes the PREDPPLibrary.3.3. Subroutines PK and ERRORTwo very important subroutines of PREDPP are called PK andERROR. PK computes the values of the population orindividual pharmacokinetic parameters (e.g., CL and V) of agiven model and accounts for the &quot;differences&quot; betweenindividual and population values. ERROR accounts for the&quot;differences&quot; between predicted and observed values. Thesetwo subroutines are where the basic task of modelling iscarried out; this task is the user&rsquo;s responsibility.Chapters 7 and 8 are devoted to a description of thesesubroutines.Figure 1.2 shows the major components of PREDPP.Figure 1.2. Components of PREDPP. ADVAN and TRANS arechosen from the PREDPP library. PK and ERROR areuser-supplied.3.4. Building an Executable Module for NONMEMWhether PREDPP is used or a special purpose PRED subroutineis written, the PRED subroutine must be combined (&quot;linked&quot;)with NONMEM; this process (which is sometimes is called&quot;link editing&quot; or &quot;loading&quot;) must take place before theactual NONMEM run. The NONMEM-PRED combination is generallycalled a &quot;load module&quot; or &quot;executable module&quot;. Compilingand linking are processes which are operating systemdependent; each installation must supply its own commandsand procedures for these tasks. They may be done before theNM-TRAN step or between it and the NONMEM step. This choiceis discussed in Section 3.7 below. For certain platforms, a &#9474;front-end interface provided by the NONMEM Project Group &#9474;(nmfe72.bat for MS/DOS; nmfe72 C-shell script for Unix-type) &#9474;can be used to perform these steps, and can create all both &#9474;types of load modules described below: generated subroutines &#9474;and user-written subroutines.3.5. NM-TRANNM-TRAN provides the following services: control languagetranslation, model specification via FORTRAN-like statements(called abbreviated code), partial differentiation, andpreprocessing of the data. They are discussed separately.3.6. Control Language TranslationNM-TRAN includes a language for communicating controlinformation to NONMEM. NM-TRAN records are free-form (i.e.,spacing between options within a record and the order of therecords and their options is flexible) and use English words(or their abbreviations) for options. For example, therecord name $ESTIMATION may be abbreviated to $EST; theoption name SIGDIGITS may be abbreviated to SIG. Eitherspaces or commas may be used to separate options. Defaultsare understood for most options, allowing the records to berelatively compact. Considerable error checking isperformed by NM-TRAN. This reduces the number and severityof the errors that can occur during the NONMEM run. NM-TRAN &#9474;also produces messages that warn the user of possible errors &#9474;in the data and/or control stream.NM-TRAN translates a file of NM-TRAN control records intoNONMEM control records, which use a fixed-field,predominately numerical control language.3.7. Model Specification via Abbreviated CodeWith PREDPP, FORTRAN subroutines PK and ERROR are needed tospecify parts of the pharmacostatistical model. In mostcases, these specifications can be directly expressed withinNM-TRAN records $PK and $ERROR, using FORTRAN-likeassignment and conditional statements called abbreviatedcode. These statements are implemented by NM-TRAN ascomplete FORTRAN subroutines in file FSUBS, incorporatingthe abbreviated code. An intermediate step between theNM-TRAN and NONMEM steps is needed to compile thesesubroutines and link them with NONMEM-PREDPP. &#9474;The message &quot;Recompiling certain components&quot; will be &#9474;displayed at the console at this step. &#9474;Figure 1.3 shows how the compile and link step relates tothe two steps of Figure 1.1.Figure 1.3. Building a NONMEM load module with generatedFORTRAN subroutines. An intermediate step is placed betweenthe two steps of Figure 1.1.If the user supplies complete PK and ERROR subroutines(i.e., $PK and $ERROR records are not used), then the NONMEMload module can be built at any time.Note that even when PREDPP is not used, the same optionsexist. For example, if the desired model can be expressedvia a $PRED record, then NM-TRAN will generate a completePRED subroutine. However, whereas NM-TRAN&rsquo;s FORTRAN-likesyntax is sufficient for most purposes of writing PK andERROR subroutines, it is not sufficient for writing any butthe simplest of PRED subroutines.3.8. Partial DifferentiationNONMEM requires that PRED (whether PREDPP or user-written)compute more than just predicted values. It must alsocompute certain partial derivatives with respect to therandom variables and described in Chapters 3 and 4.When $PK, $ERROR, or $PRED records are used, NM-TRANperforms symbolic differentiation to generate the codeneeded to compute these derivatives. This relieves the userof a major burden.3.9. Data PreprocessorNM-TRAN includes a Data Preprocessor program which allowsthe user greater flexibility in constructing his data filethan is allowed in a data file input directly into NONMEM.This is discussed in Chapter 6.4. Additional DocumentationMore information can be found in the other parts of theNONMEM Users Guide, all of which may be found as pdf files &#9474;on the NONMEM distribution medium.Part I - Users Basic GuideA thorough, step by step discussion of the variousfeatures and some of the statistical concepts involvedin using NONMEM, including many examples.Part II - Users Supplemental GuideA continuation of Part I which includes advancedfeatures of NONMEM.Part III - NONMEM Installation GuideA guide for installing NONMEM, PREDPP, and NM-TRAN.Part IV - NM-TRAN GuideA complete reference guide to NM-TRAN and the DataPreprocessor.Part V - Introductory GuideThe present document.Part VI - PREDPP GuideA complete reference guide to PREDPP.Part VII - Conditional Estimation MethodsA description of these methods and some guidelines fortheir use. &#9474;Part VIII - Help Guide &#9474;A fast way to locate information on a given word or &#9474;topic. The content of the Help Guide is also supplied &#9474;on the NONMEM distribution medium as both text files &#9474;(&quot;on-line help&quot;) and html files for on-line searching. &#9474;NONMEM V Supplemental Guide &#9474;Describes new features of NONMEM V. &#9474;Introduction to Version VI &#9474;Describes new features of NONMEM VI. &#9474;Introduction to NONMEM Version 7. &#9474;Describes new features of NONMEM 7.">1. What This Chapter is AboutThis chapter introduces a computer program called NONMEM.It also introduces two programs that are distributed withNONMEM and make it easier to use: PREDPP and NM-TRAN. Thescope of this text itself is described, and suggestions aremade for reading it. A somewhat detailed technicaldescription of the components of NONMEM is then given. Thefinal section is a list of additional references.2. Introducing NONMEM2.1. What is NONMEM?NONMEM stands for &quot;Nonlinear Mixed Effects Model.&quot; NONMEMis a computer program, written in FORTRAN 90/95, designed tofit general statistical (nonlinear) regression-type modelsto data.NONMEM was developed by the NONMEM Project Group at theUniversity of California at San Francisco for analyzingpopulation pharmacokinetic data in particular.&dagger;<cite>&dagger; NONMEM versions up through VI are the property of the &#9474;Regents of the University of California, but ICON &#9474;Development Solutions has exclusive rights to license their &#9474;use. NONMEM 7 is the current version of the software and is &#9474;the property of ICON Development Solutions. </cite>These are data typically collected from clinical studies ofpharmaceutic agents, involving the administration of a drugto individuals and the subsequent observation of drug levels(most often in the blood plasma). Proper modeling of thesedata involves accounting for both unexplainable inter- andintra-subject effects (random effects), as well as measuredconcomitant effects (fixed effects). NONMEM allows thismixed effect modeling. Such modeling is especially usefulwhen there are only a few pharmacokinetic measurements fromeach individual sampled in the population, or when the datacollection design varies considerably between theseindividuals. However, NONMEM is a general program which canbe used to fit models to a wide variety of data.Like many nonlinear regression programs, NONMEM does nothave any &quot;built in&quot; models (such as the linear model) withwhich it can compute a predicted value given the currentvalues of the regression parameters. Instead, NONMEM callsa subroutine having entry name PRED (&quot;prediction&quot;) to obtaina predicted value. PRED also must compute for NONMEMpartial derivatives with respect to certain randomvariables. Depending on the model and the kinds of doses,PRED may be very simple or may be very complicated. A usercan write his own PRED subroutine. This can be as simple orcomplicated as is necessary, and may involve calls to itsown subprograms.2.2. What is PREDPP?PREDPP stands for &quot;PRED for Population Pharmacokinetics&quot;.It is a PRED subroutine for use with NONMEM and is thesecond major component distributed with NONMEM. WhereasNONMEM is a general nonlinear regression tool, PREDPP isspecialized to the kinds of predictions which arise inpharmacokinetic data analysis. It can compute predictionsaccording to many different pharmacokinetic models,according to a great variety of dosing regimens. Almost allthe examples in this guide use PREDPP.2.3. What is NM-TRAN?NM-TRAN stands for &quot;NONMEM Translator&quot;. It is the thirdmajor component distributed with NONMEM. It is a separate,&quot;stand-alone&quot; control language translator and datapreprocessor. When NM-TRAN is used, a NONMEM run includestwo separate steps: first the NM-TRAN step, in which a fileof NM-TRAN records (which begin with &quot;$&quot;) are translatedinto several NONMEM input files, and second the NONMEM stepitself. All the examples in this guide use NM-TRAN. Westrongly recommend its use.Note that neither NM-TRAN nor NONMEM-PREDPP runinteractively. Files of commands and data are created bymeans of (say) the operating system editor. Then NM-TRANand NONMEM are executed, using these files as input. Figure1.1 shows the relationship between NONMEM, PREDPP, andNM-TRAN.Fig 1.1. NONMEM, PREDPP, and NM-TRAN. A user-written PREDsubroutine could be included instead of PREDPP.2.4. Scope of this Introductory GuideThis Guide is intended to be read by new users ofNONMEM-PREDPP. Typically, such users have pharmacokineticdata, either from a population or from a single individual,to be fit to a standard pharmacokinetic model (e.g., a oneor two compartment linear mammillary model). However, newusers with nonstandard models, or withpharmacokinetic/pharmacodynamic data, may also find thisguide helpful.It is assumed that NONMEM and its components are alreadyinstalled on the user&rsquo;s computer and that the user wants tolearn to use them as quickly as possible. This guide doesnot tell how to perform the installation or how to run aninstalled NONMEM under a particular operating system; thenew user will have to ask experienced users what the localcommands are. However, someone who is installing NONMEM ata new site may find it useful to review this guide to get aquick overview of NONMEM, its component programs, itsinputs, and its outputs.This guide is not a text book in pharmacokinetics orstatistics. Readers should be familiar with basic conceptsin pharmacokinetics and statistical data analysis. We alsoassume a very basic familiarity with FORTRAN.2.5. Contents of this Introductory GuideChapter 2 contains two examples of the use of NONMEM. Thefirst presents data from a single individual; estimates areobtained of his pharmacokinetic parameters. The secondpresents data from a group of individuals; estimates areobtained of the pharmacokinetic parameters of the populationwhich this group represents. The examples serve tointroduce NONMEM notation, input and output, and to providean idea of what is possible using the system.Chapter 3 presents the notation and definitions we will useto discuss models for individual data. The relationship ofthese models to data is discussed, and the distinctionbetween so-called fixed effects and random effects is made.Chapter 4 extends this discussion to models for populationdata.Chapter 5 discusses NONMEM&rsquo;s fitting criterion, theparameter estimates obtained by using this criterion, andthe standard errors of these estimates. It then discusseshow to do hypothesis tests with NONMEM.Chapter 6 tells how to create data files for NONMEM-PREDPPand how to describe them using the $DATA and $INPUT recordsof NM-TRAN. It also discusses the Data Preprocessor featureof NM-TRAN.Chapter 7 tells how to use NM-TRAN to write simple$SUBROUTINE records for PREDPP, how to write $PK records forindividual data, and how to write $PK records for populationdata.Chapter 8 tells how to write simple $ERROR records forPREDPP. Chapters 7 and 8 are meant to be read in parallelwith Chapters 3 and 4.Chapter 9 tells how to use NM-TRAN to specify the remainingchoices for an analysis. It tells how to assign initialvalues to parameters ($THETA, $OMEGA, $SIGMA records), howto specify what analysis tasks to perform ($ESTIMATION,$COVARIANCE records), and how to specify certain additionaloutput ($TABLE, $SCATTERPLOT records).Chapter 10 describes NONMEM&rsquo;s output in detail.Chapter 11 outlines the process of model building, showinghow a simple model can be made more complex to better fitthe data.Chapter 12 briefly describes a variety of features of PREDPPand NONMEM that are somewhat advanced for this text but areof interest to most users of NONMEM. References are givento other documents in which additional information can befound.Chapter 13 discusses errors that can occur during a NONMEMrun.Appendix 1 describes PREDPP&rsquo;s most commonly usedpharmacokinetic models (ADVAN subroutines).Appendix 2 describes alternative parameterizations (TRANSsubroutines) for these models.Appendix 3 is a list of NM-TRAN records. &#9474;2.6. How to Read this GuideReaders who are completely new to NONMEM should read thisguide starting with Chapter 2; the examples presented areused again in the later chapters. Chapters 2-5 aretheoretical in nature. Chapters 6-12 describe the detailsof building the input for NONMEM-PREDPP and interpreting theoutput. Readers who have non-pharmacokinetic data to fitcan skip (or skim) Chapters 3, 4, 7, and 8. Readers whoalready have some familiarity with certain topics (e.g., whohave used other nonlinear analysis programs to analyze data)can concentrate on the chapters of interest to them. Intime, readers who are comfortable with NONMEM may be able towork entirely from Appendix 3. We strongly recommend thatsuch users &quot;graduate&quot; to the more thorough NONMEMdocumentation listed in Section 4 of this chapter.Throughout the guide, examples are given of NM-TRAN records.These examples appear in boldface:$THETA .01Examples are also given of (fragments) of input data files.They appear as follows:ID AMT TIME DV2 320. 0. 0.2 0. .27 1.71Alphabetic characters such as ID, AMT, etc., are shown fordescriptive purposes. They are not part of the actual datafile.3. A Brief Technical OverviewIn this section we discuss the components of NONMEM in somedetail. First-time readers may prefer to skip this sectionand go directly to Chapter 2, which gives an example of aNONMEM run, and return to this section later (if at all).3.1. NONMEMNONMEM is written (almost) entirely in ANSI FORTRAN 90/95. &#9474;It is distributed on CD-ROM as FORTRAN source code, some of &#9474;which is encrypted. It can be compiled and run on anycomputer which has a FORTRAN 90/95 compiler and sufficientmemory and speed to run a large, computationally intensiveprogram.NONMEM consists of a main program and many subroutines, allof which are required for each NONMEM run. As discussedabove, one subroutine, PRED, is not included in NONMEMitself.3.2. PREDPP and the PREDPP LibraryPREDPP is not a single subroutine. It is a collection ofFORTRAN subroutines. Some of these are always needed butmust be supplied by the user himself (see PK and ERRORbelow). Others are always needed and are supplied; theseare called the kernel routines. Others (subroutines ADVANand TRANS, for example) are also always needed, and aresupplied, but are chosen from different versionscorresponding to different pharmacokinetic models. Thecollection of supplied routines constitutes the PREDPPLibrary.3.3. Subroutines PK and ERRORTwo very important subroutines of PREDPP are called PK andERROR. PK computes the values of the population orindividual pharmacokinetic parameters (e.g., CL and V) of agiven model and accounts for the &quot;differences&quot; betweenindividual and population values. ERROR accounts for the&quot;differences&quot; between predicted and observed values. Thesetwo subroutines are where the basic task of modelling iscarried out; this task is the user&rsquo;s responsibility.Chapters 7 and 8 are devoted to a description of thesesubroutines.Figure 1.2 shows the major components of PREDPP.Figure 1.2. Components of PREDPP. ADVAN and TRANS arechosen from the PREDPP library. PK and ERROR areuser-supplied.3.4. Building an Executable Module for NONMEMWhether PREDPP is used or a special purpose PRED subroutineis written, the PRED subroutine must be combined (&quot;linked&quot;)with NONMEM; this process (which is sometimes is called&quot;link editing&quot; or &quot;loading&quot;) must take place before theactual NONMEM run. The NONMEM-PRED combination is generallycalled a &quot;load module&quot; or &quot;executable module&quot;. Compilingand linking are processes which are operating systemdependent; each installation must supply its own commandsand procedures for these tasks. They may be done before theNM-TRAN step or between it and the NONMEM step. This choiceis discussed in Section 3.7 below. For certain platforms, a &#9474;front-end interface provided by the NONMEM Project Group &#9474;(nmfe72.bat for MS/DOS; nmfe72 C-shell script for Unix-type) &#9474;can be used to perform these steps, and can create all both &#9474;types of load modules described below: generated subroutines &#9474;and user-written subroutines.3.5. NM-TRANNM-TRAN provides the following services: control languagetranslation, model specification via FORTRAN-like statements(called abbreviated code), partial differentiation, andpreprocessing of the data. They are discussed separately.3.6. Control Language TranslationNM-TRAN includes a language for communicating controlinformation to NONMEM. NM-TRAN records are free-form (i.e.,spacing between options within a record and the order of therecords and their options is flexible) and use English words(or their abbreviations) for options. For example, therecord name $ESTIMATION may be abbreviated to $EST; theoption name SIGDIGITS may be abbreviated to SIG. Eitherspaces or commas may be used to separate options. Defaultsare understood for most options, allowing the records to berelatively compact. Considerable error checking isperformed by NM-TRAN. This reduces the number and severityof the errors that can occur during the NONMEM run. NM-TRAN &#9474;also produces messages that warn the user of possible errors &#9474;in the data and/or control stream.NM-TRAN translates a file of NM-TRAN control records intoNONMEM control records, which use a fixed-field,predominately numerical control language.3.7. Model Specification via Abbreviated CodeWith PREDPP, FORTRAN subroutines PK and ERROR are needed tospecify parts of the pharmacostatistical model. In mostcases, these specifications can be directly expressed withinNM-TRAN records $PK and $ERROR, using FORTRAN-likeassignment and conditional statements called abbreviatedcode. These statements are implemented by NM-TRAN ascomplete FORTRAN subroutines in file FSUBS, incorporatingthe abbreviated code. An intermediate step between theNM-TRAN and NONMEM steps is needed to compile thesesubroutines and link them with NONMEM-PREDPP. &#9474;The message &quot;Recompiling certain components&quot; will be &#9474;displayed at the console at this step. &#9474;Figure 1.3 shows how the compile and link step relates tothe two steps of Figure 1.1.Figure 1.3. Building a NONMEM load module with generatedFORTRAN subroutines. An intermediate step is placed betweenthe two steps of Figure 1.1.If the user supplies complete PK and ERROR subroutines(i.e., $PK and $ERROR records are not used), then the NONMEMload module can be built at any time.Note that even when PREDPP is not used, the same optionsexist. For example, if the desired model can be expressedvia a $PRED record, then NM-TRAN will generate a completePRED subroutine. However, whereas NM-TRAN&rsquo;s FORTRAN-likesyntax is sufficient for most purposes of writing PK andERROR subroutines, it is not sufficient for writing any butthe simplest of PRED subroutines.3.8. Partial DifferentiationNONMEM requires that PRED (whether PREDPP or user-written)compute more than just predicted values. It must alsocompute certain partial derivatives with respect to therandom variables and described in Chapters 3 and 4.When $PK, $ERROR, or $PRED records are used, NM-TRANperforms symbolic differentiation to generate the codeneeded to compute these derivatives. This relieves the userof a major burden.3.9. Data PreprocessorNM-TRAN includes a Data Preprocessor program which allowsthe user greater flexibility in constructing his data filethan is allowed in a data file input directly into NONMEM.This is discussed in Chapter 6.4. Additional DocumentationMore information can be found in the other parts of theNONMEM Users Guide, all of which may be found as pdf files &#9474;on the NONMEM distribution medium.Part I - Users Basic GuideA thorough, step by step discussion of the variousfeatures and some of the statistical concepts involvedin using NONMEM, including many examples.Part II - Users Supplemental GuideA continuation of Part I which includes advancedfeatures of NONMEM.Part III - NONMEM Installation GuideA guide for installing NONMEM, PREDPP, and NM-TRAN.Part IV - NM-TRAN GuideA complete reference guide to NM-TRAN and the DataPreprocessor.Part V - Introductory GuideThe present document.Part VI - PREDPP GuideA complete reference guide to PREDPP.Part VII - Conditional Estimation MethodsA description of these methods and some guidelines fortheir use. &#9474;Part VIII - Help Guide &#9474;A fast way to locate information on a given word or &#9474;topic. The content of the Help Guide is also supplied &#9474;on the NONMEM distribution medium as both text files &#9474;(&quot;on-line help&quot;) and html files for on-line searching. &#9474;NONMEM V Supplemental Guide &#9474;Describes new features of NONMEM V. &#9474;Introduction to Version VI &#9474;Describes new features of NONMEM VI. &#9474;Introduction to NONMEM Version 7. &#9474;Describes new features of NONMEM 7.</a><br>
<a href="#1. What This Chapter is AboutIn this chapter, two examples of the use of NONMEM will begiven. The first estimates pharmacokinetic parameters of anindividual from his data; the second estimates so-calledpopulation parameters from data from a group of individuals.The examples serve to introduce NONMEM notation, input andoutput, and to provide an idea of what is possible using thesystem. The second example will be discussed again inChapter 11.2. An Individual&rsquo;s Theophylline KineticsFigure 2.1 shows the input used to fit a model toobservations of theophylline plasma concentration time ina single individual after a single dose of 320 mg.$PROB SIMPLE NONLINEAR REGRESSION - THEOPHYLINE$INPUT ID AMT TIME DV$DATA P2DATA$SUBROUTINE ADVAN2$PKKA=THETA(1)K=THETA(2)V=THETA(3)S2=V$ERRORY=F+ERR(1)$THETA (0, 1.7) (0, .102) (0, 29.)$OMEGA 1.2$ESTIMATION PRINT=5$COVARIANCE$TABLE ID AMT TIME$SCATTER PRED VS DV UNITFigure 2.1. The input (i.e., NM-TRAN control records) foranalysis of some individual theophylline data.The first line (record) gives a name to the problem. Therest of the lines (records) discuss the data, the model, andthe desired output. Before going into these in some greaterdetail, you may want to look right now at figures 2.1 and2.2, and then 2.4 and 2.5. Figure 2.2 shows the data forthis problem, and figures 2.4 and 2.5 show some of NONMEM&rsquo;soutput. All you need to know to get a good idea of whatthis analysis shows is that the one-compartment model withfirst-order absorption has been used; the observedconcentrations and the times of observation after the bolusdose are in columns 4 and 3, respectively, of figure 2.2;and that the symbol DV stands for dependent variable (theobserved concentrations, in this case). You should, forexample, even at this point, be able to tell that theestimate of Volume of Distribution (V in figure 2.1, andTHETA(3) in figure 2.4) is 32 liters (L), with a standarderror of L. Now consider the figures in greaterdetail.2.1. The NM-TRAN Control RecordsThe second record of figure 2.1 names the data items thatappear on each data record, and the third record gives thename of the file containing the data records, P2DATA in thisexample. Figure 2.2 shows the contents of P2DATA.2 320. 0. 0.2 0. .27 1.712 0. .52 7.912 0. 1. 8.312 0. 1.92 8.332 0. 3.5 6.852 0. 5.02 6.082 0. 7.03 5.42 0. 9. 4.552 0. 12. 3.012 0. 24.3 .90Figure 2.2. The contents of the data file containing thedata records.According to the second record of figure 2.1, the third dataitem (column) of a data record is TIME, the time associatedwith the event described by that data record. The event ata given time (for this simple data set) can either be theadministration of a dose or the acquisition of anobservation. The second data item of a data record is AMT,amount (in this case in mg) of the dose given at TIME, thetime of the record. Apparently, 320 mg is given at timezero (first record of figure 2.2), and no further doses aregiven (all zeros in column 2 thereafter). The fourth dataitem (column) in P2DATA is named DV, for Dependent Variable(the measured plasma theophylline concentration), as alreadymentioned. So, all of the data records, except the first,give the time after the 320 mg dose, and the concentrationof theophylline (in mg/L) measured in a plasma sample drawnat that time. The first data item is labelled ID for theIDentification number of the patient. Here it happens to be2.2.2. The ModelThe fourth record of figure 2.1 identifies thepharmacokinetic model PREDPP is to use: the one-compartmentmodel with first-order absorption. It is implemented by anADVAN subroutine (see Chapter 1, Section 3.2) which iscalled ADVAN2 (See Chapter 7). Figure 2.3 shows the part ofthe output of NONMEM for this problem that verifies theuser&rsquo;s choice of model. It also describes the features ofthe model in terms of its compartments. Of relevance tothis problem are the DEPOT compartment (where the dose goes,and from which drug enters the central compartment by afirst order process), and the CENTRAL compartment itself.Note, for example, that the default compartment for doses(i.e., where PREDPP will add doses if not otherwiseinstructed) is the DEPOT compartment, as it should be.ONE COMPARTMENT MODEL WITH FIRST-ORDER ABSORPTION (ADVAN2)MAXIMUM NO. OF BASIC PK PARAMETERS: 3BASIC PK PARAMETERS (AFTER TRANSLATION):ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 1ABSORPTION RATE (KA) IS BASIC PK PARAMETER NO.: 3COMPARTMENT ATTRIBUTESCOMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULTSTATUS ALLOWED ALLOWED FOR DOSE FOR OBS.1 DEPOT OFF YES YES YES NO2 CENTRAL ON NO YES NO YES3 OUTPUT OFF YES NO NO NOFigure 2.3. The PREDPP output that verifies the user&rsquo;schoice of model. Features of the model are discussed, suchas the names and numbering of parameters, and the attributesof the various compartments in the model.The fifth input record (figure 2.1) signals the start of theuser&rsquo;s specification of the model for the pharmacokineticparameters. This specification is given in the next 4 linesof so-called abbreviate___________ cod____ (the $PK record, along withthis abbreviated code is called the $PK block). Some of theparameters that NONMEM estimates are denoted by herein,and are labeled THETA in NONMEM input and output. The modelspecified in figure 2.1 is very simple. It says that adifferent unknown constant (NONMEM parameter) is to beassigned to each pharmacokinetic parameter: first-orderabsorption rate, KA (line 1 of the PK block, after the $PKrecord - THETA(1)), rate constant of elimination, K (line 2- THETA(2)), and volume of distribution, V (line 3 -THETA(3)). The S2 parameter (a so-called scale parameter)is discussed in Chapter 3, Section 2.2.The sixth input record (figure 2.1 - line) signals thestart of the user&rsquo;s specification of the (statistical) modelfor the lack of fit of the pharmacokinetic model to thedata. This specification is given in the next line ofabbreviated code (the $ERROR record, along with this line ofabbreviated code is called the $ERROR block). The modelhere says that observations differ from predictions by anadditive error (ERR(1)).Record 7 ($THETA) gives NONMEM information about possiblevalues of each element of in the format: lower bound,initial estimate, upper bound. When, as in this particularrecord, only two numbers are given for an element of ,these are understood to mean the lower bound and initialestimate; the upper bound is unlimited. Record 8 ($OMEGA)gives NONMEM an initial estimate of the variance of ERR(1).This statistical parameter is often denoted by instatistical discussions, but with data from a singleindividual, it is denoted by in NONMEM documentation, andby OMEGA in NONMEM input and output. It is understood thata variance parameter is always nonnegative. The $OMEGArecord is further discussed in Chapter 9, Section 3.2.3. The OutputRecord 9 ($ESTIMATION) instructs NONMEM to obtain estimatesof the parameters, and the next record ($COVARIANCE) asksthat it also obtain standard errors of the parameterestimates. The output is shown in figure 2.4. It requireslittle discussion. The first item, the minimum value of theobjective function, is a goodness of fit statistic, muchlike a sum of squares (and as with a sum of squares, thelower the value, the better the fit). The parameterestimates (the parameter values at which the objectivefunction is minimized) and their standard errors follow.Note that the estimate of OMEGA, too, has a standard error.Unlike most fitting programs, NONMEM treats this parameterlike any other.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 8.940 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 31.94E+00 1.02E-01 3.20E+01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 8.99E-01******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 36.28E-01 7.35E-03 1.25E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 5.44E-01Figure 2.4. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) theparameter estimates, and their standard errors.The next to last control record asks NONMEM to print a tabledisplaying the input data and certain computed quantities.A portion of a NONMEM table is shown in figure 10.10 ofChapter 10. The last control record asks NONMEM to make ascatterplot of the prediction of each plasma concentration(PRED) VS the observed value (DV) and to draw the line ofidentity (UNIT, for &quot;unit slope&quot; line) on the plot. Theplot is shown in figure 2.5.PRED VS. DV8.00E-01 2.34E+00 3.88E+00 PRED 5.42E+00 6.96E+00 8.50E+00. . . . . .. . . . . . . . . . .7.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ..*. .. . .. . .. . .. . .. . * .. . .. . .. . .2.26E+00. . ... . .. . .. . .. . .. * .. . .. . .. . .. . .3.82E+00. . ... . .. . .. . .. . .DV . * . .. . .. . .. . .. . .5.38E+00. * . ... . .. . .. . .. . * .. . .. . .. . .. . .. . * .6.94E+00. . ... . .. . .. . .. . .. . .. * . .. . .. . .. * *.8.50E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.5. A scatterplot of the observed data (DV) vs thepredictions of the best-fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.3. A Population Model for PhenobarbitalAbout 60 infants were given phenobarbital therapeutically.A plasma concentration was measured in each some hours afterthe first (loading) dose, followed by multiple maintenancedoses. A second, and sometimes a third concentration weremeasured later. In all, 155 concentrations were observed.Figure 2.6 gives the NM-TRAN control records. The data aretoo lengthy to show in full, but figure 2.7 shows the datafor the first individual&dagger;.<cite>&dagger; File PHENO of NONMEM distribution medium contains the &#9474;complete data set. </cite>Figures 2.8 - 2.10 have some relevant output. Again, mostof the analysis results are apparent from the figures, andyou should try to see if you can figure them out beforegoing further. Note that the $INPUT record now defines anew data item, WT, the patient weight. It&rsquo;s value is givenon every data record for an individual, in the columnindicated. This is so despite the fact that WT may notchange within an individual. This is a bit repetitious, butconvenient.$PROBLEM PHENOBARB$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)CL=TVCL+ETA(1)TVVD=THETA(2)V=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0047) (0,.99)$OMEGA .0000055, .04$SIGMA 25$ESTIMATION PRINT=5$TABLE ID TIME AMT WT APGR$COVARIANCE$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.6. NM-TRAN control records for analysis of somepopulation phenobarbital data.1 0. 25.0 1.4 7 .1 2.0 . 1.4 7 17.31 12.5 3.5 1.4 7 .1 24.5 3.5 1.4 7 .1 37.0 3.5 1.4 7 .1 48.0 3.5 1.4 7 .1 60.5 3.5 1.4 7 .1 72.5 3.5 1.4 7 .1 85.3 3.5 1.4 7 .1 96.5 3.5 1.4 7 .1 108.5 3.5 1.4 7 .1 112.5 . 1.4 7 31.0Figure 2.7. The first individual&rsquo;s phenobarbital data.3.1. The NM-TRAN Control RecordsThe records are very similar to those for the theophyllineproblem. The new features are that the model has changed(it is implemented by ADVAN1, not ADVAN2), the model for thepharmacokinetic parameters is more complicated, and anadditional scatterplot is requested. The data for eachinfant is similar to those shown in figure 2.7; however, nowall of the data records for each infant start with the samevalue for the ID data item (column 1), but this valuediffers between infants.3.2. The ModelADVAN1 implements the one-compartment (monoexponential)model, without first order absorption. No absorption modelwas needed for this problem because all concentrations weremeasured many hours after the last (oral) dose, soabsorption could be considered to be complete, and, for thepurposes of data analysis, immediate.The parameters of the one-compartment model are defined bythe abbreviated code following the $PK statement: Clearance(CL) and Volume of Distribution (V). However, here eachparameter is not simply equal to one of NONMEM&rsquo;s parameters(an element of THETA). Rather, CL, for example, is equal toa parameter (THETA(1)) plus a new term, ETA(1). The latterexpresses interindividual variability, and stands for thedeviation of the individual&rsquo;s true clearance (CL) from thepopulation value (TVCL, Typical Value of CLearance, which,in turn, is simply THETA(1)). This model is essentiallydifferent from the theophylline model, because itincorporates interindividual variability (something that anindividual model need not do). Note that since PREDPPultimately needs the values of microconstants, rather thanphysiological-based pharmacokinetic parameters such asclearance, code must be given for K, the rate constant ofelimination. There is, though, a simple alternative towriting this additional line of code. It is discussed inChapter 3 Section 2.1.The abbreviated code after the $ERROR record is exactly thesame as that with the theophylline data and expresses thesame model for lack-of fit between observations andpredictions for an individual. The $OMEGA and $SIGMArecords, which give NONMEM information about the estimatedvariances of the ETA and ERR variables, are discussed inChapter 9, Section 3. Previously the initial estimate ofthe variance of ERR(1) was given on a $OMEGA record. Hereit is given on a $SIGMA record. This difference in NONMEMconventions between individual type data and population typedata will be discussed more fully in Chapters 3 and 4.3.3. The OutputNONMEM is again instructed to estimate the parameters andtheir standard errors. The results are shown in figures 2.8and 2.9.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 717.203 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 25.48E-03 1.40E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 6.85E-06ETA2 0.00E+00 2.86E-01SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.01E+00Figure 2.8. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) andthe parameter estimates for the phenobarbital problem.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 24.86E-04 7.84E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.27E-06ETA2 ......... 8.34E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.49E+00Figure 2.9. NONMEM output giving the standard errors of theparameter estimates for the phenobarbital problem.Note that now there are estimates of the variances of theinterindividual differences in CL (OMEGA - ETA1) and V(OMEGA - ETA2), as well as of the residual error variance(denoted by SIGMA in NONMEM output when the data are from apopulation; again, see Chapters 3 and 4). There are alsostandard errors for these estimates.The next-to-last control record asks NONMEM to make the samekind of scatterplot as in the theophylline problem: a plotof the predictions vs the observations. Here, a predictionfor an individual&rsquo;s observation is based on typical(population) values of the pharmacokinetic parameters (seefigure 2.8), rather than the values of the pharmacokineticparameters for the specific individual. The plot is shownin figure 2.10.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. * .. . .. * * ** * * .. * * ** * * * .. .* .. * *3 * * * .1.80E+01. * *** *2 * ... * * 3*2 * .. 2 * . *2 2* * * .. *2 **2*. * * * * .. *2* 2 . * * .. *2 * ** * ** * .. ** *** 3. * * * .. * . 2 * * .. * 2 . ** * * * .. * * *.2 * * .3.10E+01. * **** 2** ... * ** . .. * 22* * * .. * * . * .. ** * . .DV . * * ** * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.10. A scatterplot of the observed data (DV) vs thepredictions with the best fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.Here, in contrast to figure 2.5, the data arise from manydifferent individuals. One cannot tell which data came fromwhich infant.Although the fit is fairly good, the points far to the rightof the line of identity of figure 2.10 indicate that thereare many predictions (PRED) that are much higher than theircorresponding observations (DV). This is seen from anotherpoint of view in the second scatterplot. This scatterplotplots residuals (RES) vs patient weight (from the data item,WT &mdash; see figure 2.6). A residual is the difference betweenan observed concentration and its prediction (the sameprediction used in the scatterplot of figure 2.10). Theresiduals reflect not only lack of fit between observationsand predictions for a given individual (the variance SIGMA),but also interindividual variability (the variancescomprising OMEGA). They can be thought of as reflecting thepart of the data that the model does not explain. As can beseen from figure 2.11, there is a clear relationship betweenthe sign and magnitude of the residuals and patient weight.Here, the patients with the largest weights have the mostnegative residuals; i.e., their predictions are much largerthan their observations. These are the same points thatfell on the far right of figure 2.10.RES VS. WT-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. . * .. *. *** 2 * **2 .. . .. . * 2 .. * 23 2* * .. . .. * **. **23* .. * 22 **2 4*3* * * .1.14E+00. . ... * * .*2*42*** .. *** 34** .. . .. * ***222224* .. . .. * ** ** ****** .. . .. . .. * * ***3 * .1.78E+00. **2 ** 2* ... . .. ** * * .* .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... 2 . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. 2 * * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 2.11. A scatterplot of the residuals (RES) vspatient weight (WT). The pattern suggests that observationsare underpredicted in infants with low weight, andoverpredicted in those with higher weights.An obvious explanation is that Clearance or Volume, or both,increase with weight, so that without weight being takeninto account, too high a prediction is being made for alarger infant and too low a prediction is being made for asmaller infant, all other things (i.e., dose) being equal.To see if accounting for weight improves the fit, the runspecified in figure 2.12 can be done.$PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0027) (0,.70) .0018 .5$OMEGA .000007, .3$SIGMA 8$ESTIMATION PRINT=5$COVARIANCE$TABLE ID TIME AMT WT APGR DV$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.12. NM-TRAN control records for fitting a modeltaking into account the effect of patient weight to thepopulation phenobarbital data.Now both TVCL and TVVD are linear functions of weight with,in the case of TVCL, for example, intercept THETA(1), andslope THETA(3). Both slope and intercept are &quot;population&quot;parameters since they relate weight to typical populationvalues of the pharmacokinetic parameter. Now we see why WTis given in every data record: the abbreviated PK code mayneed to be evaluated at each event time. If WT did notchange over time within any patient, it could be given onlyon the first data record for each patient, but then slightlymore complicated abbreviated code would be needed. Theoutput from running the input of figure 2.12 is shown infigures 2.13 - 2.16.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 609.134 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 41.43E-11 1.21E-01 4.77E-03 9.18E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 1.36E-06ETA2 0.00E+00 7.51E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.71E+00Figure 2.13. The minimum objective function value andparameter estimates for the phenobarbital data, using themodel of figure 2.12, which takes into account the effect ofpatient weight.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 49.49E-11 1.46E-01 2.24E-04 1.13E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 7.24E-07ETA2 ......... 3.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.71E+00Figure 2.14. The standard errors of the parameter estimatesfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Note the improvement in the minimum objective function value(it drops 108 points), and the profound decreases in thesizes of the estimates of the interindividual variances; nowthat weight is in the model, there is less unexplainedinterindividual variability. As will be discussed inChapter 5, the decrease in the objective function can beused for a formal hypothesis test of the appropriateness ofthe new model (figure 2.12) for the effect of weight on thepharmacokinetic parameters.Note also the very small values estimated for THETA(1) andfor its standard error. The intercept term of TVCL does notappear to be an important part of the model. This model isrefined in Chapter 10, Section 6.2, where it is seen thatdeleting THETA(1) and THETA(3) produces a model that fits aswell as the model including them.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * ** ** .. * * . * * ** * .. * . .. *** *2 * * .1.80E+01. *.**3* * ... * 2*32 .. *22* * * * * * .. * *4** * . * 2 .. *2 * * .* * * .. * * 2* . * 2 * * .. **2 2 * . ** * * .. * 2 .* * .. * ** 2 * . * * .. * * * * * * * .3.10E+01. * * 2* * * * * ... ** .* .. ** ** * ** * . .. * ** . .. * * * . .DV . * * * ** . * * * .. * * . .. ** . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. * .. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.15. A scatterplot of predictions vs observationsfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Compare to figure 2.10.The scatterplots (figures 2.15 and 2.16) confirm that thenew model is an improvement: the group of points far to theright of the line of identity have disappeared from the PREDvs DV plot, and the plot of residuals vs weight no longershows a pattern.RES VS. WT-1.70E+01 -1.00E+01 -3.00E+00 RES 4.00E+00 1.10E+01 1.80E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * .. * * * * * * * . 2* * .. . .. *** . .. * * * *.* * * * * * .. . .. * * * * * ***** * .. * * ** * *. * ** 22 *2 * 2 * .1.14E+00. . ... * * * * * * **** * * * * * .. * * ** * 3 . 2* * .. . .. * 2 ***2. ** * 2* * ** ** .. . .. * * 3 *. ** * * * .. . .. . .. * *** . * * * * * .1.78E+00. * * . 2* ** * * ... . .. * * * ** .. . .. . .WT . *. * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * . .. . .. . .. . .. . .. . 2 .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.16. A scatterplot of residuals (RES) vs patientweight (WT) for the phenobarbital data, using the model offigure 2.12, which takes into account the effect of patientweight. Compare to figure 2.11.4. OverviewThe examples in this chapter illustrate some of the mostimportant and useful features of NONMEM.&deg; NONMEM can fit both individual and population models.&deg; NONMEM has a menu of pharmacokinetic models from whichthe one appropriate to the problem at hand can bechosen.&deg; The user specifies the relationship of pharmacokineticparameters to independent variables (such as WT in thephenobarbital example), using &quot;population&quot; parametersthat will be estimated.&deg; The user also specifies which parameters vary betweenindividuals, and the form (model) for this variability,as well as the form (model) for the differences betweenobservations from an individual and their predictionsfor this individual.&deg; NONMEM estimates parameters describing both kinds ofvariability.&deg; NONMEM provides estimates (standard errors) of theprecision of its parameter estimates, including thosedescribing variability.&deg; NONMEM provides a means of deciding whether one model(e.g., that including weight&rsquo;s effect on CL and V) fitsthe data better than another using the minimumobjective function value, a goodness-of-fit statistic.&deg; NONMEM provides (limited) graphics, useful in judgingthe adequacy of the model currently fit to the data.">1. What This Chapter is AboutIn this chapter, two examples of the use of NONMEM will begiven. The first estimates pharmacokinetic parameters of anindividual from his data; the second estimates so-calledpopulation parameters from data from a group of individuals.The examples serve to introduce NONMEM notation, input andoutput, and to provide an idea of what is possible using thesystem. The second example will be discussed again inChapter 11.2. An Individual&rsquo;s Theophylline KineticsFigure 2.1 shows the input used to fit a model toobservations of theophylline plasma concentration time ina single individual after a single dose of 320 mg.$PROB SIMPLE NONLINEAR REGRESSION - THEOPHYLINE$INPUT ID AMT TIME DV$DATA P2DATA$SUBROUTINE ADVAN2$PKKA=THETA(1)K=THETA(2)V=THETA(3)S2=V$ERRORY=F+ERR(1)$THETA (0, 1.7) (0, .102) (0, 29.)$OMEGA 1.2$ESTIMATION PRINT=5$COVARIANCE$TABLE ID AMT TIME$SCATTER PRED VS DV UNITFigure 2.1. The input (i.e., NM-TRAN control records) foranalysis of some individual theophylline data.The first line (record) gives a name to the problem. Therest of the lines (records) discuss the data, the model, andthe desired output. Before going into these in some greaterdetail, you may want to look right now at figures 2.1 and2.2, and then 2.4 and 2.5. Figure 2.2 shows the data forthis problem, and figures 2.4 and 2.5 show some of NONMEM&rsquo;soutput. All you need to know to get a good idea of whatthis analysis shows is that the one-compartment model withfirst-order absorption has been used; the observedconcentrations and the times of observation after the bolusdose are in columns 4 and 3, respectively, of figure 2.2;and that the symbol DV stands for dependent variable (theobserved concentrations, in this case). You should, forexample, even at this point, be able to tell that theestimate of Volume of Distribution (V in figure 2.1, andTHETA(3) in figure 2.4) is 32 liters (L), with a standarderror of L. Now consider the figures in greaterdetail.2.1. The NM-TRAN Control RecordsThe second record of figure 2.1 names the data items thatappear on each data record, and the third record gives thename of the file containing the data records, P2DATA in thisexample. Figure 2.2 shows the contents of P2DATA.2 320. 0. 0.2 0. .27 1.712 0. .52 7.912 0. 1. 8.312 0. 1.92 8.332 0. 3.5 6.852 0. 5.02 6.082 0. 7.03 5.42 0. 9. 4.552 0. 12. 3.012 0. 24.3 .90Figure 2.2. The contents of the data file containing thedata records.According to the second record of figure 2.1, the third dataitem (column) of a data record is TIME, the time associatedwith the event described by that data record. The event ata given time (for this simple data set) can either be theadministration of a dose or the acquisition of anobservation. The second data item of a data record is AMT,amount (in this case in mg) of the dose given at TIME, thetime of the record. Apparently, 320 mg is given at timezero (first record of figure 2.2), and no further doses aregiven (all zeros in column 2 thereafter). The fourth dataitem (column) in P2DATA is named DV, for Dependent Variable(the measured plasma theophylline concentration), as alreadymentioned. So, all of the data records, except the first,give the time after the 320 mg dose, and the concentrationof theophylline (in mg/L) measured in a plasma sample drawnat that time. The first data item is labelled ID for theIDentification number of the patient. Here it happens to be2.2.2. The ModelThe fourth record of figure 2.1 identifies thepharmacokinetic model PREDPP is to use: the one-compartmentmodel with first-order absorption. It is implemented by anADVAN subroutine (see Chapter 1, Section 3.2) which iscalled ADVAN2 (See Chapter 7). Figure 2.3 shows the part ofthe output of NONMEM for this problem that verifies theuser&rsquo;s choice of model. It also describes the features ofthe model in terms of its compartments. Of relevance tothis problem are the DEPOT compartment (where the dose goes,and from which drug enters the central compartment by afirst order process), and the CENTRAL compartment itself.Note, for example, that the default compartment for doses(i.e., where PREDPP will add doses if not otherwiseinstructed) is the DEPOT compartment, as it should be.ONE COMPARTMENT MODEL WITH FIRST-ORDER ABSORPTION (ADVAN2)MAXIMUM NO. OF BASIC PK PARAMETERS: 3BASIC PK PARAMETERS (AFTER TRANSLATION):ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 1ABSORPTION RATE (KA) IS BASIC PK PARAMETER NO.: 3COMPARTMENT ATTRIBUTESCOMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULTSTATUS ALLOWED ALLOWED FOR DOSE FOR OBS.1 DEPOT OFF YES YES YES NO2 CENTRAL ON NO YES NO YES3 OUTPUT OFF YES NO NO NOFigure 2.3. The PREDPP output that verifies the user&rsquo;schoice of model. Features of the model are discussed, suchas the names and numbering of parameters, and the attributesof the various compartments in the model.The fifth input record (figure 2.1) signals the start of theuser&rsquo;s specification of the model for the pharmacokineticparameters. This specification is given in the next 4 linesof so-called abbreviate___________ cod____ (the $PK record, along withthis abbreviated code is called the $PK block). Some of theparameters that NONMEM estimates are denoted by herein,and are labeled THETA in NONMEM input and output. The modelspecified in figure 2.1 is very simple. It says that adifferent unknown constant (NONMEM parameter) is to beassigned to each pharmacokinetic parameter: first-orderabsorption rate, KA (line 1 of the PK block, after the $PKrecord - THETA(1)), rate constant of elimination, K (line 2- THETA(2)), and volume of distribution, V (line 3 -THETA(3)). The S2 parameter (a so-called scale parameter)is discussed in Chapter 3, Section 2.2.The sixth input record (figure 2.1 - line) signals thestart of the user&rsquo;s specification of the (statistical) modelfor the lack of fit of the pharmacokinetic model to thedata. This specification is given in the next line ofabbreviated code (the $ERROR record, along with this line ofabbreviated code is called the $ERROR block). The modelhere says that observations differ from predictions by anadditive error (ERR(1)).Record 7 ($THETA) gives NONMEM information about possiblevalues of each element of in the format: lower bound,initial estimate, upper bound. When, as in this particularrecord, only two numbers are given for an element of ,these are understood to mean the lower bound and initialestimate; the upper bound is unlimited. Record 8 ($OMEGA)gives NONMEM an initial estimate of the variance of ERR(1).This statistical parameter is often denoted by instatistical discussions, but with data from a singleindividual, it is denoted by in NONMEM documentation, andby OMEGA in NONMEM input and output. It is understood thata variance parameter is always nonnegative. The $OMEGArecord is further discussed in Chapter 9, Section 3.2.3. The OutputRecord 9 ($ESTIMATION) instructs NONMEM to obtain estimatesof the parameters, and the next record ($COVARIANCE) asksthat it also obtain standard errors of the parameterestimates. The output is shown in figure 2.4. It requireslittle discussion. The first item, the minimum value of theobjective function, is a goodness of fit statistic, muchlike a sum of squares (and as with a sum of squares, thelower the value, the better the fit). The parameterestimates (the parameter values at which the objectivefunction is minimized) and their standard errors follow.Note that the estimate of OMEGA, too, has a standard error.Unlike most fitting programs, NONMEM treats this parameterlike any other.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 8.940 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 31.94E+00 1.02E-01 3.20E+01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 8.99E-01******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 36.28E-01 7.35E-03 1.25E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 5.44E-01Figure 2.4. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) theparameter estimates, and their standard errors.The next to last control record asks NONMEM to print a tabledisplaying the input data and certain computed quantities.A portion of a NONMEM table is shown in figure 10.10 ofChapter 10. The last control record asks NONMEM to make ascatterplot of the prediction of each plasma concentration(PRED) VS the observed value (DV) and to draw the line ofidentity (UNIT, for &quot;unit slope&quot; line) on the plot. Theplot is shown in figure 2.5.PRED VS. DV8.00E-01 2.34E+00 3.88E+00 PRED 5.42E+00 6.96E+00 8.50E+00. . . . . .. . . . . . . . . . .7.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ..*. .. . .. . .. . .. . .. . * .. . .. . .. . .2.26E+00. . ... . .. . .. . .. . .. * .. . .. . .. . .. . .3.82E+00. . ... . .. . .. . .. . .DV . * . .. . .. . .. . .. . .5.38E+00. * . ... . .. . .. . .. . * .. . .. . .. . .. . .. . * .6.94E+00. . ... . .. . .. . .. . .. . .. * . .. . .. . .. * *.8.50E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.5. A scatterplot of the observed data (DV) vs thepredictions of the best-fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.3. A Population Model for PhenobarbitalAbout 60 infants were given phenobarbital therapeutically.A plasma concentration was measured in each some hours afterthe first (loading) dose, followed by multiple maintenancedoses. A second, and sometimes a third concentration weremeasured later. In all, 155 concentrations were observed.Figure 2.6 gives the NM-TRAN control records. The data aretoo lengthy to show in full, but figure 2.7 shows the datafor the first individual&dagger;.<cite>&dagger; File PHENO of NONMEM distribution medium contains the &#9474;complete data set. </cite>Figures 2.8 - 2.10 have some relevant output. Again, mostof the analysis results are apparent from the figures, andyou should try to see if you can figure them out beforegoing further. Note that the $INPUT record now defines anew data item, WT, the patient weight. It&rsquo;s value is givenon every data record for an individual, in the columnindicated. This is so despite the fact that WT may notchange within an individual. This is a bit repetitious, butconvenient.$PROBLEM PHENOBARB$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)CL=TVCL+ETA(1)TVVD=THETA(2)V=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0047) (0,.99)$OMEGA .0000055, .04$SIGMA 25$ESTIMATION PRINT=5$TABLE ID TIME AMT WT APGR$COVARIANCE$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.6. NM-TRAN control records for analysis of somepopulation phenobarbital data.1 0. 25.0 1.4 7 .1 2.0 . 1.4 7 17.31 12.5 3.5 1.4 7 .1 24.5 3.5 1.4 7 .1 37.0 3.5 1.4 7 .1 48.0 3.5 1.4 7 .1 60.5 3.5 1.4 7 .1 72.5 3.5 1.4 7 .1 85.3 3.5 1.4 7 .1 96.5 3.5 1.4 7 .1 108.5 3.5 1.4 7 .1 112.5 . 1.4 7 31.0Figure 2.7. The first individual&rsquo;s phenobarbital data.3.1. The NM-TRAN Control RecordsThe records are very similar to those for the theophyllineproblem. The new features are that the model has changed(it is implemented by ADVAN1, not ADVAN2), the model for thepharmacokinetic parameters is more complicated, and anadditional scatterplot is requested. The data for eachinfant is similar to those shown in figure 2.7; however, nowall of the data records for each infant start with the samevalue for the ID data item (column 1), but this valuediffers between infants.3.2. The ModelADVAN1 implements the one-compartment (monoexponential)model, without first order absorption. No absorption modelwas needed for this problem because all concentrations weremeasured many hours after the last (oral) dose, soabsorption could be considered to be complete, and, for thepurposes of data analysis, immediate.The parameters of the one-compartment model are defined bythe abbreviated code following the $PK statement: Clearance(CL) and Volume of Distribution (V). However, here eachparameter is not simply equal to one of NONMEM&rsquo;s parameters(an element of THETA). Rather, CL, for example, is equal toa parameter (THETA(1)) plus a new term, ETA(1). The latterexpresses interindividual variability, and stands for thedeviation of the individual&rsquo;s true clearance (CL) from thepopulation value (TVCL, Typical Value of CLearance, which,in turn, is simply THETA(1)). This model is essentiallydifferent from the theophylline model, because itincorporates interindividual variability (something that anindividual model need not do). Note that since PREDPPultimately needs the values of microconstants, rather thanphysiological-based pharmacokinetic parameters such asclearance, code must be given for K, the rate constant ofelimination. There is, though, a simple alternative towriting this additional line of code. It is discussed inChapter 3 Section 2.1.The abbreviated code after the $ERROR record is exactly thesame as that with the theophylline data and expresses thesame model for lack-of fit between observations andpredictions for an individual. The $OMEGA and $SIGMArecords, which give NONMEM information about the estimatedvariances of the ETA and ERR variables, are discussed inChapter 9, Section 3. Previously the initial estimate ofthe variance of ERR(1) was given on a $OMEGA record. Hereit is given on a $SIGMA record. This difference in NONMEMconventions between individual type data and population typedata will be discussed more fully in Chapters 3 and 4.3.3. The OutputNONMEM is again instructed to estimate the parameters andtheir standard errors. The results are shown in figures 2.8and 2.9.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 717.203 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 25.48E-03 1.40E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 6.85E-06ETA2 0.00E+00 2.86E-01SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.01E+00Figure 2.8. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) andthe parameter estimates for the phenobarbital problem.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 24.86E-04 7.84E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.27E-06ETA2 ......... 8.34E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.49E+00Figure 2.9. NONMEM output giving the standard errors of theparameter estimates for the phenobarbital problem.Note that now there are estimates of the variances of theinterindividual differences in CL (OMEGA - ETA1) and V(OMEGA - ETA2), as well as of the residual error variance(denoted by SIGMA in NONMEM output when the data are from apopulation; again, see Chapters 3 and 4). There are alsostandard errors for these estimates.The next-to-last control record asks NONMEM to make the samekind of scatterplot as in the theophylline problem: a plotof the predictions vs the observations. Here, a predictionfor an individual&rsquo;s observation is based on typical(population) values of the pharmacokinetic parameters (seefigure 2.8), rather than the values of the pharmacokineticparameters for the specific individual. The plot is shownin figure 2.10.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. * .. . .. * * ** * * .. * * ** * * * .. .* .. * *3 * * * .1.80E+01. * *** *2 * ... * * 3*2 * .. 2 * . *2 2* * * .. *2 **2*. * * * * .. *2* 2 . * * .. *2 * ** * ** * .. ** *** 3. * * * .. * . 2 * * .. * 2 . ** * * * .. * * *.2 * * .3.10E+01. * **** 2** ... * ** . .. * 22* * * .. * * . * .. ** * . .DV . * * ** * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.10. A scatterplot of the observed data (DV) vs thepredictions with the best fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.Here, in contrast to figure 2.5, the data arise from manydifferent individuals. One cannot tell which data came fromwhich infant.Although the fit is fairly good, the points far to the rightof the line of identity of figure 2.10 indicate that thereare many predictions (PRED) that are much higher than theircorresponding observations (DV). This is seen from anotherpoint of view in the second scatterplot. This scatterplotplots residuals (RES) vs patient weight (from the data item,WT &mdash; see figure 2.6). A residual is the difference betweenan observed concentration and its prediction (the sameprediction used in the scatterplot of figure 2.10). Theresiduals reflect not only lack of fit between observationsand predictions for a given individual (the variance SIGMA),but also interindividual variability (the variancescomprising OMEGA). They can be thought of as reflecting thepart of the data that the model does not explain. As can beseen from figure 2.11, there is a clear relationship betweenthe sign and magnitude of the residuals and patient weight.Here, the patients with the largest weights have the mostnegative residuals; i.e., their predictions are much largerthan their observations. These are the same points thatfell on the far right of figure 2.10.RES VS. WT-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. . * .. *. *** 2 * **2 .. . .. . * 2 .. * 23 2* * .. . .. * **. **23* .. * 22 **2 4*3* * * .1.14E+00. . ... * * .*2*42*** .. *** 34** .. . .. * ***222224* .. . .. * ** ** ****** .. . .. . .. * * ***3 * .1.78E+00. **2 ** 2* ... . .. ** * * .* .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... 2 . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. 2 * * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 2.11. A scatterplot of the residuals (RES) vspatient weight (WT). The pattern suggests that observationsare underpredicted in infants with low weight, andoverpredicted in those with higher weights.An obvious explanation is that Clearance or Volume, or both,increase with weight, so that without weight being takeninto account, too high a prediction is being made for alarger infant and too low a prediction is being made for asmaller infant, all other things (i.e., dose) being equal.To see if accounting for weight improves the fit, the runspecified in figure 2.12 can be done.$PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0027) (0,.70) .0018 .5$OMEGA .000007, .3$SIGMA 8$ESTIMATION PRINT=5$COVARIANCE$TABLE ID TIME AMT WT APGR DV$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.12. NM-TRAN control records for fitting a modeltaking into account the effect of patient weight to thepopulation phenobarbital data.Now both TVCL and TVVD are linear functions of weight with,in the case of TVCL, for example, intercept THETA(1), andslope THETA(3). Both slope and intercept are &quot;population&quot;parameters since they relate weight to typical populationvalues of the pharmacokinetic parameter. Now we see why WTis given in every data record: the abbreviated PK code mayneed to be evaluated at each event time. If WT did notchange over time within any patient, it could be given onlyon the first data record for each patient, but then slightlymore complicated abbreviated code would be needed. Theoutput from running the input of figure 2.12 is shown infigures 2.13 - 2.16.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 609.134 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 41.43E-11 1.21E-01 4.77E-03 9.18E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 1.36E-06ETA2 0.00E+00 7.51E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.71E+00Figure 2.13. The minimum objective function value andparameter estimates for the phenobarbital data, using themodel of figure 2.12, which takes into account the effect ofpatient weight.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 49.49E-11 1.46E-01 2.24E-04 1.13E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 7.24E-07ETA2 ......... 3.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.71E+00Figure 2.14. The standard errors of the parameter estimatesfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Note the improvement in the minimum objective function value(it drops 108 points), and the profound decreases in thesizes of the estimates of the interindividual variances; nowthat weight is in the model, there is less unexplainedinterindividual variability. As will be discussed inChapter 5, the decrease in the objective function can beused for a formal hypothesis test of the appropriateness ofthe new model (figure 2.12) for the effect of weight on thepharmacokinetic parameters.Note also the very small values estimated for THETA(1) andfor its standard error. The intercept term of TVCL does notappear to be an important part of the model. This model isrefined in Chapter 10, Section 6.2, where it is seen thatdeleting THETA(1) and THETA(3) produces a model that fits aswell as the model including them.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * ** ** .. * * . * * ** * .. * . .. *** *2 * * .1.80E+01. *.**3* * ... * 2*32 .. *22* * * * * * .. * *4** * . * 2 .. *2 * * .* * * .. * * 2* . * 2 * * .. **2 2 * . ** * * .. * 2 .* * .. * ** 2 * . * * .. * * * * * * * .3.10E+01. * * 2* * * * * ... ** .* .. ** ** * ** * . .. * ** . .. * * * . .DV . * * * ** . * * * .. * * . .. ** . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. * .. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.15. A scatterplot of predictions vs observationsfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Compare to figure 2.10.The scatterplots (figures 2.15 and 2.16) confirm that thenew model is an improvement: the group of points far to theright of the line of identity have disappeared from the PREDvs DV plot, and the plot of residuals vs weight no longershows a pattern.RES VS. WT-1.70E+01 -1.00E+01 -3.00E+00 RES 4.00E+00 1.10E+01 1.80E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * .. * * * * * * * . 2* * .. . .. *** . .. * * * *.* * * * * * .. . .. * * * * * ***** * .. * * ** * *. * ** 22 *2 * 2 * .1.14E+00. . ... * * * * * * **** * * * * * .. * * ** * 3 . 2* * .. . .. * 2 ***2. ** * 2* * ** ** .. . .. * * 3 *. ** * * * .. . .. . .. * *** . * * * * * .1.78E+00. * * . 2* ** * * ... . .. * * * ** .. . .. . .WT . *. * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * . .. . .. . .. . .. . .. . 2 .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.16. A scatterplot of residuals (RES) vs patientweight (WT) for the phenobarbital data, using the model offigure 2.12, which takes into account the effect of patientweight. Compare to figure 2.11.4. OverviewThe examples in this chapter illustrate some of the mostimportant and useful features of NONMEM.&deg; NONMEM can fit both individual and population models.&deg; NONMEM has a menu of pharmacokinetic models from whichthe one appropriate to the problem at hand can bechosen.&deg; The user specifies the relationship of pharmacokineticparameters to independent variables (such as WT in thephenobarbital example), using &quot;population&quot; parametersthat will be estimated.&deg; The user also specifies which parameters vary betweenindividuals, and the form (model) for this variability,as well as the form (model) for the differences betweenobservations from an individual and their predictionsfor this individual.&deg; NONMEM estimates parameters describing both kinds ofvariability.&deg; NONMEM provides estimates (standard errors) of theprecision of its parameter estimates, including thosedescribing variability.&deg; NONMEM provides a means of deciding whether one model(e.g., that including weight&rsquo;s effect on CL and V) fitsthe data better than another using the minimumobjective function value, a goodness-of-fit statistic.&deg; NONMEM provides (limited) graphics, useful in judgingthe adequacy of the model currently fit to the data.</a><br>
<a href="#1. What This Chapter is AboutIn this chapter, the notation and definitions we will use todiscuss models for individual data will be presented. Therelationship of these models to data will be discussed, anda distinction between pharmacokinetic structural models(that describe the underlying shape and form of the data)and statistical error models (that describe the &quot;errors&quot; ordifferences between observations and structural modelpredictions) will be made. Several error models will bediscussed, as will a useful modelling device, the indicatorvariable.2. Pharmacokinetic Structural Models for Individual DataBy individua__________ dat____ we usually mean data from a singleindividual (animal or human). One could also be concernedwith data comprised of a pharmacokinetic response at justone time point from each of a number of individuals. Callthis type of data single_______ respons________ populatio__________ data_____ Thisname comes from the fact that data such as these can, ofcourse, be regarded as a particular instance of the moregeneral data type, populatio__________ data_____ i.e., data comprised ofone or more pharmacokinetic responses at different timepoints from a number of individuals sampled from apopulation. Although one can discuss the treatment ofsingle-response population data as population data, they areoften treated just as are individual data.A simple pharmacokinetic model for data from a singleindividual is the monoexponential (&quot;one-compartment&quot;) model:This model describes the typical time course of amount ofdrug in the body ( ), as a function of initial dose ( ),time ( ), and a parameter, . As we may be interested inat several possible times, we explicitly note this by thesubscript which indexes a list of times,.A way to write a generic form for a structural model,omitting details of its structure, iswhere stands for some &quot;response&quot; (dependent variable) ofinterest ( in (3.1)), the symbol stands for theunspecified form of the model (a monoexponential such as in(3.1)), which is a function of known quantities, ( andin (3.1)), and parameters, ( in (3.1)). The quantitiesin x are known, because they are either measured orcontrolled, and therefore, are called fixe_____ effects________ incontrast to effects which are not known and are regarded asrandom (see below). The parameters in the parameter vectorare called fixe_____ effec______ parameter__________ because they quantifythe influence of the fixed effects on the dependentvariable. Each one of an individual&rsquo;s pharmacokineticparameters is a particular type of fixed effect parameter.With NONMEM, parameters comprising are (usually) fixedeffect parameters, but these may or may not be anindividual&rsquo;s pharmacokinetic parameters (contrast figures2.1 and 2.6). Here we shall use the symbol for theparameter vector comprised specifically of an individual&rsquo;spharmacokinetic parameters (although there will be someexception to this).Aside from the fact that the values given by a structuralmodel are usually not the values observed due to measurementerror or model misspecification, an amount of drug ( of(3.1)) is usually not itself observable. Instead, we mayobserve a concentration ( ) of drug. We need an&quot;observation scaling&quot; model to describe the relationshipbetween and . This might bewhere V is another parameter, Volume of Distribution. (Wedenote the concentration in model (3.3) by the symbol ,to distinguish it, the model-predicted value, from the actuallyobserved value,. This will soon be discussed further.) PREDPP assumes thatthere is always an observation scaling model like (3.3) that relates anamount of drug (in somecompartment of the body)to the observation, and therefore always expects aparameter, that scales (i.e. divides) the predicted amount in thecompartment. In the exampleabove, is simply . In other examples, to be discussed later,can be more complicated. If a value for is not specified, it is taken to be 1.For therest of this discussion, it is convenient to assume that itself includes ascaling parameter (if such is needed, and even though such a parameter is notusually regarded as one of an individual&rsquo;s pharmacokinetic parameters) and thatactually includes observational scaling.Note, considering the example of (3.3), that, and . Thusand of (3.1) are in general lists of things (vectors),not single things (scalars).PREDPP implements a number of pharmacokinetic models, suchas the one-compartment model (3.1), (3.3). These will bediscussed more fully in Chapter 7. There is no need forfurther general discussion of kinetic models, as we assumethe readers of this document are familiar withpharmacokinetics. However, two modelling features deservefurther comment, alternative parameterizations and thespecial parameter, .2.1. Alternative ParameterizationsRecall the phenobarbital example of Chapter 2. For thefirst run, the input contained, among other things, somelines of code defining the variables and , and then thelineK = CL/VThis line was needed because PREDPP expects theone-compartment model to be parameterized using theparameter , the rate constant of elimination, not clearanceand volume of distribution. However, we chose to estimatetypical population values for and , so we had to relatethese parameters to THETA and then relate to and .This is an example of reparametrization of a model so thatthe pharmacokinetic parameters used are those of primaryinterest to the modeler. In fact, we may use anyparameterization we wish, so long as we are willing toinclude the reparameterization line(s) that translate ourparameters into those expected by PREDPP. (Chapter 7discusses the parameters PREDPP expects for the variousmodels it implements.) However, there is a program calledTRANS which automatically does this translation. Differentversions of TRANS exist in the PREDPP Library and correspondto translations of different parameterizations into thatexpected by PREDPP.2.2. The Scale Parameter,Usually, observations are concentrations. So, as in model(3.3), will usually be set identical to . However, isnot always simply . Some examples should clarify thispoint. (In the discussion below, we avoid the notation ,and use , to refer to the scale term for the amount in thecompartment in which concentrations are being measured.)2.2.1. Depends on a Known ConstantThis almost trivial case occurs when one wishes to match theunits of predicted responses to those of the data. Forexample, suppose is in milligrams, but concentrations arein ng/ml. If no scaling is done, the units of will bekiloliters (i.e., =1 corresponds to =1000 liters). Toavoid this, one might choose the modelthereby converting the units of into micrograms, andsince mcg/L ng/ml, the units of become liters.Of course, one could recode one&rsquo;s data, dividing all concentrationsby 1000 (or multiplying the dose by 1000) and avoid this,but that may not be convenient.2.2.2. Depends on a ParameterLater in this chapter we will discuss a model used when thedata arise from two different assays (call them assay 1 andassay 2). In such a case, there may be a systematic(multiplicative) bias of one assay relative to the other.If we wish to allow for this possibility, we might need amodel such aswhere is a new parameter that measuresthe proportional bias of the assays (i.e., bias causes theapparent volume of distribution to be different for data fromthe two assays).The parameter is not really a pharmacokinetic parameter, butfor the purpose of this discussion it can be included in .2.2.3. Depends on an Element ofLater in this chapter we will describe a model useful whentwo kinds of responses are measured, plasma and urineconcentrations. In the case of urine concentrations, thepredicted total drug in the urine during a time period(available from an &quot;output&quot; compartment present in allmodels implemented by PREDPP; see Chapter 7) would have tobe scaled by the actual urine volume during that timeperiod. This volume would be an element of , and wouldbe set equal to it.3. Statistical Model for an Individual&rsquo;s ObservationsOne does not, in fact, ever observe the predicted plasmaconcentration (or any other predicted response). What oneobserves is a measured value which differs from thepredicted value by some (usually small) amount called aresidua________ erro_____ (also called intra-individual error). Weregard this error as a random quantity (see below). We willwant NONMEM to fit our model to our data, and in so doing,provide us with estimates of the model parameters. The wayNONMEM&rsquo;s fit follows the data is determined largely by whatwe tell it about the nature of the errors (see Chapter 5).We must therefore provide NONMEM with another model, anerror model.There are many reasons that the actual observation may notcorrespond to the predicted value (e.g. as given by theright side of (3.3)) The structural model may only beapproximate, or the quantities in may have been measuredwith error, or, as is always true, pharmacokinetic responsesmay be measured with some error (assay error). It is toodifficult to model all these sources of error separately, sowe usually make the simplifying assumption that eachdifference between an observation and its prediction (i.e.each error) is a randomly occurring number. When the dataare from a single individual, and the error model is theAdditive error model (see Section 3.1, below), the error isdenoted by herein, by ETA in NONMEM output, and by ETA orERR in NM-TRAN input. (When data are from a population, andthe same error model is used, this error will be denoted ;see Chapter 4.) Therefore a model for the jth observation,, could be writtenImplicit in using the symbol in this way is the assumptionthat all residual errors come from probability distributionswith mean zero and the same (usually unknown) variance.(The error variance is the mean squared error.) Morecomplicated error models involving can be written (seebelow). A schematic of model (3.4) is shown for thestructural model of (3.1), (3.3) in figure 3.1. Becausethis model describes the influence of both fixed effects( ) and random effects ( ), it is called a Mixe_____ Effect_______Mode_____ (hence the name, NONMEM: NONlinear Mixed EffectsModel). Mixed effects models, in general, may have morethan one random effect, and more than one type of randomeffect (Chapter 4); (3.4) is only a particularly simpleexample.Figure 3.1. vs for a monoexponential model. The solidline is ; the circles are the observed data points.An error is indicated.Even though errors are unpredictable random quantities, someinformation about them is usually assumed, and some can beestimated. First, it is assumed that the mean error iszero. This simply means that were the true values for theparameters in known, the model would have no systematicoverall bias (e.g., be systematically below or above thedata points, on average).A second aspect of the error, one that can be estimated byNONMEM, is its typical size. Since errors may be positiveor negative, their typical size is not given by their mean(which is zero), but by their standard deviation, the squareroot of their variance. One can always simply convert thevariance into the standard deviation, and conversely.NONMEM output gives estimates of the error variance. Withindividual data this variance is denoted in this text by ,and by OMEGA in NONMEM input and output. The standarddeviation (SD) of the error is denoted herein. The reasonthat OMEGA, rather than, for example, OMEGA SQ stands forin NONMEM input and output will be discussed in Section 3.8.(We will see, in Chapter 4, that when the error issymbolized by , not , its variance will be denoted inthis text, and SIGMA, not OMEGA, in NONMEM input andoutput.) Here, the parameter quantifies the influence ofthe random effect, on the observations, . It istherefore called a rando______ effect_______ parameter__________3.1. The Additive Error ModelThe symbol is always used to denote a random quantitywhose probability distribution has mean zero and variance. Model (3.4) says that the errors themselves can be soregarded, and since an observation equals its prediction(under the structural model) plus an error, model (3.4) iscalled the Additiv________ error model. This model is illustratedin figure 3.2.Figure 3.2. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for additive errors. Don&rsquo;t be fooled by theapparent widening of the gap between the upper and lowercurves as time increases: the vertical distance from themiddle line to either outer line is everywhere the same.3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsNONMEM allows an error model which can be more complicatedthan that of (3.4). One such more complicated, but usefulmodel is the Constan________ Coefficien___________ o__ Variatio_________ (CCV)______ orProportiona____________ error model,A fractional error is an error expressed as a fraction ofthe corresponding prediction. The CCV model says that afractional error can be written as an , i.e. as a randomquantity with mean zero and variance . Under this model,the variance of an error itself is proportional to thesquared prediction, with being the proportionalityfactor, and so is not constant over observations. Since,under this model, the standard deviation of the error, andalso of , is , and since the mean of is(when assumes its true value), the coefficient ofvariation of is just the constant (the coefficient ofvariation of a random quantity is defined as its standarddeviation divided by its mean). This is the reason the CCVerror model is so named. Also for this reason, isdimensionless, in contrast to having units equal to those ofthe squared observation as with the Additive model. Thiserror model is illustrated in figure 3.3.Figure 3.3. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for constant coefficient of variation errors.The exponentia___________ error model is &#9474;This model is sometimes referred to as the log-normal model, &#9474;because it it is additive if &#9474;logs are taken (and because eta sj is assumed to be normally distributed):&#9474;See Chapter 8, Section 3.2 for a discussion of this model.3.3. Combined Additive and CCV Error ModelWhen most observations obey the CCV model but someobservations may be near the lower limit of detection of anassay, a model which may be useful is one which is acombination of both the Additive and CCV error models:Here there are two types of &rsquo;s, and .The first has variance ; the secondhas a possibly different variance,. NONMEM permits several types of &rsquo;s.Under this model, the variance of the error portion of the model is.When the prediction is near zero, the variance is approximately constant,namely . This is the smallest variance possibleand corresponds, perhaps, to the limit of assay precision.When the prediction is considerably greater than zero, the variance isapproximately proportional to the squared prediction.3.4. The Power Function ModelA model that has both the additive and the CCV error modelsas special cases, and smoothly interpolates between them inother cases is the Power Function model:Here is raised to the power in the error model,rather than the power (Additive error model; notefor any number, ) or the first power (CCV model). Theparameter is a fixed effects parameter, even though itsrole in the overall model is to modify the variance model,not the structural model. With NONMEM all fixed effectparameters must be elements of the general parameter vector. If we want the Power Function Model to interpolatebetween the additive and CCV models, must be constrainedto lie between 0 and 1. NONMEM allows this (see Chapter 9).While one might be tempted to combine the Power Functionmodel with the Additive model, much as the CCV and Additivemodel were combined above, such a combination model can leadto identifiability difficulties, and for this reason such acombination should be avoided.3.5. Two Different Types of MeasurementsAnother more complicated error model can arise when morethan one type of measurement is made. Suppose, for sake ofillustration, that the observations are drug concentrations,but that they are measured with two different assays. Ifone assay may be more precise than the other, then this isequivalent to saying that one assay has a smaller thanthe other. We would like to be able to take this intoaccount in the analysis (i.e., not pay as much attention tothe less precise observations), and perhaps (if we haveenough data) estimate the relative precision of the assaysas well. To do this in the notation we have introduced, anindependent variable indicating which observations areobtained with which assay is needed: we call such anindependent variable an indicator variable.3.5.1. Use of an Indicator VariableLet one of the data items (an element of ) be labeled ,and let take the value 1 if the assay used for wasof the first type, and the value 0, if it was of the 2ndtype. The variable, is an indicator variable, and itallows us to write an additive type error model, say, asHere there are two types of &rsquo;s, and .The first applies to the firsttype of assay, and has variance ; the second appliesto the second type of assay, and has a possibly different variance,. NONMEM permits several types of &rsquo;s.Different types of &rsquo;s can be correlated, and NONMEM can allow this.However, this is something we wouldonly need to consider in the example at hand if the same blood sample weremeasured by both assays.We will not emphasize this possibility in this introductory guide.(This possibility also applies to random variables describingunexplained interindividual differences with population data; see Chapter 4)When the assay is done by the first method, will beunity, and (3.8) becomesso that the variance of the error is .When the assay is done by the second method, will be zero, and(3.7) becomesso that the variance of the error is now .Both and are random effect parameters.An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.6. Two Different Types of ObservationsThe same need for separate scales for different measurementscan arise when more than one type of observation is made.Suppose both plasma concentrations ( ) and urineconcentrations ( ) are measured. The structural model formight be (3.1), (3.3). If we assume that urine iscollected between each observation of , then the structuralmodel for , the drug concentration in the urine collectedbetween time and time might bewhere is the fraction of drug excreted unchanged (aparameter), and is the urine volume collected betweentime and (a data item)&dagger;.<cite>&dagger; With all PREDPP pharmacokinetic models there is an outputcompartment for which the total amount of drug leaving thesystem is computed automatically. The concentration in theurine is then obtained by setting the scaling parameter forthe output compartment to . </cite>Assuming again, for sake of the example, that we want to usean additive type error model for the observations, theproblem is that urine concentrations can be orders ofmagnitude larger than plasma concentrations, so that, whilean additive error model might be appropriate for either typeof observation alone, the two types of observations musthave different typical error magnitudes; i.e., differentvariances ( &rsquo;s).An indicator variable can again be used. Let the indicatorvariable be unity if the observation is a , and 0if it is a . We now need to use it for both thestructural and error models, so that:A little thought shows that the indicator variable selectsthe correct prediction ( or ) and the correct error termfor each observation ( ).An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.7. More Than One Indicator VariableOf course, there could be three types of assays, or more,and similarly, more than two types of observations. Oneusually needs one less indicator variable than types ofthings to be distinguished. So, if there were three assays,one would define and . would be 1 if theassay were of the first type, and zero otherwise; wouldbe 1 if the assay were of the second type, and zerootherwise. The error model for the data would require threetypes of &rsquo;s, , , and .Equation (3.11) results in the following:An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.8. The General Mixed Effects Model for an IndividualWe have just seen examples of more complicated error modelsthan the simple Additive model. We here give a mathematicalform for the most general mixed effects model that isconsidered within the scope of this document:where is a vector valued function of and parameters(where the latter is interpreted broadly to contain parameterssuch as of (3.7)), andis a vector of different different types.The notation denotes vectortranspose. When there is more than one type, there willbe several &rsquo;s, one for each type. The collection of theseis denoted and is labeled OMEGA in NONMEM input and output.This collection is regarded as a diagonal matrix (diagonal for now;but see Chapter 4), rather than as a vector. We will use thesymbol and interchangeably in thistext to denote the (diagonal) element of this matrix foundin position .">1. What This Chapter is AboutIn this chapter, the notation and definitions we will use todiscuss models for individual data will be presented. Therelationship of these models to data will be discussed, anda distinction between pharmacokinetic structural models(that describe the underlying shape and form of the data)and statistical error models (that describe the &quot;errors&quot; ordifferences between observations and structural modelpredictions) will be made. Several error models will bediscussed, as will a useful modelling device, the indicatorvariable.2. Pharmacokinetic Structural Models for Individual DataBy individua__________ dat____ we usually mean data from a singleindividual (animal or human). One could also be concernedwith data comprised of a pharmacokinetic response at justone time point from each of a number of individuals. Callthis type of data single_______ respons________ populatio__________ data_____ Thisname comes from the fact that data such as these can, ofcourse, be regarded as a particular instance of the moregeneral data type, populatio__________ data_____ i.e., data comprised ofone or more pharmacokinetic responses at different timepoints from a number of individuals sampled from apopulation. Although one can discuss the treatment ofsingle-response population data as population data, they areoften treated just as are individual data.A simple pharmacokinetic model for data from a singleindividual is the monoexponential (&quot;one-compartment&quot;) model:This model describes the typical time course of amount ofdrug in the body ( ), as a function of initial dose ( ),time ( ), and a parameter, . As we may be interested inat several possible times, we explicitly note this by thesubscript which indexes a list of times,.A way to write a generic form for a structural model,omitting details of its structure, iswhere stands for some &quot;response&quot; (dependent variable) ofinterest ( in (3.1)), the symbol stands for theunspecified form of the model (a monoexponential such as in(3.1)), which is a function of known quantities, ( andin (3.1)), and parameters, ( in (3.1)). The quantitiesin x are known, because they are either measured orcontrolled, and therefore, are called fixe_____ effects________ incontrast to effects which are not known and are regarded asrandom (see below). The parameters in the parameter vectorare called fixe_____ effec______ parameter__________ because they quantifythe influence of the fixed effects on the dependentvariable. Each one of an individual&rsquo;s pharmacokineticparameters is a particular type of fixed effect parameter.With NONMEM, parameters comprising are (usually) fixedeffect parameters, but these may or may not be anindividual&rsquo;s pharmacokinetic parameters (contrast figures2.1 and 2.6). Here we shall use the symbol for theparameter vector comprised specifically of an individual&rsquo;spharmacokinetic parameters (although there will be someexception to this).Aside from the fact that the values given by a structuralmodel are usually not the values observed due to measurementerror or model misspecification, an amount of drug ( of(3.1)) is usually not itself observable. Instead, we mayobserve a concentration ( ) of drug. We need an&quot;observation scaling&quot; model to describe the relationshipbetween and . This might bewhere V is another parameter, Volume of Distribution. (Wedenote the concentration in model (3.3) by the symbol ,to distinguish it, the model-predicted value, from the actuallyobserved value,. This will soon be discussed further.) PREDPP assumes thatthere is always an observation scaling model like (3.3) that relates anamount of drug (in somecompartment of the body)to the observation, and therefore always expects aparameter, that scales (i.e. divides) the predicted amount in thecompartment. In the exampleabove, is simply . In other examples, to be discussed later,can be more complicated. If a value for is not specified, it is taken to be 1.For therest of this discussion, it is convenient to assume that itself includes ascaling parameter (if such is needed, and even though such a parameter is notusually regarded as one of an individual&rsquo;s pharmacokinetic parameters) and thatactually includes observational scaling.Note, considering the example of (3.3), that, and . Thusand of (3.1) are in general lists of things (vectors),not single things (scalars).PREDPP implements a number of pharmacokinetic models, suchas the one-compartment model (3.1), (3.3). These will bediscussed more fully in Chapter 7. There is no need forfurther general discussion of kinetic models, as we assumethe readers of this document are familiar withpharmacokinetics. However, two modelling features deservefurther comment, alternative parameterizations and thespecial parameter, .2.1. Alternative ParameterizationsRecall the phenobarbital example of Chapter 2. For thefirst run, the input contained, among other things, somelines of code defining the variables and , and then thelineK = CL/VThis line was needed because PREDPP expects theone-compartment model to be parameterized using theparameter , the rate constant of elimination, not clearanceand volume of distribution. However, we chose to estimatetypical population values for and , so we had to relatethese parameters to THETA and then relate to and .This is an example of reparametrization of a model so thatthe pharmacokinetic parameters used are those of primaryinterest to the modeler. In fact, we may use anyparameterization we wish, so long as we are willing toinclude the reparameterization line(s) that translate ourparameters into those expected by PREDPP. (Chapter 7discusses the parameters PREDPP expects for the variousmodels it implements.) However, there is a program calledTRANS which automatically does this translation. Differentversions of TRANS exist in the PREDPP Library and correspondto translations of different parameterizations into thatexpected by PREDPP.2.2. The Scale Parameter,Usually, observations are concentrations. So, as in model(3.3), will usually be set identical to . However, isnot always simply . Some examples should clarify thispoint. (In the discussion below, we avoid the notation ,and use , to refer to the scale term for the amount in thecompartment in which concentrations are being measured.)2.2.1. Depends on a Known ConstantThis almost trivial case occurs when one wishes to match theunits of predicted responses to those of the data. Forexample, suppose is in milligrams, but concentrations arein ng/ml. If no scaling is done, the units of will bekiloliters (i.e., =1 corresponds to =1000 liters). Toavoid this, one might choose the modelthereby converting the units of into micrograms, andsince mcg/L ng/ml, the units of become liters.Of course, one could recode one&rsquo;s data, dividing all concentrationsby 1000 (or multiplying the dose by 1000) and avoid this,but that may not be convenient.2.2.2. Depends on a ParameterLater in this chapter we will discuss a model used when thedata arise from two different assays (call them assay 1 andassay 2). In such a case, there may be a systematic(multiplicative) bias of one assay relative to the other.If we wish to allow for this possibility, we might need amodel such aswhere is a new parameter that measuresthe proportional bias of the assays (i.e., bias causes theapparent volume of distribution to be different for data fromthe two assays).The parameter is not really a pharmacokinetic parameter, butfor the purpose of this discussion it can be included in .2.2.3. Depends on an Element ofLater in this chapter we will describe a model useful whentwo kinds of responses are measured, plasma and urineconcentrations. In the case of urine concentrations, thepredicted total drug in the urine during a time period(available from an &quot;output&quot; compartment present in allmodels implemented by PREDPP; see Chapter 7) would have tobe scaled by the actual urine volume during that timeperiod. This volume would be an element of , and wouldbe set equal to it.3. Statistical Model for an Individual&rsquo;s ObservationsOne does not, in fact, ever observe the predicted plasmaconcentration (or any other predicted response). What oneobserves is a measured value which differs from thepredicted value by some (usually small) amount called aresidua________ erro_____ (also called intra-individual error). Weregard this error as a random quantity (see below). We willwant NONMEM to fit our model to our data, and in so doing,provide us with estimates of the model parameters. The wayNONMEM&rsquo;s fit follows the data is determined largely by whatwe tell it about the nature of the errors (see Chapter 5).We must therefore provide NONMEM with another model, anerror model.There are many reasons that the actual observation may notcorrespond to the predicted value (e.g. as given by theright side of (3.3)) The structural model may only beapproximate, or the quantities in may have been measuredwith error, or, as is always true, pharmacokinetic responsesmay be measured with some error (assay error). It is toodifficult to model all these sources of error separately, sowe usually make the simplifying assumption that eachdifference between an observation and its prediction (i.e.each error) is a randomly occurring number. When the dataare from a single individual, and the error model is theAdditive error model (see Section 3.1, below), the error isdenoted by herein, by ETA in NONMEM output, and by ETA orERR in NM-TRAN input. (When data are from a population, andthe same error model is used, this error will be denoted ;see Chapter 4.) Therefore a model for the jth observation,, could be writtenImplicit in using the symbol in this way is the assumptionthat all residual errors come from probability distributionswith mean zero and the same (usually unknown) variance.(The error variance is the mean squared error.) Morecomplicated error models involving can be written (seebelow). A schematic of model (3.4) is shown for thestructural model of (3.1), (3.3) in figure 3.1. Becausethis model describes the influence of both fixed effects( ) and random effects ( ), it is called a Mixe_____ Effect_______Mode_____ (hence the name, NONMEM: NONlinear Mixed EffectsModel). Mixed effects models, in general, may have morethan one random effect, and more than one type of randomeffect (Chapter 4); (3.4) is only a particularly simpleexample.Figure 3.1. vs for a monoexponential model. The solidline is ; the circles are the observed data points.An error is indicated.Even though errors are unpredictable random quantities, someinformation about them is usually assumed, and some can beestimated. First, it is assumed that the mean error iszero. This simply means that were the true values for theparameters in known, the model would have no systematicoverall bias (e.g., be systematically below or above thedata points, on average).A second aspect of the error, one that can be estimated byNONMEM, is its typical size. Since errors may be positiveor negative, their typical size is not given by their mean(which is zero), but by their standard deviation, the squareroot of their variance. One can always simply convert thevariance into the standard deviation, and conversely.NONMEM output gives estimates of the error variance. Withindividual data this variance is denoted in this text by ,and by OMEGA in NONMEM input and output. The standarddeviation (SD) of the error is denoted herein. The reasonthat OMEGA, rather than, for example, OMEGA SQ stands forin NONMEM input and output will be discussed in Section 3.8.(We will see, in Chapter 4, that when the error issymbolized by , not , its variance will be denoted inthis text, and SIGMA, not OMEGA, in NONMEM input andoutput.) Here, the parameter quantifies the influence ofthe random effect, on the observations, . It istherefore called a rando______ effect_______ parameter__________3.1. The Additive Error ModelThe symbol is always used to denote a random quantitywhose probability distribution has mean zero and variance. Model (3.4) says that the errors themselves can be soregarded, and since an observation equals its prediction(under the structural model) plus an error, model (3.4) iscalled the Additiv________ error model. This model is illustratedin figure 3.2.Figure 3.2. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for additive errors. Don&rsquo;t be fooled by theapparent widening of the gap between the upper and lowercurves as time increases: the vertical distance from themiddle line to either outer line is everywhere the same.3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsNONMEM allows an error model which can be more complicatedthan that of (3.4). One such more complicated, but usefulmodel is the Constan________ Coefficien___________ o__ Variatio_________ (CCV)______ orProportiona____________ error model,A fractional error is an error expressed as a fraction ofthe corresponding prediction. The CCV model says that afractional error can be written as an , i.e. as a randomquantity with mean zero and variance . Under this model,the variance of an error itself is proportional to thesquared prediction, with being the proportionalityfactor, and so is not constant over observations. Since,under this model, the standard deviation of the error, andalso of , is , and since the mean of is(when assumes its true value), the coefficient ofvariation of is just the constant (the coefficient ofvariation of a random quantity is defined as its standarddeviation divided by its mean). This is the reason the CCVerror model is so named. Also for this reason, isdimensionless, in contrast to having units equal to those ofthe squared observation as with the Additive model. Thiserror model is illustrated in figure 3.3.Figure 3.3. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for constant coefficient of variation errors.The exponentia___________ error model is &#9474;This model is sometimes referred to as the log-normal model, &#9474;because it it is additive if &#9474;logs are taken (and because eta sj is assumed to be normally distributed):&#9474;See Chapter 8, Section 3.2 for a discussion of this model.3.3. Combined Additive and CCV Error ModelWhen most observations obey the CCV model but someobservations may be near the lower limit of detection of anassay, a model which may be useful is one which is acombination of both the Additive and CCV error models:Here there are two types of &rsquo;s, and .The first has variance ; the secondhas a possibly different variance,. NONMEM permits several types of &rsquo;s.Under this model, the variance of the error portion of the model is.When the prediction is near zero, the variance is approximately constant,namely . This is the smallest variance possibleand corresponds, perhaps, to the limit of assay precision.When the prediction is considerably greater than zero, the variance isapproximately proportional to the squared prediction.3.4. The Power Function ModelA model that has both the additive and the CCV error modelsas special cases, and smoothly interpolates between them inother cases is the Power Function model:Here is raised to the power in the error model,rather than the power (Additive error model; notefor any number, ) or the first power (CCV model). Theparameter is a fixed effects parameter, even though itsrole in the overall model is to modify the variance model,not the structural model. With NONMEM all fixed effectparameters must be elements of the general parameter vector. If we want the Power Function Model to interpolatebetween the additive and CCV models, must be constrainedto lie between 0 and 1. NONMEM allows this (see Chapter 9).While one might be tempted to combine the Power Functionmodel with the Additive model, much as the CCV and Additivemodel were combined above, such a combination model can leadto identifiability difficulties, and for this reason such acombination should be avoided.3.5. Two Different Types of MeasurementsAnother more complicated error model can arise when morethan one type of measurement is made. Suppose, for sake ofillustration, that the observations are drug concentrations,but that they are measured with two different assays. Ifone assay may be more precise than the other, then this isequivalent to saying that one assay has a smaller thanthe other. We would like to be able to take this intoaccount in the analysis (i.e., not pay as much attention tothe less precise observations), and perhaps (if we haveenough data) estimate the relative precision of the assaysas well. To do this in the notation we have introduced, anindependent variable indicating which observations areobtained with which assay is needed: we call such anindependent variable an indicator variable.3.5.1. Use of an Indicator VariableLet one of the data items (an element of ) be labeled ,and let take the value 1 if the assay used for wasof the first type, and the value 0, if it was of the 2ndtype. The variable, is an indicator variable, and itallows us to write an additive type error model, say, asHere there are two types of &rsquo;s, and .The first applies to the firsttype of assay, and has variance ; the second appliesto the second type of assay, and has a possibly different variance,. NONMEM permits several types of &rsquo;s.Different types of &rsquo;s can be correlated, and NONMEM can allow this.However, this is something we wouldonly need to consider in the example at hand if the same blood sample weremeasured by both assays.We will not emphasize this possibility in this introductory guide.(This possibility also applies to random variables describingunexplained interindividual differences with population data; see Chapter 4)When the assay is done by the first method, will beunity, and (3.8) becomesso that the variance of the error is .When the assay is done by the second method, will be zero, and(3.7) becomesso that the variance of the error is now .Both and are random effect parameters.An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.6. Two Different Types of ObservationsThe same need for separate scales for different measurementscan arise when more than one type of observation is made.Suppose both plasma concentrations ( ) and urineconcentrations ( ) are measured. The structural model formight be (3.1), (3.3). If we assume that urine iscollected between each observation of , then the structuralmodel for , the drug concentration in the urine collectedbetween time and time might bewhere is the fraction of drug excreted unchanged (aparameter), and is the urine volume collected betweentime and (a data item)&dagger;.<cite>&dagger; With all PREDPP pharmacokinetic models there is an outputcompartment for which the total amount of drug leaving thesystem is computed automatically. The concentration in theurine is then obtained by setting the scaling parameter forthe output compartment to . </cite>Assuming again, for sake of the example, that we want to usean additive type error model for the observations, theproblem is that urine concentrations can be orders ofmagnitude larger than plasma concentrations, so that, whilean additive error model might be appropriate for either typeof observation alone, the two types of observations musthave different typical error magnitudes; i.e., differentvariances ( &rsquo;s).An indicator variable can again be used. Let the indicatorvariable be unity if the observation is a , and 0if it is a . We now need to use it for both thestructural and error models, so that:A little thought shows that the indicator variable selectsthe correct prediction ( or ) and the correct error termfor each observation ( ).An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.7. More Than One Indicator VariableOf course, there could be three types of assays, or more,and similarly, more than two types of observations. Oneusually needs one less indicator variable than types ofthings to be distinguished. So, if there were three assays,one would define and . would be 1 if theassay were of the first type, and zero otherwise; wouldbe 1 if the assay were of the second type, and zerootherwise. The error model for the data would require threetypes of &rsquo;s, , , and .Equation (3.11) results in the following:An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.8. The General Mixed Effects Model for an IndividualWe have just seen examples of more complicated error modelsthan the simple Additive model. We here give a mathematicalform for the most general mixed effects model that isconsidered within the scope of this document:where is a vector valued function of and parameters(where the latter is interpreted broadly to contain parameterssuch as of (3.7)), andis a vector of different different types.The notation denotes vectortranspose. When there is more than one type, there willbe several &rsquo;s, one for each type. The collection of theseis denoted and is labeled OMEGA in NONMEM input and output.This collection is regarded as a diagonal matrix (diagonal for now;but see Chapter 4), rather than as a vector. We will use thesymbol and interchangeably in thistext to denote the (diagonal) element of this matrix foundin position .</a><br>
<a href="#1. What This Chapter is AboutIn this chapter, models for data from (animal or human)populations will be discussed. These models describeobservations from a number of individuals sampled from thepopulation. The distinguishing feature of the data to whichsuch models apply is that there is more than one observationfrom some (usually most) individuals. A population modelincludes the structural model of Chapter 3, but also a newmodel, which shall be called the paramete_________ model______ for eachindividual&rsquo;s kinetic parameters. The parameter model canhave both fixed and random effects. A population model alsoincludes the error model of Chapter 3.2. GeneralIndividuals differ, and the types, degrees and causes ofthese differences are often what we want to learn. NONMEMwas designed to help us learn these things. Theseindividual differences can be due to fixed and/or randomeffects, but they all manifest themselves by affecting thevalue of an individual&rsquo;s parameters, . That is, first,each individual is regarded as having his own particularvalue of . If the data come from individuals,then we may rewrite the (not completely) general mixedeffects model, (3.4) for , the observation from theindividual, asEq (4.1) is now (part of) a population model because itexplicitly recognizes, through the subscript, , that thedata come from distinct individuals. Note too that we havewritten , rather than . According to NONMEM conventions,when modeling data from a population, the random effects inthe residual errors are denoted by , their individualvariances by , and the collection of the variances by thematrix , denoted SIGMA in NONMEM input and output. We alsoadopt the same convention here as we did for : thediagonal element of is interchangeably denoted or .When dealing with population data, the symbol is reservedfor random effects influencing the vectors , as is nowexplained. We can write a general model (but not yet asgeneral a model as we will present later) for :It is called the paramete_________ model______ Here, is a structural(though non-kinetic) type model (of which examples will begiven shortly), which is a function of fixed effects, ,and fixed effects parameters, . Note that since, ingeneral, is a vector, must be a vector-valued function,and for the same reason, is usually a vector. This willbe discussed further later. All fixed effects, whether theyare part of the kinetic structural model, or are part of theparameter model, are input to NONMEM in a uniform way. Forthe purposes of this discussion, the symbol is used forthe particular fixed effects in , such as the individual&rsquo;sheight, weight, and so forth (this will be discussed furtherin a moment). Even though most often is regarded as timeinvariant, as is done in most of the discussion in thisdocument, fixed effects can change with time, and thuskinetic parameters within can change with time. This willbe discussed further in Section 3.4.2.3. Structural Parameter ModelsThe symbol in (4.2) for the fixed effects parameter vectoris , not . As mentioned in Chapter 3, we reserve thesymbol , in this document, for an individual&rsquo;s fixed effectparameters and use the symbol for a vector of population(fixed effects and possibly random effects) parameters.Recall the phenobarbital example of Chapter 2. For thesecond run, the input contained the line of codeTVCL = THETA(1) + THETA(3)*WTTranslated into the symbols we are using here, this isIn (4.3), and are the first and third elements of theparameter vector , and is an element of (recall thatthis value of weight appears as a data item). The tildeover is meant to distinguish this typical populationvalue of clearance from the individual&rsquo;s actual value ofclearance. According to this model, will be the samefor any two individuals both of whom have the same value ofweight. Equation (4.3) defines an element (the oneassociated with clearance) of the vector-valued function .Note that in (4.3), we use the subscript to stress thatthis equation applies to the individual, but there is noconfusion when, as in the NM-TRAN input, and in thefollowing, the subscript is omitted. It should always beunderstood that all variables and data items used in theparameter model definition refer to the same individual.Many different models are possible to describe thedependence of individual parameters on fixed effects.However, certain model forms are simple, easy to use, andcover most cases. An assortment of these will be discussedbriefly next.3.1. Linear ModelsThe simplest form that can take, and the most common, isone that is linear in . An example is (4.3): all elementsof appear as linear coefficients of terms involving dataitems. The data items themselves can appear nonlinearly,without affecting the linearity with respect to . Forexample, if clearance is the sum of renal and non-renalcomponents, and renal clearance is believed to beproportional to renal function as described according to astandard formula involving the elements of : age ( ),serum creatinine ( ), and weight ( ), then one mightwriteClearly, is a nonlinear function of , for example,and so, therefore, is , but is linear in , and (4.4 -4.6) is still considered a linear model. (Do not worry aboutthe non-consecutive numbering of the elements of ; a modelfor is being developed (an alternative to 4.3), and themissing elements and will appear presently.)3.2. Multiplicative ModelsMultiplicative models are linear models, but on alogarithmic scale. For example, if patients covering a verywide range of weights are studied, metabolic clearance mightvary with weight, but not linearly, and a substitute for(4.4) might beNote that the logarithm of ( ) is linear in ,but itself is not. Of course, (4.4.1) can also bewrittenModels (4.4.1) and (4.4.2) are equivalent so far as isconcerned, but of (4.4.2) corresponds to of(4.4.1).3.3. Saturation ModelsA useful model for processes reaching a maximum is ahyperbolic model. For example, if a second drug, (whosesteady-state plasma concentration, is known andavailable in the data set), is present in some individualsand it is believed that this second drug is an inhibitor ofthe metabolism of the study drug, one might wish to useThis model is shown in figure 4.1. The inhibition isexpressed by the ratio occurring within the brackets and isa concave hyperbola, asymptoting to a maximum value equal to. It is identical in form to the familiarMichaelis-Menten model.Figure 4.1. A hyperbolic model for metabolic clearance ofdrug on the ordinate, as inhibited by another drug atsteady-state concentration on the abscissa.3.4. Models with Indicator VariablesIndicator variables were discussed in Chapter 3 inconnection with the error model. They can be quite usefulwhen modelling individual parameters. They are usually usedin a linear model. For example, if the clinical condition,heart failure, is noted as &quot;present&quot; or &quot;absent&quot;, one candefine an indicator variable, which equals 0 if heartfailure is absent, and 1 if it is present. If metabolicclearance is thought to be affected by heart failure, onemight chooseHere, the non-heart-failure cases will have , while the heart-failure cases will have &dagger;.<cite>&dagger; Heart failure is expected to decrease metabolicclearance. If it does, using a minus sign in (4.4.4) allows themore pleasing result that will be estimatedas positive. The model is identical to one with a positive sign,but then would probably be negative.If were constrained to be non-negative,then the sign chosen in the model statement would, of course, beimportant.</cite>3.4.1. CombinationsGiven the basic building blocks of linear, multiplicativeand saturation models, these can be combined in the usualalgebraic ways (usually by addition) to make more complexmodels. For example, one could use (4.4.3), (4.5), and(4.6) as a model for . A non-additive example arises ifplasma and urine concentrations are both observed and(kinetic) model (3.6) is to be used for the latter. Theparameter , the fraction of drug excreted unchanged intothe urine might be modeled aswhere is given by (4.5) and by(4.6) (using any of the (4.4) variants).3.4.2. Time VaryingAs mentioned in Section 2, although most of the time thedata items affecting an individual&rsquo;s do not change overthe course of his data, they occasionally do, and PREDPP canhandle this. For example, if an individual had heartfailure for part of his observation period, but not therest, , according to (4.4.4) should change. Or, ifacute renal failure occurred during a patient&rsquo;s observationperiod, would change, according to model (4.5).PREDPP implements its kinetic model recursively: given thestate of the system at time (by state we mean the amountsof drug in all the compartments), it updates (i.e. advances)the state to that at time , using the value of (and ingeneral, the value of ) at time to compute a value ofholding between times and . The value of used tocompute this is that value found on the data record withtime . So, in order to have change appropriately asdoes, one places a value of which is typical for the timeperiod to on the data record associated with thetime point . This will not always be easy since therelevant element(s) of may not be measured at, forexample, the midpoint of the time interval (the value at theof the time interval is a good choice for thevalue for the interval). If not, one will have touse some interpolation method to arrive at the typicalvalue. The important point is that the values of theindependent variables at time determine the values ofthe individual&rsquo;s parameters applying to the entire periodto .3.5. Structural Kinetic ModelsThe kinetic models (i.e., the models for responses such asdrug concentrations) used when performing a populationanalysis do not differ at all from those used for anindividual analysis. One still needs a model for therelationship of to and , and this relationship does notdepend on whether changes from individual to individual orwith time within an individual.4. Population Random Effects ModelsUnder NONMEM conventions, there are two levels of randomeffects, and and are the symbols used for the vectors offirst and second level random effects, respectively. Withdata from a single individual, only first-level randomeffects are needed. However, with data from a population ofindividuals, both first- and second-level random effects areneeded. First-level effects are needed in the parametermodel to help model unexplainable interindividualdifferences in , and second-level effects are needed in the(intraindividual) error model. For example, in (4.2) thereis an element of , , that is the difference between theindividual value (an element of ) and , the typicalvalue of . This is a first-level random effect. In (4.1)is the error between and . This is asecond-level random effect.4.1. Models for Interindividual ErrorsThe difference between and is called aninterindividua_______________ error______ It arises from a few sources: thefunction may be only approximate, and/or may be measuredwith error. It is regarded as a random quantity, and it maybe modeled in terms of variables. As usual, each of thesevariables is assumed to have mean 0 and a variance denotedby which may be estimated. This variance describesbiological population variability.The difference between and is called anintraindividua_______________ error______ It has been discussed at some lengthin Chapter 3. Although in that discussion about individualdata, this difference was modeled in terms of variables,in this discussion about population data, it is modeled interms of variables. Each variable is assumed to havemean 0 and a variance denoted by which also may beestimated.Each pair of elements in has a covariance, and NONMEM canalso estimate this, although often we choose to assume thatthe covariance is zero (we made this same assumption for the &#9474;different elements of in Chapter 3, Section 3.5.1).A covariance between two elements of , and , say, is ameasure of statistical association between these two randomvariables. Their covariance is related to theircorrelation, ( ) by(Note that now that we are suppressingthe subscript on, we may, without confusion, use the subscript positionto designate elements of .)The variances and covariances among the elements of arelaid out in a covarianc__________ matrix_______ called , and labeled OMEGAin NONMEM input and output. This matrix was defined in &#9474;Chapter 3, Section 3.8, but some additional comment here may &#9474;be helpful. If has, for example, 3 elements, has thefollowing form:Here, as previously, is another way of writing thevariance , and ( ) is the covariance between and.The elements , , are called the diagona________ element________of the matrix. If the nondiagonal elements (thecovariances) are all zero, i.e. the correlation among allpairs of elements is zero, the matrix is called a diagonalmatrix. The lowe_____ triangula__________ element________ of the matrix are theelementsTo specify the matrix only its lower triangular elementsneed be given (and these are all NONMEM does give), sincefrom (4.8) it is clear that for all , . &#9474;4.1.1. Additive/Multiplicative Models and the Exponential &#9474;ModelFrequently, the model for an interindividual error is thesimple additive one (as in (4.2)), such asA feature of (4.9) is that the resulting units for dependon the units of the parameter ( in this case). Forexample, this model was used in the theophylline problem ofChapter 2 (Figure 2.6). The final estimate of is .286(Figure 2.8). Assuming that the units of V are liters, weinterpret this to mean that the standard deviation of Vbetween individuals is .53 Liters ( .53 = ).Perhaps even more often, a multiplicative model equivalentto the Constant Coefficient of Variation (CCV) error model(3.5) is used, such asThis model is also referred to as the proportional error &#9474;model.A feature of (4.10) is that the resulting units for areindependent of the units of the parameter ( in this case).When this model is used in the theophylline problem insteadof the additive model, so that Figure 2.6 contains the codeV=TVVD*(1+ETA(2)) instead of V=TVVD+ETA(2), then NONMEMestimates to be .146. We interpret this to mean that thecoefficient of variation of V in the population is 38% (.38= ).The exponential model is &#9474;During simulation, the exponential and proportional modelsgive different results. During estimation by thefirst-order method, the exponential model andproportional models give identical results, i.e., NONMEMcannot distinguish between them. During estimation by aconditional estimation method, the exponential andproportional models for inter-individual variability givedifferent results. The exponential model is preferred forconditional estimation methods. (See NONMEM User&rsquo;s GuidePart VII, Conditional Estimation Methods.)4.1.2. Other ModelsOccasionally, a model for an individual&rsquo;s pharmacokineticparameter might involve scaling an , as in (3.6), or two ormore &rsquo;s as in (3.10). For example, a study might involvepatients in the intensive care unit (ICU) and others onnon-acute care units. It might be reasonable to supposethat some aspects of the kinetics of ICU patients (e.g.,metabolic clearance of drug) are more variable, due tounmeasured factors (e.g., hepatic function) that varygreatly among acutely ill patients. Even though thevariation is, in reality, due to a potentially measurablefixed effect (hepatic function), if information on thisfixed effect is not available, differences caused by it mustbe assigned to random factors ( ). In this case, one mightwish to use an indicator variable, (which equals 1 ifthe patient is in the ICU, and 0, otherwise), and a modelsuch asIn addition to model (4.11) we might have, for example,Models (4.11) and (4.12) together, along with suitablemodels for and , form a complete model for anindividual&rsquo;s parameter, and involve 3 &rsquo;s.4.1.3. General Form for the Parameter ModelAs we have just seen in (4.10) and in (4.11)-(4.12), anelement of need not act in a simple additive way and mayact solely on an intermediate variable (e.g. ).Indeed, there may be more or fewer elements in than in ,the elements in may act in nonlinear ways to influence ,and one element of may influence more than a singleelement of . We now give a more general form for theparameter model than (4.2) and then an example illustratingit.The general form of the parameter model isHere, is a very general function of fixed effects, ,fixed effects parameters, , and a vector of &rsquo;s, . Thedimensions of the vectors and need not be the same.An individual&rsquo;s kinetic parameter may change with time. Asexplained in Section 1.6, with NONMEM-PREDPP changes canoccur only at discrete time points. Therefore, theparameter actually can be regarded as being a number ofparameters, each one applying to a different time period.The parameter in (4.13), being a vector of all thekinetic parameters for the individual, can be regardedas encompassing these time-interval-specific parameters.An example utilizing this generality is provided by a modelfor observations of both plasma and urine drugconcentrations, similar to the one presented previously.Ignoring the details of the structural part of the model,consider the following modelIn this model, ; the parameters andare regarded as intermediate parameters. We have, where both and influence both(linearly) and (nonlinearly).4.2. Statistical Models for an Individual&rsquo;s ObservationsModel (4.1) can be generalized by incorporating a model likethose given in Chapter 3 for the residual errors, i.e. forthe differences between the and , rather thanusing just the simple Additive model. A particular instanceof such a model may have several types of &rsquo;s, and asmentioned in Section 2, the variances of these &rsquo;s aredenoted by &rsquo;s. With a population model these variancescould change from individual to individual. With NONMEM,they are considered as constants over individuals. The &rsquo;scan co-vary. A covariance matrix , like the matrix givenin Section 4.1, gives the variances and covariances of the&rsquo;s, as already discussed at the end of Chapter 3. Thisdoes not preclude the magnitudes of the errors from beingaffected by fixed effects. A model such as (3.8) can stillbe used. This is shown explicitly by the general modelgiven in the next section.5. The Population Mixed Effects ModelWe have now presented all of the parts needed to fullydefine a population model. It may be useful to recap thisinformation by stating the entire general model here:, independent for, independent for, independent for all ,where here, is a vector, along with , , and ,and and are square matrices with dimensions equal tothose of and .To try to represent the relationship between all the fixedand random effects of a population model graphically,consider figure 4.2. The model corresponding to this figureiswhere the are all equal to a constant , i.e. there is norandom interindividual variability in the volume ofdistribution, so that for the sake of this example, isjust a scalar.Figure 4.2. Random and fixed effects influence observation,, from the population point of view. Open circle, lowerleft, is population parameter predicted clearance, closedcircle is true clearance for individual which differsfrom population prediction by , chosen randomly from adistribution (upper left) with mean 0 and SD .Similarly, lower right, the observed at time (opensquare) differs by from the true value (closed circle)by an error , chosen independently from a distributionwith mean 0 and SD . The corresponding to thepopulation-based prediction is also shown (upper curve, opencircle).">1. What This Chapter is AboutIn this chapter, models for data from (animal or human)populations will be discussed. These models describeobservations from a number of individuals sampled from thepopulation. The distinguishing feature of the data to whichsuch models apply is that there is more than one observationfrom some (usually most) individuals. A population modelincludes the structural model of Chapter 3, but also a newmodel, which shall be called the paramete_________ model______ for eachindividual&rsquo;s kinetic parameters. The parameter model canhave both fixed and random effects. A population model alsoincludes the error model of Chapter 3.2. GeneralIndividuals differ, and the types, degrees and causes ofthese differences are often what we want to learn. NONMEMwas designed to help us learn these things. Theseindividual differences can be due to fixed and/or randomeffects, but they all manifest themselves by affecting thevalue of an individual&rsquo;s parameters, . That is, first,each individual is regarded as having his own particularvalue of . If the data come from individuals,then we may rewrite the (not completely) general mixedeffects model, (3.4) for , the observation from theindividual, asEq (4.1) is now (part of) a population model because itexplicitly recognizes, through the subscript, , that thedata come from distinct individuals. Note too that we havewritten , rather than . According to NONMEM conventions,when modeling data from a population, the random effects inthe residual errors are denoted by , their individualvariances by , and the collection of the variances by thematrix , denoted SIGMA in NONMEM input and output. We alsoadopt the same convention here as we did for : thediagonal element of is interchangeably denoted or .When dealing with population data, the symbol is reservedfor random effects influencing the vectors , as is nowexplained. We can write a general model (but not yet asgeneral a model as we will present later) for :It is called the paramete_________ model______ Here, is a structural(though non-kinetic) type model (of which examples will begiven shortly), which is a function of fixed effects, ,and fixed effects parameters, . Note that since, ingeneral, is a vector, must be a vector-valued function,and for the same reason, is usually a vector. This willbe discussed further later. All fixed effects, whether theyare part of the kinetic structural model, or are part of theparameter model, are input to NONMEM in a uniform way. Forthe purposes of this discussion, the symbol is used forthe particular fixed effects in , such as the individual&rsquo;sheight, weight, and so forth (this will be discussed furtherin a moment). Even though most often is regarded as timeinvariant, as is done in most of the discussion in thisdocument, fixed effects can change with time, and thuskinetic parameters within can change with time. This willbe discussed further in Section 3.4.2.3. Structural Parameter ModelsThe symbol in (4.2) for the fixed effects parameter vectoris , not . As mentioned in Chapter 3, we reserve thesymbol , in this document, for an individual&rsquo;s fixed effectparameters and use the symbol for a vector of population(fixed effects and possibly random effects) parameters.Recall the phenobarbital example of Chapter 2. For thesecond run, the input contained the line of codeTVCL = THETA(1) + THETA(3)*WTTranslated into the symbols we are using here, this isIn (4.3), and are the first and third elements of theparameter vector , and is an element of (recall thatthis value of weight appears as a data item). The tildeover is meant to distinguish this typical populationvalue of clearance from the individual&rsquo;s actual value ofclearance. According to this model, will be the samefor any two individuals both of whom have the same value ofweight. Equation (4.3) defines an element (the oneassociated with clearance) of the vector-valued function .Note that in (4.3), we use the subscript to stress thatthis equation applies to the individual, but there is noconfusion when, as in the NM-TRAN input, and in thefollowing, the subscript is omitted. It should always beunderstood that all variables and data items used in theparameter model definition refer to the same individual.Many different models are possible to describe thedependence of individual parameters on fixed effects.However, certain model forms are simple, easy to use, andcover most cases. An assortment of these will be discussedbriefly next.3.1. Linear ModelsThe simplest form that can take, and the most common, isone that is linear in . An example is (4.3): all elementsof appear as linear coefficients of terms involving dataitems. The data items themselves can appear nonlinearly,without affecting the linearity with respect to . Forexample, if clearance is the sum of renal and non-renalcomponents, and renal clearance is believed to beproportional to renal function as described according to astandard formula involving the elements of : age ( ),serum creatinine ( ), and weight ( ), then one mightwriteClearly, is a nonlinear function of , for example,and so, therefore, is , but is linear in , and (4.4 -4.6) is still considered a linear model. (Do not worry aboutthe non-consecutive numbering of the elements of ; a modelfor is being developed (an alternative to 4.3), and themissing elements and will appear presently.)3.2. Multiplicative ModelsMultiplicative models are linear models, but on alogarithmic scale. For example, if patients covering a verywide range of weights are studied, metabolic clearance mightvary with weight, but not linearly, and a substitute for(4.4) might beNote that the logarithm of ( ) is linear in ,but itself is not. Of course, (4.4.1) can also bewrittenModels (4.4.1) and (4.4.2) are equivalent so far as isconcerned, but of (4.4.2) corresponds to of(4.4.1).3.3. Saturation ModelsA useful model for processes reaching a maximum is ahyperbolic model. For example, if a second drug, (whosesteady-state plasma concentration, is known andavailable in the data set), is present in some individualsand it is believed that this second drug is an inhibitor ofthe metabolism of the study drug, one might wish to useThis model is shown in figure 4.1. The inhibition isexpressed by the ratio occurring within the brackets and isa concave hyperbola, asymptoting to a maximum value equal to. It is identical in form to the familiarMichaelis-Menten model.Figure 4.1. A hyperbolic model for metabolic clearance ofdrug on the ordinate, as inhibited by another drug atsteady-state concentration on the abscissa.3.4. Models with Indicator VariablesIndicator variables were discussed in Chapter 3 inconnection with the error model. They can be quite usefulwhen modelling individual parameters. They are usually usedin a linear model. For example, if the clinical condition,heart failure, is noted as &quot;present&quot; or &quot;absent&quot;, one candefine an indicator variable, which equals 0 if heartfailure is absent, and 1 if it is present. If metabolicclearance is thought to be affected by heart failure, onemight chooseHere, the non-heart-failure cases will have , while the heart-failure cases will have &dagger;.<cite>&dagger; Heart failure is expected to decrease metabolicclearance. If it does, using a minus sign in (4.4.4) allows themore pleasing result that will be estimatedas positive. The model is identical to one with a positive sign,but then would probably be negative.If were constrained to be non-negative,then the sign chosen in the model statement would, of course, beimportant.</cite>3.4.1. CombinationsGiven the basic building blocks of linear, multiplicativeand saturation models, these can be combined in the usualalgebraic ways (usually by addition) to make more complexmodels. For example, one could use (4.4.3), (4.5), and(4.6) as a model for . A non-additive example arises ifplasma and urine concentrations are both observed and(kinetic) model (3.6) is to be used for the latter. Theparameter , the fraction of drug excreted unchanged intothe urine might be modeled aswhere is given by (4.5) and by(4.6) (using any of the (4.4) variants).3.4.2. Time VaryingAs mentioned in Section 2, although most of the time thedata items affecting an individual&rsquo;s do not change overthe course of his data, they occasionally do, and PREDPP canhandle this. For example, if an individual had heartfailure for part of his observation period, but not therest, , according to (4.4.4) should change. Or, ifacute renal failure occurred during a patient&rsquo;s observationperiod, would change, according to model (4.5).PREDPP implements its kinetic model recursively: given thestate of the system at time (by state we mean the amountsof drug in all the compartments), it updates (i.e. advances)the state to that at time , using the value of (and ingeneral, the value of ) at time to compute a value ofholding between times and . The value of used tocompute this is that value found on the data record withtime . So, in order to have change appropriately asdoes, one places a value of which is typical for the timeperiod to on the data record associated with thetime point . This will not always be easy since therelevant element(s) of may not be measured at, forexample, the midpoint of the time interval (the value at theof the time interval is a good choice for thevalue for the interval). If not, one will have touse some interpolation method to arrive at the typicalvalue. The important point is that the values of theindependent variables at time determine the values ofthe individual&rsquo;s parameters applying to the entire periodto .3.5. Structural Kinetic ModelsThe kinetic models (i.e., the models for responses such asdrug concentrations) used when performing a populationanalysis do not differ at all from those used for anindividual analysis. One still needs a model for therelationship of to and , and this relationship does notdepend on whether changes from individual to individual orwith time within an individual.4. Population Random Effects ModelsUnder NONMEM conventions, there are two levels of randomeffects, and and are the symbols used for the vectors offirst and second level random effects, respectively. Withdata from a single individual, only first-level randomeffects are needed. However, with data from a population ofindividuals, both first- and second-level random effects areneeded. First-level effects are needed in the parametermodel to help model unexplainable interindividualdifferences in , and second-level effects are needed in the(intraindividual) error model. For example, in (4.2) thereis an element of , , that is the difference between theindividual value (an element of ) and , the typicalvalue of . This is a first-level random effect. In (4.1)is the error between and . This is asecond-level random effect.4.1. Models for Interindividual ErrorsThe difference between and is called aninterindividua_______________ error______ It arises from a few sources: thefunction may be only approximate, and/or may be measuredwith error. It is regarded as a random quantity, and it maybe modeled in terms of variables. As usual, each of thesevariables is assumed to have mean 0 and a variance denotedby which may be estimated. This variance describesbiological population variability.The difference between and is called anintraindividua_______________ error______ It has been discussed at some lengthin Chapter 3. Although in that discussion about individualdata, this difference was modeled in terms of variables,in this discussion about population data, it is modeled interms of variables. Each variable is assumed to havemean 0 and a variance denoted by which also may beestimated.Each pair of elements in has a covariance, and NONMEM canalso estimate this, although often we choose to assume thatthe covariance is zero (we made this same assumption for the &#9474;different elements of in Chapter 3, Section 3.5.1).A covariance between two elements of , and , say, is ameasure of statistical association between these two randomvariables. Their covariance is related to theircorrelation, ( ) by(Note that now that we are suppressingthe subscript on, we may, without confusion, use the subscript positionto designate elements of .)The variances and covariances among the elements of arelaid out in a covarianc__________ matrix_______ called , and labeled OMEGAin NONMEM input and output. This matrix was defined in &#9474;Chapter 3, Section 3.8, but some additional comment here may &#9474;be helpful. If has, for example, 3 elements, has thefollowing form:Here, as previously, is another way of writing thevariance , and ( ) is the covariance between and.The elements , , are called the diagona________ element________of the matrix. If the nondiagonal elements (thecovariances) are all zero, i.e. the correlation among allpairs of elements is zero, the matrix is called a diagonalmatrix. The lowe_____ triangula__________ element________ of the matrix are theelementsTo specify the matrix only its lower triangular elementsneed be given (and these are all NONMEM does give), sincefrom (4.8) it is clear that for all , . &#9474;4.1.1. Additive/Multiplicative Models and the Exponential &#9474;ModelFrequently, the model for an interindividual error is thesimple additive one (as in (4.2)), such asA feature of (4.9) is that the resulting units for dependon the units of the parameter ( in this case). Forexample, this model was used in the theophylline problem ofChapter 2 (Figure 2.6). The final estimate of is .286(Figure 2.8). Assuming that the units of V are liters, weinterpret this to mean that the standard deviation of Vbetween individuals is .53 Liters ( .53 = ).Perhaps even more often, a multiplicative model equivalentto the Constant Coefficient of Variation (CCV) error model(3.5) is used, such asThis model is also referred to as the proportional error &#9474;model.A feature of (4.10) is that the resulting units for areindependent of the units of the parameter ( in this case).When this model is used in the theophylline problem insteadof the additive model, so that Figure 2.6 contains the codeV=TVVD*(1+ETA(2)) instead of V=TVVD+ETA(2), then NONMEMestimates to be .146. We interpret this to mean that thecoefficient of variation of V in the population is 38% (.38= ).The exponential model is &#9474;During simulation, the exponential and proportional modelsgive different results. During estimation by thefirst-order method, the exponential model andproportional models give identical results, i.e., NONMEMcannot distinguish between them. During estimation by aconditional estimation method, the exponential andproportional models for inter-individual variability givedifferent results. The exponential model is preferred forconditional estimation methods. (See NONMEM User&rsquo;s GuidePart VII, Conditional Estimation Methods.)4.1.2. Other ModelsOccasionally, a model for an individual&rsquo;s pharmacokineticparameter might involve scaling an , as in (3.6), or two ormore &rsquo;s as in (3.10). For example, a study might involvepatients in the intensive care unit (ICU) and others onnon-acute care units. It might be reasonable to supposethat some aspects of the kinetics of ICU patients (e.g.,metabolic clearance of drug) are more variable, due tounmeasured factors (e.g., hepatic function) that varygreatly among acutely ill patients. Even though thevariation is, in reality, due to a potentially measurablefixed effect (hepatic function), if information on thisfixed effect is not available, differences caused by it mustbe assigned to random factors ( ). In this case, one mightwish to use an indicator variable, (which equals 1 ifthe patient is in the ICU, and 0, otherwise), and a modelsuch asIn addition to model (4.11) we might have, for example,Models (4.11) and (4.12) together, along with suitablemodels for and , form a complete model for anindividual&rsquo;s parameter, and involve 3 &rsquo;s.4.1.3. General Form for the Parameter ModelAs we have just seen in (4.10) and in (4.11)-(4.12), anelement of need not act in a simple additive way and mayact solely on an intermediate variable (e.g. ).Indeed, there may be more or fewer elements in than in ,the elements in may act in nonlinear ways to influence ,and one element of may influence more than a singleelement of . We now give a more general form for theparameter model than (4.2) and then an example illustratingit.The general form of the parameter model isHere, is a very general function of fixed effects, ,fixed effects parameters, , and a vector of &rsquo;s, . Thedimensions of the vectors and need not be the same.An individual&rsquo;s kinetic parameter may change with time. Asexplained in Section 1.6, with NONMEM-PREDPP changes canoccur only at discrete time points. Therefore, theparameter actually can be regarded as being a number ofparameters, each one applying to a different time period.The parameter in (4.13), being a vector of all thekinetic parameters for the individual, can be regardedas encompassing these time-interval-specific parameters.An example utilizing this generality is provided by a modelfor observations of both plasma and urine drugconcentrations, similar to the one presented previously.Ignoring the details of the structural part of the model,consider the following modelIn this model, ; the parameters andare regarded as intermediate parameters. We have, where both and influence both(linearly) and (nonlinearly).4.2. Statistical Models for an Individual&rsquo;s ObservationsModel (4.1) can be generalized by incorporating a model likethose given in Chapter 3 for the residual errors, i.e. forthe differences between the and , rather thanusing just the simple Additive model. A particular instanceof such a model may have several types of &rsquo;s, and asmentioned in Section 2, the variances of these &rsquo;s aredenoted by &rsquo;s. With a population model these variancescould change from individual to individual. With NONMEM,they are considered as constants over individuals. The &rsquo;scan co-vary. A covariance matrix , like the matrix givenin Section 4.1, gives the variances and covariances of the&rsquo;s, as already discussed at the end of Chapter 3. Thisdoes not preclude the magnitudes of the errors from beingaffected by fixed effects. A model such as (3.8) can stillbe used. This is shown explicitly by the general modelgiven in the next section.5. The Population Mixed Effects ModelWe have now presented all of the parts needed to fullydefine a population model. It may be useful to recap thisinformation by stating the entire general model here:, independent for, independent for, independent for all ,where here, is a vector, along with , , and ,and and are square matrices with dimensions equal tothose of and .To try to represent the relationship between all the fixedand random effects of a population model graphically,consider figure 4.2. The model corresponding to this figureiswhere the are all equal to a constant , i.e. there is norandom interindividual variability in the volume ofdistribution, so that for the sake of this example, isjust a scalar.Figure 4.2. Random and fixed effects influence observation,, from the population point of view. Open circle, lowerleft, is population parameter predicted clearance, closedcircle is true clearance for individual which differsfrom population prediction by , chosen randomly from adistribution (upper left) with mean 0 and SD .Similarly, lower right, the observed at time (opensquare) differs by from the true value (closed circle)by an error , chosen independently from a distributionwith mean 0 and SD . The corresponding to thepopulation-based prediction is also shown (upper curve, opencircle).</a><br>
<a href="#1. What This Chapter is AboutIn this chapter, we discuss the fitting criterion thatNONMEM uses, parameter estimates, and standard errorestimates. We then discuss how to form confidence intervalsfor parameters and do hypothesis tests with NONMEM.2. Model Fitting CriterionIn principle, all fitting procedures attempt to adjust thevalues of the parameters of the model to give a &quot;best fit&quot;of the predictions to the actual observations. The set ofparameters that accomplish this are called the parameterestimates, and are denoted here as , , and . Methodsdiffer in how they define &quot;best&quot;. The criterion that NONMEMuses is a Least Squares (LS) type criterion. The form ofthis criterion varies as the error model varies, and aspopulation models with multiple random effects must beconsidered. We briefly discuss these various criteria next,to give the reader a feel for what NONMEM is doing. Adetailed knowledge of the statistical basis for the choiceof fitting criterion is not necessary either to use orinterpret NONMEM fits. In this chapter, a fixed effectsparameter will be denoted by a ; the distinction betweenindividual fixed effects parameters ( ) and population fixedeffects parameters will not be important here.2.1. Least Squares for Individual Data with an AdditiveError ModelFor the Additive error model (3.4), the Ordinary LeastSquares criterion (OLS) chooses the estimate so as to makethe sum of squared (estimated) errors as small as possible.These estimates cause the prediction, here denoted , to bean estimate of the mean value of , which is intuitivelyappealing. The prediction is obtained by computing thevalue for y under the model with parameters set to theirestimated values and set to zero&dagger;.<cite>&dagger; , not , since we follow the NONMEM convention and, whendiscussing individual type data as here, use to denote therandom effects of a single level that appear in the model,those in the residual error model. </cite>2.2. Least Squares for Individual Data with Other Types ofError ModelsThe simple OLS criterion just defined becomes inefficientand is no longer the &quot;best&quot; one to use when the error modelis other than the Additive error model. It treats allestimated errors as equally important (i.e. a reduction inthe magnitude of either of two estimated errors that are ofthe same magnitude is equally valuable in that eitherreduction decreases the sum of squared errors by the sameamount), and this results in parameter estimates that causeall errors to have about the same typical magnitude, asassumed under the Additive model. The CCV error model,though, says that the typical magnitude of an error variesmonotonically with the magnitude of the (true) prediction ofy. In principle, Weighted Least Squares (WLS) gives a fitmore commensurate with the CCV or other non-Additive errormodel. WLS chooses as that value of minimizingEach is a weight which, ideally, is set proportional to the inverse ofthe variance of . In the CCV model this variance isproportional to (evaluated at the true valueof ). Use of such weights willdown-weight the importance of estimated squared errors associated with largevalues of and promote the relative contribution of those associatedwith small values of .In many cases, users can supply approximate weights, and theWLS objective function can be used as stated in (5.1).When, as with the CCV model for example, the ideal weightsdepend on the true values of parameters, these true valuescan be replaced by initial estimates, and then the WLSobjective function as given in (5.1) can be minimized.Alternatively, instead of viewing as a function ofonly through the estimated error&rsquo;s dependence on , it canbe viewed as a function of through both that dependenceand also through the ideal weights&rsquo; dependence on . Theentire function can then be minimized with respect to .That this creates a problem is most easily seen when theerror model contains a parameter which is not itself aparameter of the structural model, but which, nonetheless,must be regarded as an element of . Such an error model isthe Power Function model of (3.7), and the &quot;extra&quot; parameteris . The WLS objective function with the reciprocalvariance of substituted for is&dagger;<cite>&dagger; Again, we call attention to the symbols used for therandom effects parameter: the term appears in theobjective function, (5.2), not , because we are discussingindividual type data, not population type data. </cite>In this caseif were setto a very large number, while the other parameters in were only such asto make all , thenall would be very large, and the summation wouldattain a very small value. (The value ofis irrelevant to the minimization with respect to.)Thus, all elements in other thanwould be indeterminate (as long as they were such thatall were greater than 1); a most unsatisfactory state ofaffairs.There is a way to deal with this problem that preserves thespirit of least-squares fitting, and NONMEM uses it. Inessence, it adds to the WLS objective function a termproportional to the sum of the logarithms of the errorvariances. Thus a penalty is paid for increasing the errorvariances without a concomitant decrease in the estimatederrors themselves. This modified objective function iscalled the Extended Least Squares (ELS) objective function.It is minimized with respect to all parameters of thestructural and error models simultaneously (in the currentexample, and , as can be considered an element of ). &#9474;Note that the objective function may be negative. This has &#9474;no particular significance.2.3. Least Squares for Population DataThe complications arising from a population model are dueentirely to the random interindividual effects occurring inthe parameter model. To deal with this, NONMEM uses anapproximation to the true model. The approximate model islinear in all the random effects. For this linearizedmodel, the vector of mean values for the observations fromthe individual is the vector of true predictions forthese observations. These predictions are obtained from themodel by setting the parameters to their true values and bysetting all the elements of both and to zero. In otherwords, these are the true predictions for the meanindividual with fixed effects equal to those of theindividual. For this linearized model it is also possibleto write a formula for the variance-covariance matrix of theobservations from the individual. This matrix is afunction of the individual&rsquo;s fixed effects and thepopulation parameters , , and . Finally, the ELSobjective function discussed above is generalized to be asum over individuals, rather than observations, and wherethe term of the sum involves a squared error between avector of observations and an associated vector ofpredictions, weighted by the reciprocal of the associatedvariance-covariance matrix for the individual.3. Parameter EstimatesIt is useful to consider how to estimate parameters that donot appear in the model we use to fit the data, but are,instead, functions of them (e.g. the half-life parameter, when the rate constant of elimination is themodel parameter).It is always possible, of course, to parameterize the modelin the function of interest. For example, we have alreadyseen (Chapters 2 &amp; 3) that we may use the function(parameter) in the one-compartment model instead of .However, we may be interested in the values of severalalternative parameterizations (e.g., we may want to know k,clearance, and half-life). Rather than rerun the sameproblem with several alternative parameterizations, we canuse the fact that the LS estimate of a function of theparameters is given by the same function of the LS parameterestimates. Formally, if is the function ofinterest, then . E.g. Letting , , and, then .4. Precision of Parameter EstimatesClearly, it is almost impossible for the estimates toactually be the true values. The question is: how far arethe true values from the estimates? To discuss thisquestion, imagine replicating the entire experiment(gathering new data, but keeping fixed) multiple times.Also, for simplicity, imagine that the model has only onescalar parameter, , and that its true value, is known.If, after each replication, the estimate of is recorded,and a histogram of these values is plotted, one might seesomething like figure 5.1A or 5.1B.Figure 5.1. Two hypothetical histograms of estimates of asingle parameter upon replication of a given experiment.Left panel (A): The estimates have small variance (spread)but are biased (the mean of the estimates differs from thetrue value, ); Right panel: The estimates have largevariance but are relatively unbiased.The difference between the estimate and the true value, ,obviously differs from replication to replication. Let thisdifference be called the estimatio__________ error______ We cannot knowthe estimation error of any particular estimate (if wecould, we could know the true value itself, by subtraction),but we can hope to estimate the mean error magnitude. Sinceerrors can be positive or negative, a measure of magnitudethat is unaffected by sign is desirable. This istraditionally the Mean Squared Error ( ). The MSE can befactored into two parts:where is the bias of the estimates (mean (signed) difference between theestimates and the true value) and is the standard error ofthe estimates ( is the variance of the estimates). Asillustrated in figure 5.1, the can be about the same fortwo types of estimates while both their bias anddiffer. It is very hard to estimate the bias of anestimator unless the true parameter value is, in fact, known.This is not true of the : the standard deviation ofthe distribution of estimates of a parameter on replication isthe ; noknowledge of the true value of the parameter is required.In many situations,LS estimators of fixed effects parametersare unbiased, although in nonlinear problems,such as most pharmacokinetic ones, this cannot be assured.4.1. Distribution of Parameters vs Distribution ofParameter EstimatesFigure 5.1 illustrates the distribution of parameterestimates that might result if an experiment werereplicated. The bias and spread depend on the estimationmethod, the design of the experiment ( , which implicitlyincludes ) and on the true parameter values, including thevariances (and covariances) of the random effectsinfluencing . If, for example, more observations wereobtained in each experiment (more individuals in apopulation study), the spread of the estimates (one fromeach experiment) would decrease until, in the limit, if aninfinite number of observations were obtained in eachexperiment, every estimate would be the same (equal to thetrue value plus the bias of the estimator). Thus, thedistribution of the estimate tells us nothing about biologyor measurement error, but only about the of theestimate itself.In contrast, and tell us about unexplained (or random)interindividual variability (biology) or error magnitude(biology plus measurement error), not about how precisely weknow these things. No matter how many observations we make,interindividual variability will remain the same size (butthe variability of our estimate of its size will decrease),as will the measurement error variability of a particularinstrument.It is very important not to confuse variability (e.g.,between individuals) in a model parameter with variabilityin the estimate of that parameter, despite the fact that theterms we use to describe both variabilities are similar.Thus an element of , say has a , , while theestimate of , , also has a given by thesquare of the standard error for . Indeed, the use ofthe term &quot;standard error&quot; rather than &quot;standard deviation&quot;to name a measure of the spread in the distribution of theparameter rather than in the parameter helps callattention to the distinction between these two types ofthings.4.2. Confidence Interval for a Single ParameterAcknowledging that any particular estimate from anyparticular experiment is unlikely to equal the trueparameter value implies that we should be interested in&quot;interval&quot; estimates of parameters as well as (instead of?)point estimates. An interval estimate of a parameter isusually a range of values for the parameter, often centeredat the point estimate, such that the range contains the trueparameter value with a specified probability. Theprobability chosen is often 95%, in which case the intervalestimate is called the 95% Confidence Interval (CI).A CI is often based only on the parameter estimate and its. In the next sections we discuss three questions aboutsuch CIs a little further. (i) How to estimate the froma single set of data (we cannot replicate our experimentmany times and construct a histogram as in figure 5.1).(ii) Given an estimate of , how to use that number tocompute a (95% confidence) interval with 95% chance ofcontaining the true parameter value. (iii) Given anestimate of , how to compute a confidence interval for afunction of the parameter.4.2.1. Estimating a Parameter&rsquo;s Standard ErrorRemarkably, the of a parameter estimate can be estimatedusing only the data from a single experiment. The idea isthat the data give us estimates of the variances of allrandom effects in our model, from which we can estimate thevariability in future data (if we were to replicate theexperiment). That is, the SE of the estimates onreplication depends only on quantities we either know orhave estimates of: the , the number of observed ( ), andthe variances of all random effects.It is a little beyond the scope of this discussion to givethe method by which NONMEM actually estimates the of aparameter estimate; however, examples of how this can bedone are found in any statistical textbook on regression.NONMEM presents the estimated standard error for eachparameter of the model (including the random effectsparameters, and ) as part of its output.4.2.2. Relating the Confidence Interval to theStatistical theory tells us not only how to compute theof a parameter estimate, but also that for a LS estimate(and many other kinds of estimates), the shape of thedistribution of the estimates is approximately Normal if thedata set is large enough. This means that we may usepercentiles of the Normal distribution, to computeconfidence interval bounds (when is small, thedistribution is often used instead; this is discussed instatistics texts). In general, a 100(1- )% confidenceinterval for a single parameter, say, is computed as. Here denotes the percentile of theNormal distribution. As previously noted, is often chosento be .05, in which case is approximately 2.4.2.3. A Confidence Interval for a Function of a SingleParameterAs discussed above, one can reparameterize the model interms of the new parameter, and NONMEM will then estimateits standard error. If re-running the fit presents aproblem, there is a simple way to compute a confidenceinterval for a function of a single parameter. If thelower and upper bounds of a 100(1- )% confidence intervalfor are denoted and , respectively, then a 100(1- )%confidence interval for has lower and upper boundsand , respectively. This confidence interval,however, is not necessarily centered at .4.3. Multiple Parameters4.3.1. Correlation of Parameter EstimatesA truly new feature introduced by multiple parameters is thephenomenon of correlation among parameter estimates. NONMEMoutputs a correlation matrix for the parameter estimates.The element of the matrix is the correlation betweenthe ith and jth parameter estimates. A large correlation(e.g. ) means that the conditional distribution of theith estimate, given a fixed value of the jth estimate,depends considerably on this fixed value. Sometimes eachparameter estimate of a pair that is highly correlated has alarge standard error, meaning that neither parameter can bewell-estimated. This problem may be caused by data that donot distinguish among the parameters very well, while asimpler model, or a different design, or more data mightpermit more precise estimates of each.As a simple example, imagine a straight line fit to just twopoints, both at the same value of : neither slope norintercept can be estimated at all as long as the other isunknown, but fixing either one (simplifying the model)determines the other. Both parameters could be estimated byobserving another point at some other value of (moredata), or, still using just 2 points, by placing thesepoints at two different values of (modifying the design).Thus, when standard errors are large, it is useful toexamine the correlation matrix of parameter estimates tosee, in particular, if some simplification of the model mayhelp.4.3.2. Confidence Intervals for a Function of SeveralParametersThere is an approximate formula for computing a standarderror, and hence a confidence interval for a function ofseveral parameters (e.g., a confidence interval forhalf-life when the estimated parameters are and ). Ituses the standard errors of the parameter estimates and thecorrelations between the parameter estimates. However,discussion of this formula is beyond the scope of thisintroduction. If a confidence interval for a function ofseveral parameters is desired, it is often more convenientto re-fit the data with the model reparameterized to includethe function as an explicit parameter.5. Hypothesis TestingBefore going into details, a note of caution is in orderabout hypothesis testing in general. The logic ofhypothesis testing is that one sets up a hypothesis about aparameter&rsquo;s value, called the nul____ hypothesis___________ and asks ifthe data are sufficiently in conflict with it to call itinto question. If they are, one rejects the nullhypothesis. However, logically, if they are not, one hassimply failed to reject the null hypothesis; one does notnecessarily have sufficient data to accept it. An extremeexample will make this clear. Let the null hypothesis beany assertion at all about the state of nature. Gather noevidence bearing on the question. Clearly, the evidence(which is void) is insufficient to reject the nullhypothesis, but just as clearly, in this case the evidenceprovides no support for it either.In less extreme cases there is a way to view failure toreject as lending some support to the null hypothesis, butthe matter is problematic. It is somewhat less problematicto use a confidence interval to quantify support for a nullhypothesis. A null hypothesis is an assertion that aparameter&rsquo;s true value is found among a set of nul____ values_______A confidence interval puts reasonable bounds on the possiblevalues of a parameter. One can then say that the evidence(the data from which the parameter estimate is derived) doessupport a null hypothesis (about the value of the parameter)if the null values are included in the interval and that theevidence fully support the null hypothesis if all nonnullvalues lie outside. An example will help make this clear.Consider that mean drug clearance in adults varies linearlywith the weight of the individual to a clinicallysignificant degree. Formally, this can be put as astatement about a regression coefficient in a model such asThe null hypothesis might be that is close to zero, i.e.that it is not so different from zero as to be clinically significant. To make this precise, suppose that we know that mean clearancefor a 70 kg person (i.e., ) is about 100 ml/min. Ifwere .20 ml/min/kg or less, a 50 kg increment(decrement) in weight from 70 kg would be associated with less than a 10%change in total clearance. This is clinically insignificant, sothe appropriate null values for might be 0.0 to .20,assuming, of course, that a physical lower bound for theparameter is zero.(More usually in statistical discussions a set of null values consists ofa single number, e.g. 0.)If the confidence interval for only includes nullvalues (e.g., it is .10 to .15),one might then safely conclude that weight, if it has any effectat all, has no significant effect, and thatthe data fully support the null hypothesis.If the confidence interval includes null values and others(e.g., it is 0.0 to .60),one would conclude that there is some support for the null hypothesis,but that there is also some support for rejecting it.In this case the data are insufficient to allow outright acceptance orrejection.If the confidence interval includes no null values (e.g., it is .80 to 1.3),one would reject the null hypothesis and conclude that weight has aclinically significant (linear) effect on clearance.For these reasons, we urge caution when performinghypothesis tests and suggest that confidence intervals areoften more useful. None the less, the popularity ofhypothesis tests requires that they be done, and we nowdescribe two methods for so doing, the first somewhat moreapproximate and less general than the second, but easier todo.5.1. Hypothesis Testing Using theA straight-forward way to test a null hypothesis about thevalue of a parameter is to use a confidence interval forthis purpose. In other words, if the confidence intervalexcludes the null values, then the null hypothesis isrejected. As described in Section 4.2.2, such a confidenceinterval is based on the estimated standard error. Thismethod generalizes to a hypothesis about the values ofseveral parameters simultaneously, but this is beyond thescope of this introduction.5.2. Hypothesis Testing Using the Likelihood RatioAn approach that involves the extra effort of re-fitting thedata has the advantage of being less approximate than theone that uses a confidence interval based on the SE. Thismethod is the so-called Likelihood Ratio Test.The basic idea is to compare directly the goodness of fit(as indicated by the minimum value of the extended leastsquares objective function) obtained between using a modelin which the parameter is fixed to the hypothesized value(the reduced model) and a model in which the parameter mustbe estimated (the full model).5.2.1. Definition &mdash; Full/Reduced ModelsA model is a reduced model of a full model if it isidentical to the full model except that one or moreparameters of the latter have been fixed to hypothesizedvalues (usually 0). Consider the examples:E.g. #1. Valid Full/Reduced Pair:Full model:Reduced model:E.g. #2. Invalid Full/Reduced Pair:Full model:Reduced model:In example #1, fixing to 0 produces the reduced model,while in example #2, no parameter of the full model can befixed to a particular value to yield the &quot;reduced&quot; model.It will always be true that if the models are set upcorrectly, the number of parameters that must be estimatedwill be greater in the full model than in the reduced model.Note that this is not so for example #2.5.2.2. Reduced/Full Models Express the Null/AlternativeHypothesesThe reduced model expresses the null hypothesis; the fullmodel expresses an alternative hypothesis. In example #1above, the null hypothesis is &quot;typical value of clearance isindependent of weight&quot;, and the alternative is &quot;typicalvalue of clearance depends linearly on weight.&quot;Note an important point here: the alternative hypothesisrepresents a particular alternative, and the likelihoodratio test using it will most sensitively reject the nullhypothesis only when this particular alternative holds. Ifthe full model were that &quot;the typical value of clearance isinversely proportional to weight&quot; (so that as weightincreases, the typical value of clearance decreases, asituation which rarely holds), the likelihood ratio testusing the alternative we have stated would not beparticularly sensitive to rejecting the null hypothesis, andwe might fail to do so. In contrast, we might succeed inrejecting the null hypothesis if we used some otheralternative model closer to the truth.5.2.3. The Likelihood Ratio TestPart of the NONMEM output is the &quot;Minimum Value of theObjective Function&quot; (see Chapter 2). Denote this by . IfNONMEM&rsquo;s approximate model were the true model, then wouldbe minus twice the maximum logarithm of the likelihood ofthe data (for those readers unfamiliar with likelihoods, andcurious as to what they are, we suggest consulting astatistics textbook). Statistical theory tells us that thedifference in minus twice the maximum log likelihoodsbetween a full and reduced model can be referenced to aknown distribution. Thus, to perform the Likelihood RatioTest, one proceeds as follows.Let be the minimum value of the objective function fromthe fit to the full model, and let be the correspondingquantity from the fit to the reduced model. Fit both modelsseparately yielding and , and form the statistic,This statistic is approximately distributed chi-square ( )withdegree of freedom, where is the number of parameters whose values arefixed in the reduced model. For an -level test,compare to , the 100(1- )percentile of the distribution.In particular, when exactly one parameter of the full modelis fixed in the reduced model, a decrease of 3.84 in theminimum value of the objective function is significant at.If NONMEM&rsquo;s approximate model (linear in the random effects)were the true model, and in addition, were linear in thefixed effects, then would be (approximately)distributed according to the distribution with , anddegrees of freedom ( ). Since is equal toonly when is &quot;large&quot;, and is greater otherwise, itis more conservative to reference to in allinstances, even when is nonlinear.6. Choosing Among ModelsAn idea related to hypothesis testing is this: when facedwith alternative explanations (models) for some data, howdoes one use the data to determine which model(s) is (are)most plausible? When one of the models is a reducedsub-model of the other, and there is some reason toprefer the reduced model to the alternative, then theLikelihood Ratio test can be used to test whether this apriori preference must be rejected (at the level).However, when one gives the matter some thought, there isusually little objective reason to prefer one model overanother on a priori grounds. For example, although possiblymore convenient, a monoexponential model is, if anything,less likely on biological grounds than a biexponential.Not only may there not be a clear probabilityfavoring one contending model over another, but the twomodels may not form a full and reduced model pair. In suchcircumstances, one must rely on some goodness-of-fitcriterion to distinguish between the models. Considerchoosing between just two models (the ideas to be discussedreadily generalize to more than two), denoted model andmodel . If the number of free parameters in model ( )is the same as that of ( ), then here is a reasonablecriterion: favor the model with the better fit. Note thatthere is no value associated with this statement; nohypothesis is being tested.Unfortunately, if one cannot simply compare andand choose the one with the smaller value. The reason isbest understood when and are a full and reduced modelpair. The full model will always fit the data better (i.e.,have a smaller ) as it has more free parameters to adjustits shape to the data. While the same is not always truefor any pair of non-linear models with different numbers ofparameters, it is often true: the model with the greaternumber of parameters will fit a given data set better thanthe model with fewer parameters. Yet the larger (moreparameters) model may not really be better; it may, in fact,fit an entirely new data set worse than the simpler model ifits better fit to the original data was simply because itexploited the flexibility of its extra parameter(s) tobetter fit some random aspect of that data.Based on the above intuitive argument, it seems that oneshould penalize the larger model in some way beforecomparing the likelihoods. This intuition is formallyrealized in the Akaike Information Criterion (AIC) whichsays that one should compute + , andchoose model if is &gt;0, and model if is &lt;0. Thesecond term penalizes model if , and vice versa.When , the reduces to the comparison of anddescribed previously.">1. What This Chapter is AboutIn this chapter, we discuss the fitting criterion thatNONMEM uses, parameter estimates, and standard errorestimates. We then discuss how to form confidence intervalsfor parameters and do hypothesis tests with NONMEM.2. Model Fitting CriterionIn principle, all fitting procedures attempt to adjust thevalues of the parameters of the model to give a &quot;best fit&quot;of the predictions to the actual observations. The set ofparameters that accomplish this are called the parameterestimates, and are denoted here as , , and . Methodsdiffer in how they define &quot;best&quot;. The criterion that NONMEMuses is a Least Squares (LS) type criterion. The form ofthis criterion varies as the error model varies, and aspopulation models with multiple random effects must beconsidered. We briefly discuss these various criteria next,to give the reader a feel for what NONMEM is doing. Adetailed knowledge of the statistical basis for the choiceof fitting criterion is not necessary either to use orinterpret NONMEM fits. In this chapter, a fixed effectsparameter will be denoted by a ; the distinction betweenindividual fixed effects parameters ( ) and population fixedeffects parameters will not be important here.2.1. Least Squares for Individual Data with an AdditiveError ModelFor the Additive error model (3.4), the Ordinary LeastSquares criterion (OLS) chooses the estimate so as to makethe sum of squared (estimated) errors as small as possible.These estimates cause the prediction, here denoted , to bean estimate of the mean value of , which is intuitivelyappealing. The prediction is obtained by computing thevalue for y under the model with parameters set to theirestimated values and set to zero&dagger;.<cite>&dagger; , not , since we follow the NONMEM convention and, whendiscussing individual type data as here, use to denote therandom effects of a single level that appear in the model,those in the residual error model. </cite>2.2. Least Squares for Individual Data with Other Types ofError ModelsThe simple OLS criterion just defined becomes inefficientand is no longer the &quot;best&quot; one to use when the error modelis other than the Additive error model. It treats allestimated errors as equally important (i.e. a reduction inthe magnitude of either of two estimated errors that are ofthe same magnitude is equally valuable in that eitherreduction decreases the sum of squared errors by the sameamount), and this results in parameter estimates that causeall errors to have about the same typical magnitude, asassumed under the Additive model. The CCV error model,though, says that the typical magnitude of an error variesmonotonically with the magnitude of the (true) prediction ofy. In principle, Weighted Least Squares (WLS) gives a fitmore commensurate with the CCV or other non-Additive errormodel. WLS chooses as that value of minimizingEach is a weight which, ideally, is set proportional to the inverse ofthe variance of . In the CCV model this variance isproportional to (evaluated at the true valueof ). Use of such weights willdown-weight the importance of estimated squared errors associated with largevalues of and promote the relative contribution of those associatedwith small values of .In many cases, users can supply approximate weights, and theWLS objective function can be used as stated in (5.1).When, as with the CCV model for example, the ideal weightsdepend on the true values of parameters, these true valuescan be replaced by initial estimates, and then the WLSobjective function as given in (5.1) can be minimized.Alternatively, instead of viewing as a function ofonly through the estimated error&rsquo;s dependence on , it canbe viewed as a function of through both that dependenceand also through the ideal weights&rsquo; dependence on . Theentire function can then be minimized with respect to .That this creates a problem is most easily seen when theerror model contains a parameter which is not itself aparameter of the structural model, but which, nonetheless,must be regarded as an element of . Such an error model isthe Power Function model of (3.7), and the &quot;extra&quot; parameteris . The WLS objective function with the reciprocalvariance of substituted for is&dagger;<cite>&dagger; Again, we call attention to the symbols used for therandom effects parameter: the term appears in theobjective function, (5.2), not , because we are discussingindividual type data, not population type data. </cite>In this caseif were setto a very large number, while the other parameters in were only such asto make all , thenall would be very large, and the summation wouldattain a very small value. (The value ofis irrelevant to the minimization with respect to.)Thus, all elements in other thanwould be indeterminate (as long as they were such thatall were greater than 1); a most unsatisfactory state ofaffairs.There is a way to deal with this problem that preserves thespirit of least-squares fitting, and NONMEM uses it. Inessence, it adds to the WLS objective function a termproportional to the sum of the logarithms of the errorvariances. Thus a penalty is paid for increasing the errorvariances without a concomitant decrease in the estimatederrors themselves. This modified objective function iscalled the Extended Least Squares (ELS) objective function.It is minimized with respect to all parameters of thestructural and error models simultaneously (in the currentexample, and , as can be considered an element of ). &#9474;Note that the objective function may be negative. This has &#9474;no particular significance.2.3. Least Squares for Population DataThe complications arising from a population model are dueentirely to the random interindividual effects occurring inthe parameter model. To deal with this, NONMEM uses anapproximation to the true model. The approximate model islinear in all the random effects. For this linearizedmodel, the vector of mean values for the observations fromthe individual is the vector of true predictions forthese observations. These predictions are obtained from themodel by setting the parameters to their true values and bysetting all the elements of both and to zero. In otherwords, these are the true predictions for the meanindividual with fixed effects equal to those of theindividual. For this linearized model it is also possibleto write a formula for the variance-covariance matrix of theobservations from the individual. This matrix is afunction of the individual&rsquo;s fixed effects and thepopulation parameters , , and . Finally, the ELSobjective function discussed above is generalized to be asum over individuals, rather than observations, and wherethe term of the sum involves a squared error between avector of observations and an associated vector ofpredictions, weighted by the reciprocal of the associatedvariance-covariance matrix for the individual.3. Parameter EstimatesIt is useful to consider how to estimate parameters that donot appear in the model we use to fit the data, but are,instead, functions of them (e.g. the half-life parameter, when the rate constant of elimination is themodel parameter).It is always possible, of course, to parameterize the modelin the function of interest. For example, we have alreadyseen (Chapters 2 &amp; 3) that we may use the function(parameter) in the one-compartment model instead of .However, we may be interested in the values of severalalternative parameterizations (e.g., we may want to know k,clearance, and half-life). Rather than rerun the sameproblem with several alternative parameterizations, we canuse the fact that the LS estimate of a function of theparameters is given by the same function of the LS parameterestimates. Formally, if is the function ofinterest, then . E.g. Letting , , and, then .4. Precision of Parameter EstimatesClearly, it is almost impossible for the estimates toactually be the true values. The question is: how far arethe true values from the estimates? To discuss thisquestion, imagine replicating the entire experiment(gathering new data, but keeping fixed) multiple times.Also, for simplicity, imagine that the model has only onescalar parameter, , and that its true value, is known.If, after each replication, the estimate of is recorded,and a histogram of these values is plotted, one might seesomething like figure 5.1A or 5.1B.Figure 5.1. Two hypothetical histograms of estimates of asingle parameter upon replication of a given experiment.Left panel (A): The estimates have small variance (spread)but are biased (the mean of the estimates differs from thetrue value, ); Right panel: The estimates have largevariance but are relatively unbiased.The difference between the estimate and the true value, ,obviously differs from replication to replication. Let thisdifference be called the estimatio__________ error______ We cannot knowthe estimation error of any particular estimate (if wecould, we could know the true value itself, by subtraction),but we can hope to estimate the mean error magnitude. Sinceerrors can be positive or negative, a measure of magnitudethat is unaffected by sign is desirable. This istraditionally the Mean Squared Error ( ). The MSE can befactored into two parts:where is the bias of the estimates (mean (signed) difference between theestimates and the true value) and is the standard error ofthe estimates ( is the variance of the estimates). Asillustrated in figure 5.1, the can be about the same fortwo types of estimates while both their bias anddiffer. It is very hard to estimate the bias of anestimator unless the true parameter value is, in fact, known.This is not true of the : the standard deviation ofthe distribution of estimates of a parameter on replication isthe ; noknowledge of the true value of the parameter is required.In many situations,LS estimators of fixed effects parametersare unbiased, although in nonlinear problems,such as most pharmacokinetic ones, this cannot be assured.4.1. Distribution of Parameters vs Distribution ofParameter EstimatesFigure 5.1 illustrates the distribution of parameterestimates that might result if an experiment werereplicated. The bias and spread depend on the estimationmethod, the design of the experiment ( , which implicitlyincludes ) and on the true parameter values, including thevariances (and covariances) of the random effectsinfluencing . If, for example, more observations wereobtained in each experiment (more individuals in apopulation study), the spread of the estimates (one fromeach experiment) would decrease until, in the limit, if aninfinite number of observations were obtained in eachexperiment, every estimate would be the same (equal to thetrue value plus the bias of the estimator). Thus, thedistribution of the estimate tells us nothing about biologyor measurement error, but only about the of theestimate itself.In contrast, and tell us about unexplained (or random)interindividual variability (biology) or error magnitude(biology plus measurement error), not about how precisely weknow these things. No matter how many observations we make,interindividual variability will remain the same size (butthe variability of our estimate of its size will decrease),as will the measurement error variability of a particularinstrument.It is very important not to confuse variability (e.g.,between individuals) in a model parameter with variabilityin the estimate of that parameter, despite the fact that theterms we use to describe both variabilities are similar.Thus an element of , say has a , , while theestimate of , , also has a given by thesquare of the standard error for . Indeed, the use ofthe term &quot;standard error&quot; rather than &quot;standard deviation&quot;to name a measure of the spread in the distribution of theparameter rather than in the parameter helps callattention to the distinction between these two types ofthings.4.2. Confidence Interval for a Single ParameterAcknowledging that any particular estimate from anyparticular experiment is unlikely to equal the trueparameter value implies that we should be interested in&quot;interval&quot; estimates of parameters as well as (instead of?)point estimates. An interval estimate of a parameter isusually a range of values for the parameter, often centeredat the point estimate, such that the range contains the trueparameter value with a specified probability. Theprobability chosen is often 95%, in which case the intervalestimate is called the 95% Confidence Interval (CI).A CI is often based only on the parameter estimate and its. In the next sections we discuss three questions aboutsuch CIs a little further. (i) How to estimate the froma single set of data (we cannot replicate our experimentmany times and construct a histogram as in figure 5.1).(ii) Given an estimate of , how to use that number tocompute a (95% confidence) interval with 95% chance ofcontaining the true parameter value. (iii) Given anestimate of , how to compute a confidence interval for afunction of the parameter.4.2.1. Estimating a Parameter&rsquo;s Standard ErrorRemarkably, the of a parameter estimate can be estimatedusing only the data from a single experiment. The idea isthat the data give us estimates of the variances of allrandom effects in our model, from which we can estimate thevariability in future data (if we were to replicate theexperiment). That is, the SE of the estimates onreplication depends only on quantities we either know orhave estimates of: the , the number of observed ( ), andthe variances of all random effects.It is a little beyond the scope of this discussion to givethe method by which NONMEM actually estimates the of aparameter estimate; however, examples of how this can bedone are found in any statistical textbook on regression.NONMEM presents the estimated standard error for eachparameter of the model (including the random effectsparameters, and ) as part of its output.4.2.2. Relating the Confidence Interval to theStatistical theory tells us not only how to compute theof a parameter estimate, but also that for a LS estimate(and many other kinds of estimates), the shape of thedistribution of the estimates is approximately Normal if thedata set is large enough. This means that we may usepercentiles of the Normal distribution, to computeconfidence interval bounds (when is small, thedistribution is often used instead; this is discussed instatistics texts). In general, a 100(1- )% confidenceinterval for a single parameter, say, is computed as. Here denotes the percentile of theNormal distribution. As previously noted, is often chosento be .05, in which case is approximately 2.4.2.3. A Confidence Interval for a Function of a SingleParameterAs discussed above, one can reparameterize the model interms of the new parameter, and NONMEM will then estimateits standard error. If re-running the fit presents aproblem, there is a simple way to compute a confidenceinterval for a function of a single parameter. If thelower and upper bounds of a 100(1- )% confidence intervalfor are denoted and , respectively, then a 100(1- )%confidence interval for has lower and upper boundsand , respectively. This confidence interval,however, is not necessarily centered at .4.3. Multiple Parameters4.3.1. Correlation of Parameter EstimatesA truly new feature introduced by multiple parameters is thephenomenon of correlation among parameter estimates. NONMEMoutputs a correlation matrix for the parameter estimates.The element of the matrix is the correlation betweenthe ith and jth parameter estimates. A large correlation(e.g. ) means that the conditional distribution of theith estimate, given a fixed value of the jth estimate,depends considerably on this fixed value. Sometimes eachparameter estimate of a pair that is highly correlated has alarge standard error, meaning that neither parameter can bewell-estimated. This problem may be caused by data that donot distinguish among the parameters very well, while asimpler model, or a different design, or more data mightpermit more precise estimates of each.As a simple example, imagine a straight line fit to just twopoints, both at the same value of : neither slope norintercept can be estimated at all as long as the other isunknown, but fixing either one (simplifying the model)determines the other. Both parameters could be estimated byobserving another point at some other value of (moredata), or, still using just 2 points, by placing thesepoints at two different values of (modifying the design).Thus, when standard errors are large, it is useful toexamine the correlation matrix of parameter estimates tosee, in particular, if some simplification of the model mayhelp.4.3.2. Confidence Intervals for a Function of SeveralParametersThere is an approximate formula for computing a standarderror, and hence a confidence interval for a function ofseveral parameters (e.g., a confidence interval forhalf-life when the estimated parameters are and ). Ituses the standard errors of the parameter estimates and thecorrelations between the parameter estimates. However,discussion of this formula is beyond the scope of thisintroduction. If a confidence interval for a function ofseveral parameters is desired, it is often more convenientto re-fit the data with the model reparameterized to includethe function as an explicit parameter.5. Hypothesis TestingBefore going into details, a note of caution is in orderabout hypothesis testing in general. The logic ofhypothesis testing is that one sets up a hypothesis about aparameter&rsquo;s value, called the nul____ hypothesis___________ and asks ifthe data are sufficiently in conflict with it to call itinto question. If they are, one rejects the nullhypothesis. However, logically, if they are not, one hassimply failed to reject the null hypothesis; one does notnecessarily have sufficient data to accept it. An extremeexample will make this clear. Let the null hypothesis beany assertion at all about the state of nature. Gather noevidence bearing on the question. Clearly, the evidence(which is void) is insufficient to reject the nullhypothesis, but just as clearly, in this case the evidenceprovides no support for it either.In less extreme cases there is a way to view failure toreject as lending some support to the null hypothesis, butthe matter is problematic. It is somewhat less problematicto use a confidence interval to quantify support for a nullhypothesis. A null hypothesis is an assertion that aparameter&rsquo;s true value is found among a set of nul____ values_______A confidence interval puts reasonable bounds on the possiblevalues of a parameter. One can then say that the evidence(the data from which the parameter estimate is derived) doessupport a null hypothesis (about the value of the parameter)if the null values are included in the interval and that theevidence fully support the null hypothesis if all nonnullvalues lie outside. An example will help make this clear.Consider that mean drug clearance in adults varies linearlywith the weight of the individual to a clinicallysignificant degree. Formally, this can be put as astatement about a regression coefficient in a model such asThe null hypothesis might be that is close to zero, i.e.that it is not so different from zero as to be clinically significant. To make this precise, suppose that we know that mean clearancefor a 70 kg person (i.e., ) is about 100 ml/min. Ifwere .20 ml/min/kg or less, a 50 kg increment(decrement) in weight from 70 kg would be associated with less than a 10%change in total clearance. This is clinically insignificant, sothe appropriate null values for might be 0.0 to .20,assuming, of course, that a physical lower bound for theparameter is zero.(More usually in statistical discussions a set of null values consists ofa single number, e.g. 0.)If the confidence interval for only includes nullvalues (e.g., it is .10 to .15),one might then safely conclude that weight, if it has any effectat all, has no significant effect, and thatthe data fully support the null hypothesis.If the confidence interval includes null values and others(e.g., it is 0.0 to .60),one would conclude that there is some support for the null hypothesis,but that there is also some support for rejecting it.In this case the data are insufficient to allow outright acceptance orrejection.If the confidence interval includes no null values (e.g., it is .80 to 1.3),one would reject the null hypothesis and conclude that weight has aclinically significant (linear) effect on clearance.For these reasons, we urge caution when performinghypothesis tests and suggest that confidence intervals areoften more useful. None the less, the popularity ofhypothesis tests requires that they be done, and we nowdescribe two methods for so doing, the first somewhat moreapproximate and less general than the second, but easier todo.5.1. Hypothesis Testing Using theA straight-forward way to test a null hypothesis about thevalue of a parameter is to use a confidence interval forthis purpose. In other words, if the confidence intervalexcludes the null values, then the null hypothesis isrejected. As described in Section 4.2.2, such a confidenceinterval is based on the estimated standard error. Thismethod generalizes to a hypothesis about the values ofseveral parameters simultaneously, but this is beyond thescope of this introduction.5.2. Hypothesis Testing Using the Likelihood RatioAn approach that involves the extra effort of re-fitting thedata has the advantage of being less approximate than theone that uses a confidence interval based on the SE. Thismethod is the so-called Likelihood Ratio Test.The basic idea is to compare directly the goodness of fit(as indicated by the minimum value of the extended leastsquares objective function) obtained between using a modelin which the parameter is fixed to the hypothesized value(the reduced model) and a model in which the parameter mustbe estimated (the full model).5.2.1. Definition &mdash; Full/Reduced ModelsA model is a reduced model of a full model if it isidentical to the full model except that one or moreparameters of the latter have been fixed to hypothesizedvalues (usually 0). Consider the examples:E.g. #1. Valid Full/Reduced Pair:Full model:Reduced model:E.g. #2. Invalid Full/Reduced Pair:Full model:Reduced model:In example #1, fixing to 0 produces the reduced model,while in example #2, no parameter of the full model can befixed to a particular value to yield the &quot;reduced&quot; model.It will always be true that if the models are set upcorrectly, the number of parameters that must be estimatedwill be greater in the full model than in the reduced model.Note that this is not so for example #2.5.2.2. Reduced/Full Models Express the Null/AlternativeHypothesesThe reduced model expresses the null hypothesis; the fullmodel expresses an alternative hypothesis. In example #1above, the null hypothesis is &quot;typical value of clearance isindependent of weight&quot;, and the alternative is &quot;typicalvalue of clearance depends linearly on weight.&quot;Note an important point here: the alternative hypothesisrepresents a particular alternative, and the likelihoodratio test using it will most sensitively reject the nullhypothesis only when this particular alternative holds. Ifthe full model were that &quot;the typical value of clearance isinversely proportional to weight&quot; (so that as weightincreases, the typical value of clearance decreases, asituation which rarely holds), the likelihood ratio testusing the alternative we have stated would not beparticularly sensitive to rejecting the null hypothesis, andwe might fail to do so. In contrast, we might succeed inrejecting the null hypothesis if we used some otheralternative model closer to the truth.5.2.3. The Likelihood Ratio TestPart of the NONMEM output is the &quot;Minimum Value of theObjective Function&quot; (see Chapter 2). Denote this by . IfNONMEM&rsquo;s approximate model were the true model, then wouldbe minus twice the maximum logarithm of the likelihood ofthe data (for those readers unfamiliar with likelihoods, andcurious as to what they are, we suggest consulting astatistics textbook). Statistical theory tells us that thedifference in minus twice the maximum log likelihoodsbetween a full and reduced model can be referenced to aknown distribution. Thus, to perform the Likelihood RatioTest, one proceeds as follows.Let be the minimum value of the objective function fromthe fit to the full model, and let be the correspondingquantity from the fit to the reduced model. Fit both modelsseparately yielding and , and form the statistic,This statistic is approximately distributed chi-square ( )withdegree of freedom, where is the number of parameters whose values arefixed in the reduced model. For an -level test,compare to , the 100(1- )percentile of the distribution.In particular, when exactly one parameter of the full modelis fixed in the reduced model, a decrease of 3.84 in theminimum value of the objective function is significant at.If NONMEM&rsquo;s approximate model (linear in the random effects)were the true model, and in addition, were linear in thefixed effects, then would be (approximately)distributed according to the distribution with , anddegrees of freedom ( ). Since is equal toonly when is &quot;large&quot;, and is greater otherwise, itis more conservative to reference to in allinstances, even when is nonlinear.6. Choosing Among ModelsAn idea related to hypothesis testing is this: when facedwith alternative explanations (models) for some data, howdoes one use the data to determine which model(s) is (are)most plausible? When one of the models is a reducedsub-model of the other, and there is some reason toprefer the reduced model to the alternative, then theLikelihood Ratio test can be used to test whether this apriori preference must be rejected (at the level).However, when one gives the matter some thought, there isusually little objective reason to prefer one model overanother on a priori grounds. For example, although possiblymore convenient, a monoexponential model is, if anything,less likely on biological grounds than a biexponential.Not only may there not be a clear probabilityfavoring one contending model over another, but the twomodels may not form a full and reduced model pair. In suchcircumstances, one must rely on some goodness-of-fitcriterion to distinguish between the models. Considerchoosing between just two models (the ideas to be discussedreadily generalize to more than two), denoted model andmodel . If the number of free parameters in model ( )is the same as that of ( ), then here is a reasonablecriterion: favor the model with the better fit. Note thatthere is no value associated with this statement; nohypothesis is being tested.Unfortunately, if one cannot simply compare andand choose the one with the smaller value. The reason isbest understood when and are a full and reduced modelpair. The full model will always fit the data better (i.e.,have a smaller ) as it has more free parameters to adjustits shape to the data. While the same is not always truefor any pair of non-linear models with different numbers ofparameters, it is often true: the model with the greaternumber of parameters will fit a given data set better thanthe model with fewer parameters. Yet the larger (moreparameters) model may not really be better; it may, in fact,fit an entirely new data set worse than the simpler model ifits better fit to the original data was simply because itexploited the flexibility of its extra parameter(s) tobetter fit some random aspect of that data.Based on the above intuitive argument, it seems that oneshould penalize the larger model in some way beforecomparing the likelihoods. This intuition is formallyrealized in the Akaike Information Criterion (AIC) whichsays that one should compute + , andchoose model if is &gt;0, and model if is &lt;0. Thesecond term penalizes model if , and vice versa.When , the reduces to the comparison of anddescribed previously.</a><br>
<a href="#1. What This Chapter is AboutThis chapter tells how to create data for analysis byNONMEM-PREDPP. It tells how to describe the data using$DATA and $INPUT records. The requirements for formattingthe data for NONMEM-PREDPP are somewhat more stringent thanare the requirements for formatting the data for NM-TRAN.The Data Preprocessor is a component of NM-TRAN whichmodifies the data so that it becomes formatted appropriatelyfor NONMEM-PREDPP.2. Data Sets for NONMEM2.1. Data RecordsA data set for NONMEM analysis consists of a series ofrecords (&quot;lines&quot; in the terminology of editing programs).Each record must consist of a fixed number of data items andeach must have the same format. Figure 6.1 shows how such adata set may be pictured. In data base terminology, this isa &quot;flat&quot; structure.Figure 6.1. A NONMEM input data set. Each data record is arow; each type of data item is in a different column.NONMEM imposes no limit on the number of records in the dataset. It does not (nor does PREDPP or NM-TRAN) sort the datarecords before processing them, so the data records mustalready be in the correct sequence. NONMEM itself cannot beinstructed to delete or drop records from the data set, but &#9474;see the DROP and IGNORE options of the $DATA record, below.2.2. Data ItemsNONMEM reads records from the data set with a FORTRAN FORMATspecification, and so each data item must occupy a fixednumber of character positions. Data items are alwaysnumbers. However, if no particular number is appropriatefor a given data item on a given record, the data item iscalled a nul____ dat____ item_____ it may be given the numerical value0 or the nonnumerical value &quot;.&quot;, or left blank. Zero&rsquo;s wereused in the first two lines of the Theophylline example ofChapter 2, which appeared as follows:2 320. 0. 0.2 0. .27 1.71The Data Preprocessor allows each value in the data set tooccupy only as many character positions as it needs, so longas the data items are separated by blanks (spaces) orcommas. Tab characters may also be used as separators if &#9474;they are stored as explicit characters, e.g., ASCII 011, &#9474;although this is platform-dependent and should be tested &#9474;carefully. When there are no commas or tabs, the value &quot;.&quot;or 0 must be used to hold the place of a null data item.The two lines above could have been entered as follows:2 320. 0. 0.2,,.27,1.71(Note the use in the second line of adjacent commas &quot;,,&quot; todenote a null data item.)The contents of the data items must be purely numeric; i.e.,character values such as Y, N, M or F may not be recorded.Instead, numeric codes such as 0 or 1 must be used.With NONMEM VI, the number of data items per data record isgiven by constant PD in file SIZES. The default value is20. With NONMEM 7.1, the default value is 50. With NONMEM7.2, there is no limit on the number of data items per datarecord.2.3. Clinical Data and Data ConversionClinical data often has a &quot;hierarchical&quot; file structure,with (say) two record formats: a patient record, containingfixed information about a patient (ID number, sex, age,prior history of smoking or drug use, etc), followed by oneor more visit records, containing doses and physicalobservations during the course of the study. Visit recordsmay not even contain the same number of items as patientrecords, nor have the same format. The hierarchy is shownschematically in figure 6.2.Patient recordVisit recordVisit record...Patient recordVisit recordVisit record...Figure 6.2. A hierarchical data file. Patient and visitrecords have different formats.NONMEM cannot accept such data. For NONMEM, the (fixed)information on the &quot;patient&quot; record must be copied ontoevery &quot;visit&quot; record, and the &quot;patient&quot; records must beeliminated. This is the user&rsquo;s responsibility and istypically done in a one-time data conversion step using thesystem editor and/or a specially written computer program.If an individual&rsquo;s data is to be deleted because he did notcomplete the study or had an adverse outcome, it should bedone at this time. In addition, numeric codes should besubstituted for alphabetic codes. Clinical data sometimesincludes multi-digit, non-consecutive patient identificationnumbers drawn from some patient identification system. Suchpatient identification numbers can be used with NONMEM asthe identification data item described in Section 6.2.However, it is preferable to append to each patient&rsquo;s datarecords numbers from the sequence 1, 2, 3, ..., for use asthe ID data item. This will make it easier to read ascatterplot which includes ID along one of the axes (e.g.,residual vs ID).When there is a large amount of data, we strongly suggestthat a small amount of data (from one or two individuals) beprepared for NONMEM-PREDPP analysis and a run in which onlytables and scatterplots are output be made to check that thedata is correctly prepared before a great deal of labor isexpended on the remainder.3. Data Sets for PREDPPWhen PREDPP is used with NONMEM, the data must meetadditional requirements. First, PREDPP is concerned withtime-ordered events such as dose events, which introducedrug into the system at particular times, and observationevents, which report observations taken at particular times.PREDPP insists that these events be recorded on separaterecords. That is, dosing information cannot be recorded onthe same record as an observed value. Second, PREDPPrequires that the time of each event be recorded on eachdata record, and that the physical sequence of the datarecords be the same as their sequence in time. (E.g., if adose event immediately precedes an observation event intime, then the dose event record must immediately precedethe observation event record.) Again, neither PREDPP northe Data Preprocessor will physically sort or resequence thedata records.4. The $DATA RecordThe $DATA record describes the characteristics of theexternal data file to be processed by NONMEM. NONMEM is nota data base management system and does not store a data setbetween runs; once a file has been prepared for NONMEM, itmust be re-read each time it is to be analyzed. The firstcharacter string appearing after $DATA is the name of thefile containing the data. Since it is to be used in aFORTRAN OPEN statement, this name may not include embedded &#9474;special characters such as slashes (/ or \), commas, &#9474;semi-colons, parentheses, equal signs or spaces unless it is &#9474;surrounded by single quotes &rsquo; or double quotes &quot;. The &#9474;filename may contain 80 characters. (If a file is to be &#9474;opened by NONMEM rather than by NM-TRAN, the filename may &#9474;not contain embedded spaces, and may contain at most 71 &#9474;characters.) A FORTRAN format specification suitable toread the data may follow the file name; this is optional andcan be supplied by the Data Preprocessor. The choice isdiscussed more fully in Section 10.4 of this chapter.Certain options may be specified if desired. Among theseare:RECORDS=nThis tells the number of records to be read from thedata file. If omitted, the records are read to theend-of-file or to a NONMEM FINISH record (Users GuideII). The RECORDS option may be used to limit NONMEMprocessing to the initial portion of the file and isuseful during the early stages of debugging. &#9474;RECORDS=label &#9474;&quot;Label&quot; is a data item label. The data records for the &#9474;problem will start at the place where the file is &#9474;positioned before data records are read and include all &#9474;contiguous data records having the same value for the &#9474;data item. In particular, the ID label may be used (or &#9474;alternatively, the option may be coded RECORDS=IR, &#9474;RECORDS=INDREC, or RECORDS=INDIVIDUALRECORD) to obtain &#9474;the data for a single individual. &#9474;IR,INDREC,INDIVIDUALRECORD. &#9474;NOREWIND|REWIND &#9474;With the first problem specification in a control &#9474;stream, the file is positioned at its initial point so &#9474;that the first record in the file is used. The options &#9474;REWIND and NOREWIND apply only with a $DATA record in a &#9474;subsequent problem specification. &#9474;REWIND: Reposition the file at the start. &#9474;NOREWIND: Leave the file at its current position so &#9474;that the next record in the file is read. Used when &#9474;the $DATA record with the previous problem &#9474;specification included the RECORDS option so that &#9474;NM-TRAN did not read to a physical end-of-file. This &#9474;is the default.LRECL=nThis tells the length of the physical data records. Itis required if the operating system associates a fixedphysical record length with every disk file andconsiders it a fatal I/O error if a READ commandrequests more characters than the records contain. Ifthis is true of your operating system, the operatingsystem will issue an error message when you first runNM-TRAN without the LRECL option in the $DATA record.WIDE This requests that the NONMEM data set produced byNM-TRAN always contain single-line records, and thatthese records always include at least one space betweendata items. Such a data set can be further processedby other programs. (The default is NOWIDE, in whichcase NM-TRAN limits the records to 80 characters bycreating multi-line records and/or eliminating spacesbetween data items if necessary.) It may not be usedif a FORTRAN format specification is present. It also &#9474;provides an extra character for relative times computed &#9474;by the Data Preprocessor.NULL=cThis requests that the NONMEM data set produced byNM-TRAN contain the character c in place of null dataitems. For example, NULL=0 requests that all null dataitems be replaced by 0. The syntax NULL=&rsquo;c&rsquo; andNULL=&quot;c&quot; is also permitted. The default is NULL=&rsquo; &rsquo;.It may not be used if a FORTRAN format specification ispresent.IGNORE=cThis instructs NM-TRAN to ignore data records havingcharacter c in the first character position (&quot;column1&quot;) of the record. This allows the use of &quot;comment&quot;records in the NM-TRAN data set. The syntax IGNORE=&rsquo;c&rsquo;and IGNORE=&quot;c&quot; is also permitted. It may be used evenif a FORTRAN format specification is present. &#9474;The character @ has a special meaning. It signifies &#9474;that any data record containing an alphabetic character &#9474;(or special characters @ or #) as its first non-blank &#9474;character (not just in column 1) should be ignored. &#9474;Alphabetic characters are the letters A-Z and a-z. &#9474;Thus, a table file produced by NONMEM in an earlier run &#9474;can be used as an NM-TRAN data set. Any header lines &#9474;included in this table can be dropped by specifying &#9474;IGNORE=@. &#9474;When the IGNORE option is omitted, any records &#9474;containing the character # in column 1 are ignored. &#9474;IGNORE=(list), ACCEPT=(list) &#9474;This form of the IGNORE option allows records to be &#9474;dropped based on the values of data items. For example, &#9474;IGNORE=(GEN.EQ.1,AGE.GT.60). &#9474;Records having GEN equal to 1 or AGE greater than 60 &#9474;are dropped. All others are accepted. The ACCEPT &#9474;option allows records to be accepted based on the &#9474;values of data items. See Guide VIII for more &#9474;information. &#9474;&#9474;LAST20=nn &#9474;&quot;nn&quot; is a 2 digit number that specifies the highest &#9474;2-digit year that is assumed to be in the 21st. &#9474;century, i.e., that represents 20nn rather than 19nn. &#9474;See Section 10.1.5 below. &#9474;TRANSLATE &#9474;The translate option must be followed by parentheses &#9474;enclosing a list of one or more translate &#9474;specifications. For example, &#9474;$DATA filename TRANSLATE(TIME/24,II/24) &#9474;Translate specification TIME/24 causes the value of &#9474;TIME to be divided by 24, whether or not day-time &#9474;translation occurs (i.e., whether or not relative times &#9474;are being computed). This has the effect of changing &#9474;the unit of TIME from hours to days. Similarly, &#9474;translate specification II/24 causes the value of II &#9474;(interdose interval) to be divided by 24 whether or not &#9474;&quot;:&quot; appears in any II value. See Section 10.1.4 below.5. The $INPUT RecordThis record describes how many data items there are on eachdata record, the order of the data items, and tells what thelabels of the data items are.5.1. Data Item LabelsA data item label is one to four letters (A-Z) or numerals(0-9). With NONMEM 7 a label consists of 1-24 letters &#9474;(A-Z), numerals (0-9), and the character &rsquo;_&rsquo;. (The length &#9474;24 is specified by constant SDF in SIZES) &#9474;The first character must be a letter. These labels are theones which will be used in other records (such as $PK or$SCATTERPLOT), and will appear in NONMEM&rsquo;s output. Theorder of the data items on the data records is notimportant, but must be the same on all data records in thedata set. In both the examples of Chapter 2, the ID dataitems happened to be the first ones in the data records, andthe DV data items happened to be the last ones. This orderwas arbitrary.5.2. Reserved Labels and SynonymsCertain data item labels are reserved in that they identifydata items which are recognized specifically by NONMEM,PREDPP, or NM-TRAN. The data items they label arethemselves called NONMEM, PREDPP, or NM-TRAN data items,respectively.&bull; Reserved NONMEM data item labels are: ID, L2, DV, andMDV. They are discussed in Section 6 of this chapterand in Section 4.2 of Chapter 12. Additional reservedNONMEM data item labels are: MRG_, RAW_, and RPT_. See &#9474;Guide VIII for a discussion of these items.&bull; Reserved PREDPP data item labels are: TIME, EVID, AMT,RATE, SS, II, ADDL, CMT, PCMT, CALL, and CONT. Theyare discussed in Section 7 of this chapter and inSection 2.4 of Chapter 12. Additional reserved PREDPP &#9474;data items are the extra EVID labels, XVID1, XVID2, &#9474;XVID3, XVID4, and XVID5. See Guide VIII for a &#9474;discussion of these items.&bull; Reserved NM-TRAN data item labels are: DATE, DAT1,DAT2, DAT3, and L1. DATE, DAT1, DAT2, and DAT3 arediscussed in Section 10.1 of this chapter; L1 isdiscussed in Section 4.2 of Chapter 12.If you do not want to use the reserved label, you can supplytwo labels: the reserved label and a &quot;synonym&quot;. Eitherlabel can be used in subsequent records, but only thesynonym will appear in NONMEM output. For example,$INPUT PNO=ID,CONC=DV,DOSE=AMT,WT,....The first three data items are given the labels PNO, CONC,and DOSE. These labels are synonyms for the NONMEM dataitems ID and DV and for the PREDPP data item AMT. The lastdata item is given the label WT and is not a reserved dataitem; it is an example of fixed effect (&quot;concomitant&quot;) dataWhen $PK and $ERROR records are present, certain labels maynot be used at all as data item labels. These are: thelabels for the basic and additional PK parameters for thepharmacokinetic model, as listed in Appendices 1 and 2(e.g., for ADVAN1 and TRANS2: CL, V, S1, S2, F1, F0), andspecific labels for the arguments of the PK and ERRORsubroutines: IDEF, IREV, N, GG, IRGG, HH, and G.5.3. Dropping Data Items via DROPIf no format specification is included on the $INPUT record,then another synonym, DROP, may be used with any data item.DROP may be used as a synonym more than once. It identifiesdata items to be dropped (i.e. eliminated) from the NM-TRANdata set by the Data Preprocessor while constructing theNONMEM data set. This provides a way to limit the number ofdata items in the NONMEM data set and to eliminatenon-numeric data items.6. NONMEM Data Items6.1. DV Data ItemThere must always be a Dependen_________ Variabl________ dat____ ite____ labeledDV. This is a value of an observation. There can be onlyone DV data item per data record. The position of the DVdata item (and the ones described below) is not important.However, its position must be the same on all records.6.2. ID Data Item for Population DataWhen the data is from a population, NONMEM expects theIdentificatio______________ dat____ item_____ labeled ID, and expects the datato be organized into two or more &quot;individual records&quot;. Anindividua__________ recor______ is a group of contiguous data recordshaving the same value for the ID data item and presumablycontaining data from the same individual. ID data itemvalues need not be consecutive, increasing, unique, norbegin with 1. E.g., 3, 5, 6, 10, 3, etc. is a possiblesequence of ID values. Note the two instances of 3 as IDdata item values. As long as these two instances areseparated by different ID data item values (e.g. 5, 6, 10),they represent different individuals.6.3. MDV data itemIf there are records in an input data set which do notcontain values of observations, then NONMEM needs to beinformed of this fact. This is done using the Missin_______Dependen_________ Variabl________ dat____ ite____ labeled MDV. The values of MDVare:0 The DV data item of the data record contains a value ofan observation. The record is referred to as anobservatio___________ record_______1 The DV data item of the data record does not contain avalue of an observation.NONMEM limits the number of observation records per &#9474;individual record to 250. To change this limit, see UsersGuide III.When PREDPP is used, the Data Preprocessor is able torecognize which records contain observed values and which donot, and it can supply the MDV data item if it is notalready present in the data set, i.e. if the label MDV doesnot occur in the $INPUT record. (When PREDPP is not used,the Data Preprocessor cannot do this.)7. PREDPP Data Items7.1. TIME Data ItemPREDPP will in general need theTim____ dat____ item_____ labeled TIME. The value of TIME must benon-negative. Within an individual record, values of TIMEmay not decrease. (Exceptions exist for reset andreset-dose events; see Section 7.3.) The units are optional(e.g., minutes or hours), but should be consistent withother units used in the problem. The TIME of the firstevent record may be zero or non-zero. (If non-zero, thenPREDPP in effect subtracts this value from all other TIMEvalues within the same individual record, so that PREDPPalways works with relative time values.) The DataPreprocessor permits TIME to be expressed as clock time(e.g., 8:30, representing the time, half-past 8 o&rsquo;clock).Such times are converted by the Data Preprocessor intorelative times. Details are given in Section 10.1 below.7.2. AMT, RATE, SS, II: Dose-related Data ItemsDoses are described using one or more of these four dataitems, depending on the kind of dose. A detailed discussionof these data items and of dose records in general isdeferred to Section 8 below.7.3. EVID Data ItemWhen PREDPP is used, all data records are also called even_____records________ Every event record must contain an Even_____Identificatio______________ dat____ ite____ identifying the kind of eventdescribed by the record, and labeled EVID. The values ofEVID and the five kinds of event records are:0 Observation event. This record contains an observedvalue (in the DV data item). Dose-related data itemssuch as RATE and AMT must be 0.1 Dose event. This record describes a dose. Thecontents of the DV data item are ignored.2 Other event. This record is used for a variety ofpurposes. It can be used to obtain a predicted valueat a point in time at which no actual observation ordose event took place; it can be used to turn acompartment off or on at a point in time; it can beused to mark a time at which a change in aphysiological data item (e.g. weight) occurs (as wellas give the new value of the data item). Dose-relateddata items must be 0. The contents of the DV data itemare ignored.3 Reset event. This record is used to reset the kineticsystem at some point in time, without actually startinga new individual record: time is set to whatever timeappears in the event record, the amounts in eachcompartment are set to zero, prior doses are cancelled,and the on/off status of each compartment is set to itsinitial status. It is in all other respects identicalto an other event type record. It is typically usedwithin an individual record, when the individual had acourse of drug treatment, followed by a wash-outperiod, followed by another course of drug treatment.It should appear prior to the start of the secondcourse.4 Reset-dose event. This record combines EVID types 3(reset) and 1 (dose). First the system is reset, andthen a dose is introduced. It is in all other respectsidentical to an ordinary dose event type record.If only dose and observation event records are present inthe NM-TRAN data set, and if EVID is not already present inthe data set (i.e. EVID does not appear in the INPUTrecord), then EVID will be supplied automatically by theData Preprocessor. This is what was done in the examples ofChapter 2. If other or reset type event records are presentin the data set, then the $INPUT record must include theEVID data item, and the data set must include theappropriate values for EVID on all the data records.7.4. CMT and PCMT Data ItemsThe Compartmen___________ dat____ ite____ (CMT) and Predictio__________ Compartmen___________dat____ ite____ (PCMT) are similar. Both contain the number of acompartment in the model. (Compartments and compartmentnumbers are discussed in Chapter 7 and Appendix 1, as aredefault compartments. It may help to look at Chapter 7 andAppendix 1 at this time.) If CMT or PCMT is not defined inthe data set (i.e., not listed in the $INPUT record), or hasthe value 0 on a given event record, the appropriate defaultcompartment is used, except as noted below. This is whatwas done in the examples of Chapter 2. The meaning of thetwo data items depends on the particular kind of eventrecord.&bull; Observation event: CMT specifies the compartment fromwhich the predicted value of the observation isobtained. PCMT is ignored. When CMT specifies theoutput compartment, it is allowed to have a negativesign (e.g., with the One-compartment model, CMT may be-2). This signals that after the prediction iscomputed the output compartment is to be turned off,i.e. the amount in the compartment is to be set tozero. The amount remains zero until the compartment issubsequently turned on. This is quite useful withurine observations; see Section 9 below.&bull; Dose event: CMT specifies the compartment into whichthe dose is introduced. The compartment is turned onif it was previously off. PCMT specifies thecompartment for which a predicted observation iscomputed. This predicted value is not associated withan observation, but it can be useful because it willappear in tables or scatterplots.&bull; Other event: A positive value of CMT specifies that thecompartment is to be turned on if it is off. Anegative value of CMT specifies that the compartment isto be turned off if it is on. (If CMT is 0, nocompartment is turned on or off.) PCMT is the same asfor dose events.&bull; Reset event: CMT is ignored. PCMT is the same as fordose events.&bull; Reset-dose event: CMT and PCMT are the same as for doseevents.7.5. CALL Data ItemThe Cal____ dat____ ite____ (CALL) is used to force a call to eitheror both of the PK and ERROR subroutines with the eventrecord when such a call would not normally occur. A call tothe PK or ERROR subroutine causes the code specified by the$PK or $ERROR records, respectively, to be executed with theevent record. This is discussed in Chapters 7 ($PK) and 8($ERROR).) When not defined in the data set, CALL isassumed to be 0 always. The values are:0 No forced call; PREDPP takes its normal action.1 Force a call to ERROR.2 Force a call to PK.3 Force a call to both PK and ERROR.10 Force a call to ADVAN9. May be combined with other &#9474;values. E.g., the value 12 means &quot;Force a call to PK &#9474;and to ADVAN9&quot;.8. Describing Doses to PREDPPDoses are described using one or more of the data itemsdiscussed below. A detailed discussion of the actual kindsof doses that PREDPP recognizes follows in Section 8.2,including a precise definition of what is meant by the term&quot;steady-state dose&quot; (Section 8.2.3). A data item that isnot needed to describe the kinds of doses used in the studyneed not be defined in the data set; it will in effectalways have the value 0. Only AMT (Dose amount) was used inthe examples of Chapter 2, for example. The values ofdose-related data items should be 0 for non-dose events andfor those dose events to which they are not relevant.8.1. Dose-related Data ItemsAMT data itemThe Amoun______ dat____ ite____ (AMT) gives the amount of a bolus doseor of an infusion of finite duration. This amount should bea positive number.RATE data itemThe Rat____ dat____ ite____ (RATE) gives the rate of an infusion.This rate should be a positive number. (Negative values arediscussed in Chapter 12, Section 2.3.)SS data itemThe Steady-stat____________ dat____ ite____ (SS) can take four values. &#9474;0 This record does not describe a steady-state dose.1 This record describes a steady-state dose. If this isnot the first event record for the individual, then thesystem is first reset as if by a reset event record(except that the on/off status of the compartments isunchanged from what it was prior to the event recordand the time on the event record must not be less thanthe time on the previous event record). Thecompartment amounts are then computed usingsteady-state kinetic formulas.2 This record describes a steady-state dose. No reset ofthe kinetic system occurs. Compartment amounts arecomputed using steady-state kinetic formulas and arethen added to the amounts already present at the eventtime. The use of SS=2 will be discussed further inSection 8.2.7, below. &#9474;3 This record describes a steady-state dose. It is &#9474;exactly like a steady-state dose with SS data item = 1, &#9474;except that existing compartment amounts and &#9474;derivatives are retained and used as initial estimates. &#9474;The computed steady-state levels replace these &#9474;compartment amounts and derivatives. This value of SS &#9474;may be specified only with SS6 and SS9 (the General &#9474;Nonlinear Models).II data itemThe Interdos_________ Interva________ dat____ ite____ labeled II gives the timebetween implied doses (see Section 8.2.3 and Chapter 12,Section 2.4). For a steady-state infusion, it should be 0.For other steady-state doses, it should be a positive numberwhose units are the same as the TIME data item.8.2. Different Kinds of DosesAny of the doses described here may be introduced into anycompartment of the model except the output compartment.Examples are given below that are fragments of data records,identifying the data items of interest and showing theircontents on the dose record. The units of various dataitems are presumed to be appropriate for some actual data.8.2.1. Instantaneous Bolus DosesAll the examples in Chapter 2 involve instantaneous bolusdoses, which we shall refer to simply as bolus doses.(There is also such a thing as a &quot;zero-order bolus dose&quot;,see Chapter 12, Section 2.3.) These are dose records havingAMT&gt;0, RATE=0 and SS=0. (Recall that if RATE and SS arenot defined on the $INPUT record, they are effectively 0.)If the $PK record computes a bioavailability fractionparameter for the compartment into which the dose isintroduced, then the contents of the AMT data item ismultiplied by the current value of this parameter before theamount is added to the compartment. A bolus dose enters thedose compartment immediately; the predicted (scaled) amountin the dose compartment, if displayed in a table orscatterplot, will include the dose.Example:TIME AMT4. 10.This is a dose of 10 to be added to the default dosecompartment at time 4.A bolus dose to the central compartment might be interpretedas an IV bolus dose; to the depot it might be an oraltablet; to a peripheral compartment it might be anintra-muscular injection.8.2.2. InfusionsInfusions are doses having AMT&gt;0 and RATE&gt;0. The durationof the infusion is computed by PREDPP by dividing the AMT bythe RATE. As with bolus doses, AMT is first multiplied bythe bioavailability parameter for the dose compartment, ifany. There is no explicit &quot;end of infusion&quot; record. Drugamounts in the system cannot be affected in a detectable wayat the time an infusion begins by any drug introduced by theinfusion; the predicted (scaled) amount in the dosecompartment, if displayed in a table or scatterplot, willnot include the dose. Infusions may overlap. That is,subsequent dose records may start new infusions before oldones have finished. It is not an error if an infusion&rsquo;sduration is so large as to extend beyond the time of thelast event record for the individual; the remainder of thedrug is ignored. A reset or reset-dose event, or asteady-state dose event with SS=1, will also terminate anyinfusions in progress.Example:TIME AMT RATE4. 10. 2.The duration of the infusion will be computed as 10./2., andso the infusion, which begins at time 4, will terminate attime 9. (=4.+5.).An infusion to the central compartment might be interpretedas an IV infusion; to the depot it might be a sustainedrelease tablet; to a peripheral compartment it might be animplant or skin patch which releases drug at a knownconstant rate. It is possible for NONMEM-PREDPP to estimatethe input rate of a constant-rate drug delivery system (seeChapter 12, Section 2.3).8.2.3. Steady-State DosesA steady-state dose can be regarded as the last one of aseries of doses just like the one specified in the doseevent record, which have been given at a regular interdoseinterval since time , and such that they have led to asteady-state periodic pattern of drug amounts in the systemby the time this last dose has been administered. The dosesof similar kind that precede it are called implie_______ doses______because their existence is not described by separate doserecords in the data set, but rather is implied by thedescription of the single steady-state dose. By stipulatingthat a dose is a steady-state dose, the user instructsPREDPP to update the drug amounts in the system at the timethe dose is given by using steady-state kinetic formulas.This can take less computational time than using separatedose records to describe the implied doses and usingtransient kinetic formulas to advance the system from onedose time to the next (as well as requiring fewer doserecords). The formulas used to compute the steady-stateamounts at the time the steady-state dose is introduced usethe values of the basic and additional pharmacokineticparameters in effect at this time; any values in effect atearlier times are ignored. Moreover, when using asteady-state dose, the user is assuming that underreasonable values of the pharmacokinetic parameters,steady-state is in fact effectively reached by the time thedose is introduced; PREDPP does not check this assumption.The output compartment must be off when a steady state doserecord is encountered in the data set.8.2.4. Steady-State with Multiple Bolus DosesThese are dose events having AMT&gt;0, RATE=0, SS=1, and II&gt;0.The II data item (interdose interval) tells how many timeunits apart the doses were given. As with non-steady-statebolus doses, AMT is first multiplied by the bioavailabilityparameter for the dose compartment, if any.Figure 6.3 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.3. Steady-state with multiple bolus doses. Thedose is given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT SS II8 10. 1 12Here, an infinite number of bolus doses, 10 units each, areassumed to have been given 12 hours apart, with the last ofthese given at time 8AM, at which time steady-state isreached. The fact that TIME is 8 has no effect on thecomputed amounts, but is important in relation to therecords that follow. Steady-state levels can be predictedat any time between the time on the dose record (8) and theend of the succeeding interdose interval (12) (providedthere are no further doses introduced during this interval).If another (steady-state or non-steady-state) dose just likethe steady-state one is introduced at time 20, thenpredictions in the interdose interval following this timewill also be steady-state levels.8.2.5. Steady-State with Multiple InfusionsThese are dose events having AMT&gt;0, RATE&gt;0, SS=1, and II&gt;0.Each such event describes the last of a series of regularlyspaced infusions, all of the same amount and rate. As witha non-steady-state infusion, the duration of each infusionis given by AMT/RATE. The bioavailability fraction appliesto each infusion of the series.Figure 6.4 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.4. Steady-state with multiple infusions. The doseis given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT RATE SS II16 10. 5. 1 6Here, infusions, each 10 units and of duration 2 (=10/5),are assumed to have been given 6 hours apart, with the lastof these started at time 4PM, at which time steady-state isreached. The daily dose times were 4 AM, 10 AM, 4 PM, and10 PM. Again, the value of TIME has no effect on thecomputed amounts but is important in relation to the recordsthat follow. Steady-state levels can be predicted betweentimes 16 (4 PM) and 22 (10 PM) (provided there are nofurther doses introduced during this interval).8.2.6. Steady-State with Constant InfusionThese are dose events having AMT=0, RATE&gt;0, SS=1, and II=0.Such an event consists of infusion with the stated rate,starting at time , and ending at the time on the doseevent record. Bioavailability fractions do not apply tothese doses.Figure 6.5 shows how drug levels vary with time.Figure 6.5. Steady-state with constant infusion.Steady-state level can be predicted only at time t.Example:TIME RATE SS16 2. 1Here, a steady-state infusion at rate 2 is specified asending at 4 PM. A steady-state level can be predicted onlyat this time.8.2.7. Multiple Steady-State DosesDoses with SS=2 are exactly like doses with SS=1. Doseswith SS=2 are similar to non-steady-state doses in thatcompartment amounts are computed in two steps. First,compartment amounts are computed at the time on the doseevent record based on the prior dosing history of thesystem. Second, steady-state amounts are computed from thedosing information on the record and added to the existingcompartment amounts. Thus, if the kinetics are linear, thisresults in an application of the superposition principlewherein the amounts in the system resulting from dosesdescribed by dose event records preceding the time of thesteady-state dose are superposed on the (steady-state)amounts in the system resulting from the steady-state doseand the implied doses.As with any steady-state dose, the steady-state amounts areobtained using the values of the pharmacokinetic parameterscomputed from the information on the steady-state doserecord. In the case that SS=2, though, if these valuesdiffer from those computed from the information on theprevious dose record(s), then the compartment amounts at thetime in the steady-state dose record are not trulysteady-state amounts, and the computed steady-state levelsare not valid predictions. PREDPP will not detect thiserror. We emphasize that superposition is only valid withlinear kinetic systems; all the kinetic systems (ADVANs)discussed in this text are linear.SS=2 records can be used to achieve the specification ofcomplicated dosing regimens. For example, Figure 6.6 showshow drug levels vary with time when two different doses arealternated. In this illustration, two steady-state dosesare specified, each with interdose interval I and with timebetween the two steady-state doses equal to I/2. Even morecomplex patterns are possible.Figure 6.6. Multiple steady-state doses. Two separatesteady-state doses are given. As pictured, they are eachbolus doses, but they do not have to be. The first doseevent record is at time t. The second dose event record isat time t+I/2. They each have interdose interval I.Steady-state levels can be predicted between times t+I/2 andand t+I.Example:TIME AMT SS II8 10. 1 2420 15. 2 24This describes the following dosing regimen: a dose of 10units every morning at 8 AM and a dose of 15 units everyevening at 8 PM (20 hours is 12 hours past 8). Note thatsteady-state is not truly established until after the seconddose record; any observation events interposed between thetwo dose records will reflect only the first steady-statedosage (i.e., 10 units every 8 AM). Another way to achievethe same steady-state is by the following:Example:TIME AMT SS II20 10. 1 1220 5. 2 24This describes doses of 10 units every 12 hours, the last ofwhich is given at 8 PM (i.e. at 8 AM and 8 PM daily), plusadditional doses of 5 units at 8 PM daily. In bothexamples, the steady-state levels can be predicted from time20 hours to time 32 hours.8.2.8. Combining Non-Steady-State Doses with Steady-StateDosesNon-steady-state dose records may appear before, among, orafter steady-state dose records. Such a dose record mayoccur before a steady-state dose record to reflect atransient dose given among a series of regular doses leadingto steady-state, but which is not a part of this series.E.g., a patient who has been maintained at steady-statetakes an extra dose by mistake shortly before hisappointment. A non-steady-state dose record may occur aftera steady-state dose record in order to continue the patternof doses beyond the steady-state dose. Ordinarily,steady-state levels can only be predicted between , thetime on the steady-state dose record, and , the sum ofand the interdose interval. If it is not only necessary tocompute a steady-state prediction between and , butalso after , then there must also occur one or morenon-steady-state dose records at , , etc. with dosesjust like the steady-state dose. (The &quot;additional doses&quot;data item, labeled ADDL, is especially useful for thispurpose; see Chapter 12, Section 2.4.)Example:TIME AMT SS II8 10. 1 2420 15. 2 2432 10. 0 044 15. 0 0Here, the last two records continue the steady-state patternof the first two. Steady-state levels may be predictedbetween times 20 and 56.Similarly, a steady-state constant infusion may be extendedwith a non-steady-state infusion. In the example below,steady-state levels can be predicted from time 0 to time100.TIME RATE AMT SS0 30 0. 10 30 3000. 09. The Output Compartment: Urine Collections andObservationsIn this section we show how urine collections andobservations of urine concentration, , can be described.The first-time reader may prefer to return to this sectionafter reading Section 4.3.3 of Chapter 7. As an example,consider the one-compartment model with first-orderabsorption (ADVAN2). The sequence of events is:6:00 AM A bolus dose of 100 is given.8:00 AM A urine collection is started.9:30 AM and urine volume (UVOL) are measured and anew collection is started.11:45 AM , , and urine volume are measured.The $INPUT record is:$INPUT ID TIME EVID UVOL DV CMT AMTThe data records appear as follows:ID TIME EVID UVOL DV CMT AMT1 6.00 1 0 0 1 1001 8.00 2 0 0 3 01 9.50 0 75 .058 -3 01 9.50 2 0 0 3 01 11.75 0 100 .067 -3 01 11.75 0 100 5.80 2 0Notice that urine collections start with an other type eventrecord (EVID=2) whose CMT contains the number of the outputcompartment, the effect of which is to turn this compartmenton at 8AM, i.e. to begin accounting for the amount of drugappearing in this compartment from 8AM. Because other typeevent records are included, the EVID data item must bepresent in the data. The CMT data item must be present inall event records since it is needed to refer to the outputcompartment in at least one record. Care must be taken touse correct values for the CMT data item; default valuesused when this data item is not present are not relevant inthis case. The DV value on the observation record at 9:30is the measured . Because the value of CMT is negative,the output compartment is also turned off at 9:30. Sincethe collection is to continue, the compartment must beexplicitly turned on again (the fourth record). Note thatUVOL is recorded on both observation records at time 11:45.Strictly speaking, it need only be recorded on the second( observation). This point is discussed further inChapter 7, Section 4.3.3.10. The Data PreprocessorThis section discusses in more detail the ways in which theData Preprocessor can modify data, and discusses when aformat specification should be included in the $DATA record.10.1. Day-time Translation10.1.1. TIME Data ItemSometimes the data contains clock times hh:mm (e.g., thetime 1:30 PM is recorded as 13:30). These times must beconverted to decimal-valued times (e.g., 13.5). The DataPreprocessor can perform this task when it is processingunformatted data. Within an individual record, the DataPreprocessor replaces the TIME value in the first datarecord with 0, and then replaces subsequent records&rsquo; TIMEvalues with the relative time (i.e., the number of hourselapsed since the first record). (The TIME value is alsoreset to 0 on a reset (EVID=3) or reset-dose (EVID=4)record.) Here is an example of relative time calculation:Contents of original file: Contents of new file:ID TIME ID TIME1 9:15 1 0.001 9:30 1 0.251 10 1 0.751 14:40 1 5.421 32.5 1 23.252 8 2 0.002 8.0 2 0.002 44:50 2 36.832 58 2 50.00The presence of the colon &quot;:&quot; in the TIME data item of atleast one record of the data causes the Data Preprocessor toconvert all the TIME values to elapsed values. Elapsedtimes are also called relativ________ times______ Note that recordeddata (lines 5, 8, and 9 of the original file) spanned morethan one day. The user had to add 24 to the TIME values oneach day subsequent to the first to communicate the correcttimes to the Data Preprocessor.10.1.2. DATE Data ItemHere is another way the above data could have been recorded,using a data item called DATE whose value is 1 for the firstday, 2 for the second day, and so on. This allows TIMEvalues to be recorded more naturally using values in therange 0-24.Contents of original file: Contents of new file:ID DATE TIME ID DATE TIME1 1 9:15 1 1 0.001 1 9:30 1 1 0.251 1 10 1 1 0.751 1 14:40 1 1 5.421 2 8.5 1 2 23.252 1 8 2 1 0.002 1 8.0 2 1 0.002 2 20:50 2 2 36.832 3 10 2 3 50.00The DATE data item is of significance only to the DataPreprocessor; NONMEM-PREDPP will not make use of it. Evenif there are no &quot;:&quot; characters among the TIME values, theexistence of a DATE data item will cause the DataPreprocessor to replace TIME values by relative times.10.1.3. Calendar DatesThe Dat____ dat____ ite____ (DATE) can also be used to recordcalendar dates in month-day-year format. Any alphabeticcharacter (e.g., / or -) can be used to separate thecomponents. Here is a third way the same example could berecorded:Contents of original file: Contents of new file:ID DATE=DROP TIME ID TIME1 10-1-86 9:15 1 0.001 10-1-86 9:30 1 0.251 10-1-86 10 1 0.751 10-1-86 14:40 1 5.421 10-2-86 8.5 1 23.252 10-12 8 2 0.002 10-12 8.0 2 0.002 10-13 20:50 2 36.832 10-14 10 2 50.00This example illustrates two features. First, when calendardates are used, the DATE item should be specified as&quot;DATE=DROP&quot;, so that the data item is omitted from the newdata file (see Section 5.3). Otherwise, the alphabeticcharacters which separate the components will cause readerrors when NONMEM reads the data. Second, the year valueis optional; only month and date were actually needed.(Within a single individual record, however, either alldates should specify a year, or none should.)Data labels DAT1, DAT2, and DAT3 are also recognized by theData Preprocessor and can be used instead of DATE. Thelabel given to the Date data item describes its format:DATE month day yearDAT1 day month yearDAT2 year month dayDAT3 year day monthIf only one of the three components is present, it isassumed to be the day&dagger;.<cite>&dagger; In this case only, the Date data item may be zero ornegative. Day -1 means one day prior to day 0. </cite>If only two components are present, they are assumed to bemonth and day (with DATE and DAT2) or day and month (withDAT1 and DAT3). The year may be omitted or given as 1, 2,3, or 4 digits. &#9474;10.1.4. Converting Hours to Days &#9474;The units of the relative TIME values resulting from the &#9474;Data Preprocessor&rsquo;s day-time translation are hours. If the &#9474;correct units for relative time should be days, then the &#9474;TRANSLATE option of the $DATA record may be used to request &#9474;that hours to be converted to days. For example, &#9474;$DATA filename TRANSLATE(TIME/24) &#9474;or &#9474;$DATA filename TRANSLATE(TIME/24.000) &#9474;With the former, values of TIME have two significant digits, &#9474;e.g., xxxx.xx. With the latter, they have three &#9474;significant digits, e.g., xxxx.xxx. &#9474;10.1.5. The Year 2000 - LAST20 &#9474;The user may supply 4 digit years starting (e.g.) &quot;19&quot; and &#9474;&quot;20&quot;, and such dates are processed correctly. (Three digit &#9474;years &quot;000&quot;-&quot;999&quot; are permitted, but would represent exactly &#9474;those years, and should not normally be used.) If the year &#9474;is omitted, it is assumed to be a non-leap year. A problem &#9474;arises when the year supplied, but has only 1 or 2 digits. &#9474;Such years are assumed by default to be in the 1900&rsquo;s. If &#9474;this is not a correct assumption, two errors may be made by &#9474;the Data Preprocessor when computing relative times. First, &#9474;1900 was not a leap year, but 2000 is a leap year. Hence, &#9474;if consecutive dates in a data file are 02-28-00 and &#9474;03-01-00 (signifying February 28 and March 1, 2000), an &#9474;elapsed time of 24 hours, rather than 48 hours, is computed. &#9474;Second, if consecutive dates have years 99 and 00, the &#9474;computed elapsed time is negative and an error message is &#9474;generated. &#9474;With NONMEM V and later versions there is a constant LAST20. &#9474;The value of LAST20 is a 2 digit number nn that specifies &#9474;the highest 2-digit year that is assumed to be in the 21st. &#9474;century, i.e., to represent 20nn rather than 19nn. For &#9474;example, with LAST20=50, then 1 and 2 digit years are &#9474;interpreted as follows: &#9474;00-50 represents 2000-2050 &#9474;51-99 represents 1951-1999 &#9474;The elapsed time between 02-28-00 and 03-01-00 is calculated &#9474;to be 48 hours, and the elapsed time calculated between the &#9474;years 99 (1999) and 00 (2000) is positive. &#9474;There are two ways that a value for LAST20 can be specified. &#9474;First, when NM-TRAN is installed, a value is given to &#9474;constant LAST20 in TrGlobal.f90 (in the resource directory): &#9474;DATA LAST20 &#9474;The default value of this constant in the distribution &#9474;medium is 50. Please ask your system support department if &#9474;they modified the LAST20 constant when NM-TRAN was &#9474;installed. &#9474;Regardless of what value was assigned to the LAST20 constant &#9474;in TrGlobal.f90, there is an option LAST20 of the $DATA &#9474;record that may be used to specify the value of the constant &#9474;for the current run. For example: &#9474;$DATA filename LAST20=50 &#9474;This insures that all 1 and 2 digit years are interpreted as &#9474;above (2000-2050; 1951-1999). &#9474;10.1.6. Leap Year Warning - LYWARN &#9474;There may be two circumstances such that 1 or 2 digit years &#9474;are recorded as 00, 01, ... (equivalently, 0, 1, ...). &#9474;First, these may represent the years 2000, 2001, etc. Or, &#9474;they may represent years 0, 1, etc., of a study. Suppose &#9474;the latter is the case, and that none of the years of the &#9474;study was a leap year. Then if LAST20 is set to a value &#9474;greater than -1, the year 0 is assumed incorrectly to be the &#9474;leap year 2000, and elapsed times may be computed &#9474;incorrectly. The Data Preprocessor issues a warning message &#9474;under the following circumstances: &#9474;1) The year is recorded as &quot;00&quot; or &quot;0&quot;, &#9474;2) The value of LAST20 is greater than -1 by default (so &#9474;that the year is understood to be 2000), and &#9474;3) The LAST20 option of the $DATA record was not used to &#9474;modify LAST20 for this run. &#9474;The warning message is as follows: &#9474;(DATA WARNING 3) RECORD 3, DATA ITEM 3: 01-01-00 &#9474;THE YEAR IS ASSUMED TO BE 2000 (A LEAP YEAR). IF THIS IS INCORRECT, USE&#9474;$DATA&rsquo;S LAST20 OPTION TO OVERRIDE THE DEFAULT VALUE OF LAST20 IN NMTRAN&rsquo;S&#9474;ABLOCK, OR CHANGE THE DEFAULT: 50 &#9474;Suppose these warning messages are appropriate, that is, &#9474;year &quot;00&quot; (or &quot;0&quot;) should not be a leap year. The LAST20 &#9474;option of the $DATA record may be used to specify that such &#9474;years are in the 1900&rsquo;s for the current data set: &#9474;$DATA filename LAST20=-1 &#9474;A constant LYWARN is defined in NM-TRAN&rsquo;s ABLOCK module. &#9474;The default value of LYWARN is 1 (&quot;data warning message 3 &#9474;enabled&quot;). If the value of LYWARN is set to 0 (&quot;data &#9474;warning message 3 disabled&quot;) and NM-TRAN is recompiled, then &#9474;the warning message is suppressed for all runs.10.2. Interdose Interval (II) ConversionWhen the input data is unformatted and PREDPP is being used,the Interdose Interval (II) data item is checked for valuescontaining a colon (:). Any such value is assumed to signala clock time hh:mm. The minutes portion is converted to adecimal number containing as many decimal places as digitsin the original. E.g., the value &quot;:30&quot; is replaced by&quot;.50&quot;. This conversion is performed whether or not day-timetranslation is also being done.10.3. Data Items Generated by the Data PreprocessorWhen the data is from a single individual, the DataPreprocessor will almost always generate an ID data item&Dagger;.<cite>&Dagger; Section 4.2 of Chapter 12 discusses the L1 data item,which is used to prevent NM-TRAN from generating anIdentification data item for individual data. </cite>It does this whether or not PREDPP is used. This is donebecause, when the data is from a single individual, the IDdata item must take on very special non-constant values forNONMEM. The generated ID data item is given the label&quot;.ID.&quot; (i.e., ID surrounded by dots). If this data item isto be shown in any NONMEM output (e.g., in a table), it mustbe referred to on subsequent NM-TRAN records by this label.When PREDPP is used, the Data Preprocessor will alwaysgenerate the required EVID data item if it is not alreadylisted on the $INPUT record. (This was discussed in Section7.3 above.)When PREDPP is used, the Data Preprocessor will alwaysgenerate the MDV (Missing Dependent Variable) data item ifit is not already listed on the $INPUT record.These data items are generated by the Data Preprocessorwhether or not a format specification was coded on the$INPUT record. They are appended to the end of each datarecord.10.4. When Must a Format Specification be Included orOmitted?When coding the $DATA record, you will need to decidewhether to include a FORTRAN format specification describingthe data file or to omit it and let the Data Preprocessorconstruct it. Here are some guidelines in making thisdecision.A format specification is required when:Some data values are left blank on some data records,without having the value 0 or . (or a pair of commas)to hold the place of the missing value.Some data values are adjacent on some data records;they are not separated by a space or a comma.The data records span multiple physical records; thatis, the character / is needed in the formatspecification. (The Data Preprocessor may generatesuch a format specification for the NONMEM data set; weare speaking here of the NM-TRAN data set.)A format specification should not be present when:The $INPUT record includes DROP as a data item label orsynonym.Day-time translation is desired.II conversion is desired.Commas are used to separate the data items.The data values are not lined up into columns withuniform width, so that no format specification can bewritten to describe the file.Many data files do not fall in either category. A formatspecification is optional for such files.10.5. Skipping Data ItemsIt is always possible to omit (skip) data items that are notof interest for a given NONMEM run. When a formatspecification is coded, two things must be done: first,replace the data item&rsquo;s specification by an &quot;X&quot;specification (e.g., replace F8.0 by 8X) and second, deletethe data item&rsquo;s label from the $INPUT record. When noformat specification is coded, all that need be done is toreplace the data item&rsquo;s label in the $INPUT record by DROP(or include DROP as a synonym).">1. What This Chapter is AboutThis chapter tells how to create data for analysis byNONMEM-PREDPP. It tells how to describe the data using$DATA and $INPUT records. The requirements for formattingthe data for NONMEM-PREDPP are somewhat more stringent thanare the requirements for formatting the data for NM-TRAN.The Data Preprocessor is a component of NM-TRAN whichmodifies the data so that it becomes formatted appropriatelyfor NONMEM-PREDPP.2. Data Sets for NONMEM2.1. Data RecordsA data set for NONMEM analysis consists of a series ofrecords (&quot;lines&quot; in the terminology of editing programs).Each record must consist of a fixed number of data items andeach must have the same format. Figure 6.1 shows how such adata set may be pictured. In data base terminology, this isa &quot;flat&quot; structure.Figure 6.1. A NONMEM input data set. Each data record is arow; each type of data item is in a different column.NONMEM imposes no limit on the number of records in the dataset. It does not (nor does PREDPP or NM-TRAN) sort the datarecords before processing them, so the data records mustalready be in the correct sequence. NONMEM itself cannot beinstructed to delete or drop records from the data set, but &#9474;see the DROP and IGNORE options of the $DATA record, below.2.2. Data ItemsNONMEM reads records from the data set with a FORTRAN FORMATspecification, and so each data item must occupy a fixednumber of character positions. Data items are alwaysnumbers. However, if no particular number is appropriatefor a given data item on a given record, the data item iscalled a nul____ dat____ item_____ it may be given the numerical value0 or the nonnumerical value &quot;.&quot;, or left blank. Zero&rsquo;s wereused in the first two lines of the Theophylline example ofChapter 2, which appeared as follows:2 320. 0. 0.2 0. .27 1.71The Data Preprocessor allows each value in the data set tooccupy only as many character positions as it needs, so longas the data items are separated by blanks (spaces) orcommas. Tab characters may also be used as separators if &#9474;they are stored as explicit characters, e.g., ASCII 011, &#9474;although this is platform-dependent and should be tested &#9474;carefully. When there are no commas or tabs, the value &quot;.&quot;or 0 must be used to hold the place of a null data item.The two lines above could have been entered as follows:2 320. 0. 0.2,,.27,1.71(Note the use in the second line of adjacent commas &quot;,,&quot; todenote a null data item.)The contents of the data items must be purely numeric; i.e.,character values such as Y, N, M or F may not be recorded.Instead, numeric codes such as 0 or 1 must be used.With NONMEM VI, the number of data items per data record isgiven by constant PD in file SIZES. The default value is20. With NONMEM 7.1, the default value is 50. With NONMEM7.2, there is no limit on the number of data items per datarecord.2.3. Clinical Data and Data ConversionClinical data often has a &quot;hierarchical&quot; file structure,with (say) two record formats: a patient record, containingfixed information about a patient (ID number, sex, age,prior history of smoking or drug use, etc), followed by oneor more visit records, containing doses and physicalobservations during the course of the study. Visit recordsmay not even contain the same number of items as patientrecords, nor have the same format. The hierarchy is shownschematically in figure 6.2.Patient recordVisit recordVisit record...Patient recordVisit recordVisit record...Figure 6.2. A hierarchical data file. Patient and visitrecords have different formats.NONMEM cannot accept such data. For NONMEM, the (fixed)information on the &quot;patient&quot; record must be copied ontoevery &quot;visit&quot; record, and the &quot;patient&quot; records must beeliminated. This is the user&rsquo;s responsibility and istypically done in a one-time data conversion step using thesystem editor and/or a specially written computer program.If an individual&rsquo;s data is to be deleted because he did notcomplete the study or had an adverse outcome, it should bedone at this time. In addition, numeric codes should besubstituted for alphabetic codes. Clinical data sometimesincludes multi-digit, non-consecutive patient identificationnumbers drawn from some patient identification system. Suchpatient identification numbers can be used with NONMEM asthe identification data item described in Section 6.2.However, it is preferable to append to each patient&rsquo;s datarecords numbers from the sequence 1, 2, 3, ..., for use asthe ID data item. This will make it easier to read ascatterplot which includes ID along one of the axes (e.g.,residual vs ID).When there is a large amount of data, we strongly suggestthat a small amount of data (from one or two individuals) beprepared for NONMEM-PREDPP analysis and a run in which onlytables and scatterplots are output be made to check that thedata is correctly prepared before a great deal of labor isexpended on the remainder.3. Data Sets for PREDPPWhen PREDPP is used with NONMEM, the data must meetadditional requirements. First, PREDPP is concerned withtime-ordered events such as dose events, which introducedrug into the system at particular times, and observationevents, which report observations taken at particular times.PREDPP insists that these events be recorded on separaterecords. That is, dosing information cannot be recorded onthe same record as an observed value. Second, PREDPPrequires that the time of each event be recorded on eachdata record, and that the physical sequence of the datarecords be the same as their sequence in time. (E.g., if adose event immediately precedes an observation event intime, then the dose event record must immediately precedethe observation event record.) Again, neither PREDPP northe Data Preprocessor will physically sort or resequence thedata records.4. The $DATA RecordThe $DATA record describes the characteristics of theexternal data file to be processed by NONMEM. NONMEM is nota data base management system and does not store a data setbetween runs; once a file has been prepared for NONMEM, itmust be re-read each time it is to be analyzed. The firstcharacter string appearing after $DATA is the name of thefile containing the data. Since it is to be used in aFORTRAN OPEN statement, this name may not include embedded &#9474;special characters such as slashes (/ or \), commas, &#9474;semi-colons, parentheses, equal signs or spaces unless it is &#9474;surrounded by single quotes &rsquo; or double quotes &quot;. The &#9474;filename may contain 80 characters. (If a file is to be &#9474;opened by NONMEM rather than by NM-TRAN, the filename may &#9474;not contain embedded spaces, and may contain at most 71 &#9474;characters.) A FORTRAN format specification suitable toread the data may follow the file name; this is optional andcan be supplied by the Data Preprocessor. The choice isdiscussed more fully in Section 10.4 of this chapter.Certain options may be specified if desired. Among theseare:RECORDS=nThis tells the number of records to be read from thedata file. If omitted, the records are read to theend-of-file or to a NONMEM FINISH record (Users GuideII). The RECORDS option may be used to limit NONMEMprocessing to the initial portion of the file and isuseful during the early stages of debugging. &#9474;RECORDS=label &#9474;&quot;Label&quot; is a data item label. The data records for the &#9474;problem will start at the place where the file is &#9474;positioned before data records are read and include all &#9474;contiguous data records having the same value for the &#9474;data item. In particular, the ID label may be used (or &#9474;alternatively, the option may be coded RECORDS=IR, &#9474;RECORDS=INDREC, or RECORDS=INDIVIDUALRECORD) to obtain &#9474;the data for a single individual. &#9474;IR,INDREC,INDIVIDUALRECORD. &#9474;NOREWIND|REWIND &#9474;With the first problem specification in a control &#9474;stream, the file is positioned at its initial point so &#9474;that the first record in the file is used. The options &#9474;REWIND and NOREWIND apply only with a $DATA record in a &#9474;subsequent problem specification. &#9474;REWIND: Reposition the file at the start. &#9474;NOREWIND: Leave the file at its current position so &#9474;that the next record in the file is read. Used when &#9474;the $DATA record with the previous problem &#9474;specification included the RECORDS option so that &#9474;NM-TRAN did not read to a physical end-of-file. This &#9474;is the default.LRECL=nThis tells the length of the physical data records. Itis required if the operating system associates a fixedphysical record length with every disk file andconsiders it a fatal I/O error if a READ commandrequests more characters than the records contain. Ifthis is true of your operating system, the operatingsystem will issue an error message when you first runNM-TRAN without the LRECL option in the $DATA record.WIDE This requests that the NONMEM data set produced byNM-TRAN always contain single-line records, and thatthese records always include at least one space betweendata items. Such a data set can be further processedby other programs. (The default is NOWIDE, in whichcase NM-TRAN limits the records to 80 characters bycreating multi-line records and/or eliminating spacesbetween data items if necessary.) It may not be usedif a FORTRAN format specification is present. It also &#9474;provides an extra character for relative times computed &#9474;by the Data Preprocessor.NULL=cThis requests that the NONMEM data set produced byNM-TRAN contain the character c in place of null dataitems. For example, NULL=0 requests that all null dataitems be replaced by 0. The syntax NULL=&rsquo;c&rsquo; andNULL=&quot;c&quot; is also permitted. The default is NULL=&rsquo; &rsquo;.It may not be used if a FORTRAN format specification ispresent.IGNORE=cThis instructs NM-TRAN to ignore data records havingcharacter c in the first character position (&quot;column1&quot;) of the record. This allows the use of &quot;comment&quot;records in the NM-TRAN data set. The syntax IGNORE=&rsquo;c&rsquo;and IGNORE=&quot;c&quot; is also permitted. It may be used evenif a FORTRAN format specification is present. &#9474;The character @ has a special meaning. It signifies &#9474;that any data record containing an alphabetic character &#9474;(or special characters @ or #) as its first non-blank &#9474;character (not just in column 1) should be ignored. &#9474;Alphabetic characters are the letters A-Z and a-z. &#9474;Thus, a table file produced by NONMEM in an earlier run &#9474;can be used as an NM-TRAN data set. Any header lines &#9474;included in this table can be dropped by specifying &#9474;IGNORE=@. &#9474;When the IGNORE option is omitted, any records &#9474;containing the character # in column 1 are ignored. &#9474;IGNORE=(list), ACCEPT=(list) &#9474;This form of the IGNORE option allows records to be &#9474;dropped based on the values of data items. For example, &#9474;IGNORE=(GEN.EQ.1,AGE.GT.60). &#9474;Records having GEN equal to 1 or AGE greater than 60 &#9474;are dropped. All others are accepted. The ACCEPT &#9474;option allows records to be accepted based on the &#9474;values of data items. See Guide VIII for more &#9474;information. &#9474;&#9474;LAST20=nn &#9474;&quot;nn&quot; is a 2 digit number that specifies the highest &#9474;2-digit year that is assumed to be in the 21st. &#9474;century, i.e., that represents 20nn rather than 19nn. &#9474;See Section 10.1.5 below. &#9474;TRANSLATE &#9474;The translate option must be followed by parentheses &#9474;enclosing a list of one or more translate &#9474;specifications. For example, &#9474;$DATA filename TRANSLATE(TIME/24,II/24) &#9474;Translate specification TIME/24 causes the value of &#9474;TIME to be divided by 24, whether or not day-time &#9474;translation occurs (i.e., whether or not relative times &#9474;are being computed). This has the effect of changing &#9474;the unit of TIME from hours to days. Similarly, &#9474;translate specification II/24 causes the value of II &#9474;(interdose interval) to be divided by 24 whether or not &#9474;&quot;:&quot; appears in any II value. See Section 10.1.4 below.5. The $INPUT RecordThis record describes how many data items there are on eachdata record, the order of the data items, and tells what thelabels of the data items are.5.1. Data Item LabelsA data item label is one to four letters (A-Z) or numerals(0-9). With NONMEM 7 a label consists of 1-24 letters &#9474;(A-Z), numerals (0-9), and the character &rsquo;_&rsquo;. (The length &#9474;24 is specified by constant SDF in SIZES) &#9474;The first character must be a letter. These labels are theones which will be used in other records (such as $PK or$SCATTERPLOT), and will appear in NONMEM&rsquo;s output. Theorder of the data items on the data records is notimportant, but must be the same on all data records in thedata set. In both the examples of Chapter 2, the ID dataitems happened to be the first ones in the data records, andthe DV data items happened to be the last ones. This orderwas arbitrary.5.2. Reserved Labels and SynonymsCertain data item labels are reserved in that they identifydata items which are recognized specifically by NONMEM,PREDPP, or NM-TRAN. The data items they label arethemselves called NONMEM, PREDPP, or NM-TRAN data items,respectively.&bull; Reserved NONMEM data item labels are: ID, L2, DV, andMDV. They are discussed in Section 6 of this chapterand in Section 4.2 of Chapter 12. Additional reservedNONMEM data item labels are: MRG_, RAW_, and RPT_. See &#9474;Guide VIII for a discussion of these items.&bull; Reserved PREDPP data item labels are: TIME, EVID, AMT,RATE, SS, II, ADDL, CMT, PCMT, CALL, and CONT. Theyare discussed in Section 7 of this chapter and inSection 2.4 of Chapter 12. Additional reserved PREDPP &#9474;data items are the extra EVID labels, XVID1, XVID2, &#9474;XVID3, XVID4, and XVID5. See Guide VIII for a &#9474;discussion of these items.&bull; Reserved NM-TRAN data item labels are: DATE, DAT1,DAT2, DAT3, and L1. DATE, DAT1, DAT2, and DAT3 arediscussed in Section 10.1 of this chapter; L1 isdiscussed in Section 4.2 of Chapter 12.If you do not want to use the reserved label, you can supplytwo labels: the reserved label and a &quot;synonym&quot;. Eitherlabel can be used in subsequent records, but only thesynonym will appear in NONMEM output. For example,$INPUT PNO=ID,CONC=DV,DOSE=AMT,WT,....The first three data items are given the labels PNO, CONC,and DOSE. These labels are synonyms for the NONMEM dataitems ID and DV and for the PREDPP data item AMT. The lastdata item is given the label WT and is not a reserved dataitem; it is an example of fixed effect (&quot;concomitant&quot;) dataWhen $PK and $ERROR records are present, certain labels maynot be used at all as data item labels. These are: thelabels for the basic and additional PK parameters for thepharmacokinetic model, as listed in Appendices 1 and 2(e.g., for ADVAN1 and TRANS2: CL, V, S1, S2, F1, F0), andspecific labels for the arguments of the PK and ERRORsubroutines: IDEF, IREV, N, GG, IRGG, HH, and G.5.3. Dropping Data Items via DROPIf no format specification is included on the $INPUT record,then another synonym, DROP, may be used with any data item.DROP may be used as a synonym more than once. It identifiesdata items to be dropped (i.e. eliminated) from the NM-TRANdata set by the Data Preprocessor while constructing theNONMEM data set. This provides a way to limit the number ofdata items in the NONMEM data set and to eliminatenon-numeric data items.6. NONMEM Data Items6.1. DV Data ItemThere must always be a Dependen_________ Variabl________ dat____ ite____ labeledDV. This is a value of an observation. There can be onlyone DV data item per data record. The position of the DVdata item (and the ones described below) is not important.However, its position must be the same on all records.6.2. ID Data Item for Population DataWhen the data is from a population, NONMEM expects theIdentificatio______________ dat____ item_____ labeled ID, and expects the datato be organized into two or more &quot;individual records&quot;. Anindividua__________ recor______ is a group of contiguous data recordshaving the same value for the ID data item and presumablycontaining data from the same individual. ID data itemvalues need not be consecutive, increasing, unique, norbegin with 1. E.g., 3, 5, 6, 10, 3, etc. is a possiblesequence of ID values. Note the two instances of 3 as IDdata item values. As long as these two instances areseparated by different ID data item values (e.g. 5, 6, 10),they represent different individuals.6.3. MDV data itemIf there are records in an input data set which do notcontain values of observations, then NONMEM needs to beinformed of this fact. This is done using the Missin_______Dependen_________ Variabl________ dat____ ite____ labeled MDV. The values of MDVare:0 The DV data item of the data record contains a value ofan observation. The record is referred to as anobservatio___________ record_______1 The DV data item of the data record does not contain avalue of an observation.NONMEM limits the number of observation records per &#9474;individual record to 250. To change this limit, see UsersGuide III.When PREDPP is used, the Data Preprocessor is able torecognize which records contain observed values and which donot, and it can supply the MDV data item if it is notalready present in the data set, i.e. if the label MDV doesnot occur in the $INPUT record. (When PREDPP is not used,the Data Preprocessor cannot do this.)7. PREDPP Data Items7.1. TIME Data ItemPREDPP will in general need theTim____ dat____ item_____ labeled TIME. The value of TIME must benon-negative. Within an individual record, values of TIMEmay not decrease. (Exceptions exist for reset andreset-dose events; see Section 7.3.) The units are optional(e.g., minutes or hours), but should be consistent withother units used in the problem. The TIME of the firstevent record may be zero or non-zero. (If non-zero, thenPREDPP in effect subtracts this value from all other TIMEvalues within the same individual record, so that PREDPPalways works with relative time values.) The DataPreprocessor permits TIME to be expressed as clock time(e.g., 8:30, representing the time, half-past 8 o&rsquo;clock).Such times are converted by the Data Preprocessor intorelative times. Details are given in Section 10.1 below.7.2. AMT, RATE, SS, II: Dose-related Data ItemsDoses are described using one or more of these four dataitems, depending on the kind of dose. A detailed discussionof these data items and of dose records in general isdeferred to Section 8 below.7.3. EVID Data ItemWhen PREDPP is used, all data records are also called even_____records________ Every event record must contain an Even_____Identificatio______________ dat____ ite____ identifying the kind of eventdescribed by the record, and labeled EVID. The values ofEVID and the five kinds of event records are:0 Observation event. This record contains an observedvalue (in the DV data item). Dose-related data itemssuch as RATE and AMT must be 0.1 Dose event. This record describes a dose. Thecontents of the DV data item are ignored.2 Other event. This record is used for a variety ofpurposes. It can be used to obtain a predicted valueat a point in time at which no actual observation ordose event took place; it can be used to turn acompartment off or on at a point in time; it can beused to mark a time at which a change in aphysiological data item (e.g. weight) occurs (as wellas give the new value of the data item). Dose-relateddata items must be 0. The contents of the DV data itemare ignored.3 Reset event. This record is used to reset the kineticsystem at some point in time, without actually startinga new individual record: time is set to whatever timeappears in the event record, the amounts in eachcompartment are set to zero, prior doses are cancelled,and the on/off status of each compartment is set to itsinitial status. It is in all other respects identicalto an other event type record. It is typically usedwithin an individual record, when the individual had acourse of drug treatment, followed by a wash-outperiod, followed by another course of drug treatment.It should appear prior to the start of the secondcourse.4 Reset-dose event. This record combines EVID types 3(reset) and 1 (dose). First the system is reset, andthen a dose is introduced. It is in all other respectsidentical to an ordinary dose event type record.If only dose and observation event records are present inthe NM-TRAN data set, and if EVID is not already present inthe data set (i.e. EVID does not appear in the INPUTrecord), then EVID will be supplied automatically by theData Preprocessor. This is what was done in the examples ofChapter 2. If other or reset type event records are presentin the data set, then the $INPUT record must include theEVID data item, and the data set must include theappropriate values for EVID on all the data records.7.4. CMT and PCMT Data ItemsThe Compartmen___________ dat____ ite____ (CMT) and Predictio__________ Compartmen___________dat____ ite____ (PCMT) are similar. Both contain the number of acompartment in the model. (Compartments and compartmentnumbers are discussed in Chapter 7 and Appendix 1, as aredefault compartments. It may help to look at Chapter 7 andAppendix 1 at this time.) If CMT or PCMT is not defined inthe data set (i.e., not listed in the $INPUT record), or hasthe value 0 on a given event record, the appropriate defaultcompartment is used, except as noted below. This is whatwas done in the examples of Chapter 2. The meaning of thetwo data items depends on the particular kind of eventrecord.&bull; Observation event: CMT specifies the compartment fromwhich the predicted value of the observation isobtained. PCMT is ignored. When CMT specifies theoutput compartment, it is allowed to have a negativesign (e.g., with the One-compartment model, CMT may be-2). This signals that after the prediction iscomputed the output compartment is to be turned off,i.e. the amount in the compartment is to be set tozero. The amount remains zero until the compartment issubsequently turned on. This is quite useful withurine observations; see Section 9 below.&bull; Dose event: CMT specifies the compartment into whichthe dose is introduced. The compartment is turned onif it was previously off. PCMT specifies thecompartment for which a predicted observation iscomputed. This predicted value is not associated withan observation, but it can be useful because it willappear in tables or scatterplots.&bull; Other event: A positive value of CMT specifies that thecompartment is to be turned on if it is off. Anegative value of CMT specifies that the compartment isto be turned off if it is on. (If CMT is 0, nocompartment is turned on or off.) PCMT is the same asfor dose events.&bull; Reset event: CMT is ignored. PCMT is the same as fordose events.&bull; Reset-dose event: CMT and PCMT are the same as for doseevents.7.5. CALL Data ItemThe Cal____ dat____ ite____ (CALL) is used to force a call to eitheror both of the PK and ERROR subroutines with the eventrecord when such a call would not normally occur. A call tothe PK or ERROR subroutine causes the code specified by the$PK or $ERROR records, respectively, to be executed with theevent record. This is discussed in Chapters 7 ($PK) and 8($ERROR).) When not defined in the data set, CALL isassumed to be 0 always. The values are:0 No forced call; PREDPP takes its normal action.1 Force a call to ERROR.2 Force a call to PK.3 Force a call to both PK and ERROR.10 Force a call to ADVAN9. May be combined with other &#9474;values. E.g., the value 12 means &quot;Force a call to PK &#9474;and to ADVAN9&quot;.8. Describing Doses to PREDPPDoses are described using one or more of the data itemsdiscussed below. A detailed discussion of the actual kindsof doses that PREDPP recognizes follows in Section 8.2,including a precise definition of what is meant by the term&quot;steady-state dose&quot; (Section 8.2.3). A data item that isnot needed to describe the kinds of doses used in the studyneed not be defined in the data set; it will in effectalways have the value 0. Only AMT (Dose amount) was used inthe examples of Chapter 2, for example. The values ofdose-related data items should be 0 for non-dose events andfor those dose events to which they are not relevant.8.1. Dose-related Data ItemsAMT data itemThe Amoun______ dat____ ite____ (AMT) gives the amount of a bolus doseor of an infusion of finite duration. This amount should bea positive number.RATE data itemThe Rat____ dat____ ite____ (RATE) gives the rate of an infusion.This rate should be a positive number. (Negative values arediscussed in Chapter 12, Section 2.3.)SS data itemThe Steady-stat____________ dat____ ite____ (SS) can take four values. &#9474;0 This record does not describe a steady-state dose.1 This record describes a steady-state dose. If this isnot the first event record for the individual, then thesystem is first reset as if by a reset event record(except that the on/off status of the compartments isunchanged from what it was prior to the event recordand the time on the event record must not be less thanthe time on the previous event record). Thecompartment amounts are then computed usingsteady-state kinetic formulas.2 This record describes a steady-state dose. No reset ofthe kinetic system occurs. Compartment amounts arecomputed using steady-state kinetic formulas and arethen added to the amounts already present at the eventtime. The use of SS=2 will be discussed further inSection 8.2.7, below. &#9474;3 This record describes a steady-state dose. It is &#9474;exactly like a steady-state dose with SS data item = 1, &#9474;except that existing compartment amounts and &#9474;derivatives are retained and used as initial estimates. &#9474;The computed steady-state levels replace these &#9474;compartment amounts and derivatives. This value of SS &#9474;may be specified only with SS6 and SS9 (the General &#9474;Nonlinear Models).II data itemThe Interdos_________ Interva________ dat____ ite____ labeled II gives the timebetween implied doses (see Section 8.2.3 and Chapter 12,Section 2.4). For a steady-state infusion, it should be 0.For other steady-state doses, it should be a positive numberwhose units are the same as the TIME data item.8.2. Different Kinds of DosesAny of the doses described here may be introduced into anycompartment of the model except the output compartment.Examples are given below that are fragments of data records,identifying the data items of interest and showing theircontents on the dose record. The units of various dataitems are presumed to be appropriate for some actual data.8.2.1. Instantaneous Bolus DosesAll the examples in Chapter 2 involve instantaneous bolusdoses, which we shall refer to simply as bolus doses.(There is also such a thing as a &quot;zero-order bolus dose&quot;,see Chapter 12, Section 2.3.) These are dose records havingAMT&gt;0, RATE=0 and SS=0. (Recall that if RATE and SS arenot defined on the $INPUT record, they are effectively 0.)If the $PK record computes a bioavailability fractionparameter for the compartment into which the dose isintroduced, then the contents of the AMT data item ismultiplied by the current value of this parameter before theamount is added to the compartment. A bolus dose enters thedose compartment immediately; the predicted (scaled) amountin the dose compartment, if displayed in a table orscatterplot, will include the dose.Example:TIME AMT4. 10.This is a dose of 10 to be added to the default dosecompartment at time 4.A bolus dose to the central compartment might be interpretedas an IV bolus dose; to the depot it might be an oraltablet; to a peripheral compartment it might be anintra-muscular injection.8.2.2. InfusionsInfusions are doses having AMT&gt;0 and RATE&gt;0. The durationof the infusion is computed by PREDPP by dividing the AMT bythe RATE. As with bolus doses, AMT is first multiplied bythe bioavailability parameter for the dose compartment, ifany. There is no explicit &quot;end of infusion&quot; record. Drugamounts in the system cannot be affected in a detectable wayat the time an infusion begins by any drug introduced by theinfusion; the predicted (scaled) amount in the dosecompartment, if displayed in a table or scatterplot, willnot include the dose. Infusions may overlap. That is,subsequent dose records may start new infusions before oldones have finished. It is not an error if an infusion&rsquo;sduration is so large as to extend beyond the time of thelast event record for the individual; the remainder of thedrug is ignored. A reset or reset-dose event, or asteady-state dose event with SS=1, will also terminate anyinfusions in progress.Example:TIME AMT RATE4. 10. 2.The duration of the infusion will be computed as 10./2., andso the infusion, which begins at time 4, will terminate attime 9. (=4.+5.).An infusion to the central compartment might be interpretedas an IV infusion; to the depot it might be a sustainedrelease tablet; to a peripheral compartment it might be animplant or skin patch which releases drug at a knownconstant rate. It is possible for NONMEM-PREDPP to estimatethe input rate of a constant-rate drug delivery system (seeChapter 12, Section 2.3).8.2.3. Steady-State DosesA steady-state dose can be regarded as the last one of aseries of doses just like the one specified in the doseevent record, which have been given at a regular interdoseinterval since time , and such that they have led to asteady-state periodic pattern of drug amounts in the systemby the time this last dose has been administered. The dosesof similar kind that precede it are called implie_______ doses______because their existence is not described by separate doserecords in the data set, but rather is implied by thedescription of the single steady-state dose. By stipulatingthat a dose is a steady-state dose, the user instructsPREDPP to update the drug amounts in the system at the timethe dose is given by using steady-state kinetic formulas.This can take less computational time than using separatedose records to describe the implied doses and usingtransient kinetic formulas to advance the system from onedose time to the next (as well as requiring fewer doserecords). The formulas used to compute the steady-stateamounts at the time the steady-state dose is introduced usethe values of the basic and additional pharmacokineticparameters in effect at this time; any values in effect atearlier times are ignored. Moreover, when using asteady-state dose, the user is assuming that underreasonable values of the pharmacokinetic parameters,steady-state is in fact effectively reached by the time thedose is introduced; PREDPP does not check this assumption.The output compartment must be off when a steady state doserecord is encountered in the data set.8.2.4. Steady-State with Multiple Bolus DosesThese are dose events having AMT&gt;0, RATE=0, SS=1, and II&gt;0.The II data item (interdose interval) tells how many timeunits apart the doses were given. As with non-steady-statebolus doses, AMT is first multiplied by the bioavailabilityparameter for the dose compartment, if any.Figure 6.3 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.3. Steady-state with multiple bolus doses. Thedose is given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT SS II8 10. 1 12Here, an infinite number of bolus doses, 10 units each, areassumed to have been given 12 hours apart, with the last ofthese given at time 8AM, at which time steady-state isreached. The fact that TIME is 8 has no effect on thecomputed amounts, but is important in relation to therecords that follow. Steady-state levels can be predictedat any time between the time on the dose record (8) and theend of the succeeding interdose interval (12) (providedthere are no further doses introduced during this interval).If another (steady-state or non-steady-state) dose just likethe steady-state one is introduced at time 20, thenpredictions in the interdose interval following this timewill also be steady-state levels.8.2.5. Steady-State with Multiple InfusionsThese are dose events having AMT&gt;0, RATE&gt;0, SS=1, and II&gt;0.Each such event describes the last of a series of regularlyspaced infusions, all of the same amount and rate. As witha non-steady-state infusion, the duration of each infusionis given by AMT/RATE. The bioavailability fraction appliesto each infusion of the series.Figure 6.4 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.4. Steady-state with multiple infusions. The doseis given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT RATE SS II16 10. 5. 1 6Here, infusions, each 10 units and of duration 2 (=10/5),are assumed to have been given 6 hours apart, with the lastof these started at time 4PM, at which time steady-state isreached. The daily dose times were 4 AM, 10 AM, 4 PM, and10 PM. Again, the value of TIME has no effect on thecomputed amounts but is important in relation to the recordsthat follow. Steady-state levels can be predicted betweentimes 16 (4 PM) and 22 (10 PM) (provided there are nofurther doses introduced during this interval).8.2.6. Steady-State with Constant InfusionThese are dose events having AMT=0, RATE&gt;0, SS=1, and II=0.Such an event consists of infusion with the stated rate,starting at time , and ending at the time on the doseevent record. Bioavailability fractions do not apply tothese doses.Figure 6.5 shows how drug levels vary with time.Figure 6.5. Steady-state with constant infusion.Steady-state level can be predicted only at time t.Example:TIME RATE SS16 2. 1Here, a steady-state infusion at rate 2 is specified asending at 4 PM. A steady-state level can be predicted onlyat this time.8.2.7. Multiple Steady-State DosesDoses with SS=2 are exactly like doses with SS=1. Doseswith SS=2 are similar to non-steady-state doses in thatcompartment amounts are computed in two steps. First,compartment amounts are computed at the time on the doseevent record based on the prior dosing history of thesystem. Second, steady-state amounts are computed from thedosing information on the record and added to the existingcompartment amounts. Thus, if the kinetics are linear, thisresults in an application of the superposition principlewherein the amounts in the system resulting from dosesdescribed by dose event records preceding the time of thesteady-state dose are superposed on the (steady-state)amounts in the system resulting from the steady-state doseand the implied doses.As with any steady-state dose, the steady-state amounts areobtained using the values of the pharmacokinetic parameterscomputed from the information on the steady-state doserecord. In the case that SS=2, though, if these valuesdiffer from those computed from the information on theprevious dose record(s), then the compartment amounts at thetime in the steady-state dose record are not trulysteady-state amounts, and the computed steady-state levelsare not valid predictions. PREDPP will not detect thiserror. We emphasize that superposition is only valid withlinear kinetic systems; all the kinetic systems (ADVANs)discussed in this text are linear.SS=2 records can be used to achieve the specification ofcomplicated dosing regimens. For example, Figure 6.6 showshow drug levels vary with time when two different doses arealternated. In this illustration, two steady-state dosesare specified, each with interdose interval I and with timebetween the two steady-state doses equal to I/2. Even morecomplex patterns are possible.Figure 6.6. Multiple steady-state doses. Two separatesteady-state doses are given. As pictured, they are eachbolus doses, but they do not have to be. The first doseevent record is at time t. The second dose event record isat time t+I/2. They each have interdose interval I.Steady-state levels can be predicted between times t+I/2 andand t+I.Example:TIME AMT SS II8 10. 1 2420 15. 2 24This describes the following dosing regimen: a dose of 10units every morning at 8 AM and a dose of 15 units everyevening at 8 PM (20 hours is 12 hours past 8). Note thatsteady-state is not truly established until after the seconddose record; any observation events interposed between thetwo dose records will reflect only the first steady-statedosage (i.e., 10 units every 8 AM). Another way to achievethe same steady-state is by the following:Example:TIME AMT SS II20 10. 1 1220 5. 2 24This describes doses of 10 units every 12 hours, the last ofwhich is given at 8 PM (i.e. at 8 AM and 8 PM daily), plusadditional doses of 5 units at 8 PM daily. In bothexamples, the steady-state levels can be predicted from time20 hours to time 32 hours.8.2.8. Combining Non-Steady-State Doses with Steady-StateDosesNon-steady-state dose records may appear before, among, orafter steady-state dose records. Such a dose record mayoccur before a steady-state dose record to reflect atransient dose given among a series of regular doses leadingto steady-state, but which is not a part of this series.E.g., a patient who has been maintained at steady-statetakes an extra dose by mistake shortly before hisappointment. A non-steady-state dose record may occur aftera steady-state dose record in order to continue the patternof doses beyond the steady-state dose. Ordinarily,steady-state levels can only be predicted between , thetime on the steady-state dose record, and , the sum ofand the interdose interval. If it is not only necessary tocompute a steady-state prediction between and , butalso after , then there must also occur one or morenon-steady-state dose records at , , etc. with dosesjust like the steady-state dose. (The &quot;additional doses&quot;data item, labeled ADDL, is especially useful for thispurpose; see Chapter 12, Section 2.4.)Example:TIME AMT SS II8 10. 1 2420 15. 2 2432 10. 0 044 15. 0 0Here, the last two records continue the steady-state patternof the first two. Steady-state levels may be predictedbetween times 20 and 56.Similarly, a steady-state constant infusion may be extendedwith a non-steady-state infusion. In the example below,steady-state levels can be predicted from time 0 to time100.TIME RATE AMT SS0 30 0. 10 30 3000. 09. The Output Compartment: Urine Collections andObservationsIn this section we show how urine collections andobservations of urine concentration, , can be described.The first-time reader may prefer to return to this sectionafter reading Section 4.3.3 of Chapter 7. As an example,consider the one-compartment model with first-orderabsorption (ADVAN2). The sequence of events is:6:00 AM A bolus dose of 100 is given.8:00 AM A urine collection is started.9:30 AM and urine volume (UVOL) are measured and anew collection is started.11:45 AM , , and urine volume are measured.The $INPUT record is:$INPUT ID TIME EVID UVOL DV CMT AMTThe data records appear as follows:ID TIME EVID UVOL DV CMT AMT1 6.00 1 0 0 1 1001 8.00 2 0 0 3 01 9.50 0 75 .058 -3 01 9.50 2 0 0 3 01 11.75 0 100 .067 -3 01 11.75 0 100 5.80 2 0Notice that urine collections start with an other type eventrecord (EVID=2) whose CMT contains the number of the outputcompartment, the effect of which is to turn this compartmenton at 8AM, i.e. to begin accounting for the amount of drugappearing in this compartment from 8AM. Because other typeevent records are included, the EVID data item must bepresent in the data. The CMT data item must be present inall event records since it is needed to refer to the outputcompartment in at least one record. Care must be taken touse correct values for the CMT data item; default valuesused when this data item is not present are not relevant inthis case. The DV value on the observation record at 9:30is the measured . Because the value of CMT is negative,the output compartment is also turned off at 9:30. Sincethe collection is to continue, the compartment must beexplicitly turned on again (the fourth record). Note thatUVOL is recorded on both observation records at time 11:45.Strictly speaking, it need only be recorded on the second( observation). This point is discussed further inChapter 7, Section 4.3.3.10. The Data PreprocessorThis section discusses in more detail the ways in which theData Preprocessor can modify data, and discusses when aformat specification should be included in the $DATA record.10.1. Day-time Translation10.1.1. TIME Data ItemSometimes the data contains clock times hh:mm (e.g., thetime 1:30 PM is recorded as 13:30). These times must beconverted to decimal-valued times (e.g., 13.5). The DataPreprocessor can perform this task when it is processingunformatted data. Within an individual record, the DataPreprocessor replaces the TIME value in the first datarecord with 0, and then replaces subsequent records&rsquo; TIMEvalues with the relative time (i.e., the number of hourselapsed since the first record). (The TIME value is alsoreset to 0 on a reset (EVID=3) or reset-dose (EVID=4)record.) Here is an example of relative time calculation:Contents of original file: Contents of new file:ID TIME ID TIME1 9:15 1 0.001 9:30 1 0.251 10 1 0.751 14:40 1 5.421 32.5 1 23.252 8 2 0.002 8.0 2 0.002 44:50 2 36.832 58 2 50.00The presence of the colon &quot;:&quot; in the TIME data item of atleast one record of the data causes the Data Preprocessor toconvert all the TIME values to elapsed values. Elapsedtimes are also called relativ________ times______ Note that recordeddata (lines 5, 8, and 9 of the original file) spanned morethan one day. The user had to add 24 to the TIME values oneach day subsequent to the first to communicate the correcttimes to the Data Preprocessor.10.1.2. DATE Data ItemHere is another way the above data could have been recorded,using a data item called DATE whose value is 1 for the firstday, 2 for the second day, and so on. This allows TIMEvalues to be recorded more naturally using values in therange 0-24.Contents of original file: Contents of new file:ID DATE TIME ID DATE TIME1 1 9:15 1 1 0.001 1 9:30 1 1 0.251 1 10 1 1 0.751 1 14:40 1 1 5.421 2 8.5 1 2 23.252 1 8 2 1 0.002 1 8.0 2 1 0.002 2 20:50 2 2 36.832 3 10 2 3 50.00The DATE data item is of significance only to the DataPreprocessor; NONMEM-PREDPP will not make use of it. Evenif there are no &quot;:&quot; characters among the TIME values, theexistence of a DATE data item will cause the DataPreprocessor to replace TIME values by relative times.10.1.3. Calendar DatesThe Dat____ dat____ ite____ (DATE) can also be used to recordcalendar dates in month-day-year format. Any alphabeticcharacter (e.g., / or -) can be used to separate thecomponents. Here is a third way the same example could berecorded:Contents of original file: Contents of new file:ID DATE=DROP TIME ID TIME1 10-1-86 9:15 1 0.001 10-1-86 9:30 1 0.251 10-1-86 10 1 0.751 10-1-86 14:40 1 5.421 10-2-86 8.5 1 23.252 10-12 8 2 0.002 10-12 8.0 2 0.002 10-13 20:50 2 36.832 10-14 10 2 50.00This example illustrates two features. First, when calendardates are used, the DATE item should be specified as&quot;DATE=DROP&quot;, so that the data item is omitted from the newdata file (see Section 5.3). Otherwise, the alphabeticcharacters which separate the components will cause readerrors when NONMEM reads the data. Second, the year valueis optional; only month and date were actually needed.(Within a single individual record, however, either alldates should specify a year, or none should.)Data labels DAT1, DAT2, and DAT3 are also recognized by theData Preprocessor and can be used instead of DATE. Thelabel given to the Date data item describes its format:DATE month day yearDAT1 day month yearDAT2 year month dayDAT3 year day monthIf only one of the three components is present, it isassumed to be the day&dagger;.<cite>&dagger; In this case only, the Date data item may be zero ornegative. Day -1 means one day prior to day 0. </cite>If only two components are present, they are assumed to bemonth and day (with DATE and DAT2) or day and month (withDAT1 and DAT3). The year may be omitted or given as 1, 2,3, or 4 digits. &#9474;10.1.4. Converting Hours to Days &#9474;The units of the relative TIME values resulting from the &#9474;Data Preprocessor&rsquo;s day-time translation are hours. If the &#9474;correct units for relative time should be days, then the &#9474;TRANSLATE option of the $DATA record may be used to request &#9474;that hours to be converted to days. For example, &#9474;$DATA filename TRANSLATE(TIME/24) &#9474;or &#9474;$DATA filename TRANSLATE(TIME/24.000) &#9474;With the former, values of TIME have two significant digits, &#9474;e.g., xxxx.xx. With the latter, they have three &#9474;significant digits, e.g., xxxx.xxx. &#9474;10.1.5. The Year 2000 - LAST20 &#9474;The user may supply 4 digit years starting (e.g.) &quot;19&quot; and &#9474;&quot;20&quot;, and such dates are processed correctly. (Three digit &#9474;years &quot;000&quot;-&quot;999&quot; are permitted, but would represent exactly &#9474;those years, and should not normally be used.) If the year &#9474;is omitted, it is assumed to be a non-leap year. A problem &#9474;arises when the year supplied, but has only 1 or 2 digits. &#9474;Such years are assumed by default to be in the 1900&rsquo;s. If &#9474;this is not a correct assumption, two errors may be made by &#9474;the Data Preprocessor when computing relative times. First, &#9474;1900 was not a leap year, but 2000 is a leap year. Hence, &#9474;if consecutive dates in a data file are 02-28-00 and &#9474;03-01-00 (signifying February 28 and March 1, 2000), an &#9474;elapsed time of 24 hours, rather than 48 hours, is computed. &#9474;Second, if consecutive dates have years 99 and 00, the &#9474;computed elapsed time is negative and an error message is &#9474;generated. &#9474;With NONMEM V and later versions there is a constant LAST20. &#9474;The value of LAST20 is a 2 digit number nn that specifies &#9474;the highest 2-digit year that is assumed to be in the 21st. &#9474;century, i.e., to represent 20nn rather than 19nn. For &#9474;example, with LAST20=50, then 1 and 2 digit years are &#9474;interpreted as follows: &#9474;00-50 represents 2000-2050 &#9474;51-99 represents 1951-1999 &#9474;The elapsed time between 02-28-00 and 03-01-00 is calculated &#9474;to be 48 hours, and the elapsed time calculated between the &#9474;years 99 (1999) and 00 (2000) is positive. &#9474;There are two ways that a value for LAST20 can be specified. &#9474;First, when NM-TRAN is installed, a value is given to &#9474;constant LAST20 in TrGlobal.f90 (in the resource directory): &#9474;DATA LAST20 &#9474;The default value of this constant in the distribution &#9474;medium is 50. Please ask your system support department if &#9474;they modified the LAST20 constant when NM-TRAN was &#9474;installed. &#9474;Regardless of what value was assigned to the LAST20 constant &#9474;in TrGlobal.f90, there is an option LAST20 of the $DATA &#9474;record that may be used to specify the value of the constant &#9474;for the current run. For example: &#9474;$DATA filename LAST20=50 &#9474;This insures that all 1 and 2 digit years are interpreted as &#9474;above (2000-2050; 1951-1999). &#9474;10.1.6. Leap Year Warning - LYWARN &#9474;There may be two circumstances such that 1 or 2 digit years &#9474;are recorded as 00, 01, ... (equivalently, 0, 1, ...). &#9474;First, these may represent the years 2000, 2001, etc. Or, &#9474;they may represent years 0, 1, etc., of a study. Suppose &#9474;the latter is the case, and that none of the years of the &#9474;study was a leap year. Then if LAST20 is set to a value &#9474;greater than -1, the year 0 is assumed incorrectly to be the &#9474;leap year 2000, and elapsed times may be computed &#9474;incorrectly. The Data Preprocessor issues a warning message &#9474;under the following circumstances: &#9474;1) The year is recorded as &quot;00&quot; or &quot;0&quot;, &#9474;2) The value of LAST20 is greater than -1 by default (so &#9474;that the year is understood to be 2000), and &#9474;3) The LAST20 option of the $DATA record was not used to &#9474;modify LAST20 for this run. &#9474;The warning message is as follows: &#9474;(DATA WARNING 3) RECORD 3, DATA ITEM 3: 01-01-00 &#9474;THE YEAR IS ASSUMED TO BE 2000 (A LEAP YEAR). IF THIS IS INCORRECT, USE&#9474;$DATA&rsquo;S LAST20 OPTION TO OVERRIDE THE DEFAULT VALUE OF LAST20 IN NMTRAN&rsquo;S&#9474;ABLOCK, OR CHANGE THE DEFAULT: 50 &#9474;Suppose these warning messages are appropriate, that is, &#9474;year &quot;00&quot; (or &quot;0&quot;) should not be a leap year. The LAST20 &#9474;option of the $DATA record may be used to specify that such &#9474;years are in the 1900&rsquo;s for the current data set: &#9474;$DATA filename LAST20=-1 &#9474;A constant LYWARN is defined in NM-TRAN&rsquo;s ABLOCK module. &#9474;The default value of LYWARN is 1 (&quot;data warning message 3 &#9474;enabled&quot;). If the value of LYWARN is set to 0 (&quot;data &#9474;warning message 3 disabled&quot;) and NM-TRAN is recompiled, then &#9474;the warning message is suppressed for all runs.10.2. Interdose Interval (II) ConversionWhen the input data is unformatted and PREDPP is being used,the Interdose Interval (II) data item is checked for valuescontaining a colon (:). Any such value is assumed to signala clock time hh:mm. The minutes portion is converted to adecimal number containing as many decimal places as digitsin the original. E.g., the value &quot;:30&quot; is replaced by&quot;.50&quot;. This conversion is performed whether or not day-timetranslation is also being done.10.3. Data Items Generated by the Data PreprocessorWhen the data is from a single individual, the DataPreprocessor will almost always generate an ID data item&Dagger;.<cite>&Dagger; Section 4.2 of Chapter 12 discusses the L1 data item,which is used to prevent NM-TRAN from generating anIdentification data item for individual data. </cite>It does this whether or not PREDPP is used. This is donebecause, when the data is from a single individual, the IDdata item must take on very special non-constant values forNONMEM. The generated ID data item is given the label&quot;.ID.&quot; (i.e., ID surrounded by dots). If this data item isto be shown in any NONMEM output (e.g., in a table), it mustbe referred to on subsequent NM-TRAN records by this label.When PREDPP is used, the Data Preprocessor will alwaysgenerate the required EVID data item if it is not alreadylisted on the $INPUT record. (This was discussed in Section7.3 above.)When PREDPP is used, the Data Preprocessor will alwaysgenerate the MDV (Missing Dependent Variable) data item ifit is not already listed on the $INPUT record.These data items are generated by the Data Preprocessorwhether or not a format specification was coded on the$INPUT record. They are appended to the end of each datarecord.10.4. When Must a Format Specification be Included orOmitted?When coding the $DATA record, you will need to decidewhether to include a FORTRAN format specification describingthe data file or to omit it and let the Data Preprocessorconstruct it. Here are some guidelines in making thisdecision.A format specification is required when:Some data values are left blank on some data records,without having the value 0 or . (or a pair of commas)to hold the place of the missing value.Some data values are adjacent on some data records;they are not separated by a space or a comma.The data records span multiple physical records; thatis, the character / is needed in the formatspecification. (The Data Preprocessor may generatesuch a format specification for the NONMEM data set; weare speaking here of the NM-TRAN data set.)A format specification should not be present when:The $INPUT record includes DROP as a data item label orsynonym.Day-time translation is desired.II conversion is desired.Commas are used to separate the data items.The data values are not lined up into columns withuniform width, so that no format specification can bewritten to describe the file.Many data files do not fall in either category. A formatspecification is optional for such files.10.5. Skipping Data ItemsIt is always possible to omit (skip) data items that are notof interest for a given NONMEM run. When a formatspecification is coded, two things must be done: first,replace the data item&rsquo;s specification by an &quot;X&quot;specification (e.g., replace F8.0 by 8X) and second, deletethe data item&rsquo;s label from the $INPUT record. When noformat specification is coded, all that need be done is toreplace the data item&rsquo;s label in the $INPUT record by DROP(or include DROP as a synonym).</a><br>
<a href="#1. What This Chapter is AboutThis chapter tells how to write a $SUBROUTINE record and howto write a simple $PK record for both individual andpopulation data. This chapter is meant to be read inparallel with Chapters 3 and 4.2. The $SUBROUTINE RecordThe $SUBROUTINE record describes which pharmacokinetic modelis to be used. Recall that NONMEM calls a subroutine namedPRED to compute the predicted value. The user must chooseto use his own PRED subroutine or to use the PREDPP package.In this text it is assumed that the PREDPP package ischosen.2.1. Choosing an ADVAN Subroutine: Standard PharmacokineticModelsThe PREDPP Library includes subroutines which are &#9474;pre-preprogrammed, each for a specific pharmacokineticmodel. They are:ADVAN1 (One Compartment Linear Model)ADVAN2 (One Compartment Linear Model with First OrderAbsorption)ADVAN3 (Two Compartment Linear Model)ADVAN4 (Two Compartment Linear Model with First OrderAbsorption)ADVAN10 (One Compartment Model with Michaelis-MentenElimination) &#9474;ADVAN11 (Three Compartment Linear Model) &#9474;ADVAN12 (Three Compartment Linear Model with First Order &#9474;Absorption)PREDPP calls only one subroutine, ADVAN; the different namesabove are external names distinguishing different instancesof the ADVAN routine in the PREDPP Library. The name&rsquo;ADVAN&rsquo; is used because the routine advances (i.e. updatesthe state of) the kinetic system from one point in time tothe next. There are additional ADVAN routines in theLibrary which implement more general types ofpharmacokinetic models; see Chapter 12, Section 2.2. Eachof the ADVAN&rsquo;s can be used for either individual orpopulation data. The (external) name of the ADVAN to beused is coded on the $SUBROUTINE record; this also impliesthat PREDPP is to be used. As an example, the followingrecord specifies the One Compartment Linear Model:$SUBROUTINE ADVAN1The ADVAN&rsquo;s are described in Appendix 1. They share certainfeatures.1. The compartments are numbered. These numbers are usedin two places. First, they are used in the CMT andPCMT data items to describe specific compartments.Second, the compartment number n is part of the name ofPK parameters such as compartment scale (Sn), asdiscussed below.2. Each model has a defaul_______ observatio___________ compartment____________ whichfor each of the above ADVAN&rsquo;s happens to be the centralcompartment. If an event record contains anobservation (i.e. is an observation event record), theprediction associated with that record will be thescaled drug amount in this compartment, unless the CMTdata item on the record specifies differently. Theprediction associated with a non-observational eventrecord will again be the scaled drug amount in thiscompartment, unless the PCMT data item on the recordspecifies differently.3. Each model has a defaul_______ dos____ compartment____________ Unlessspecified differently by the CMT data item, it isunderstood that a dose is input into this compartment.With ADVAN1, ADVAN3, and ADVAN10, this is the centralcompartment. With ADVAN2 and ADVAN4, a drug depotcompartment is part of the model and is the defaultdose compartment. In these cases, if a dose is to godirectly into the central compartment, its compartmentnumber (2) must be present in the CMT data item of thedose record. Note that it is never required that therebe doses into the depot compartment. In a studyinvolving mixed oral and IV doses, for example, somepatients may receive only IV doses. All dose eventrecords for such patients will have the value 2 in theCMT data item.4. Each model has an output compartment. The amount ofdrug in this compartment is the accumulated amount ofdrug eliminated from the system and typicallyrepresents the amount of drug which accumulates in theurine. This compartment is special. It may notreceive a dose. It is initially off, and it remainsoff (so that the amount therein remains zero) until itis explicitly turned on by an other type event recordwhich has the output compartment&rsquo;s number in the CMTdata item. It is computed by &quot;mass balance&quot;, asfollows. Between any two points in time, it increasesby an amount equal to the amount of drug in the othercompartments at the first point in time, plus theamount added via doses between the two time points,less the amount remaining in the other compartments atthe second point in time. (This difference ismultiplied by an output fraction (F0) parameter, if F0is computed by the PK routine.) The output compartmentcan be turned off (i.e. its amount reset to zero). Ifthe compartment is interpreted as a urine compartment,this is equivalent to &quot;emptying&quot; the compartment. Thisis done by putting the negative of its number in theCMT data item of an other type or observation eventrecord.On event records, the output compartment is referred toby the compartment number given in Appendix 1. A PKparameter which refers to the output compartment mayuse either this number or 0 (zero). Thus, F0 and F2both denote the output fraction for ADVAN1; similarly,S0 and S4 both denote the scale for ADVAN4&rsquo;s outputcompartment. SC denotes the scale for any ADVAN&rsquo;s &#9474;central compartment.5. Each model has a set of basic (required)pharmacokinetic (PK) parameters, which are themicroconstants used to compute the amounts of drug viathe kinetic equations for the model. Each one also hasa set of additional (optional) PK parameters, includingcompartment scales (Sn), bioavailability fractions(Fn), and output fraction (F0). Compartment scales aretypically used to convert amounts to concentrations,but they also can be used for other purposes.Bioavailability fractions multiply dose amounts. Theoutput fraction is described above.6. Each model&rsquo;s basic and additional pharmacokineticparameters must be computed for it by a subroutinenamed PK. The error model must be described by asubroutine named ERROR. $PK and $ERROR abbreviatedcode provide an easy way to specify the essentialcomputations that must occur in these subroutines.2.2. Choosing a TRANS Subroutine: AlternativeParameterizationsAs discussed in Chapter 3, we may prefer to usepharmacokinetic parameters in our PK routine other than themicroconstants used by PREDPP. Appendix 2 shows severalcommonly-used parameterizations. The PREDPP packageincludes a family of subroutines called TRANS routines whichare pre-programmed to translate (reparameterize) from thesecommonly used parameterizations to the ones expected byPREDPP. Appendix 2 also gives the TRANS routine for eachalternative parameterization. As with ADVAN, TRANS is thename of the routine. The names given in Appendix 2 areinstances of external subroutine names used in the PREDPPLibrary. The first member of the family, TRANS1, simplytranslates a set of microconstants into these samemicroconstants and must be included in the NONMEM loadmodule in lieu of the others when the $PK abbreviated codecomputes the microconstants.The user must describe on the $SUBROUTINE record which TRANSroutine is to be used. For example, the following recordrequests the One Compartment Linear Model parameterized (inthe PK routine) in terms of clearance and volume.$SUBROUTINE ADVAN1,TRANS2When a TRANS other than TRANS1 is used, only the alternativeparameters listed in column 1 need be assigned values in the$PK abbreviated code. In this example, these are CL, V, andKA.Note that TRANS1 is the default. That is, if no TRANSroutine is listed on the $SUBROUTINE record, it is assumedthat TRANS1 is intended. This is the case in the examplesof Chapter 2. Alternative parameterizations using TRANS1are discussed later in this chapter in Section 4.2.3. $PK Abbreviated Code &#9474;$PK abbreviated code consists of a block of $P___ statements___________one per line, which look much like FORTRAN statements. Infact, they are a subset of FORTRAN: simple assignment &#9474;statements, certain kinds of conditional (IF) statements, &#9474;and certain kinds of CALL, WRITE, PRINT, RETURN, OPEN, &#9474;CLOSE, REWIND statements. The $PK abbreviated code must bepreceded by a record containing the characters &quot;$PK&quot;. Thisrecord and the abbreviated code constitute the $P___ record_______$PK statements must include assignment statements giving avalue to every basic PK parameter for the given ADVAN andTRANS combination, as listed in Appendix 1 (when TRANS1 isused) or column 1 of Appendix 2 (when a different TRANS isused). They may also include assignment statements givingvalues to one or more of the additional PK parameters.3.1. SyntaxWe assume the readers of this document are familiar withwriting FORTRAN assignment and conditional statements. Ifnot, the examples in this and the following chapter shouldgive adequate guidance. FORTRAN statement numbers are notused, and the statements may start in any column. As withall NM-TRAN records, blank lines are permitted, and all textfollowing a semi-colon (;) is ignored and may be used forcomments. FORTRAN continuation lines are not permitted.The statements are built using the following: elements ofthe THETA array (e.g., THETA(1)); constants; names of inputdata items appearing on the $INPUT record; names ofpreviously-assigned variables; FORTRAN library functionsSQRT, LOG, LOG10, EXP, SIN, COS, ABS, TAN, ASIN, ACOS, ATAN &#9474;and INT. arithmetic operators +, -, *, /, **; andarithmetical and logical expressions using all of the above.In addition, statements may include representations forrandom variables such as ETA(1) and EPS(3). Input dataitems have the values appearing on the current event record,and thus these values may change from one event record tothe next. A user-defined variable name follows the usualFORTRAN rules (1-6 letters and digits, starting with aletter) and may not be subscripted. It is defined(&quot;declared&quot;) by being assigned a value (i.e., by appearingto the left of = in an assignment statement).Nested parentheses and nested IF statements are allowed. A &#9474;pair of parentheses enclosing a subscript may be nestedwithin another pair of parentheses. All subscripts must beconstants (e.g. THETA(1)). The statements are evaluatedsequentially, in the order in which they appear.All variables, constants, and expressions are evaluatedusing floating-point (not integer) arithmetic. Single ordouble precision function names and constants may be usedinterchangeably.3.2. When are $PK Statements Evaluated?$PK statements are normally evaluated with every eventrecord for both population and individual data. Thisenables the amounts in the compartments to be updated fromevent time to event time using current values of the dataitems. This may be more frequent than is necessary. In thetheophylline example of Chapter 2, no data item is used inthe $PK statements. In the phenobarbital example, the dataitem used, WT, is constant within any individual&rsquo;s data. Inthese cases, it is sufficient, and it can save noticeableamounts of run time, to evaluate the $PK statements once perindividual record. PREDPP can be instructed that the set ofevent records with which the $PK statements are evaluatedare to be limited in some way (see Chapter 12, Section 2.7).The CALL data item can be used to force the statements to beevaluated with any event records.Certain advanced forms of dosing (additional and laggeddoses; see Chapter 12, Sections 2.4 and 2.5) introduce dosesat times which do not necessarily coincide with any eventrecord. PREDPP does not normally evaluate the $PKstatements at such times, but can be instructed to do so(Chapter 12, Section 2.7). Model event time parameters can &#9474;be used to instruct PREDPP to evaluate the $PK statements at &#9474;specified times (Chapter 12, Section Section 2.7)3.3. Time Varying PK parametersThe state of the kinetic system at a given event time isobtained using PK parameter values computed with the dataitems on the event record. Using these parameter values thesystem is advanced to the event time from the last eventtime. Population models sometimes use data items whichchange value within individual records and thus give rise toPK parameters whose values change within individual records.In Chapter 4, Section 3.1.6, it is pointed out that it isdesirable for the value of such a data item on the eventrecord to be that value holding at the midpoint of theinterval between the current event time and the lastprevious event time, since the system is advanced over thisinterval using the PK parameters determined with this value.If the data item changes too rapidly for this value tofairly represent the data item over the entire time period,it is possible to subdivide the interval into smallerintervals. Event records with EVID=2 (other type eventrecords) can be introduced for this purpose. For example,between two consecutive event records rj and rj+1, withevent times tj and tj+1, one might introduce two new othertype event records R1 and R2, with event times T1 and T2,into the data set. The value of the data item in R1 will beused to compute the PK parameters used to advance the systemover the interval tj to T1 and should be the value of thedata item holding at the midpoint of this interval.Similarly, the value of the data item in R2 will be used tocompute the PK parameters used to advance the system overthe interval T1 to T2 and should be the value of the dataitem holding at the midpoint of this interval, and so on.4. $PK Statements for Individual Data4.1. Basic and Additional ParametersWith individual data, the parameters to be estimated are(usually) the individual&rsquo;s PK parameters, and therefore,elements of &theta; should be associated with these PK parameters.(NONMEM estimates the elements of the &theta; vector.) By anindividual&rsquo;s PK parameters, we mean here the basic PKparameters and, possibly, some additional PK parameters(e.g. a bioavailability fraction, or volume of distributionwhen the latter is not a basic PK parameter). Toillustrate, in the theophylline example of Chapter 1 thereoccur these $PK statements$PKKA=THETA(1)K=THETA(2)The parameters KA and K are the basic PK parameters forADVAN2 and TRANS1 (the default TRANS routine). They areused to compute the amounts in the compartments. Typically,however, the observations are concentrations. A scaleparameter is used to convert the amount into aconcentration. Thus, in the theophylline example we see twoadditional $PK statements:V=THETA(3)S2=VHere, V is a user-defined variable standing for the volumeof distribution of the central compartment. It is neither abasic nor additional parameter. The parameter S2 is thescale parameter for the central compartment; upon dividingthe amount in that compartment by S2, the concentrationresults. (An observation is usually predicted by an amountfor a compartment divided by that compartment&rsquo;s scaleparameter). In fact, these two statements could be replacedby the single statementS2=THETA(3)However, it may be helpful to the user to distinguish in hiscode between the calculation of the central volume itselfand the calculation of the scale parameter.There is no particular need for certain elements of &theta; to beassociated with certain PK parameters. In the aboveexample, the roles of &theta;1 and &theta;2 could have been reversed.NONMEM&rsquo;s &theta; vector may contain more or fewer elements thanthere are PK parameters, depending on how these parametersare modeled.PK parameters must be explicitly modeled, usually in termsof parameters to be estimated and user-defined data items;the user communicates this model with the $PK statements.If a certain parameter&rsquo;s value is known _ prior______ (say, S2has the known value 500), there are several ways the valuecan be incorporated into the $PK statements. The followingexamples show how it can be done via a constant, via a fixedelement of &theta;, and via a (differently-named) data item:1. S2=5002. $THETA .6 9. (500 FIXED)$PKS2=THETA(3)Here, rather than be estimated, &theta;3 is constrained tothe value 500. This is discussed in Chapter 9.3. $INPUT ... VOL ..$PKS2=VOLHere, VOL is assumed to have the value 500 on the datarecords. When the data is from a population, thisthird technique allows a unique value of VOL to besupplied for each individual.4.2. Alternative Parameterizations using $PK StatementsIt is possible to use an alternative parameterization whilestill using TRANS1. The reparameterization is performedwithin the $PK statements by explicitly computing themicroconstants from the alternative parameters. Such&quot;reparameterization&quot; statements are given in column 2 ofAppendix 2. They must follow the assignment statements thatgive the alternative parameters their values, as in thephenobarbital example of Chapter 2.The advantage of using $PK statements to reparameterize,rather than using a TRANS subroutine, is that theNONMEM-PREDPP load module will then always consist of thesame set of subroutines for a given choice of ADVAN, whichsimplifies the job of creating and running it. It will alsorun slightly faster. We assume in this document that thisapproach is taken.Other parameterizations are possible besides the ones inAppendix 2. For example, with ADVAN1 and TRANS1, one mightcode:CL=THETA(1)K=THETA(2)V=CL/KS1=VThe ability to express a large variety of modelingpossibilities with NONMEM-PREDPP provides great freedom andflexibility, but as always with flexible modelingcapability, certain pitfalls arise. Suppose, for example,that with a one compartment system the compartment amount,rather than the concentration is observed. With ADVAN1 andTRANS1 the statementsCL=THETA(1)V=THETA(2)K=CL/Vwill lead to difficulty because only the ratio of &theta;1 to &theta;2affects the amount in the compartment, and therefore, thedata do not allow &theta;1 and &theta;2 to be separately estimated. Thestatements should read:K=THETA(1)It is important to remember that only those elements of &theta;which affect the predictions of observations will beestimated by NONMEM. Here is some problematic code usingADVAN1 with TRANS1:K=THETA(1)V=THETA(2)CL=THETA(3)S1=VOnce again, NONMEM will be unable to produce separateestimates of all elements of &theta;. The kinetics of a simpleone compartment system cannot be determined by threeindependent parameters. With TRANS1, PREDPP itself does not&quot;know&quot; about the relationship K=CL/V which defines adependency among the parameters. Indeed, the parameters CLand V are both regarded as user-defined variables. Thevalue of &theta;3 has no effect on the prediction. Were it notfor the fact that S1 is set equal to V, the value of &theta;2would have no effect on the prediction either. With TRANS2this code is also incorrect for essentially the same reason.Here, K is regarded as a user-defined variable, and therelationship CL=K*V is not &quot;known&quot; to PREDPP. (PREDPP doesknow that CL/V is the rate constant of elimination, but itdoes not recognize the variable K as denoting this rateconstant, and &theta;1 has no effect on the prediction.)4.3. Scale ParametersScale parameters are mentioned in Section 2.1. Predictedcompartment amounts are divided by them and are thusconverted to predicted concentrations. They are only neededfor those compartments whose concentrations are directlyobserved. With ADVAN3, for example, the peripheralcompartment&rsquo;s scale S2 does need to be computed explicitlyif there are no observation events giving measured values ofconcentrations in the peripheral compartment. Predictedvalues for this compartment may still be plotted againsttime, for example, but these values need not be scaled drugamounts; the (unscaled) amount alone is sufficient to showthe shape of the curve. (The various volume parametersshown in Appendix 2 must be modeled when they are used asbasic parameters, but they need not be assigned as values tocompartment scale parameters.) Any scale parameter which isnot modeled by $PK statements is assumed to be 1 (i.e.,predicted values are always amounts).4.3.1. Scaling by a Known ConstantIn Chapter 3, Section 2.2.1, the units of V were changedfrom kiloliters to liters using the model:S=V/1000This can be coded in a $PK statementsimilar to the way it appears here,except that the compartment number mustbe specified:S1=V/1000Basic PK parameters may also be rescaled in thismanner.4.3.2. Scaling by a Parameter: Conditional Statements andIndicator VariablesIn Chapter 3, Section 2.2.2, the following model appeared:V, ifassayis1S=&#9129;hV,ifassayis2There are two ways this can be coded in $PK statements.The assay data item can be tested directly,or anindicator variablecan be used.Anindicator variableis a variable whose value is 0 or 1.It may be identified with an input data item, or it may be a user-definedvariable in the $PK statements.For example, suppose variable ASY is to beused as an indicator variable.If some input data item isgiven value 1 when assay 1 was used and value 0 when assay2 was used, then this data item could simply be named ASY on the$INPUT record.Suppose, however, that the assay number itself (1 or 2)was recorded in the dataand that we have named the data itemANUM on the $INPUT record.We must compute the user-defined variable ASY for use asan indicator variable.There are two ways this can be done: using a logical IFand using a block IF.1. ASY=1IF (ANUM.EQ.2) ASY=0Here, ASY is &quot;provisionally&quot; given the value 1. Thevalue is changed to 0 if the data indicates assay 2.2. IF (ANUM.EQ.1) THENASY=1ELSEASY=0ENDIFThe choice between these forms of IF is purely a matter ofstyle. Now let us assume that the compartment to be scaledis compartment 2, and that h is to be identified with &theta;5.The parameter S2 can now be coded unconditionally:S2=ASY*V+(1-ASY)*THETA(5)*VAlternatively, ANUM can be tested and ASY avoidedaltogether:1. S2=VIF (ANUM.EQ.2) S2=THETA(5)*V2. IF (ANUM.EQ.1) THENS2=VELSES2=THETA(5)*VENDIF4.3.3. Scaling by a Data ItemIf observations of urine concentration Cu are included inthe data (see e.g. Chapter 6, Section 9), it is necessary toprovide urine volume as a scale for the output compartment.Presumably, this volume varies between urine observationsand is recorded in the data records. Suppose this data itemis called UVOL in the $INPUT record. (The name given to thedata item has no special significance; any name could bechosen.) An additional $PK statement is necessary:S0=UVOLUVOL need be recorded on only those observation events towhich it applies, although it does no harm to record it onother event records. For example, it may well happen thatboth plasma and urine responses are measured at the sametime, so that there are two observation event records withthe same value of TIME, one for each compartment observed atthat time. As described in Section 3.2 above, $PKstatements are normally evaluated with every event record.Consider, for example, the sample data below. Assume thatthe Central compartment is compartment 2 and the outputcompartment is compartment 3. (Note the use of -3 tosignify that compartment 3 is to be turned off after theobservation time. The compartment will remain off until thetime another urine collection begins, as indicated with another type record; see Chapter 6, Section 7.4). Either 1.or 2. will produce the correct value of S0:1. Record UVOL on the event record to which it applies.The order of the records does not matter.TIME UVOL DV CMT10. 0 5.80 210. 100 .067 -32. Record UVOL on all event records having the same valueof TIME. The order of the records does not matter.TIME UVOL DV CMT10. 100 5.80 210. 100 .067 -3The following will not produce the correct value of S0unless PREDPP is instructed to evaluate the $PK statementsonly once for each distinct value of TIME:TIME UVOL DV CMT10. 100 5.80 210. 0 .067 -34.4. Bioavailability Fraction ParametersPK parameters of the form Fn, where n is the number of acompartment into which a dose may be introduced, arebioavailability fractions. If a dose record specifies adose for compartment n, the dose amount given on the eventrecord is multiplied by the value of Fn computed from the$PK statements evaluated with this record, and this productis the dose amount introduced into the system. For example,F1 multiplies the amount of dose which is to be added tocompartment 1. Any Fn which is not computed by $PKstatements is assumed to be 1 (i.e., the dose is 100%available).As an example, suppose two different preparations of thesame drug are administered, and it is assumed that theydiffer only in their bioavailability. The indicatorvariable (or data item) PREP has value 1 for the firstpreparation and 0 for the second. The ratio of thebioavailability of the second preparation to that of thefirst preparation is identified with &theta;6. Usually, themethod of drug administration permits this ratio to beestimated, but not the separate bioavailabilities. Withoutloss of generality, the bioavailability of the firstpreparation can be taken to be 1. Assuming the drug enterscompartment 1 of the model, there are three ways this can becoded:1. F1=PREP+(1-PREP)*THETA(6)2. F1=1IF (PREP.EQ.0) F1=THETA(6)3. IF (PREP.EQ.0) THENF1=THETA(6)ELSEF1=1ENDIFAgain, the choice is a matter of style.Once a dose is introduced into the dose compartment, itbegins to distribute into the other compartments. Whetheror not the original dose was 100% available, it is assumedthat none of the dose appearing in the dose compartment, andin other compartments after the dose is introduced, isfurther reduced due to bioavailability effects. PREDPPcannot model &quot;bioavailability effects&quot; between compartments.4.5. Output FractionThe Output Fraction parameter, F0, is an optional additionalPK parameter of every model. As discussed in Section 2above, every model contains an output compartment. If thiscompartment has been turned on prior to the advance fromtime tj&minus;1 to time tj, then the amount of drug lost from thesystem during this interval via elimination is multiplied byF0 and added to the prior contents of the outputcompartment. If the $PK statements do not include anassignment statement giving a value to F0, it is taken to be1 (i.e., 100% of the drug excreted goes to the outputcompartment). In model (4.7), an example of the use of F0is given. Assuming that the variables CLREN (renalclearance) and CL (total clearance) have been calculatedwith earlier $PK statements, the statementF0=CLREN/CLcan be used to compute F0.5. $PK Statements for Population DataWith population data, the structural models for the PKparameters tend to be more complicated than with individualdata. In addition, the influence of interindividual randomeffects needs to be described. These will involvedifferences in the $PK statements, but the same $SUBROUTINErecord and the same ADVAN and TRANS subroutines are used,and the same general requirements and examples of theearlier sections of this chapter still mostly apply. Inthis section, the models of Chapter 4 are implemented via$PK statements. Many of these models could be implementedin a variety of ways; an experienced programmer may preferto code them differently.With population data, we must distinguish between thetypical value of a PK parameter in the population and thevalue of that parameter for a given individual, theindividual&rsquo;s value. The typical value is computed by astructural model involving only fixed effects. We havechosen to denote it with the use of a tilde: e.g. Cl. Theindividual&rsquo;s value is computed by a model including randominterindividual effects (represented by random variables)and is denoted without a tilde: e.g., Cl. There is no tildecharacter in the FORTRAN character set, and with NM-TRAN wedo not need to distinguish typical and individual values.However, for purposes of clarity, in all the examples whichfollow we will include the letters TV (Typical Value) at thestart of those variable names which we think of as having atilde (e.g., TVCL). This is a matter of style.5.1. Structural Part of Parameter ModelsIn models such as (4.3), the subscript i indicates that themodel applies to the ith individual. As noted in Chapter 4,the subscript is not needed and, indeed, is not used in $PKstatements.5.1.1. Linear ModelsModels (4.4), (4.5a), (4.5b) and (4.6) can be coded as theyappear. Assuming that WT, AGE, and SECR are input dataitems or have been calculated with earlier $PK statements,the code is:TVCLM=THETA(1)*WTRF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFTVCL=TVCLM+TVCLR5.1.2. Multiplicative ModelsModel (4.4.1) can be coded as follows:TVLCLM=THETA(1)+THETA(2)*LOG(WT)TVCLM=EXP(TVLCLM)Model (4.4.2) can also be coded as it appears:TVCLM=THETA(1)*WT**THETA(2)5.1.3. Saturation ModelsModel (4.4.3) presents a problem. Subscripted variablesthat can appear in $PK statements are few; naturally, theyinclude THETA and (as seen below) ETA. The variable CPSScannot be subscripted, and a variable name such as CPSS2(rather than CPSS(2)) must be used for Cpss2. The model can &#9474;be coded exactly as it appears:TVCLM=WT*(THETA(1)-THETA(2)*CPSS2/(THETA(3)+CPSS2))5.1.4. Models with Indicator VariablesWhen dealing with typical values, indicator variables (0/1variables) can be used interchangeably with conditional (IF)statements, as we have already seen. Model (4.4.4) can becoded in a variety of ways, two of which are:1. TVCLM=(THETA(1)-THETA(2)*HF)*WT2. IF (HF.EQ.0) THENTVCLM=THETA(1)*WTELSETVCLM=(THETA(1)-THETA(2))*WTENDIF5.2. Population Random Effect ModelsRandom variables &eta; are used in the models forinterindividual errors. (With population models, randomvariables &epsilon; are used in the models for intraindividualerrors; see Chapter 4, Section 2.) In $PK statements theyare denoted by ETA(1), ETA(2), etc. Even if there is onlyonce such variable it must still be subscripted. It is thepresence of one or more such variables that indicates toNM-TRAN that the data is from a population. Just as thereis no particular need for certain &theta; elements to beidentified with certain PK parameters, there is noparticular need for certain &theta; elements to be associated withcertain &eta; variables, and any association need not beone-to-one. The following models are both valid:1. CL=THETA(1)+ETA(1)V=THETA(2)+ETA(2)2. CL=THETA(1)+ETA(2)V=THETA(2)+ETA(1)However, it will be easier to keep things straight if thefirst model is used.Here are three different ways of coding a model for anindividual&rsquo;s value of clearance:1. TVCL=THETA(1)CL=TVCL+ETA(1)2. CL=THETA(1)CL=CL+ETA(1)3. CL=THETA(1)+ETA(1)We prefer the first way because it clearly distinguishes themodel for the typical value from the model for theindividual&rsquo;s value. With any of the three ways for codingthe model the typical value of the parameter can be computedas follows: The &eta; variables are set to 0, and the parameteris computed. Any variable whose value depends on &eta;variables is called a rando______ variable_________Random variables are called true-value variables in the &#9474;first edition of this guide. This is because, in principle, &#9474;a random variable can assume an individual&rsquo;s true value &#9474;under the model. Such a variable is in contrast to a &#9474;variable which assumes only a typical value for the &#9474;population.An individual&rsquo;s true value is never actually known, althoughan estimate of it can be obtained. See Chapter 12, Sections4.11-4.13.5.3. Models for Interindividual ErrorsHere we show how to express the most commonly used modelsfor interindividual errors with $PK statements. Inaddition, all the error models described in Chapter 8 mayalso be used in $PK statements.5.3.1. Additive/Multiplicative ModelsThis is the error model of (4.9):K=TVK+ETA(1)This is the error model of (4.10):K=TVK*(1+ETA(1))This model can also be coded as:K=TVK+TVK*ETA(1)Here, the variable TVK has been &quot;multiplied through&quot;. Thechoice is a matter of style.5.3.2. Other ModelsThe model (4.11) may be coded as written.CLM=TVCLM+(1-ICU)*ETA(1)+ICU*ETA(2)It may also be coded with an IF statement. &#9474;IF (ICU.EQ.0) THENCLM=TVCLM+ETA(1)ELSECLM=TVCLM+ETA(2)ENDIFThe choice is a matter of style.Note that, under the parameterizations given in Appendices 1and 2, CLM is neither a basic nor an additional PKparameter, yet its model involves an &eta; variable. This islegitimate: any variable can be defined in terms of an &eta;variable. However, just as with &theta;&rsquo;s, the values assigned tothe &eta; variables must somehow affect the predictions ofobservations. Otherwise, the variance of some &eta; variablecannot be estimated, and consequently, none of the variancesof these variables can be estimated. Presumably, within the$PK statements, CLM is used to compute CL, and (eitherwithin the $PK statements or within the TRANS routine) CL isused to compute K.5.4. Restrictions on Random Variables &#9474;This section discusses the use of random variables in somedepth and may be skipped by the casual reader. The remarkshere apply to all random variables: both the ETA variablesof this chapter and the ERR/EPS variables of Chapter 8.In general, ETA variables can be used like any othervariables.Any variable whose value is affected by an ETA variable is arandom variable, whether the ETA variable occurs explicitlyin the defining expression for the random variable orwhether another random variable occurs in this expression.For example, consider the following:TVCLM=THETA(2)*WTCLM=TVCLM+ETA(2)RF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFCLR=TVCLR+ETA(1)CL=CLM+CLRCL is a random variable, because it is computed from randomvariables. It depends on both &eta;1 and &eta;2.Random variables may be changed and may be assigned &#9474;conditionally, subject to the following restrictions. &#9474;A random variable may not appear anywhere within a &#9474;nested if structure. &#9474;A random variable defined in the $PK block may not be &#9474;redefined in the $ERROR block.As an example of the first restriction, suppose in the model(4.11) it is also believed that, for ICU patients, ageaffects CLM. The following code expresses the model, but isnot permitted:IF (ICU.EQ.1) THENIF (AGE.GE.50) THENTVCLM=THETA(1)ELSETVCLM=THETA(2)ENDIFCLM=TVCLM+ETA(1)ELSETVCLM=THETA(3)CLM=TVCLM+ETA(2)ENDIFAn alternate code follows, in which the calculation of TVCLM(which involves a nested IF) precedes the calculation of CLM(which does not require a nested IF). This code ispermitted.IF (ICU.EQ.1) THENIF (AGE.GT.50) THENTVCL=THETA(1)ELSETVCL=THETA(2)ENDIFELSETVCL=THETA(3)ENDIFIF (ICU.EQ.1) THENCL=TVCL+ETA(1)ELSECL=TVCL+ETA(2)ENDIFIndentations are used in the above code for clarity, buthave no affect on NM-TRAN&rsquo;s processing of the abbreviatedcode.">1. What This Chapter is AboutThis chapter tells how to write a $SUBROUTINE record and howto write a simple $PK record for both individual andpopulation data. This chapter is meant to be read inparallel with Chapters 3 and 4.2. The $SUBROUTINE RecordThe $SUBROUTINE record describes which pharmacokinetic modelis to be used. Recall that NONMEM calls a subroutine namedPRED to compute the predicted value. The user must chooseto use his own PRED subroutine or to use the PREDPP package.In this text it is assumed that the PREDPP package ischosen.2.1. Choosing an ADVAN Subroutine: Standard PharmacokineticModelsThe PREDPP Library includes subroutines which are &#9474;pre-preprogrammed, each for a specific pharmacokineticmodel. They are:ADVAN1 (One Compartment Linear Model)ADVAN2 (One Compartment Linear Model with First OrderAbsorption)ADVAN3 (Two Compartment Linear Model)ADVAN4 (Two Compartment Linear Model with First OrderAbsorption)ADVAN10 (One Compartment Model with Michaelis-MentenElimination) &#9474;ADVAN11 (Three Compartment Linear Model) &#9474;ADVAN12 (Three Compartment Linear Model with First Order &#9474;Absorption)PREDPP calls only one subroutine, ADVAN; the different namesabove are external names distinguishing different instancesof the ADVAN routine in the PREDPP Library. The name&rsquo;ADVAN&rsquo; is used because the routine advances (i.e. updatesthe state of) the kinetic system from one point in time tothe next. There are additional ADVAN routines in theLibrary which implement more general types ofpharmacokinetic models; see Chapter 12, Section 2.2. Eachof the ADVAN&rsquo;s can be used for either individual orpopulation data. The (external) name of the ADVAN to beused is coded on the $SUBROUTINE record; this also impliesthat PREDPP is to be used. As an example, the followingrecord specifies the One Compartment Linear Model:$SUBROUTINE ADVAN1The ADVAN&rsquo;s are described in Appendix 1. They share certainfeatures.1. The compartments are numbered. These numbers are usedin two places. First, they are used in the CMT andPCMT data items to describe specific compartments.Second, the compartment number n is part of the name ofPK parameters such as compartment scale (Sn), asdiscussed below.2. Each model has a defaul_______ observatio___________ compartment____________ whichfor each of the above ADVAN&rsquo;s happens to be the centralcompartment. If an event record contains anobservation (i.e. is an observation event record), theprediction associated with that record will be thescaled drug amount in this compartment, unless the CMTdata item on the record specifies differently. Theprediction associated with a non-observational eventrecord will again be the scaled drug amount in thiscompartment, unless the PCMT data item on the recordspecifies differently.3. Each model has a defaul_______ dos____ compartment____________ Unlessspecified differently by the CMT data item, it isunderstood that a dose is input into this compartment.With ADVAN1, ADVAN3, and ADVAN10, this is the centralcompartment. With ADVAN2 and ADVAN4, a drug depotcompartment is part of the model and is the defaultdose compartment. In these cases, if a dose is to godirectly into the central compartment, its compartmentnumber (2) must be present in the CMT data item of thedose record. Note that it is never required that therebe doses into the depot compartment. In a studyinvolving mixed oral and IV doses, for example, somepatients may receive only IV doses. All dose eventrecords for such patients will have the value 2 in theCMT data item.4. Each model has an output compartment. The amount ofdrug in this compartment is the accumulated amount ofdrug eliminated from the system and typicallyrepresents the amount of drug which accumulates in theurine. This compartment is special. It may notreceive a dose. It is initially off, and it remainsoff (so that the amount therein remains zero) until itis explicitly turned on by an other type event recordwhich has the output compartment&rsquo;s number in the CMTdata item. It is computed by &quot;mass balance&quot;, asfollows. Between any two points in time, it increasesby an amount equal to the amount of drug in the othercompartments at the first point in time, plus theamount added via doses between the two time points,less the amount remaining in the other compartments atthe second point in time. (This difference ismultiplied by an output fraction (F0) parameter, if F0is computed by the PK routine.) The output compartmentcan be turned off (i.e. its amount reset to zero). Ifthe compartment is interpreted as a urine compartment,this is equivalent to &quot;emptying&quot; the compartment. Thisis done by putting the negative of its number in theCMT data item of an other type or observation eventrecord.On event records, the output compartment is referred toby the compartment number given in Appendix 1. A PKparameter which refers to the output compartment mayuse either this number or 0 (zero). Thus, F0 and F2both denote the output fraction for ADVAN1; similarly,S0 and S4 both denote the scale for ADVAN4&rsquo;s outputcompartment. SC denotes the scale for any ADVAN&rsquo;s &#9474;central compartment.5. Each model has a set of basic (required)pharmacokinetic (PK) parameters, which are themicroconstants used to compute the amounts of drug viathe kinetic equations for the model. Each one also hasa set of additional (optional) PK parameters, includingcompartment scales (Sn), bioavailability fractions(Fn), and output fraction (F0). Compartment scales aretypically used to convert amounts to concentrations,but they also can be used for other purposes.Bioavailability fractions multiply dose amounts. Theoutput fraction is described above.6. Each model&rsquo;s basic and additional pharmacokineticparameters must be computed for it by a subroutinenamed PK. The error model must be described by asubroutine named ERROR. $PK and $ERROR abbreviatedcode provide an easy way to specify the essentialcomputations that must occur in these subroutines.2.2. Choosing a TRANS Subroutine: AlternativeParameterizationsAs discussed in Chapter 3, we may prefer to usepharmacokinetic parameters in our PK routine other than themicroconstants used by PREDPP. Appendix 2 shows severalcommonly-used parameterizations. The PREDPP packageincludes a family of subroutines called TRANS routines whichare pre-programmed to translate (reparameterize) from thesecommonly used parameterizations to the ones expected byPREDPP. Appendix 2 also gives the TRANS routine for eachalternative parameterization. As with ADVAN, TRANS is thename of the routine. The names given in Appendix 2 areinstances of external subroutine names used in the PREDPPLibrary. The first member of the family, TRANS1, simplytranslates a set of microconstants into these samemicroconstants and must be included in the NONMEM loadmodule in lieu of the others when the $PK abbreviated codecomputes the microconstants.The user must describe on the $SUBROUTINE record which TRANSroutine is to be used. For example, the following recordrequests the One Compartment Linear Model parameterized (inthe PK routine) in terms of clearance and volume.$SUBROUTINE ADVAN1,TRANS2When a TRANS other than TRANS1 is used, only the alternativeparameters listed in column 1 need be assigned values in the$PK abbreviated code. In this example, these are CL, V, andKA.Note that TRANS1 is the default. That is, if no TRANSroutine is listed on the $SUBROUTINE record, it is assumedthat TRANS1 is intended. This is the case in the examplesof Chapter 2. Alternative parameterizations using TRANS1are discussed later in this chapter in Section 4.2.3. $PK Abbreviated Code &#9474;$PK abbreviated code consists of a block of $P___ statements___________one per line, which look much like FORTRAN statements. Infact, they are a subset of FORTRAN: simple assignment &#9474;statements, certain kinds of conditional (IF) statements, &#9474;and certain kinds of CALL, WRITE, PRINT, RETURN, OPEN, &#9474;CLOSE, REWIND statements. The $PK abbreviated code must bepreceded by a record containing the characters &quot;$PK&quot;. Thisrecord and the abbreviated code constitute the $P___ record_______$PK statements must include assignment statements giving avalue to every basic PK parameter for the given ADVAN andTRANS combination, as listed in Appendix 1 (when TRANS1 isused) or column 1 of Appendix 2 (when a different TRANS isused). They may also include assignment statements givingvalues to one or more of the additional PK parameters.3.1. SyntaxWe assume the readers of this document are familiar withwriting FORTRAN assignment and conditional statements. Ifnot, the examples in this and the following chapter shouldgive adequate guidance. FORTRAN statement numbers are notused, and the statements may start in any column. As withall NM-TRAN records, blank lines are permitted, and all textfollowing a semi-colon (;) is ignored and may be used forcomments. FORTRAN continuation lines are not permitted.The statements are built using the following: elements ofthe THETA array (e.g., THETA(1)); constants; names of inputdata items appearing on the $INPUT record; names ofpreviously-assigned variables; FORTRAN library functionsSQRT, LOG, LOG10, EXP, SIN, COS, ABS, TAN, ASIN, ACOS, ATAN &#9474;and INT. arithmetic operators +, -, *, /, **; andarithmetical and logical expressions using all of the above.In addition, statements may include representations forrandom variables such as ETA(1) and EPS(3). Input dataitems have the values appearing on the current event record,and thus these values may change from one event record tothe next. A user-defined variable name follows the usualFORTRAN rules (1-6 letters and digits, starting with aletter) and may not be subscripted. It is defined(&quot;declared&quot;) by being assigned a value (i.e., by appearingto the left of = in an assignment statement).Nested parentheses and nested IF statements are allowed. A &#9474;pair of parentheses enclosing a subscript may be nestedwithin another pair of parentheses. All subscripts must beconstants (e.g. THETA(1)). The statements are evaluatedsequentially, in the order in which they appear.All variables, constants, and expressions are evaluatedusing floating-point (not integer) arithmetic. Single ordouble precision function names and constants may be usedinterchangeably.3.2. When are $PK Statements Evaluated?$PK statements are normally evaluated with every eventrecord for both population and individual data. Thisenables the amounts in the compartments to be updated fromevent time to event time using current values of the dataitems. This may be more frequent than is necessary. In thetheophylline example of Chapter 2, no data item is used inthe $PK statements. In the phenobarbital example, the dataitem used, WT, is constant within any individual&rsquo;s data. Inthese cases, it is sufficient, and it can save noticeableamounts of run time, to evaluate the $PK statements once perindividual record. PREDPP can be instructed that the set ofevent records with which the $PK statements are evaluatedare to be limited in some way (see Chapter 12, Section 2.7).The CALL data item can be used to force the statements to beevaluated with any event records.Certain advanced forms of dosing (additional and laggeddoses; see Chapter 12, Sections 2.4 and 2.5) introduce dosesat times which do not necessarily coincide with any eventrecord. PREDPP does not normally evaluate the $PKstatements at such times, but can be instructed to do so(Chapter 12, Section 2.7). Model event time parameters can &#9474;be used to instruct PREDPP to evaluate the $PK statements at &#9474;specified times (Chapter 12, Section Section 2.7)3.3. Time Varying PK parametersThe state of the kinetic system at a given event time isobtained using PK parameter values computed with the dataitems on the event record. Using these parameter values thesystem is advanced to the event time from the last eventtime. Population models sometimes use data items whichchange value within individual records and thus give rise toPK parameters whose values change within individual records.In Chapter 4, Section 3.1.6, it is pointed out that it isdesirable for the value of such a data item on the eventrecord to be that value holding at the midpoint of theinterval between the current event time and the lastprevious event time, since the system is advanced over thisinterval using the PK parameters determined with this value.If the data item changes too rapidly for this value tofairly represent the data item over the entire time period,it is possible to subdivide the interval into smallerintervals. Event records with EVID=2 (other type eventrecords) can be introduced for this purpose. For example,between two consecutive event records rj and rj+1, withevent times tj and tj+1, one might introduce two new othertype event records R1 and R2, with event times T1 and T2,into the data set. The value of the data item in R1 will beused to compute the PK parameters used to advance the systemover the interval tj to T1 and should be the value of thedata item holding at the midpoint of this interval.Similarly, the value of the data item in R2 will be used tocompute the PK parameters used to advance the system overthe interval T1 to T2 and should be the value of the dataitem holding at the midpoint of this interval, and so on.4. $PK Statements for Individual Data4.1. Basic and Additional ParametersWith individual data, the parameters to be estimated are(usually) the individual&rsquo;s PK parameters, and therefore,elements of &theta; should be associated with these PK parameters.(NONMEM estimates the elements of the &theta; vector.) By anindividual&rsquo;s PK parameters, we mean here the basic PKparameters and, possibly, some additional PK parameters(e.g. a bioavailability fraction, or volume of distributionwhen the latter is not a basic PK parameter). Toillustrate, in the theophylline example of Chapter 1 thereoccur these $PK statements$PKKA=THETA(1)K=THETA(2)The parameters KA and K are the basic PK parameters forADVAN2 and TRANS1 (the default TRANS routine). They areused to compute the amounts in the compartments. Typically,however, the observations are concentrations. A scaleparameter is used to convert the amount into aconcentration. Thus, in the theophylline example we see twoadditional $PK statements:V=THETA(3)S2=VHere, V is a user-defined variable standing for the volumeof distribution of the central compartment. It is neither abasic nor additional parameter. The parameter S2 is thescale parameter for the central compartment; upon dividingthe amount in that compartment by S2, the concentrationresults. (An observation is usually predicted by an amountfor a compartment divided by that compartment&rsquo;s scaleparameter). In fact, these two statements could be replacedby the single statementS2=THETA(3)However, it may be helpful to the user to distinguish in hiscode between the calculation of the central volume itselfand the calculation of the scale parameter.There is no particular need for certain elements of &theta; to beassociated with certain PK parameters. In the aboveexample, the roles of &theta;1 and &theta;2 could have been reversed.NONMEM&rsquo;s &theta; vector may contain more or fewer elements thanthere are PK parameters, depending on how these parametersare modeled.PK parameters must be explicitly modeled, usually in termsof parameters to be estimated and user-defined data items;the user communicates this model with the $PK statements.If a certain parameter&rsquo;s value is known _ prior______ (say, S2has the known value 500), there are several ways the valuecan be incorporated into the $PK statements. The followingexamples show how it can be done via a constant, via a fixedelement of &theta;, and via a (differently-named) data item:1. S2=5002. $THETA .6 9. (500 FIXED)$PKS2=THETA(3)Here, rather than be estimated, &theta;3 is constrained tothe value 500. This is discussed in Chapter 9.3. $INPUT ... VOL ..$PKS2=VOLHere, VOL is assumed to have the value 500 on the datarecords. When the data is from a population, thisthird technique allows a unique value of VOL to besupplied for each individual.4.2. Alternative Parameterizations using $PK StatementsIt is possible to use an alternative parameterization whilestill using TRANS1. The reparameterization is performedwithin the $PK statements by explicitly computing themicroconstants from the alternative parameters. Such&quot;reparameterization&quot; statements are given in column 2 ofAppendix 2. They must follow the assignment statements thatgive the alternative parameters their values, as in thephenobarbital example of Chapter 2.The advantage of using $PK statements to reparameterize,rather than using a TRANS subroutine, is that theNONMEM-PREDPP load module will then always consist of thesame set of subroutines for a given choice of ADVAN, whichsimplifies the job of creating and running it. It will alsorun slightly faster. We assume in this document that thisapproach is taken.Other parameterizations are possible besides the ones inAppendix 2. For example, with ADVAN1 and TRANS1, one mightcode:CL=THETA(1)K=THETA(2)V=CL/KS1=VThe ability to express a large variety of modelingpossibilities with NONMEM-PREDPP provides great freedom andflexibility, but as always with flexible modelingcapability, certain pitfalls arise. Suppose, for example,that with a one compartment system the compartment amount,rather than the concentration is observed. With ADVAN1 andTRANS1 the statementsCL=THETA(1)V=THETA(2)K=CL/Vwill lead to difficulty because only the ratio of &theta;1 to &theta;2affects the amount in the compartment, and therefore, thedata do not allow &theta;1 and &theta;2 to be separately estimated. Thestatements should read:K=THETA(1)It is important to remember that only those elements of &theta;which affect the predictions of observations will beestimated by NONMEM. Here is some problematic code usingADVAN1 with TRANS1:K=THETA(1)V=THETA(2)CL=THETA(3)S1=VOnce again, NONMEM will be unable to produce separateestimates of all elements of &theta;. The kinetics of a simpleone compartment system cannot be determined by threeindependent parameters. With TRANS1, PREDPP itself does not&quot;know&quot; about the relationship K=CL/V which defines adependency among the parameters. Indeed, the parameters CLand V are both regarded as user-defined variables. Thevalue of &theta;3 has no effect on the prediction. Were it notfor the fact that S1 is set equal to V, the value of &theta;2would have no effect on the prediction either. With TRANS2this code is also incorrect for essentially the same reason.Here, K is regarded as a user-defined variable, and therelationship CL=K*V is not &quot;known&quot; to PREDPP. (PREDPP doesknow that CL/V is the rate constant of elimination, but itdoes not recognize the variable K as denoting this rateconstant, and &theta;1 has no effect on the prediction.)4.3. Scale ParametersScale parameters are mentioned in Section 2.1. Predictedcompartment amounts are divided by them and are thusconverted to predicted concentrations. They are only neededfor those compartments whose concentrations are directlyobserved. With ADVAN3, for example, the peripheralcompartment&rsquo;s scale S2 does need to be computed explicitlyif there are no observation events giving measured values ofconcentrations in the peripheral compartment. Predictedvalues for this compartment may still be plotted againsttime, for example, but these values need not be scaled drugamounts; the (unscaled) amount alone is sufficient to showthe shape of the curve. (The various volume parametersshown in Appendix 2 must be modeled when they are used asbasic parameters, but they need not be assigned as values tocompartment scale parameters.) Any scale parameter which isnot modeled by $PK statements is assumed to be 1 (i.e.,predicted values are always amounts).4.3.1. Scaling by a Known ConstantIn Chapter 3, Section 2.2.1, the units of V were changedfrom kiloliters to liters using the model:S=V/1000This can be coded in a $PK statementsimilar to the way it appears here,except that the compartment number mustbe specified:S1=V/1000Basic PK parameters may also be rescaled in thismanner.4.3.2. Scaling by a Parameter: Conditional Statements andIndicator VariablesIn Chapter 3, Section 2.2.2, the following model appeared:V, ifassayis1S=&#9129;hV,ifassayis2There are two ways this can be coded in $PK statements.The assay data item can be tested directly,or anindicator variablecan be used.Anindicator variableis a variable whose value is 0 or 1.It may be identified with an input data item, or it may be a user-definedvariable in the $PK statements.For example, suppose variable ASY is to beused as an indicator variable.If some input data item isgiven value 1 when assay 1 was used and value 0 when assay2 was used, then this data item could simply be named ASY on the$INPUT record.Suppose, however, that the assay number itself (1 or 2)was recorded in the dataand that we have named the data itemANUM on the $INPUT record.We must compute the user-defined variable ASY for use asan indicator variable.There are two ways this can be done: using a logical IFand using a block IF.1. ASY=1IF (ANUM.EQ.2) ASY=0Here, ASY is &quot;provisionally&quot; given the value 1. Thevalue is changed to 0 if the data indicates assay 2.2. IF (ANUM.EQ.1) THENASY=1ELSEASY=0ENDIFThe choice between these forms of IF is purely a matter ofstyle. Now let us assume that the compartment to be scaledis compartment 2, and that h is to be identified with &theta;5.The parameter S2 can now be coded unconditionally:S2=ASY*V+(1-ASY)*THETA(5)*VAlternatively, ANUM can be tested and ASY avoidedaltogether:1. S2=VIF (ANUM.EQ.2) S2=THETA(5)*V2. IF (ANUM.EQ.1) THENS2=VELSES2=THETA(5)*VENDIF4.3.3. Scaling by a Data ItemIf observations of urine concentration Cu are included inthe data (see e.g. Chapter 6, Section 9), it is necessary toprovide urine volume as a scale for the output compartment.Presumably, this volume varies between urine observationsand is recorded in the data records. Suppose this data itemis called UVOL in the $INPUT record. (The name given to thedata item has no special significance; any name could bechosen.) An additional $PK statement is necessary:S0=UVOLUVOL need be recorded on only those observation events towhich it applies, although it does no harm to record it onother event records. For example, it may well happen thatboth plasma and urine responses are measured at the sametime, so that there are two observation event records withthe same value of TIME, one for each compartment observed atthat time. As described in Section 3.2 above, $PKstatements are normally evaluated with every event record.Consider, for example, the sample data below. Assume thatthe Central compartment is compartment 2 and the outputcompartment is compartment 3. (Note the use of -3 tosignify that compartment 3 is to be turned off after theobservation time. The compartment will remain off until thetime another urine collection begins, as indicated with another type record; see Chapter 6, Section 7.4). Either 1.or 2. will produce the correct value of S0:1. Record UVOL on the event record to which it applies.The order of the records does not matter.TIME UVOL DV CMT10. 0 5.80 210. 100 .067 -32. Record UVOL on all event records having the same valueof TIME. The order of the records does not matter.TIME UVOL DV CMT10. 100 5.80 210. 100 .067 -3The following will not produce the correct value of S0unless PREDPP is instructed to evaluate the $PK statementsonly once for each distinct value of TIME:TIME UVOL DV CMT10. 100 5.80 210. 0 .067 -34.4. Bioavailability Fraction ParametersPK parameters of the form Fn, where n is the number of acompartment into which a dose may be introduced, arebioavailability fractions. If a dose record specifies adose for compartment n, the dose amount given on the eventrecord is multiplied by the value of Fn computed from the$PK statements evaluated with this record, and this productis the dose amount introduced into the system. For example,F1 multiplies the amount of dose which is to be added tocompartment 1. Any Fn which is not computed by $PKstatements is assumed to be 1 (i.e., the dose is 100%available).As an example, suppose two different preparations of thesame drug are administered, and it is assumed that theydiffer only in their bioavailability. The indicatorvariable (or data item) PREP has value 1 for the firstpreparation and 0 for the second. The ratio of thebioavailability of the second preparation to that of thefirst preparation is identified with &theta;6. Usually, themethod of drug administration permits this ratio to beestimated, but not the separate bioavailabilities. Withoutloss of generality, the bioavailability of the firstpreparation can be taken to be 1. Assuming the drug enterscompartment 1 of the model, there are three ways this can becoded:1. F1=PREP+(1-PREP)*THETA(6)2. F1=1IF (PREP.EQ.0) F1=THETA(6)3. IF (PREP.EQ.0) THENF1=THETA(6)ELSEF1=1ENDIFAgain, the choice is a matter of style.Once a dose is introduced into the dose compartment, itbegins to distribute into the other compartments. Whetheror not the original dose was 100% available, it is assumedthat none of the dose appearing in the dose compartment, andin other compartments after the dose is introduced, isfurther reduced due to bioavailability effects. PREDPPcannot model &quot;bioavailability effects&quot; between compartments.4.5. Output FractionThe Output Fraction parameter, F0, is an optional additionalPK parameter of every model. As discussed in Section 2above, every model contains an output compartment. If thiscompartment has been turned on prior to the advance fromtime tj&minus;1 to time tj, then the amount of drug lost from thesystem during this interval via elimination is multiplied byF0 and added to the prior contents of the outputcompartment. If the $PK statements do not include anassignment statement giving a value to F0, it is taken to be1 (i.e., 100% of the drug excreted goes to the outputcompartment). In model (4.7), an example of the use of F0is given. Assuming that the variables CLREN (renalclearance) and CL (total clearance) have been calculatedwith earlier $PK statements, the statementF0=CLREN/CLcan be used to compute F0.5. $PK Statements for Population DataWith population data, the structural models for the PKparameters tend to be more complicated than with individualdata. In addition, the influence of interindividual randomeffects needs to be described. These will involvedifferences in the $PK statements, but the same $SUBROUTINErecord and the same ADVAN and TRANS subroutines are used,and the same general requirements and examples of theearlier sections of this chapter still mostly apply. Inthis section, the models of Chapter 4 are implemented via$PK statements. Many of these models could be implementedin a variety of ways; an experienced programmer may preferto code them differently.With population data, we must distinguish between thetypical value of a PK parameter in the population and thevalue of that parameter for a given individual, theindividual&rsquo;s value. The typical value is computed by astructural model involving only fixed effects. We havechosen to denote it with the use of a tilde: e.g. Cl. Theindividual&rsquo;s value is computed by a model including randominterindividual effects (represented by random variables)and is denoted without a tilde: e.g., Cl. There is no tildecharacter in the FORTRAN character set, and with NM-TRAN wedo not need to distinguish typical and individual values.However, for purposes of clarity, in all the examples whichfollow we will include the letters TV (Typical Value) at thestart of those variable names which we think of as having atilde (e.g., TVCL). This is a matter of style.5.1. Structural Part of Parameter ModelsIn models such as (4.3), the subscript i indicates that themodel applies to the ith individual. As noted in Chapter 4,the subscript is not needed and, indeed, is not used in $PKstatements.5.1.1. Linear ModelsModels (4.4), (4.5a), (4.5b) and (4.6) can be coded as theyappear. Assuming that WT, AGE, and SECR are input dataitems or have been calculated with earlier $PK statements,the code is:TVCLM=THETA(1)*WTRF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFTVCL=TVCLM+TVCLR5.1.2. Multiplicative ModelsModel (4.4.1) can be coded as follows:TVLCLM=THETA(1)+THETA(2)*LOG(WT)TVCLM=EXP(TVLCLM)Model (4.4.2) can also be coded as it appears:TVCLM=THETA(1)*WT**THETA(2)5.1.3. Saturation ModelsModel (4.4.3) presents a problem. Subscripted variablesthat can appear in $PK statements are few; naturally, theyinclude THETA and (as seen below) ETA. The variable CPSScannot be subscripted, and a variable name such as CPSS2(rather than CPSS(2)) must be used for Cpss2. The model can &#9474;be coded exactly as it appears:TVCLM=WT*(THETA(1)-THETA(2)*CPSS2/(THETA(3)+CPSS2))5.1.4. Models with Indicator VariablesWhen dealing with typical values, indicator variables (0/1variables) can be used interchangeably with conditional (IF)statements, as we have already seen. Model (4.4.4) can becoded in a variety of ways, two of which are:1. TVCLM=(THETA(1)-THETA(2)*HF)*WT2. IF (HF.EQ.0) THENTVCLM=THETA(1)*WTELSETVCLM=(THETA(1)-THETA(2))*WTENDIF5.2. Population Random Effect ModelsRandom variables &eta; are used in the models forinterindividual errors. (With population models, randomvariables &epsilon; are used in the models for intraindividualerrors; see Chapter 4, Section 2.) In $PK statements theyare denoted by ETA(1), ETA(2), etc. Even if there is onlyonce such variable it must still be subscripted. It is thepresence of one or more such variables that indicates toNM-TRAN that the data is from a population. Just as thereis no particular need for certain &theta; elements to beidentified with certain PK parameters, there is noparticular need for certain &theta; elements to be associated withcertain &eta; variables, and any association need not beone-to-one. The following models are both valid:1. CL=THETA(1)+ETA(1)V=THETA(2)+ETA(2)2. CL=THETA(1)+ETA(2)V=THETA(2)+ETA(1)However, it will be easier to keep things straight if thefirst model is used.Here are three different ways of coding a model for anindividual&rsquo;s value of clearance:1. TVCL=THETA(1)CL=TVCL+ETA(1)2. CL=THETA(1)CL=CL+ETA(1)3. CL=THETA(1)+ETA(1)We prefer the first way because it clearly distinguishes themodel for the typical value from the model for theindividual&rsquo;s value. With any of the three ways for codingthe model the typical value of the parameter can be computedas follows: The &eta; variables are set to 0, and the parameteris computed. Any variable whose value depends on &eta;variables is called a rando______ variable_________Random variables are called true-value variables in the &#9474;first edition of this guide. This is because, in principle, &#9474;a random variable can assume an individual&rsquo;s true value &#9474;under the model. Such a variable is in contrast to a &#9474;variable which assumes only a typical value for the &#9474;population.An individual&rsquo;s true value is never actually known, althoughan estimate of it can be obtained. See Chapter 12, Sections4.11-4.13.5.3. Models for Interindividual ErrorsHere we show how to express the most commonly used modelsfor interindividual errors with $PK statements. Inaddition, all the error models described in Chapter 8 mayalso be used in $PK statements.5.3.1. Additive/Multiplicative ModelsThis is the error model of (4.9):K=TVK+ETA(1)This is the error model of (4.10):K=TVK*(1+ETA(1))This model can also be coded as:K=TVK+TVK*ETA(1)Here, the variable TVK has been &quot;multiplied through&quot;. Thechoice is a matter of style.5.3.2. Other ModelsThe model (4.11) may be coded as written.CLM=TVCLM+(1-ICU)*ETA(1)+ICU*ETA(2)It may also be coded with an IF statement. &#9474;IF (ICU.EQ.0) THENCLM=TVCLM+ETA(1)ELSECLM=TVCLM+ETA(2)ENDIFThe choice is a matter of style.Note that, under the parameterizations given in Appendices 1and 2, CLM is neither a basic nor an additional PKparameter, yet its model involves an &eta; variable. This islegitimate: any variable can be defined in terms of an &eta;variable. However, just as with &theta;&rsquo;s, the values assigned tothe &eta; variables must somehow affect the predictions ofobservations. Otherwise, the variance of some &eta; variablecannot be estimated, and consequently, none of the variancesof these variables can be estimated. Presumably, within the$PK statements, CLM is used to compute CL, and (eitherwithin the $PK statements or within the TRANS routine) CL isused to compute K.5.4. Restrictions on Random Variables &#9474;This section discusses the use of random variables in somedepth and may be skipped by the casual reader. The remarkshere apply to all random variables: both the ETA variablesof this chapter and the ERR/EPS variables of Chapter 8.In general, ETA variables can be used like any othervariables.Any variable whose value is affected by an ETA variable is arandom variable, whether the ETA variable occurs explicitlyin the defining expression for the random variable orwhether another random variable occurs in this expression.For example, consider the following:TVCLM=THETA(2)*WTCLM=TVCLM+ETA(2)RF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFCLR=TVCLR+ETA(1)CL=CLM+CLRCL is a random variable, because it is computed from randomvariables. It depends on both &eta;1 and &eta;2.Random variables may be changed and may be assigned &#9474;conditionally, subject to the following restrictions. &#9474;A random variable may not appear anywhere within a &#9474;nested if structure. &#9474;A random variable defined in the $PK block may not be &#9474;redefined in the $ERROR block.As an example of the first restriction, suppose in the model(4.11) it is also believed that, for ICU patients, ageaffects CLM. The following code expresses the model, but isnot permitted:IF (ICU.EQ.1) THENIF (AGE.GE.50) THENTVCLM=THETA(1)ELSETVCLM=THETA(2)ENDIFCLM=TVCLM+ETA(1)ELSETVCLM=THETA(3)CLM=TVCLM+ETA(2)ENDIFAn alternate code follows, in which the calculation of TVCLM(which involves a nested IF) precedes the calculation of CLM(which does not require a nested IF). This code ispermitted.IF (ICU.EQ.1) THENIF (AGE.GT.50) THENTVCL=THETA(1)ELSETVCL=THETA(2)ENDIFELSETVCL=THETA(3)ENDIFIF (ICU.EQ.1) THENCL=TVCL+ETA(1)ELSECL=TVCL+ETA(2)ENDIFIndentations are used in the above code for clarity, buthave no affect on NM-TRAN&rsquo;s processing of the abbreviatedcode.</a><br>
<a href="#1. What This Chapter is AboutThis chapter tells how to write a simple $ERROR record forPREDPP. This chapter is meant to be read in parallel withChapters 3 and 4.2. $ERROR Abbreviated Code$ERROR abbreviated code consists of a block of $ERRO______statements___________ one per line. The $ERROR abbreviated code mustbe preceded by a record containing the characters &quot;$ERROR&quot;.This record and the abbreviated code constitute the $ERRO______record_______$ERROR statements describe the error model for PREDPP.These statements are very similar for individual data andfor population data. In fact, by making use of variablescalled ERR variables, the $ERROR statements are identicalfor both kinds of data.2.1. SyntaxThe syntax of a $ERROR record is very similar to that of a$PK record. Certain differences will be mentioned here.There must be an assignment statement giving a value to aspecial (reserved) variable Y. Y is a random variable &#9474;representing the random variable y (the modeledobservation). Y is usually defined in terms of a special(reserved) variable F, which represents the prediction forY. When the data are from a population, F is a random &#9474;variable. With individual data, ETA variables may be usedin the definition of Y. With population data, EPS variablesmay be used in the definition of Y. There are also specialrandom variables called ERR variables. The variable ERR(I)is the same as ETA(I) or EPS(I), depending on whether thedata are individual or population, respectively. For thepurpose of giving a general discussion, applying equally toboth individual and population data, ERR will be used in allthe examples in this chapter. (It is also useful to use ERRin $ERROR statements as a practical matter. Sometimes thesame data is analyzed from both the population and theindividual point of view. By using ERR variables, changes tothe NM-TRAN input file are minimized.) An ERR variable (aswith ETA and EPS variables) must always include a subscript(e.g., ERR(1)), even when there is only one such variable inthe model.Variables computed within $PK statements may be used in$ERROR statements, but not vice versa.2.2. When are $ERROR Statements Evaluated?$ERROR statements are normally evaluated with every event &#9474;record. This may be more frequent than is necessary.PREDPP can be instructed that the set of event records withwhich the $ERROR statements are evaluated is to be limitedto only observation events, once per individual record, oronce per problem. Such limitation does not apply to theSimulation Step (Chapter 12, Section 4.8). With theadditive (3.4) and constant coefficient of variation (3.5)error models, and with the exponential error model, NM-TRAN &#9474;instructs PREDPP to evaluate the $ERROR statements only onceper problem. Again, the CALL data item can be used to forceevaluation of the $ERROR statements with any event records.3. Error ModelsThe following sections show how the error models of Chapter3 are expressed using $ERROR statements.3.1. The Additive Error ModelThis is the error model (3.4):Y=F+ERR(1)Both examples in Chapter 2 use this error model. &#9474;3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsThis is the CCV error model (3.5):Y=F*(1+ERR(1))This error model can also be coded as:Y=F+F*ERR(1)Here, the variable F has been &quot;multiplied through&quot;. Thechoice is a matter of style.This is the exponential error model (3.5a): &#9474;Y=F*EXP(ERR(1))When the $ERROR statements consist solely of one of thesestatements (in any of the forms), the output from PREDPPwill include the message:ERROR IN LOG Y IS MODELEDThis is done because during data analysis NONMEM cannotdistinguish between the CCV error model y=f+f&epsilon; and theexponential error model y=fexp(&epsilon;), for whichlog(y)=log(f)+&epsilon;&dagger;. By using the latter model and modellingthe error in log(y) rather than in y, NM-TRAN enables PREDPPto achieve an improvement in run time.<cite>&dagger; During Simulation, NONMEM does distinguish between the CCVand exponential error models. </cite>3.3. Combined Additive and CCV Error ModelThis is the error model (3.6):Y=F+F*ERR(1)+ERR(2)3.4. The Power ModelThis is the error model (3.7):Y=F+F**P*ERR(1)The variable P must be assigned a value before its useabove. P is typically identified with an element of &theta; sothat it can be estimated in the fitting process. Let usassume that &theta;4 is chosen for this purpose. Then analternative coding is:Y=F+F**THETA(4)*ERR(1)3.5. Two Different Types of MeasurementsWe have already seen how an indicator variable, e.g., ASY,can be used in $PK statements for a variety of purposes.The same technique is used in $ERROR statements. Considermodel (3.8) where the variable ASY has the value 1 or 0,corresponding to assay 1 or assay 2. ASY is a data recorditem. Then the error model (3.8) is coded:Y=F+ASY*ERR(1)+(1-ASY)*ERR(2)This model can also be coded in several ways, the choice of &#9474;which is a matter of style.1) IF (ASY.EQ.1) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF2) IF (ASY.EQ.1) Y=F+ERR(1)IF (ASY.NE.1) Y=F+ERR(2)3) Y=F+ERR(2)IF (ASY.EQ.1) Y=F+ERR(1)3.6. Two Different Types of ObservationsIn Chapter 3, Section 3.6, an example is given in whichthere are two kinds of observations, plasma (C) and urine(Cu). With PREDPP, measurements from different compartmentsof the model are recorded in the DV data item of differentobservation event records. The CMT data item identifies thecompartment from which the prediction associated with theevent record is to be obtained. When the $ERROR statementsare evaluated for a given event record, the variable Fcontains the prediction from the compartment specified forthat event record. All that need be done is to select thecorrect error model, depending on the compartment. Suppose,for example, that ADVAN2 is used, so that the centralcompartment is compartment 2 and the output (urine)compartment is compartment 3. Then the error model (3.10)can be coded:TYP=0IF (CMT.EQ.2) TYP=1Y=F+TYP*ERR(1)+(1-TYP)*ERR(2)This model can also be coded in several ways, one of whichis shown here:IF (CMT.EQ.2) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF3.7. More than One Indicator VariableIn Chapter 3, Section 3.7, an example is given in whichthere are three kinds of observations. Suppose that thereare two data items, ASY1 and ASY2. ASY1 is 1 if assay 1 isused and 0 otherwise. ASY2 is 1 if assay 2 is used and 0otherwise. This is the error model (3.11):Y=F+ASY1*ERR(1)+ASY2*ERR(2)+(1-ASY1)*(1-ASY2)*ERR(3)This model can also be coded in several ways, one of whichis shown here:Y=F+ERR(3)IF (ASY1.EQ.1) Y=F+ERR(1)IF (ASY2.EQ.1) Y=F+ERR(2)">1. What This Chapter is AboutThis chapter tells how to write a simple $ERROR record forPREDPP. This chapter is meant to be read in parallel withChapters 3 and 4.2. $ERROR Abbreviated Code$ERROR abbreviated code consists of a block of $ERRO______statements___________ one per line. The $ERROR abbreviated code mustbe preceded by a record containing the characters &quot;$ERROR&quot;.This record and the abbreviated code constitute the $ERRO______record_______$ERROR statements describe the error model for PREDPP.These statements are very similar for individual data andfor population data. In fact, by making use of variablescalled ERR variables, the $ERROR statements are identicalfor both kinds of data.2.1. SyntaxThe syntax of a $ERROR record is very similar to that of a$PK record. Certain differences will be mentioned here.There must be an assignment statement giving a value to aspecial (reserved) variable Y. Y is a random variable &#9474;representing the random variable y (the modeledobservation). Y is usually defined in terms of a special(reserved) variable F, which represents the prediction forY. When the data are from a population, F is a random &#9474;variable. With individual data, ETA variables may be usedin the definition of Y. With population data, EPS variablesmay be used in the definition of Y. There are also specialrandom variables called ERR variables. The variable ERR(I)is the same as ETA(I) or EPS(I), depending on whether thedata are individual or population, respectively. For thepurpose of giving a general discussion, applying equally toboth individual and population data, ERR will be used in allthe examples in this chapter. (It is also useful to use ERRin $ERROR statements as a practical matter. Sometimes thesame data is analyzed from both the population and theindividual point of view. By using ERR variables, changes tothe NM-TRAN input file are minimized.) An ERR variable (aswith ETA and EPS variables) must always include a subscript(e.g., ERR(1)), even when there is only one such variable inthe model.Variables computed within $PK statements may be used in$ERROR statements, but not vice versa.2.2. When are $ERROR Statements Evaluated?$ERROR statements are normally evaluated with every event &#9474;record. This may be more frequent than is necessary.PREDPP can be instructed that the set of event records withwhich the $ERROR statements are evaluated is to be limitedto only observation events, once per individual record, oronce per problem. Such limitation does not apply to theSimulation Step (Chapter 12, Section 4.8). With theadditive (3.4) and constant coefficient of variation (3.5)error models, and with the exponential error model, NM-TRAN &#9474;instructs PREDPP to evaluate the $ERROR statements only onceper problem. Again, the CALL data item can be used to forceevaluation of the $ERROR statements with any event records.3. Error ModelsThe following sections show how the error models of Chapter3 are expressed using $ERROR statements.3.1. The Additive Error ModelThis is the error model (3.4):Y=F+ERR(1)Both examples in Chapter 2 use this error model. &#9474;3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsThis is the CCV error model (3.5):Y=F*(1+ERR(1))This error model can also be coded as:Y=F+F*ERR(1)Here, the variable F has been &quot;multiplied through&quot;. Thechoice is a matter of style.This is the exponential error model (3.5a): &#9474;Y=F*EXP(ERR(1))When the $ERROR statements consist solely of one of thesestatements (in any of the forms), the output from PREDPPwill include the message:ERROR IN LOG Y IS MODELEDThis is done because during data analysis NONMEM cannotdistinguish between the CCV error model y=f+f&epsilon; and theexponential error model y=fexp(&epsilon;), for whichlog(y)=log(f)+&epsilon;&dagger;. By using the latter model and modellingthe error in log(y) rather than in y, NM-TRAN enables PREDPPto achieve an improvement in run time.<cite>&dagger; During Simulation, NONMEM does distinguish between the CCVand exponential error models. </cite>3.3. Combined Additive and CCV Error ModelThis is the error model (3.6):Y=F+F*ERR(1)+ERR(2)3.4. The Power ModelThis is the error model (3.7):Y=F+F**P*ERR(1)The variable P must be assigned a value before its useabove. P is typically identified with an element of &theta; sothat it can be estimated in the fitting process. Let usassume that &theta;4 is chosen for this purpose. Then analternative coding is:Y=F+F**THETA(4)*ERR(1)3.5. Two Different Types of MeasurementsWe have already seen how an indicator variable, e.g., ASY,can be used in $PK statements for a variety of purposes.The same technique is used in $ERROR statements. Considermodel (3.8) where the variable ASY has the value 1 or 0,corresponding to assay 1 or assay 2. ASY is a data recorditem. Then the error model (3.8) is coded:Y=F+ASY*ERR(1)+(1-ASY)*ERR(2)This model can also be coded in several ways, the choice of &#9474;which is a matter of style.1) IF (ASY.EQ.1) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF2) IF (ASY.EQ.1) Y=F+ERR(1)IF (ASY.NE.1) Y=F+ERR(2)3) Y=F+ERR(2)IF (ASY.EQ.1) Y=F+ERR(1)3.6. Two Different Types of ObservationsIn Chapter 3, Section 3.6, an example is given in whichthere are two kinds of observations, plasma (C) and urine(Cu). With PREDPP, measurements from different compartmentsof the model are recorded in the DV data item of differentobservation event records. The CMT data item identifies thecompartment from which the prediction associated with theevent record is to be obtained. When the $ERROR statementsare evaluated for a given event record, the variable Fcontains the prediction from the compartment specified forthat event record. All that need be done is to select thecorrect error model, depending on the compartment. Suppose,for example, that ADVAN2 is used, so that the centralcompartment is compartment 2 and the output (urine)compartment is compartment 3. Then the error model (3.10)can be coded:TYP=0IF (CMT.EQ.2) TYP=1Y=F+TYP*ERR(1)+(1-TYP)*ERR(2)This model can also be coded in several ways, one of whichis shown here:IF (CMT.EQ.2) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF3.7. More than One Indicator VariableIn Chapter 3, Section 3.7, an example is given in whichthere are three kinds of observations. Suppose that thereare two data items, ASY1 and ASY2. ASY1 is 1 if assay 1 isused and 0 otherwise. ASY2 is 1 if assay 2 is used and 0otherwise. This is the error model (3.11):Y=F+ASY1*ERR(1)+ASY2*ERR(2)+(1-ASY1)*(1-ASY2)*ERR(3)This model can also be coded in several ways, one of whichis shown here:Y=F+ERR(3)IF (ASY1.EQ.1) Y=F+ERR(1)IF (ASY2.EQ.1) Y=F+ERR(2)</a><br>
<a href="#1. What This Chapter is AboutThis chapter tells how to give initial estimates to NONMEM&rsquo;sparameters ($THETA, $OMEGA, $SIGMA records); how to tellNONMEM what tasks to perform ($ESTIMATION, $COVARIANCErecords); and how to tell NONMEM what additional output toproduce ($TABLE, $SCATTERPLOT records).2. Providing Initial Estimates For &theta;: The $THETA RecordThis record provides an initial estimate (and, optionally,provides lower and upper bounds) for every element ofNONMEM&rsquo;s &theta; vector.2.1. Providing Initial Estimates For Elements Of &theta;The $THETA record contains a list of values, separated byspaces or commas, which are the initial estimates for the&theta;&rsquo;s used in the $PK and $ERROR statements. The position ofa value in the list corresponds to its position (subscript)in the &theta; vector. For example, consider the followingstatement:$THETA 1.7 .102 29.This says that the initial estimate for &theta;1 is 1.7, theinitial estimate for &theta;2 is .102, and the initial estimatefor &theta;3 is 29. Some users of NONMEM prefer to code eachvalue on a separate line so that they can include commentsto themselves describing the significance of the &theta;&rsquo;s. Theabove record could have been coded as follows:$THETA 1.7 ; RATE CONSTANT OF ABSORPTION.102 ; RATE CONSTANT OF ELIMINATION19. ; VOLUME OF DISTRIBUTIONThis is a matter of style.2.2. Providing Constraints for Elements of &theta;When NONMEM is told to estimate the parameters (Section 4.1,the Estimation Step, below), it varies the elements of &theta; tofind values which cause the model to fit the observationsbest. The values on the $THETA record are the initialestimates of &theta; for this search. When only an initialestimate is provided, NONMEM is free to chose any positiveor negative value for that element of &theta;. We then say thatthe &theta; element is unconstrained, which means that its lowerbound (lower limit) is &minus;&infin; and its upper bound (upper limit)is +&infin;. When finite bounds are desired, the initial estimateand its bounds must be enclosed in parentheses and specifiedin the order (lower, initial, upper). When the upper boundneedn&rsquo;t be finite, the initial estimate and its lower boundare enclosed in parentheses and specified in the order(lower, initial). Note that when no estimation isperformed, upper and lower bounds have no effect.In the theophylline example of Chapter 2, for example,negative &theta; values are physiologically impossible. Each &theta;element was given a lower bound of 0, which constrained itto be non-negative:$THETA (0, 1.7) (0, .102) (0, 29.)It is possible to mix constrained and unconstrained &theta;s; thiswas done in Chapter 2, figure 2.12:$THETA (0,.0027) (0,.70) .0018 .5An upper bound of +&infin; may be stated explicitly using thevalue 1000000 or the word INFINITY. Similarly, a lowerbound of &minus;&infin; may be stated explicitly as -1000000 or-INFINITY.2.3. Fixing Elements of &theta;When estimation is performed, it is sometimes desirable tohold one or more elements of &theta; to a constant value. Oneexample is when a full model is reduced to a simpler model,as discussed in Chapter 5, Section 2.1; usually this is doneby holding some &theta; element to 0. In fact, the value 0 maynot be used as an initial estimate for an element of &theta;unless this element is fixed to this value. A &theta; element isheld constant by inserting the word FIXED after the initialestimate. For example, the following statement allows &theta;1and &theta;3 to vary, but holds &theta;2 to the value .102:$THETA 1.7 .102 FIXED 29.Parentheses may be used to make the statement easier toread:$THETA 1.7 (.102 FIXED) 29.If the lower, initial, and upper values for an element of &theta;are identical, the element of &theta; is understood to be fixed,even if the word FIXED does not appear.2.4. How to Obtain Initial Estimates for &theta;When estimating parameters, good initial estimates for &theta; aresometimes important. Poor initial estimates mayoccasionally cause the NONMEM run to take excessive amountsof computer time, to produce parameter estimates that arenot physiologically reasonable, or to fail to produce anyparameter estimates at all. For some drugs and models,initial estimates for &theta; can be obtained from publishedliterature describing prior studies with the drug. For somestudies, very accurate values may have been obtained byprior runs with NONMEM or other regression programs. Highlyaccurate values should be perturbed (modified) by about 10%before being used as initial estimates in a NONMEM run.(Initial estimates that are too close to what may be theactual final estimates will cause problems in a NONMEM run;see Chapter 13.) Sometimes, however, there is littleguidance in choosing initial estimates for some elements of&theta;.One approach with population data, where there is areasonable amount of data for each individual, is asfollows. It is often easier to guess at appropriateparameter values for individual data than for populationdata. So, first estimate each individual&rsquo;s parameter valuesusing only the data from the individual. The mean values ofthe individuals&rsquo; parameter estimates can then be used as theinitial parameter estimates in the population analysis.Results from individual runs can also be used to obtaininitial estimates for elements of &Omega; and &Sigma;; see below.Another approach is simply to let NONMEM find an initialestimate. NONMEM has an automatic strategy for so doing;see Chapter 12, Section 4.4.3. Providing Initial Estimates for &Omega; and &Sigma;: the $OMEGA and$SIGMA RecordsRecall that &Omega; and &Sigma; are variance/covariance matrices for thefollowing random variables:Individual Model&Omega; (OMEGA) for &eta; (Random Intraindividual Variability)Population Model&Omega; (OMEGA) for &eta; (Random Interindividual Variability)&Sigma; (SIGMA) for &epsilon; (Random Intraindividual Variability)In all the examples in this document, &Omega; and &Sigma; are diagonalmatrices, in which covariance elements such as &omega;12 (which iscov(&eta;1,&eta;2)) are assumed to be zero. NONMEM also allows fullvariance/covariance matrices; this is beyond the scope ofthis text, but see Chapter 12, Section 4.1.Initial estimates for the variances must be provided toNONMEM via the $OMEGA and $SIGMA records. Initial estimatesof all model parameters (&theta;, &Omega;, and &Sigma;) must be provided evenif estimation is not requested. $OMEGA and $SIGMA recordseach contain a list of values, separated by spaces orcommas, which are the estimates for the correspondingvariances. As in the $THETA record, the position of a valuein the list corresponds to the position (subscript) of thecorresponding variance (along the diagonal) in the matrix.3.1. $OMEGA Record With Individual DataWith individual data, &eta; variables are used in $ERRORrecords, where they are called either ERR or ETA. Forexample, in the theophylline problem of Chapter 2 (figure2.1) there appear the records:$ERRORY=F+ERR(1)$OMEGA 1.2Here, ERR(1) corresponds to &eta;1, and the initial estimate forits variance is 1.2: i.e., &Omega;11=&omega;1=var(&eta;1)=1.2.3.2. $OMEGA Record With Population DataWith population data, &eta; variables are used in $PKstatements. For example, in the phenobarbital problem ofChapter 2 (figure 2.6) there appear the lines:CL=TVCL+ETA(1)V=TVVD+ETA(2)$OMEGA .0000055, .04The $OMEGA record says that the initial estimate for thevariance of &eta;1 is 5.5x10&minus;6, and of &eta;2 is .04: i.e.,&Omega;11=&omega;1=var(&eta;1)=5.5x10&minus;6 and &Omega;22=&omega;2=var(&eta;2)=.04. Some usersof NONMEM prefer to code each value on a separate line sothat they can include comments:$OMEGA .0000005 ; VARIANCE IN CL.04 ; VARIANCE IN V3.3. The $SIGMA RecordThis record is used only with population data, and issimilar to the $OMEGA record. It gives the initialestimates of the variances of the &epsilon; variables used in the$ERROR statements, where they are called either ERR or EPS.For example, in Figure 2.6, there also appears the records:$ERRORY=F+ERR(1)$SIGMA 25Here, ERR(1) corresponds to &epsilon;1, and the initial estimate forits variance is 25: i.e., &Sigma;11=&sigma;1=var(&epsilon;1)=25.3.4. Fixing Elements of &Omega; or &Sigma;It is sometimes desirable to hold one or more elements of &Omega;or &Sigma; to constant value(s). In the population example ofChapter 2 it is possible to ignore interindividualvariability in CL by fixing &eta;1 to 0&dagger;.<cite>&dagger; One could also re-write the $PK statements to eliminateETA(1) in the model for CL, which also requires that ETA(2)in the model for V be re-numbered as ETA(1). It is easierto modify only $OMEGA. </cite>The variance of an &eta; or &epsilon; variable is held constant byinserting the word FIXED after the initial estimate:$OMEGA 0 FIXED .0225Parentheses may be used to make the statement easier toread:$OMEGA (0 FIXED) .0225As with &theta;, the value 0 may not be used as an initialestimate for any element of &Omega; or &Sigma; unless the element isfixed to this value.3.5. How to Obtain Initial Estimates for &Omega; and &Sigma;The initial estimates for the variances will depend on theparticular (interindividual and/or intraindividual) errormodels chosen. The estimates do not have to be particularlyaccurate, although values which are much too small can causedifficulties for NONMEM. In general, it is better toover-estimate the variances rather than to under-estimatethem. As with initial estimates for &theta;, initial estimatescan sometimes be obtained from published literature or fromprior runs with NONMEM or other regression programs.Initial estimates can also be obtained by an approach whichwe illustrate with examples for both intraindividual andinterindividual error models. The standard deviation of aphysiological quantity is generally some fraction r of itstypical value t: &sigma;y=rt.For the additive model:y=f+&epsilon;&sigma;y=&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=(rt)2=r2t2Some ambiguity exists about what we mean by &quot;the typicalvalue&quot; of y. For the purpose of obtaining an initialestimate of the variance, we need not be too particularabout this. For the theophylline example (Figure 2.1), wemay choose the mean of the observed values as the typicalvalue. This value is approximately 5.4. Assuming 20%error, i.e. r=.2, then &sigma;&epsilon;=(.2x5.4)2=1.2. Similarly, in thefirst phenobarbital example (Figure 2.6), the mean of theobservations is approximately 25. Again assuming 20% error,then r=.2, and &sigma;&epsilon;=(.2x25)2=25. For that same example, thetypical value of CL was estimated according to the model forthe parameter: TVCL=THETA(1). We used the initial estimateof &theta;1, .0047, as the typical value of CL, and assumed 50%error: &Omega;11=(.5x.0047)2=5.5x10&minus;6. The model for V isTVVD=THETA(2). Again, we used the initial estimate of &theta;2,.99, as the typical value of V, but assumed 20% error:&Omega;22=(.2x.99)2=.04. Note finally that in the secondphenobarbital example (Figure 2.12), we used as initialestimates of variance the final estimates obtained from thefirst example (understanding that these estimates could besomewhat large due to some of the variability beingexplained in this example by a systematic influence ofweight).For the constant coefficient of variation model:y=f+f&epsilon;&sigma;y=f&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=r2ft22If we identify t with the value of f (whatever it may be),we have: var&epsilon;=r2In other words, using the CCV model, we do not need toestimate the typical value of the variable. For example,assuming 20% error, var&epsilon;=.22=.04.As with &theta;, it is possible for NONMEM itself to obtaininitial estimates of &Omega; and &Sigma; automatically; see Chapter 12,Section 4.4.4. Specifying Optional TasksTwo main tasks of NONMEM, the Estimation Step and theCovariance Step, are optional and must be specificallyrequested by including the $ESTIMATION and $COVARIANCErecords. To skip the Estimation Step, simply omit the$ESTIMATION record. To skip the Covariance Step, simplyomit the $COVARIANCE record.In every run NONMEM computes and prints the value of theobjective function and the final parameter estimates. Thevalues printed are based on the final parameter estimates ifthe Estimation Step is requested, and are based on theinitial estimates if it is not.4.1. Requesting the Estimation Step: the $ESTIMATION RecordIn the Estimation Step, NONMEM performs a search to obtainthose values of &theta;, &Omega;, and (for population studies) &Sigma; whichgive the lowest value of the objective function. The outputof this step is the pages whose titles are &quot;MONITORING OFSEARCH:&quot;, &quot;MINIMUM VALUE OF OBJECTIVE FUNCTION&quot;, and &quot;FINALPARAMETER ESTIMATE&quot;. This step is requested by the presenceof the following statement:$ESTIMATIONThere are several options, which are described in the NONMEMUsers Guide, Part IV. The most frequently used ones are asfollows.METHOD=0NONMEM always sets etas to 0 during the computation of &#9474;the objective function. Also called the &quot;first order &#9474;(FO) method.&quot; This is the default. It may also be &#9474;coded as METHOD=ZERO. &#9474;METHOD=1 &#9474;NONMEM uses conditional estimates for the etas during &#9474;the computation of the objective function. &#9474;METHOD=1 is also called the &quot;first order &#9474;conditional estimation (FOCE) method.&quot; It may also be &#9474;coded as METHOD=CONDITIONAL. When the option &#9474;INTERACTION is also present, the method is called the &#9474;&quot;FOCE with INTERACTION method&quot;. It is recommended for &#9474;continuous variables unless the data are very sparse. &#9474;These methods are discussed in Guide VII, Conditional &#9474;Estimation Methods.SIGDIGITS=nBy default, the search continues until the estimates ofall elements of &theta;, &Omega;, and &Sigma; have been determined to atleast 3 significant figures. Because only 3significant digits are used to print parameterestimates in the output, and for other reasons as well,this amount of accuracy is often sufficient. However,the SIGDIGITS option can be used to request a differentnumber (n) of significant digits.MAXEVAL=nThe Estimation Step always runs with a specific limiton the number of objective function evaluations allowedduring the search, as a protection against infiniteloops and excessively long runs. The default maximumis computed according to the number of parameters beingestimated. The MAXEVALS option can be used to requesta different number (n) for the maximum number offunction evaluations.PRINT=nAs the Estimation Step progresses, by default it printsintermediate output summarizing the progress of thesearch. The search proceeds in stages, callediterations. At the end of certain iterations asummarization is printed which consists of the valuesof the objective function, its gradient vector withrespect to the parameters, and the parameter valuesthemselves. By default, this summarization is onlyprinted for the first and last iterations. The PRINToption can be used to request a number (n) such thatstarting from the first iteration, only n-1 iterationsare skipped before another summarization is printed&dagger;.<cite>&dagger; The PRINT option can also be used to suppressintermediate printout altogether, but this shouldusually not be done because the information is often ofvalue. See Chapter 10, Section 4. </cite>An example of the use of these options is:$EST SIG=6,MAX=900,PRI=5In addition to the first and last iterations, summarizationsare printed every 5th iteration. Notice that abbreviationsof the record and option names were used; this is a matterof style.4.2. Requesting the Covariance Step: the $COVARIANCE RecordIn the Covariance Step, NONMEM obtains information on theprecision of the parameter estimates obtained in theEstimation Step. The output of this step are pages withtitles &quot;STANDARD ERROR OF ESTIMATE&quot;, &quot;COVARIANCE MATRIX OFESTIMATE&quot;, &quot;CORRELATION MATRIX OF ESTIMATE&quot;, and &quot;INVERSECOVARIANCE MATRIX OF ESTIMATE&quot;. This step is requested bythe presence of the following record:$COVARIANCEThere are several options, which are discussed in NONMEMUsers Guide, Part IV. The Covariance Step cannot berequested by itself; the Estimation Step must precede it&Dagger;.<cite>&Dagger; The Estimation Step may be omitted when the run iscontinued from a prior run using a Model Specification inputfile; see Chapter 12, Section 4.3, and Chapter 13, Section3.2. </cite>5. Specifying Optional Output$TABLE and $SCATTERPLOT records are used to request NONMEMsteps which generate additional output. If one of theserecords is omitted, NONMEM does not produce thecorresponding additional output. Tables and scatterplotsare generated after all other tasks have been performed.This affects the values displayed for PRED, RES, and WRES.If the Estimation Step is not run, then the initialestimates of the parameters are used to compute thesequantities. If the Estimation Step is run, then the finalparameter estimates are used. Residuals (RES) and weightedresiduals (WRES) are defined in Chapter 11, Section 4.4.2.The UNCONDITIONAL option of the $TABLE and $SCATTERPLOTrecords requests that output of this type be generated evenif the Estimation Step terminates unsuccessfully, and is thedefault. The CONDITIONAL option of these records requeststhat output of this type be generated only if the EstimationStep terminates successfully.5.1. Requesting the Table Step: the $TABLE RecordThe values of DV, PRED, RES, and WRES are always printed inevery table. Other data items to be printed should belisted on the record. The data items are printed in theorder in which they are listed. This does not have to bethe same order as in the data file, nor does every data itemhave to be listed. For example, the following recordappears in Chapter 2, figure 2.12:$TABLE ID TIME AMT WT APGRFigure 10.10 in Chapter 10 shows a portion of the resultingoutput.It is possible for the lines of a table to be sorted into adifferent order than that of the original input file; thisis discussed in the NONMEM Users Guide, Part IV.More than one table can be printed. A separate $TABLErecord is used to request each one.5.2. Requesting Scatterplots: the $SCATTERPLOT RecordChapter 2 contained many examples of $SCATTERPLOT recordsand the resulting output. Here, for example, are therecords from figure 2.6:$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS WTThe word UNIT requests a unit-slope line, which is the linePRED=DV. Figures 2.10 and 2.11 show the resulting output.Similarly, the word ORD0 can be used to request a zero lineon the ordinate axis.It is possible to generate several scatterplots with asingle record, by using a list of data item names:$SCATTERPLOT (PRED,RES,WRES) VS WTThis produces three scatterplots, and has the same effect asthe three records:$SCATTERPLOT PRED VS WT$SCATTERPLOT RES VS WT$SCATTERPLOT WRES VS WTSometimes it is desirable to partition a scatterplot into anumber of separate scatterplots. For example, if the datacontain both plasma and urine observations, it would bebetter to separate the scatterplot of PRED vs. DV into onescatterplot where the DV values are the plasma observations,and another one where the DV values are the urineobservations. To do this, it is necessary to specify apartitioning data item, in this case, the CMT data item,which gives the compartment number of the observation. Thefollowing record could be used.$SCATTERPLOT PRED VS DV BY CMT UNITThis will produce separate scatterplots: one with plasmaobservations (CMT=1 if ADVAN1 is used), and one with urineobservations (CMT=2 if ADVAN1 is used).Two partitioning items can also be specified:$SCATTERPLOT PRED VS DV BY CMT SEX UNITOne scatterplot is produced for each unique combination ofvalues of the two partitioning data items.6. Placement and Order of RecordsTwo main rules control the placement and order of recordswithin a NM-TRAN control file:The $INPUT record must appear before any records whichcontain data item names ($PK, $ERROR, $TABLE,$SCATTERPLOT)The $SUBROUTINE, $PK, and $ERROR records should appearin the indicated order, but do not have to beconsecutive.The records $DATA, $THETA, $OMEGA, $SIGMA, $ESTIMATION,$COVARIANCE, $TABLE, and $SCATTERPLOT can be placed anywhereamong the control records, in any order. However, NONMEMalways performs its tasks in a fixed order:Estimation StepCovariance StepTable StepScatterplot StepThus, even if the $TABLE record precedes the $ESTIMATIONrecord, the values of PRED, RES, and WRES in the table willbe based on the final parameter estimates. &#9474;7. INCLUDE records &#9474;One or more records of the form &#9474;INCLUDE filename n &#9474;may appear anywhere among the NM-TRAN control records. The &#9474;characters INCLUDE may be upper- or lower-case. &quot;n&quot; is an &#9474;optional integer, and gives the number of copies (default is &#9474;1). &#9474;NMTRAN opens the named file and reads it to end-of-file. &#9474;The contents of the named file may be any portion of an &#9474;NM-TRAN control stream, e.g., NM-TRAN control records and/or &#9474;abbreviated code. After reaching end-of-file, if the &#9474;number of copies is greater than 1, NM-TRAN rewinds the &#9474;file and re-reads it the specified number of times. After &#9474;reaching end-of-file on the final (or only) copy, NMTRAN &#9474;resumes reading the original control stream after the &#9474;include record. &#9474;There may be more than one INCLUDE record, but they may not &#9474;be nested. That is, an included file may not contain &#9474;INCLUDE records. &#9474;For example, &#9474;$PROBLEM Model &quot;a&quot; with data set 27, proportional error &#9474;INCLUDE data27.def &#9474;INCLUDE modela.def &#9474;$ERROR Y=F+F*ERR(1) &#9474;$THETA 1.3 4 &#9474;$OMEGA .04 &#9474;$SIGMA 1 &#9474;$ESTIMATION &#9474;The file data27.def contains the $INPUT and $DATA records. &#9474;The file modela.def contains the $SUBROUTINE record and $PK &#9474;block.">1. What This Chapter is AboutThis chapter tells how to give initial estimates to NONMEM&rsquo;sparameters ($THETA, $OMEGA, $SIGMA records); how to tellNONMEM what tasks to perform ($ESTIMATION, $COVARIANCErecords); and how to tell NONMEM what additional output toproduce ($TABLE, $SCATTERPLOT records).2. Providing Initial Estimates For &theta;: The $THETA RecordThis record provides an initial estimate (and, optionally,provides lower and upper bounds) for every element ofNONMEM&rsquo;s &theta; vector.2.1. Providing Initial Estimates For Elements Of &theta;The $THETA record contains a list of values, separated byspaces or commas, which are the initial estimates for the&theta;&rsquo;s used in the $PK and $ERROR statements. The position ofa value in the list corresponds to its position (subscript)in the &theta; vector. For example, consider the followingstatement:$THETA 1.7 .102 29.This says that the initial estimate for &theta;1 is 1.7, theinitial estimate for &theta;2 is .102, and the initial estimatefor &theta;3 is 29. Some users of NONMEM prefer to code eachvalue on a separate line so that they can include commentsto themselves describing the significance of the &theta;&rsquo;s. Theabove record could have been coded as follows:$THETA 1.7 ; RATE CONSTANT OF ABSORPTION.102 ; RATE CONSTANT OF ELIMINATION19. ; VOLUME OF DISTRIBUTIONThis is a matter of style.2.2. Providing Constraints for Elements of &theta;When NONMEM is told to estimate the parameters (Section 4.1,the Estimation Step, below), it varies the elements of &theta; tofind values which cause the model to fit the observationsbest. The values on the $THETA record are the initialestimates of &theta; for this search. When only an initialestimate is provided, NONMEM is free to chose any positiveor negative value for that element of &theta;. We then say thatthe &theta; element is unconstrained, which means that its lowerbound (lower limit) is &minus;&infin; and its upper bound (upper limit)is +&infin;. When finite bounds are desired, the initial estimateand its bounds must be enclosed in parentheses and specifiedin the order (lower, initial, upper). When the upper boundneedn&rsquo;t be finite, the initial estimate and its lower boundare enclosed in parentheses and specified in the order(lower, initial). Note that when no estimation isperformed, upper and lower bounds have no effect.In the theophylline example of Chapter 2, for example,negative &theta; values are physiologically impossible. Each &theta;element was given a lower bound of 0, which constrained itto be non-negative:$THETA (0, 1.7) (0, .102) (0, 29.)It is possible to mix constrained and unconstrained &theta;s; thiswas done in Chapter 2, figure 2.12:$THETA (0,.0027) (0,.70) .0018 .5An upper bound of +&infin; may be stated explicitly using thevalue 1000000 or the word INFINITY. Similarly, a lowerbound of &minus;&infin; may be stated explicitly as -1000000 or-INFINITY.2.3. Fixing Elements of &theta;When estimation is performed, it is sometimes desirable tohold one or more elements of &theta; to a constant value. Oneexample is when a full model is reduced to a simpler model,as discussed in Chapter 5, Section 2.1; usually this is doneby holding some &theta; element to 0. In fact, the value 0 maynot be used as an initial estimate for an element of &theta;unless this element is fixed to this value. A &theta; element isheld constant by inserting the word FIXED after the initialestimate. For example, the following statement allows &theta;1and &theta;3 to vary, but holds &theta;2 to the value .102:$THETA 1.7 .102 FIXED 29.Parentheses may be used to make the statement easier toread:$THETA 1.7 (.102 FIXED) 29.If the lower, initial, and upper values for an element of &theta;are identical, the element of &theta; is understood to be fixed,even if the word FIXED does not appear.2.4. How to Obtain Initial Estimates for &theta;When estimating parameters, good initial estimates for &theta; aresometimes important. Poor initial estimates mayoccasionally cause the NONMEM run to take excessive amountsof computer time, to produce parameter estimates that arenot physiologically reasonable, or to fail to produce anyparameter estimates at all. For some drugs and models,initial estimates for &theta; can be obtained from publishedliterature describing prior studies with the drug. For somestudies, very accurate values may have been obtained byprior runs with NONMEM or other regression programs. Highlyaccurate values should be perturbed (modified) by about 10%before being used as initial estimates in a NONMEM run.(Initial estimates that are too close to what may be theactual final estimates will cause problems in a NONMEM run;see Chapter 13.) Sometimes, however, there is littleguidance in choosing initial estimates for some elements of&theta;.One approach with population data, where there is areasonable amount of data for each individual, is asfollows. It is often easier to guess at appropriateparameter values for individual data than for populationdata. So, first estimate each individual&rsquo;s parameter valuesusing only the data from the individual. The mean values ofthe individuals&rsquo; parameter estimates can then be used as theinitial parameter estimates in the population analysis.Results from individual runs can also be used to obtaininitial estimates for elements of &Omega; and &Sigma;; see below.Another approach is simply to let NONMEM find an initialestimate. NONMEM has an automatic strategy for so doing;see Chapter 12, Section 4.4.3. Providing Initial Estimates for &Omega; and &Sigma;: the $OMEGA and$SIGMA RecordsRecall that &Omega; and &Sigma; are variance/covariance matrices for thefollowing random variables:Individual Model&Omega; (OMEGA) for &eta; (Random Intraindividual Variability)Population Model&Omega; (OMEGA) for &eta; (Random Interindividual Variability)&Sigma; (SIGMA) for &epsilon; (Random Intraindividual Variability)In all the examples in this document, &Omega; and &Sigma; are diagonalmatrices, in which covariance elements such as &omega;12 (which iscov(&eta;1,&eta;2)) are assumed to be zero. NONMEM also allows fullvariance/covariance matrices; this is beyond the scope ofthis text, but see Chapter 12, Section 4.1.Initial estimates for the variances must be provided toNONMEM via the $OMEGA and $SIGMA records. Initial estimatesof all model parameters (&theta;, &Omega;, and &Sigma;) must be provided evenif estimation is not requested. $OMEGA and $SIGMA recordseach contain a list of values, separated by spaces orcommas, which are the estimates for the correspondingvariances. As in the $THETA record, the position of a valuein the list corresponds to the position (subscript) of thecorresponding variance (along the diagonal) in the matrix.3.1. $OMEGA Record With Individual DataWith individual data, &eta; variables are used in $ERRORrecords, where they are called either ERR or ETA. Forexample, in the theophylline problem of Chapter 2 (figure2.1) there appear the records:$ERRORY=F+ERR(1)$OMEGA 1.2Here, ERR(1) corresponds to &eta;1, and the initial estimate forits variance is 1.2: i.e., &Omega;11=&omega;1=var(&eta;1)=1.2.3.2. $OMEGA Record With Population DataWith population data, &eta; variables are used in $PKstatements. For example, in the phenobarbital problem ofChapter 2 (figure 2.6) there appear the lines:CL=TVCL+ETA(1)V=TVVD+ETA(2)$OMEGA .0000055, .04The $OMEGA record says that the initial estimate for thevariance of &eta;1 is 5.5x10&minus;6, and of &eta;2 is .04: i.e.,&Omega;11=&omega;1=var(&eta;1)=5.5x10&minus;6 and &Omega;22=&omega;2=var(&eta;2)=.04. Some usersof NONMEM prefer to code each value on a separate line sothat they can include comments:$OMEGA .0000005 ; VARIANCE IN CL.04 ; VARIANCE IN V3.3. The $SIGMA RecordThis record is used only with population data, and issimilar to the $OMEGA record. It gives the initialestimates of the variances of the &epsilon; variables used in the$ERROR statements, where they are called either ERR or EPS.For example, in Figure 2.6, there also appears the records:$ERRORY=F+ERR(1)$SIGMA 25Here, ERR(1) corresponds to &epsilon;1, and the initial estimate forits variance is 25: i.e., &Sigma;11=&sigma;1=var(&epsilon;1)=25.3.4. Fixing Elements of &Omega; or &Sigma;It is sometimes desirable to hold one or more elements of &Omega;or &Sigma; to constant value(s). In the population example ofChapter 2 it is possible to ignore interindividualvariability in CL by fixing &eta;1 to 0&dagger;.<cite>&dagger; One could also re-write the $PK statements to eliminateETA(1) in the model for CL, which also requires that ETA(2)in the model for V be re-numbered as ETA(1). It is easierto modify only $OMEGA. </cite>The variance of an &eta; or &epsilon; variable is held constant byinserting the word FIXED after the initial estimate:$OMEGA 0 FIXED .0225Parentheses may be used to make the statement easier toread:$OMEGA (0 FIXED) .0225As with &theta;, the value 0 may not be used as an initialestimate for any element of &Omega; or &Sigma; unless the element isfixed to this value.3.5. How to Obtain Initial Estimates for &Omega; and &Sigma;The initial estimates for the variances will depend on theparticular (interindividual and/or intraindividual) errormodels chosen. The estimates do not have to be particularlyaccurate, although values which are much too small can causedifficulties for NONMEM. In general, it is better toover-estimate the variances rather than to under-estimatethem. As with initial estimates for &theta;, initial estimatescan sometimes be obtained from published literature or fromprior runs with NONMEM or other regression programs.Initial estimates can also be obtained by an approach whichwe illustrate with examples for both intraindividual andinterindividual error models. The standard deviation of aphysiological quantity is generally some fraction r of itstypical value t: &sigma;y=rt.For the additive model:y=f+&epsilon;&sigma;y=&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=(rt)2=r2t2Some ambiguity exists about what we mean by &quot;the typicalvalue&quot; of y. For the purpose of obtaining an initialestimate of the variance, we need not be too particularabout this. For the theophylline example (Figure 2.1), wemay choose the mean of the observed values as the typicalvalue. This value is approximately 5.4. Assuming 20%error, i.e. r=.2, then &sigma;&epsilon;=(.2x5.4)2=1.2. Similarly, in thefirst phenobarbital example (Figure 2.6), the mean of theobservations is approximately 25. Again assuming 20% error,then r=.2, and &sigma;&epsilon;=(.2x25)2=25. For that same example, thetypical value of CL was estimated according to the model forthe parameter: TVCL=THETA(1). We used the initial estimateof &theta;1, .0047, as the typical value of CL, and assumed 50%error: &Omega;11=(.5x.0047)2=5.5x10&minus;6. The model for V isTVVD=THETA(2). Again, we used the initial estimate of &theta;2,.99, as the typical value of V, but assumed 20% error:&Omega;22=(.2x.99)2=.04. Note finally that in the secondphenobarbital example (Figure 2.12), we used as initialestimates of variance the final estimates obtained from thefirst example (understanding that these estimates could besomewhat large due to some of the variability beingexplained in this example by a systematic influence ofweight).For the constant coefficient of variation model:y=f+f&epsilon;&sigma;y=f&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=r2ft22If we identify t with the value of f (whatever it may be),we have: var&epsilon;=r2In other words, using the CCV model, we do not need toestimate the typical value of the variable. For example,assuming 20% error, var&epsilon;=.22=.04.As with &theta;, it is possible for NONMEM itself to obtaininitial estimates of &Omega; and &Sigma; automatically; see Chapter 12,Section 4.4.4. Specifying Optional TasksTwo main tasks of NONMEM, the Estimation Step and theCovariance Step, are optional and must be specificallyrequested by including the $ESTIMATION and $COVARIANCErecords. To skip the Estimation Step, simply omit the$ESTIMATION record. To skip the Covariance Step, simplyomit the $COVARIANCE record.In every run NONMEM computes and prints the value of theobjective function and the final parameter estimates. Thevalues printed are based on the final parameter estimates ifthe Estimation Step is requested, and are based on theinitial estimates if it is not.4.1. Requesting the Estimation Step: the $ESTIMATION RecordIn the Estimation Step, NONMEM performs a search to obtainthose values of &theta;, &Omega;, and (for population studies) &Sigma; whichgive the lowest value of the objective function. The outputof this step is the pages whose titles are &quot;MONITORING OFSEARCH:&quot;, &quot;MINIMUM VALUE OF OBJECTIVE FUNCTION&quot;, and &quot;FINALPARAMETER ESTIMATE&quot;. This step is requested by the presenceof the following statement:$ESTIMATIONThere are several options, which are described in the NONMEMUsers Guide, Part IV. The most frequently used ones are asfollows.METHOD=0NONMEM always sets etas to 0 during the computation of &#9474;the objective function. Also called the &quot;first order &#9474;(FO) method.&quot; This is the default. It may also be &#9474;coded as METHOD=ZERO. &#9474;METHOD=1 &#9474;NONMEM uses conditional estimates for the etas during &#9474;the computation of the objective function. &#9474;METHOD=1 is also called the &quot;first order &#9474;conditional estimation (FOCE) method.&quot; It may also be &#9474;coded as METHOD=CONDITIONAL. When the option &#9474;INTERACTION is also present, the method is called the &#9474;&quot;FOCE with INTERACTION method&quot;. It is recommended for &#9474;continuous variables unless the data are very sparse. &#9474;These methods are discussed in Guide VII, Conditional &#9474;Estimation Methods.SIGDIGITS=nBy default, the search continues until the estimates ofall elements of &theta;, &Omega;, and &Sigma; have been determined to atleast 3 significant figures. Because only 3significant digits are used to print parameterestimates in the output, and for other reasons as well,this amount of accuracy is often sufficient. However,the SIGDIGITS option can be used to request a differentnumber (n) of significant digits.MAXEVAL=nThe Estimation Step always runs with a specific limiton the number of objective function evaluations allowedduring the search, as a protection against infiniteloops and excessively long runs. The default maximumis computed according to the number of parameters beingestimated. The MAXEVALS option can be used to requesta different number (n) for the maximum number offunction evaluations.PRINT=nAs the Estimation Step progresses, by default it printsintermediate output summarizing the progress of thesearch. The search proceeds in stages, callediterations. At the end of certain iterations asummarization is printed which consists of the valuesof the objective function, its gradient vector withrespect to the parameters, and the parameter valuesthemselves. By default, this summarization is onlyprinted for the first and last iterations. The PRINToption can be used to request a number (n) such thatstarting from the first iteration, only n-1 iterationsare skipped before another summarization is printed&dagger;.<cite>&dagger; The PRINT option can also be used to suppressintermediate printout altogether, but this shouldusually not be done because the information is often ofvalue. See Chapter 10, Section 4. </cite>An example of the use of these options is:$EST SIG=6,MAX=900,PRI=5In addition to the first and last iterations, summarizationsare printed every 5th iteration. Notice that abbreviationsof the record and option names were used; this is a matterof style.4.2. Requesting the Covariance Step: the $COVARIANCE RecordIn the Covariance Step, NONMEM obtains information on theprecision of the parameter estimates obtained in theEstimation Step. The output of this step are pages withtitles &quot;STANDARD ERROR OF ESTIMATE&quot;, &quot;COVARIANCE MATRIX OFESTIMATE&quot;, &quot;CORRELATION MATRIX OF ESTIMATE&quot;, and &quot;INVERSECOVARIANCE MATRIX OF ESTIMATE&quot;. This step is requested bythe presence of the following record:$COVARIANCEThere are several options, which are discussed in NONMEMUsers Guide, Part IV. The Covariance Step cannot berequested by itself; the Estimation Step must precede it&Dagger;.<cite>&Dagger; The Estimation Step may be omitted when the run iscontinued from a prior run using a Model Specification inputfile; see Chapter 12, Section 4.3, and Chapter 13, Section3.2. </cite>5. Specifying Optional Output$TABLE and $SCATTERPLOT records are used to request NONMEMsteps which generate additional output. If one of theserecords is omitted, NONMEM does not produce thecorresponding additional output. Tables and scatterplotsare generated after all other tasks have been performed.This affects the values displayed for PRED, RES, and WRES.If the Estimation Step is not run, then the initialestimates of the parameters are used to compute thesequantities. If the Estimation Step is run, then the finalparameter estimates are used. Residuals (RES) and weightedresiduals (WRES) are defined in Chapter 11, Section 4.4.2.The UNCONDITIONAL option of the $TABLE and $SCATTERPLOTrecords requests that output of this type be generated evenif the Estimation Step terminates unsuccessfully, and is thedefault. The CONDITIONAL option of these records requeststhat output of this type be generated only if the EstimationStep terminates successfully.5.1. Requesting the Table Step: the $TABLE RecordThe values of DV, PRED, RES, and WRES are always printed inevery table. Other data items to be printed should belisted on the record. The data items are printed in theorder in which they are listed. This does not have to bethe same order as in the data file, nor does every data itemhave to be listed. For example, the following recordappears in Chapter 2, figure 2.12:$TABLE ID TIME AMT WT APGRFigure 10.10 in Chapter 10 shows a portion of the resultingoutput.It is possible for the lines of a table to be sorted into adifferent order than that of the original input file; thisis discussed in the NONMEM Users Guide, Part IV.More than one table can be printed. A separate $TABLErecord is used to request each one.5.2. Requesting Scatterplots: the $SCATTERPLOT RecordChapter 2 contained many examples of $SCATTERPLOT recordsand the resulting output. Here, for example, are therecords from figure 2.6:$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS WTThe word UNIT requests a unit-slope line, which is the linePRED=DV. Figures 2.10 and 2.11 show the resulting output.Similarly, the word ORD0 can be used to request a zero lineon the ordinate axis.It is possible to generate several scatterplots with asingle record, by using a list of data item names:$SCATTERPLOT (PRED,RES,WRES) VS WTThis produces three scatterplots, and has the same effect asthe three records:$SCATTERPLOT PRED VS WT$SCATTERPLOT RES VS WT$SCATTERPLOT WRES VS WTSometimes it is desirable to partition a scatterplot into anumber of separate scatterplots. For example, if the datacontain both plasma and urine observations, it would bebetter to separate the scatterplot of PRED vs. DV into onescatterplot where the DV values are the plasma observations,and another one where the DV values are the urineobservations. To do this, it is necessary to specify apartitioning data item, in this case, the CMT data item,which gives the compartment number of the observation. Thefollowing record could be used.$SCATTERPLOT PRED VS DV BY CMT UNITThis will produce separate scatterplots: one with plasmaobservations (CMT=1 if ADVAN1 is used), and one with urineobservations (CMT=2 if ADVAN1 is used).Two partitioning items can also be specified:$SCATTERPLOT PRED VS DV BY CMT SEX UNITOne scatterplot is produced for each unique combination ofvalues of the two partitioning data items.6. Placement and Order of RecordsTwo main rules control the placement and order of recordswithin a NM-TRAN control file:The $INPUT record must appear before any records whichcontain data item names ($PK, $ERROR, $TABLE,$SCATTERPLOT)The $SUBROUTINE, $PK, and $ERROR records should appearin the indicated order, but do not have to beconsecutive.The records $DATA, $THETA, $OMEGA, $SIGMA, $ESTIMATION,$COVARIANCE, $TABLE, and $SCATTERPLOT can be placed anywhereamong the control records, in any order. However, NONMEMalways performs its tasks in a fixed order:Estimation StepCovariance StepTable StepScatterplot StepThus, even if the $TABLE record precedes the $ESTIMATIONrecord, the values of PRED, RES, and WRES in the table willbe based on the final parameter estimates. &#9474;7. INCLUDE records &#9474;One or more records of the form &#9474;INCLUDE filename n &#9474;may appear anywhere among the NM-TRAN control records. The &#9474;characters INCLUDE may be upper- or lower-case. &quot;n&quot; is an &#9474;optional integer, and gives the number of copies (default is &#9474;1). &#9474;NMTRAN opens the named file and reads it to end-of-file. &#9474;The contents of the named file may be any portion of an &#9474;NM-TRAN control stream, e.g., NM-TRAN control records and/or &#9474;abbreviated code. After reaching end-of-file, if the &#9474;number of copies is greater than 1, NM-TRAN rewinds the &#9474;file and re-reads it the specified number of times. After &#9474;reaching end-of-file on the final (or only) copy, NMTRAN &#9474;resumes reading the original control stream after the &#9474;include record. &#9474;There may be more than one INCLUDE record, but they may not &#9474;be nested. That is, an included file may not contain &#9474;INCLUDE records. &#9474;For example, &#9474;$PROBLEM Model &quot;a&quot; with data set 27, proportional error &#9474;INCLUDE data27.def &#9474;INCLUDE modela.def &#9474;$ERROR Y=F+F*ERR(1) &#9474;$THETA 1.3 4 &#9474;$OMEGA .04 &#9474;$SIGMA 1 &#9474;$ESTIMATION &#9474;The file data27.def contains the $INPUT and $DATA records. &#9474;The file modela.def contains the $SUBROUTINE record and $PK &#9474;block.</a><br>
<a href="#1. What This Chapter is AboutThis chapter describes NONMEM&rsquo;s output in detail. Each pageof a NONMEM-PREDPP output file is shown and discussed.The input file to NM-TRAN is that of figure 2.12, which isreproduced here as figure 10.1 for convenience.1 $PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V2 $INPUT ID TIME AMT WT APGR DV3 $DATA INDATA4 $SUBROUTINE ADVAN15 $PK6 TVCL=THETA(1)+THETA(3)*WT7 CL=TVCL+ETA(1)8 TVVD=THETA(2)+THETA(4)*WT9 V=TVVD+ETA(2)10 ; THE FOLLOWING ARE REQUIRED BY PREDPP11 K=CL/V12 S1=V13 $ERROR14 Y=F+ERR(1)15 $THETA (0,.0027) (0,.70) .0018 .516 $OMEGA .000007, .317 $SIGMA 818 $ESTIMATION PRINT=519 $COVARIANCE20 $TABLE ID TIME AMT WT APGR DV21 $SCATTER PRED VS DV UNIT22 $SCATTER RES VS WTFigure 10.1. The NM-TRAN input file (same as figure 2.12).The line numbers on the left are not actually part of thefile.2. NONMEM Describes its InputsThe first page of NONMEM&rsquo;s output is shown in figure 10.2.In this page, NONMEM repeats (&quot;echos&quot;) the instructions itwas given in the control file and describes the data file.The first page of the output should be checked carefully.Problems in a NONMEM run can often be traced to errors inthe problem specification. For example, always check thatthe initial parameter estimates were entered correctly.1 NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) DOUBLE PRECISION NONMEM VERSION IV LEVEL 1.02 DEVELOPED AND PROGRAMMED BY STUART BEAL AND LEWIS SHEINER34 PROBLEM NO. 15 PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V67 DATA CHECKOUT RUN: NO8 DATA SET LOCATED ON UNIT NO.: 29 THIS UNIT TO BE REWOUND: NO10 NO. OF DATA RECS IN DATA SET: 74411 NO. OF DATA ITEMS IN DATA SET: 812 ID DATA ITEM IS DATA ITEM NO.: 113 DEP VARIABLE IS DATA ITEM NO.: 614 MDV DATA ITEM IS DATA ITEM NO.: 81516 INDICES PASSED TO SUBROUTINE PRED ARE:17 7 2 3 0 0 0 0 0 018 0 01920 LABELS FOR DATA ITEMS ARE:21 ID TIME AMT WT APGR DV EVID MDV2223 FORMAT FOR DATA IS:24 (6E6.0,2F2.0)2526 TOT. NO. OF OBS RECS: 15527 TOT. NO. OF INDIVIDUALS: 592829 LENGTH OF THETA: 43031 OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 23233 SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 13435 INITIAL ESTIMATE OF THETA:36 LOWER BOUND INITIAL EST UPPER BOUND37 0.0000E+00 0.2700E-02 0.1000E+0738 0.0000E+00 0.7000E+00 0.1000E+0739 -0.1000E+07 0.1800E-02 0.1000E+0740 -0.1000E+07 0.5000E+00 0.1000E+074142 INITIAL ESTIMATE OF OMEGA:43 0.7000E-0544 0.0000E+00 0.3000E+004546 INITIAL ESTIMATE OF SIGMA:47 0.8000E+014849 ESTIMATION STEP OMITTED: NO50 NO. OF FUNCT. EVALS. ALLOWED: 36051 NO. OF SIG. FIGURES REQUIRED: 352 INTERMEDIATE PRINTOUT: YES53 MSF OUTPUT: NO5455 COVARIANCE STEP OMITTED: NO56 EIGENVLS. PRINTED: NO57 SPECIAL COMPUTATION: NO5859 TABLES STEP OMITTED: NO60 NO. OF TABLES: 161 TABLES PRINTED: YES6263 USER-CHOSEN DATA ITEMS FOR TABLE 1,64 IN THE ORDER THEY WILL APPEAR IN THE TABLE, ARE:65 ID TIME AMT WT APGR6667 SCATTERPLOT STEP OMITTED: NO68 NO. OF PAIRS OF ITEMS GENERATING69 FAMILIES OF SCATTERPLOTS: 27071 ITEMS TO BE SCATTERED ARE: DV PRED72 UNIT SLOPE LINE INCLUDED73 ITEMS TO BE SCATTERED ARE: WT RESFigure 10.2. The first page of the output report. The linenumbers on the left are not actually part of the report.Line 5 is an identification line for the output report. Thecontents of the $PROBLEM record are shown here.Line 7 indicates that this is not a data checkout run. (Datacheckout mode is discussed in Chapter 12 Section 4.10.)Lines 8 through 27 describe the input data file. Lines 10and 11 describe the numbers of rows and columns in the inputfile, as shown in figure 6.1. Specifically, line 10 showshow many data records were read according to the FORTRANformat specification given in line 24. Line 11 describesthe number of data items per record, which is the number ofdata items listed in the $INPUT record, less any that weredropped by the Data Preprocessor, plus any that it added(see Chapter 6). Lines 12, 13, and 14 describe thelocations of those data items of interest to NONMEM itself(i.e. NONMEM data items). Lines 16 through 18 are discussedin Section 3. Line 21 gives the labels for all the dataitems. The first six labels are those of the data itemsspecified in the $INPUT record and the next two (EVID, MDV)are those of two data items added to the data set by theData Preprocessor. (NONMEM itself supplies labels PRED,RES, and WRES for the prediction, residual, and weightedresidual data items.) In the terminology of Chapter 4 (e.g.(4.15a)), ID, TIME, AMT, WT, and APGR are the elements of x;DV is y; PRED is f (evaluated for the typical individual inthe population). Line 24 shows the format used to read eachdata record. In this example, the format was generated bythe Data Preprocessor and describes the data file afterprocessing by the Data Preprocessor.&dagger;<cite>&dagger; When a format specification is supplied on the $DATArecord, and no data items are dropped or added by the DataPreprocessor, the original format specification is usedunchanged and appears here. </cite>Line 26 gives the number of observation records. Line 27gives the number of individual records; that is, one lessthan the number of times that the ID data item changedvalue.Lines 29 through 47 describe the contents of the $THETA,$OMEGA and $SIGMA records. First, the number of elements of&theta;, &Omega; and &Sigma; are given (lines 29, 31 and 33), then theirinitial estimates are displayed. In lines 38-41, notice thevalues 0.1000e+07 and -0.1000e+07. These are NONMEM&rsquo;s wayof expressing the values +&infin; and &minus;&infin;; i.e., of describing &theta;swhich are unbounded on one or both sides. Another FORTRANsystem may display these numbers differently (e.g.,1.0000e+06), but the absolute value will always be1,000,000. In lines 43 and 44, notice that the variancesfrom the $OMEGA record appear along the diagonal of the &Omega;matrix, and that the off-diagonal element cov(&eta;1,&eta;2) iszero. Line 31 states that NONMEM understands &Omega; to bediagonal; the off-diagonal element(s) are automaticallyfixed at zero.The remaining lines of figure 10.2 describe the tasks thatNONMEM will perform. Lines 49 through 53 describe the$ESTIMATION record. Lines 50 through 53 show the defaults(set by NM-TRAN) for various options, all of which couldhave been specified explicitly on the $ESTIMATION record.In line 50 for example, NONMEM displays the maximum numberof times it will evaluate the objective function during theEstimation Step (this number can be slightly exceeded). Thevalue 360 was supplied by NM-TRAN. It is a function of thesizes of &theta;, &Omega;, and &Sigma;. Line 51 displays the desired numberof significant digits in the final parameter estimate; thevalue 3 is the default number requested by NM-TRAN.Lines 55 through 59 describe the $COVARIANCE record, givingthe default options chosen by NM-TRAN.Lines 59 through 61 describe the $TABLE record. Lines 67through 73 describe the $SCATTERPLOT records.3. PREDPP Describes Its InputsThe next two pages are produced by PREDPP and will notappear if $PRED statements (or a user-written PREDsubroutine) are used. PREDPP uses these pages to repeat(&quot;echo&quot;) the instructions it was given in the control file,and to identify the ADVAN and TRANS routines chosen by theuser. The first page of PREDPP&rsquo;s output is shown in figure10.3. 1 DOUBLE PRECISION PRED VERSION III LEVEL 1.023 ONE COMPARTMENT MODEL (ADVAN1)45 MAXIMUM NO. OF BASIC PK PARAMETERS: 267 BASIC PK PARAMETERS (AFTER TRANSLATION):8 ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 191011 COMPARTMENT ATTRIBUTES12 COMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULT13 STATUS ALLOWED ALLOWED FOR DOSE FOR OBS.14 1 CENTRAL ON NO YES YES YES15 2 OUTPUT OFF YES NO NO NOFigure 10.3. The first page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.In its first page of output, PREDPP describes the featuresof the pharmacokinetic model and its parameterizationencoded into the ADVAN and TRANS routines specified on the$SUBROUTINE record. The information displayed here includesthe kind of information summarized in Appendices 1 and 2.In the particular output of Figure 10.3 no informationconcerning an alternate parameterization appears becauseTRANS1 was specified. The information concerning basicparameters and compartments is displayed in a format similarto that used in NONMEM Users Guide, Part VI, which is thecomplete reference for PREDPP.Lines 5 and 8 describe the basic PK parameters, which inthis example is the single microconstant K. If a translatorother than TRANS1 had been requested, an additional linewould appear describing the translation. E.g., with TRANS2,this line would read:TRANSLATOR WILL CONVERT PARAMETERS CLEARANCE (CL) AND VOLUME(V) to KLines 10 through 14 describe the compartment attributes.Even though the output compartment is never turned on by thedata of this example, its attributes are described herebecause it is part of the model.The information presented so far describes the model forcomputing drug amounts. For a given choice of ADVAN andTRANS, the contents of this page are completely fixed.PREDPP&rsquo;s second page of output describes user choicesrelated to the given ADVAN routine, including choices forthe scale parameters (and thus, to the model for computingconcentrations). This page is shown in figure 10.4.1 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG2 COMPT. NO. INDICES3 SCALE BIOAVAIL. ZERO-ORDER ZERO-ORDER ABSORB4 FRACTION RATE DURATION LAG5 1 3 * * * *6 2 * - - - -7 - PARAMETER IS NOT ALLOWED FOR THIS MODEL8 * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;9 WILL DEFAULT TO ONE IF APPLICABLE1011 DATA ITEM INDICES USED BY PRED ARE:12 EVENT ID DATA ITEM IS DATA ITEM NO.: 713 TIME DATA ITEM IS DATA ITEM NO.: 214 DOSE AMOUNT DATA ITEM IS DATA ITEM NO.: 3151617 PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.18 PK SUBROUTINE NOT CALLED AT ADDITIONAL DOSE OR LAGGED DOSE TIMES.1920 DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.21 OTHERWISE, ERROR SUBROUTINE CALLED ONCE IN THIS PROBLEM.Figure 10.4. The second page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.Lines 2 through 9 describe the additional PK parameters thatare computed by the $PK statements (or PK subroutine). Inline 5, the position marked with &quot;3&quot; corresponds to thescale parameter for compartment number 1. Thus, we knowthat the $PK statements contained an assignment statementfor S1. From the prior page we can see that compartmentnumber 1 is the central compartment. The value &quot;3&quot; is a rownumber within GG, an array used for communication betweenPREDPP and the PK subroutine. With the use of NM-TRAN and$PK statements, row numbers are of no interest to the user.With a user-written PK subroutine, it is important to checktheir correctness. Positions marked with &quot;*&quot; correspond toadditional PK parameters that are allowed by the model butthat are not assigned a value by $PK statements; an exampleis F1, the bioavailability fraction for compartment 1.Positions marked with &quot;-&quot; correspond to additionalparameters that may not be computed; for instance,dose-related parameters are not allowed for the outputcompartment, because (as shown on the preceding page) thiscompartment cannot receive doses.Lines 11 through 14 describe the locations in the input datarecord of those data items of interest to PREDPP (PREDPPdata items). (NM-TRAN causes the locations of these dataitems in the data set to be passed by NONMEM to PREDPP, asindicated in lines 15 through 17 of figure 10.2. NONMEM isnot concerned with the significance of these data items.)Note that data item 7, Event ID, was appended by the DataPreprocessor.Line 17 reflects the fact that, by default, $PK statementsare evaluated with every event record&dagger;. Lagged andadditional doses are discussed in Chapter 12, Sections 2.4and 2.5. They are not used in this example.<cite>&dagger; In this example, the $PK statements (lines 5 through 12 ofthe input file, figure 10.1) involve only WT, which isconstant for each individual. It is possible to limit theevent records with which the $PK statements are evaluated tothe first event record of each individual, in order toreduce run time. This decision is left to the user. </cite> &#9474;Line 21 reflects the fact that the $ERROR statementsdescribe the simple error model (3.4). This model uses nodata items and no elements of &theta; whatsoever (directly orindirectly). NM-TRAN has instructed PREDPP that the $ERRORstatements need be evaluated only once at the beginning ofthe problem. Line 20 indicates that, should the SimulationStep be implemented, PREDPP will disregard this limitationand evaluate the $ERROR statements with every event record,so that randomly-generated values of intra-individual errorcan be applied at every observation event. (This exampledoes not involve simulation, but the PK and ERROR routineswhich implement the $PK and $ERROR statements are capable ofsupporting all NONMEM tasks, including simulation.)Finally, note that the $PK and $ERROR models (figure 10.1,lines 5-14) are not documented in the NONMEM-PREDPP output.It is a good idea to attach a printed copy of the NM-TRANinput records to the corresponding NONMEM output. MS/DOS &#9474;batch file nmfe72.bat and Unix C-shell script nmfe72 &#9474;(supplied with NONMEM) do this automatically.4. Diagnostic Output from the Estimation StepThe next page of output, figure 10.5, is produced during therunning of the Estimation Step.1 MONITORING OF SEARCH:234 ITERATION NO.: 0 OBJECTIVE VALUE: 0.6757E+03 NO. OF FUNC. EVALS.: 85 CUMULATIVE NO. OF FUNC. EVALS.: 86 PARAMETER: 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+007 GRADIENT: -0.7986E+03 -0.1594E+04 -0.4294E+03 -0.1000E+04 0.1542E+03 0.5269E+03 0.9128E+0289 ITERATION NO.: 5 OBJECTIVE VALUE: 0.6502E+03 NO. OF FUNC. EVALS.:1010 CUMULATIVE NO. OF FUNC. EVALS.: 5811 PARAMETER: 0.8878E-01 0.1003E+00 0.2055E+00 0.1296E+00 0.6695E-01 0.7822E-01 0.1071E+0012 GRADIENT: 0.1060E+04 0.2567E+04 0.3675E+03 0.8472E+03 -0.1807E+03 -0.5093E+03 0.9841E+021314 ITERATION NO.: 10 OBJECTIVE VALUE: 0.6153E+03 NO. OF FUNC. EVALS.: 915 CUMULATIVE NO. OF FUNC. EVALS.: 10716 PARAMETER: 0.5008E-01 0.6626E-01 0.2425E+00 0.1663E+00 -0.6718E-01 0.6382E-01 0.1004E+0017 GRADIENT: 0.9732E+02 0.3034E+03 0.3185E+02 0.1228E+03 -0.1162E+03 0.1252E+03 0.6450E+021819 ITERATION NO.: 15 OBJECTIVE VALUE: 0.6108E+03 NO. OF FUNC. EVALS.: 920 CUMULATIVE NO. OF FUNC. EVALS.: 15221 PARAMETER: 0.4235E-01 0.4508E-01 0.2462E+00 0.1831E+00 -0.5721E-01 0.5237E-01 0.1008E+0022 GRADIENT: 0.3989E+02 0.7394E+02 -0.1782E+01 0.8527E+02 -0.9309E+02 0.1867E+02 -0.1773E+022324 ITERATION NO.: 20 OBJECTIVE VALUE: 0.6095E+03 NO. OF FUNC. EVALS.: 925 CUMULATIVE NO. OF FUNC. EVALS.: 19726 PARAMETER: 0.1927E-01 0.3153E-01 0.2615E+00 0.1898E+00 -0.4458E-01 0.4904E-01 0.1047E+0027 GRADIENT: 0.1609E+02 -0.3621E+02 0.5228E+01 0.9614E+00 -0.1740E+02 0.1329E+02 0.3111E+012829 ITERATION NO.: 25 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 930 CUMULATIVE NO. OF FUNC. EVALS.: 24231 PARAMETER: 0.2389E-02 0.4171E-01 0.2652E+00 0.1833E+00 -0.4413E-01 0.4998E-01 0.1043E+0032 GRADIENT: 0.2273E+01 -0.5333E+01 0.3914E+01 -0.5397E+01 0.1271E+01 0.2610E+01 0.3584E+003334 ITERATION NO.: 30 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.:1635 CUMULATIVE NO. OF FUNC. EVALS.: 29936 PARAMETER: -0.1278E-03 0.4166E-01 0.2650E+00 0.1835E+00 -0.4414E-01 0.5003E-01 0.1043E+0037 GRADIENT: -0.1120E+00 -0.9411E+00 -0.3719E+00 -0.2540E+01 -0.5135E-01 0.1420E+00 -0.9524E-013839 ITERATION NO.: 32 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 040 CUMULATIVE NO. OF FUNC. EVALS.: 31541 PARAMETER: -0.7284E-05 0.4150E-01 0.2650E+00 0.1836E+00 -0.4411E-01 0.5003E-01 0.1043E+0042 GRADIENT: -0.6416E-02 0.9336E-01 0.4548E-01 0.4826E-01 0.1263E-02 0.9652E-01 0.4629E-014344 MINIMIZATION SUCCESSFUL45 NO. OF FUNCTION EVALUATIONS USED: 31546 NO. OF SIG. DIGITS IN FINAL EST.: 3.9Figure 10.5. The output from the Estimation Step. The linenumbers on the left are not actually part of the report.4.1. Intermediate Output from the Estimation StepLines 1 through 42 are referred to as the intermediateoutput. Lines 4 through 7 give numbers summarizing the 0-thiteration, which are based on the initial parameterestimates. Line 4 shows the initial value of the objectivefunction. The value following &quot;NO. OF FUNC. EVALS.&quot; is thenumber of objective function evaluations which were neededduring the iteration. Line 5 gives the cumulative number offunction evaluations including this and all prior iterationsummaries.Line 6 gives the unconstraine_____________ paramete_________ (UCP_____ estimates. &#9474;The search is carried out in a different parameter space. &#9474;The parameters are transformed to unconstrained parameters &#9474;(UCP). In the transformation process a scaling occurs so &#9474;that the initial estimate of each of the UCP is 0.1.Thus, in line 6, all parameters are .1 at the 0-thiteration. Parameters are printed in the following order:elements of &theta;, elements of &Omega;, elements of &Sigma;. In thisexample, reading from left to right, the parameters are &theta;1,&theta;2, &theta;3, &theta;4, &Omega;11, &Omega;22, and &Sigma;11.Two points should be noted. First, fixed parameters do notappear in the list. Therefore, the off-diagonal element&Omega;12, which is effectively fixed to 0, does not appear.Second, when off-diagonal elements of &Omega; are being estimated,then as many additional UCP&rsquo;s appear as there areoff-diagonal elements of &Omega; being estimated. However, a 1-1correspondence between each of the elements of &Omega; and an UCPdoes not exist. The same is true for elements of &Sigma; and theUCP&rsquo;s for &Sigma; when off-diagonal elements of &Sigma; are estimated. &#9474;With NONMEM 7, the parameter estimates are also &#9474;displayed in their natural (unscaled) space. These lines &#9474;are identified as NPARAMETR and precede the PARAMETER &#9474;lines, which display the UCP values.Line 7 shows the gradient for each parameter, which may bethought of as the partial derivative of the objectivefunction with respect to that parameter.The Estimation Step proceeds in a series of stages callediterations. In this example, intermediate printout isproduced for each of every 5 iterations, as well as for the0-th and final iterations, for which intermediate printoutis always printed by default. This printout consists of thesame four lines as for the 0-th iteration, but using theparameters estimates obtained at the end of the iteration.In lines 4, 9, 14, 19, 24, 29, 34, and 39, observe that theobjective function drops quickly at first, and then moreslowly. After iteration number 25, there is no change abovethe fourth significant digit.In lines 6, 11, 16, 21, 26, 31, 36, and 41, observe thateach parameter also changes rapidly at first and then moreslowly as it converges to its final value. (The firstparameter, &theta;1, is an exception. It is clearly approaching avery small value close to its lower bound, 0. In Chapter12, we shall see that both &theta;1 and &theta;2 are best fixed at 0.)Finally, in lines 7, 12, 17, 22, 27, 32, 37, and 42, observethat the gradients also approach 0, another sign that aminimum of the objective function has been located.The values computed for the gradients are very sensitive todifferences in computer arithmetic and precision. If agiven NONMEM run is repeated on a different computer, or onthe same computer with different machine precision or adifferent FORTRAN compiler, it is likely that the gradientswill be different. This will cause the search to follow adifferent path to the minimum, so that lines 4 through 42may be quite different. However, each final estimate of aUCP should always be the same to the number of requestedsignificant digits. (Minor differences may also be observedin the output of the Covariance Step, below; this output isalso sensitive to computational differences.)4.2. Summary Output from the Estimation StepLines 44, 45 and 46 are always printed, even whenintermediate printout is suppressed. Line 44, &quot;MINIMIZATIONSUCCESSFUL&quot;, signifies that the search appears to havelocated a minimum of the objective function. Before one canbe certain that a minimum has been located, or one whichcorresponds to a reasonable parameter estimate (there can bea number of &quot;local minima&quot;), the final parameter estimatesmust be examined in their (untransformed) state; see Section5 below. The Estimation Step is not always successful.Chapter 13 discusses two other messages that sometimesappear instead of line 44.In line 45, note that the number of function evaluationsused, 315, is a total value and includes all iterations (notjust those for which intermediate printout was displayed).This is under the limit of 360 supplied by NM-TRAN (figure10.2, line 57).The number of significant digits in the final estimate isgiven in line 34 as 3.9. This can be interpreted as meaningthat no (transformed) parameter estimate is actuallydetermined to less than 3.9 significant digits. Morespecifically, when the UCP estimates were compared betweenthe last two iterations, none differed in the first (almost)4 significant figures including leading zeros after thedecimal point. Note that the final &theta;1 UCP estimate is-0.7284E-05, and so the 7284 are not significant digits atall! Because NONMEM displays only 3 significant digits inthe printed parameter estimates, and for other reasons aswell, by default NM-TRAN requests only 3 significant digits.However, more significance can be requested, as wasdiscussed in Chapter 9, Section 4.1. &#9474;5. Minimum Value of the Objective Function and Final &#9474;Parameter EstimatesThe next two pages in the NONMEM output are produced whetheror not the Estimation Step was implemented and, if it was,whether or not the search terminated successfully. Theygive the values of the objective function and the parameterestimates, using the final parameter estimates if theEstimation Step was implemented (whether or not the searchterminated successfully), and using the initial parameterestimates otherwise. These pages have already been shown inChapter 2, figure 2.13. Even when the minimization routineis successful in locating a minimum of the objectivefunction, the final (untransformed) parameter estimates mustbe carefully checked. Is any parameter&rsquo;s final estimatephysiologically unreasonable? Is any parameter&rsquo;s finalestimate near its upper or lower constraint? If eitheranswer is yes, the model, the constraints on &theta;&rsquo;s, or thedata may be incorrect; see Chapter 11.Sometimes the final estimates do not match anticipatedvalues, e.g., values obtained by some other system ofanalysis. Additional refinement of the model may be needed,as discussed in Chapter 11. However, the discrepancy maywell be traceable to an error in model specification, suchas an error in specifying a compartment&rsquo;s scale. Along withthe Estimation Step, it is important to obtain a scatterplotof PRED vs DV and make sure the unit slope line is visible.See Chapter 13, Section 4.4.6. Output from the Covariance StepFigures 10.6 through 10.7 show the output of the CovarianceStep, which was requested via the $COVARIANCE record.Figure 10.6 has already been displayed as figure 2.14, butis included here for completeness. This page displays thestandard errors of the parameter estimates. Standard errorsare discussed extensively in Chapters 5 and 11. A detaileddiscussion of the remaining three pages, containing thecovariance, correlation, and inverse covariance matrices, isbeyond the scope of this text. Note, however, the use ofthe notation &quot;........&quot;. Each sequence of dots denotes avalue (such as the standard error in the estimate of &Omega;12)that is 0 by definition, rather than due to a computation.1 ************************************************************************************************************************2 ******************** ********************3 ******************** STANDARD ERROR OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************6789 THETA - VECTOR OF FIXED EFFECTS *********************101112 TH 1 TH 2 TH 3 TH 41314 9.49E-11 1.46E-01 2.24E-04 1.13E-0115161718 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********192021 ETA1 ETA22223 ETA1 7.24E-072425 ETA2 ......... 3.63E-0226272829 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****303132 EPS13334 EPS1 1.71E+00Figure 10.6. Standard error of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 9.02E-211112 TH 2 3.93E-12 2.14E-021314 TH 3 -5.23E-15 -1.45E-05 5.00E-081516 TH 4 -3.69E-12 -1.57E-02 1.04E-05 1.27E-021718 OM11 -1.11E-17 2.13E-08 -6.39E-12 -1.52E-08 5.24E-131920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.79E-14 4.40E-04 -5.30E-07 5.58E-04 6.27E-10 ......... 1.32E-032324 SG11 1.04E-11 -5.69E-02 1.12E-04 4.45E-02 -3.74E-07 ......... -1.03E-02 2.92E+00Figure 10.7. Covariance matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** CORRELATION MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.00E+001112 TH 2 2.83E-01 1.00E+001314 TH 3 -2.46E-01 -4.44E-01 1.00E+001516 TH 4 -3.45E-01 -9.53E-01 4.13E-01 1.00E+001718 OM11 -1.61E-01 2.01E-01 -3.95E-02 -1.86E-01 1.00E+001920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -5.21E-03 8.29E-02 -6.53E-02 1.37E-01 2.39E-02 ......... 1.00E+002324 SG11 6.44E-02 -2.28E-01 2.94E-01 2.31E-01 -3.02E-01 ......... -1.66E-01 1.00E+00Figure 10.8. Correlation matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** INVERSE COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.56E+201112 TH 2 1.46E+11 1.25E+031314 TH 3 1.35E+13 4.42E+04 2.80E+071516 TH 4 2.32E+11 1.63E+03 3.98E+04 2.23E+031718 OM11 3.04E+15 -3.96E+06 -7.46E+08 -1.76E+06 2.26E+121920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.56E+11 -1.14E+03 -2.82E+04 -1.55E+03 2.82E+06 ......... 1.86E+032324 SG11 -1.93E+09 -7.14E+00 -1.06E+03 -1.03E+01 2.67E+05 ......... 9.91E+00 4.78E-01Figure 10.9. Inverse covariance matrix of the estimate.The line numbers on the left are not actually part of thereport.7. Additional Output: Tables and ScatterplotsThe use of $TABLE and $SCATTERPLOT records to request tablesand scatterplots is discussed in Chapter 9.7.1. Output from the Table StepThe first 12 lines of the table produced by the $TABLErecord are shown in figure 10.10. This is the data for thefirst individual.1 TABLE NO. 12345 LINE NO. ID TIME AMT WT APGR DV PRED RES WRES67 1 1.00E+00 0.00E+00 2.50E+01 1.40E+00 7.00E+00 0.00E+00 1.78E+01 0.00E+00 0.00E+0089 2 1.00E+00 2.00E+00 0.00E+00 1.40E+00 7.00E+00 1.73E+01 1.76E+01 -3.14E-01 -2.92E-011011 3 1.00E+00 1.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 1.92E+01 0.00E+00 0.00E+001213 4 1.00E+00 2.45E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.07E+01 0.00E+00 0.00E+001415 5 1.00E+00 3.70E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.20E+01 0.00E+00 0.00E+001617 6 1.00E+00 4.80E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.33E+01 0.00E+00 0.00E+001819 7 1.00E+00 6.05E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.45E+01 0.00E+00 0.00E+002021 8 1.00E+00 7.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.56E+01 0.00E+00 0.00E+002223 9 1.00E+00 8.53E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.66E+01 0.00E+00 0.00E+002425 10 1.00E+00 9.65E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.77E+01 0.00E+00 0.00E+002627 11 1.00E+00 1.08E+02 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.87E+01 0.00E+00 0.00E+002829 12 1.00E+00 1.12E+02 0.00E+00 1.40E+00 7.00E+00 3.10E+01 2.81E+01 2.88E+00 6.88E-01Figure 10.10. A portion of a NONMEM table. The linenumbers on the left are not actually part of the report.Each row in the table corresponds to a record of the inputfile, and the rows appear in the same order as do thecorresponding records of the input data file. Note that thevalues of RES and WRES are always shown as zero fornon-observation records&dagger;, whereas a (possibly) nonzero valueof PRED is printed for every record.<cite>&dagger; Strictly speaking, RES and WRES are always zero forrecords having MDV=1. With PREDPP, this is the same thing.</cite>If there are more than 900 data records, separate tables areproduced for groups of 900 records. The last table containsthe remaining records. If the rows of the table are sorted,each group of records is sorted separately. When the inputdata file is large, the table will require many pages toprint. Therefore, the $TABLE record should be omittedunless needed for diagnostic purposes (such as wheninitially checking a new data set or model).7.2. Output from the Scatterplot StepMany examples of scatterplots are present in Chapters 2 and11. They are not reproduced here. Whereas all the recordsin the input data file correspond to rows of a table, thisis not true of a scatterplot that includes one or more ofthe items RES, WRES, and DV. When one of these three isbeing plotted, then only observation records contributepoints to the scatterplot&dagger;.<cite>&dagger; Strictly speaking, it is only the records having MDV=0that contribute points. With PREDPP, this is the samething. </cite>In figure 2.5, there are exactly 10 points &quot;*&quot;,corresponding to the 10 observation records in figure 2.2;the dose record does not contribute a point.NONMEM displays only the first 900 records of theappropriate type in a scatterplot. This limit appliesbefore any partitioning. For example, in a plot of DV VSID, the first 900 observation records are displayed; in aplot of WT vs ID, the first 900 records of the data file aredisplayed. Additional scatterplots can be requested,showing additional points, using options &quot;FROM=&quot; and &quot;TO=&quot;of the $SCATTERPLOT record. See NONMEM Users Guide, PartIV.">1. What This Chapter is AboutThis chapter describes NONMEM&rsquo;s output in detail. Each pageof a NONMEM-PREDPP output file is shown and discussed.The input file to NM-TRAN is that of figure 2.12, which isreproduced here as figure 10.1 for convenience.1 $PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V2 $INPUT ID TIME AMT WT APGR DV3 $DATA INDATA4 $SUBROUTINE ADVAN15 $PK6 TVCL=THETA(1)+THETA(3)*WT7 CL=TVCL+ETA(1)8 TVVD=THETA(2)+THETA(4)*WT9 V=TVVD+ETA(2)10 ; THE FOLLOWING ARE REQUIRED BY PREDPP11 K=CL/V12 S1=V13 $ERROR14 Y=F+ERR(1)15 $THETA (0,.0027) (0,.70) .0018 .516 $OMEGA .000007, .317 $SIGMA 818 $ESTIMATION PRINT=519 $COVARIANCE20 $TABLE ID TIME AMT WT APGR DV21 $SCATTER PRED VS DV UNIT22 $SCATTER RES VS WTFigure 10.1. The NM-TRAN input file (same as figure 2.12).The line numbers on the left are not actually part of thefile.2. NONMEM Describes its InputsThe first page of NONMEM&rsquo;s output is shown in figure 10.2.In this page, NONMEM repeats (&quot;echos&quot;) the instructions itwas given in the control file and describes the data file.The first page of the output should be checked carefully.Problems in a NONMEM run can often be traced to errors inthe problem specification. For example, always check thatthe initial parameter estimates were entered correctly.1 NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) DOUBLE PRECISION NONMEM VERSION IV LEVEL 1.02 DEVELOPED AND PROGRAMMED BY STUART BEAL AND LEWIS SHEINER34 PROBLEM NO. 15 PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V67 DATA CHECKOUT RUN: NO8 DATA SET LOCATED ON UNIT NO.: 29 THIS UNIT TO BE REWOUND: NO10 NO. OF DATA RECS IN DATA SET: 74411 NO. OF DATA ITEMS IN DATA SET: 812 ID DATA ITEM IS DATA ITEM NO.: 113 DEP VARIABLE IS DATA ITEM NO.: 614 MDV DATA ITEM IS DATA ITEM NO.: 81516 INDICES PASSED TO SUBROUTINE PRED ARE:17 7 2 3 0 0 0 0 0 018 0 01920 LABELS FOR DATA ITEMS ARE:21 ID TIME AMT WT APGR DV EVID MDV2223 FORMAT FOR DATA IS:24 (6E6.0,2F2.0)2526 TOT. NO. OF OBS RECS: 15527 TOT. NO. OF INDIVIDUALS: 592829 LENGTH OF THETA: 43031 OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 23233 SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 13435 INITIAL ESTIMATE OF THETA:36 LOWER BOUND INITIAL EST UPPER BOUND37 0.0000E+00 0.2700E-02 0.1000E+0738 0.0000E+00 0.7000E+00 0.1000E+0739 -0.1000E+07 0.1800E-02 0.1000E+0740 -0.1000E+07 0.5000E+00 0.1000E+074142 INITIAL ESTIMATE OF OMEGA:43 0.7000E-0544 0.0000E+00 0.3000E+004546 INITIAL ESTIMATE OF SIGMA:47 0.8000E+014849 ESTIMATION STEP OMITTED: NO50 NO. OF FUNCT. EVALS. ALLOWED: 36051 NO. OF SIG. FIGURES REQUIRED: 352 INTERMEDIATE PRINTOUT: YES53 MSF OUTPUT: NO5455 COVARIANCE STEP OMITTED: NO56 EIGENVLS. PRINTED: NO57 SPECIAL COMPUTATION: NO5859 TABLES STEP OMITTED: NO60 NO. OF TABLES: 161 TABLES PRINTED: YES6263 USER-CHOSEN DATA ITEMS FOR TABLE 1,64 IN THE ORDER THEY WILL APPEAR IN THE TABLE, ARE:65 ID TIME AMT WT APGR6667 SCATTERPLOT STEP OMITTED: NO68 NO. OF PAIRS OF ITEMS GENERATING69 FAMILIES OF SCATTERPLOTS: 27071 ITEMS TO BE SCATTERED ARE: DV PRED72 UNIT SLOPE LINE INCLUDED73 ITEMS TO BE SCATTERED ARE: WT RESFigure 10.2. The first page of the output report. The linenumbers on the left are not actually part of the report.Line 5 is an identification line for the output report. Thecontents of the $PROBLEM record are shown here.Line 7 indicates that this is not a data checkout run. (Datacheckout mode is discussed in Chapter 12 Section 4.10.)Lines 8 through 27 describe the input data file. Lines 10and 11 describe the numbers of rows and columns in the inputfile, as shown in figure 6.1. Specifically, line 10 showshow many data records were read according to the FORTRANformat specification given in line 24. Line 11 describesthe number of data items per record, which is the number ofdata items listed in the $INPUT record, less any that weredropped by the Data Preprocessor, plus any that it added(see Chapter 6). Lines 12, 13, and 14 describe thelocations of those data items of interest to NONMEM itself(i.e. NONMEM data items). Lines 16 through 18 are discussedin Section 3. Line 21 gives the labels for all the dataitems. The first six labels are those of the data itemsspecified in the $INPUT record and the next two (EVID, MDV)are those of two data items added to the data set by theData Preprocessor. (NONMEM itself supplies labels PRED,RES, and WRES for the prediction, residual, and weightedresidual data items.) In the terminology of Chapter 4 (e.g.(4.15a)), ID, TIME, AMT, WT, and APGR are the elements of x;DV is y; PRED is f (evaluated for the typical individual inthe population). Line 24 shows the format used to read eachdata record. In this example, the format was generated bythe Data Preprocessor and describes the data file afterprocessing by the Data Preprocessor.&dagger;<cite>&dagger; When a format specification is supplied on the $DATArecord, and no data items are dropped or added by the DataPreprocessor, the original format specification is usedunchanged and appears here. </cite>Line 26 gives the number of observation records. Line 27gives the number of individual records; that is, one lessthan the number of times that the ID data item changedvalue.Lines 29 through 47 describe the contents of the $THETA,$OMEGA and $SIGMA records. First, the number of elements of&theta;, &Omega; and &Sigma; are given (lines 29, 31 and 33), then theirinitial estimates are displayed. In lines 38-41, notice thevalues 0.1000e+07 and -0.1000e+07. These are NONMEM&rsquo;s wayof expressing the values +&infin; and &minus;&infin;; i.e., of describing &theta;swhich are unbounded on one or both sides. Another FORTRANsystem may display these numbers differently (e.g.,1.0000e+06), but the absolute value will always be1,000,000. In lines 43 and 44, notice that the variancesfrom the $OMEGA record appear along the diagonal of the &Omega;matrix, and that the off-diagonal element cov(&eta;1,&eta;2) iszero. Line 31 states that NONMEM understands &Omega; to bediagonal; the off-diagonal element(s) are automaticallyfixed at zero.The remaining lines of figure 10.2 describe the tasks thatNONMEM will perform. Lines 49 through 53 describe the$ESTIMATION record. Lines 50 through 53 show the defaults(set by NM-TRAN) for various options, all of which couldhave been specified explicitly on the $ESTIMATION record.In line 50 for example, NONMEM displays the maximum numberof times it will evaluate the objective function during theEstimation Step (this number can be slightly exceeded). Thevalue 360 was supplied by NM-TRAN. It is a function of thesizes of &theta;, &Omega;, and &Sigma;. Line 51 displays the desired numberof significant digits in the final parameter estimate; thevalue 3 is the default number requested by NM-TRAN.Lines 55 through 59 describe the $COVARIANCE record, givingthe default options chosen by NM-TRAN.Lines 59 through 61 describe the $TABLE record. Lines 67through 73 describe the $SCATTERPLOT records.3. PREDPP Describes Its InputsThe next two pages are produced by PREDPP and will notappear if $PRED statements (or a user-written PREDsubroutine) are used. PREDPP uses these pages to repeat(&quot;echo&quot;) the instructions it was given in the control file,and to identify the ADVAN and TRANS routines chosen by theuser. The first page of PREDPP&rsquo;s output is shown in figure10.3. 1 DOUBLE PRECISION PRED VERSION III LEVEL 1.023 ONE COMPARTMENT MODEL (ADVAN1)45 MAXIMUM NO. OF BASIC PK PARAMETERS: 267 BASIC PK PARAMETERS (AFTER TRANSLATION):8 ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 191011 COMPARTMENT ATTRIBUTES12 COMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULT13 STATUS ALLOWED ALLOWED FOR DOSE FOR OBS.14 1 CENTRAL ON NO YES YES YES15 2 OUTPUT OFF YES NO NO NOFigure 10.3. The first page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.In its first page of output, PREDPP describes the featuresof the pharmacokinetic model and its parameterizationencoded into the ADVAN and TRANS routines specified on the$SUBROUTINE record. The information displayed here includesthe kind of information summarized in Appendices 1 and 2.In the particular output of Figure 10.3 no informationconcerning an alternate parameterization appears becauseTRANS1 was specified. The information concerning basicparameters and compartments is displayed in a format similarto that used in NONMEM Users Guide, Part VI, which is thecomplete reference for PREDPP.Lines 5 and 8 describe the basic PK parameters, which inthis example is the single microconstant K. If a translatorother than TRANS1 had been requested, an additional linewould appear describing the translation. E.g., with TRANS2,this line would read:TRANSLATOR WILL CONVERT PARAMETERS CLEARANCE (CL) AND VOLUME(V) to KLines 10 through 14 describe the compartment attributes.Even though the output compartment is never turned on by thedata of this example, its attributes are described herebecause it is part of the model.The information presented so far describes the model forcomputing drug amounts. For a given choice of ADVAN andTRANS, the contents of this page are completely fixed.PREDPP&rsquo;s second page of output describes user choicesrelated to the given ADVAN routine, including choices forthe scale parameters (and thus, to the model for computingconcentrations). This page is shown in figure 10.4.1 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG2 COMPT. NO. INDICES3 SCALE BIOAVAIL. ZERO-ORDER ZERO-ORDER ABSORB4 FRACTION RATE DURATION LAG5 1 3 * * * *6 2 * - - - -7 - PARAMETER IS NOT ALLOWED FOR THIS MODEL8 * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;9 WILL DEFAULT TO ONE IF APPLICABLE1011 DATA ITEM INDICES USED BY PRED ARE:12 EVENT ID DATA ITEM IS DATA ITEM NO.: 713 TIME DATA ITEM IS DATA ITEM NO.: 214 DOSE AMOUNT DATA ITEM IS DATA ITEM NO.: 3151617 PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.18 PK SUBROUTINE NOT CALLED AT ADDITIONAL DOSE OR LAGGED DOSE TIMES.1920 DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.21 OTHERWISE, ERROR SUBROUTINE CALLED ONCE IN THIS PROBLEM.Figure 10.4. The second page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.Lines 2 through 9 describe the additional PK parameters thatare computed by the $PK statements (or PK subroutine). Inline 5, the position marked with &quot;3&quot; corresponds to thescale parameter for compartment number 1. Thus, we knowthat the $PK statements contained an assignment statementfor S1. From the prior page we can see that compartmentnumber 1 is the central compartment. The value &quot;3&quot; is a rownumber within GG, an array used for communication betweenPREDPP and the PK subroutine. With the use of NM-TRAN and$PK statements, row numbers are of no interest to the user.With a user-written PK subroutine, it is important to checktheir correctness. Positions marked with &quot;*&quot; correspond toadditional PK parameters that are allowed by the model butthat are not assigned a value by $PK statements; an exampleis F1, the bioavailability fraction for compartment 1.Positions marked with &quot;-&quot; correspond to additionalparameters that may not be computed; for instance,dose-related parameters are not allowed for the outputcompartment, because (as shown on the preceding page) thiscompartment cannot receive doses.Lines 11 through 14 describe the locations in the input datarecord of those data items of interest to PREDPP (PREDPPdata items). (NM-TRAN causes the locations of these dataitems in the data set to be passed by NONMEM to PREDPP, asindicated in lines 15 through 17 of figure 10.2. NONMEM isnot concerned with the significance of these data items.)Note that data item 7, Event ID, was appended by the DataPreprocessor.Line 17 reflects the fact that, by default, $PK statementsare evaluated with every event record&dagger;. Lagged andadditional doses are discussed in Chapter 12, Sections 2.4and 2.5. They are not used in this example.<cite>&dagger; In this example, the $PK statements (lines 5 through 12 ofthe input file, figure 10.1) involve only WT, which isconstant for each individual. It is possible to limit theevent records with which the $PK statements are evaluated tothe first event record of each individual, in order toreduce run time. This decision is left to the user. </cite> &#9474;Line 21 reflects the fact that the $ERROR statementsdescribe the simple error model (3.4). This model uses nodata items and no elements of &theta; whatsoever (directly orindirectly). NM-TRAN has instructed PREDPP that the $ERRORstatements need be evaluated only once at the beginning ofthe problem. Line 20 indicates that, should the SimulationStep be implemented, PREDPP will disregard this limitationand evaluate the $ERROR statements with every event record,so that randomly-generated values of intra-individual errorcan be applied at every observation event. (This exampledoes not involve simulation, but the PK and ERROR routineswhich implement the $PK and $ERROR statements are capable ofsupporting all NONMEM tasks, including simulation.)Finally, note that the $PK and $ERROR models (figure 10.1,lines 5-14) are not documented in the NONMEM-PREDPP output.It is a good idea to attach a printed copy of the NM-TRANinput records to the corresponding NONMEM output. MS/DOS &#9474;batch file nmfe72.bat and Unix C-shell script nmfe72 &#9474;(supplied with NONMEM) do this automatically.4. Diagnostic Output from the Estimation StepThe next page of output, figure 10.5, is produced during therunning of the Estimation Step.1 MONITORING OF SEARCH:234 ITERATION NO.: 0 OBJECTIVE VALUE: 0.6757E+03 NO. OF FUNC. EVALS.: 85 CUMULATIVE NO. OF FUNC. EVALS.: 86 PARAMETER: 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+007 GRADIENT: -0.7986E+03 -0.1594E+04 -0.4294E+03 -0.1000E+04 0.1542E+03 0.5269E+03 0.9128E+0289 ITERATION NO.: 5 OBJECTIVE VALUE: 0.6502E+03 NO. OF FUNC. EVALS.:1010 CUMULATIVE NO. OF FUNC. EVALS.: 5811 PARAMETER: 0.8878E-01 0.1003E+00 0.2055E+00 0.1296E+00 0.6695E-01 0.7822E-01 0.1071E+0012 GRADIENT: 0.1060E+04 0.2567E+04 0.3675E+03 0.8472E+03 -0.1807E+03 -0.5093E+03 0.9841E+021314 ITERATION NO.: 10 OBJECTIVE VALUE: 0.6153E+03 NO. OF FUNC. EVALS.: 915 CUMULATIVE NO. OF FUNC. EVALS.: 10716 PARAMETER: 0.5008E-01 0.6626E-01 0.2425E+00 0.1663E+00 -0.6718E-01 0.6382E-01 0.1004E+0017 GRADIENT: 0.9732E+02 0.3034E+03 0.3185E+02 0.1228E+03 -0.1162E+03 0.1252E+03 0.6450E+021819 ITERATION NO.: 15 OBJECTIVE VALUE: 0.6108E+03 NO. OF FUNC. EVALS.: 920 CUMULATIVE NO. OF FUNC. EVALS.: 15221 PARAMETER: 0.4235E-01 0.4508E-01 0.2462E+00 0.1831E+00 -0.5721E-01 0.5237E-01 0.1008E+0022 GRADIENT: 0.3989E+02 0.7394E+02 -0.1782E+01 0.8527E+02 -0.9309E+02 0.1867E+02 -0.1773E+022324 ITERATION NO.: 20 OBJECTIVE VALUE: 0.6095E+03 NO. OF FUNC. EVALS.: 925 CUMULATIVE NO. OF FUNC. EVALS.: 19726 PARAMETER: 0.1927E-01 0.3153E-01 0.2615E+00 0.1898E+00 -0.4458E-01 0.4904E-01 0.1047E+0027 GRADIENT: 0.1609E+02 -0.3621E+02 0.5228E+01 0.9614E+00 -0.1740E+02 0.1329E+02 0.3111E+012829 ITERATION NO.: 25 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 930 CUMULATIVE NO. OF FUNC. EVALS.: 24231 PARAMETER: 0.2389E-02 0.4171E-01 0.2652E+00 0.1833E+00 -0.4413E-01 0.4998E-01 0.1043E+0032 GRADIENT: 0.2273E+01 -0.5333E+01 0.3914E+01 -0.5397E+01 0.1271E+01 0.2610E+01 0.3584E+003334 ITERATION NO.: 30 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.:1635 CUMULATIVE NO. OF FUNC. EVALS.: 29936 PARAMETER: -0.1278E-03 0.4166E-01 0.2650E+00 0.1835E+00 -0.4414E-01 0.5003E-01 0.1043E+0037 GRADIENT: -0.1120E+00 -0.9411E+00 -0.3719E+00 -0.2540E+01 -0.5135E-01 0.1420E+00 -0.9524E-013839 ITERATION NO.: 32 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 040 CUMULATIVE NO. OF FUNC. EVALS.: 31541 PARAMETER: -0.7284E-05 0.4150E-01 0.2650E+00 0.1836E+00 -0.4411E-01 0.5003E-01 0.1043E+0042 GRADIENT: -0.6416E-02 0.9336E-01 0.4548E-01 0.4826E-01 0.1263E-02 0.9652E-01 0.4629E-014344 MINIMIZATION SUCCESSFUL45 NO. OF FUNCTION EVALUATIONS USED: 31546 NO. OF SIG. DIGITS IN FINAL EST.: 3.9Figure 10.5. The output from the Estimation Step. The linenumbers on the left are not actually part of the report.4.1. Intermediate Output from the Estimation StepLines 1 through 42 are referred to as the intermediateoutput. Lines 4 through 7 give numbers summarizing the 0-thiteration, which are based on the initial parameterestimates. Line 4 shows the initial value of the objectivefunction. The value following &quot;NO. OF FUNC. EVALS.&quot; is thenumber of objective function evaluations which were neededduring the iteration. Line 5 gives the cumulative number offunction evaluations including this and all prior iterationsummaries.Line 6 gives the unconstraine_____________ paramete_________ (UCP_____ estimates. &#9474;The search is carried out in a different parameter space. &#9474;The parameters are transformed to unconstrained parameters &#9474;(UCP). In the transformation process a scaling occurs so &#9474;that the initial estimate of each of the UCP is 0.1.Thus, in line 6, all parameters are .1 at the 0-thiteration. Parameters are printed in the following order:elements of &theta;, elements of &Omega;, elements of &Sigma;. In thisexample, reading from left to right, the parameters are &theta;1,&theta;2, &theta;3, &theta;4, &Omega;11, &Omega;22, and &Sigma;11.Two points should be noted. First, fixed parameters do notappear in the list. Therefore, the off-diagonal element&Omega;12, which is effectively fixed to 0, does not appear.Second, when off-diagonal elements of &Omega; are being estimated,then as many additional UCP&rsquo;s appear as there areoff-diagonal elements of &Omega; being estimated. However, a 1-1correspondence between each of the elements of &Omega; and an UCPdoes not exist. The same is true for elements of &Sigma; and theUCP&rsquo;s for &Sigma; when off-diagonal elements of &Sigma; are estimated. &#9474;With NONMEM 7, the parameter estimates are also &#9474;displayed in their natural (unscaled) space. These lines &#9474;are identified as NPARAMETR and precede the PARAMETER &#9474;lines, which display the UCP values.Line 7 shows the gradient for each parameter, which may bethought of as the partial derivative of the objectivefunction with respect to that parameter.The Estimation Step proceeds in a series of stages callediterations. In this example, intermediate printout isproduced for each of every 5 iterations, as well as for the0-th and final iterations, for which intermediate printoutis always printed by default. This printout consists of thesame four lines as for the 0-th iteration, but using theparameters estimates obtained at the end of the iteration.In lines 4, 9, 14, 19, 24, 29, 34, and 39, observe that theobjective function drops quickly at first, and then moreslowly. After iteration number 25, there is no change abovethe fourth significant digit.In lines 6, 11, 16, 21, 26, 31, 36, and 41, observe thateach parameter also changes rapidly at first and then moreslowly as it converges to its final value. (The firstparameter, &theta;1, is an exception. It is clearly approaching avery small value close to its lower bound, 0. In Chapter12, we shall see that both &theta;1 and &theta;2 are best fixed at 0.)Finally, in lines 7, 12, 17, 22, 27, 32, 37, and 42, observethat the gradients also approach 0, another sign that aminimum of the objective function has been located.The values computed for the gradients are very sensitive todifferences in computer arithmetic and precision. If agiven NONMEM run is repeated on a different computer, or onthe same computer with different machine precision or adifferent FORTRAN compiler, it is likely that the gradientswill be different. This will cause the search to follow adifferent path to the minimum, so that lines 4 through 42may be quite different. However, each final estimate of aUCP should always be the same to the number of requestedsignificant digits. (Minor differences may also be observedin the output of the Covariance Step, below; this output isalso sensitive to computational differences.)4.2. Summary Output from the Estimation StepLines 44, 45 and 46 are always printed, even whenintermediate printout is suppressed. Line 44, &quot;MINIMIZATIONSUCCESSFUL&quot;, signifies that the search appears to havelocated a minimum of the objective function. Before one canbe certain that a minimum has been located, or one whichcorresponds to a reasonable parameter estimate (there can bea number of &quot;local minima&quot;), the final parameter estimatesmust be examined in their (untransformed) state; see Section5 below. The Estimation Step is not always successful.Chapter 13 discusses two other messages that sometimesappear instead of line 44.In line 45, note that the number of function evaluationsused, 315, is a total value and includes all iterations (notjust those for which intermediate printout was displayed).This is under the limit of 360 supplied by NM-TRAN (figure10.2, line 57).The number of significant digits in the final estimate isgiven in line 34 as 3.9. This can be interpreted as meaningthat no (transformed) parameter estimate is actuallydetermined to less than 3.9 significant digits. Morespecifically, when the UCP estimates were compared betweenthe last two iterations, none differed in the first (almost)4 significant figures including leading zeros after thedecimal point. Note that the final &theta;1 UCP estimate is-0.7284E-05, and so the 7284 are not significant digits atall! Because NONMEM displays only 3 significant digits inthe printed parameter estimates, and for other reasons aswell, by default NM-TRAN requests only 3 significant digits.However, more significance can be requested, as wasdiscussed in Chapter 9, Section 4.1. &#9474;5. Minimum Value of the Objective Function and Final &#9474;Parameter EstimatesThe next two pages in the NONMEM output are produced whetheror not the Estimation Step was implemented and, if it was,whether or not the search terminated successfully. Theygive the values of the objective function and the parameterestimates, using the final parameter estimates if theEstimation Step was implemented (whether or not the searchterminated successfully), and using the initial parameterestimates otherwise. These pages have already been shown inChapter 2, figure 2.13. Even when the minimization routineis successful in locating a minimum of the objectivefunction, the final (untransformed) parameter estimates mustbe carefully checked. Is any parameter&rsquo;s final estimatephysiologically unreasonable? Is any parameter&rsquo;s finalestimate near its upper or lower constraint? If eitheranswer is yes, the model, the constraints on &theta;&rsquo;s, or thedata may be incorrect; see Chapter 11.Sometimes the final estimates do not match anticipatedvalues, e.g., values obtained by some other system ofanalysis. Additional refinement of the model may be needed,as discussed in Chapter 11. However, the discrepancy maywell be traceable to an error in model specification, suchas an error in specifying a compartment&rsquo;s scale. Along withthe Estimation Step, it is important to obtain a scatterplotof PRED vs DV and make sure the unit slope line is visible.See Chapter 13, Section 4.4.6. Output from the Covariance StepFigures 10.6 through 10.7 show the output of the CovarianceStep, which was requested via the $COVARIANCE record.Figure 10.6 has already been displayed as figure 2.14, butis included here for completeness. This page displays thestandard errors of the parameter estimates. Standard errorsare discussed extensively in Chapters 5 and 11. A detaileddiscussion of the remaining three pages, containing thecovariance, correlation, and inverse covariance matrices, isbeyond the scope of this text. Note, however, the use ofthe notation &quot;........&quot;. Each sequence of dots denotes avalue (such as the standard error in the estimate of &Omega;12)that is 0 by definition, rather than due to a computation.1 ************************************************************************************************************************2 ******************** ********************3 ******************** STANDARD ERROR OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************6789 THETA - VECTOR OF FIXED EFFECTS *********************101112 TH 1 TH 2 TH 3 TH 41314 9.49E-11 1.46E-01 2.24E-04 1.13E-0115161718 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********192021 ETA1 ETA22223 ETA1 7.24E-072425 ETA2 ......... 3.63E-0226272829 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****303132 EPS13334 EPS1 1.71E+00Figure 10.6. Standard error of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 9.02E-211112 TH 2 3.93E-12 2.14E-021314 TH 3 -5.23E-15 -1.45E-05 5.00E-081516 TH 4 -3.69E-12 -1.57E-02 1.04E-05 1.27E-021718 OM11 -1.11E-17 2.13E-08 -6.39E-12 -1.52E-08 5.24E-131920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.79E-14 4.40E-04 -5.30E-07 5.58E-04 6.27E-10 ......... 1.32E-032324 SG11 1.04E-11 -5.69E-02 1.12E-04 4.45E-02 -3.74E-07 ......... -1.03E-02 2.92E+00Figure 10.7. Covariance matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** CORRELATION MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.00E+001112 TH 2 2.83E-01 1.00E+001314 TH 3 -2.46E-01 -4.44E-01 1.00E+001516 TH 4 -3.45E-01 -9.53E-01 4.13E-01 1.00E+001718 OM11 -1.61E-01 2.01E-01 -3.95E-02 -1.86E-01 1.00E+001920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -5.21E-03 8.29E-02 -6.53E-02 1.37E-01 2.39E-02 ......... 1.00E+002324 SG11 6.44E-02 -2.28E-01 2.94E-01 2.31E-01 -3.02E-01 ......... -1.66E-01 1.00E+00Figure 10.8. Correlation matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** INVERSE COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.56E+201112 TH 2 1.46E+11 1.25E+031314 TH 3 1.35E+13 4.42E+04 2.80E+071516 TH 4 2.32E+11 1.63E+03 3.98E+04 2.23E+031718 OM11 3.04E+15 -3.96E+06 -7.46E+08 -1.76E+06 2.26E+121920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.56E+11 -1.14E+03 -2.82E+04 -1.55E+03 2.82E+06 ......... 1.86E+032324 SG11 -1.93E+09 -7.14E+00 -1.06E+03 -1.03E+01 2.67E+05 ......... 9.91E+00 4.78E-01Figure 10.9. Inverse covariance matrix of the estimate.The line numbers on the left are not actually part of thereport.7. Additional Output: Tables and ScatterplotsThe use of $TABLE and $SCATTERPLOT records to request tablesand scatterplots is discussed in Chapter 9.7.1. Output from the Table StepThe first 12 lines of the table produced by the $TABLErecord are shown in figure 10.10. This is the data for thefirst individual.1 TABLE NO. 12345 LINE NO. ID TIME AMT WT APGR DV PRED RES WRES67 1 1.00E+00 0.00E+00 2.50E+01 1.40E+00 7.00E+00 0.00E+00 1.78E+01 0.00E+00 0.00E+0089 2 1.00E+00 2.00E+00 0.00E+00 1.40E+00 7.00E+00 1.73E+01 1.76E+01 -3.14E-01 -2.92E-011011 3 1.00E+00 1.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 1.92E+01 0.00E+00 0.00E+001213 4 1.00E+00 2.45E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.07E+01 0.00E+00 0.00E+001415 5 1.00E+00 3.70E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.20E+01 0.00E+00 0.00E+001617 6 1.00E+00 4.80E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.33E+01 0.00E+00 0.00E+001819 7 1.00E+00 6.05E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.45E+01 0.00E+00 0.00E+002021 8 1.00E+00 7.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.56E+01 0.00E+00 0.00E+002223 9 1.00E+00 8.53E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.66E+01 0.00E+00 0.00E+002425 10 1.00E+00 9.65E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.77E+01 0.00E+00 0.00E+002627 11 1.00E+00 1.08E+02 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.87E+01 0.00E+00 0.00E+002829 12 1.00E+00 1.12E+02 0.00E+00 1.40E+00 7.00E+00 3.10E+01 2.81E+01 2.88E+00 6.88E-01Figure 10.10. A portion of a NONMEM table. The linenumbers on the left are not actually part of the report.Each row in the table corresponds to a record of the inputfile, and the rows appear in the same order as do thecorresponding records of the input data file. Note that thevalues of RES and WRES are always shown as zero fornon-observation records&dagger;, whereas a (possibly) nonzero valueof PRED is printed for every record.<cite>&dagger; Strictly speaking, RES and WRES are always zero forrecords having MDV=1. With PREDPP, this is the same thing.</cite>If there are more than 900 data records, separate tables areproduced for groups of 900 records. The last table containsthe remaining records. If the rows of the table are sorted,each group of records is sorted separately. When the inputdata file is large, the table will require many pages toprint. Therefore, the $TABLE record should be omittedunless needed for diagnostic purposes (such as wheninitially checking a new data set or model).7.2. Output from the Scatterplot StepMany examples of scatterplots are present in Chapters 2 and11. They are not reproduced here. Whereas all the recordsin the input data file correspond to rows of a table, thisis not true of a scatterplot that includes one or more ofthe items RES, WRES, and DV. When one of these three isbeing plotted, then only observation records contributepoints to the scatterplot&dagger;.<cite>&dagger; Strictly speaking, it is only the records having MDV=0that contribute points. With PREDPP, this is the samething. </cite>In figure 2.5, there are exactly 10 points &quot;*&quot;,corresponding to the 10 observation records in figure 2.2;the dose record does not contribute a point.NONMEM displays only the first 900 records of theappropriate type in a scatterplot. This limit appliesbefore any partitioning. For example, in a plot of DV VSID, the first 900 observation records are displayed; in aplot of WT vs ID, the first 900 records of the data file aredisplayed. Additional scatterplots can be requested,showing additional points, using options &quot;FROM=&quot; and &quot;TO=&quot;of the $SCATTERPLOT record. See NONMEM Users Guide, PartIV.</a><br>
<a href="#1. What This Chapter is AboutIn this chapter, the simple phenobarbital example begun inChapter 2 will be continued to illustrate how NONMEM is usedto build a model for population data. The topic of modelbuilding, diagnosis and verification is a large one. Thischapter can only give a very abbreviated example.2. The Stages of Model BuildingTo analyze a population data set and build a model for it,one must proceed in logical stages. There are five stages,and their relationship to one another is presenteddiagrammatically in figure 11.1. One begins by checking thedata. One then tries to find an adequate modelincorporating the fixed effects; then an adequate modelincorporating the random effects and describing randominter- and intra-individual variability. After a reasonablycomplete model is found, attempts are made to refine it, andfinally, if desired, the various parts of the models (whichoften, in effect, simply assert the existence of certainrelationships between independent variables and thedependent variable) can be subject to formal hypothesistests, as described in Chapter 5. (However, it is wellknown by statisticians that formal hypothesis testingundertaken after model building is just an approximation forthe type of hypothesis testing described in textbooks, whichassumes that the model is the correct model).+chapt11/fig11.1.ubuntu.epsiFigure 11.1. Stages in model building.3. Check-out &mdash; Index PlotsThe goal of this stage is to assure that the data arecorrect. There is no point to trying to model the data whengross errors are present. Most gross errors are encodingerrors that cause certain values to be different from theintended value by a considerable amount (for example, amisplaced decimal point changes a value by a factor of 10),so that graphical display of the data is usually adequate todetect these. No numerical or statistical approaches areneeded. Indeed, they are not usually useful, even for moresubtle errors, as such errors cannot easily be detected byany means (how is a 10% error to be distinguished frominter- or intra-individual variability?).To detect gross errors, then, one makes scatterplots ofdifferent data item types vs individuals&rsquo; identificationnumbers (i.e. the ID data item, or, if the values of thisdata item are arbitrary, another data item that identifiespatients using sequential integer values; call this thesequence data item: SEQ). Such plots (of one data itemversus ID or SEQ) are called here inde_____ plots______ and are quiteuseful for revealing the structure of the data, as will benoted below, as well as for finding gross errors.If NONMEM is used to make index plots, it will also beuseful to implement the Tables Step, so that if a problem isnoted in a scatterplot, one can refer to the table to try tofind the datum that might account for the problem. To runNONMEM some model must be specified, even if all that isdesired is an index plot. In such case, it makes littledifference what model is used. It is easiest and useful to(i) start with a simple ADVAN that is likely to provide atleast a roughly satisfactory fit, (ii) set each PK parameterto a (different) element of &theta;, (iii) use only one &eta;variable, modifying the scale parameter only, and one &epsilon;variable, and (iv) use roughly reasonable fixed initialestimates.For the phenobarbital example, one might use ADVAN1 withK=&theta;1, V=&theta;2+&theta;2&eta;1, and y=f+f&epsilon;1. Initial estimates might be: K= .0057 hr &minus;1 (half-life = 5 days, a typical value foradults); V= 1.44 L. (the first patient has a concentrationof 17.3 mg/L some few hours after an initial loading dose of25 mg; 1.44 times 17.3 = 25); &omega; = .25 (50% variability); &sigma;2= .04 (20% variability).Figures 11.2 and 11.3 show index plots that might be seen ina check-out run (gross errors have been added). In figure11.2, DV is plotted vs ID (here ID and SEQ are the same),and a gross error occurring at about patient #13 is seen (anobservation of about 24 mcg/ml was erroneously recorded as240 mcg/ml). In figure 11.3, AMT is plotted vs ID, andpatient #3 appears to have a grossly erroneous value (again,a decimal point error; a dose of 18 was misrecorded as 180).DV VS. ID0.00E+00 5.00E+01 1.00E+02 DV 1.50E+02 2.00E+02 2.50E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. * * * ** .. * 2 .. * * * .. *** .. 2*** * .. * 2 .. ** * * .. ** * .1.14E+01. ** * * ... * * .. * 3 .. * * .. * * * .. * 2* 2 * .. ** * .. * * * .. 2 * .. 2*2 .2.38E+01. 2 * ... * * * ** * .. * * .. * * * .. * .ID . 2 .. * .. * 2* * .. * * .. * * .3.62E+01. * * * ... * *** ** .. * * * .. * * .. ** * .. ** * .. * * * .. ** * .. * .. * .4.86E+01. * * * *22 ... * * * * .. * ** .. * * * .. * * 2* * .. * .. * .. * * .. 2 ** * * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.2. A scatterplot of the dependent variable, DV,vs the patient&rsquo;s ID number (a type of index plot). Note theoutlier at about ID = 13.Actually, figure 11.3 reveals a considerable amount aboutthe data structure (this will be seen better in figure 11.4,below, when the outlier has been removed). Many points liealong the line AMT = 0, where one sees integers 5, 3, 3, 6,etc, as one proceeds along the ID axis, each integerindicating the corresponding number of points over-plottedat that location. They correspond to the observationrecords, since the doses on these records are all zero.Thus one can see how many observations each individualcontributes (other type records would also plot at AMT=0,however). Proceeding to the next highest &quot;line&quot; of doses(where many points over-plot for each patient), one &quot;sees&quot;the event records giving the maintenance dose amount sincethis amount stays constant within a individual (manymaintenance doses were given per individual), and thisamount is approximately the same across individuals. Last,at the highest doses (except for the outlier), one hasmostly single points. These are the loading doses. Thereis occasional over-plotting of loading-dose points. Thesepoints represent overlapping patient ID numbers (at theresolution of the NONMEM plot ), not multiple loading dosesto the same patient.AMT VS. ID-1.00E+01 3.00E+01 7.00E+01 AMT 1.10E+02 1.50E+02 1.90E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. 5 K * * .. 3 B * .. 3A * .. 3 A * .. 6CB * * .. 3 C * .. 4 C * .. 3 B * .1.14E+01. 4 E* 2* ... 2C 2 .. 4C * .. 2 B * .. 3 D 2 .. 7M 2* .. 32A 2 .. 3 B * .. 3 C 2 .. 5 3 B 2 * .2.38E+01. 3 C * 2 ... 6B ** * .. 2 9 * .. 3 6 * * .. *3 * .ID . 2 B 2 .. * * .. 5 4 6 2 * * .. 2 6 * .. 2 7 2 .3.62E+01. 3 B * ... 6 R ** .. 3 B * .. 2 * * * .. 3 6 * .. 3 6 * 2 .. 3 A 2 .. 38 * .. * 2 .. * 4 * .4.86E+01. 86C * * * ... 494 * * .. 3A * * .. 3A 3 .. 6 B * 4 .. * 6 * .. ** * .. 2 8 2 .. 6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.3. An index plot of the independent variable,dose amount (AMT). Note the outlier at about ID = 3.Figure 11.4 replots the same data as figure 11.3 but withthe misrecorded values of the data items corrected. Figures11.5 and 11.6 show the index plots for the other two dataitems of interest to this data analysis: weight (WT) andApgar score (APGR).AMT VS. ID-1.00E+00 1.34E+01 2.78E+01 AMT 4.22E+01 5.66E+01 7.10E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. ..5 9B * * ..3 B * ..3 A * ..3 A * ..6 CB * * ..3 C * ..4 C * ..3 B * .1.14E+01.4 E * 2 * ...2 C 2 ..4 C * ..2 B * ..3 C* 2 ..7 M 2 * ..3 2A 2 ..3 B * ..3 C 2 ..5 3 B 2 * .2.38E+01.3 C * 2 ...6 47 * * * ..2 9 *..3 6 * * ..* 3 * .ID .2 B 2 ..* * ..5 4 6 2 * *..2 6 * ..2 7 2 .3.62E+01.3 B * ...6 R * * ..3 B * ..2 * * * ..3 6 * ..3 6 * 2 ..3 A 2 ..3 8 * ..* 2 ..* 4 * .4.86E+01.8 6 C * * * ...4 94 * * ..3 A * * ..3 A *2 ..6 38 * 22 ..* 6 * ..* * * ..2 5 3 2 ..6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.4. See figure 11.3; the outlier has beencorrected. WT VS. ID5.00E-01 1.14E+00 1.78E+00 WT 2.42E+00 3.06E+00 3.70E+00. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. G F .. G .. H .. F .1.14E+01. 6 G ... G .. H .. E .. I .. G G .. H .. F .. H .. 7 F .2.38E+01. I ... K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... G J .. F .. 5 .. A .. 2 A .. F .. C .. 3 .. 6 .4.86E+01. D G ... J .. F .. G .. 8 E .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.5. Index plot for weight (WT)APGR VS. ID9.00E-01 2.74E+00 4.58E+00 APGR 6.42E+00 8.26E+00 1.01E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. V .. G .. H .. F .1.14E+01. G 6 ... G .. H .. E .. I .. W ..H .. F .. H .. F 7 .2.38E+01. I ...K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... J G .. F.. 5 .. A ..2 A .. F .. C .. 3 .. 6 .4.86E+01. T ... J .. F .. G .. M .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.6. Index plot for Apgar score (APGR)These plots will be useful in the next stage of modelbuilding.4. Building the Structural Part of the ModelOne must first consider the choice of the structural kineticmodel. For the phenobarbital data, a monoexponentialkinetic model has been chosen. Presumably, the basicstructural kinetics are already known well enough for thiswell studied drug, and it is not necessary to explore thefits of other possible structural kinetic models to the dataat hand. Rather, in this section we focus on the newer taskto most users of NONMEM, the task of building the structuralpart of the model for the PK parameters.4.1. A General ApproachIt is generally advisable to start from the simplestreasonable model, and proceed toward greater complexity,stopping whenever further additions fail to improve themodel fit. Thus, one needs several types of tools: (i)those to choose a &quot;minimal&quot; model, (ii) those to indicatewhat part of a current model needs to be altered orelaborated (called model diagnosis or model criticism), and(iii) those to judge whether an alteration or elaborationhas led to an improved model.With such tools, one proceeds step by step from the minimalmodel, running NONMEM and using the diagnostic tools at eachstep to suggest a single addition for the next step. Theprocess will terminate when the judgement tools indicate noimprovement by any of the additions suggested by thediagnostic tools, or when the diagnostic tools fail tosuggest any more additions.The NONMEM runs at this stage, since there will be many ofthem, should be made as short as possible. To do so, onlythe estimation, table and scatterplot features need be used;the Covariance Step need not, in general, be run.4.2. The Minimal ModelAs suggested above, the minimal model involves the simplestpharmacokinetic model (ADVAN) likely to fit the data, andthe simplest possible structural PK parameter model: eachparameter is simply identified with a separate element of &theta;.At this stage, the statistical model should also be verysimple. Only one, or at most two &eta; variables should bedefined. These will usually affect (first) the scaleparameter (which itself, is often a volume of distributionparameter) and (second) some other parameter influencing theoverall kinetics. Since the overall kinetics exhibited inthe data will usually be dominated by elimination, thesecond &eta; should usually modify the rate constant ofelimination or clearance. However, some (kinetic) data setsare dominated by absorption or distribution, and in suchcases, the second &eta; should probably modify the parametermost affecting these processes. A single &epsilon; should usuallysuffice. Both inter- and intra-individual errors canconveniently be modeled as proportional, so that thedetermination of initial estimates of variances is madeeasier, and all such estimates are on the same scale, butthis is a matter of taste. The model for the phenobarbitaldata defined in Chapter 2 (figure 2.6) almost fulfills thespirit of these restrictions. However, the inter- andintra-individual error models there are additive, ratherthan proportional. The minimal model used on thephenobarbital data in this chapter is therefore a modifiedversion of that used in Chapter 2. It is:CL=&theta;1(1+&eta;1) (11.1a)V=&theta;2(1+&eta;2) (11.1b)y=F(1+&epsilon;1) (11.1c)In (11.1), it is understood that S=V, and that F is theprediction of y from ADVAN1 using CL and V. A control fileto NM-TRAN that specifies this model, and instructs NONMEMto produce the desired output is:$PROBLEM PHENOBARB SIMPLE MODEL (#1)$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PK TVCL=THETA(1)CL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0,.0105) (0,1.05)$OMEGAS .25 .25$SIGMAS .04$ESTIMATION$TABLE ID TIME AMT WT APGR$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS (PRED,WT,APGR)$SCATTERPLOT WRES VS (PRED,WT,APGR)4.3. Use of ConstraintsIt is important to realize that constraints on elements of &theta;or &Omega; may be part of a model.For example, constraining clearance to be positive isa modelling choice. One might implement this constraintin NONMEM using a lower bound on the $THETA record, and this wouldassure that the estimate of clearance will be positive.It may not be necessary to do this; even without the lower bound, the datamight clearly force the estimate to be positive.Often, however, analysts will constrain the range of aparameter in the belief that doing so will shorten computingtime or stabilize the search for the minimum of theobjective function. While this benefit may be gained, thedata may force the parameter estimate to the constraintboundary even though this boundary may not, in fact,represent a true modeling choice. In this case the properaction is to relax the constraint and rerun the problem. Todo otherwise, and leave the parameter estimate to be theboundary value, implies that at the outset the user assumesthat the parameter must be within the boundary and elevatesthe constraint to the status of a modeling choice. If anestimate lies on a boundary, NONMEM will print a warningmessage (along with the standard message regarding thestatus of the termination of the Estimation Step). Thereader is cautioned to look for such a message, and ingeneral, it is a good idea to check the values of the finalestimates against the boundary values. Alternatively, theimplementation of constraints that are not intended torepresent modeling choices might be used cautiously and onlyif they really seem necessary to stabilize a search.4.4. Diagnostic Tools4.4.1. Plot of DV vs PREDMost useful diagnostic tools are graphical. For an overallsense of the fit, a useful diagnostic plot is DV vs PRED.When there are substantial and systematic deviations fromthe line of identity, this plot suggests that there areproblems with the fit, but it does not suggest what exactlythese problems might be or what to do about them. This plotfor the fit of the phenobarbital data to model (11.1) isseen in figure 11.7.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. .* .. . .. * * ** * * .. * * 2 * * * .. .* .. * *2* * * * .1.80E+01. * .*** 2* * ... * * *23 * .. 2 * . *2 **** * .. *2 ***** * * * * .. 22 2. * * .. 3 * ** * ** * .. ** *2 3 * * * .. * . 2 * * .. * ** . * * * * * .. * * *** * * .3.10E+01. ** *2 22 ... * ** . .. * 22*.* * .. * * . * .. * * * . .DV . * * 2 * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.7. Predictions from fit of model (11.1) tophenobarbital data vs observations themselves. The line ofidentity (...) shows where the points should, ideally, fall.Figure 11.7 reveals that there is a group of points wherethe observation is much lower than the prediction. To beginto determine why this is so, it will be useful to look atresidual plots. Such plots are the basis of the mostimportant of the diagnostic tools.4.4.2. Residual PlotsAs mentioned in Chapter 2, a residual is the differencebetween an observation and its prediction. The predictionin this case (the same prediction as denoted by PRED) is thepopulation prediction, i.e. the prediction for the typicalindividual having the given values for all the concomitantvariables.With population data, weighted residuals are often moreinformative than (plain) residuals. The weighted residualsfor an individual are formed by transforming theindividual&rsquo;s residuals so that under the population model,and assuming the true values of the population parametersare given by the estimates of those parameters, all weightedresiduals have unit variance and are uncorrelated. Weightedresiduals are more informative for several reasons. First,since they have unit variance, or what is the same, unitstandard deviation, &quot;large&quot; weighted residuals are thosewith absolute values greater than 3 or so. Second, looselyspeaking, although plain residuals remove the structuralmodel from the data, allowing one to see what part of thedata is not (yet) modeled, they do not remove thestatistical model (formally, they are still correlated).Weighted residuals have both models &rsquo;removed&rsquo; so any patternin these is definitely not accounted for by the currentmodel. This provides a more secure basis for future modelbuilding choices.4.4.2.1. Index Plots of ResidualsFigure 11.8 is an index plot of residuals, which is a usefulplot when combined with index plots of other data items.One can look for an association between unusual residualsand values of another data item. E.g. Are the largestdiscrepancies between model and data associated with certain(possibly extreme) values of the data item?RES VS. ID-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. 2* 2 .. * ** . .. . 2 * .. * 2 . .. * .* 3* .. . * ** .. . 22 .. 2 * .1.14E+01. * **.* ... . * * .. 2 * * .. **. .. * * * .. *** . * 3 .. .* ** .. . *2 .. * * * . .. * * * ** .2.38E+01. * * * . ... * . * * 2 * .. * * . .. * * * .. . * .ID . ** . .. . * .. * * * 2 . .. ** . .. ** . .3.62E+01. * * .* ... ** **** .. * * * . .. 2 .. * * * . .. * * . * .. 2* . .. . *** .. . * .. * . .4.86E+01. * 2 * *2* ... . * * * * .. * * * .. . ** * .. * * 22 .. * . .. . * .. * * . .. *. ** * ** .. . .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 11.8. Index plot of residuals from fit of model(11.1) to phenobarbital data.In the phenobarbital example, this is clearly so: The largenegative residuals (i.e., predictions greater thanobservations), first noted in figure 11.7, are here seen tobe associated with patients 22 to 32 or thereabouts. Infigures 11.4 and 11.5 it is clear that these same patientsare those who received the highest doses and who weigh themost. An obvious explanation, then, of the over-predictionsis that they are in the patients who weigh the most, andbecause weight is not in the model, neither volume norclearance is adjusted to be larger in such individuals, sothat predictions are strictly proportional to dose alone andmay be too large for these heavier patients.4.4.2.2. Plot of WRES vs Independent VariableAnother way to see the association between weight (or dose)and the large residuals is to plot the residual againstweight, say. Figure 11.9 is this plot, but where, forreasons already discussed, weighted residuals, rather thanplain residuals, are used.WRES VS. WT-3.10E+00 -1.92E+00 -7.40E-01 WRES 4.40E-01 1.62E+00 2.80E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . .. . *.. * * . ** * * * * * 2 .. . .. . * * * .. * * . * * * * * * * * .. . .. * * * ** * * *2 * .. * * * * ** 2 ** ** * * **** * * .1.14E+00. . ... * * * ** 2* * ** **** .. * * ** * ** *. ** * * .. . .. * ****2*** .22**2 * .. . .. 2 * ** **.* * * * .. . .. . .. ** *** ** *. * .1.78E+00. * * * ** * *** ... . .. * *2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * * . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.9. Plot of weighted residuals vs weight for fitof minimal model to phenobarbital data.It is clear from figure 11.9, in a way that is particularlycompelling, that it is precisely those individuals with thelargest weight whose residuals are large and negative. Thistype of residual plot, where (weighted) residuals areplotted against some independent variable, is the singlemost useful diagnostic tool.Systematic patterns of weighted residuals, then, suggestpossible model improvements. For an independent variablethat already appears in the model, such a pattern maysuggest that the way in which it enters the model isincorrect; e.g., it might appear as having a linearinfluence on a PK parameter, and a curvilinear influencemight be better, or it might affect additional PKparameters, beyond those it affects in the current model.An example of this will be seen shortly. For a variablethat does not yet appear in the model, as in figure 11.9,such a pattern suggests that the element should appear.Before examining what happens if patient weight is added tothe model, a caution about residual plots is in order.Neither residuals, nor weighted residuals, should ever beplotted against the observations themselves. Such a plotwill always show a correlation, spuriously suggesting aproblem with the model. This is most easily appreciated byconsidering the simple model that gives rise to theconstant-valued prediction given by the the mean of theobservations. All positive residuals (observations greaterthan prediction) must then be associated with observationsgreater than the mean, while all negative residuals must beassociated with observations less than the mean. Clearly,then, the residuals plotted against the observations mustshow a line with positive slope. This same type ofassociation, although to a lesser degree, holds true, evenin less extreme cases. The phenomenon is illustrated infigure 11.10.+chapt11/fig11.10.ubuntu.epsiFigure 11.10. Residuals always correlate with theobservations themselves; the more so, the less the modelexplains the data!4.5. Judging Goodness of FitA more complex model is acceptable only if the complexitycan be justified by some significant improvement in the fit.To evaluate whether this has been accomplished, severalmeasures should be examined; no single measure suffices.In the phenobarbital example, based on the finding in figure11.9, a modified model is suggested. This model, (11.2),has (11.2b)=(11.1b), and (11.2c)=(11.1c), butCl=(&theta;1+&theta;3WT)(1+&eta;1) (11.2a)which is a full model relative to the reduced model (11.1a),whence (11.2) is a full model relative to the reduced model(11.1).Themodel-defining statements to NM-TRAN ($PK and $ERROR) now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))We now examine some measures of goodness of fit, and see how(11.2) fares relative to (11.1).4.5.1. A Global Measure &mdash; Change in the Objective FunctionA global measure of goodness of fit is, of course, theobjective function value based on the final parameterestimates, which, in the case of NONMEM, is minus twice thelog likelihood of the data (see Chapter 5, Section 5.2.3).As noted in Chapter 5, if the new model differs from theprevious model only by the addition of some new variable(s)(so that the two models form a full/reduced model pair),then the difference in objective function values has a known(approximate) statistical distribution. More informally,during model-building, a fall in objective function value of4 when a single new parameter is introduced (and no old onesare eliminated) indicates that the new model hassubstantially improved the overall goodness of fit. Model(11.2) shows a decrease in objective function of 35.2relative to (11.1), indicating considerable improvement.4.5.2. Decrease in Unexplained VariabilityThe purpose of adding independent variables to the model isusually to explain kinetic differences among individuals.This means that prior to adding a variable, such differenceswere not &quot;explained&quot; by the model, and hence were part ofrandom interindividual variability, although thesedifferences could also have been reflected as a part ofrandom intraindividual variability. Accordingly,elaboration of the model should be accompanied by a decreasein the estimates of the variances in &Omega; and/or &Sigma;.The estimates of &omega;2CL, &omega;2V, and &sigma;2 from the fit to Model(11.2) are .057, .12, and .0196, corresponding tocoefficients of variation of 24%, 35%, and 14%,respectively. The corresponding values from the fit to(11.1) are .25 (CV=50%), .14 (CV=37%), and .016 (CV=13%), sothat a considerable reduction in the variance of clearanceis seen.4.5.3. Improvement in PlotsThe last, and most useful, evidence confirming the value ofelaborating a model is to find that the pattern(s) in thePRED vs DV and weighted residual plot(s) that suggested theneed for the addition have now disappeared. Indeed, when amodel is relatively complete, all weighted residual plotsshould show no pattern: the &quot;unexplained&quot; part of the datashould have become featureless random noise.Figures 11.11 and 11.12 correspond to 11.7 and 11.9, but arefrom the fit to model (11.2).PRED VS. DV6.00E+00 2.40E+01 4.20E+01 PRED 6.00E+01 7.80E+01 9.60E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... * .. . .. . .. .* .. . .. * ** * * * ..* * *** * * .. * . .. * ***** * * .1.80E+01. * *.** ** ** ... * * * 2*2 * .. ** ** . 3 ** * * .. *2 ** 2 * ** * * .. 22 **. * * .. ** ** .2 * * * * .. * * * ** 2* * * * .. * .** ** .. * 2 .* * 2 * .. ** 2* * * .3.10E+01. * * 4*2. ... * 2 . .. * *******. .. * * . * .. ** * . .DV . * * * ** . * * *.. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.11. Predictions from fit of model (11.2) tophenobarbital data vs observations.Compared to figures 11.7 and 11.9, figures 11.11 and 11.12indicate an improvement in that the number of large negativeresiduals is clearly reduced in both plots.WRES VS. WT-3.50E+00 -2.22E+00 -9.40E-01 WRES 3.40E-01 1.62E+00 2.90E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . .. . * ..* * * ** * *** * * .. . .. . * * * .. * * * * 2 * * * *.. . .. * * * * * . 2 ** * * .. * * * * ** *2 * * 2* 2 * ** * .1.14E+00. . ... * * * * ** 2** ** *** .. * * 2 ** *.2 * * * .. . .. * *2** **3 *** *** * * .. . .. * * * * 3.* * * * .. . .. . .. ** * * 2 * * * .1.78E+00. * ***2* . * * ... . .. * * 2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * . * .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.12. Plot of weighted residuals vs weight for fitof model (11.2) to phenobarbital data.4.6. Using the Tools: Further Improvement4.6.1. An Additional Effect of WTWhile all of the above suggests that model (11.2) issuperior to model (11.1), figure 11.12 shows a persistentlinear relationship between weight and residuals. Thus, theaddition of weight to the model for clearance does not fullyexploit the information in the variable, weight. An obviousmodification to model (11.2) that might deal with this is tohave weight affect V as well as CL. Accordingly, definemodel (11.3) such that (11.3a)=(11.2a), (11.3c)=(11.2c), butV=(&theta;2+&theta;4WT)(1+&eta;2) (11.3b)The model-defining portion of the control stream nowbecomes:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTV=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When model (11.3) is fit to the data, the objective functiondecreases fully 126 relative to model (11.2). Moreover, theestimates of &omega;2CL, &omega;2V, and &sigma;2 are now .050 (CV=22%), .028(CV=17%), and .011 (CV=10%), indicating a furthersubstantial decrease in unexplained variation. The plotscorresponding to 11.7/11.11 and 11.9/11.12 are shown asfigures 11.13 and 11.14.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * *2* .. * *. * * * * * .. *. .. .2 *2* * * .1.80E+01. * *22 * * ... * **5 * .. *22* . * * * * * .. * *4** *. * * * .. 2* * *. * * * .. * * ** * . * 2 * * .. * *2 ** * . 2 * * .. * ** . * * .. * ** 2 * . * * .. * * * * *. * * .3.10E+01. * * *2 . * * * * ... ** . * .. ** 2 * ** * . .. * 2 . .. * * * . .DV . * * * 2 . * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. *.. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.13. Predictions from fit of model (11.3) tophenobarbital data vs observations.Now there are no obvious discrepancies, and the plot ofweighted residuals vs WT shows no pattern, so that it islikely that no further use of weight in the model isrequired. WRES VS. WT-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * . .. * * * * ** . * *** * .. . .. ** * . .. * * * * . * * * * * * .. . .. * ** 2 * ** ** * .. * * 2* 2* 2 * * * *** ** * * .1.14E+00. . ... * * * * .2* 2 * 2 * ** .. * * * * * *** * * * * .. . .. * * **** *** . 2 ***2 * * * .. . .. * * * ** *. * * * * * .. . .. . .. * * 2* * * * * .1.78E+00. * * .* *** * * * ... . .. * * . * * * .. . .. . .WT . * . * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * .. . .. . .. . .. . .. . * * .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.14. Plot of weighted residuals vs weight for fitof model (11.3) to phenobarbital data.4.6.2. The Effect of APGRThe structural model building stage is not over until allavailable independent variables have been examined forinfluence, and there is one additional variable, the Apgarscore, that has not yet been seriously considered. A plotof the weighted residuals from the fit to model (11.3) vsAPGR is shown in figure 11.15.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * * * * ** * * * * .. . .. . .. . .. . .. * * ** * * .. . .. . .. . .2.68E+00. . ... . .. * 2 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * 2 ** . * 2 * 2 ** 2 * .. . .. . .APGR . . .. . .. . .. * * * 2* **2* 2 2 2 *** ** * .. . .6.44E+00. . ... . .. . .. * 2* * * **** *** ***2*22 ** * ** * * * .. . .. . .. . .. . .. * * * * * ** * * *2 * 2*** 2*223 * * * * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* *** * * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.15. Plot of weighted residuals vs Apgar score forfit of model (11.3) to phenobarbital data.There is a weak suggestion from figure 11.15 that for APGRless than 3, the weighted residuals tend to be negative.Accordingly, a new model (11.4) can be proposed, which isidentical to (11.3) except that&theta;2+&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2(11.4b))(&theta;2+&theta;4WT)&theta;5,ifAPGR&le;2The relevant statements for NM-TRAN now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When this model is fit to the data, &theta;5 is estimated to be1.18, implying that indeed, the volumes of distribution forinfants with Apgar scores less than 3 are typically 18%higher than those of infants (of the same weight) withhigher Apgar scores. The measures of improvement are nowmarginal, however: the objective function decreases only3.7, and the decreases in the variances are all less than10% of their previous values, with the variance of &epsilon;actually increasing a few percent. Inspection of figure11.6 suggests a reason for this: note that only 5 distinctindividuals (separate symbols) have Apgar scores less than3. There is simply not very much information about babieswith low Apgar scores in this data set.For completeness, figure 11.16 corresponds to figure 11.5,but using model (11.4), and now shows no distinct pattern.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * 2 * 2 . * * * * .. . .. . .. . .. . .. * * * * . * * .. . .. . .. . .2.68E+00. . ... . .. 3 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * ** * * . 3 * 2 ** * * *.. . .. . .APGR . . .. . .. . .. * * * * 2**2* 22 *2 ** 2 * .. . .6.44E+00. . ... . .. . .. * *2 * * * 2* * * 2 3.*23 2 * * * * * * .. . .. . .. . .. . .. * * * * * ** * **2. ***2* 2*2*3* * ** * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* * *** * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.16. Plot of weighted residuals vs Apgar score forfit of model (11.4) to phenobarbital data.The stage of building the structural model is now complete.5. Building the Statistical Model5.1. Judging Among AlternativesNONMEM can provide estimates of the &eta; variables for eachindividual (see Chapter 12, Sections 4.11-4.13). Plots ofthe estimated interindividual differences, which can beregarded as interindividual residuals, can be obtained.Plots of these residuals (associated with a particular PKparameter) versus the values of an independent variableprovide further help in building the structural part of theparameter model. Moreover, a plot of these residuals versusthe typical values of the parameter (whose values depend oncovariates) also provides help in building the model forinterindividual differences themselves. For example, ifinterindividual differences are modeled with the additivemodel, but the plot shows a linear trend (in the boundariesenveloping the residuals), this suggests that a proportionalmodel be tried.Lastly, help can be provided in the selection of a model forintraindividual error. Predictions of concentrations, andhence residuals, based on estimates of individuals&rsquo; &eta;s, canbe computed, and the residuals can be plotted versus thepredictions. (This requires advanced techniques.) Again,if intraindividual errors are modeled with the additivemodel, but the plot shows a linear trend in the envelope,this suggests that a proportional model be tried.The statistical model is usually of less interest than thestructural model, so that frequently all that is sought isan adequate model, not necessarily the correct one, nor doesone care whether the estimates of the random effectsparameters (the elements of &Omega; and &Sigma;) are particularlyprecise. Sometimes, however, the variability in the randomeffects is of genuine primary interest. In such cases moreattention must be paid to building the random effects model.This, however, may not be easy because it is an unfortunate,but unavoidable fact, that a great deal more data is neededto estimate random effects parameters with a given precisionthan is needed to estimate fixed effect parameters withcomparable precision.The tools used to elaborate the statistical model aresimilar to those used for elaborating the structural model:alternative models are assessed using (available) residualplots, especially ones like those just discussed, andrelative changes in the objective function.5.1.1. Unexplained VariabilityWhen the statistical model is developed, a new &eta; variablemay be added, or an old &eta; variable used differently. Thendifferences in the &omega;s between models cannot really be usedto judge the benefit of the addition, and this evaluationtool becomes less useful. On the other hand, an addition ofan &eta; might be confirmed by a reduction in the estimates ofthe variances in &Sigma;, the variances of the random componentsin the model for residual error. However, there is one suresign that too many &eta;&rsquo;s are in the model: NONMEM mayestimate one or more of the &omega;s to be zero, or very nearlyzero. This can be disconcerting, particularly if the &eta;variable is the only such variable affecting Volume, forinstance, as then this estimate seems to suggest that withrespect to Volume, there is no interindividual variabilityin the population whatsoever! The result should not beinterpreted this way, however. Rather, assuming the &eta;affecting Volume is the one most recently added, itindicates that given the previous statistical model, noadditional variability needs to be ascribed to volume toexplain all the variability seen. The data cannot supportsuch an elaborate statistical model, and a simpler model,such as the previous one, must be used.5.1.2. Residual PlotsThe most important residual plot is now a plot of theweighted residuals against predictions, where a pattern inthe shape of the outer envelope of points can indicatedeficiencies in the statistical model (recall that adistinct pattern in the local &quot;average&quot; residual vs thepredictions would indicate a defect in the structuralmodel). This can be illustrated using the phenobarbitaldata. Figure 11.17 shows the plot of weighted residuals vspredictions for model (11.4), and figure 11.18 shows thesame plot for a modified model, (11.5), identical to (11.4)except fory=F+&epsilon;1 (11.5c)Only the $ERROR statements of the control stream change:$ERRORY=F+ERR(1)WRES VS. PRED-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. 2 . .. * . * .. * . * .. * * . * .1.82E+01. * ** . * * ... * * . 2 * * .. * * * 2 2* *2 2 *3. 2*2 *** *** ** * * .. * * * * * .. . * * .. * *. * .. * . * * 2 * .. * * * * . * * * * * * .. * . * * .. * * ** * * * *.2.74E+01. * . * * ... * * * *.* * * * .. * * . * * .. * * * 2 . * * * .. * * * * * . * * * .PRED . * * . ** * ** * .. .** * .. * . .. . * 2 .. . .3.66E+01. * . * ... * * . ** * .. * . .. * . .. * * . * .. . .. . .. . .. * . .. . .4.58E+01. * . ... . .. . .. . .. . .. . .. . .. . .. .* * .. . .5.50E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.17. Plot of weighted residuals vs predictions forfit of model (11.4) to phenobarbital data (proportionalintraindividual error).Although the plots do not differ greatly, there is a smallsuggestion in figure 11.18 that the envelope of weightedresiduals is somewhat V-shaped with the apex of the V atPRED=0 (but which does not show on the plot), while infigure 11.17 the weighted residuals seem more homogeneous,and their magnitude seems less dependent on that of thepredictions. That this impression is valid is suggestedalso by the increase in objective function of 7.6 in goingfrom model (11.4) to (11.5).WRES VS. PRED-3.20E+00 -2.04E+00 -8.80E-01 WRES 2.80E-01 1.44E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. **. .. * . * .. * .* * * .. * * . .1.80E+01. * * . * ... * * . * * * * .. * * ** * * * 2 **2* 3* *** * * ** .. ** 2 * ** 2* * * * .. .* * .. * .* .. * . 2 * * * .. * * * *. 2 * * .. * . * * ** * .. * .2 * * * .2.70E+01. * * . * ... * * .* * * * * .. * 2 * * * * ..* * * . * * .. * * * * * * . * * * * .PRED . * * . * * ** * .. * . * 2 .. * . * .. . * .. . * * * .3.60E+01. * * . * ... * . * .. * . * .. * * . * .. * . .. . .. . .. . .. . .. * . .4.50E+01. . ... . .. * . .. . .. . .. . .. . .. . .. * . .. . * .5.40E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.18. Plot of weighted residuals vs predictions forfit of model (11.5) to phenobarbital data (additiveintraindividual error).6. Refine ModelThe goal of this stage is to check whether the model is asparsimonious as reasonable, since if it is not, certainimportant parameters may not be estimated with as goodprecision as can be achieved. Although up to this stage,one tries to avoid adding parts to the model which are notwell supported by the data, it is nonetheless possible thata part added at one stage may seem unnecessary after addinganother part at a later stage. Perhaps, for example, weightaffects V, and V and CL are correlated in the population(independent of weight), but first the influence of weighton CL is examined, and later its influence on V is examined(this was the order illustrated above). Then initially,weight might appear to influence CL, although this influencemight only derive from the correlation between the two PKparameters. Later, after the influence of weight on V is apart of the model, the influence of weight on CL mightdisappear. One wants to check this possibility and, ifindicated, eliminate the influence of weight on CL from themodel at the stage now being described. The basic techniqueat this stage, is to run the Covariance Step with the bestmodel thus far, and look for parameters with confidenceintervals that include the parameter&rsquo;s null value, i.e., thevalue that causes the parameter to be effectively deletedfrom the model. A null value is usually zero (for aparameter quantifying an additive portion of the model), andsometimes unity (for a parameter quantifying amultiplicative part of the model). If such parameters arefound, then one at a time, each can be set to its null valueand the consequences examined as discussed above for theearlier model building stages.Figures 11.19 and 11.20 show two pages of NONMEM output froma run fitting model (11.4) to the phenobarbital data, andimplementing the Covariance Step. Figure 11.19 shows thefinal parameter estimates, and 11.20, their standard errors.******************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 57.50E-05 2.66E-02 4.62E-03 9.53E-01 1.18E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 4.59E-02ETA2 0.00E+00 2.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.10E-02Figure 11.19. Parameter estimates from fit of model (11.4)to phenobarbital data.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 59.59E-04 9.24E-02 7.33E-04 7.48E-02 8.36E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.25E-02ETA2 ......... 7.08E-03SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 2.01E-03Figure 11.20. Standard errors of parameter estimates fromfit of model (11.4) to phenobarbital data.6.1. Use of Standard Errors and Confidence IntervalsThe null values of &theta;1 through &theta;4 are zero, while the nullvalue of &theta;5 is unity. Using the numbers from the figures,it is easily seen that for &theta;1 and &theta;2, the parameterestimate minus the null value is a fraction of one standarderror, and hence &theta;1 and &theta;2 may not be different from theirnull values.As indicated in Chapter 5 (Section 4.2.2), an approximate(two-sided) 95% confidence interval for a parameter estimateis&theta;&plusmn;Z.975SEwhere Z.975 is the 97.5 percentile of the normaldistribution (&asymp;2) and SE is the standard error of theparameter estimate. Therefore, for &theta;5, a 95%confidence interval is given by 1.18&plusmn;(2)(.0836), whichis 1.01 - 1.35. This range only barely missesincluding the null value, unity,indicating, as did the marginal change in theobjective function associated with going from (11.3) to (11.4),that one cannot be very sure of the influence of Apgar score onvolume.Finally, note the magnitudes of the standard errors of theother parameters&rsquo; estimates. For &theta;3 it is 16% of theestimate (i.e., the CV of the estimation error is 16%), for&theta;4 it is 7.8%, while for the 2 elements of &Omega; it is 49% and27%. This pattern is typical: the precision of the fixedeffect parameter estimates is considerably greater than thatof the random effects parameter estimates, except when thenumber of individuals sampled is enormous.6.2. A Model RefinementBased on the observation that &theta;1 and &theta;2 may be equal totheir null values, these parameters are next set to theirnull values, defining a new (and final) model,Cl=&theta;3WT(1+&eta;1) (11.6a)&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2) (11.6b)(&theta;4WT)&theta;5,ifAPGR&le;2y=F(1+&epsilon;1) (11.6c)which is communicated to NM-TRAN without changing the$PK or $ERRORstatements, but simply by fixing the values of &theta;1 and &theta;2to 0, using the FIXED option in the $THETA record:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0 FIXED) (0 FIXED) (0,.0018) (0,.43) 1.0When this model is fit to the data, the objective functionincreases only .12 (a trivial change). However, now theCV&rsquo;s of the estimation errors in &theta;3 and &theta;4 are 4.4% and 2.5%respectively.This is the main point of this section on model refinement;deletion of imprecisely estimated parameters can improve theprecision of other parameter estimates. This is related tothe correlation between parameter estimation errors,mentioned in Chapter 5. With little data from patients whoweigh virtually nothing, &theta;1 and &theta;2, the values of CL and Vfor such patients, are not well estimated (regardless of thefact that one might rationally model the values of theseparameters to be 0), and so their parameter estimates arelargely dependent on the estimates of the slope parameters&theta;3, &theta;4, and &theta;5. The correlation between the estimates of &theta;1and &theta;3 is -.96, and that between &theta;2 and &theta;4 is -.95. Ofcourse, since slope itself can only be well determined whenthe intercept is well determined, the parameter estimates of&theta;3, &theta;4, and &theta;5 themselves largely depend on the estimates of&theta;1 and &theta;2; correlations are symmetric. In other words,neither type of parameter (intercept or slope) is veryprecisely estimated since the estimate of each depends onthe value assigned to the other. But if one of theparameters can be eliminated from the model (i.e.,rationally assigned a fixed value), then the other can bemore precisely determined.7. Testing the ModelThis step is undertaken when it is desirable to assignp-values to the hypothesis test of one or more parametervalues against null values. The procedure is as follows:Beginning with the final model resulting from all previoussteps, each parameter to be tested is set, in turn, to itsnull value, and the reduced model is fit to the data (onlythe Estimation Step need be run; no tables, graphs orcovariance output are necessary). A likelihood ratio testis done using the difference in minimum objective functionvalues obtained with both the full (original) and reducedmodels. In doing this one must be careful that in theEstimation Step with a reduced model, no parameter otherthan the one under test (and those which are alreadyconstrained to fixed values under the full model) beconstrained to a fixed value.">1. What This Chapter is AboutIn this chapter, the simple phenobarbital example begun inChapter 2 will be continued to illustrate how NONMEM is usedto build a model for population data. The topic of modelbuilding, diagnosis and verification is a large one. Thischapter can only give a very abbreviated example.2. The Stages of Model BuildingTo analyze a population data set and build a model for it,one must proceed in logical stages. There are five stages,and their relationship to one another is presenteddiagrammatically in figure 11.1. One begins by checking thedata. One then tries to find an adequate modelincorporating the fixed effects; then an adequate modelincorporating the random effects and describing randominter- and intra-individual variability. After a reasonablycomplete model is found, attempts are made to refine it, andfinally, if desired, the various parts of the models (whichoften, in effect, simply assert the existence of certainrelationships between independent variables and thedependent variable) can be subject to formal hypothesistests, as described in Chapter 5. (However, it is wellknown by statisticians that formal hypothesis testingundertaken after model building is just an approximation forthe type of hypothesis testing described in textbooks, whichassumes that the model is the correct model).+chapt11/fig11.1.ubuntu.epsiFigure 11.1. Stages in model building.3. Check-out &mdash; Index PlotsThe goal of this stage is to assure that the data arecorrect. There is no point to trying to model the data whengross errors are present. Most gross errors are encodingerrors that cause certain values to be different from theintended value by a considerable amount (for example, amisplaced decimal point changes a value by a factor of 10),so that graphical display of the data is usually adequate todetect these. No numerical or statistical approaches areneeded. Indeed, they are not usually useful, even for moresubtle errors, as such errors cannot easily be detected byany means (how is a 10% error to be distinguished frominter- or intra-individual variability?).To detect gross errors, then, one makes scatterplots ofdifferent data item types vs individuals&rsquo; identificationnumbers (i.e. the ID data item, or, if the values of thisdata item are arbitrary, another data item that identifiespatients using sequential integer values; call this thesequence data item: SEQ). Such plots (of one data itemversus ID or SEQ) are called here inde_____ plots______ and are quiteuseful for revealing the structure of the data, as will benoted below, as well as for finding gross errors.If NONMEM is used to make index plots, it will also beuseful to implement the Tables Step, so that if a problem isnoted in a scatterplot, one can refer to the table to try tofind the datum that might account for the problem. To runNONMEM some model must be specified, even if all that isdesired is an index plot. In such case, it makes littledifference what model is used. It is easiest and useful to(i) start with a simple ADVAN that is likely to provide atleast a roughly satisfactory fit, (ii) set each PK parameterto a (different) element of &theta;, (iii) use only one &eta;variable, modifying the scale parameter only, and one &epsilon;variable, and (iv) use roughly reasonable fixed initialestimates.For the phenobarbital example, one might use ADVAN1 withK=&theta;1, V=&theta;2+&theta;2&eta;1, and y=f+f&epsilon;1. Initial estimates might be: K= .0057 hr &minus;1 (half-life = 5 days, a typical value foradults); V= 1.44 L. (the first patient has a concentrationof 17.3 mg/L some few hours after an initial loading dose of25 mg; 1.44 times 17.3 = 25); &omega; = .25 (50% variability); &sigma;2= .04 (20% variability).Figures 11.2 and 11.3 show index plots that might be seen ina check-out run (gross errors have been added). In figure11.2, DV is plotted vs ID (here ID and SEQ are the same),and a gross error occurring at about patient #13 is seen (anobservation of about 24 mcg/ml was erroneously recorded as240 mcg/ml). In figure 11.3, AMT is plotted vs ID, andpatient #3 appears to have a grossly erroneous value (again,a decimal point error; a dose of 18 was misrecorded as 180).DV VS. ID0.00E+00 5.00E+01 1.00E+02 DV 1.50E+02 2.00E+02 2.50E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. * * * ** .. * 2 .. * * * .. *** .. 2*** * .. * 2 .. ** * * .. ** * .1.14E+01. ** * * ... * * .. * 3 .. * * .. * * * .. * 2* 2 * .. ** * .. * * * .. 2 * .. 2*2 .2.38E+01. 2 * ... * * * ** * .. * * .. * * * .. * .ID . 2 .. * .. * 2* * .. * * .. * * .3.62E+01. * * * ... * *** ** .. * * * .. * * .. ** * .. ** * .. * * * .. ** * .. * .. * .4.86E+01. * * * *22 ... * * * * .. * ** .. * * * .. * * 2* * .. * .. * .. * * .. 2 ** * * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.2. A scatterplot of the dependent variable, DV,vs the patient&rsquo;s ID number (a type of index plot). Note theoutlier at about ID = 13.Actually, figure 11.3 reveals a considerable amount aboutthe data structure (this will be seen better in figure 11.4,below, when the outlier has been removed). Many points liealong the line AMT = 0, where one sees integers 5, 3, 3, 6,etc, as one proceeds along the ID axis, each integerindicating the corresponding number of points over-plottedat that location. They correspond to the observationrecords, since the doses on these records are all zero.Thus one can see how many observations each individualcontributes (other type records would also plot at AMT=0,however). Proceeding to the next highest &quot;line&quot; of doses(where many points over-plot for each patient), one &quot;sees&quot;the event records giving the maintenance dose amount sincethis amount stays constant within a individual (manymaintenance doses were given per individual), and thisamount is approximately the same across individuals. Last,at the highest doses (except for the outlier), one hasmostly single points. These are the loading doses. Thereis occasional over-plotting of loading-dose points. Thesepoints represent overlapping patient ID numbers (at theresolution of the NONMEM plot ), not multiple loading dosesto the same patient.AMT VS. ID-1.00E+01 3.00E+01 7.00E+01 AMT 1.10E+02 1.50E+02 1.90E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. 5 K * * .. 3 B * .. 3A * .. 3 A * .. 6CB * * .. 3 C * .. 4 C * .. 3 B * .1.14E+01. 4 E* 2* ... 2C 2 .. 4C * .. 2 B * .. 3 D 2 .. 7M 2* .. 32A 2 .. 3 B * .. 3 C 2 .. 5 3 B 2 * .2.38E+01. 3 C * 2 ... 6B ** * .. 2 9 * .. 3 6 * * .. *3 * .ID . 2 B 2 .. * * .. 5 4 6 2 * * .. 2 6 * .. 2 7 2 .3.62E+01. 3 B * ... 6 R ** .. 3 B * .. 2 * * * .. 3 6 * .. 3 6 * 2 .. 3 A 2 .. 38 * .. * 2 .. * 4 * .4.86E+01. 86C * * * ... 494 * * .. 3A * * .. 3A 3 .. 6 B * 4 .. * 6 * .. ** * .. 2 8 2 .. 6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.3. An index plot of the independent variable,dose amount (AMT). Note the outlier at about ID = 3.Figure 11.4 replots the same data as figure 11.3 but withthe misrecorded values of the data items corrected. Figures11.5 and 11.6 show the index plots for the other two dataitems of interest to this data analysis: weight (WT) andApgar score (APGR).AMT VS. ID-1.00E+00 1.34E+01 2.78E+01 AMT 4.22E+01 5.66E+01 7.10E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. ..5 9B * * ..3 B * ..3 A * ..3 A * ..6 CB * * ..3 C * ..4 C * ..3 B * .1.14E+01.4 E * 2 * ...2 C 2 ..4 C * ..2 B * ..3 C* 2 ..7 M 2 * ..3 2A 2 ..3 B * ..3 C 2 ..5 3 B 2 * .2.38E+01.3 C * 2 ...6 47 * * * ..2 9 *..3 6 * * ..* 3 * .ID .2 B 2 ..* * ..5 4 6 2 * *..2 6 * ..2 7 2 .3.62E+01.3 B * ...6 R * * ..3 B * ..2 * * * ..3 6 * ..3 6 * 2 ..3 A 2 ..3 8 * ..* 2 ..* 4 * .4.86E+01.8 6 C * * * ...4 94 * * ..3 A * * ..3 A *2 ..6 38 * 22 ..* 6 * ..* * * ..2 5 3 2 ..6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.4. See figure 11.3; the outlier has beencorrected. WT VS. ID5.00E-01 1.14E+00 1.78E+00 WT 2.42E+00 3.06E+00 3.70E+00. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. G F .. G .. H .. F .1.14E+01. 6 G ... G .. H .. E .. I .. G G .. H .. F .. H .. 7 F .2.38E+01. I ... K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... G J .. F .. 5 .. A .. 2 A .. F .. C .. 3 .. 6 .4.86E+01. D G ... J .. F .. G .. 8 E .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.5. Index plot for weight (WT)APGR VS. ID9.00E-01 2.74E+00 4.58E+00 APGR 6.42E+00 8.26E+00 1.01E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. V .. G .. H .. F .1.14E+01. G 6 ... G .. H .. E .. I .. W ..H .. F .. H .. F 7 .2.38E+01. I ...K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... J G .. F.. 5 .. A ..2 A .. F .. C .. 3 .. 6 .4.86E+01. T ... J .. F .. G .. M .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.6. Index plot for Apgar score (APGR)These plots will be useful in the next stage of modelbuilding.4. Building the Structural Part of the ModelOne must first consider the choice of the structural kineticmodel. For the phenobarbital data, a monoexponentialkinetic model has been chosen. Presumably, the basicstructural kinetics are already known well enough for thiswell studied drug, and it is not necessary to explore thefits of other possible structural kinetic models to the dataat hand. Rather, in this section we focus on the newer taskto most users of NONMEM, the task of building the structuralpart of the model for the PK parameters.4.1. A General ApproachIt is generally advisable to start from the simplestreasonable model, and proceed toward greater complexity,stopping whenever further additions fail to improve themodel fit. Thus, one needs several types of tools: (i)those to choose a &quot;minimal&quot; model, (ii) those to indicatewhat part of a current model needs to be altered orelaborated (called model diagnosis or model criticism), and(iii) those to judge whether an alteration or elaborationhas led to an improved model.With such tools, one proceeds step by step from the minimalmodel, running NONMEM and using the diagnostic tools at eachstep to suggest a single addition for the next step. Theprocess will terminate when the judgement tools indicate noimprovement by any of the additions suggested by thediagnostic tools, or when the diagnostic tools fail tosuggest any more additions.The NONMEM runs at this stage, since there will be many ofthem, should be made as short as possible. To do so, onlythe estimation, table and scatterplot features need be used;the Covariance Step need not, in general, be run.4.2. The Minimal ModelAs suggested above, the minimal model involves the simplestpharmacokinetic model (ADVAN) likely to fit the data, andthe simplest possible structural PK parameter model: eachparameter is simply identified with a separate element of &theta;.At this stage, the statistical model should also be verysimple. Only one, or at most two &eta; variables should bedefined. These will usually affect (first) the scaleparameter (which itself, is often a volume of distributionparameter) and (second) some other parameter influencing theoverall kinetics. Since the overall kinetics exhibited inthe data will usually be dominated by elimination, thesecond &eta; should usually modify the rate constant ofelimination or clearance. However, some (kinetic) data setsare dominated by absorption or distribution, and in suchcases, the second &eta; should probably modify the parametermost affecting these processes. A single &epsilon; should usuallysuffice. Both inter- and intra-individual errors canconveniently be modeled as proportional, so that thedetermination of initial estimates of variances is madeeasier, and all such estimates are on the same scale, butthis is a matter of taste. The model for the phenobarbitaldata defined in Chapter 2 (figure 2.6) almost fulfills thespirit of these restrictions. However, the inter- andintra-individual error models there are additive, ratherthan proportional. The minimal model used on thephenobarbital data in this chapter is therefore a modifiedversion of that used in Chapter 2. It is:CL=&theta;1(1+&eta;1) (11.1a)V=&theta;2(1+&eta;2) (11.1b)y=F(1+&epsilon;1) (11.1c)In (11.1), it is understood that S=V, and that F is theprediction of y from ADVAN1 using CL and V. A control fileto NM-TRAN that specifies this model, and instructs NONMEMto produce the desired output is:$PROBLEM PHENOBARB SIMPLE MODEL (#1)$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PK TVCL=THETA(1)CL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0,.0105) (0,1.05)$OMEGAS .25 .25$SIGMAS .04$ESTIMATION$TABLE ID TIME AMT WT APGR$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS (PRED,WT,APGR)$SCATTERPLOT WRES VS (PRED,WT,APGR)4.3. Use of ConstraintsIt is important to realize that constraints on elements of &theta;or &Omega; may be part of a model.For example, constraining clearance to be positive isa modelling choice. One might implement this constraintin NONMEM using a lower bound on the $THETA record, and this wouldassure that the estimate of clearance will be positive.It may not be necessary to do this; even without the lower bound, the datamight clearly force the estimate to be positive.Often, however, analysts will constrain the range of aparameter in the belief that doing so will shorten computingtime or stabilize the search for the minimum of theobjective function. While this benefit may be gained, thedata may force the parameter estimate to the constraintboundary even though this boundary may not, in fact,represent a true modeling choice. In this case the properaction is to relax the constraint and rerun the problem. Todo otherwise, and leave the parameter estimate to be theboundary value, implies that at the outset the user assumesthat the parameter must be within the boundary and elevatesthe constraint to the status of a modeling choice. If anestimate lies on a boundary, NONMEM will print a warningmessage (along with the standard message regarding thestatus of the termination of the Estimation Step). Thereader is cautioned to look for such a message, and ingeneral, it is a good idea to check the values of the finalestimates against the boundary values. Alternatively, theimplementation of constraints that are not intended torepresent modeling choices might be used cautiously and onlyif they really seem necessary to stabilize a search.4.4. Diagnostic Tools4.4.1. Plot of DV vs PREDMost useful diagnostic tools are graphical. For an overallsense of the fit, a useful diagnostic plot is DV vs PRED.When there are substantial and systematic deviations fromthe line of identity, this plot suggests that there areproblems with the fit, but it does not suggest what exactlythese problems might be or what to do about them. This plotfor the fit of the phenobarbital data to model (11.1) isseen in figure 11.7.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. .* .. . .. * * ** * * .. * * 2 * * * .. .* .. * *2* * * * .1.80E+01. * .*** 2* * ... * * *23 * .. 2 * . *2 **** * .. *2 ***** * * * * .. 22 2. * * .. 3 * ** * ** * .. ** *2 3 * * * .. * . 2 * * .. * ** . * * * * * .. * * *** * * .3.10E+01. ** *2 22 ... * ** . .. * 22*.* * .. * * . * .. * * * . .DV . * * 2 * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.7. Predictions from fit of model (11.1) tophenobarbital data vs observations themselves. The line ofidentity (...) shows where the points should, ideally, fall.Figure 11.7 reveals that there is a group of points wherethe observation is much lower than the prediction. To beginto determine why this is so, it will be useful to look atresidual plots. Such plots are the basis of the mostimportant of the diagnostic tools.4.4.2. Residual PlotsAs mentioned in Chapter 2, a residual is the differencebetween an observation and its prediction. The predictionin this case (the same prediction as denoted by PRED) is thepopulation prediction, i.e. the prediction for the typicalindividual having the given values for all the concomitantvariables.With population data, weighted residuals are often moreinformative than (plain) residuals. The weighted residualsfor an individual are formed by transforming theindividual&rsquo;s residuals so that under the population model,and assuming the true values of the population parametersare given by the estimates of those parameters, all weightedresiduals have unit variance and are uncorrelated. Weightedresiduals are more informative for several reasons. First,since they have unit variance, or what is the same, unitstandard deviation, &quot;large&quot; weighted residuals are thosewith absolute values greater than 3 or so. Second, looselyspeaking, although plain residuals remove the structuralmodel from the data, allowing one to see what part of thedata is not (yet) modeled, they do not remove thestatistical model (formally, they are still correlated).Weighted residuals have both models &rsquo;removed&rsquo; so any patternin these is definitely not accounted for by the currentmodel. This provides a more secure basis for future modelbuilding choices.4.4.2.1. Index Plots of ResidualsFigure 11.8 is an index plot of residuals, which is a usefulplot when combined with index plots of other data items.One can look for an association between unusual residualsand values of another data item. E.g. Are the largestdiscrepancies between model and data associated with certain(possibly extreme) values of the data item?RES VS. ID-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. 2* 2 .. * ** . .. . 2 * .. * 2 . .. * .* 3* .. . * ** .. . 22 .. 2 * .1.14E+01. * **.* ... . * * .. 2 * * .. **. .. * * * .. *** . * 3 .. .* ** .. . *2 .. * * * . .. * * * ** .2.38E+01. * * * . ... * . * * 2 * .. * * . .. * * * .. . * .ID . ** . .. . * .. * * * 2 . .. ** . .. ** . .3.62E+01. * * .* ... ** **** .. * * * . .. 2 .. * * * . .. * * . * .. 2* . .. . *** .. . * .. * . .4.86E+01. * 2 * *2* ... . * * * * .. * * * .. . ** * .. * * 22 .. * . .. . * .. * * . .. *. ** * ** .. . .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 11.8. Index plot of residuals from fit of model(11.1) to phenobarbital data.In the phenobarbital example, this is clearly so: The largenegative residuals (i.e., predictions greater thanobservations), first noted in figure 11.7, are here seen tobe associated with patients 22 to 32 or thereabouts. Infigures 11.4 and 11.5 it is clear that these same patientsare those who received the highest doses and who weigh themost. An obvious explanation, then, of the over-predictionsis that they are in the patients who weigh the most, andbecause weight is not in the model, neither volume norclearance is adjusted to be larger in such individuals, sothat predictions are strictly proportional to dose alone andmay be too large for these heavier patients.4.4.2.2. Plot of WRES vs Independent VariableAnother way to see the association between weight (or dose)and the large residuals is to plot the residual againstweight, say. Figure 11.9 is this plot, but where, forreasons already discussed, weighted residuals, rather thanplain residuals, are used.WRES VS. WT-3.10E+00 -1.92E+00 -7.40E-01 WRES 4.40E-01 1.62E+00 2.80E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . .. . *.. * * . ** * * * * * 2 .. . .. . * * * .. * * . * * * * * * * * .. . .. * * * ** * * *2 * .. * * * * ** 2 ** ** * * **** * * .1.14E+00. . ... * * * ** 2* * ** **** .. * * ** * ** *. ** * * .. . .. * ****2*** .22**2 * .. . .. 2 * ** **.* * * * .. . .. . .. ** *** ** *. * .1.78E+00. * * * ** * *** ... . .. * *2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * * . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.9. Plot of weighted residuals vs weight for fitof minimal model to phenobarbital data.It is clear from figure 11.9, in a way that is particularlycompelling, that it is precisely those individuals with thelargest weight whose residuals are large and negative. Thistype of residual plot, where (weighted) residuals areplotted against some independent variable, is the singlemost useful diagnostic tool.Systematic patterns of weighted residuals, then, suggestpossible model improvements. For an independent variablethat already appears in the model, such a pattern maysuggest that the way in which it enters the model isincorrect; e.g., it might appear as having a linearinfluence on a PK parameter, and a curvilinear influencemight be better, or it might affect additional PKparameters, beyond those it affects in the current model.An example of this will be seen shortly. For a variablethat does not yet appear in the model, as in figure 11.9,such a pattern suggests that the element should appear.Before examining what happens if patient weight is added tothe model, a caution about residual plots is in order.Neither residuals, nor weighted residuals, should ever beplotted against the observations themselves. Such a plotwill always show a correlation, spuriously suggesting aproblem with the model. This is most easily appreciated byconsidering the simple model that gives rise to theconstant-valued prediction given by the the mean of theobservations. All positive residuals (observations greaterthan prediction) must then be associated with observationsgreater than the mean, while all negative residuals must beassociated with observations less than the mean. Clearly,then, the residuals plotted against the observations mustshow a line with positive slope. This same type ofassociation, although to a lesser degree, holds true, evenin less extreme cases. The phenomenon is illustrated infigure 11.10.+chapt11/fig11.10.ubuntu.epsiFigure 11.10. Residuals always correlate with theobservations themselves; the more so, the less the modelexplains the data!4.5. Judging Goodness of FitA more complex model is acceptable only if the complexitycan be justified by some significant improvement in the fit.To evaluate whether this has been accomplished, severalmeasures should be examined; no single measure suffices.In the phenobarbital example, based on the finding in figure11.9, a modified model is suggested. This model, (11.2),has (11.2b)=(11.1b), and (11.2c)=(11.1c), butCl=(&theta;1+&theta;3WT)(1+&eta;1) (11.2a)which is a full model relative to the reduced model (11.1a),whence (11.2) is a full model relative to the reduced model(11.1).Themodel-defining statements to NM-TRAN ($PK and $ERROR) now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))We now examine some measures of goodness of fit, and see how(11.2) fares relative to (11.1).4.5.1. A Global Measure &mdash; Change in the Objective FunctionA global measure of goodness of fit is, of course, theobjective function value based on the final parameterestimates, which, in the case of NONMEM, is minus twice thelog likelihood of the data (see Chapter 5, Section 5.2.3).As noted in Chapter 5, if the new model differs from theprevious model only by the addition of some new variable(s)(so that the two models form a full/reduced model pair),then the difference in objective function values has a known(approximate) statistical distribution. More informally,during model-building, a fall in objective function value of4 when a single new parameter is introduced (and no old onesare eliminated) indicates that the new model hassubstantially improved the overall goodness of fit. Model(11.2) shows a decrease in objective function of 35.2relative to (11.1), indicating considerable improvement.4.5.2. Decrease in Unexplained VariabilityThe purpose of adding independent variables to the model isusually to explain kinetic differences among individuals.This means that prior to adding a variable, such differenceswere not &quot;explained&quot; by the model, and hence were part ofrandom interindividual variability, although thesedifferences could also have been reflected as a part ofrandom intraindividual variability. Accordingly,elaboration of the model should be accompanied by a decreasein the estimates of the variances in &Omega; and/or &Sigma;.The estimates of &omega;2CL, &omega;2V, and &sigma;2 from the fit to Model(11.2) are .057, .12, and .0196, corresponding tocoefficients of variation of 24%, 35%, and 14%,respectively. The corresponding values from the fit to(11.1) are .25 (CV=50%), .14 (CV=37%), and .016 (CV=13%), sothat a considerable reduction in the variance of clearanceis seen.4.5.3. Improvement in PlotsThe last, and most useful, evidence confirming the value ofelaborating a model is to find that the pattern(s) in thePRED vs DV and weighted residual plot(s) that suggested theneed for the addition have now disappeared. Indeed, when amodel is relatively complete, all weighted residual plotsshould show no pattern: the &quot;unexplained&quot; part of the datashould have become featureless random noise.Figures 11.11 and 11.12 correspond to 11.7 and 11.9, but arefrom the fit to model (11.2).PRED VS. DV6.00E+00 2.40E+01 4.20E+01 PRED 6.00E+01 7.80E+01 9.60E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... * .. . .. . .. .* .. . .. * ** * * * ..* * *** * * .. * . .. * ***** * * .1.80E+01. * *.** ** ** ... * * * 2*2 * .. ** ** . 3 ** * * .. *2 ** 2 * ** * * .. 22 **. * * .. ** ** .2 * * * * .. * * * ** 2* * * * .. * .** ** .. * 2 .* * 2 * .. ** 2* * * .3.10E+01. * * 4*2. ... * 2 . .. * *******. .. * * . * .. ** * . .DV . * * * ** . * * *.. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.11. Predictions from fit of model (11.2) tophenobarbital data vs observations.Compared to figures 11.7 and 11.9, figures 11.11 and 11.12indicate an improvement in that the number of large negativeresiduals is clearly reduced in both plots.WRES VS. WT-3.50E+00 -2.22E+00 -9.40E-01 WRES 3.40E-01 1.62E+00 2.90E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . .. . * ..* * * ** * *** * * .. . .. . * * * .. * * * * 2 * * * *.. . .. * * * * * . 2 ** * * .. * * * * ** *2 * * 2* 2 * ** * .1.14E+00. . ... * * * * ** 2** ** *** .. * * 2 ** *.2 * * * .. . .. * *2** **3 *** *** * * .. . .. * * * * 3.* * * * .. . .. . .. ** * * 2 * * * .1.78E+00. * ***2* . * * ... . .. * * 2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * . * .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.12. Plot of weighted residuals vs weight for fitof model (11.2) to phenobarbital data.4.6. Using the Tools: Further Improvement4.6.1. An Additional Effect of WTWhile all of the above suggests that model (11.2) issuperior to model (11.1), figure 11.12 shows a persistentlinear relationship between weight and residuals. Thus, theaddition of weight to the model for clearance does not fullyexploit the information in the variable, weight. An obviousmodification to model (11.2) that might deal with this is tohave weight affect V as well as CL. Accordingly, definemodel (11.3) such that (11.3a)=(11.2a), (11.3c)=(11.2c), butV=(&theta;2+&theta;4WT)(1+&eta;2) (11.3b)The model-defining portion of the control stream nowbecomes:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTV=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When model (11.3) is fit to the data, the objective functiondecreases fully 126 relative to model (11.2). Moreover, theestimates of &omega;2CL, &omega;2V, and &sigma;2 are now .050 (CV=22%), .028(CV=17%), and .011 (CV=10%), indicating a furthersubstantial decrease in unexplained variation. The plotscorresponding to 11.7/11.11 and 11.9/11.12 are shown asfigures 11.13 and 11.14.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * *2* .. * *. * * * * * .. *. .. .2 *2* * * .1.80E+01. * *22 * * ... * **5 * .. *22* . * * * * * .. * *4** *. * * * .. 2* * *. * * * .. * * ** * . * 2 * * .. * *2 ** * . 2 * * .. * ** . * * .. * ** 2 * . * * .. * * * * *. * * .3.10E+01. * * *2 . * * * * ... ** . * .. ** 2 * ** * . .. * 2 . .. * * * . .DV . * * * 2 . * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. *.. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.13. Predictions from fit of model (11.3) tophenobarbital data vs observations.Now there are no obvious discrepancies, and the plot ofweighted residuals vs WT shows no pattern, so that it islikely that no further use of weight in the model isrequired. WRES VS. WT-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * . .. * * * * ** . * *** * .. . .. ** * . .. * * * * . * * * * * * .. . .. * ** 2 * ** ** * .. * * 2* 2* 2 * * * *** ** * * .1.14E+00. . ... * * * * .2* 2 * 2 * ** .. * * * * * *** * * * * .. . .. * * **** *** . 2 ***2 * * * .. . .. * * * ** *. * * * * * .. . .. . .. * * 2* * * * * .1.78E+00. * * .* *** * * * ... . .. * * . * * * .. . .. . .WT . * . * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * .. . .. . .. . .. . .. . * * .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.14. Plot of weighted residuals vs weight for fitof model (11.3) to phenobarbital data.4.6.2. The Effect of APGRThe structural model building stage is not over until allavailable independent variables have been examined forinfluence, and there is one additional variable, the Apgarscore, that has not yet been seriously considered. A plotof the weighted residuals from the fit to model (11.3) vsAPGR is shown in figure 11.15.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * * * * ** * * * * .. . .. . .. . .. . .. * * ** * * .. . .. . .. . .2.68E+00. . ... . .. * 2 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * 2 ** . * 2 * 2 ** 2 * .. . .. . .APGR . . .. . .. . .. * * * 2* **2* 2 2 2 *** ** * .. . .6.44E+00. . ... . .. . .. * 2* * * **** *** ***2*22 ** * ** * * * .. . .. . .. . .. . .. * * * * * ** * * *2 * 2*** 2*223 * * * * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* *** * * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.15. Plot of weighted residuals vs Apgar score forfit of model (11.3) to phenobarbital data.There is a weak suggestion from figure 11.15 that for APGRless than 3, the weighted residuals tend to be negative.Accordingly, a new model (11.4) can be proposed, which isidentical to (11.3) except that&theta;2+&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2(11.4b))(&theta;2+&theta;4WT)&theta;5,ifAPGR&le;2The relevant statements for NM-TRAN now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When this model is fit to the data, &theta;5 is estimated to be1.18, implying that indeed, the volumes of distribution forinfants with Apgar scores less than 3 are typically 18%higher than those of infants (of the same weight) withhigher Apgar scores. The measures of improvement are nowmarginal, however: the objective function decreases only3.7, and the decreases in the variances are all less than10% of their previous values, with the variance of &epsilon;actually increasing a few percent. Inspection of figure11.6 suggests a reason for this: note that only 5 distinctindividuals (separate symbols) have Apgar scores less than3. There is simply not very much information about babieswith low Apgar scores in this data set.For completeness, figure 11.16 corresponds to figure 11.5,but using model (11.4), and now shows no distinct pattern.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * 2 * 2 . * * * * .. . .. . .. . .. . .. * * * * . * * .. . .. . .. . .2.68E+00. . ... . .. 3 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * ** * * . 3 * 2 ** * * *.. . .. . .APGR . . .. . .. . .. * * * * 2**2* 22 *2 ** 2 * .. . .6.44E+00. . ... . .. . .. * *2 * * * 2* * * 2 3.*23 2 * * * * * * .. . .. . .. . .. . .. * * * * * ** * **2. ***2* 2*2*3* * ** * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* * *** * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.16. Plot of weighted residuals vs Apgar score forfit of model (11.4) to phenobarbital data.The stage of building the structural model is now complete.5. Building the Statistical Model5.1. Judging Among AlternativesNONMEM can provide estimates of the &eta; variables for eachindividual (see Chapter 12, Sections 4.11-4.13). Plots ofthe estimated interindividual differences, which can beregarded as interindividual residuals, can be obtained.Plots of these residuals (associated with a particular PKparameter) versus the values of an independent variableprovide further help in building the structural part of theparameter model. Moreover, a plot of these residuals versusthe typical values of the parameter (whose values depend oncovariates) also provides help in building the model forinterindividual differences themselves. For example, ifinterindividual differences are modeled with the additivemodel, but the plot shows a linear trend (in the boundariesenveloping the residuals), this suggests that a proportionalmodel be tried.Lastly, help can be provided in the selection of a model forintraindividual error. Predictions of concentrations, andhence residuals, based on estimates of individuals&rsquo; &eta;s, canbe computed, and the residuals can be plotted versus thepredictions. (This requires advanced techniques.) Again,if intraindividual errors are modeled with the additivemodel, but the plot shows a linear trend in the envelope,this suggests that a proportional model be tried.The statistical model is usually of less interest than thestructural model, so that frequently all that is sought isan adequate model, not necessarily the correct one, nor doesone care whether the estimates of the random effectsparameters (the elements of &Omega; and &Sigma;) are particularlyprecise. Sometimes, however, the variability in the randomeffects is of genuine primary interest. In such cases moreattention must be paid to building the random effects model.This, however, may not be easy because it is an unfortunate,but unavoidable fact, that a great deal more data is neededto estimate random effects parameters with a given precisionthan is needed to estimate fixed effect parameters withcomparable precision.The tools used to elaborate the statistical model aresimilar to those used for elaborating the structural model:alternative models are assessed using (available) residualplots, especially ones like those just discussed, andrelative changes in the objective function.5.1.1. Unexplained VariabilityWhen the statistical model is developed, a new &eta; variablemay be added, or an old &eta; variable used differently. Thendifferences in the &omega;s between models cannot really be usedto judge the benefit of the addition, and this evaluationtool becomes less useful. On the other hand, an addition ofan &eta; might be confirmed by a reduction in the estimates ofthe variances in &Sigma;, the variances of the random componentsin the model for residual error. However, there is one suresign that too many &eta;&rsquo;s are in the model: NONMEM mayestimate one or more of the &omega;s to be zero, or very nearlyzero. This can be disconcerting, particularly if the &eta;variable is the only such variable affecting Volume, forinstance, as then this estimate seems to suggest that withrespect to Volume, there is no interindividual variabilityin the population whatsoever! The result should not beinterpreted this way, however. Rather, assuming the &eta;affecting Volume is the one most recently added, itindicates that given the previous statistical model, noadditional variability needs to be ascribed to volume toexplain all the variability seen. The data cannot supportsuch an elaborate statistical model, and a simpler model,such as the previous one, must be used.5.1.2. Residual PlotsThe most important residual plot is now a plot of theweighted residuals against predictions, where a pattern inthe shape of the outer envelope of points can indicatedeficiencies in the statistical model (recall that adistinct pattern in the local &quot;average&quot; residual vs thepredictions would indicate a defect in the structuralmodel). This can be illustrated using the phenobarbitaldata. Figure 11.17 shows the plot of weighted residuals vspredictions for model (11.4), and figure 11.18 shows thesame plot for a modified model, (11.5), identical to (11.4)except fory=F+&epsilon;1 (11.5c)Only the $ERROR statements of the control stream change:$ERRORY=F+ERR(1)WRES VS. PRED-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. 2 . .. * . * .. * . * .. * * . * .1.82E+01. * ** . * * ... * * . 2 * * .. * * * 2 2* *2 2 *3. 2*2 *** *** ** * * .. * * * * * .. . * * .. * *. * .. * . * * 2 * .. * * * * . * * * * * * .. * . * * .. * * ** * * * *.2.74E+01. * . * * ... * * * *.* * * * .. * * . * * .. * * * 2 . * * * .. * * * * * . * * * .PRED . * * . ** * ** * .. .** * .. * . .. . * 2 .. . .3.66E+01. * . * ... * * . ** * .. * . .. * . .. * * . * .. . .. . .. . .. * . .. . .4.58E+01. * . ... . .. . .. . .. . .. . .. . .. . .. .* * .. . .5.50E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.17. Plot of weighted residuals vs predictions forfit of model (11.4) to phenobarbital data (proportionalintraindividual error).Although the plots do not differ greatly, there is a smallsuggestion in figure 11.18 that the envelope of weightedresiduals is somewhat V-shaped with the apex of the V atPRED=0 (but which does not show on the plot), while infigure 11.17 the weighted residuals seem more homogeneous,and their magnitude seems less dependent on that of thepredictions. That this impression is valid is suggestedalso by the increase in objective function of 7.6 in goingfrom model (11.4) to (11.5).WRES VS. PRED-3.20E+00 -2.04E+00 -8.80E-01 WRES 2.80E-01 1.44E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. **. .. * . * .. * .* * * .. * * . .1.80E+01. * * . * ... * * . * * * * .. * * ** * * * 2 **2* 3* *** * * ** .. ** 2 * ** 2* * * * .. .* * .. * .* .. * . 2 * * * .. * * * *. 2 * * .. * . * * ** * .. * .2 * * * .2.70E+01. * * . * ... * * .* * * * * .. * 2 * * * * ..* * * . * * .. * * * * * * . * * * * .PRED . * * . * * ** * .. * . * 2 .. * . * .. . * .. . * * * .3.60E+01. * * . * ... * . * .. * . * .. * * . * .. * . .. . .. . .. . .. . .. * . .4.50E+01. . ... . .. * . .. . .. . .. . .. . .. . .. * . .. . * .5.40E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.18. Plot of weighted residuals vs predictions forfit of model (11.5) to phenobarbital data (additiveintraindividual error).6. Refine ModelThe goal of this stage is to check whether the model is asparsimonious as reasonable, since if it is not, certainimportant parameters may not be estimated with as goodprecision as can be achieved. Although up to this stage,one tries to avoid adding parts to the model which are notwell supported by the data, it is nonetheless possible thata part added at one stage may seem unnecessary after addinganother part at a later stage. Perhaps, for example, weightaffects V, and V and CL are correlated in the population(independent of weight), but first the influence of weighton CL is examined, and later its influence on V is examined(this was the order illustrated above). Then initially,weight might appear to influence CL, although this influencemight only derive from the correlation between the two PKparameters. Later, after the influence of weight on V is apart of the model, the influence of weight on CL mightdisappear. One wants to check this possibility and, ifindicated, eliminate the influence of weight on CL from themodel at the stage now being described. The basic techniqueat this stage, is to run the Covariance Step with the bestmodel thus far, and look for parameters with confidenceintervals that include the parameter&rsquo;s null value, i.e., thevalue that causes the parameter to be effectively deletedfrom the model. A null value is usually zero (for aparameter quantifying an additive portion of the model), andsometimes unity (for a parameter quantifying amultiplicative part of the model). If such parameters arefound, then one at a time, each can be set to its null valueand the consequences examined as discussed above for theearlier model building stages.Figures 11.19 and 11.20 show two pages of NONMEM output froma run fitting model (11.4) to the phenobarbital data, andimplementing the Covariance Step. Figure 11.19 shows thefinal parameter estimates, and 11.20, their standard errors.******************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 57.50E-05 2.66E-02 4.62E-03 9.53E-01 1.18E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 4.59E-02ETA2 0.00E+00 2.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.10E-02Figure 11.19. Parameter estimates from fit of model (11.4)to phenobarbital data.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 59.59E-04 9.24E-02 7.33E-04 7.48E-02 8.36E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.25E-02ETA2 ......... 7.08E-03SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 2.01E-03Figure 11.20. Standard errors of parameter estimates fromfit of model (11.4) to phenobarbital data.6.1. Use of Standard Errors and Confidence IntervalsThe null values of &theta;1 through &theta;4 are zero, while the nullvalue of &theta;5 is unity. Using the numbers from the figures,it is easily seen that for &theta;1 and &theta;2, the parameterestimate minus the null value is a fraction of one standarderror, and hence &theta;1 and &theta;2 may not be different from theirnull values.As indicated in Chapter 5 (Section 4.2.2), an approximate(two-sided) 95% confidence interval for a parameter estimateis&theta;&plusmn;Z.975SEwhere Z.975 is the 97.5 percentile of the normaldistribution (&asymp;2) and SE is the standard error of theparameter estimate. Therefore, for &theta;5, a 95%confidence interval is given by 1.18&plusmn;(2)(.0836), whichis 1.01 - 1.35. This range only barely missesincluding the null value, unity,indicating, as did the marginal change in theobjective function associated with going from (11.3) to (11.4),that one cannot be very sure of the influence of Apgar score onvolume.Finally, note the magnitudes of the standard errors of theother parameters&rsquo; estimates. For &theta;3 it is 16% of theestimate (i.e., the CV of the estimation error is 16%), for&theta;4 it is 7.8%, while for the 2 elements of &Omega; it is 49% and27%. This pattern is typical: the precision of the fixedeffect parameter estimates is considerably greater than thatof the random effects parameter estimates, except when thenumber of individuals sampled is enormous.6.2. A Model RefinementBased on the observation that &theta;1 and &theta;2 may be equal totheir null values, these parameters are next set to theirnull values, defining a new (and final) model,Cl=&theta;3WT(1+&eta;1) (11.6a)&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2) (11.6b)(&theta;4WT)&theta;5,ifAPGR&le;2y=F(1+&epsilon;1) (11.6c)which is communicated to NM-TRAN without changing the$PK or $ERRORstatements, but simply by fixing the values of &theta;1 and &theta;2to 0, using the FIXED option in the $THETA record:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0 FIXED) (0 FIXED) (0,.0018) (0,.43) 1.0When this model is fit to the data, the objective functionincreases only .12 (a trivial change). However, now theCV&rsquo;s of the estimation errors in &theta;3 and &theta;4 are 4.4% and 2.5%respectively.This is the main point of this section on model refinement;deletion of imprecisely estimated parameters can improve theprecision of other parameter estimates. This is related tothe correlation between parameter estimation errors,mentioned in Chapter 5. With little data from patients whoweigh virtually nothing, &theta;1 and &theta;2, the values of CL and Vfor such patients, are not well estimated (regardless of thefact that one might rationally model the values of theseparameters to be 0), and so their parameter estimates arelargely dependent on the estimates of the slope parameters&theta;3, &theta;4, and &theta;5. The correlation between the estimates of &theta;1and &theta;3 is -.96, and that between &theta;2 and &theta;4 is -.95. Ofcourse, since slope itself can only be well determined whenthe intercept is well determined, the parameter estimates of&theta;3, &theta;4, and &theta;5 themselves largely depend on the estimates of&theta;1 and &theta;2; correlations are symmetric. In other words,neither type of parameter (intercept or slope) is veryprecisely estimated since the estimate of each depends onthe value assigned to the other. But if one of theparameters can be eliminated from the model (i.e.,rationally assigned a fixed value), then the other can bemore precisely determined.7. Testing the ModelThis step is undertaken when it is desirable to assignp-values to the hypothesis test of one or more parametervalues against null values. The procedure is as follows:Beginning with the final model resulting from all previoussteps, each parameter to be tested is set, in turn, to itsnull value, and the reduced model is fit to the data (onlythe Estimation Step need be run; no tables, graphs orcovariance output are necessary). A likelihood ratio testis done using the difference in minimum objective functionvalues obtained with both the full (original) and reducedmodels. In doing this one must be careful that in theEstimation Step with a reduced model, no parameter otherthan the one under test (and those which are alreadyconstrained to fixed values under the full model) beconstrained to a fixed value.</a><br>
<a href="#1. What This Chapter is AboutThis chapter briefly describes a variety of features ofPREDPP and NONMEM that are somewhat advanced for this textbut are of interest to most users of NONMEM. References aregiven to other documents where additional information can befound. Section 2 is concerned with PREDPP, Section 3 isconcerned with user-written PREDs, and Section 4 describesgeneral NONMEM features. Section 5 contains an example thatincludes several of the advanced features. Note that &#9474;wherever $PK, $ERROR, $DES, $AES, $MODEL, $MIX and $PREDstatements are referred to below, user-written subroutines &#9474;PK, ERROR, DES, AES, MODEL, MIX and PRED can be usedinstead.2. Advanced Features of PREDPP2.1. Pharmacodynamic Modeling Using the $ERROR Record$ERROR statements may modify the value of F, the scaled drugconcentration. They may also introduce new &theta; and &eta;variables. This allows pharmacodynamic modeling to beperformed using PREDPP. Such models occur when a studyinvolves measurement of a drug effect, such as bloodpressure. A proposed model might relate the predictedeffect to a pharmacokinetic quantity such as plasma level.PREDPP can be used to model Cp as is usual, and thepredicted effect can be computed in the $ERROR statements.For example, suppose that a modified version of thephenobarbital data of Chapter 2 includes observations ofsome drug effect (in this case, perhaps a measure of thedegree of sedation) but none of the concentrationobservations. The dose event records are the same as thoseof the earlier example. Suppose that the drugconcentrations from each individual have been used toestimate that individual&rsquo;s K and V parameters, and thatthese estimates are now included on every event record forthe individual. Finally, suppose that the proposedstructural model for the effect, E, is an &quot;E-max&quot; model:E=EmaxC50Cp+Cpwhere here Cp is understood to mean the prediction of an individual&rsquo;sdrug concentration in the plasma, andEmax and C50 are PD (pharmacodynamic parameters) modeled asEmax=&theta;1+&eta;1C50=&theta;2+&eta;2To fit this data we can use the control statements of figure12.1. To obtain initial parameter estimates, let us assumethat the following is observable in the data. The averagevalue of all effect measurements is about 50. Acrossindividuals, the average value of the largest effectmeasurement within each individual&rsquo;s data is about 100, andthe average value of the individual&rsquo;s observed concentrationat about half this largest measurement is about 20. (Thisis seen when concentration measurements and effectmeasurements are examined together.) Let us also assume 20%random interindividual variability in Emax and C50 and 4%intraindividual variability in the observation. From thiswe obtain initial estimates of 100 and 20 for &theta;1 and &theta;2,(100&times;.2)2 for &Omega;11, (20&times;.2)2 for &Omega;22, and (50&times;.04)2 for &Sigma;.This example is examined again in in Section 3.2, whichshows the use of $PRED statements, and in Section 5, whichshows how observed concentrations and effects can be fitsimultaneously.References: Users Guide VI (PREDPP) IV.B.2$PROBLEM PHARMACODYNAMIC MODEL USING $ERROR STATEMENTS$INPUT ID TIME AMT INDK INDV DV$DATA EFFDATA$SUBROUTINE ADVAN1$PKK=INDKV=INDVS1=V$ERROREMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*F/(C50+F)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.1. The input to NONMEM-PREDPP for analysis ofeffect observations.2.2. Other Pharmacokinetic Models: ADVAN5 through ADVAN9 &#9474;and ADVAN13Appendix 1 lists ADVAN routines for the most commonly-usedpharmacokinetic models. Other ADVAN routines are:ADVAN5 (General Linear)ADVAN6 (General Nonlinear)ADVAN7 (General Linear with Real Eigenvalues)ADVAN8 (General Nonlinear Kinetics with Stiff Equations)ADVAN9 (General Nonlinear Kinetics with EquilibriumCompartments) &#9474;ADVAN13 (General Nonlinear Kinetics using LSODA)With the general methods the user defines a model of up to &#9474;99 compartments using special options of the $MODEL record.For a linear model (ADVAN5 and ADVAN7), it is sufficient tospecify (directed) compartmental connections and to computetheir rate constant parameters with $PK statements. ADVAN 5and 7 make use of numerical approximations to the matrixexponential. For a nonlinear model (ADVAN6, ADVAN8, ADVAN9, &#9474;and ADVAN13), differential equations must be supplied togovern the kinetics, via $DES statements. It is possible to &#9474;specify initial conditions for the differential equations &#9474;using the I_SS (Initial Steady State) feature. For ADVAN9,algebraic equations may also be supplied via $AESstatements. The use of the term &rsquo;nonlinear&rsquo; with ADVAN 6,8, 9, and 13 only indicates that a system of any type offirst-order differential equations is allowed; suchequations could be linear or non-linear.In all cases, the basic features of PREDPP described inChapter 7 are still available, such as the ability tointroduce doses of any kind to any compartment of the model.It should be noted that the general ADVAN routines arerelatively slow. For example, when a general method is usedfor a model identical to that of an analytic method (ADVAN1 &#9474;through ADVAN4 or ADVAN10 through ADVAN12) the run timeincreases, usually by an order of magnitude.Some ADVAN and SS routines must be told the number ofaccurate digits that are required in the computation of drugamounts, i.e., the relative tolerance. This is specifiedeither by the TOL option of the $SUBROUTINES record or bythe $TOL record.References: Users Guide VI (PREDPP) VI, VIIReferences: Users Guide IV (NM-TRAN) V.C.3, 4, 7-102.3. Zero-Order Bolus DosesInstantaneous bolus doses, which have AMT&gt;0 and RATE=0, aredescribed in Chapter 6. Such doses appear instantaneouslyin the dose compartment. Zero-order bolus doses are dosesthat enter the dose compartment via a zero-order process (inthe same manner as do infusions) except that the rate orduration of the process is computed with $PK statements.When the RATE data item has the value -1, then the $PKstatements must include an assignment statement for anadditional PK parameter, Rn (the &quot;modeled rate forcompartment n&quot;), whose value gives the rate of entry of thedrug during the interval of time between the last eventrecord and the current one. There is a different suchparameter for every compartment receiving a zero-order bolusdose. When the RATE data item has the value -2, then the$PK statements must include an assignment statement for anadditional PK parameter, Dn (the &quot;modeled duration forcompartment n&quot;), whose value at the time of the dose eventgives the duration time of the dose. The rate and durationparameters can be modeled like any other PK parameters; inparticular, the assignment statements can involve &theta;&rsquo;s whichare to be estimated. These parameters can be used to modelthe drug release rate or dissolution time of a tablet orcapsule.Steady-state levels involving zero-order bolus doses can becomputed.Steady-state with constant infusion was described in Chapter6. Steady-state infusions may also have modeled rates(i.e., the RATE data item may be -1).References: Users Guide VI (PREDPP) III.F.3, F.42.4. The Additional Dose Data Item: ADDLADDL is a dose-related data item that is used to requestthat a given number of additional doses, just like the dosespecified on the event record, be added to the system at aregular time interval, starting from the time on the eventrecord. PREDPP itself adds these doses at the appropriatefuture times; no actual dose event record is generated bythe Data Preprocessor or by PREDPP. A positive integervalue in ADDL specifies how many additional doses (i.e., inaddition to that already specified in the event record) areto be given, and the value in the II (interdose interval)data item (which is required) specifies the time intervalbetween doses.ADDL may be non-zero on a steady-state dose event record(except for steady-state infusions), in which caseadditional doses are given, maintaining the dosing regimeninto the future. Non-steady-state kinetic formulas are usedto advance the system between each additional dose. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) V.K2.5. Lagged doses: the ALAG ParameterPREDPP permits an additional PK parameter called anabsorption lag time. One such parameter can be defined foreach compartment and applies to all doses to thatcompartment. It gives the amount of time that a dose isheld as a &quot;pending&quot; dose. When the absorption lag time hasexpired, the dose is input into the system. In effect, thevalue of the absorption lag time parameter is added to thevalue of the TIME data item on the dose event record. WithNM-TRAN, recognized names for absorption lag time parametershave the form ALAGn, where n is the compartment number. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) III.F.6References: Users Guide IV (NM-TRAN) V.C.5 &#9474;2.6. Model Event Times: MTIME &#9474;Model event times MTIME(i) are additional PK parameters &#9474;defined in the PK routine or $PK block. A model event time &#9474;is not associated with any compartment, but, like an &#9474;absorption lag time, defines a time to which the system is &#9474;advanced. When the time is reached, indicator variables are &#9474;set and a call to PK is made. At this call (and/or &#9474;subsequent to this call) PK or DES or AES or ERROR can use &#9474;the indicator variables to change some aspect of the &#9474;system, e.g., a term in a differential equation, or the rate &#9474;of an infusion.2.7. Controlling Calls to PK and ERRORIn order to evaluate the $PK and $ERROR statements, PREDPPcalls the PK and ERROR subroutines. By default, thesubroutines are called with every event record. PREDPP maybe instructed to limit calls to certain event records inorder to save the computing time involved with unnecessarycalls (e.g. when the PK parameters do not vary from eventrecord to event record within an individual). It is alsopossible to cause the PK subroutine to be called at timeswhich do not correspond to any actual event record.Using NM-TRAN, calls to PK are controlled by the presence ofone of the following pseudo-statements, at the start of the$PK block:CALLFL=-2:call with every event record, at additional and lagged &#9474;dose times, and at modeled event times.CALLFL=-1:call with every event record (default).CALLFL=0:call with the first event record of each individualrecord and with new values of TIME.CALLFL=1:call once per individual record.A callin_______ protoco________ phras______ may be used instead of a &#9474;pseudo-statement. A calling protocol phrase may use upper- &#9474;or lower-case characters. It must be enclosed in &#9474;parentheses. NM-TRAN can understand minor variations in the &#9474;wording. E.g., the word &quot;CALL&quot; and prepositions such as &#9474;WITH can be omitted. Here are calling protocol phrases &#9474;equivalent to the above four pseudo-statements, &#9474;respectively. &#9474;(CALL WITH NON-EVENT TIMES) &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH FIRST EVENT RECORD AND NEW TIME) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;The choice CALLFL=-2 (CALL WITH NON-EVENT TIMES) is intended &#9474;to be used when PK parameters Dn and/or Fn apply toadditional or lagged doses and the model for theseparameters depends on some time-varying concomitant variablesuch as type of drug preparation or patient weight. Bydefault, the values of the PK parameters which apply to thedose are those values computed by PK with the first eventrecord having a value of TIME greater than the time at whichthe dose actually enters the system (the additional orlagged dose time). However, if PREDPP is instructed to alsocall PK at the additional or lagged dose time, then thevalues of the PK parameters are those values computed atthese special calls. At such calls, PK has available to itinformation from the initiating dose event record itself,and information from the two event records whose TIME valuesbracket the additional or lagged dose time. Along withCALLFL=-2 in the $PK block, the NM-TRAN $BIND record may beuseful; see Users Guide IV.Using NM-TRAN, calls to ERROR are controlled by the presenceof one of the following pseudo-statements at the start ofthe $ERROR block:CALLFL=-1: call with every event record (default).CALLFL=0: call with observation events only.CALLFL=1: call once per individual record.A calling protocol phrase may be used instead of a &#9474;pseudo-statement. As in the $PK block, the calling protocol &#9474;phrase may use upper- or lower-case characters and must be &#9474;enclosed in parentheses. &#9474;Here are calling protocol phrases equivalent to the above &#9474;three pseudo-statements, respectively. &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH OBSERVATION EVENTS) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;NM-TRAN automatically instructs PREDPP to limit calls toERROR to once per problem for the simple error modelsdiscussed in Chapter 8, Sections 3.1 and 3.2:Y=F+ERR(1)Y=F+F*ERR(1)Y=F*(1+ERR(1))Y=F*EXP(ERR(1))During the Simulation Step, PREDPP ignores any limitationand calls the ERROR subroutine with every event record.Even when calls to PK and/or ERROR are limited, the CALLinput data item can be used to force additional calls forspecific event records as needed.References: Users Guide VI (PREDPP) III.B.2, III.H, IV.C,V.JReferences: Users Guide IV (NM-TRAN) V.C.5, C.62.8. Transgeneration of Input Data: the INFN SubroutineNONMEM may be used to modify the data records before anycomputations are performed and also after all computationshave been performed. This is referred to as transgeneratio_______________of the data. Transgeneration at the beginning of a problemcan be used, for example, to change weight-normalized dosesto unnormalized doses. PREDPP allows the user to supply asubroutine called INFN (&quot;initialization/finalization&quot;) inwhich transgeneration can be performed. (The PREDPP libraryincludes a default INFN subroutine which does nothing.)References: Users Guide VI (PREDPP) VI.A3. User-written PRED SubroutinesIt is not necessary to use PREDPP with NONMEM. Either $PREDstatements or a user-written PRED subroutine may be used inplace of PREDPP to supply NONMEM with predicted values forthe DV data item according to some (not necessarilypharmacokinetic) model. An example using $PRED statementsis given here. A special caveat applies to user-writtenPRED subroutines that are recursive: see 4.6 below.References: Users Guide I (Basic) C.23.1. Required Data ItemsThe only required data items when PREDPP is not used are theNONMEM data items DV, MDV, and ID. When PREDPP is used, theData Preprocessor is able to recognize which records containobserved values and which do not, and it supplies the MDVdata item if it is not already present in the data file.When PREDPP is not used, the Data Preprocessor cannot dothis. The input data file must already contain the MDV dataitem if it is needed, i.e., if the DV item of some datarecord does not contain a value of an actual observation.If $PRED statements are used, they must calculate a variablecalled Y, using input data items and NONMEM&rsquo;s &theta;, &eta;, and (forpopulation models) &epsilon; vectors in the calculation.References: Users Guide I (Basic) B.1References: Users Guide IV (NM-TRAN) III.B.83.2. An Example of $PRED Statements: PharmacodynamicModelingThe syntax of $PRED statements is essentially the same asdiscussed for $PK and $ERROR statements. $PRED statementscan be used for simple pharmacokinetic and pharmacodynamicmodels. In figure 12.1 above an example was given ofpharmacodynamic modeling using $ERROR statements. Supposethat in that example, drug concentration is always measuredat the same time as drug effect. Suppose too, that ratherthan input the individuals&rsquo; values of K and V and use themto compute a predicted drug concentration for theindividual, the observed drug concentration itself is usedin the Emax model. This means that the the observedconcentrations are again incorporated into the data, but nowas values of an independent variable, rather than as the DVdata item. This also means that a pharmacokinetic model isnot needed, and therefore, PREDPP is not needed either.Figure 12.2 shows the control stream for this new example.$PROBLEM A SIMPLE PHARMACODYNAMIC MODEL$INPUT ID TIME CP DV$DATA EFFDATA$PREDEMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*CP/(C50+CP)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.2. The input to NONMEM including $PRED statementsfor analysis of effect data.4. Advanced Features of NONMEM4.1. Full Covariance Matrices: $OMEGA BLOCK and $SIGMABLOCKIn the examples of Chapter 2 and 9, there appearedstatements such as:$OMEGA .0000055, .04This is an example of the specification of initial parameterestimates for a variance-covariance &Omega; matrix which isconstrained to be diagonal. Initial estimates are given forthe variances of &eta;1 and of &eta;2. The covariance between &eta;1and &eta;2 is constrained to be 0, i.e., &omega;12=cov(&eta;1,&eta;2)=0.Another way of writing this statement is:$OMEGA DIAGONAL(2) .0000055, .04The option DIAGONAL(2) states explicitly that the blockcontains two &eta;s and that it has diagonal form.If the data supports the possibility that &eta;1 and &eta;2 covarywith each other, it may be useful to model &Omega; as beingunconstrained and allow NONMEM to estimate the covariance.A special form of the $OMEGA record is used, in whichinitial values are supplied for both variances and thecovariance. For example:$OMEGA BLOCK(2) .0000055, .0000001, .04The option BLOCK(2) states that there are two &eta; variables inthe block, and that covariance is to be estimated. The newelement is &omega;12=&omega;21=cov(&eta;1,&eta;2)=cov(&eta;2,&eta;1)=1&times;10&minus;7.$OMEGA BLOCK is used for both population and individualstudies, i.e., it is the same whether &eta; is used in the firstcase in a model for residual error or is used in the secondcase in a model for random interindividual error. In apopulation study, if there is more than one &epsilon; variable, andthe model allows these variables to covary, then $SIGMABLOCK is used in a similar manner.The initial estimates of even more complicated &Omega; and &Sigma;matrices may be given using multiple $OMEGA and $SIGMArecords. For example, the initial estimates of a mixture ofcorrelated and uncorrelated random variables may given.Also, in this context (as with the simple form of the $OMEGAand $SIGMA records described in Chapter 9, Section 3)variances-covariances may be constrained to fixed values bymeans of the FIXED option. Finally, somevariances-covariances may be constrained to equal others bymeans of the BLOCK SAME option. The ability to fix allvariances-covariances in both &Omega; and &Sigma; allows Bayesianestimates to be obtained of the pharmacokinetic parametersof a single individual, based on the individual&rsquo;s data and aprior population distribution for the parameters.References: Users Guide IV (NM-TRAN) III.B.104.2. Grouping Related Observations: The L1 and L2 DataItemsThe $ERROR statements for a problem may sometimes involvemore than one random variable. For example, there may betwo types of observations. One type may be an observationfrom one compartment of a PK system, or with one assay orpreparation, and another type may be an observation from adifferent compartment or with a different assay orpreparation. The model for the two types of observationswould typically involve at least two &epsilon; variables (e.g.(3.8)). If all observations are made at sufficientlyseparated times, there may be little reason to be concernedabout correlation between the two random errors. However,if the two types of observations are taken at the same orvery close to the same time, it is possible that correlationwill exist; whatever circumstance has influenced oneobservation to be different from the predicted level mayalso have some influence on the other observation. In thiscase a covariance between the two &epsilon; variables should beallowed, as described above in Section 4.1. Then the twotypes of observations at the same time point are regarded astwo elements of a multivariat____________ observation____________In the case of population data, there exists a NONMEM dataitem, L2, which is used to identify the elements of amultivariate observation. In effect, L2 acts in a similarway as ID, but grouping observations within individualrecords.In the case of individual data, the ID data item alreadyserves this purpose: it forms groups of observations whose&eta; variables may be correlated. Thus, in the input datafile, the ID data item should be the same for thoseobservations which may have correlated &eta;s. However, forindividual data, the Data Preprocessor normally replaces theID data item with a new set of values which describe everyobservation as being independent of the others. To preventthe Data Preprocessor from doing this, L1 should be includedin the $INPUT record as the name or synonym for theuser-supplied ID data item.References: Users Guide IV (NM-TRAN) II.C.4, III.B.2References: Users Guide II (Supplemental) D.34.3. Continuing a NONMEM Run: MSFO and MSFI &#9474;The MSFO (Model Specification Output File) option of the$ESTIMATION record instructs NONMEM to write a Mode_____Specificatio_____________ Fil____ (MSF)______ It is created when NONMEM writes &#9474;the first iteration summary to the intermediate output file, &#9474;and is re-written when every subsequent iteration summary is &#9474;written. This file can then be read in a subsequent NONMEMrun using a $MSFI (Model Specification File Input) record.This file has much of the information about the model usedin the previous run, thus the name &quot;Model SpecificationFile&quot;. It also contains all the information that allows theEstimation Step from the previous run (which may haveterminated, for example, due to the number of functionevaluations exceeding its limit or a computer crash or some &#9474;other externally-caused interruption of the NONMEM run) tobe continued in the subsequent run. There are a number ofbenefits to using a MSF. First, what might be a longEstimation Step (due to a very lengthy search) can be splitover a series of runs, each with a limited number offunction evaluations. Any run which terminates prematurelydue to computer failure can be restarted from the MSF outputin the previous run. (This provides a &quot;checkpoint/restart&quot;capability.) The progress made in the Estimation Step canalso be evaluated between runs, and a decision made as towhether it is worth continuing a search which is consumingexcessive amounts of computer time. Second, the Covariance,Tables, and Scatterplot Steps can be performed in laterruns, each using the MSF from the final run with theEstimation Step. It is advisable to perform the CovarianceStep only after satisfactory results have been obtained fromthe Estimation Step.References: Users Guide I (Basic) C.4.4References: Users Guide IV (NM-TRAN) III.B.6, B.124.4. NONMEM Can Obtain Initial Estimates for &theta;, &Omega;, &Sigma;NONMEM can be directed to obtain initial estimates for oneor more elements of &theta;, &Omega;, or &Sigma;. This is done in a separateInitial Estimates Step. For an element of &theta;, omit theinitial estimate but include lower and upper bounds, e.g.,(1, ,50) in the $THETA record. (The NUMBERPOINTS option maybe used to control the number of points in &theta; space examinedby NONMEM during the search for initial estimates of &theta;.)For a block of &Omega; or &Sigma;, omit all initial estimates on the$OMEGA BLOCK (or DIAGONAL) record, or $SIGMA BLOCK (orDIAGONAL) record, respectively.Note that when $PK and $ERROR statements are present but the$OMEGA and/or $SIGMA records are absent, NONMEM will bedirected to obtain initial estimates for the variances ofthe random variables in question, assuming the diagonal formof the matrix.References: Users Guide IV (NM-TRAN) III.B.9-114.5. Improving Parameter Estimates: REPEAT and RESCALEThe Estimation Step can be immediately repeated after thesearch has terminated successfully, by including the REPEAToption on the $ESTIMATION record. This can improve theaccuracy of the parameter estimates when one or more initialestimates are wrong by a few orders of magnitude. The finalestimates from the first implementation of the EstimationStep are used as the initial estimates of the secondimplementation, and thus the scaling used with the STP isdifferent from that with the first implementation, allowingfewer leading zeros after the decimal point in the STP.When the Estimation Step is continued by means of a ModelSpecification File, similar rescaling can be requested usingthe RESCALE option of the $MSFI record.References: Users Guide IV (NM-TRAN) III.B.12, B.14References: Users Guide II (Supplemental) F4.6. The Covariance Step: R&minus;1, S&minus;1, Special ComputationThe Covariance Step, which computes standard errors of theparameter estimates, first computes a covariance matrix ofthe parameter estimates. (This is not the same as the &Omega; or&Sigma; matrix). It is possible to request that this covariancematrix be computed in one of three different ways: either asR&minus;1, S&minus;1, or R&minus;1SR&minus;1 (the default), where R and S are twomatrices from statistical theory, the Hessian andCross-Product Gradient matrices, respectively. OptionsMATRIX=R and MATRIX=S of the $COVARIANCE record are used torequest the R&minus;1 and S&minus;1 matrices, respectively. TheCovariance Step can produce additional output. When thedefault covariance matrix is used, R&minus;1 and/or S&minus;1 can beprinted. This is requested by options PRINT=R and/orPRINT=S. Eigenvalues are be printed if requested by optionPRINT=E. Multiple PRINT options can be specified.A special computation is required when the data are from asingle individual and a recursive PRED is used. A recursivePRED is one which stores the results of certain computationsusing the values from one event record, and uses theseresults in later computations with the values from a laterevent record. PREDPP advances the kinetic system from onetime point to the next and therefore is an example of arecursive PRED. When PREDPP is used and the data is from asingle individual, NM-TRAN automatically requests thespecial computation. When a recursive user-written PRED isused and the data are from a single individual, the SPECIALoption of the $COVARIANCE record must be used.The CONDITIONAL option of the $COVARIANCE record requeststhat the Covariance Step be implemented only if EstimationStep terminates successfully, and is the default. TheUNCONDITIONAL option can be used to request that it beimplemented no matter how the Estimation Step terminates.References: Users Guide IV (NM-TRAN) III.B.15References: Users Guide II (Supplemental) D.2.54.7. Multiple Problems in a Single NONMEM RunNONMEM can implement more than one problem in a single run.That is, the input control stream can contain more than one$PROBLEM record, each followed by its own set of problemspecification statements. This feature can be useful in avariety of situations. A series of what otherwise would beseparate runs, each analyzing a single individual&rsquo;s datawithin a population data file, can be performed convenientlywithout building separate data files for each individual.Also, more than one data set can be analyzed using the samemodel and the same problem specification. Multiple problemsare also useful with NONMEM&rsquo;s Simulation Step, describedbelow.Note that abbreviated code such as $PK and $ERROR statements &#9474;cannot appear after the first problem. If the $DATA recordis omitted or the filename is specified as * on a $DATArecord in a problem subsequent to the first, the previousdata set is re-used.A sequence of problems may be defined to be a superproble____________ &#9474;by means of the NM-TRAN $SUPER record, and NONMEM may also &#9474;be directed to repeat them a specific number of times.References: Users Guide IV (NM-TRAN) III.B.14.8. Simulation Using NONMEM: The $SIMULATION RecordThe term simulatio__________ refers to the generation of data pointsaccording to some model. A simple form of simulation isperformed when the Estimation Step is omitted but the TableStep is implemented. The PRED column of the table containspredictions based on the information in the data records andthe initial estimates of &theta;, under the model specified in thePRED (PREDPP) subroutine. Random variables &eta; and &epsilon; (if any)have no effect on the predictions and may be omitted. Ifthe only purpose of the run is to obtain simulated values,and these variables are present, it is best (but notrequired) that their variances be fixed to 0. NONMEM doesnot compute the objective function in this circumstance,which has certain advantages.NONMEM can also perform a Simulation Step, in which anothertype of simulation is performed. In the Simulation Step,each value of the DV data item of each record with MDV=0 isreplaced by a simulated observation generated from themodel, but including statistical variability&dagger;.<cite>&dagger; During the Simulation Step, values of F computed by PREDor PREDPP for records having MDV=1 are irrelevant and areignored by NONMEM. </cite>The PRED (PREDPP) routine uses &eta; and &epsilon; values that aresupplied by NONMEM according to user-specified randomdistributions (e.g., with variances given by the initialestimates of &Omega; and &Sigma;). If &Omega; and &Sigma; matrices are fixed tozero, for example, the simulated values are the same as thepredictions described above.If the data are then displayed by the Table Step, the DVcolumn for records with MDV=0 contains the simulatedobservations obtained from the Simulation Step. For recordshaving MDV=1, the DV column contains whatever was in theoriginal data record. The PRED column of the table containspredictions as described above. If the Estimation Step wasnot implemented, the values of &theta; used for these predictionsare the initial values. If the Estimation Step wasimplemented, the values of &theta; used for the predictions in thePRED column are the final parameter estimates. Note thatthe observations that are fit during the search are thesimulated values obtained by the Simulation Step.Often data are simulated using the Simulation Step, thenanalyzed using one or more other steps (e.g. Estimation andCovariance Steps), and this process is repeated a fixednumber of times, using the same model. The Simulation Stepaccommodates this easily with the notion of a NONME______subproblem___________ whereby these steps are repeated within the sameNONMEM problem. However, on occasion it can be useful tohave multiple problems (see Section 4.7), where one problemimplements the Simulation Step, and the subsequent problemimplements other steps. For example, this is one way toobtain different initial parameter estimates for theEstimation Step than for the Simulation Step.The ONLYSIMULATION option causes NONMEM to suppressevaluation of the objective function. With this option,PRED-defined variables displayed in tables and scatterplots(see Section 4.13) are simulated values, i.e., use simulated&eta;s and initial &theta;s, and weighted residual values in tablesand scatterplots are always 0.References: Users Guide IV (NM-TRAN) III.B.13References: Users Guide VI (PREDPP) III.E.2, L.1 , IV.B.1-2,C, G.14.9. Files for Subsequent Processing: the $TABLE RecordNONMEM can write the data for a table to an externalformatted file, as requested by the FILE option of the$TABLE record. Other computer programs can read thesefiles. Such programs can perform further analysis orprovide improved graphical displays. These files normallycontain header lines similar to those in a printed table,but the header lines can be suppressed entirely or in partby means of the NOHEADER or ONEHEADER options, respectively.Tables may be written to the same or to different table &#9474;files.References: Users Guide IV (NM-TRAN) III.B.164.10. Data Checkout ModeNONMEM&rsquo;s data checkout mode is intended for preliminarydisplay of data without the use of a model. In datacheckout mode, the PRED routine is not called. Predictions,the objective function, residuals, and weighted residualsare not computed. Only the Table and Scatterplot Steps canbe implemented in the problem. With NM-TRAN, this mode isrequested by coding the option CHECKOUT on the $DATA record.A $SUBROUTINES record and abbreviated code are required, butthey have no effect and need only be syntactically correct.References: Users Guide IV (NM-TRAN) III.B.64.11. Obtaining Individual Parameter Estimates -Conditional Estimates of &eta;sWith population data, NONMEM can obtain estimates ofindividual-specific true values of &eta; from any given set ofvalues of &theta;, &Omega;, &Sigma;, and the individual&rsquo;s data. These arecalled conditiona___________ estimates of &eta;. When the conditionalestimates are obtained after estimation is carried out bythe First-Order method, they are referred to as &quot;posthoc&quot;estimates. With NM-TRAN, they are requested by the optionPOSTHOC on the $ESTIMATION record.References: Users Guide IV (NM-TRAN) III.B.144.12. Population Conditional Estimation MethodsNONMEM can obtain conditional estimates of &eta; variables aspart of the computation of population parameter estimates.These are called conditiona___________ estimatio__________ methods________ WithNM-TRAN, such methods are requested by including the optionMETHOD=CONDITIONAL (or METHOD=1) on the $ESTIMATION record.(The option METHOD=ZERO, or METHOD=0, requests theconventional First-Order method and is the default.) Thereare two conditional estimation methods. If NONMEM uses onlyfirst-order approximations, this is the First-Orde___________Conditiona___________ Estimatio__________ Method_______ This has one variation,interaction____________ which takes into account &eta;-&epsilon; interaction and isrequested by the additional option INTERACTION on the$ESTIMATION record. If NONMEM uses a certain second-orderapproximation, this is the Laplacia_________ method, which isrequested by the additional option LAPLACIAN on the$ESTIMATION record. Interaction cannot be specified withthe Laplacian method.Note that this usage of the term CONDITIONAL is differentfrom the usage on the $SCATTERPLOT, $TABLE, and $COVARIANCErecords, in which it refers to the circumstances under whichthe step in question is implemented.References: Users Guide IV (NM-TRAN) III.B.144.13. Displaying PRED-Defined Variables and ConditionalEstimates of &eta;sNONMEM can display PRED-defined variables in table andscatterplots. With NM-TRAN, any variable appearing on theleft-hand side of an assignment statement in abbreviatedcode can be displayed by listing it in a $TABLE or $SCATTERrecord. If the data are population, NONMEM can also displayconditional estimates of &eta;. With NM-TRAN, variables ETA(1),ETA(2), etc., can be simply listed in $TABLE and $SCATTERrecords. When conditional estimation is not performed, thevalues displayed are zero. Displayed values of PRED-defined &#9474;random variables will use conditional estimates of &eta; if theyhave been obtained, otherwise they will be typical values.This feature is available with PREDPP, as well as withuser-written PRED routines. For example, the followingrecords could replace the $ESTIMATION record in Figure 12.2:$ESTIMATION POSTHOC$TABLE ETA(1) EMAXThe $ABBREVIATED record can be used to limit the number ofvariables available for display when the number isexcessive.References: Guide III (Installation) V.2.4References: Guide IV (NM-TRAN) III.B.16-17References: Guide VI (PREDPP) III.J, IV.E4.14. Mixture ModelsA mixtur_______ mode_____ is a model that explicitly assumes that thepopulation consists of two or more sub-populations, eachhaving its own model. For example, with twosub-populations, one might assume that some fraction p ofthe population has one set of typical values of the PKparameters, and the remaining fraction 1-p has another setof typical values. Both sets of typical values and themixing fraction p may be estimated. For each individual,NONMEM also computes an estimate of the number of thesubpopulation of which the individual is a member. The usermust supply a FORTRAN subroutine called MIX or a $MIX block &#9474;of abbreviated code to compute the fractions p and 1-p.References: Users Guide VI (PREDPP) III.L.24.15. PRED Error Return Codes and Error Messages in FilePRDERRA PRED routine can return a PRE____ erro_____ retur______ cod____ (1 or 2)to NONMEM, indicating that it is unable to compute aprediction for a given data record with the current valuesof &theta;&rsquo;s and &eta;&rsquo;s. For example, PREDPP returns error returncode 1 when a basic or additional PK parameter has a valuethat is physically impossible (e.g., a scale parameter whichis zero or negative). Error return codes can also bespecified by the user in user-written code or in abbreviatedcode using the EXIT statement. One reason for doing this isto constrain parameters in order to avoid floating pointmachine interrupts. The PRE____ erro_____ recover________ optio______determines what action NONMEM will take. With NM-TRAN, thePRED error recovery option is either ABORT (which is thedefault) or NOABORT, and is specified on the $ESTIMATION and$THETA records.If an error return code is returned during the Simulation,Covariance, Table or Scatterplot Step, or during computationof the initial value of the objective function, NONMEM willabort. If the error return code is returned during theEstimation or Initial Estimates Step, NONMEM will try toavoid those values of &theta; and &eta; for which the error occurs. Ifthey cannot be avoided, NONMEM&rsquo;s actions depend on the errorreturn code value, as follows:1 If NOABORT is specified on $ESTIM or $THETA, try toavoid the current values of &theta; and &eta;. If ABORT isspecified on $ESTIM or $THETA, then abort.2 Abort in all cases.PRED routines may optionally provide text accompanying theerror return code. NONMEM writes all text associated witherror return codes to a file, PRDERR. The contents of thisfile should always be carefully reviewed.References: Users Guide III (Installation) III.2.1.1References: Users Guide IV (NM-TRAN) IV.A, IV.C.5-6References: Users Guide VI (PREDPP) III.K, IV.F4.16. User-Written SubroutinesAlthough most NONMEM applications can be accomplished usingNM-TRAN abbreviated code, there are cases in whichuser-written FORTRAN subroutines are needed. The$SUBROUTINES record allows the user to specify the names ofuser-written routines that are needed in the NONMEM loadmodule. A user may choose to write his own PRED, PK, ERROR,MODEL, DES, or AES subroutine. Some subroutines that aredistributed with NONMEM are dummy, or &quot;stub&quot; routines, thatdo nothing. Of these, subroutines CCONTR, CONPAR, CONTR,and CRIT can be replaced to obtain an objective functiondifferent from the default. NONMEM subroutine MIX must bereplaced for mixture models. PREDPP subroutine INFN may bereplaced by user-written code. The names of all suchroutines are specified using the identically named optionsof the $SUBROUTINES record, e.g., PRED=subname,CONTR=subname, etc. User-written routines may call otherFORTRAN subroutines, which can be specified for inclusion inthe load module using the option OTHER=subname.With user-written CONTR routines, the NM-TRAN $CONTR recordmay be useful.References: Users Guide IV (NM-TRAN) III.B.4, B.6 &#9474;4.17. PRIOR &#9474;The PRIOR subroutine and $PRIOR record allows a Bayesian &#9474;penalty function to be added to the NONMEM objective &#9474;function. This serves as a constraint on the estimates of &#9474;THETA, OMEGA, and SIGMA and thus as a way for stable &#9474;estimates to be obtained with insufficient data. &#9474;References: Introduction to NONMEM Version VI5. Observations of Two Different TypesAn NM-TRAN control stream is shown in Figure 12.3, for theanalysis of a data set which contains observations of twodifferent types. A fragment of the data set, shown inFigure 12.4, contains the data for one individual. Thisexample illustrates how concentration and effect data can befit simultaneously, and includes many of the advancedfeatures described in this chapter, such as pharmacodynamicmodeling in the $ERROR statements, correlation betweenelements of &Sigma;, and the L2 data item.Suppose that the data set for the phenobarbital example ofChapter 2 is modified to include both concentration andeffect observations, and that a data item called TYPE isused to distinguish between them. When TYPE is 1, DVcontains an effect measurement. When TYPE is 2, DV containsa concentration. The $PK statements are the same as thoseof Figure 2.12. The $ERROR statements are the same as thoseof Figure 12.1, except that the elements of &theta; and &eta; arerenumbered to follow those used in the $PK statements. The &#9474;(random) variable Y1 is assigned the same value as Y in the &#9474;$ERROR statements of Figure 12.1 The (random) variable Y2 isassigned the same value as Y in the $ERROR statements ofFigure 2.12, except that &epsilon;2 is used rather than &epsilon;1.The input data file contains observations of both typeswhich were made at the same time value. The event recordstherefore include the L2 data item. Figure 12.4, likeFigure 2.7, shows the data for the first individual, butincludes TYPE and L2 data items and effect observations.Note that the L2 data item has a different value for eachmultivariate observation within the individual record. (Thevalues 1 and 2 are chosen arbitrarily and may be re-used forthe L2 data items in the next individual&rsquo;s data, ifdesired.)The $THETA, $OMEGA, and $SIGMA records contain the valuesshown in Figures 2.12 and 12.1 and one other value, 2.8, forthe covariance &Sigma;12=cov(&epsilon;1,&epsilon;2). The estimate 2.8 is chosenso that the correlation is, arbitrarily, .5(2.8=&Sigma;12=(&Sigma;11&Sigma;22)2corr=(8&times;4)2.5).$PROBLEM COMBINED PK/PD MODEL$INPUT ID TIME AMT WT APGR DV TYPE L2$DATA COMBDATA$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERROREMAX=THETA(5)+ETA(3)C50=THETA(6)+ETA(4)E=EMAX*F/(C50+F)Y1=E+ERR(1)Y2=F+ERR(2)Q=1IF (TYPE.EQ.2) Q=0Y=Q*Y1+(1-Q)*Y2$THETA (0,.0027) (0,.70) .0018 .5 100 20$OMEGA .000007 .3 400 16$SIGMA BLOCK(2) 4 2.8 8$ESTIMATIONFigure 12.3. The input to NONMEM-PREDPP for analysis of thepopulation phenobarbital data, including both concentrationand effect observations.1 0. 25.0 1.4 7 . 2 01 2.0 . 1.4 7 6.0 1 11 2.0 . 1.4 7 17.3 2 11 12.5 3.5 1.4 7 . 2 01 24.5 3.5 1.4 7 . 2 11 37.0 3.5 1.4 7 . 2 01 48.0 3.5 1.4 7 . 2 11 60.5 3.5 1.4 7 . 2 01 72.5 3.5 1.4 7 . 2 11 85.3 3.5 1.4 7 . 2 01 96.5 3.5 1.4 7 . 2 11 108.5 3.5 1.4 7 . 2 01 112.5 . 1.4 7 8.0 1 21 112.5 . 1.4 7 31.0 2 2Figure 12.4. The first individual&rsquo;s phenobarbital data,including both concentration and effect observations.The above $ERROR statements can be coded more simply. &#9474;$ERROR &#9474;EMAX=THETA(5)+ETA(3) &#9474;C50=THETA(6)+ETA(4) &#9474;E=EMAX*F/(C50+F) &#9474;IF (TYPE.EQ.2) THEN &#9474;Y=F+ERR(2) &#9474;ELSE &#9474;Y=E+ERR(1) &#9474;ENDIF &#9474;Figure 12.5. Alternate $ERROR statements &#9474;6. NONMEM 7 &#9474;With NONMEM 7 there are many new features, including new &#9474;Estimation Methods. A description is beyond the scope of &#9474;this guide. &#9474;References: Introduction to NONMEM 7">1. What This Chapter is AboutThis chapter briefly describes a variety of features ofPREDPP and NONMEM that are somewhat advanced for this textbut are of interest to most users of NONMEM. References aregiven to other documents where additional information can befound. Section 2 is concerned with PREDPP, Section 3 isconcerned with user-written PREDs, and Section 4 describesgeneral NONMEM features. Section 5 contains an example thatincludes several of the advanced features. Note that &#9474;wherever $PK, $ERROR, $DES, $AES, $MODEL, $MIX and $PREDstatements are referred to below, user-written subroutines &#9474;PK, ERROR, DES, AES, MODEL, MIX and PRED can be usedinstead.2. Advanced Features of PREDPP2.1. Pharmacodynamic Modeling Using the $ERROR Record$ERROR statements may modify the value of F, the scaled drugconcentration. They may also introduce new &theta; and &eta;variables. This allows pharmacodynamic modeling to beperformed using PREDPP. Such models occur when a studyinvolves measurement of a drug effect, such as bloodpressure. A proposed model might relate the predictedeffect to a pharmacokinetic quantity such as plasma level.PREDPP can be used to model Cp as is usual, and thepredicted effect can be computed in the $ERROR statements.For example, suppose that a modified version of thephenobarbital data of Chapter 2 includes observations ofsome drug effect (in this case, perhaps a measure of thedegree of sedation) but none of the concentrationobservations. The dose event records are the same as thoseof the earlier example. Suppose that the drugconcentrations from each individual have been used toestimate that individual&rsquo;s K and V parameters, and thatthese estimates are now included on every event record forthe individual. Finally, suppose that the proposedstructural model for the effect, E, is an &quot;E-max&quot; model:E=EmaxC50Cp+Cpwhere here Cp is understood to mean the prediction of an individual&rsquo;sdrug concentration in the plasma, andEmax and C50 are PD (pharmacodynamic parameters) modeled asEmax=&theta;1+&eta;1C50=&theta;2+&eta;2To fit this data we can use the control statements of figure12.1. To obtain initial parameter estimates, let us assumethat the following is observable in the data. The averagevalue of all effect measurements is about 50. Acrossindividuals, the average value of the largest effectmeasurement within each individual&rsquo;s data is about 100, andthe average value of the individual&rsquo;s observed concentrationat about half this largest measurement is about 20. (Thisis seen when concentration measurements and effectmeasurements are examined together.) Let us also assume 20%random interindividual variability in Emax and C50 and 4%intraindividual variability in the observation. From thiswe obtain initial estimates of 100 and 20 for &theta;1 and &theta;2,(100&times;.2)2 for &Omega;11, (20&times;.2)2 for &Omega;22, and (50&times;.04)2 for &Sigma;.This example is examined again in in Section 3.2, whichshows the use of $PRED statements, and in Section 5, whichshows how observed concentrations and effects can be fitsimultaneously.References: Users Guide VI (PREDPP) IV.B.2$PROBLEM PHARMACODYNAMIC MODEL USING $ERROR STATEMENTS$INPUT ID TIME AMT INDK INDV DV$DATA EFFDATA$SUBROUTINE ADVAN1$PKK=INDKV=INDVS1=V$ERROREMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*F/(C50+F)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.1. The input to NONMEM-PREDPP for analysis ofeffect observations.2.2. Other Pharmacokinetic Models: ADVAN5 through ADVAN9 &#9474;and ADVAN13Appendix 1 lists ADVAN routines for the most commonly-usedpharmacokinetic models. Other ADVAN routines are:ADVAN5 (General Linear)ADVAN6 (General Nonlinear)ADVAN7 (General Linear with Real Eigenvalues)ADVAN8 (General Nonlinear Kinetics with Stiff Equations)ADVAN9 (General Nonlinear Kinetics with EquilibriumCompartments) &#9474;ADVAN13 (General Nonlinear Kinetics using LSODA)With the general methods the user defines a model of up to &#9474;99 compartments using special options of the $MODEL record.For a linear model (ADVAN5 and ADVAN7), it is sufficient tospecify (directed) compartmental connections and to computetheir rate constant parameters with $PK statements. ADVAN 5and 7 make use of numerical approximations to the matrixexponential. For a nonlinear model (ADVAN6, ADVAN8, ADVAN9, &#9474;and ADVAN13), differential equations must be supplied togovern the kinetics, via $DES statements. It is possible to &#9474;specify initial conditions for the differential equations &#9474;using the I_SS (Initial Steady State) feature. For ADVAN9,algebraic equations may also be supplied via $AESstatements. The use of the term &rsquo;nonlinear&rsquo; with ADVAN 6,8, 9, and 13 only indicates that a system of any type offirst-order differential equations is allowed; suchequations could be linear or non-linear.In all cases, the basic features of PREDPP described inChapter 7 are still available, such as the ability tointroduce doses of any kind to any compartment of the model.It should be noted that the general ADVAN routines arerelatively slow. For example, when a general method is usedfor a model identical to that of an analytic method (ADVAN1 &#9474;through ADVAN4 or ADVAN10 through ADVAN12) the run timeincreases, usually by an order of magnitude.Some ADVAN and SS routines must be told the number ofaccurate digits that are required in the computation of drugamounts, i.e., the relative tolerance. This is specifiedeither by the TOL option of the $SUBROUTINES record or bythe $TOL record.References: Users Guide VI (PREDPP) VI, VIIReferences: Users Guide IV (NM-TRAN) V.C.3, 4, 7-102.3. Zero-Order Bolus DosesInstantaneous bolus doses, which have AMT&gt;0 and RATE=0, aredescribed in Chapter 6. Such doses appear instantaneouslyin the dose compartment. Zero-order bolus doses are dosesthat enter the dose compartment via a zero-order process (inthe same manner as do infusions) except that the rate orduration of the process is computed with $PK statements.When the RATE data item has the value -1, then the $PKstatements must include an assignment statement for anadditional PK parameter, Rn (the &quot;modeled rate forcompartment n&quot;), whose value gives the rate of entry of thedrug during the interval of time between the last eventrecord and the current one. There is a different suchparameter for every compartment receiving a zero-order bolusdose. When the RATE data item has the value -2, then the$PK statements must include an assignment statement for anadditional PK parameter, Dn (the &quot;modeled duration forcompartment n&quot;), whose value at the time of the dose eventgives the duration time of the dose. The rate and durationparameters can be modeled like any other PK parameters; inparticular, the assignment statements can involve &theta;&rsquo;s whichare to be estimated. These parameters can be used to modelthe drug release rate or dissolution time of a tablet orcapsule.Steady-state levels involving zero-order bolus doses can becomputed.Steady-state with constant infusion was described in Chapter6. Steady-state infusions may also have modeled rates(i.e., the RATE data item may be -1).References: Users Guide VI (PREDPP) III.F.3, F.42.4. The Additional Dose Data Item: ADDLADDL is a dose-related data item that is used to requestthat a given number of additional doses, just like the dosespecified on the event record, be added to the system at aregular time interval, starting from the time on the eventrecord. PREDPP itself adds these doses at the appropriatefuture times; no actual dose event record is generated bythe Data Preprocessor or by PREDPP. A positive integervalue in ADDL specifies how many additional doses (i.e., inaddition to that already specified in the event record) areto be given, and the value in the II (interdose interval)data item (which is required) specifies the time intervalbetween doses.ADDL may be non-zero on a steady-state dose event record(except for steady-state infusions), in which caseadditional doses are given, maintaining the dosing regimeninto the future. Non-steady-state kinetic formulas are usedto advance the system between each additional dose. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) V.K2.5. Lagged doses: the ALAG ParameterPREDPP permits an additional PK parameter called anabsorption lag time. One such parameter can be defined foreach compartment and applies to all doses to thatcompartment. It gives the amount of time that a dose isheld as a &quot;pending&quot; dose. When the absorption lag time hasexpired, the dose is input into the system. In effect, thevalue of the absorption lag time parameter is added to thevalue of the TIME data item on the dose event record. WithNM-TRAN, recognized names for absorption lag time parametershave the form ALAGn, where n is the compartment number. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) III.F.6References: Users Guide IV (NM-TRAN) V.C.5 &#9474;2.6. Model Event Times: MTIME &#9474;Model event times MTIME(i) are additional PK parameters &#9474;defined in the PK routine or $PK block. A model event time &#9474;is not associated with any compartment, but, like an &#9474;absorption lag time, defines a time to which the system is &#9474;advanced. When the time is reached, indicator variables are &#9474;set and a call to PK is made. At this call (and/or &#9474;subsequent to this call) PK or DES or AES or ERROR can use &#9474;the indicator variables to change some aspect of the &#9474;system, e.g., a term in a differential equation, or the rate &#9474;of an infusion.2.7. Controlling Calls to PK and ERRORIn order to evaluate the $PK and $ERROR statements, PREDPPcalls the PK and ERROR subroutines. By default, thesubroutines are called with every event record. PREDPP maybe instructed to limit calls to certain event records inorder to save the computing time involved with unnecessarycalls (e.g. when the PK parameters do not vary from eventrecord to event record within an individual). It is alsopossible to cause the PK subroutine to be called at timeswhich do not correspond to any actual event record.Using NM-TRAN, calls to PK are controlled by the presence ofone of the following pseudo-statements, at the start of the$PK block:CALLFL=-2:call with every event record, at additional and lagged &#9474;dose times, and at modeled event times.CALLFL=-1:call with every event record (default).CALLFL=0:call with the first event record of each individualrecord and with new values of TIME.CALLFL=1:call once per individual record.A callin_______ protoco________ phras______ may be used instead of a &#9474;pseudo-statement. A calling protocol phrase may use upper- &#9474;or lower-case characters. It must be enclosed in &#9474;parentheses. NM-TRAN can understand minor variations in the &#9474;wording. E.g., the word &quot;CALL&quot; and prepositions such as &#9474;WITH can be omitted. Here are calling protocol phrases &#9474;equivalent to the above four pseudo-statements, &#9474;respectively. &#9474;(CALL WITH NON-EVENT TIMES) &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH FIRST EVENT RECORD AND NEW TIME) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;The choice CALLFL=-2 (CALL WITH NON-EVENT TIMES) is intended &#9474;to be used when PK parameters Dn and/or Fn apply toadditional or lagged doses and the model for theseparameters depends on some time-varying concomitant variablesuch as type of drug preparation or patient weight. Bydefault, the values of the PK parameters which apply to thedose are those values computed by PK with the first eventrecord having a value of TIME greater than the time at whichthe dose actually enters the system (the additional orlagged dose time). However, if PREDPP is instructed to alsocall PK at the additional or lagged dose time, then thevalues of the PK parameters are those values computed atthese special calls. At such calls, PK has available to itinformation from the initiating dose event record itself,and information from the two event records whose TIME valuesbracket the additional or lagged dose time. Along withCALLFL=-2 in the $PK block, the NM-TRAN $BIND record may beuseful; see Users Guide IV.Using NM-TRAN, calls to ERROR are controlled by the presenceof one of the following pseudo-statements at the start ofthe $ERROR block:CALLFL=-1: call with every event record (default).CALLFL=0: call with observation events only.CALLFL=1: call once per individual record.A calling protocol phrase may be used instead of a &#9474;pseudo-statement. As in the $PK block, the calling protocol &#9474;phrase may use upper- or lower-case characters and must be &#9474;enclosed in parentheses. &#9474;Here are calling protocol phrases equivalent to the above &#9474;three pseudo-statements, respectively. &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH OBSERVATION EVENTS) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;NM-TRAN automatically instructs PREDPP to limit calls toERROR to once per problem for the simple error modelsdiscussed in Chapter 8, Sections 3.1 and 3.2:Y=F+ERR(1)Y=F+F*ERR(1)Y=F*(1+ERR(1))Y=F*EXP(ERR(1))During the Simulation Step, PREDPP ignores any limitationand calls the ERROR subroutine with every event record.Even when calls to PK and/or ERROR are limited, the CALLinput data item can be used to force additional calls forspecific event records as needed.References: Users Guide VI (PREDPP) III.B.2, III.H, IV.C,V.JReferences: Users Guide IV (NM-TRAN) V.C.5, C.62.8. Transgeneration of Input Data: the INFN SubroutineNONMEM may be used to modify the data records before anycomputations are performed and also after all computationshave been performed. This is referred to as transgeneratio_______________of the data. Transgeneration at the beginning of a problemcan be used, for example, to change weight-normalized dosesto unnormalized doses. PREDPP allows the user to supply asubroutine called INFN (&quot;initialization/finalization&quot;) inwhich transgeneration can be performed. (The PREDPP libraryincludes a default INFN subroutine which does nothing.)References: Users Guide VI (PREDPP) VI.A3. User-written PRED SubroutinesIt is not necessary to use PREDPP with NONMEM. Either $PREDstatements or a user-written PRED subroutine may be used inplace of PREDPP to supply NONMEM with predicted values forthe DV data item according to some (not necessarilypharmacokinetic) model. An example using $PRED statementsis given here. A special caveat applies to user-writtenPRED subroutines that are recursive: see 4.6 below.References: Users Guide I (Basic) C.23.1. Required Data ItemsThe only required data items when PREDPP is not used are theNONMEM data items DV, MDV, and ID. When PREDPP is used, theData Preprocessor is able to recognize which records containobserved values and which do not, and it supplies the MDVdata item if it is not already present in the data file.When PREDPP is not used, the Data Preprocessor cannot dothis. The input data file must already contain the MDV dataitem if it is needed, i.e., if the DV item of some datarecord does not contain a value of an actual observation.If $PRED statements are used, they must calculate a variablecalled Y, using input data items and NONMEM&rsquo;s &theta;, &eta;, and (forpopulation models) &epsilon; vectors in the calculation.References: Users Guide I (Basic) B.1References: Users Guide IV (NM-TRAN) III.B.83.2. An Example of $PRED Statements: PharmacodynamicModelingThe syntax of $PRED statements is essentially the same asdiscussed for $PK and $ERROR statements. $PRED statementscan be used for simple pharmacokinetic and pharmacodynamicmodels. In figure 12.1 above an example was given ofpharmacodynamic modeling using $ERROR statements. Supposethat in that example, drug concentration is always measuredat the same time as drug effect. Suppose too, that ratherthan input the individuals&rsquo; values of K and V and use themto compute a predicted drug concentration for theindividual, the observed drug concentration itself is usedin the Emax model. This means that the the observedconcentrations are again incorporated into the data, but nowas values of an independent variable, rather than as the DVdata item. This also means that a pharmacokinetic model isnot needed, and therefore, PREDPP is not needed either.Figure 12.2 shows the control stream for this new example.$PROBLEM A SIMPLE PHARMACODYNAMIC MODEL$INPUT ID TIME CP DV$DATA EFFDATA$PREDEMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*CP/(C50+CP)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.2. The input to NONMEM including $PRED statementsfor analysis of effect data.4. Advanced Features of NONMEM4.1. Full Covariance Matrices: $OMEGA BLOCK and $SIGMABLOCKIn the examples of Chapter 2 and 9, there appearedstatements such as:$OMEGA .0000055, .04This is an example of the specification of initial parameterestimates for a variance-covariance &Omega; matrix which isconstrained to be diagonal. Initial estimates are given forthe variances of &eta;1 and of &eta;2. The covariance between &eta;1and &eta;2 is constrained to be 0, i.e., &omega;12=cov(&eta;1,&eta;2)=0.Another way of writing this statement is:$OMEGA DIAGONAL(2) .0000055, .04The option DIAGONAL(2) states explicitly that the blockcontains two &eta;s and that it has diagonal form.If the data supports the possibility that &eta;1 and &eta;2 covarywith each other, it may be useful to model &Omega; as beingunconstrained and allow NONMEM to estimate the covariance.A special form of the $OMEGA record is used, in whichinitial values are supplied for both variances and thecovariance. For example:$OMEGA BLOCK(2) .0000055, .0000001, .04The option BLOCK(2) states that there are two &eta; variables inthe block, and that covariance is to be estimated. The newelement is &omega;12=&omega;21=cov(&eta;1,&eta;2)=cov(&eta;2,&eta;1)=1&times;10&minus;7.$OMEGA BLOCK is used for both population and individualstudies, i.e., it is the same whether &eta; is used in the firstcase in a model for residual error or is used in the secondcase in a model for random interindividual error. In apopulation study, if there is more than one &epsilon; variable, andthe model allows these variables to covary, then $SIGMABLOCK is used in a similar manner.The initial estimates of even more complicated &Omega; and &Sigma;matrices may be given using multiple $OMEGA and $SIGMArecords. For example, the initial estimates of a mixture ofcorrelated and uncorrelated random variables may given.Also, in this context (as with the simple form of the $OMEGAand $SIGMA records described in Chapter 9, Section 3)variances-covariances may be constrained to fixed values bymeans of the FIXED option. Finally, somevariances-covariances may be constrained to equal others bymeans of the BLOCK SAME option. The ability to fix allvariances-covariances in both &Omega; and &Sigma; allows Bayesianestimates to be obtained of the pharmacokinetic parametersof a single individual, based on the individual&rsquo;s data and aprior population distribution for the parameters.References: Users Guide IV (NM-TRAN) III.B.104.2. Grouping Related Observations: The L1 and L2 DataItemsThe $ERROR statements for a problem may sometimes involvemore than one random variable. For example, there may betwo types of observations. One type may be an observationfrom one compartment of a PK system, or with one assay orpreparation, and another type may be an observation from adifferent compartment or with a different assay orpreparation. The model for the two types of observationswould typically involve at least two &epsilon; variables (e.g.(3.8)). If all observations are made at sufficientlyseparated times, there may be little reason to be concernedabout correlation between the two random errors. However,if the two types of observations are taken at the same orvery close to the same time, it is possible that correlationwill exist; whatever circumstance has influenced oneobservation to be different from the predicted level mayalso have some influence on the other observation. In thiscase a covariance between the two &epsilon; variables should beallowed, as described above in Section 4.1. Then the twotypes of observations at the same time point are regarded astwo elements of a multivariat____________ observation____________In the case of population data, there exists a NONMEM dataitem, L2, which is used to identify the elements of amultivariate observation. In effect, L2 acts in a similarway as ID, but grouping observations within individualrecords.In the case of individual data, the ID data item alreadyserves this purpose: it forms groups of observations whose&eta; variables may be correlated. Thus, in the input datafile, the ID data item should be the same for thoseobservations which may have correlated &eta;s. However, forindividual data, the Data Preprocessor normally replaces theID data item with a new set of values which describe everyobservation as being independent of the others. To preventthe Data Preprocessor from doing this, L1 should be includedin the $INPUT record as the name or synonym for theuser-supplied ID data item.References: Users Guide IV (NM-TRAN) II.C.4, III.B.2References: Users Guide II (Supplemental) D.34.3. Continuing a NONMEM Run: MSFO and MSFI &#9474;The MSFO (Model Specification Output File) option of the$ESTIMATION record instructs NONMEM to write a Mode_____Specificatio_____________ Fil____ (MSF)______ It is created when NONMEM writes &#9474;the first iteration summary to the intermediate output file, &#9474;and is re-written when every subsequent iteration summary is &#9474;written. This file can then be read in a subsequent NONMEMrun using a $MSFI (Model Specification File Input) record.This file has much of the information about the model usedin the previous run, thus the name &quot;Model SpecificationFile&quot;. It also contains all the information that allows theEstimation Step from the previous run (which may haveterminated, for example, due to the number of functionevaluations exceeding its limit or a computer crash or some &#9474;other externally-caused interruption of the NONMEM run) tobe continued in the subsequent run. There are a number ofbenefits to using a MSF. First, what might be a longEstimation Step (due to a very lengthy search) can be splitover a series of runs, each with a limited number offunction evaluations. Any run which terminates prematurelydue to computer failure can be restarted from the MSF outputin the previous run. (This provides a &quot;checkpoint/restart&quot;capability.) The progress made in the Estimation Step canalso be evaluated between runs, and a decision made as towhether it is worth continuing a search which is consumingexcessive amounts of computer time. Second, the Covariance,Tables, and Scatterplot Steps can be performed in laterruns, each using the MSF from the final run with theEstimation Step. It is advisable to perform the CovarianceStep only after satisfactory results have been obtained fromthe Estimation Step.References: Users Guide I (Basic) C.4.4References: Users Guide IV (NM-TRAN) III.B.6, B.124.4. NONMEM Can Obtain Initial Estimates for &theta;, &Omega;, &Sigma;NONMEM can be directed to obtain initial estimates for oneor more elements of &theta;, &Omega;, or &Sigma;. This is done in a separateInitial Estimates Step. For an element of &theta;, omit theinitial estimate but include lower and upper bounds, e.g.,(1, ,50) in the $THETA record. (The NUMBERPOINTS option maybe used to control the number of points in &theta; space examinedby NONMEM during the search for initial estimates of &theta;.)For a block of &Omega; or &Sigma;, omit all initial estimates on the$OMEGA BLOCK (or DIAGONAL) record, or $SIGMA BLOCK (orDIAGONAL) record, respectively.Note that when $PK and $ERROR statements are present but the$OMEGA and/or $SIGMA records are absent, NONMEM will bedirected to obtain initial estimates for the variances ofthe random variables in question, assuming the diagonal formof the matrix.References: Users Guide IV (NM-TRAN) III.B.9-114.5. Improving Parameter Estimates: REPEAT and RESCALEThe Estimation Step can be immediately repeated after thesearch has terminated successfully, by including the REPEAToption on the $ESTIMATION record. This can improve theaccuracy of the parameter estimates when one or more initialestimates are wrong by a few orders of magnitude. The finalestimates from the first implementation of the EstimationStep are used as the initial estimates of the secondimplementation, and thus the scaling used with the STP isdifferent from that with the first implementation, allowingfewer leading zeros after the decimal point in the STP.When the Estimation Step is continued by means of a ModelSpecification File, similar rescaling can be requested usingthe RESCALE option of the $MSFI record.References: Users Guide IV (NM-TRAN) III.B.12, B.14References: Users Guide II (Supplemental) F4.6. The Covariance Step: R&minus;1, S&minus;1, Special ComputationThe Covariance Step, which computes standard errors of theparameter estimates, first computes a covariance matrix ofthe parameter estimates. (This is not the same as the &Omega; or&Sigma; matrix). It is possible to request that this covariancematrix be computed in one of three different ways: either asR&minus;1, S&minus;1, or R&minus;1SR&minus;1 (the default), where R and S are twomatrices from statistical theory, the Hessian andCross-Product Gradient matrices, respectively. OptionsMATRIX=R and MATRIX=S of the $COVARIANCE record are used torequest the R&minus;1 and S&minus;1 matrices, respectively. TheCovariance Step can produce additional output. When thedefault covariance matrix is used, R&minus;1 and/or S&minus;1 can beprinted. This is requested by options PRINT=R and/orPRINT=S. Eigenvalues are be printed if requested by optionPRINT=E. Multiple PRINT options can be specified.A special computation is required when the data are from asingle individual and a recursive PRED is used. A recursivePRED is one which stores the results of certain computationsusing the values from one event record, and uses theseresults in later computations with the values from a laterevent record. PREDPP advances the kinetic system from onetime point to the next and therefore is an example of arecursive PRED. When PREDPP is used and the data is from asingle individual, NM-TRAN automatically requests thespecial computation. When a recursive user-written PRED isused and the data are from a single individual, the SPECIALoption of the $COVARIANCE record must be used.The CONDITIONAL option of the $COVARIANCE record requeststhat the Covariance Step be implemented only if EstimationStep terminates successfully, and is the default. TheUNCONDITIONAL option can be used to request that it beimplemented no matter how the Estimation Step terminates.References: Users Guide IV (NM-TRAN) III.B.15References: Users Guide II (Supplemental) D.2.54.7. Multiple Problems in a Single NONMEM RunNONMEM can implement more than one problem in a single run.That is, the input control stream can contain more than one$PROBLEM record, each followed by its own set of problemspecification statements. This feature can be useful in avariety of situations. A series of what otherwise would beseparate runs, each analyzing a single individual&rsquo;s datawithin a population data file, can be performed convenientlywithout building separate data files for each individual.Also, more than one data set can be analyzed using the samemodel and the same problem specification. Multiple problemsare also useful with NONMEM&rsquo;s Simulation Step, describedbelow.Note that abbreviated code such as $PK and $ERROR statements &#9474;cannot appear after the first problem. If the $DATA recordis omitted or the filename is specified as * on a $DATArecord in a problem subsequent to the first, the previousdata set is re-used.A sequence of problems may be defined to be a superproble____________ &#9474;by means of the NM-TRAN $SUPER record, and NONMEM may also &#9474;be directed to repeat them a specific number of times.References: Users Guide IV (NM-TRAN) III.B.14.8. Simulation Using NONMEM: The $SIMULATION RecordThe term simulatio__________ refers to the generation of data pointsaccording to some model. A simple form of simulation isperformed when the Estimation Step is omitted but the TableStep is implemented. The PRED column of the table containspredictions based on the information in the data records andthe initial estimates of &theta;, under the model specified in thePRED (PREDPP) subroutine. Random variables &eta; and &epsilon; (if any)have no effect on the predictions and may be omitted. Ifthe only purpose of the run is to obtain simulated values,and these variables are present, it is best (but notrequired) that their variances be fixed to 0. NONMEM doesnot compute the objective function in this circumstance,which has certain advantages.NONMEM can also perform a Simulation Step, in which anothertype of simulation is performed. In the Simulation Step,each value of the DV data item of each record with MDV=0 isreplaced by a simulated observation generated from themodel, but including statistical variability&dagger;.<cite>&dagger; During the Simulation Step, values of F computed by PREDor PREDPP for records having MDV=1 are irrelevant and areignored by NONMEM. </cite>The PRED (PREDPP) routine uses &eta; and &epsilon; values that aresupplied by NONMEM according to user-specified randomdistributions (e.g., with variances given by the initialestimates of &Omega; and &Sigma;). If &Omega; and &Sigma; matrices are fixed tozero, for example, the simulated values are the same as thepredictions described above.If the data are then displayed by the Table Step, the DVcolumn for records with MDV=0 contains the simulatedobservations obtained from the Simulation Step. For recordshaving MDV=1, the DV column contains whatever was in theoriginal data record. The PRED column of the table containspredictions as described above. If the Estimation Step wasnot implemented, the values of &theta; used for these predictionsare the initial values. If the Estimation Step wasimplemented, the values of &theta; used for the predictions in thePRED column are the final parameter estimates. Note thatthe observations that are fit during the search are thesimulated values obtained by the Simulation Step.Often data are simulated using the Simulation Step, thenanalyzed using one or more other steps (e.g. Estimation andCovariance Steps), and this process is repeated a fixednumber of times, using the same model. The Simulation Stepaccommodates this easily with the notion of a NONME______subproblem___________ whereby these steps are repeated within the sameNONMEM problem. However, on occasion it can be useful tohave multiple problems (see Section 4.7), where one problemimplements the Simulation Step, and the subsequent problemimplements other steps. For example, this is one way toobtain different initial parameter estimates for theEstimation Step than for the Simulation Step.The ONLYSIMULATION option causes NONMEM to suppressevaluation of the objective function. With this option,PRED-defined variables displayed in tables and scatterplots(see Section 4.13) are simulated values, i.e., use simulated&eta;s and initial &theta;s, and weighted residual values in tablesand scatterplots are always 0.References: Users Guide IV (NM-TRAN) III.B.13References: Users Guide VI (PREDPP) III.E.2, L.1 , IV.B.1-2,C, G.14.9. Files for Subsequent Processing: the $TABLE RecordNONMEM can write the data for a table to an externalformatted file, as requested by the FILE option of the$TABLE record. Other computer programs can read thesefiles. Such programs can perform further analysis orprovide improved graphical displays. These files normallycontain header lines similar to those in a printed table,but the header lines can be suppressed entirely or in partby means of the NOHEADER or ONEHEADER options, respectively.Tables may be written to the same or to different table &#9474;files.References: Users Guide IV (NM-TRAN) III.B.164.10. Data Checkout ModeNONMEM&rsquo;s data checkout mode is intended for preliminarydisplay of data without the use of a model. In datacheckout mode, the PRED routine is not called. Predictions,the objective function, residuals, and weighted residualsare not computed. Only the Table and Scatterplot Steps canbe implemented in the problem. With NM-TRAN, this mode isrequested by coding the option CHECKOUT on the $DATA record.A $SUBROUTINES record and abbreviated code are required, butthey have no effect and need only be syntactically correct.References: Users Guide IV (NM-TRAN) III.B.64.11. Obtaining Individual Parameter Estimates -Conditional Estimates of &eta;sWith population data, NONMEM can obtain estimates ofindividual-specific true values of &eta; from any given set ofvalues of &theta;, &Omega;, &Sigma;, and the individual&rsquo;s data. These arecalled conditiona___________ estimates of &eta;. When the conditionalestimates are obtained after estimation is carried out bythe First-Order method, they are referred to as &quot;posthoc&quot;estimates. With NM-TRAN, they are requested by the optionPOSTHOC on the $ESTIMATION record.References: Users Guide IV (NM-TRAN) III.B.144.12. Population Conditional Estimation MethodsNONMEM can obtain conditional estimates of &eta; variables aspart of the computation of population parameter estimates.These are called conditiona___________ estimatio__________ methods________ WithNM-TRAN, such methods are requested by including the optionMETHOD=CONDITIONAL (or METHOD=1) on the $ESTIMATION record.(The option METHOD=ZERO, or METHOD=0, requests theconventional First-Order method and is the default.) Thereare two conditional estimation methods. If NONMEM uses onlyfirst-order approximations, this is the First-Orde___________Conditiona___________ Estimatio__________ Method_______ This has one variation,interaction____________ which takes into account &eta;-&epsilon; interaction and isrequested by the additional option INTERACTION on the$ESTIMATION record. If NONMEM uses a certain second-orderapproximation, this is the Laplacia_________ method, which isrequested by the additional option LAPLACIAN on the$ESTIMATION record. Interaction cannot be specified withthe Laplacian method.Note that this usage of the term CONDITIONAL is differentfrom the usage on the $SCATTERPLOT, $TABLE, and $COVARIANCErecords, in which it refers to the circumstances under whichthe step in question is implemented.References: Users Guide IV (NM-TRAN) III.B.144.13. Displaying PRED-Defined Variables and ConditionalEstimates of &eta;sNONMEM can display PRED-defined variables in table andscatterplots. With NM-TRAN, any variable appearing on theleft-hand side of an assignment statement in abbreviatedcode can be displayed by listing it in a $TABLE or $SCATTERrecord. If the data are population, NONMEM can also displayconditional estimates of &eta;. With NM-TRAN, variables ETA(1),ETA(2), etc., can be simply listed in $TABLE and $SCATTERrecords. When conditional estimation is not performed, thevalues displayed are zero. Displayed values of PRED-defined &#9474;random variables will use conditional estimates of &eta; if theyhave been obtained, otherwise they will be typical values.This feature is available with PREDPP, as well as withuser-written PRED routines. For example, the followingrecords could replace the $ESTIMATION record in Figure 12.2:$ESTIMATION POSTHOC$TABLE ETA(1) EMAXThe $ABBREVIATED record can be used to limit the number ofvariables available for display when the number isexcessive.References: Guide III (Installation) V.2.4References: Guide IV (NM-TRAN) III.B.16-17References: Guide VI (PREDPP) III.J, IV.E4.14. Mixture ModelsA mixtur_______ mode_____ is a model that explicitly assumes that thepopulation consists of two or more sub-populations, eachhaving its own model. For example, with twosub-populations, one might assume that some fraction p ofthe population has one set of typical values of the PKparameters, and the remaining fraction 1-p has another setof typical values. Both sets of typical values and themixing fraction p may be estimated. For each individual,NONMEM also computes an estimate of the number of thesubpopulation of which the individual is a member. The usermust supply a FORTRAN subroutine called MIX or a $MIX block &#9474;of abbreviated code to compute the fractions p and 1-p.References: Users Guide VI (PREDPP) III.L.24.15. PRED Error Return Codes and Error Messages in FilePRDERRA PRED routine can return a PRE____ erro_____ retur______ cod____ (1 or 2)to NONMEM, indicating that it is unable to compute aprediction for a given data record with the current valuesof &theta;&rsquo;s and &eta;&rsquo;s. For example, PREDPP returns error returncode 1 when a basic or additional PK parameter has a valuethat is physically impossible (e.g., a scale parameter whichis zero or negative). Error return codes can also bespecified by the user in user-written code or in abbreviatedcode using the EXIT statement. One reason for doing this isto constrain parameters in order to avoid floating pointmachine interrupts. The PRE____ erro_____ recover________ optio______determines what action NONMEM will take. With NM-TRAN, thePRED error recovery option is either ABORT (which is thedefault) or NOABORT, and is specified on the $ESTIMATION and$THETA records.If an error return code is returned during the Simulation,Covariance, Table or Scatterplot Step, or during computationof the initial value of the objective function, NONMEM willabort. If the error return code is returned during theEstimation or Initial Estimates Step, NONMEM will try toavoid those values of &theta; and &eta; for which the error occurs. Ifthey cannot be avoided, NONMEM&rsquo;s actions depend on the errorreturn code value, as follows:1 If NOABORT is specified on $ESTIM or $THETA, try toavoid the current values of &theta; and &eta;. If ABORT isspecified on $ESTIM or $THETA, then abort.2 Abort in all cases.PRED routines may optionally provide text accompanying theerror return code. NONMEM writes all text associated witherror return codes to a file, PRDERR. The contents of thisfile should always be carefully reviewed.References: Users Guide III (Installation) III.2.1.1References: Users Guide IV (NM-TRAN) IV.A, IV.C.5-6References: Users Guide VI (PREDPP) III.K, IV.F4.16. User-Written SubroutinesAlthough most NONMEM applications can be accomplished usingNM-TRAN abbreviated code, there are cases in whichuser-written FORTRAN subroutines are needed. The$SUBROUTINES record allows the user to specify the names ofuser-written routines that are needed in the NONMEM loadmodule. A user may choose to write his own PRED, PK, ERROR,MODEL, DES, or AES subroutine. Some subroutines that aredistributed with NONMEM are dummy, or &quot;stub&quot; routines, thatdo nothing. Of these, subroutines CCONTR, CONPAR, CONTR,and CRIT can be replaced to obtain an objective functiondifferent from the default. NONMEM subroutine MIX must bereplaced for mixture models. PREDPP subroutine INFN may bereplaced by user-written code. The names of all suchroutines are specified using the identically named optionsof the $SUBROUTINES record, e.g., PRED=subname,CONTR=subname, etc. User-written routines may call otherFORTRAN subroutines, which can be specified for inclusion inthe load module using the option OTHER=subname.With user-written CONTR routines, the NM-TRAN $CONTR recordmay be useful.References: Users Guide IV (NM-TRAN) III.B.4, B.6 &#9474;4.17. PRIOR &#9474;The PRIOR subroutine and $PRIOR record allows a Bayesian &#9474;penalty function to be added to the NONMEM objective &#9474;function. This serves as a constraint on the estimates of &#9474;THETA, OMEGA, and SIGMA and thus as a way for stable &#9474;estimates to be obtained with insufficient data. &#9474;References: Introduction to NONMEM Version VI5. Observations of Two Different TypesAn NM-TRAN control stream is shown in Figure 12.3, for theanalysis of a data set which contains observations of twodifferent types. A fragment of the data set, shown inFigure 12.4, contains the data for one individual. Thisexample illustrates how concentration and effect data can befit simultaneously, and includes many of the advancedfeatures described in this chapter, such as pharmacodynamicmodeling in the $ERROR statements, correlation betweenelements of &Sigma;, and the L2 data item.Suppose that the data set for the phenobarbital example ofChapter 2 is modified to include both concentration andeffect observations, and that a data item called TYPE isused to distinguish between them. When TYPE is 1, DVcontains an effect measurement. When TYPE is 2, DV containsa concentration. The $PK statements are the same as thoseof Figure 2.12. The $ERROR statements are the same as thoseof Figure 12.1, except that the elements of &theta; and &eta; arerenumbered to follow those used in the $PK statements. The &#9474;(random) variable Y1 is assigned the same value as Y in the &#9474;$ERROR statements of Figure 12.1 The (random) variable Y2 isassigned the same value as Y in the $ERROR statements ofFigure 2.12, except that &epsilon;2 is used rather than &epsilon;1.The input data file contains observations of both typeswhich were made at the same time value. The event recordstherefore include the L2 data item. Figure 12.4, likeFigure 2.7, shows the data for the first individual, butincludes TYPE and L2 data items and effect observations.Note that the L2 data item has a different value for eachmultivariate observation within the individual record. (Thevalues 1 and 2 are chosen arbitrarily and may be re-used forthe L2 data items in the next individual&rsquo;s data, ifdesired.)The $THETA, $OMEGA, and $SIGMA records contain the valuesshown in Figures 2.12 and 12.1 and one other value, 2.8, forthe covariance &Sigma;12=cov(&epsilon;1,&epsilon;2). The estimate 2.8 is chosenso that the correlation is, arbitrarily, .5(2.8=&Sigma;12=(&Sigma;11&Sigma;22)2corr=(8&times;4)2.5).$PROBLEM COMBINED PK/PD MODEL$INPUT ID TIME AMT WT APGR DV TYPE L2$DATA COMBDATA$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERROREMAX=THETA(5)+ETA(3)C50=THETA(6)+ETA(4)E=EMAX*F/(C50+F)Y1=E+ERR(1)Y2=F+ERR(2)Q=1IF (TYPE.EQ.2) Q=0Y=Q*Y1+(1-Q)*Y2$THETA (0,.0027) (0,.70) .0018 .5 100 20$OMEGA .000007 .3 400 16$SIGMA BLOCK(2) 4 2.8 8$ESTIMATIONFigure 12.3. The input to NONMEM-PREDPP for analysis of thepopulation phenobarbital data, including both concentrationand effect observations.1 0. 25.0 1.4 7 . 2 01 2.0 . 1.4 7 6.0 1 11 2.0 . 1.4 7 17.3 2 11 12.5 3.5 1.4 7 . 2 01 24.5 3.5 1.4 7 . 2 11 37.0 3.5 1.4 7 . 2 01 48.0 3.5 1.4 7 . 2 11 60.5 3.5 1.4 7 . 2 01 72.5 3.5 1.4 7 . 2 11 85.3 3.5 1.4 7 . 2 01 96.5 3.5 1.4 7 . 2 11 108.5 3.5 1.4 7 . 2 01 112.5 . 1.4 7 8.0 1 21 112.5 . 1.4 7 31.0 2 2Figure 12.4. The first individual&rsquo;s phenobarbital data,including both concentration and effect observations.The above $ERROR statements can be coded more simply. &#9474;$ERROR &#9474;EMAX=THETA(5)+ETA(3) &#9474;C50=THETA(6)+ETA(4) &#9474;E=EMAX*F/(C50+F) &#9474;IF (TYPE.EQ.2) THEN &#9474;Y=F+ERR(2) &#9474;ELSE &#9474;Y=E+ERR(1) &#9474;ENDIF &#9474;Figure 12.5. Alternate $ERROR statements &#9474;6. NONMEM 7 &#9474;With NONMEM 7 there are many new features, including new &#9474;Estimation Methods. A description is beyond the scope of &#9474;this guide. &#9474;References: Introduction to NONMEM 7</a><br>
<a href="#1. What This Chapter is AboutThis chapter describes error messages that can appear inNONMEM&rsquo;s output and discusses some possible causes andremedies. It is not encyclopedic; only selected messagesare discussed. NM-TRAN messages are meant to beself-explanatory, as are many PREDPP messages, and importantNONMEM messages are documented in NONMEM Users Guide, PartI, Chapter G. Unlike certain other regression programs,NONMEM-PREDPP will not try to mask what is perceived as areal problem and to which attention must be given by theuser before the computation can proceed; an error messageresults and often, the program terminates.The Estimation and Covariance Steps do not always terminatesuccessfully. This is a normal part of the process of modelbuilding.2. Abnormal Termination of the Estimation StepNormal termination of the Estimation Step is indicated bythe message:MINIMIZATION SUCCESSFULEven when this message is seen, it is possible that theEstimation Step has not run correctly. Final estimatesshould be different from initial estimates. If the initialand final estimates are the same and the gradients for aparameter are zero at every iteration&dagger;, this is a sign of amodelling error. The parameter does not affect anypredictions, as discussed in Chapter 7, Section 4.2. Ifthere were bounds, estimates should be well away from thebounds. A final estimate which is close to a bound isdiscussed in Chapter 11, Section 4.3.<cite>&dagger; A gradient may reach zero at or near the final iteration;this is not an error. Note also that no gradient iscomputed or printed for a parameter whose value is fixed, soif a gradient is always zero, it is not for this reason. </cite>Abnormal termination of the Estimation Step is indicated bya message whose first line is:MINIMIZATION TERMINATEDOne of several messages will follow, indicating the type offailure. The messages are listed in Users Guide I.Two of the most common are discussed here separately.2.1. &quot;DUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED&quot;If after any iteration the total number of evaluations ofthe objective function (Chapter 10, figure 10.5, line 33) isequal to or greater than the maximum allowed (Chapter 10,figure 10.2, line 51), the minimization search is haltedwith this message. If the $ESTIMATION record requested thata Model Specification File be written, it is possible tocontinue the search from this point in a subsequent NONMEMrun. In Chapter 12, Section 4.3, a strategy is discussed bywhich the number of function evaluations is deliberately setto a low value in order to structure a lengthy run as aseries of shorter runs.Whenever this message is obtained, it is important toexamine the intermediate output and evaluate the progressmade so far. A poorly-specified model, for example, maycause very slow convergence of the minimization search.Raising the maximum number of function evaluations (usingthe MAXEVAL option of the $ESTIMATION record) may not beadvisable.2.2. &quot;DUE TO ROUNDING ERRORS (ERROR=134)&quot;This message will be accompanied in the intermediate outputby a message beginning: NUMSIGDIG: .... which gives theapproximate number of significant digits obtained in each ofthe parameters being estimated. At least one such numberwill be less than the number requested.The number of significant digits obtained should beexamined. If it is at least 2, and the gradient vectorappears stable throughout the last few iterations, asatisfactory minimum may well have been obtained. (It maybe desirable to re-run the problem with the print intervalfor iteration summarization set to 1 (PRINT=1 in the$ESTIMATION record) so that the progress made at everyiteration can be examined.) The final parameter estimatesshould be examined, and if they appear reasonable, theymight be accepted. Although the user may have requestedmore than 2 significant digits, the data may only supportabout 2 digits, given the precision of the arithmetic beingused. By examining the gradients carefully, it is oftenpossible to obtain further information about which parameterestimates are less-well determined.Even though the final parameter estimates may be adequate,it is unlikely that the minimum is sufficientlywell-determined to allow the Covariance Step to runsuccessfully, at least with the number of significantfigures requested in the Estimation Step. The EstimationStep may need to be rerun, requesting only 2 significantfigures, followed by the Covariance Step.If the number of significant digits is less than 2 (or evennegative), then the final estimates should not be trusted.The problem may be model misspecification or insufficientdata.Model misspecification is a very general problem involvingsome mismatch between the model and the data. This canresult in particularly large values of the objectivefunction or slow convergence of the minimization search.Sometimes the model is overparameterized. This means thatthe model has more parameters than can be well-enoughestimated from the data (e.g., a biexponential model is fitto monoexponential data). When model misspecificationoccurs due to over-parameterization, then the EstimationStep will usually proceed smoothly, but terminate with fewerthan 2 significant digits. It is best to start with simplemodels (see Chapter 11).A related problem arises when a covariance element, e.g.,&Omega;12 (or &Sigma;12), is being estimated. If the ID (or L2 dataitem) is not used correctly, it may appear as though thecovariance does not affect objective function values, andthen this parameter will not be well estimated. In otherwords, it may appear as though the model isoverparameterized due to the inclusion of this parameter.See Chapter 12, Section 4.2.3. Abnormal Termination of the Covariance StepIt is possible for the Estimation Step to terminatesuccessfully, and yet the Covariance Step generates an errormessage. Error messages from the Covariance Step areprinted immediately after line 46 of Figure 10.5. Themessages are listed in Users Guide I.When a message arises, often it is:R MATRIX ALGORITHMICALLY NON-POSITIVE-SEMIDEFINITEBUT NONSINGULARCOVARIANCE STEP ABORTEDIn order for the minimization routine to terminatesuccessfully, it needs to determine that the final gradientvector is sufficiently small, which is a necessary conditionfor a minimum to have been achieved. This condition,however, is not sufficient. A sufficient condition, thatthe R matrix be positive definite (and therefore, that theapparent minimum not be a saddle point) is only checked inthe Covariance Step. The message means that the sufficientcondition appears not to be satisfied. The final estimateis, therefore, in doubt.Sometimes the message is:R MATRIX ALGORITHMICALLY SINGULARCOVARIANCE STEP UNOBTAINABLES MATRIX ALGORITHMICALLY SINGULARThis arises when there exists a parameter whose values donot actually affect the predictions and whose gradient inthe intermediate output is always 0.In general, successful completion of the Covariance Steprequires a better defined minimum than does the successfulcompletion of the Estimation Step.4. Miscellaneous ProblemsThis section discusses a few simple errors which preventNONMEM-PREDPP from running successfully.4.1. Proportional Error ModelA common error is to use the proportional error model whilesome predicted values for actual observations are zero orclose to zero. (For example, if the first dose is aninfusion and there is a &quot;baseline&quot; observation at the startof the infusion, the predicted level will be zero.)With individual data this will lead to an error messagesimilar to the following (the individual number may bedifferent from 1):PROGRAM TERMINATED BY OBJ, ERROR IN ELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)VAR-COV OF DATA FROM INDIVIDUAL RECORD ESTIMATED TO BE SINGULARWith population data this will lead to an error messagesimilar to the following (the individual and record numbersmay be different than 1):PROGRAM TERMINATED BY OBJ, ERROR IN CELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)INTRAINDIVIDUAL VARIANCE OF DATA FROM OBS RECORD 1 ESTIMATED TO BE 04.2. Errors in the Pharmacokinetic ModelWhen using a new model, a run should done in which theEstimation Step is not run, and a scatterplot of PRED vs DVwith unit slope line is produced, to verify that the modeland the initial parameter estimates are reasonable. It ismuch harder to diagnose errors in the model or the initialestimates after the Estimation Step fails. Make sure thatthe initial value of the objective function is notexcessively large, and that the unit slope line shows on theplot: scaling errors can easily go undetected! E.g., if theunits are incorrect at some point in the model (L vs ml),the predictions may be wrong by a factor of 1000.Similarly, if no scale was specified for the compartmentbeing observed, the predictions for the observations arecompartment amounts rather than concentrations. In bothcases, the shape of the PRED vs DV plot may appear linear,but the axes may be labeled quite differently. Whenobservations from two different compartments are present inthe data (e.g., Cp and Cu), some of the observations may bescaled incorrectly. This is discussed in Chapter 6, Section9, and Chapter 7, Section 4.3.3.5. Errors with PREDPP5.1. Error Messages from a TRANS RoutineTRANS routines can produce error messages. Here is one fromTRANS2:ERROR IN TRANS2 ROUTINE: V IS ZEROAppendix 2 shows that TRANS2 normally computes K=CL/V. Theroutine checks that V is not zero, and upon finding that itis, it prints the informative message, and terminates therun (thus avoiding a machine &quot;division by zero&quot; interrupt bythe operating system). This error usually occurs with theinitial parameter estimates. E.g., suppose the relevant $PKstatement is:V=THETA(1)+WT*THETA(2)For some values of &theta;1, &theta;2, and WT, a value of zero is beingcomputed for V. The initial estimates of &theta;1 and &theta;2 shouldbe checked. The intercept &theta;1 might have been fixed to zero,in which case then, the values of WT should also be checked.If WT is recorded only on the first event record of eachindividual&rsquo;s data, careful coding is required to insure thata value of zero is not used when the $PK record is evaluatedwith subsequent event records.5.2. Error Messages from ADVAN RoutinesA similar error message can be generated in PREDPP, e.g.PK PARAMETER FOR OBSERVATION COMPARTMENT&rsquo;S SCALE IS ZEROSome scale parameter is modeled in such a way as to producea zero. Again, the code for that scale parameter, and theinitial estimates for the &theta;&rsquo;s used therein, should bechecked. Perhaps the scale parameter is being set equal toa volume parameter, and as described above, the volumeparameter is being set to zero. When TRANS1 is used, thevolume parameter is neither recognized nor checked.5.3. Numeric difficulties in PREDPPNumeric difficulties can occur with linear pharmacokineticmodels (e.g., ADVAN1-4) in the process of computing certainexponentials. They can occur from an error in the units ofeither a rate constant and/or the TIME data items. They canalso occur from inordinately large values for a rateconstant which arise during the minimization search. Thismight be avoided by placing appropriate constraints on &theta;&rsquo;s.They can also occur when the system is advanced over anexcessively long period of time. This can happen within anindividual record, when the individual had a course of drugtreatment, followed by a wash-out period, followed byanother course of drug treatment. The first dose record oftreatment courses other than the first should have EVID dataitem equal to 4 (reset-dose) rather than 1 (dose), to avoidcomputing excessively small compartment amounts (see Chapter6, Section 7.3), and to reduce computational cost.Difficulties can occur in the process of computingpredictions with ADVAN2 and ADVAN4 when values of KA and Karise during the minimization search that are very close toone another. The models encoded into the ADVAN routinesassume that KA and K have fairly distinct values, and theformulas for the predictions have the term KA-K in thedenominator. If, for example, the typical values of K andKA are associated with &theta;1 and &theta;2, respectively, then onemight try reparameterizing. The typical values of K and KA-Kcan be associated with &theta;1 and &theta;2, so that K=&theta;1 and KA=K+&theta;2.A lower bound of zero should be placed on &theta;2&dagger;.<cite>&dagger; This technique also prevents a &quot;flip-flop&quot; from occurring.(In the original parameterization, the final estimates of &theta;1and &theta;2 can be the final estimates of the typical values ofKA and K, respectively). </cite>A similar situation occurs with TRANS3, where VSS-V occursin the denominator of the expression for K21. As above,reparameterization and a constraint on an element of &theta; mayhelp.">1. What This Chapter is AboutThis chapter describes error messages that can appear inNONMEM&rsquo;s output and discusses some possible causes andremedies. It is not encyclopedic; only selected messagesare discussed. NM-TRAN messages are meant to beself-explanatory, as are many PREDPP messages, and importantNONMEM messages are documented in NONMEM Users Guide, PartI, Chapter G. Unlike certain other regression programs,NONMEM-PREDPP will not try to mask what is perceived as areal problem and to which attention must be given by theuser before the computation can proceed; an error messageresults and often, the program terminates.The Estimation and Covariance Steps do not always terminatesuccessfully. This is a normal part of the process of modelbuilding.2. Abnormal Termination of the Estimation StepNormal termination of the Estimation Step is indicated bythe message:MINIMIZATION SUCCESSFULEven when this message is seen, it is possible that theEstimation Step has not run correctly. Final estimatesshould be different from initial estimates. If the initialand final estimates are the same and the gradients for aparameter are zero at every iteration&dagger;, this is a sign of amodelling error. The parameter does not affect anypredictions, as discussed in Chapter 7, Section 4.2. Ifthere were bounds, estimates should be well away from thebounds. A final estimate which is close to a bound isdiscussed in Chapter 11, Section 4.3.<cite>&dagger; A gradient may reach zero at or near the final iteration;this is not an error. Note also that no gradient iscomputed or printed for a parameter whose value is fixed, soif a gradient is always zero, it is not for this reason. </cite>Abnormal termination of the Estimation Step is indicated bya message whose first line is:MINIMIZATION TERMINATEDOne of several messages will follow, indicating the type offailure. The messages are listed in Users Guide I.Two of the most common are discussed here separately.2.1. &quot;DUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED&quot;If after any iteration the total number of evaluations ofthe objective function (Chapter 10, figure 10.5, line 33) isequal to or greater than the maximum allowed (Chapter 10,figure 10.2, line 51), the minimization search is haltedwith this message. If the $ESTIMATION record requested thata Model Specification File be written, it is possible tocontinue the search from this point in a subsequent NONMEMrun. In Chapter 12, Section 4.3, a strategy is discussed bywhich the number of function evaluations is deliberately setto a low value in order to structure a lengthy run as aseries of shorter runs.Whenever this message is obtained, it is important toexamine the intermediate output and evaluate the progressmade so far. A poorly-specified model, for example, maycause very slow convergence of the minimization search.Raising the maximum number of function evaluations (usingthe MAXEVAL option of the $ESTIMATION record) may not beadvisable.2.2. &quot;DUE TO ROUNDING ERRORS (ERROR=134)&quot;This message will be accompanied in the intermediate outputby a message beginning: NUMSIGDIG: .... which gives theapproximate number of significant digits obtained in each ofthe parameters being estimated. At least one such numberwill be less than the number requested.The number of significant digits obtained should beexamined. If it is at least 2, and the gradient vectorappears stable throughout the last few iterations, asatisfactory minimum may well have been obtained. (It maybe desirable to re-run the problem with the print intervalfor iteration summarization set to 1 (PRINT=1 in the$ESTIMATION record) so that the progress made at everyiteration can be examined.) The final parameter estimatesshould be examined, and if they appear reasonable, theymight be accepted. Although the user may have requestedmore than 2 significant digits, the data may only supportabout 2 digits, given the precision of the arithmetic beingused. By examining the gradients carefully, it is oftenpossible to obtain further information about which parameterestimates are less-well determined.Even though the final parameter estimates may be adequate,it is unlikely that the minimum is sufficientlywell-determined to allow the Covariance Step to runsuccessfully, at least with the number of significantfigures requested in the Estimation Step. The EstimationStep may need to be rerun, requesting only 2 significantfigures, followed by the Covariance Step.If the number of significant digits is less than 2 (or evennegative), then the final estimates should not be trusted.The problem may be model misspecification or insufficientdata.Model misspecification is a very general problem involvingsome mismatch between the model and the data. This canresult in particularly large values of the objectivefunction or slow convergence of the minimization search.Sometimes the model is overparameterized. This means thatthe model has more parameters than can be well-enoughestimated from the data (e.g., a biexponential model is fitto monoexponential data). When model misspecificationoccurs due to over-parameterization, then the EstimationStep will usually proceed smoothly, but terminate with fewerthan 2 significant digits. It is best to start with simplemodels (see Chapter 11).A related problem arises when a covariance element, e.g.,&Omega;12 (or &Sigma;12), is being estimated. If the ID (or L2 dataitem) is not used correctly, it may appear as though thecovariance does not affect objective function values, andthen this parameter will not be well estimated. In otherwords, it may appear as though the model isoverparameterized due to the inclusion of this parameter.See Chapter 12, Section 4.2.3. Abnormal Termination of the Covariance StepIt is possible for the Estimation Step to terminatesuccessfully, and yet the Covariance Step generates an errormessage. Error messages from the Covariance Step areprinted immediately after line 46 of Figure 10.5. Themessages are listed in Users Guide I.When a message arises, often it is:R MATRIX ALGORITHMICALLY NON-POSITIVE-SEMIDEFINITEBUT NONSINGULARCOVARIANCE STEP ABORTEDIn order for the minimization routine to terminatesuccessfully, it needs to determine that the final gradientvector is sufficiently small, which is a necessary conditionfor a minimum to have been achieved. This condition,however, is not sufficient. A sufficient condition, thatthe R matrix be positive definite (and therefore, that theapparent minimum not be a saddle point) is only checked inthe Covariance Step. The message means that the sufficientcondition appears not to be satisfied. The final estimateis, therefore, in doubt.Sometimes the message is:R MATRIX ALGORITHMICALLY SINGULARCOVARIANCE STEP UNOBTAINABLES MATRIX ALGORITHMICALLY SINGULARThis arises when there exists a parameter whose values donot actually affect the predictions and whose gradient inthe intermediate output is always 0.In general, successful completion of the Covariance Steprequires a better defined minimum than does the successfulcompletion of the Estimation Step.4. Miscellaneous ProblemsThis section discusses a few simple errors which preventNONMEM-PREDPP from running successfully.4.1. Proportional Error ModelA common error is to use the proportional error model whilesome predicted values for actual observations are zero orclose to zero. (For example, if the first dose is aninfusion and there is a &quot;baseline&quot; observation at the startof the infusion, the predicted level will be zero.)With individual data this will lead to an error messagesimilar to the following (the individual number may bedifferent from 1):PROGRAM TERMINATED BY OBJ, ERROR IN ELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)VAR-COV OF DATA FROM INDIVIDUAL RECORD ESTIMATED TO BE SINGULARWith population data this will lead to an error messagesimilar to the following (the individual and record numbersmay be different than 1):PROGRAM TERMINATED BY OBJ, ERROR IN CELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)INTRAINDIVIDUAL VARIANCE OF DATA FROM OBS RECORD 1 ESTIMATED TO BE 04.2. Errors in the Pharmacokinetic ModelWhen using a new model, a run should done in which theEstimation Step is not run, and a scatterplot of PRED vs DVwith unit slope line is produced, to verify that the modeland the initial parameter estimates are reasonable. It ismuch harder to diagnose errors in the model or the initialestimates after the Estimation Step fails. Make sure thatthe initial value of the objective function is notexcessively large, and that the unit slope line shows on theplot: scaling errors can easily go undetected! E.g., if theunits are incorrect at some point in the model (L vs ml),the predictions may be wrong by a factor of 1000.Similarly, if no scale was specified for the compartmentbeing observed, the predictions for the observations arecompartment amounts rather than concentrations. In bothcases, the shape of the PRED vs DV plot may appear linear,but the axes may be labeled quite differently. Whenobservations from two different compartments are present inthe data (e.g., Cp and Cu), some of the observations may bescaled incorrectly. This is discussed in Chapter 6, Section9, and Chapter 7, Section 4.3.3.5. Errors with PREDPP5.1. Error Messages from a TRANS RoutineTRANS routines can produce error messages. Here is one fromTRANS2:ERROR IN TRANS2 ROUTINE: V IS ZEROAppendix 2 shows that TRANS2 normally computes K=CL/V. Theroutine checks that V is not zero, and upon finding that itis, it prints the informative message, and terminates therun (thus avoiding a machine &quot;division by zero&quot; interrupt bythe operating system). This error usually occurs with theinitial parameter estimates. E.g., suppose the relevant $PKstatement is:V=THETA(1)+WT*THETA(2)For some values of &theta;1, &theta;2, and WT, a value of zero is beingcomputed for V. The initial estimates of &theta;1 and &theta;2 shouldbe checked. The intercept &theta;1 might have been fixed to zero,in which case then, the values of WT should also be checked.If WT is recorded only on the first event record of eachindividual&rsquo;s data, careful coding is required to insure thata value of zero is not used when the $PK record is evaluatedwith subsequent event records.5.2. Error Messages from ADVAN RoutinesA similar error message can be generated in PREDPP, e.g.PK PARAMETER FOR OBSERVATION COMPARTMENT&rsquo;S SCALE IS ZEROSome scale parameter is modeled in such a way as to producea zero. Again, the code for that scale parameter, and theinitial estimates for the &theta;&rsquo;s used therein, should bechecked. Perhaps the scale parameter is being set equal toa volume parameter, and as described above, the volumeparameter is being set to zero. When TRANS1 is used, thevolume parameter is neither recognized nor checked.5.3. Numeric difficulties in PREDPPNumeric difficulties can occur with linear pharmacokineticmodels (e.g., ADVAN1-4) in the process of computing certainexponentials. They can occur from an error in the units ofeither a rate constant and/or the TIME data items. They canalso occur from inordinately large values for a rateconstant which arise during the minimization search. Thismight be avoided by placing appropriate constraints on &theta;&rsquo;s.They can also occur when the system is advanced over anexcessively long period of time. This can happen within anindividual record, when the individual had a course of drugtreatment, followed by a wash-out period, followed byanother course of drug treatment. The first dose record oftreatment courses other than the first should have EVID dataitem equal to 4 (reset-dose) rather than 1 (dose), to avoidcomputing excessively small compartment amounts (see Chapter6, Section 7.3), and to reduce computational cost.Difficulties can occur in the process of computingpredictions with ADVAN2 and ADVAN4 when values of KA and Karise during the minimization search that are very close toone another. The models encoded into the ADVAN routinesassume that KA and K have fairly distinct values, and theformulas for the predictions have the term KA-K in thedenominator. If, for example, the typical values of K andKA are associated with &theta;1 and &theta;2, respectively, then onemight try reparameterizing. The typical values of K and KA-Kcan be associated with &theta;1 and &theta;2, so that K=&theta;1 and KA=K+&theta;2.A lower bound of zero should be placed on &theta;2&dagger;.<cite>&dagger; This technique also prevents a &quot;flip-flop&quot; from occurring.(In the original parameterization, the final estimates of &theta;1and &theta;2 can be the final estimates of the typical values ofKA and K, respectively). </cite>A similar situation occurs with TRANS3, where VSS-V occursin the denominator of the expression for K21. As above,reparameterization and a constraint on an element of &theta; mayhelp.</a><br>
<a href="#INDEX">INDEX</a><br>
<a href="#- A -">- A -</a><br>
<a href="#- B -">- B -</a><br>
<a href="#- C -">- C -</a><br>
<a href="#- D -">- D -</a><br>
<a href="#- E -">- E -</a><br>
<a href="#- F -">- F -</a><br>
<a href="#- G -">- G -</a><br>
<a href="#- H -">- H -</a><br>
<a href="#- I -">- I -</a><br>
<a href="#- J -">- J -</a><br>
<a href="#- K -">- K -</a><br>
<a href="#- L -">- L -</a><br>
<a href="#- M -">- M -</a><br>
<a href="#- N -">- N -</a><br>
<a href="#- O -">- O -</a><br>
<a href="#- P -">- P -</a><br>
<a href="#- R -">- R -</a><br>
<a href="#- S -">- S -</a><br>
<a href="#- T -">- T -</a><br>
<a href="#- U -">- U -</a><br>
<a href="#- V -">- V -</a><br>
<a href="#- W -">- W -</a><br>
<a href="#- Y -">- Y -</a><br>
<a href="#- Z -">- Z -</a><br>

<hr>


<p align="center" style="margin-top: 1em">NONMEM Users
Guide - Part V</p>

<p align="center" style="margin-top: 1em">Introductory
Guide</p>

<p align="center" style="margin-top: 1em">April 2011</p>

<p align="center" style="margin-top: 1em">by</p>

<p align="center" style="margin-top: 1em">Alison J.
Boeckmann</p>

<p align="center" style="margin-top: 1em">Lewis B.
Sheiner</p>

<p align="center" style="margin-top: 1em">Stuart L.
Beal</p>

<p style="margin-top: 1em">NONMEM Project Group <br>
University of California at San Francisco</p>

<p style="margin-top: 1em">ICON Development Solutions
Ellicott City, Maryland</p>

<p style="margin-top: 1em">Copyright by the Regents of the
University of California <br>
1994,2011 <br>
All rights reserved</p></table>

<p style="margin-top: 1em"><b>Preface</b></p>

<p style="margin-top: 1em">This edition of &quot;NONMEM
Users Guide - Part V Introductory Guide&quot; is distributed
with NONMEM 7.2. It is the first new edition since 1994.
Details that have changed since the previous edition have
been corrected, and some new features have been added.</p>

<p style="margin-top: 1em">Significant changes are marked
with bars. <big>&#9474;</big></p>

<p style="margin-top: 1em">Examples of NONMEM outputs have
not been updated. They remain as they were in 1994 and are
from NONMEM IV. With later versions of NONMEM there are
changes in the outputs. In some cases the wording has been
changed; there is new content; and the numerical results may
have changed slightly. But none of this affects the features
and methodology that Lewis Sheiner described in chapters 2,
10, and 11.</p>

<p style="margin-top: 1em">True to its purpose as an
instructional guide for new users of NONMEM, this Guide
remains oriented to the classic NONMEM methods and basic
features (through NONMEM VI). References to even earlier
versions of NONMEM and PREDPP have been deleted.</p>

<p align="center" style="margin-top: 1em"><b>Chapter 1 -
Introduction to NONMEM, PREDPP, and NM-TRAN</b></p>

<h2>1. What This Chapter is AboutThis chapter introduces a computer program called NONMEM.It also introduces two programs that are distributed withNONMEM and make it easier to use: PREDPP and NM-TRAN. Thescope of this text itself is described, and suggestions aremade for reading it. A somewhat detailed technicaldescription of the components of NONMEM is then given. Thefinal section is a list of additional references.2. Introducing NONMEM2.1. What is NONMEM?NONMEM stands for &quot;Nonlinear Mixed Effects Model.&quot; NONMEMis a computer program, written in FORTRAN 90/95, designed tofit general statistical (nonlinear) regression-type modelsto data.NONMEM was developed by the NONMEM Project Group at theUniversity of California at San Francisco for analyzingpopulation pharmacokinetic data in particular.&dagger;<cite>&dagger; NONMEM versions up through VI are the property of the &#9474;Regents of the University of California, but ICON &#9474;Development Solutions has exclusive rights to license their &#9474;use. NONMEM 7 is the current version of the software and is &#9474;the property of ICON Development Solutions. </cite>These are data typically collected from clinical studies ofpharmaceutic agents, involving the administration of a drugto individuals and the subsequent observation of drug levels(most often in the blood plasma). Proper modeling of thesedata involves accounting for both unexplainable inter- andintra-subject effects (random effects), as well as measuredconcomitant effects (fixed effects). NONMEM allows thismixed effect modeling. Such modeling is especially usefulwhen there are only a few pharmacokinetic measurements fromeach individual sampled in the population, or when the datacollection design varies considerably between theseindividuals. However, NONMEM is a general program which canbe used to fit models to a wide variety of data.Like many nonlinear regression programs, NONMEM does nothave any &quot;built in&quot; models (such as the linear model) withwhich it can compute a predicted value given the currentvalues of the regression parameters. Instead, NONMEM callsa subroutine having entry name PRED (&quot;prediction&quot;) to obtaina predicted value. PRED also must compute for NONMEMpartial derivatives with respect to certain randomvariables. Depending on the model and the kinds of doses,PRED may be very simple or may be very complicated. A usercan write his own PRED subroutine. This can be as simple orcomplicated as is necessary, and may involve calls to itsown subprograms.2.2. What is PREDPP?PREDPP stands for &quot;PRED for Population Pharmacokinetics&quot;.It is a PRED subroutine for use with NONMEM and is thesecond major component distributed with NONMEM. WhereasNONMEM is a general nonlinear regression tool, PREDPP isspecialized to the kinds of predictions which arise inpharmacokinetic data analysis. It can compute predictionsaccording to many different pharmacokinetic models,according to a great variety of dosing regimens. Almost allthe examples in this guide use PREDPP.2.3. What is NM-TRAN?NM-TRAN stands for &quot;NONMEM Translator&quot;. It is the thirdmajor component distributed with NONMEM. It is a separate,&quot;stand-alone&quot; control language translator and datapreprocessor. When NM-TRAN is used, a NONMEM run includestwo separate steps: first the NM-TRAN step, in which a fileof NM-TRAN records (which begin with &quot;$&quot;) are translatedinto several NONMEM input files, and second the NONMEM stepitself. All the examples in this guide use NM-TRAN. Westrongly recommend its use.Note that neither NM-TRAN nor NONMEM-PREDPP runinteractively. Files of commands and data are created bymeans of (say) the operating system editor. Then NM-TRANand NONMEM are executed, using these files as input. Figure1.1 shows the relationship between NONMEM, PREDPP, andNM-TRAN.Fig 1.1. NONMEM, PREDPP, and NM-TRAN. A user-written PREDsubroutine could be included instead of PREDPP.2.4. Scope of this Introductory GuideThis Guide is intended to be read by new users ofNONMEM-PREDPP. Typically, such users have pharmacokineticdata, either from a population or from a single individual,to be fit to a standard pharmacokinetic model (e.g., a oneor two compartment linear mammillary model). However, newusers with nonstandard models, or withpharmacokinetic/pharmacodynamic data, may also find thisguide helpful.It is assumed that NONMEM and its components are alreadyinstalled on the user&rsquo;s computer and that the user wants tolearn to use them as quickly as possible. This guide doesnot tell how to perform the installation or how to run aninstalled NONMEM under a particular operating system; thenew user will have to ask experienced users what the localcommands are. However, someone who is installing NONMEM ata new site may find it useful to review this guide to get aquick overview of NONMEM, its component programs, itsinputs, and its outputs.This guide is not a text book in pharmacokinetics orstatistics. Readers should be familiar with basic conceptsin pharmacokinetics and statistical data analysis. We alsoassume a very basic familiarity with FORTRAN.2.5. Contents of this Introductory GuideChapter 2 contains two examples of the use of NONMEM. Thefirst presents data from a single individual; estimates areobtained of his pharmacokinetic parameters. The secondpresents data from a group of individuals; estimates areobtained of the pharmacokinetic parameters of the populationwhich this group represents. The examples serve tointroduce NONMEM notation, input and output, and to providean idea of what is possible using the system.Chapter 3 presents the notation and definitions we will useto discuss models for individual data. The relationship ofthese models to data is discussed, and the distinctionbetween so-called fixed effects and random effects is made.Chapter 4 extends this discussion to models for populationdata.Chapter 5 discusses NONMEM&rsquo;s fitting criterion, theparameter estimates obtained by using this criterion, andthe standard errors of these estimates. It then discusseshow to do hypothesis tests with NONMEM.Chapter 6 tells how to create data files for NONMEM-PREDPPand how to describe them using the $DATA and $INPUT recordsof NM-TRAN. It also discusses the Data Preprocessor featureof NM-TRAN.Chapter 7 tells how to use NM-TRAN to write simple$SUBROUTINE records for PREDPP, how to write $PK records forindividual data, and how to write $PK records for populationdata.Chapter 8 tells how to write simple $ERROR records forPREDPP. Chapters 7 and 8 are meant to be read in parallelwith Chapters 3 and 4.Chapter 9 tells how to use NM-TRAN to specify the remainingchoices for an analysis. It tells how to assign initialvalues to parameters ($THETA, $OMEGA, $SIGMA records), howto specify what analysis tasks to perform ($ESTIMATION,$COVARIANCE records), and how to specify certain additionaloutput ($TABLE, $SCATTERPLOT records).Chapter 10 describes NONMEM&rsquo;s output in detail.Chapter 11 outlines the process of model building, showinghow a simple model can be made more complex to better fitthe data.Chapter 12 briefly describes a variety of features of PREDPPand NONMEM that are somewhat advanced for this text but areof interest to most users of NONMEM. References are givento other documents in which additional information can befound.Chapter 13 discusses errors that can occur during a NONMEMrun.Appendix 1 describes PREDPP&rsquo;s most commonly usedpharmacokinetic models (ADVAN subroutines).Appendix 2 describes alternative parameterizations (TRANSsubroutines) for these models.Appendix 3 is a list of NM-TRAN records. &#9474;2.6. How to Read this GuideReaders who are completely new to NONMEM should read thisguide starting with Chapter 2; the examples presented areused again in the later chapters. Chapters 2-5 aretheoretical in nature. Chapters 6-12 describe the detailsof building the input for NONMEM-PREDPP and interpreting theoutput. Readers who have non-pharmacokinetic data to fitcan skip (or skim) Chapters 3, 4, 7, and 8. Readers whoalready have some familiarity with certain topics (e.g., whohave used other nonlinear analysis programs to analyze data)can concentrate on the chapters of interest to them. Intime, readers who are comfortable with NONMEM may be able towork entirely from Appendix 3. We strongly recommend thatsuch users &quot;graduate&quot; to the more thorough NONMEMdocumentation listed in Section 4 of this chapter.Throughout the guide, examples are given of NM-TRAN records.These examples appear in boldface:$THETA .01Examples are also given of (fragments) of input data files.They appear as follows:ID AMT TIME DV2 320. 0. 0.2 0. .27 1.71Alphabetic characters such as ID, AMT, etc., are shown fordescriptive purposes. They are not part of the actual datafile.3. A Brief Technical OverviewIn this section we discuss the components of NONMEM in somedetail. First-time readers may prefer to skip this sectionand go directly to Chapter 2, which gives an example of aNONMEM run, and return to this section later (if at all).3.1. NONMEMNONMEM is written (almost) entirely in ANSI FORTRAN 90/95. &#9474;It is distributed on CD-ROM as FORTRAN source code, some of &#9474;which is encrypted. It can be compiled and run on anycomputer which has a FORTRAN 90/95 compiler and sufficientmemory and speed to run a large, computationally intensiveprogram.NONMEM consists of a main program and many subroutines, allof which are required for each NONMEM run. As discussedabove, one subroutine, PRED, is not included in NONMEMitself.3.2. PREDPP and the PREDPP LibraryPREDPP is not a single subroutine. It is a collection ofFORTRAN subroutines. Some of these are always needed butmust be supplied by the user himself (see PK and ERRORbelow). Others are always needed and are supplied; theseare called the kernel routines. Others (subroutines ADVANand TRANS, for example) are also always needed, and aresupplied, but are chosen from different versionscorresponding to different pharmacokinetic models. Thecollection of supplied routines constitutes the PREDPPLibrary.3.3. Subroutines PK and ERRORTwo very important subroutines of PREDPP are called PK andERROR. PK computes the values of the population orindividual pharmacokinetic parameters (e.g., CL and V) of agiven model and accounts for the &quot;differences&quot; betweenindividual and population values. ERROR accounts for the&quot;differences&quot; between predicted and observed values. Thesetwo subroutines are where the basic task of modelling iscarried out; this task is the user&rsquo;s responsibility.Chapters 7 and 8 are devoted to a description of thesesubroutines.Figure 1.2 shows the major components of PREDPP.Figure 1.2. Components of PREDPP. ADVAN and TRANS arechosen from the PREDPP library. PK and ERROR areuser-supplied.3.4. Building an Executable Module for NONMEMWhether PREDPP is used or a special purpose PRED subroutineis written, the PRED subroutine must be combined (&quot;linked&quot;)with NONMEM; this process (which is sometimes is called&quot;link editing&quot; or &quot;loading&quot;) must take place before theactual NONMEM run. The NONMEM-PRED combination is generallycalled a &quot;load module&quot; or &quot;executable module&quot;. Compilingand linking are processes which are operating systemdependent; each installation must supply its own commandsand procedures for these tasks. They may be done before theNM-TRAN step or between it and the NONMEM step. This choiceis discussed in Section 3.7 below. For certain platforms, a &#9474;front-end interface provided by the NONMEM Project Group &#9474;(nmfe72.bat for MS/DOS; nmfe72 C-shell script for Unix-type) &#9474;can be used to perform these steps, and can create all both &#9474;types of load modules described below: generated subroutines &#9474;and user-written subroutines.3.5. NM-TRANNM-TRAN provides the following services: control languagetranslation, model specification via FORTRAN-like statements(called abbreviated code), partial differentiation, andpreprocessing of the data. They are discussed separately.3.6. Control Language TranslationNM-TRAN includes a language for communicating controlinformation to NONMEM. NM-TRAN records are free-form (i.e.,spacing between options within a record and the order of therecords and their options is flexible) and use English words(or their abbreviations) for options. For example, therecord name $ESTIMATION may be abbreviated to $EST; theoption name SIGDIGITS may be abbreviated to SIG. Eitherspaces or commas may be used to separate options. Defaultsare understood for most options, allowing the records to berelatively compact. Considerable error checking isperformed by NM-TRAN. This reduces the number and severityof the errors that can occur during the NONMEM run. NM-TRAN &#9474;also produces messages that warn the user of possible errors &#9474;in the data and/or control stream.NM-TRAN translates a file of NM-TRAN control records intoNONMEM control records, which use a fixed-field,predominately numerical control language.3.7. Model Specification via Abbreviated CodeWith PREDPP, FORTRAN subroutines PK and ERROR are needed tospecify parts of the pharmacostatistical model. In mostcases, these specifications can be directly expressed withinNM-TRAN records $PK and $ERROR, using FORTRAN-likeassignment and conditional statements called abbreviatedcode. These statements are implemented by NM-TRAN ascomplete FORTRAN subroutines in file FSUBS, incorporatingthe abbreviated code. An intermediate step between theNM-TRAN and NONMEM steps is needed to compile thesesubroutines and link them with NONMEM-PREDPP. &#9474;The message &quot;Recompiling certain components&quot; will be &#9474;displayed at the console at this step. &#9474;Figure 1.3 shows how the compile and link step relates tothe two steps of Figure 1.1.Figure 1.3. Building a NONMEM load module with generatedFORTRAN subroutines. An intermediate step is placed betweenthe two steps of Figure 1.1.If the user supplies complete PK and ERROR subroutines(i.e., $PK and $ERROR records are not used), then the NONMEMload module can be built at any time.Note that even when PREDPP is not used, the same optionsexist. For example, if the desired model can be expressedvia a $PRED record, then NM-TRAN will generate a completePRED subroutine. However, whereas NM-TRAN&rsquo;s FORTRAN-likesyntax is sufficient for most purposes of writing PK andERROR subroutines, it is not sufficient for writing any butthe simplest of PRED subroutines.3.8. Partial DifferentiationNONMEM requires that PRED (whether PREDPP or user-written)compute more than just predicted values. It must alsocompute certain partial derivatives with respect to therandom variables and described in Chapters 3 and 4.When $PK, $ERROR, or $PRED records are used, NM-TRANperforms symbolic differentiation to generate the codeneeded to compute these derivatives. This relieves the userof a major burden.3.9. Data PreprocessorNM-TRAN includes a Data Preprocessor program which allowsthe user greater flexibility in constructing his data filethan is allowed in a data file input directly into NONMEM.This is discussed in Chapter 6.4. Additional DocumentationMore information can be found in the other parts of theNONMEM Users Guide, all of which may be found as pdf files &#9474;on the NONMEM distribution medium.Part I - Users Basic GuideA thorough, step by step discussion of the variousfeatures and some of the statistical concepts involvedin using NONMEM, including many examples.Part II - Users Supplemental GuideA continuation of Part I which includes advancedfeatures of NONMEM.Part III - NONMEM Installation GuideA guide for installing NONMEM, PREDPP, and NM-TRAN.Part IV - NM-TRAN GuideA complete reference guide to NM-TRAN and the DataPreprocessor.Part V - Introductory GuideThe present document.Part VI - PREDPP GuideA complete reference guide to PREDPP.Part VII - Conditional Estimation MethodsA description of these methods and some guidelines fortheir use. &#9474;Part VIII - Help Guide &#9474;A fast way to locate information on a given word or &#9474;topic. The content of the Help Guide is also supplied &#9474;on the NONMEM distribution medium as both text files &#9474;(&quot;on-line help&quot;) and html files for on-line searching. &#9474;NONMEM V Supplemental Guide &#9474;Describes new features of NONMEM V. &#9474;Introduction to Version VI &#9474;Describes new features of NONMEM VI. &#9474;Introduction to NONMEM Version 7. &#9474;Describes new features of NONMEM 7.
<a name="1. What This Chapter is AboutThis chapter introduces a computer program called NONMEM.It also introduces two programs that are distributed withNONMEM and make it easier to use: PREDPP and NM-TRAN. Thescope of this text itself is described, and suggestions aremade for reading it. A somewhat detailed technicaldescription of the components of NONMEM is then given. Thefinal section is a list of additional references.2. Introducing NONMEM2.1. What is NONMEM?NONMEM stands for &quot;Nonlinear Mixed Effects Model.&quot; NONMEMis a computer program, written in FORTRAN 90/95, designed tofit general statistical (nonlinear) regression-type modelsto data.NONMEM was developed by the NONMEM Project Group at theUniversity of California at San Francisco for analyzingpopulation pharmacokinetic data in particular.&dagger;<cite>&dagger; NONMEM versions up through VI are the property of the &#9474;Regents of the University of California, but ICON &#9474;Development Solutions has exclusive rights to license their &#9474;use. NONMEM 7 is the current version of the software and is &#9474;the property of ICON Development Solutions. </cite>These are data typically collected from clinical studies ofpharmaceutic agents, involving the administration of a drugto individuals and the subsequent observation of drug levels(most often in the blood plasma). Proper modeling of thesedata involves accounting for both unexplainable inter- andintra-subject effects (random effects), as well as measuredconcomitant effects (fixed effects). NONMEM allows thismixed effect modeling. Such modeling is especially usefulwhen there are only a few pharmacokinetic measurements fromeach individual sampled in the population, or when the datacollection design varies considerably between theseindividuals. However, NONMEM is a general program which canbe used to fit models to a wide variety of data.Like many nonlinear regression programs, NONMEM does nothave any &quot;built in&quot; models (such as the linear model) withwhich it can compute a predicted value given the currentvalues of the regression parameters. Instead, NONMEM callsa subroutine having entry name PRED (&quot;prediction&quot;) to obtaina predicted value. PRED also must compute for NONMEMpartial derivatives with respect to certain randomvariables. Depending on the model and the kinds of doses,PRED may be very simple or may be very complicated. A usercan write his own PRED subroutine. This can be as simple orcomplicated as is necessary, and may involve calls to itsown subprograms.2.2. What is PREDPP?PREDPP stands for &quot;PRED for Population Pharmacokinetics&quot;.It is a PRED subroutine for use with NONMEM and is thesecond major component distributed with NONMEM. WhereasNONMEM is a general nonlinear regression tool, PREDPP isspecialized to the kinds of predictions which arise inpharmacokinetic data analysis. It can compute predictionsaccording to many different pharmacokinetic models,according to a great variety of dosing regimens. Almost allthe examples in this guide use PREDPP.2.3. What is NM-TRAN?NM-TRAN stands for &quot;NONMEM Translator&quot;. It is the thirdmajor component distributed with NONMEM. It is a separate,&quot;stand-alone&quot; control language translator and datapreprocessor. When NM-TRAN is used, a NONMEM run includestwo separate steps: first the NM-TRAN step, in which a fileof NM-TRAN records (which begin with &quot;$&quot;) are translatedinto several NONMEM input files, and second the NONMEM stepitself. All the examples in this guide use NM-TRAN. Westrongly recommend its use.Note that neither NM-TRAN nor NONMEM-PREDPP runinteractively. Files of commands and data are created bymeans of (say) the operating system editor. Then NM-TRANand NONMEM are executed, using these files as input. Figure1.1 shows the relationship between NONMEM, PREDPP, andNM-TRAN.Fig 1.1. NONMEM, PREDPP, and NM-TRAN. A user-written PREDsubroutine could be included instead of PREDPP.2.4. Scope of this Introductory GuideThis Guide is intended to be read by new users ofNONMEM-PREDPP. Typically, such users have pharmacokineticdata, either from a population or from a single individual,to be fit to a standard pharmacokinetic model (e.g., a oneor two compartment linear mammillary model). However, newusers with nonstandard models, or withpharmacokinetic/pharmacodynamic data, may also find thisguide helpful.It is assumed that NONMEM and its components are alreadyinstalled on the user&rsquo;s computer and that the user wants tolearn to use them as quickly as possible. This guide doesnot tell how to perform the installation or how to run aninstalled NONMEM under a particular operating system; thenew user will have to ask experienced users what the localcommands are. However, someone who is installing NONMEM ata new site may find it useful to review this guide to get aquick overview of NONMEM, its component programs, itsinputs, and its outputs.This guide is not a text book in pharmacokinetics orstatistics. Readers should be familiar with basic conceptsin pharmacokinetics and statistical data analysis. We alsoassume a very basic familiarity with FORTRAN.2.5. Contents of this Introductory GuideChapter 2 contains two examples of the use of NONMEM. Thefirst presents data from a single individual; estimates areobtained of his pharmacokinetic parameters. The secondpresents data from a group of individuals; estimates areobtained of the pharmacokinetic parameters of the populationwhich this group represents. The examples serve tointroduce NONMEM notation, input and output, and to providean idea of what is possible using the system.Chapter 3 presents the notation and definitions we will useto discuss models for individual data. The relationship ofthese models to data is discussed, and the distinctionbetween so-called fixed effects and random effects is made.Chapter 4 extends this discussion to models for populationdata.Chapter 5 discusses NONMEM&rsquo;s fitting criterion, theparameter estimates obtained by using this criterion, andthe standard errors of these estimates. It then discusseshow to do hypothesis tests with NONMEM.Chapter 6 tells how to create data files for NONMEM-PREDPPand how to describe them using the $DATA and $INPUT recordsof NM-TRAN. It also discusses the Data Preprocessor featureof NM-TRAN.Chapter 7 tells how to use NM-TRAN to write simple$SUBROUTINE records for PREDPP, how to write $PK records forindividual data, and how to write $PK records for populationdata.Chapter 8 tells how to write simple $ERROR records forPREDPP. Chapters 7 and 8 are meant to be read in parallelwith Chapters 3 and 4.Chapter 9 tells how to use NM-TRAN to specify the remainingchoices for an analysis. It tells how to assign initialvalues to parameters ($THETA, $OMEGA, $SIGMA records), howto specify what analysis tasks to perform ($ESTIMATION,$COVARIANCE records), and how to specify certain additionaloutput ($TABLE, $SCATTERPLOT records).Chapter 10 describes NONMEM&rsquo;s output in detail.Chapter 11 outlines the process of model building, showinghow a simple model can be made more complex to better fitthe data.Chapter 12 briefly describes a variety of features of PREDPPand NONMEM that are somewhat advanced for this text but areof interest to most users of NONMEM. References are givento other documents in which additional information can befound.Chapter 13 discusses errors that can occur during a NONMEMrun.Appendix 1 describes PREDPP&rsquo;s most commonly usedpharmacokinetic models (ADVAN subroutines).Appendix 2 describes alternative parameterizations (TRANSsubroutines) for these models.Appendix 3 is a list of NM-TRAN records. &#9474;2.6. How to Read this GuideReaders who are completely new to NONMEM should read thisguide starting with Chapter 2; the examples presented areused again in the later chapters. Chapters 2-5 aretheoretical in nature. Chapters 6-12 describe the detailsof building the input for NONMEM-PREDPP and interpreting theoutput. Readers who have non-pharmacokinetic data to fitcan skip (or skim) Chapters 3, 4, 7, and 8. Readers whoalready have some familiarity with certain topics (e.g., whohave used other nonlinear analysis programs to analyze data)can concentrate on the chapters of interest to them. Intime, readers who are comfortable with NONMEM may be able towork entirely from Appendix 3. We strongly recommend thatsuch users &quot;graduate&quot; to the more thorough NONMEMdocumentation listed in Section 4 of this chapter.Throughout the guide, examples are given of NM-TRAN records.These examples appear in boldface:$THETA .01Examples are also given of (fragments) of input data files.They appear as follows:ID AMT TIME DV2 320. 0. 0.2 0. .27 1.71Alphabetic characters such as ID, AMT, etc., are shown fordescriptive purposes. They are not part of the actual datafile.3. A Brief Technical OverviewIn this section we discuss the components of NONMEM in somedetail. First-time readers may prefer to skip this sectionand go directly to Chapter 2, which gives an example of aNONMEM run, and return to this section later (if at all).3.1. NONMEMNONMEM is written (almost) entirely in ANSI FORTRAN 90/95. &#9474;It is distributed on CD-ROM as FORTRAN source code, some of &#9474;which is encrypted. It can be compiled and run on anycomputer which has a FORTRAN 90/95 compiler and sufficientmemory and speed to run a large, computationally intensiveprogram.NONMEM consists of a main program and many subroutines, allof which are required for each NONMEM run. As discussedabove, one subroutine, PRED, is not included in NONMEMitself.3.2. PREDPP and the PREDPP LibraryPREDPP is not a single subroutine. It is a collection ofFORTRAN subroutines. Some of these are always needed butmust be supplied by the user himself (see PK and ERRORbelow). Others are always needed and are supplied; theseare called the kernel routines. Others (subroutines ADVANand TRANS, for example) are also always needed, and aresupplied, but are chosen from different versionscorresponding to different pharmacokinetic models. Thecollection of supplied routines constitutes the PREDPPLibrary.3.3. Subroutines PK and ERRORTwo very important subroutines of PREDPP are called PK andERROR. PK computes the values of the population orindividual pharmacokinetic parameters (e.g., CL and V) of agiven model and accounts for the &quot;differences&quot; betweenindividual and population values. ERROR accounts for the&quot;differences&quot; between predicted and observed values. Thesetwo subroutines are where the basic task of modelling iscarried out; this task is the user&rsquo;s responsibility.Chapters 7 and 8 are devoted to a description of thesesubroutines.Figure 1.2 shows the major components of PREDPP.Figure 1.2. Components of PREDPP. ADVAN and TRANS arechosen from the PREDPP library. PK and ERROR areuser-supplied.3.4. Building an Executable Module for NONMEMWhether PREDPP is used or a special purpose PRED subroutineis written, the PRED subroutine must be combined (&quot;linked&quot;)with NONMEM; this process (which is sometimes is called&quot;link editing&quot; or &quot;loading&quot;) must take place before theactual NONMEM run. The NONMEM-PRED combination is generallycalled a &quot;load module&quot; or &quot;executable module&quot;. Compilingand linking are processes which are operating systemdependent; each installation must supply its own commandsand procedures for these tasks. They may be done before theNM-TRAN step or between it and the NONMEM step. This choiceis discussed in Section 3.7 below. For certain platforms, a &#9474;front-end interface provided by the NONMEM Project Group &#9474;(nmfe72.bat for MS/DOS; nmfe72 C-shell script for Unix-type) &#9474;can be used to perform these steps, and can create all both &#9474;types of load modules described below: generated subroutines &#9474;and user-written subroutines.3.5. NM-TRANNM-TRAN provides the following services: control languagetranslation, model specification via FORTRAN-like statements(called abbreviated code), partial differentiation, andpreprocessing of the data. They are discussed separately.3.6. Control Language TranslationNM-TRAN includes a language for communicating controlinformation to NONMEM. NM-TRAN records are free-form (i.e.,spacing between options within a record and the order of therecords and their options is flexible) and use English words(or their abbreviations) for options. For example, therecord name $ESTIMATION may be abbreviated to $EST; theoption name SIGDIGITS may be abbreviated to SIG. Eitherspaces or commas may be used to separate options. Defaultsare understood for most options, allowing the records to berelatively compact. Considerable error checking isperformed by NM-TRAN. This reduces the number and severityof the errors that can occur during the NONMEM run. NM-TRAN &#9474;also produces messages that warn the user of possible errors &#9474;in the data and/or control stream.NM-TRAN translates a file of NM-TRAN control records intoNONMEM control records, which use a fixed-field,predominately numerical control language.3.7. Model Specification via Abbreviated CodeWith PREDPP, FORTRAN subroutines PK and ERROR are needed tospecify parts of the pharmacostatistical model. In mostcases, these specifications can be directly expressed withinNM-TRAN records $PK and $ERROR, using FORTRAN-likeassignment and conditional statements called abbreviatedcode. These statements are implemented by NM-TRAN ascomplete FORTRAN subroutines in file FSUBS, incorporatingthe abbreviated code. An intermediate step between theNM-TRAN and NONMEM steps is needed to compile thesesubroutines and link them with NONMEM-PREDPP. &#9474;The message &quot;Recompiling certain components&quot; will be &#9474;displayed at the console at this step. &#9474;Figure 1.3 shows how the compile and link step relates tothe two steps of Figure 1.1.Figure 1.3. Building a NONMEM load module with generatedFORTRAN subroutines. An intermediate step is placed betweenthe two steps of Figure 1.1.If the user supplies complete PK and ERROR subroutines(i.e., $PK and $ERROR records are not used), then the NONMEMload module can be built at any time.Note that even when PREDPP is not used, the same optionsexist. For example, if the desired model can be expressedvia a $PRED record, then NM-TRAN will generate a completePRED subroutine. However, whereas NM-TRAN&rsquo;s FORTRAN-likesyntax is sufficient for most purposes of writing PK andERROR subroutines, it is not sufficient for writing any butthe simplest of PRED subroutines.3.8. Partial DifferentiationNONMEM requires that PRED (whether PREDPP or user-written)compute more than just predicted values. It must alsocompute certain partial derivatives with respect to therandom variables and described in Chapters 3 and 4.When $PK, $ERROR, or $PRED records are used, NM-TRANperforms symbolic differentiation to generate the codeneeded to compute these derivatives. This relieves the userof a major burden.3.9. Data PreprocessorNM-TRAN includes a Data Preprocessor program which allowsthe user greater flexibility in constructing his data filethan is allowed in a data file input directly into NONMEM.This is discussed in Chapter 6.4. Additional DocumentationMore information can be found in the other parts of theNONMEM Users Guide, all of which may be found as pdf files &#9474;on the NONMEM distribution medium.Part I - Users Basic GuideA thorough, step by step discussion of the variousfeatures and some of the statistical concepts involvedin using NONMEM, including many examples.Part II - Users Supplemental GuideA continuation of Part I which includes advancedfeatures of NONMEM.Part III - NONMEM Installation GuideA guide for installing NONMEM, PREDPP, and NM-TRAN.Part IV - NM-TRAN GuideA complete reference guide to NM-TRAN and the DataPreprocessor.Part V - Introductory GuideThe present document.Part VI - PREDPP GuideA complete reference guide to PREDPP.Part VII - Conditional Estimation MethodsA description of these methods and some guidelines fortheir use. &#9474;Part VIII - Help Guide &#9474;A fast way to locate information on a given word or &#9474;topic. The content of the Help Guide is also supplied &#9474;on the NONMEM distribution medium as both text files &#9474;(&quot;on-line help&quot;) and html files for on-line searching. &#9474;NONMEM V Supplemental Guide &#9474;Describes new features of NONMEM V. &#9474;Introduction to Version VI &#9474;Describes new features of NONMEM VI. &#9474;Introduction to NONMEM Version 7. &#9474;Describes new features of NONMEM 7."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 2 -
NONMEM Examples</b></p>

<h2>1. What This Chapter is AboutIn this chapter, two examples of the use of NONMEM will begiven. The first estimates pharmacokinetic parameters of anindividual from his data; the second estimates so-calledpopulation parameters from data from a group of individuals.The examples serve to introduce NONMEM notation, input andoutput, and to provide an idea of what is possible using thesystem. The second example will be discussed again inChapter 11.2. An Individual&rsquo;s Theophylline KineticsFigure 2.1 shows the input used to fit a model toobservations of theophylline plasma concentration time ina single individual after a single dose of 320 mg.$PROB SIMPLE NONLINEAR REGRESSION - THEOPHYLINE$INPUT ID AMT TIME DV$DATA P2DATA$SUBROUTINE ADVAN2$PKKA=THETA(1)K=THETA(2)V=THETA(3)S2=V$ERRORY=F+ERR(1)$THETA (0, 1.7) (0, .102) (0, 29.)$OMEGA 1.2$ESTIMATION PRINT=5$COVARIANCE$TABLE ID AMT TIME$SCATTER PRED VS DV UNITFigure 2.1. The input (i.e., NM-TRAN control records) foranalysis of some individual theophylline data.The first line (record) gives a name to the problem. Therest of the lines (records) discuss the data, the model, andthe desired output. Before going into these in some greaterdetail, you may want to look right now at figures 2.1 and2.2, and then 2.4 and 2.5. Figure 2.2 shows the data forthis problem, and figures 2.4 and 2.5 show some of NONMEM&rsquo;soutput. All you need to know to get a good idea of whatthis analysis shows is that the one-compartment model withfirst-order absorption has been used; the observedconcentrations and the times of observation after the bolusdose are in columns 4 and 3, respectively, of figure 2.2;and that the symbol DV stands for dependent variable (theobserved concentrations, in this case). You should, forexample, even at this point, be able to tell that theestimate of Volume of Distribution (V in figure 2.1, andTHETA(3) in figure 2.4) is 32 liters (L), with a standarderror of L. Now consider the figures in greaterdetail.2.1. The NM-TRAN Control RecordsThe second record of figure 2.1 names the data items thatappear on each data record, and the third record gives thename of the file containing the data records, P2DATA in thisexample. Figure 2.2 shows the contents of P2DATA.2 320. 0. 0.2 0. .27 1.712 0. .52 7.912 0. 1. 8.312 0. 1.92 8.332 0. 3.5 6.852 0. 5.02 6.082 0. 7.03 5.42 0. 9. 4.552 0. 12. 3.012 0. 24.3 .90Figure 2.2. The contents of the data file containing thedata records.According to the second record of figure 2.1, the third dataitem (column) of a data record is TIME, the time associatedwith the event described by that data record. The event ata given time (for this simple data set) can either be theadministration of a dose or the acquisition of anobservation. The second data item of a data record is AMT,amount (in this case in mg) of the dose given at TIME, thetime of the record. Apparently, 320 mg is given at timezero (first record of figure 2.2), and no further doses aregiven (all zeros in column 2 thereafter). The fourth dataitem (column) in P2DATA is named DV, for Dependent Variable(the measured plasma theophylline concentration), as alreadymentioned. So, all of the data records, except the first,give the time after the 320 mg dose, and the concentrationof theophylline (in mg/L) measured in a plasma sample drawnat that time. The first data item is labelled ID for theIDentification number of the patient. Here it happens to be2.2.2. The ModelThe fourth record of figure 2.1 identifies thepharmacokinetic model PREDPP is to use: the one-compartmentmodel with first-order absorption. It is implemented by anADVAN subroutine (see Chapter 1, Section 3.2) which iscalled ADVAN2 (See Chapter 7). Figure 2.3 shows the part ofthe output of NONMEM for this problem that verifies theuser&rsquo;s choice of model. It also describes the features ofthe model in terms of its compartments. Of relevance tothis problem are the DEPOT compartment (where the dose goes,and from which drug enters the central compartment by afirst order process), and the CENTRAL compartment itself.Note, for example, that the default compartment for doses(i.e., where PREDPP will add doses if not otherwiseinstructed) is the DEPOT compartment, as it should be.ONE COMPARTMENT MODEL WITH FIRST-ORDER ABSORPTION (ADVAN2)MAXIMUM NO. OF BASIC PK PARAMETERS: 3BASIC PK PARAMETERS (AFTER TRANSLATION):ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 1ABSORPTION RATE (KA) IS BASIC PK PARAMETER NO.: 3COMPARTMENT ATTRIBUTESCOMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULTSTATUS ALLOWED ALLOWED FOR DOSE FOR OBS.1 DEPOT OFF YES YES YES NO2 CENTRAL ON NO YES NO YES3 OUTPUT OFF YES NO NO NOFigure 2.3. The PREDPP output that verifies the user&rsquo;schoice of model. Features of the model are discussed, suchas the names and numbering of parameters, and the attributesof the various compartments in the model.The fifth input record (figure 2.1) signals the start of theuser&rsquo;s specification of the model for the pharmacokineticparameters. This specification is given in the next 4 linesof so-called abbreviate___________ cod____ (the $PK record, along withthis abbreviated code is called the $PK block). Some of theparameters that NONMEM estimates are denoted by herein,and are labeled THETA in NONMEM input and output. The modelspecified in figure 2.1 is very simple. It says that adifferent unknown constant (NONMEM parameter) is to beassigned to each pharmacokinetic parameter: first-orderabsorption rate, KA (line 1 of the PK block, after the $PKrecord - THETA(1)), rate constant of elimination, K (line 2- THETA(2)), and volume of distribution, V (line 3 -THETA(3)). The S2 parameter (a so-called scale parameter)is discussed in Chapter 3, Section 2.2.The sixth input record (figure 2.1 - line) signals thestart of the user&rsquo;s specification of the (statistical) modelfor the lack of fit of the pharmacokinetic model to thedata. This specification is given in the next line ofabbreviated code (the $ERROR record, along with this line ofabbreviated code is called the $ERROR block). The modelhere says that observations differ from predictions by anadditive error (ERR(1)).Record 7 ($THETA) gives NONMEM information about possiblevalues of each element of in the format: lower bound,initial estimate, upper bound. When, as in this particularrecord, only two numbers are given for an element of ,these are understood to mean the lower bound and initialestimate; the upper bound is unlimited. Record 8 ($OMEGA)gives NONMEM an initial estimate of the variance of ERR(1).This statistical parameter is often denoted by instatistical discussions, but with data from a singleindividual, it is denoted by in NONMEM documentation, andby OMEGA in NONMEM input and output. It is understood thata variance parameter is always nonnegative. The $OMEGArecord is further discussed in Chapter 9, Section 3.2.3. The OutputRecord 9 ($ESTIMATION) instructs NONMEM to obtain estimatesof the parameters, and the next record ($COVARIANCE) asksthat it also obtain standard errors of the parameterestimates. The output is shown in figure 2.4. It requireslittle discussion. The first item, the minimum value of theobjective function, is a goodness of fit statistic, muchlike a sum of squares (and as with a sum of squares, thelower the value, the better the fit). The parameterestimates (the parameter values at which the objectivefunction is minimized) and their standard errors follow.Note that the estimate of OMEGA, too, has a standard error.Unlike most fitting programs, NONMEM treats this parameterlike any other.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 8.940 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 31.94E+00 1.02E-01 3.20E+01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 8.99E-01******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 36.28E-01 7.35E-03 1.25E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 5.44E-01Figure 2.4. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) theparameter estimates, and their standard errors.The next to last control record asks NONMEM to print a tabledisplaying the input data and certain computed quantities.A portion of a NONMEM table is shown in figure 10.10 ofChapter 10. The last control record asks NONMEM to make ascatterplot of the prediction of each plasma concentration(PRED) VS the observed value (DV) and to draw the line ofidentity (UNIT, for &quot;unit slope&quot; line) on the plot. Theplot is shown in figure 2.5.PRED VS. DV8.00E-01 2.34E+00 3.88E+00 PRED 5.42E+00 6.96E+00 8.50E+00. . . . . .. . . . . . . . . . .7.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ..*. .. . .. . .. . .. . .. . * .. . .. . .. . .2.26E+00. . ... . .. . .. . .. . .. * .. . .. . .. . .. . .3.82E+00. . ... . .. . .. . .. . .DV . * . .. . .. . .. . .. . .5.38E+00. * . ... . .. . .. . .. . * .. . .. . .. . .. . .. . * .6.94E+00. . ... . .. . .. . .. . .. . .. * . .. . .. . .. * *.8.50E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.5. A scatterplot of the observed data (DV) vs thepredictions of the best-fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.3. A Population Model for PhenobarbitalAbout 60 infants were given phenobarbital therapeutically.A plasma concentration was measured in each some hours afterthe first (loading) dose, followed by multiple maintenancedoses. A second, and sometimes a third concentration weremeasured later. In all, 155 concentrations were observed.Figure 2.6 gives the NM-TRAN control records. The data aretoo lengthy to show in full, but figure 2.7 shows the datafor the first individual&dagger;.<cite>&dagger; File PHENO of NONMEM distribution medium contains the &#9474;complete data set. </cite>Figures 2.8 - 2.10 have some relevant output. Again, mostof the analysis results are apparent from the figures, andyou should try to see if you can figure them out beforegoing further. Note that the $INPUT record now defines anew data item, WT, the patient weight. It&rsquo;s value is givenon every data record for an individual, in the columnindicated. This is so despite the fact that WT may notchange within an individual. This is a bit repetitious, butconvenient.$PROBLEM PHENOBARB$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)CL=TVCL+ETA(1)TVVD=THETA(2)V=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0047) (0,.99)$OMEGA .0000055, .04$SIGMA 25$ESTIMATION PRINT=5$TABLE ID TIME AMT WT APGR$COVARIANCE$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.6. NM-TRAN control records for analysis of somepopulation phenobarbital data.1 0. 25.0 1.4 7 .1 2.0 . 1.4 7 17.31 12.5 3.5 1.4 7 .1 24.5 3.5 1.4 7 .1 37.0 3.5 1.4 7 .1 48.0 3.5 1.4 7 .1 60.5 3.5 1.4 7 .1 72.5 3.5 1.4 7 .1 85.3 3.5 1.4 7 .1 96.5 3.5 1.4 7 .1 108.5 3.5 1.4 7 .1 112.5 . 1.4 7 31.0Figure 2.7. The first individual&rsquo;s phenobarbital data.3.1. The NM-TRAN Control RecordsThe records are very similar to those for the theophyllineproblem. The new features are that the model has changed(it is implemented by ADVAN1, not ADVAN2), the model for thepharmacokinetic parameters is more complicated, and anadditional scatterplot is requested. The data for eachinfant is similar to those shown in figure 2.7; however, nowall of the data records for each infant start with the samevalue for the ID data item (column 1), but this valuediffers between infants.3.2. The ModelADVAN1 implements the one-compartment (monoexponential)model, without first order absorption. No absorption modelwas needed for this problem because all concentrations weremeasured many hours after the last (oral) dose, soabsorption could be considered to be complete, and, for thepurposes of data analysis, immediate.The parameters of the one-compartment model are defined bythe abbreviated code following the $PK statement: Clearance(CL) and Volume of Distribution (V). However, here eachparameter is not simply equal to one of NONMEM&rsquo;s parameters(an element of THETA). Rather, CL, for example, is equal toa parameter (THETA(1)) plus a new term, ETA(1). The latterexpresses interindividual variability, and stands for thedeviation of the individual&rsquo;s true clearance (CL) from thepopulation value (TVCL, Typical Value of CLearance, which,in turn, is simply THETA(1)). This model is essentiallydifferent from the theophylline model, because itincorporates interindividual variability (something that anindividual model need not do). Note that since PREDPPultimately needs the values of microconstants, rather thanphysiological-based pharmacokinetic parameters such asclearance, code must be given for K, the rate constant ofelimination. There is, though, a simple alternative towriting this additional line of code. It is discussed inChapter 3 Section 2.1.The abbreviated code after the $ERROR record is exactly thesame as that with the theophylline data and expresses thesame model for lack-of fit between observations andpredictions for an individual. The $OMEGA and $SIGMArecords, which give NONMEM information about the estimatedvariances of the ETA and ERR variables, are discussed inChapter 9, Section 3. Previously the initial estimate ofthe variance of ERR(1) was given on a $OMEGA record. Hereit is given on a $SIGMA record. This difference in NONMEMconventions between individual type data and population typedata will be discussed more fully in Chapters 3 and 4.3.3. The OutputNONMEM is again instructed to estimate the parameters andtheir standard errors. The results are shown in figures 2.8and 2.9.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 717.203 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 25.48E-03 1.40E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 6.85E-06ETA2 0.00E+00 2.86E-01SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.01E+00Figure 2.8. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) andthe parameter estimates for the phenobarbital problem.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 24.86E-04 7.84E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.27E-06ETA2 ......... 8.34E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.49E+00Figure 2.9. NONMEM output giving the standard errors of theparameter estimates for the phenobarbital problem.Note that now there are estimates of the variances of theinterindividual differences in CL (OMEGA - ETA1) and V(OMEGA - ETA2), as well as of the residual error variance(denoted by SIGMA in NONMEM output when the data are from apopulation; again, see Chapters 3 and 4). There are alsostandard errors for these estimates.The next-to-last control record asks NONMEM to make the samekind of scatterplot as in the theophylline problem: a plotof the predictions vs the observations. Here, a predictionfor an individual&rsquo;s observation is based on typical(population) values of the pharmacokinetic parameters (seefigure 2.8), rather than the values of the pharmacokineticparameters for the specific individual. The plot is shownin figure 2.10.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. * .. . .. * * ** * * .. * * ** * * * .. .* .. * *3 * * * .1.80E+01. * *** *2 * ... * * 3*2 * .. 2 * . *2 2* * * .. *2 **2*. * * * * .. *2* 2 . * * .. *2 * ** * ** * .. ** *** 3. * * * .. * . 2 * * .. * 2 . ** * * * .. * * *.2 * * .3.10E+01. * **** 2** ... * ** . .. * 22* * * .. * * . * .. ** * . .DV . * * ** * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.10. A scatterplot of the observed data (DV) vs thepredictions with the best fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.Here, in contrast to figure 2.5, the data arise from manydifferent individuals. One cannot tell which data came fromwhich infant.Although the fit is fairly good, the points far to the rightof the line of identity of figure 2.10 indicate that thereare many predictions (PRED) that are much higher than theircorresponding observations (DV). This is seen from anotherpoint of view in the second scatterplot. This scatterplotplots residuals (RES) vs patient weight (from the data item,WT &mdash; see figure 2.6). A residual is the difference betweenan observed concentration and its prediction (the sameprediction used in the scatterplot of figure 2.10). Theresiduals reflect not only lack of fit between observationsand predictions for a given individual (the variance SIGMA),but also interindividual variability (the variancescomprising OMEGA). They can be thought of as reflecting thepart of the data that the model does not explain. As can beseen from figure 2.11, there is a clear relationship betweenthe sign and magnitude of the residuals and patient weight.Here, the patients with the largest weights have the mostnegative residuals; i.e., their predictions are much largerthan their observations. These are the same points thatfell on the far right of figure 2.10.RES VS. WT-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. . * .. *. *** 2 * **2 .. . .. . * 2 .. * 23 2* * .. . .. * **. **23* .. * 22 **2 4*3* * * .1.14E+00. . ... * * .*2*42*** .. *** 34** .. . .. * ***222224* .. . .. * ** ** ****** .. . .. . .. * * ***3 * .1.78E+00. **2 ** 2* ... . .. ** * * .* .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... 2 . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. 2 * * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 2.11. A scatterplot of the residuals (RES) vspatient weight (WT). The pattern suggests that observationsare underpredicted in infants with low weight, andoverpredicted in those with higher weights.An obvious explanation is that Clearance or Volume, or both,increase with weight, so that without weight being takeninto account, too high a prediction is being made for alarger infant and too low a prediction is being made for asmaller infant, all other things (i.e., dose) being equal.To see if accounting for weight improves the fit, the runspecified in figure 2.12 can be done.$PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0027) (0,.70) .0018 .5$OMEGA .000007, .3$SIGMA 8$ESTIMATION PRINT=5$COVARIANCE$TABLE ID TIME AMT WT APGR DV$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.12. NM-TRAN control records for fitting a modeltaking into account the effect of patient weight to thepopulation phenobarbital data.Now both TVCL and TVVD are linear functions of weight with,in the case of TVCL, for example, intercept THETA(1), andslope THETA(3). Both slope and intercept are &quot;population&quot;parameters since they relate weight to typical populationvalues of the pharmacokinetic parameter. Now we see why WTis given in every data record: the abbreviated PK code mayneed to be evaluated at each event time. If WT did notchange over time within any patient, it could be given onlyon the first data record for each patient, but then slightlymore complicated abbreviated code would be needed. Theoutput from running the input of figure 2.12 is shown infigures 2.13 - 2.16.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 609.134 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 41.43E-11 1.21E-01 4.77E-03 9.18E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 1.36E-06ETA2 0.00E+00 7.51E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.71E+00Figure 2.13. The minimum objective function value andparameter estimates for the phenobarbital data, using themodel of figure 2.12, which takes into account the effect ofpatient weight.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 49.49E-11 1.46E-01 2.24E-04 1.13E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 7.24E-07ETA2 ......... 3.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.71E+00Figure 2.14. The standard errors of the parameter estimatesfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Note the improvement in the minimum objective function value(it drops 108 points), and the profound decreases in thesizes of the estimates of the interindividual variances; nowthat weight is in the model, there is less unexplainedinterindividual variability. As will be discussed inChapter 5, the decrease in the objective function can beused for a formal hypothesis test of the appropriateness ofthe new model (figure 2.12) for the effect of weight on thepharmacokinetic parameters.Note also the very small values estimated for THETA(1) andfor its standard error. The intercept term of TVCL does notappear to be an important part of the model. This model isrefined in Chapter 10, Section 6.2, where it is seen thatdeleting THETA(1) and THETA(3) produces a model that fits aswell as the model including them.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * ** ** .. * * . * * ** * .. * . .. *** *2 * * .1.80E+01. *.**3* * ... * 2*32 .. *22* * * * * * .. * *4** * . * 2 .. *2 * * .* * * .. * * 2* . * 2 * * .. **2 2 * . ** * * .. * 2 .* * .. * ** 2 * . * * .. * * * * * * * .3.10E+01. * * 2* * * * * ... ** .* .. ** ** * ** * . .. * ** . .. * * * . .DV . * * * ** . * * * .. * * . .. ** . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. * .. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.15. A scatterplot of predictions vs observationsfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Compare to figure 2.10.The scatterplots (figures 2.15 and 2.16) confirm that thenew model is an improvement: the group of points far to theright of the line of identity have disappeared from the PREDvs DV plot, and the plot of residuals vs weight no longershows a pattern.RES VS. WT-1.70E+01 -1.00E+01 -3.00E+00 RES 4.00E+00 1.10E+01 1.80E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * .. * * * * * * * . 2* * .. . .. *** . .. * * * *.* * * * * * .. . .. * * * * * ***** * .. * * ** * *. * ** 22 *2 * 2 * .1.14E+00. . ... * * * * * * **** * * * * * .. * * ** * 3 . 2* * .. . .. * 2 ***2. ** * 2* * ** ** .. . .. * * 3 *. ** * * * .. . .. . .. * *** . * * * * * .1.78E+00. * * . 2* ** * * ... . .. * * * ** .. . .. . .WT . *. * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * . .. . .. . .. . .. . .. . 2 .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.16. A scatterplot of residuals (RES) vs patientweight (WT) for the phenobarbital data, using the model offigure 2.12, which takes into account the effect of patientweight. Compare to figure 2.11.4. OverviewThe examples in this chapter illustrate some of the mostimportant and useful features of NONMEM.&deg; NONMEM can fit both individual and population models.&deg; NONMEM has a menu of pharmacokinetic models from whichthe one appropriate to the problem at hand can bechosen.&deg; The user specifies the relationship of pharmacokineticparameters to independent variables (such as WT in thephenobarbital example), using &quot;population&quot; parametersthat will be estimated.&deg; The user also specifies which parameters vary betweenindividuals, and the form (model) for this variability,as well as the form (model) for the differences betweenobservations from an individual and their predictionsfor this individual.&deg; NONMEM estimates parameters describing both kinds ofvariability.&deg; NONMEM provides estimates (standard errors) of theprecision of its parameter estimates, including thosedescribing variability.&deg; NONMEM provides a means of deciding whether one model(e.g., that including weight&rsquo;s effect on CL and V) fitsthe data better than another using the minimumobjective function value, a goodness-of-fit statistic.&deg; NONMEM provides (limited) graphics, useful in judgingthe adequacy of the model currently fit to the data.
<a name="1. What This Chapter is AboutIn this chapter, two examples of the use of NONMEM will begiven. The first estimates pharmacokinetic parameters of anindividual from his data; the second estimates so-calledpopulation parameters from data from a group of individuals.The examples serve to introduce NONMEM notation, input andoutput, and to provide an idea of what is possible using thesystem. The second example will be discussed again inChapter 11.2. An Individual&rsquo;s Theophylline KineticsFigure 2.1 shows the input used to fit a model toobservations of theophylline plasma concentration time ina single individual after a single dose of 320 mg.$PROB SIMPLE NONLINEAR REGRESSION - THEOPHYLINE$INPUT ID AMT TIME DV$DATA P2DATA$SUBROUTINE ADVAN2$PKKA=THETA(1)K=THETA(2)V=THETA(3)S2=V$ERRORY=F+ERR(1)$THETA (0, 1.7) (0, .102) (0, 29.)$OMEGA 1.2$ESTIMATION PRINT=5$COVARIANCE$TABLE ID AMT TIME$SCATTER PRED VS DV UNITFigure 2.1. The input (i.e., NM-TRAN control records) foranalysis of some individual theophylline data.The first line (record) gives a name to the problem. Therest of the lines (records) discuss the data, the model, andthe desired output. Before going into these in some greaterdetail, you may want to look right now at figures 2.1 and2.2, and then 2.4 and 2.5. Figure 2.2 shows the data forthis problem, and figures 2.4 and 2.5 show some of NONMEM&rsquo;soutput. All you need to know to get a good idea of whatthis analysis shows is that the one-compartment model withfirst-order absorption has been used; the observedconcentrations and the times of observation after the bolusdose are in columns 4 and 3, respectively, of figure 2.2;and that the symbol DV stands for dependent variable (theobserved concentrations, in this case). You should, forexample, even at this point, be able to tell that theestimate of Volume of Distribution (V in figure 2.1, andTHETA(3) in figure 2.4) is 32 liters (L), with a standarderror of L. Now consider the figures in greaterdetail.2.1. The NM-TRAN Control RecordsThe second record of figure 2.1 names the data items thatappear on each data record, and the third record gives thename of the file containing the data records, P2DATA in thisexample. Figure 2.2 shows the contents of P2DATA.2 320. 0. 0.2 0. .27 1.712 0. .52 7.912 0. 1. 8.312 0. 1.92 8.332 0. 3.5 6.852 0. 5.02 6.082 0. 7.03 5.42 0. 9. 4.552 0. 12. 3.012 0. 24.3 .90Figure 2.2. The contents of the data file containing thedata records.According to the second record of figure 2.1, the third dataitem (column) of a data record is TIME, the time associatedwith the event described by that data record. The event ata given time (for this simple data set) can either be theadministration of a dose or the acquisition of anobservation. The second data item of a data record is AMT,amount (in this case in mg) of the dose given at TIME, thetime of the record. Apparently, 320 mg is given at timezero (first record of figure 2.2), and no further doses aregiven (all zeros in column 2 thereafter). The fourth dataitem (column) in P2DATA is named DV, for Dependent Variable(the measured plasma theophylline concentration), as alreadymentioned. So, all of the data records, except the first,give the time after the 320 mg dose, and the concentrationof theophylline (in mg/L) measured in a plasma sample drawnat that time. The first data item is labelled ID for theIDentification number of the patient. Here it happens to be2.2.2. The ModelThe fourth record of figure 2.1 identifies thepharmacokinetic model PREDPP is to use: the one-compartmentmodel with first-order absorption. It is implemented by anADVAN subroutine (see Chapter 1, Section 3.2) which iscalled ADVAN2 (See Chapter 7). Figure 2.3 shows the part ofthe output of NONMEM for this problem that verifies theuser&rsquo;s choice of model. It also describes the features ofthe model in terms of its compartments. Of relevance tothis problem are the DEPOT compartment (where the dose goes,and from which drug enters the central compartment by afirst order process), and the CENTRAL compartment itself.Note, for example, that the default compartment for doses(i.e., where PREDPP will add doses if not otherwiseinstructed) is the DEPOT compartment, as it should be.ONE COMPARTMENT MODEL WITH FIRST-ORDER ABSORPTION (ADVAN2)MAXIMUM NO. OF BASIC PK PARAMETERS: 3BASIC PK PARAMETERS (AFTER TRANSLATION):ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 1ABSORPTION RATE (KA) IS BASIC PK PARAMETER NO.: 3COMPARTMENT ATTRIBUTESCOMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULTSTATUS ALLOWED ALLOWED FOR DOSE FOR OBS.1 DEPOT OFF YES YES YES NO2 CENTRAL ON NO YES NO YES3 OUTPUT OFF YES NO NO NOFigure 2.3. The PREDPP output that verifies the user&rsquo;schoice of model. Features of the model are discussed, suchas the names and numbering of parameters, and the attributesof the various compartments in the model.The fifth input record (figure 2.1) signals the start of theuser&rsquo;s specification of the model for the pharmacokineticparameters. This specification is given in the next 4 linesof so-called abbreviate___________ cod____ (the $PK record, along withthis abbreviated code is called the $PK block). Some of theparameters that NONMEM estimates are denoted by herein,and are labeled THETA in NONMEM input and output. The modelspecified in figure 2.1 is very simple. It says that adifferent unknown constant (NONMEM parameter) is to beassigned to each pharmacokinetic parameter: first-orderabsorption rate, KA (line 1 of the PK block, after the $PKrecord - THETA(1)), rate constant of elimination, K (line 2- THETA(2)), and volume of distribution, V (line 3 -THETA(3)). The S2 parameter (a so-called scale parameter)is discussed in Chapter 3, Section 2.2.The sixth input record (figure 2.1 - line) signals thestart of the user&rsquo;s specification of the (statistical) modelfor the lack of fit of the pharmacokinetic model to thedata. This specification is given in the next line ofabbreviated code (the $ERROR record, along with this line ofabbreviated code is called the $ERROR block). The modelhere says that observations differ from predictions by anadditive error (ERR(1)).Record 7 ($THETA) gives NONMEM information about possiblevalues of each element of in the format: lower bound,initial estimate, upper bound. When, as in this particularrecord, only two numbers are given for an element of ,these are understood to mean the lower bound and initialestimate; the upper bound is unlimited. Record 8 ($OMEGA)gives NONMEM an initial estimate of the variance of ERR(1).This statistical parameter is often denoted by instatistical discussions, but with data from a singleindividual, it is denoted by in NONMEM documentation, andby OMEGA in NONMEM input and output. It is understood thata variance parameter is always nonnegative. The $OMEGArecord is further discussed in Chapter 9, Section 3.2.3. The OutputRecord 9 ($ESTIMATION) instructs NONMEM to obtain estimatesof the parameters, and the next record ($COVARIANCE) asksthat it also obtain standard errors of the parameterestimates. The output is shown in figure 2.4. It requireslittle discussion. The first item, the minimum value of theobjective function, is a goodness of fit statistic, muchlike a sum of squares (and as with a sum of squares, thelower the value, the better the fit). The parameterestimates (the parameter values at which the objectivefunction is minimized) and their standard errors follow.Note that the estimate of OMEGA, too, has a standard error.Unlike most fitting programs, NONMEM treats this parameterlike any other.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 8.940 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 31.94E+00 1.02E-01 3.20E+01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 8.99E-01******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 36.28E-01 7.35E-03 1.25E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1ETA1 5.44E-01Figure 2.4. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) theparameter estimates, and their standard errors.The next to last control record asks NONMEM to print a tabledisplaying the input data and certain computed quantities.A portion of a NONMEM table is shown in figure 10.10 ofChapter 10. The last control record asks NONMEM to make ascatterplot of the prediction of each plasma concentration(PRED) VS the observed value (DV) and to draw the line ofidentity (UNIT, for &quot;unit slope&quot; line) on the plot. Theplot is shown in figure 2.5.PRED VS. DV8.00E-01 2.34E+00 3.88E+00 PRED 5.42E+00 6.96E+00 8.50E+00. . . . . .. . . . . . . . . . .7.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ..*. .. . .. . .. . .. . .. . * .. . .. . .. . .2.26E+00. . ... . .. . .. . .. . .. * .. . .. . .. . .. . .3.82E+00. . ... . .. . .. . .. . .DV . * . .. . .. . .. . .. . .5.38E+00. * . ... . .. . .. . .. . * .. . .. . .. . .. . .. . * .6.94E+00. . ... . .. . .. . .. . .. . .. * . .. . .. . .. * *.8.50E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.5. A scatterplot of the observed data (DV) vs thepredictions of the best-fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.3. A Population Model for PhenobarbitalAbout 60 infants were given phenobarbital therapeutically.A plasma concentration was measured in each some hours afterthe first (loading) dose, followed by multiple maintenancedoses. A second, and sometimes a third concentration weremeasured later. In all, 155 concentrations were observed.Figure 2.6 gives the NM-TRAN control records. The data aretoo lengthy to show in full, but figure 2.7 shows the datafor the first individual&dagger;.<cite>&dagger; File PHENO of NONMEM distribution medium contains the &#9474;complete data set. </cite>Figures 2.8 - 2.10 have some relevant output. Again, mostof the analysis results are apparent from the figures, andyou should try to see if you can figure them out beforegoing further. Note that the $INPUT record now defines anew data item, WT, the patient weight. It&rsquo;s value is givenon every data record for an individual, in the columnindicated. This is so despite the fact that WT may notchange within an individual. This is a bit repetitious, butconvenient.$PROBLEM PHENOBARB$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)CL=TVCL+ETA(1)TVVD=THETA(2)V=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0047) (0,.99)$OMEGA .0000055, .04$SIGMA 25$ESTIMATION PRINT=5$TABLE ID TIME AMT WT APGR$COVARIANCE$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.6. NM-TRAN control records for analysis of somepopulation phenobarbital data.1 0. 25.0 1.4 7 .1 2.0 . 1.4 7 17.31 12.5 3.5 1.4 7 .1 24.5 3.5 1.4 7 .1 37.0 3.5 1.4 7 .1 48.0 3.5 1.4 7 .1 60.5 3.5 1.4 7 .1 72.5 3.5 1.4 7 .1 85.3 3.5 1.4 7 .1 96.5 3.5 1.4 7 .1 108.5 3.5 1.4 7 .1 112.5 . 1.4 7 31.0Figure 2.7. The first individual&rsquo;s phenobarbital data.3.1. The NM-TRAN Control RecordsThe records are very similar to those for the theophyllineproblem. The new features are that the model has changed(it is implemented by ADVAN1, not ADVAN2), the model for thepharmacokinetic parameters is more complicated, and anadditional scatterplot is requested. The data for eachinfant is similar to those shown in figure 2.7; however, nowall of the data records for each infant start with the samevalue for the ID data item (column 1), but this valuediffers between infants.3.2. The ModelADVAN1 implements the one-compartment (monoexponential)model, without first order absorption. No absorption modelwas needed for this problem because all concentrations weremeasured many hours after the last (oral) dose, soabsorption could be considered to be complete, and, for thepurposes of data analysis, immediate.The parameters of the one-compartment model are defined bythe abbreviated code following the $PK statement: Clearance(CL) and Volume of Distribution (V). However, here eachparameter is not simply equal to one of NONMEM&rsquo;s parameters(an element of THETA). Rather, CL, for example, is equal toa parameter (THETA(1)) plus a new term, ETA(1). The latterexpresses interindividual variability, and stands for thedeviation of the individual&rsquo;s true clearance (CL) from thepopulation value (TVCL, Typical Value of CLearance, which,in turn, is simply THETA(1)). This model is essentiallydifferent from the theophylline model, because itincorporates interindividual variability (something that anindividual model need not do). Note that since PREDPPultimately needs the values of microconstants, rather thanphysiological-based pharmacokinetic parameters such asclearance, code must be given for K, the rate constant ofelimination. There is, though, a simple alternative towriting this additional line of code. It is discussed inChapter 3 Section 2.1.The abbreviated code after the $ERROR record is exactly thesame as that with the theophylline data and expresses thesame model for lack-of fit between observations andpredictions for an individual. The $OMEGA and $SIGMArecords, which give NONMEM information about the estimatedvariances of the ETA and ERR variables, are discussed inChapter 9, Section 3. Previously the initial estimate ofthe variance of ERR(1) was given on a $OMEGA record. Hereit is given on a $SIGMA record. This difference in NONMEMconventions between individual type data and population typedata will be discussed more fully in Chapters 3 and 4.3.3. The OutputNONMEM is again instructed to estimate the parameters andtheir standard errors. The results are shown in figures 2.8and 2.9.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 717.203 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 25.48E-03 1.40E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 6.85E-06ETA2 0.00E+00 2.86E-01SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.01E+00Figure 2.8. NONMEM output giving the goodness of fitstatistic (the minimum value of the objective function) andthe parameter estimates for the phenobarbital problem.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 24.86E-04 7.84E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.27E-06ETA2 ......... 8.34E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.49E+00Figure 2.9. NONMEM output giving the standard errors of theparameter estimates for the phenobarbital problem.Note that now there are estimates of the variances of theinterindividual differences in CL (OMEGA - ETA1) and V(OMEGA - ETA2), as well as of the residual error variance(denoted by SIGMA in NONMEM output when the data are from apopulation; again, see Chapters 3 and 4). There are alsostandard errors for these estimates.The next-to-last control record asks NONMEM to make the samekind of scatterplot as in the theophylline problem: a plotof the predictions vs the observations. Here, a predictionfor an individual&rsquo;s observation is based on typical(population) values of the pharmacokinetic parameters (seefigure 2.8), rather than the values of the pharmacokineticparameters for the specific individual. The plot is shownin figure 2.10.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. * .. . .. * * ** * * .. * * ** * * * .. .* .. * *3 * * * .1.80E+01. * *** *2 * ... * * 3*2 * .. 2 * . *2 2* * * .. *2 **2*. * * * * .. *2* 2 . * * .. *2 * ** * ** * .. ** *** 3. * * * .. * . 2 * * .. * 2 . ** * * * .. * * *.2 * * .3.10E+01. * **** 2** ... * ** . .. * 22* * * .. * * . * .. ** * . .DV . * * ** * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.10. A scatterplot of the observed data (DV) vs thepredictions with the best fitting model parameters (PRED).The line of identity (intercept = 0; slope = 1) is drawn.If all points fell on that line, the fit would be perfect.Here, in contrast to figure 2.5, the data arise from manydifferent individuals. One cannot tell which data came fromwhich infant.Although the fit is fairly good, the points far to the rightof the line of identity of figure 2.10 indicate that thereare many predictions (PRED) that are much higher than theircorresponding observations (DV). This is seen from anotherpoint of view in the second scatterplot. This scatterplotplots residuals (RES) vs patient weight (from the data item,WT &mdash; see figure 2.6). A residual is the difference betweenan observed concentration and its prediction (the sameprediction used in the scatterplot of figure 2.10). Theresiduals reflect not only lack of fit between observationsand predictions for a given individual (the variance SIGMA),but also interindividual variability (the variancescomprising OMEGA). They can be thought of as reflecting thepart of the data that the model does not explain. As can beseen from figure 2.11, there is a clear relationship betweenthe sign and magnitude of the residuals and patient weight.Here, the patients with the largest weights have the mostnegative residuals; i.e., their predictions are much largerthan their observations. These are the same points thatfell on the far right of figure 2.10.RES VS. WT-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. . * .. *. *** 2 * **2 .. . .. . * 2 .. * 23 2* * .. . .. * **. **23* .. * 22 **2 4*3* * * .1.14E+00. . ... * * .*2*42*** .. *** 34** .. . .. * ***222224* .. . .. * ** ** ****** .. . .. . .. * * ***3 * .1.78E+00. **2 ** 2* ... . .. ** * * .* .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... 2 . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. 2 * * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 2.11. A scatterplot of the residuals (RES) vspatient weight (WT). The pattern suggests that observationsare underpredicted in infants with low weight, andoverpredicted in those with higher weights.An obvious explanation is that Clearance or Volume, or both,increase with weight, so that without weight being takeninto account, too high a prediction is being made for alarger infant and too low a prediction is being made for asmaller infant, all other things (i.e., dose) being equal.To see if accounting for weight improves the fit, the runspecified in figure 2.12 can be done.$PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERRORY=F+ERR(1)$THETA (0,.0027) (0,.70) .0018 .5$OMEGA .000007, .3$SIGMA 8$ESTIMATION PRINT=5$COVARIANCE$TABLE ID TIME AMT WT APGR DV$SCATTER PRED VS DV UNIT$SCATTER RES VS WTFigure 2.12. NM-TRAN control records for fitting a modeltaking into account the effect of patient weight to thepopulation phenobarbital data.Now both TVCL and TVVD are linear functions of weight with,in the case of TVCL, for example, intercept THETA(1), andslope THETA(3). Both slope and intercept are &quot;population&quot;parameters since they relate weight to typical populationvalues of the pharmacokinetic parameter. Now we see why WTis given in every data record: the abbreviated PK code mayneed to be evaluated at each event time. If WT did notchange over time within any patient, it could be given onlyon the first data record for each patient, but then slightlymore complicated abbreviated code would be needed. Theoutput from running the input of figure 2.12 is shown infigures 2.13 - 2.16.******************************************************************************************************************************************** **************************************** MINIMUM VALUE OF OBJECTIVE FUNCTION **************************************** ********************************************************************************************************************************************************************************************** 609.134 ********************************************************************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 41.43E-11 1.21E-01 4.77E-03 9.18E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 1.36E-06ETA2 0.00E+00 7.51E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 8.71E+00Figure 2.13. The minimum objective function value andparameter estimates for the phenobarbital data, using themodel of figure 2.12, which takes into account the effect ofpatient weight.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 49.49E-11 1.46E-01 2.24E-04 1.13E-01OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 7.24E-07ETA2 ......... 3.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.71E+00Figure 2.14. The standard errors of the parameter estimatesfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Note the improvement in the minimum objective function value(it drops 108 points), and the profound decreases in thesizes of the estimates of the interindividual variances; nowthat weight is in the model, there is less unexplainedinterindividual variability. As will be discussed inChapter 5, the decrease in the objective function can beused for a formal hypothesis test of the appropriateness ofthe new model (figure 2.12) for the effect of weight on thepharmacokinetic parameters.Note also the very small values estimated for THETA(1) andfor its standard error. The intercept term of TVCL does notappear to be an important part of the model. This model isrefined in Chapter 10, Section 6.2, where it is seen thatdeleting THETA(1) and THETA(3) produces a model that fits aswell as the model including them.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * ** ** .. * * . * * ** * .. * . .. *** *2 * * .1.80E+01. *.**3* * ... * 2*32 .. *22* * * * * * .. * *4** * . * 2 .. *2 * * .* * * .. * * 2* . * 2 * * .. **2 2 * . ** * * .. * 2 .* * .. * ** 2 * . * * .. * * * * * * * .3.10E+01. * * 2* * * * * ... ** .* .. ** ** * ** * . .. * ** . .. * * * . .DV . * * * ** . * * * .. * * . .. ** . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. * .. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.15. A scatterplot of predictions vs observationsfor the phenobarbital data, using the model of figure 2.12,which takes into account the effect of patient weight.Compare to figure 2.10.The scatterplots (figures 2.15 and 2.16) confirm that thenew model is an improvement: the group of points far to theright of the line of identity have disappeared from the PREDvs DV plot, and the plot of residuals vs weight no longershows a pattern.RES VS. WT-1.70E+01 -1.00E+01 -3.00E+00 RES 4.00E+00 1.10E+01 1.80E+01. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * .. * * * * * * * . 2* * .. . .. *** . .. * * * *.* * * * * * .. . .. * * * * * ***** * .. * * ** * *. * ** 22 *2 * 2 * .1.14E+00. . ... * * * * * * **** * * * * * .. * * ** * 3 . 2* * .. . .. * 2 ***2. ** * 2* * ** ** .. . .. * * 3 *. ** * * * .. . .. . .. * *** . * * * * * .1.78E+00. * * . 2* ** * * ... . .. * * * ** .. . .. . .WT . *. * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * . .. . .. . .. . .. . .. . 2 .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 2.16. A scatterplot of residuals (RES) vs patientweight (WT) for the phenobarbital data, using the model offigure 2.12, which takes into account the effect of patientweight. Compare to figure 2.11.4. OverviewThe examples in this chapter illustrate some of the mostimportant and useful features of NONMEM.&deg; NONMEM can fit both individual and population models.&deg; NONMEM has a menu of pharmacokinetic models from whichthe one appropriate to the problem at hand can bechosen.&deg; The user specifies the relationship of pharmacokineticparameters to independent variables (such as WT in thephenobarbital example), using &quot;population&quot; parametersthat will be estimated.&deg; The user also specifies which parameters vary betweenindividuals, and the form (model) for this variability,as well as the form (model) for the differences betweenobservations from an individual and their predictionsfor this individual.&deg; NONMEM estimates parameters describing both kinds ofvariability.&deg; NONMEM provides estimates (standard errors) of theprecision of its parameter estimates, including thosedescribing variability.&deg; NONMEM provides a means of deciding whether one model(e.g., that including weight&rsquo;s effect on CL and V) fitsthe data better than another using the minimumobjective function value, a goodness-of-fit statistic.&deg; NONMEM provides (limited) graphics, useful in judgingthe adequacy of the model currently fit to the data."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 3 -
Models for Individual Data</b></p>

<h2>1. What This Chapter is AboutIn this chapter, the notation and definitions we will use todiscuss models for individual data will be presented. Therelationship of these models to data will be discussed, anda distinction between pharmacokinetic structural models(that describe the underlying shape and form of the data)and statistical error models (that describe the &quot;errors&quot; ordifferences between observations and structural modelpredictions) will be made. Several error models will bediscussed, as will a useful modelling device, the indicatorvariable.2. Pharmacokinetic Structural Models for Individual DataBy individua__________ dat____ we usually mean data from a singleindividual (animal or human). One could also be concernedwith data comprised of a pharmacokinetic response at justone time point from each of a number of individuals. Callthis type of data single_______ respons________ populatio__________ data_____ Thisname comes from the fact that data such as these can, ofcourse, be regarded as a particular instance of the moregeneral data type, populatio__________ data_____ i.e., data comprised ofone or more pharmacokinetic responses at different timepoints from a number of individuals sampled from apopulation. Although one can discuss the treatment ofsingle-response population data as population data, they areoften treated just as are individual data.A simple pharmacokinetic model for data from a singleindividual is the monoexponential (&quot;one-compartment&quot;) model:This model describes the typical time course of amount ofdrug in the body ( ), as a function of initial dose ( ),time ( ), and a parameter, . As we may be interested inat several possible times, we explicitly note this by thesubscript which indexes a list of times,.A way to write a generic form for a structural model,omitting details of its structure, iswhere stands for some &quot;response&quot; (dependent variable) ofinterest ( in (3.1)), the symbol stands for theunspecified form of the model (a monoexponential such as in(3.1)), which is a function of known quantities, ( andin (3.1)), and parameters, ( in (3.1)). The quantitiesin x are known, because they are either measured orcontrolled, and therefore, are called fixe_____ effects________ incontrast to effects which are not known and are regarded asrandom (see below). The parameters in the parameter vectorare called fixe_____ effec______ parameter__________ because they quantifythe influence of the fixed effects on the dependentvariable. Each one of an individual&rsquo;s pharmacokineticparameters is a particular type of fixed effect parameter.With NONMEM, parameters comprising are (usually) fixedeffect parameters, but these may or may not be anindividual&rsquo;s pharmacokinetic parameters (contrast figures2.1 and 2.6). Here we shall use the symbol for theparameter vector comprised specifically of an individual&rsquo;spharmacokinetic parameters (although there will be someexception to this).Aside from the fact that the values given by a structuralmodel are usually not the values observed due to measurementerror or model misspecification, an amount of drug ( of(3.1)) is usually not itself observable. Instead, we mayobserve a concentration ( ) of drug. We need an&quot;observation scaling&quot; model to describe the relationshipbetween and . This might bewhere V is another parameter, Volume of Distribution. (Wedenote the concentration in model (3.3) by the symbol ,to distinguish it, the model-predicted value, from the actuallyobserved value,. This will soon be discussed further.) PREDPP assumes thatthere is always an observation scaling model like (3.3) that relates anamount of drug (in somecompartment of the body)to the observation, and therefore always expects aparameter, that scales (i.e. divides) the predicted amount in thecompartment. In the exampleabove, is simply . In other examples, to be discussed later,can be more complicated. If a value for is not specified, it is taken to be 1.For therest of this discussion, it is convenient to assume that itself includes ascaling parameter (if such is needed, and even though such a parameter is notusually regarded as one of an individual&rsquo;s pharmacokinetic parameters) and thatactually includes observational scaling.Note, considering the example of (3.3), that, and . Thusand of (3.1) are in general lists of things (vectors),not single things (scalars).PREDPP implements a number of pharmacokinetic models, suchas the one-compartment model (3.1), (3.3). These will bediscussed more fully in Chapter 7. There is no need forfurther general discussion of kinetic models, as we assumethe readers of this document are familiar withpharmacokinetics. However, two modelling features deservefurther comment, alternative parameterizations and thespecial parameter, .2.1. Alternative ParameterizationsRecall the phenobarbital example of Chapter 2. For thefirst run, the input contained, among other things, somelines of code defining the variables and , and then thelineK = CL/VThis line was needed because PREDPP expects theone-compartment model to be parameterized using theparameter , the rate constant of elimination, not clearanceand volume of distribution. However, we chose to estimatetypical population values for and , so we had to relatethese parameters to THETA and then relate to and .This is an example of reparametrization of a model so thatthe pharmacokinetic parameters used are those of primaryinterest to the modeler. In fact, we may use anyparameterization we wish, so long as we are willing toinclude the reparameterization line(s) that translate ourparameters into those expected by PREDPP. (Chapter 7discusses the parameters PREDPP expects for the variousmodels it implements.) However, there is a program calledTRANS which automatically does this translation. Differentversions of TRANS exist in the PREDPP Library and correspondto translations of different parameterizations into thatexpected by PREDPP.2.2. The Scale Parameter,Usually, observations are concentrations. So, as in model(3.3), will usually be set identical to . However, isnot always simply . Some examples should clarify thispoint. (In the discussion below, we avoid the notation ,and use , to refer to the scale term for the amount in thecompartment in which concentrations are being measured.)2.2.1. Depends on a Known ConstantThis almost trivial case occurs when one wishes to match theunits of predicted responses to those of the data. Forexample, suppose is in milligrams, but concentrations arein ng/ml. If no scaling is done, the units of will bekiloliters (i.e., =1 corresponds to =1000 liters). Toavoid this, one might choose the modelthereby converting the units of into micrograms, andsince mcg/L ng/ml, the units of become liters.Of course, one could recode one&rsquo;s data, dividing all concentrationsby 1000 (or multiplying the dose by 1000) and avoid this,but that may not be convenient.2.2.2. Depends on a ParameterLater in this chapter we will discuss a model used when thedata arise from two different assays (call them assay 1 andassay 2). In such a case, there may be a systematic(multiplicative) bias of one assay relative to the other.If we wish to allow for this possibility, we might need amodel such aswhere is a new parameter that measuresthe proportional bias of the assays (i.e., bias causes theapparent volume of distribution to be different for data fromthe two assays).The parameter is not really a pharmacokinetic parameter, butfor the purpose of this discussion it can be included in .2.2.3. Depends on an Element ofLater in this chapter we will describe a model useful whentwo kinds of responses are measured, plasma and urineconcentrations. In the case of urine concentrations, thepredicted total drug in the urine during a time period(available from an &quot;output&quot; compartment present in allmodels implemented by PREDPP; see Chapter 7) would have tobe scaled by the actual urine volume during that timeperiod. This volume would be an element of , and wouldbe set equal to it.3. Statistical Model for an Individual&rsquo;s ObservationsOne does not, in fact, ever observe the predicted plasmaconcentration (or any other predicted response). What oneobserves is a measured value which differs from thepredicted value by some (usually small) amount called aresidua________ erro_____ (also called intra-individual error). Weregard this error as a random quantity (see below). We willwant NONMEM to fit our model to our data, and in so doing,provide us with estimates of the model parameters. The wayNONMEM&rsquo;s fit follows the data is determined largely by whatwe tell it about the nature of the errors (see Chapter 5).We must therefore provide NONMEM with another model, anerror model.There are many reasons that the actual observation may notcorrespond to the predicted value (e.g. as given by theright side of (3.3)) The structural model may only beapproximate, or the quantities in may have been measuredwith error, or, as is always true, pharmacokinetic responsesmay be measured with some error (assay error). It is toodifficult to model all these sources of error separately, sowe usually make the simplifying assumption that eachdifference between an observation and its prediction (i.e.each error) is a randomly occurring number. When the dataare from a single individual, and the error model is theAdditive error model (see Section 3.1, below), the error isdenoted by herein, by ETA in NONMEM output, and by ETA orERR in NM-TRAN input. (When data are from a population, andthe same error model is used, this error will be denoted ;see Chapter 4.) Therefore a model for the jth observation,, could be writtenImplicit in using the symbol in this way is the assumptionthat all residual errors come from probability distributionswith mean zero and the same (usually unknown) variance.(The error variance is the mean squared error.) Morecomplicated error models involving can be written (seebelow). A schematic of model (3.4) is shown for thestructural model of (3.1), (3.3) in figure 3.1. Becausethis model describes the influence of both fixed effects( ) and random effects ( ), it is called a Mixe_____ Effect_______Mode_____ (hence the name, NONMEM: NONlinear Mixed EffectsModel). Mixed effects models, in general, may have morethan one random effect, and more than one type of randomeffect (Chapter 4); (3.4) is only a particularly simpleexample.Figure 3.1. vs for a monoexponential model. The solidline is ; the circles are the observed data points.An error is indicated.Even though errors are unpredictable random quantities, someinformation about them is usually assumed, and some can beestimated. First, it is assumed that the mean error iszero. This simply means that were the true values for theparameters in known, the model would have no systematicoverall bias (e.g., be systematically below or above thedata points, on average).A second aspect of the error, one that can be estimated byNONMEM, is its typical size. Since errors may be positiveor negative, their typical size is not given by their mean(which is zero), but by their standard deviation, the squareroot of their variance. One can always simply convert thevariance into the standard deviation, and conversely.NONMEM output gives estimates of the error variance. Withindividual data this variance is denoted in this text by ,and by OMEGA in NONMEM input and output. The standarddeviation (SD) of the error is denoted herein. The reasonthat OMEGA, rather than, for example, OMEGA SQ stands forin NONMEM input and output will be discussed in Section 3.8.(We will see, in Chapter 4, that when the error issymbolized by , not , its variance will be denoted inthis text, and SIGMA, not OMEGA, in NONMEM input andoutput.) Here, the parameter quantifies the influence ofthe random effect, on the observations, . It istherefore called a rando______ effect_______ parameter__________3.1. The Additive Error ModelThe symbol is always used to denote a random quantitywhose probability distribution has mean zero and variance. Model (3.4) says that the errors themselves can be soregarded, and since an observation equals its prediction(under the structural model) plus an error, model (3.4) iscalled the Additiv________ error model. This model is illustratedin figure 3.2.Figure 3.2. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for additive errors. Don&rsquo;t be fooled by theapparent widening of the gap between the upper and lowercurves as time increases: the vertical distance from themiddle line to either outer line is everywhere the same.3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsNONMEM allows an error model which can be more complicatedthan that of (3.4). One such more complicated, but usefulmodel is the Constan________ Coefficien___________ o__ Variatio_________ (CCV)______ orProportiona____________ error model,A fractional error is an error expressed as a fraction ofthe corresponding prediction. The CCV model says that afractional error can be written as an , i.e. as a randomquantity with mean zero and variance . Under this model,the variance of an error itself is proportional to thesquared prediction, with being the proportionalityfactor, and so is not constant over observations. Since,under this model, the standard deviation of the error, andalso of , is , and since the mean of is(when assumes its true value), the coefficient ofvariation of is just the constant (the coefficient ofvariation of a random quantity is defined as its standarddeviation divided by its mean). This is the reason the CCVerror model is so named. Also for this reason, isdimensionless, in contrast to having units equal to those ofthe squared observation as with the Additive model. Thiserror model is illustrated in figure 3.3.Figure 3.3. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for constant coefficient of variation errors.The exponentia___________ error model is &#9474;This model is sometimes referred to as the log-normal model, &#9474;because it it is additive if &#9474;logs are taken (and because eta sj is assumed to be normally distributed):&#9474;See Chapter 8, Section 3.2 for a discussion of this model.3.3. Combined Additive and CCV Error ModelWhen most observations obey the CCV model but someobservations may be near the lower limit of detection of anassay, a model which may be useful is one which is acombination of both the Additive and CCV error models:Here there are two types of &rsquo;s, and .The first has variance ; the secondhas a possibly different variance,. NONMEM permits several types of &rsquo;s.Under this model, the variance of the error portion of the model is.When the prediction is near zero, the variance is approximately constant,namely . This is the smallest variance possibleand corresponds, perhaps, to the limit of assay precision.When the prediction is considerably greater than zero, the variance isapproximately proportional to the squared prediction.3.4. The Power Function ModelA model that has both the additive and the CCV error modelsas special cases, and smoothly interpolates between them inother cases is the Power Function model:Here is raised to the power in the error model,rather than the power (Additive error model; notefor any number, ) or the first power (CCV model). Theparameter is a fixed effects parameter, even though itsrole in the overall model is to modify the variance model,not the structural model. With NONMEM all fixed effectparameters must be elements of the general parameter vector. If we want the Power Function Model to interpolatebetween the additive and CCV models, must be constrainedto lie between 0 and 1. NONMEM allows this (see Chapter 9).While one might be tempted to combine the Power Functionmodel with the Additive model, much as the CCV and Additivemodel were combined above, such a combination model can leadto identifiability difficulties, and for this reason such acombination should be avoided.3.5. Two Different Types of MeasurementsAnother more complicated error model can arise when morethan one type of measurement is made. Suppose, for sake ofillustration, that the observations are drug concentrations,but that they are measured with two different assays. Ifone assay may be more precise than the other, then this isequivalent to saying that one assay has a smaller thanthe other. We would like to be able to take this intoaccount in the analysis (i.e., not pay as much attention tothe less precise observations), and perhaps (if we haveenough data) estimate the relative precision of the assaysas well. To do this in the notation we have introduced, anindependent variable indicating which observations areobtained with which assay is needed: we call such anindependent variable an indicator variable.3.5.1. Use of an Indicator VariableLet one of the data items (an element of ) be labeled ,and let take the value 1 if the assay used for wasof the first type, and the value 0, if it was of the 2ndtype. The variable, is an indicator variable, and itallows us to write an additive type error model, say, asHere there are two types of &rsquo;s, and .The first applies to the firsttype of assay, and has variance ; the second appliesto the second type of assay, and has a possibly different variance,. NONMEM permits several types of &rsquo;s.Different types of &rsquo;s can be correlated, and NONMEM can allow this.However, this is something we wouldonly need to consider in the example at hand if the same blood sample weremeasured by both assays.We will not emphasize this possibility in this introductory guide.(This possibility also applies to random variables describingunexplained interindividual differences with population data; see Chapter 4)When the assay is done by the first method, will beunity, and (3.8) becomesso that the variance of the error is .When the assay is done by the second method, will be zero, and(3.7) becomesso that the variance of the error is now .Both and are random effect parameters.An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.6. Two Different Types of ObservationsThe same need for separate scales for different measurementscan arise when more than one type of observation is made.Suppose both plasma concentrations ( ) and urineconcentrations ( ) are measured. The structural model formight be (3.1), (3.3). If we assume that urine iscollected between each observation of , then the structuralmodel for , the drug concentration in the urine collectedbetween time and time might bewhere is the fraction of drug excreted unchanged (aparameter), and is the urine volume collected betweentime and (a data item)&dagger;.<cite>&dagger; With all PREDPP pharmacokinetic models there is an outputcompartment for which the total amount of drug leaving thesystem is computed automatically. The concentration in theurine is then obtained by setting the scaling parameter forthe output compartment to . </cite>Assuming again, for sake of the example, that we want to usean additive type error model for the observations, theproblem is that urine concentrations can be orders ofmagnitude larger than plasma concentrations, so that, whilean additive error model might be appropriate for either typeof observation alone, the two types of observations musthave different typical error magnitudes; i.e., differentvariances ( &rsquo;s).An indicator variable can again be used. Let the indicatorvariable be unity if the observation is a , and 0if it is a . We now need to use it for both thestructural and error models, so that:A little thought shows that the indicator variable selectsthe correct prediction ( or ) and the correct error termfor each observation ( ).An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.7. More Than One Indicator VariableOf course, there could be three types of assays, or more,and similarly, more than two types of observations. Oneusually needs one less indicator variable than types ofthings to be distinguished. So, if there were three assays,one would define and . would be 1 if theassay were of the first type, and zero otherwise; wouldbe 1 if the assay were of the second type, and zerootherwise. The error model for the data would require threetypes of &rsquo;s, , , and .Equation (3.11) results in the following:An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.8. The General Mixed Effects Model for an IndividualWe have just seen examples of more complicated error modelsthan the simple Additive model. We here give a mathematicalform for the most general mixed effects model that isconsidered within the scope of this document:where is a vector valued function of and parameters(where the latter is interpreted broadly to contain parameterssuch as of (3.7)), andis a vector of different different types.The notation denotes vectortranspose. When there is more than one type, there willbe several &rsquo;s, one for each type. The collection of theseis denoted and is labeled OMEGA in NONMEM input and output.This collection is regarded as a diagonal matrix (diagonal for now;but see Chapter 4), rather than as a vector. We will use thesymbol and interchangeably in thistext to denote the (diagonal) element of this matrix foundin position .
<a name="1. What This Chapter is AboutIn this chapter, the notation and definitions we will use todiscuss models for individual data will be presented. Therelationship of these models to data will be discussed, anda distinction between pharmacokinetic structural models(that describe the underlying shape and form of the data)and statistical error models (that describe the &quot;errors&quot; ordifferences between observations and structural modelpredictions) will be made. Several error models will bediscussed, as will a useful modelling device, the indicatorvariable.2. Pharmacokinetic Structural Models for Individual DataBy individua__________ dat____ we usually mean data from a singleindividual (animal or human). One could also be concernedwith data comprised of a pharmacokinetic response at justone time point from each of a number of individuals. Callthis type of data single_______ respons________ populatio__________ data_____ Thisname comes from the fact that data such as these can, ofcourse, be regarded as a particular instance of the moregeneral data type, populatio__________ data_____ i.e., data comprised ofone or more pharmacokinetic responses at different timepoints from a number of individuals sampled from apopulation. Although one can discuss the treatment ofsingle-response population data as population data, they areoften treated just as are individual data.A simple pharmacokinetic model for data from a singleindividual is the monoexponential (&quot;one-compartment&quot;) model:This model describes the typical time course of amount ofdrug in the body ( ), as a function of initial dose ( ),time ( ), and a parameter, . As we may be interested inat several possible times, we explicitly note this by thesubscript which indexes a list of times,.A way to write a generic form for a structural model,omitting details of its structure, iswhere stands for some &quot;response&quot; (dependent variable) ofinterest ( in (3.1)), the symbol stands for theunspecified form of the model (a monoexponential such as in(3.1)), which is a function of known quantities, ( andin (3.1)), and parameters, ( in (3.1)). The quantitiesin x are known, because they are either measured orcontrolled, and therefore, are called fixe_____ effects________ incontrast to effects which are not known and are regarded asrandom (see below). The parameters in the parameter vectorare called fixe_____ effec______ parameter__________ because they quantifythe influence of the fixed effects on the dependentvariable. Each one of an individual&rsquo;s pharmacokineticparameters is a particular type of fixed effect parameter.With NONMEM, parameters comprising are (usually) fixedeffect parameters, but these may or may not be anindividual&rsquo;s pharmacokinetic parameters (contrast figures2.1 and 2.6). Here we shall use the symbol for theparameter vector comprised specifically of an individual&rsquo;spharmacokinetic parameters (although there will be someexception to this).Aside from the fact that the values given by a structuralmodel are usually not the values observed due to measurementerror or model misspecification, an amount of drug ( of(3.1)) is usually not itself observable. Instead, we mayobserve a concentration ( ) of drug. We need an&quot;observation scaling&quot; model to describe the relationshipbetween and . This might bewhere V is another parameter, Volume of Distribution. (Wedenote the concentration in model (3.3) by the symbol ,to distinguish it, the model-predicted value, from the actuallyobserved value,. This will soon be discussed further.) PREDPP assumes thatthere is always an observation scaling model like (3.3) that relates anamount of drug (in somecompartment of the body)to the observation, and therefore always expects aparameter, that scales (i.e. divides) the predicted amount in thecompartment. In the exampleabove, is simply . In other examples, to be discussed later,can be more complicated. If a value for is not specified, it is taken to be 1.For therest of this discussion, it is convenient to assume that itself includes ascaling parameter (if such is needed, and even though such a parameter is notusually regarded as one of an individual&rsquo;s pharmacokinetic parameters) and thatactually includes observational scaling.Note, considering the example of (3.3), that, and . Thusand of (3.1) are in general lists of things (vectors),not single things (scalars).PREDPP implements a number of pharmacokinetic models, suchas the one-compartment model (3.1), (3.3). These will bediscussed more fully in Chapter 7. There is no need forfurther general discussion of kinetic models, as we assumethe readers of this document are familiar withpharmacokinetics. However, two modelling features deservefurther comment, alternative parameterizations and thespecial parameter, .2.1. Alternative ParameterizationsRecall the phenobarbital example of Chapter 2. For thefirst run, the input contained, among other things, somelines of code defining the variables and , and then thelineK = CL/VThis line was needed because PREDPP expects theone-compartment model to be parameterized using theparameter , the rate constant of elimination, not clearanceand volume of distribution. However, we chose to estimatetypical population values for and , so we had to relatethese parameters to THETA and then relate to and .This is an example of reparametrization of a model so thatthe pharmacokinetic parameters used are those of primaryinterest to the modeler. In fact, we may use anyparameterization we wish, so long as we are willing toinclude the reparameterization line(s) that translate ourparameters into those expected by PREDPP. (Chapter 7discusses the parameters PREDPP expects for the variousmodels it implements.) However, there is a program calledTRANS which automatically does this translation. Differentversions of TRANS exist in the PREDPP Library and correspondto translations of different parameterizations into thatexpected by PREDPP.2.2. The Scale Parameter,Usually, observations are concentrations. So, as in model(3.3), will usually be set identical to . However, isnot always simply . Some examples should clarify thispoint. (In the discussion below, we avoid the notation ,and use , to refer to the scale term for the amount in thecompartment in which concentrations are being measured.)2.2.1. Depends on a Known ConstantThis almost trivial case occurs when one wishes to match theunits of predicted responses to those of the data. Forexample, suppose is in milligrams, but concentrations arein ng/ml. If no scaling is done, the units of will bekiloliters (i.e., =1 corresponds to =1000 liters). Toavoid this, one might choose the modelthereby converting the units of into micrograms, andsince mcg/L ng/ml, the units of become liters.Of course, one could recode one&rsquo;s data, dividing all concentrationsby 1000 (or multiplying the dose by 1000) and avoid this,but that may not be convenient.2.2.2. Depends on a ParameterLater in this chapter we will discuss a model used when thedata arise from two different assays (call them assay 1 andassay 2). In such a case, there may be a systematic(multiplicative) bias of one assay relative to the other.If we wish to allow for this possibility, we might need amodel such aswhere is a new parameter that measuresthe proportional bias of the assays (i.e., bias causes theapparent volume of distribution to be different for data fromthe two assays).The parameter is not really a pharmacokinetic parameter, butfor the purpose of this discussion it can be included in .2.2.3. Depends on an Element ofLater in this chapter we will describe a model useful whentwo kinds of responses are measured, plasma and urineconcentrations. In the case of urine concentrations, thepredicted total drug in the urine during a time period(available from an &quot;output&quot; compartment present in allmodels implemented by PREDPP; see Chapter 7) would have tobe scaled by the actual urine volume during that timeperiod. This volume would be an element of , and wouldbe set equal to it.3. Statistical Model for an Individual&rsquo;s ObservationsOne does not, in fact, ever observe the predicted plasmaconcentration (or any other predicted response). What oneobserves is a measured value which differs from thepredicted value by some (usually small) amount called aresidua________ erro_____ (also called intra-individual error). Weregard this error as a random quantity (see below). We willwant NONMEM to fit our model to our data, and in so doing,provide us with estimates of the model parameters. The wayNONMEM&rsquo;s fit follows the data is determined largely by whatwe tell it about the nature of the errors (see Chapter 5).We must therefore provide NONMEM with another model, anerror model.There are many reasons that the actual observation may notcorrespond to the predicted value (e.g. as given by theright side of (3.3)) The structural model may only beapproximate, or the quantities in may have been measuredwith error, or, as is always true, pharmacokinetic responsesmay be measured with some error (assay error). It is toodifficult to model all these sources of error separately, sowe usually make the simplifying assumption that eachdifference between an observation and its prediction (i.e.each error) is a randomly occurring number. When the dataare from a single individual, and the error model is theAdditive error model (see Section 3.1, below), the error isdenoted by herein, by ETA in NONMEM output, and by ETA orERR in NM-TRAN input. (When data are from a population, andthe same error model is used, this error will be denoted ;see Chapter 4.) Therefore a model for the jth observation,, could be writtenImplicit in using the symbol in this way is the assumptionthat all residual errors come from probability distributionswith mean zero and the same (usually unknown) variance.(The error variance is the mean squared error.) Morecomplicated error models involving can be written (seebelow). A schematic of model (3.4) is shown for thestructural model of (3.1), (3.3) in figure 3.1. Becausethis model describes the influence of both fixed effects( ) and random effects ( ), it is called a Mixe_____ Effect_______Mode_____ (hence the name, NONMEM: NONlinear Mixed EffectsModel). Mixed effects models, in general, may have morethan one random effect, and more than one type of randomeffect (Chapter 4); (3.4) is only a particularly simpleexample.Figure 3.1. vs for a monoexponential model. The solidline is ; the circles are the observed data points.An error is indicated.Even though errors are unpredictable random quantities, someinformation about them is usually assumed, and some can beestimated. First, it is assumed that the mean error iszero. This simply means that were the true values for theparameters in known, the model would have no systematicoverall bias (e.g., be systematically below or above thedata points, on average).A second aspect of the error, one that can be estimated byNONMEM, is its typical size. Since errors may be positiveor negative, their typical size is not given by their mean(which is zero), but by their standard deviation, the squareroot of their variance. One can always simply convert thevariance into the standard deviation, and conversely.NONMEM output gives estimates of the error variance. Withindividual data this variance is denoted in this text by ,and by OMEGA in NONMEM input and output. The standarddeviation (SD) of the error is denoted herein. The reasonthat OMEGA, rather than, for example, OMEGA SQ stands forin NONMEM input and output will be discussed in Section 3.8.(We will see, in Chapter 4, that when the error issymbolized by , not , its variance will be denoted inthis text, and SIGMA, not OMEGA, in NONMEM input andoutput.) Here, the parameter quantifies the influence ofthe random effect, on the observations, . It istherefore called a rando______ effect_______ parameter__________3.1. The Additive Error ModelThe symbol is always used to denote a random quantitywhose probability distribution has mean zero and variance. Model (3.4) says that the errors themselves can be soregarded, and since an observation equals its prediction(under the structural model) plus an error, model (3.4) iscalled the Additiv________ error model. This model is illustratedin figure 3.2.Figure 3.2. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for additive errors. Don&rsquo;t be fooled by theapparent widening of the gap between the upper and lowercurves as time increases: the vertical distance from themiddle line to either outer line is everywhere the same.3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsNONMEM allows an error model which can be more complicatedthan that of (3.4). One such more complicated, but usefulmodel is the Constan________ Coefficien___________ o__ Variatio_________ (CCV)______ orProportiona____________ error model,A fractional error is an error expressed as a fraction ofthe corresponding prediction. The CCV model says that afractional error can be written as an , i.e. as a randomquantity with mean zero and variance . Under this model,the variance of an error itself is proportional to thesquared prediction, with being the proportionalityfactor, and so is not constant over observations. Since,under this model, the standard deviation of the error, andalso of , is , and since the mean of is(when assumes its true value), the coefficient ofvariation of is just the constant (the coefficient ofvariation of a random quantity is defined as its standarddeviation divided by its mean). This is the reason the CCVerror model is so named. Also for this reason, isdimensionless, in contrast to having units equal to those ofthe squared observation as with the Additive model. Thiserror model is illustrated in figure 3.3.Figure 3.3. vs for a monoexponential model. The middleline is ; the outer lines give the approximate&quot;envelope&quot; for constant coefficient of variation errors.The exponentia___________ error model is &#9474;This model is sometimes referred to as the log-normal model, &#9474;because it it is additive if &#9474;logs are taken (and because eta sj is assumed to be normally distributed):&#9474;See Chapter 8, Section 3.2 for a discussion of this model.3.3. Combined Additive and CCV Error ModelWhen most observations obey the CCV model but someobservations may be near the lower limit of detection of anassay, a model which may be useful is one which is acombination of both the Additive and CCV error models:Here there are two types of &rsquo;s, and .The first has variance ; the secondhas a possibly different variance,. NONMEM permits several types of &rsquo;s.Under this model, the variance of the error portion of the model is.When the prediction is near zero, the variance is approximately constant,namely . This is the smallest variance possibleand corresponds, perhaps, to the limit of assay precision.When the prediction is considerably greater than zero, the variance isapproximately proportional to the squared prediction.3.4. The Power Function ModelA model that has both the additive and the CCV error modelsas special cases, and smoothly interpolates between them inother cases is the Power Function model:Here is raised to the power in the error model,rather than the power (Additive error model; notefor any number, ) or the first power (CCV model). Theparameter is a fixed effects parameter, even though itsrole in the overall model is to modify the variance model,not the structural model. With NONMEM all fixed effectparameters must be elements of the general parameter vector. If we want the Power Function Model to interpolatebetween the additive and CCV models, must be constrainedto lie between 0 and 1. NONMEM allows this (see Chapter 9).While one might be tempted to combine the Power Functionmodel with the Additive model, much as the CCV and Additivemodel were combined above, such a combination model can leadto identifiability difficulties, and for this reason such acombination should be avoided.3.5. Two Different Types of MeasurementsAnother more complicated error model can arise when morethan one type of measurement is made. Suppose, for sake ofillustration, that the observations are drug concentrations,but that they are measured with two different assays. Ifone assay may be more precise than the other, then this isequivalent to saying that one assay has a smaller thanthe other. We would like to be able to take this intoaccount in the analysis (i.e., not pay as much attention tothe less precise observations), and perhaps (if we haveenough data) estimate the relative precision of the assaysas well. To do this in the notation we have introduced, anindependent variable indicating which observations areobtained with which assay is needed: we call such anindependent variable an indicator variable.3.5.1. Use of an Indicator VariableLet one of the data items (an element of ) be labeled ,and let take the value 1 if the assay used for wasof the first type, and the value 0, if it was of the 2ndtype. The variable, is an indicator variable, and itallows us to write an additive type error model, say, asHere there are two types of &rsquo;s, and .The first applies to the firsttype of assay, and has variance ; the second appliesto the second type of assay, and has a possibly different variance,. NONMEM permits several types of &rsquo;s.Different types of &rsquo;s can be correlated, and NONMEM can allow this.However, this is something we wouldonly need to consider in the example at hand if the same blood sample weremeasured by both assays.We will not emphasize this possibility in this introductory guide.(This possibility also applies to random variables describingunexplained interindividual differences with population data; see Chapter 4)When the assay is done by the first method, will beunity, and (3.8) becomesso that the variance of the error is .When the assay is done by the second method, will be zero, and(3.7) becomesso that the variance of the error is now .Both and are random effect parameters.An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.6. Two Different Types of ObservationsThe same need for separate scales for different measurementscan arise when more than one type of observation is made.Suppose both plasma concentrations ( ) and urineconcentrations ( ) are measured. The structural model formight be (3.1), (3.3). If we assume that urine iscollected between each observation of , then the structuralmodel for , the drug concentration in the urine collectedbetween time and time might bewhere is the fraction of drug excreted unchanged (aparameter), and is the urine volume collected betweentime and (a data item)&dagger;.<cite>&dagger; With all PREDPP pharmacokinetic models there is an outputcompartment for which the total amount of drug leaving thesystem is computed automatically. The concentration in theurine is then obtained by setting the scaling parameter forthe output compartment to . </cite>Assuming again, for sake of the example, that we want to usean additive type error model for the observations, theproblem is that urine concentrations can be orders ofmagnitude larger than plasma concentrations, so that, whilean additive error model might be appropriate for either typeof observation alone, the two types of observations musthave different typical error magnitudes; i.e., differentvariances ( &rsquo;s).An indicator variable can again be used. Let the indicatorvariable be unity if the observation is a , and 0if it is a . We now need to use it for both thestructural and error models, so that:A little thought shows that the indicator variable selectsthe correct prediction ( or ) and the correct error termfor each observation ( ).An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.7. More Than One Indicator VariableOf course, there could be three types of assays, or more,and similarly, more than two types of observations. Oneusually needs one less indicator variable than types ofthings to be distinguished. So, if there were three assays,one would define and . would be 1 if theassay were of the first type, and zero otherwise; wouldbe 1 if the assay were of the second type, and zerootherwise. The error model for the data would require threetypes of &rsquo;s, , , and .Equation (3.11) results in the following:An equivalent form of the model that can be implemented &#9474;easily is &#9474;&#9474;3.8. The General Mixed Effects Model for an IndividualWe have just seen examples of more complicated error modelsthan the simple Additive model. We here give a mathematicalform for the most general mixed effects model that isconsidered within the scope of this document:where is a vector valued function of and parameters(where the latter is interpreted broadly to contain parameterssuch as of (3.7)), andis a vector of different different types.The notation denotes vectortranspose. When there is more than one type, there willbe several &rsquo;s, one for each type. The collection of theseis denoted and is labeled OMEGA in NONMEM input and output.This collection is regarded as a diagonal matrix (diagonal for now;but see Chapter 4), rather than as a vector. We will use thesymbol and interchangeably in thistext to denote the (diagonal) element of this matrix foundin position ."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 4 -
Models for Population Data</b></p>

<h2>1. What This Chapter is AboutIn this chapter, models for data from (animal or human)populations will be discussed. These models describeobservations from a number of individuals sampled from thepopulation. The distinguishing feature of the data to whichsuch models apply is that there is more than one observationfrom some (usually most) individuals. A population modelincludes the structural model of Chapter 3, but also a newmodel, which shall be called the paramete_________ model______ for eachindividual&rsquo;s kinetic parameters. The parameter model canhave both fixed and random effects. A population model alsoincludes the error model of Chapter 3.2. GeneralIndividuals differ, and the types, degrees and causes ofthese differences are often what we want to learn. NONMEMwas designed to help us learn these things. Theseindividual differences can be due to fixed and/or randomeffects, but they all manifest themselves by affecting thevalue of an individual&rsquo;s parameters, . That is, first,each individual is regarded as having his own particularvalue of . If the data come from individuals,then we may rewrite the (not completely) general mixedeffects model, (3.4) for , the observation from theindividual, asEq (4.1) is now (part of) a population model because itexplicitly recognizes, through the subscript, , that thedata come from distinct individuals. Note too that we havewritten , rather than . According to NONMEM conventions,when modeling data from a population, the random effects inthe residual errors are denoted by , their individualvariances by , and the collection of the variances by thematrix , denoted SIGMA in NONMEM input and output. We alsoadopt the same convention here as we did for : thediagonal element of is interchangeably denoted or .When dealing with population data, the symbol is reservedfor random effects influencing the vectors , as is nowexplained. We can write a general model (but not yet asgeneral a model as we will present later) for :It is called the paramete_________ model______ Here, is a structural(though non-kinetic) type model (of which examples will begiven shortly), which is a function of fixed effects, ,and fixed effects parameters, . Note that since, ingeneral, is a vector, must be a vector-valued function,and for the same reason, is usually a vector. This willbe discussed further later. All fixed effects, whether theyare part of the kinetic structural model, or are part of theparameter model, are input to NONMEM in a uniform way. Forthe purposes of this discussion, the symbol is used forthe particular fixed effects in , such as the individual&rsquo;sheight, weight, and so forth (this will be discussed furtherin a moment). Even though most often is regarded as timeinvariant, as is done in most of the discussion in thisdocument, fixed effects can change with time, and thuskinetic parameters within can change with time. This willbe discussed further in Section 3.4.2.3. Structural Parameter ModelsThe symbol in (4.2) for the fixed effects parameter vectoris , not . As mentioned in Chapter 3, we reserve thesymbol , in this document, for an individual&rsquo;s fixed effectparameters and use the symbol for a vector of population(fixed effects and possibly random effects) parameters.Recall the phenobarbital example of Chapter 2. For thesecond run, the input contained the line of codeTVCL = THETA(1) + THETA(3)*WTTranslated into the symbols we are using here, this isIn (4.3), and are the first and third elements of theparameter vector , and is an element of (recall thatthis value of weight appears as a data item). The tildeover is meant to distinguish this typical populationvalue of clearance from the individual&rsquo;s actual value ofclearance. According to this model, will be the samefor any two individuals both of whom have the same value ofweight. Equation (4.3) defines an element (the oneassociated with clearance) of the vector-valued function .Note that in (4.3), we use the subscript to stress thatthis equation applies to the individual, but there is noconfusion when, as in the NM-TRAN input, and in thefollowing, the subscript is omitted. It should always beunderstood that all variables and data items used in theparameter model definition refer to the same individual.Many different models are possible to describe thedependence of individual parameters on fixed effects.However, certain model forms are simple, easy to use, andcover most cases. An assortment of these will be discussedbriefly next.3.1. Linear ModelsThe simplest form that can take, and the most common, isone that is linear in . An example is (4.3): all elementsof appear as linear coefficients of terms involving dataitems. The data items themselves can appear nonlinearly,without affecting the linearity with respect to . Forexample, if clearance is the sum of renal and non-renalcomponents, and renal clearance is believed to beproportional to renal function as described according to astandard formula involving the elements of : age ( ),serum creatinine ( ), and weight ( ), then one mightwriteClearly, is a nonlinear function of , for example,and so, therefore, is , but is linear in , and (4.4 -4.6) is still considered a linear model. (Do not worry aboutthe non-consecutive numbering of the elements of ; a modelfor is being developed (an alternative to 4.3), and themissing elements and will appear presently.)3.2. Multiplicative ModelsMultiplicative models are linear models, but on alogarithmic scale. For example, if patients covering a verywide range of weights are studied, metabolic clearance mightvary with weight, but not linearly, and a substitute for(4.4) might beNote that the logarithm of ( ) is linear in ,but itself is not. Of course, (4.4.1) can also bewrittenModels (4.4.1) and (4.4.2) are equivalent so far as isconcerned, but of (4.4.2) corresponds to of(4.4.1).3.3. Saturation ModelsA useful model for processes reaching a maximum is ahyperbolic model. For example, if a second drug, (whosesteady-state plasma concentration, is known andavailable in the data set), is present in some individualsand it is believed that this second drug is an inhibitor ofthe metabolism of the study drug, one might wish to useThis model is shown in figure 4.1. The inhibition isexpressed by the ratio occurring within the brackets and isa concave hyperbola, asymptoting to a maximum value equal to. It is identical in form to the familiarMichaelis-Menten model.Figure 4.1. A hyperbolic model for metabolic clearance ofdrug on the ordinate, as inhibited by another drug atsteady-state concentration on the abscissa.3.4. Models with Indicator VariablesIndicator variables were discussed in Chapter 3 inconnection with the error model. They can be quite usefulwhen modelling individual parameters. They are usually usedin a linear model. For example, if the clinical condition,heart failure, is noted as &quot;present&quot; or &quot;absent&quot;, one candefine an indicator variable, which equals 0 if heartfailure is absent, and 1 if it is present. If metabolicclearance is thought to be affected by heart failure, onemight chooseHere, the non-heart-failure cases will have , while the heart-failure cases will have &dagger;.<cite>&dagger; Heart failure is expected to decrease metabolicclearance. If it does, using a minus sign in (4.4.4) allows themore pleasing result that will be estimatedas positive. The model is identical to one with a positive sign,but then would probably be negative.If were constrained to be non-negative,then the sign chosen in the model statement would, of course, beimportant.</cite>3.4.1. CombinationsGiven the basic building blocks of linear, multiplicativeand saturation models, these can be combined in the usualalgebraic ways (usually by addition) to make more complexmodels. For example, one could use (4.4.3), (4.5), and(4.6) as a model for . A non-additive example arises ifplasma and urine concentrations are both observed and(kinetic) model (3.6) is to be used for the latter. Theparameter , the fraction of drug excreted unchanged intothe urine might be modeled aswhere is given by (4.5) and by(4.6) (using any of the (4.4) variants).3.4.2. Time VaryingAs mentioned in Section 2, although most of the time thedata items affecting an individual&rsquo;s do not change overthe course of his data, they occasionally do, and PREDPP canhandle this. For example, if an individual had heartfailure for part of his observation period, but not therest, , according to (4.4.4) should change. Or, ifacute renal failure occurred during a patient&rsquo;s observationperiod, would change, according to model (4.5).PREDPP implements its kinetic model recursively: given thestate of the system at time (by state we mean the amountsof drug in all the compartments), it updates (i.e. advances)the state to that at time , using the value of (and ingeneral, the value of ) at time to compute a value ofholding between times and . The value of used tocompute this is that value found on the data record withtime . So, in order to have change appropriately asdoes, one places a value of which is typical for the timeperiod to on the data record associated with thetime point . This will not always be easy since therelevant element(s) of may not be measured at, forexample, the midpoint of the time interval (the value at theof the time interval is a good choice for thevalue for the interval). If not, one will have touse some interpolation method to arrive at the typicalvalue. The important point is that the values of theindependent variables at time determine the values ofthe individual&rsquo;s parameters applying to the entire periodto .3.5. Structural Kinetic ModelsThe kinetic models (i.e., the models for responses such asdrug concentrations) used when performing a populationanalysis do not differ at all from those used for anindividual analysis. One still needs a model for therelationship of to and , and this relationship does notdepend on whether changes from individual to individual orwith time within an individual.4. Population Random Effects ModelsUnder NONMEM conventions, there are two levels of randomeffects, and and are the symbols used for the vectors offirst and second level random effects, respectively. Withdata from a single individual, only first-level randomeffects are needed. However, with data from a population ofindividuals, both first- and second-level random effects areneeded. First-level effects are needed in the parametermodel to help model unexplainable interindividualdifferences in , and second-level effects are needed in the(intraindividual) error model. For example, in (4.2) thereis an element of , , that is the difference between theindividual value (an element of ) and , the typicalvalue of . This is a first-level random effect. In (4.1)is the error between and . This is asecond-level random effect.4.1. Models for Interindividual ErrorsThe difference between and is called aninterindividua_______________ error______ It arises from a few sources: thefunction may be only approximate, and/or may be measuredwith error. It is regarded as a random quantity, and it maybe modeled in terms of variables. As usual, each of thesevariables is assumed to have mean 0 and a variance denotedby which may be estimated. This variance describesbiological population variability.The difference between and is called anintraindividua_______________ error______ It has been discussed at some lengthin Chapter 3. Although in that discussion about individualdata, this difference was modeled in terms of variables,in this discussion about population data, it is modeled interms of variables. Each variable is assumed to havemean 0 and a variance denoted by which also may beestimated.Each pair of elements in has a covariance, and NONMEM canalso estimate this, although often we choose to assume thatthe covariance is zero (we made this same assumption for the &#9474;different elements of in Chapter 3, Section 3.5.1).A covariance between two elements of , and , say, is ameasure of statistical association between these two randomvariables. Their covariance is related to theircorrelation, ( ) by(Note that now that we are suppressingthe subscript on, we may, without confusion, use the subscript positionto designate elements of .)The variances and covariances among the elements of arelaid out in a covarianc__________ matrix_______ called , and labeled OMEGAin NONMEM input and output. This matrix was defined in &#9474;Chapter 3, Section 3.8, but some additional comment here may &#9474;be helpful. If has, for example, 3 elements, has thefollowing form:Here, as previously, is another way of writing thevariance , and ( ) is the covariance between and.The elements , , are called the diagona________ element________of the matrix. If the nondiagonal elements (thecovariances) are all zero, i.e. the correlation among allpairs of elements is zero, the matrix is called a diagonalmatrix. The lowe_____ triangula__________ element________ of the matrix are theelementsTo specify the matrix only its lower triangular elementsneed be given (and these are all NONMEM does give), sincefrom (4.8) it is clear that for all , . &#9474;4.1.1. Additive/Multiplicative Models and the Exponential &#9474;ModelFrequently, the model for an interindividual error is thesimple additive one (as in (4.2)), such asA feature of (4.9) is that the resulting units for dependon the units of the parameter ( in this case). Forexample, this model was used in the theophylline problem ofChapter 2 (Figure 2.6). The final estimate of is .286(Figure 2.8). Assuming that the units of V are liters, weinterpret this to mean that the standard deviation of Vbetween individuals is .53 Liters ( .53 = ).Perhaps even more often, a multiplicative model equivalentto the Constant Coefficient of Variation (CCV) error model(3.5) is used, such asThis model is also referred to as the proportional error &#9474;model.A feature of (4.10) is that the resulting units for areindependent of the units of the parameter ( in this case).When this model is used in the theophylline problem insteadof the additive model, so that Figure 2.6 contains the codeV=TVVD*(1+ETA(2)) instead of V=TVVD+ETA(2), then NONMEMestimates to be .146. We interpret this to mean that thecoefficient of variation of V in the population is 38% (.38= ).The exponential model is &#9474;During simulation, the exponential and proportional modelsgive different results. During estimation by thefirst-order method, the exponential model andproportional models give identical results, i.e., NONMEMcannot distinguish between them. During estimation by aconditional estimation method, the exponential andproportional models for inter-individual variability givedifferent results. The exponential model is preferred forconditional estimation methods. (See NONMEM User&rsquo;s GuidePart VII, Conditional Estimation Methods.)4.1.2. Other ModelsOccasionally, a model for an individual&rsquo;s pharmacokineticparameter might involve scaling an , as in (3.6), or two ormore &rsquo;s as in (3.10). For example, a study might involvepatients in the intensive care unit (ICU) and others onnon-acute care units. It might be reasonable to supposethat some aspects of the kinetics of ICU patients (e.g.,metabolic clearance of drug) are more variable, due tounmeasured factors (e.g., hepatic function) that varygreatly among acutely ill patients. Even though thevariation is, in reality, due to a potentially measurablefixed effect (hepatic function), if information on thisfixed effect is not available, differences caused by it mustbe assigned to random factors ( ). In this case, one mightwish to use an indicator variable, (which equals 1 ifthe patient is in the ICU, and 0, otherwise), and a modelsuch asIn addition to model (4.11) we might have, for example,Models (4.11) and (4.12) together, along with suitablemodels for and , form a complete model for anindividual&rsquo;s parameter, and involve 3 &rsquo;s.4.1.3. General Form for the Parameter ModelAs we have just seen in (4.10) and in (4.11)-(4.12), anelement of need not act in a simple additive way and mayact solely on an intermediate variable (e.g. ).Indeed, there may be more or fewer elements in than in ,the elements in may act in nonlinear ways to influence ,and one element of may influence more than a singleelement of . We now give a more general form for theparameter model than (4.2) and then an example illustratingit.The general form of the parameter model isHere, is a very general function of fixed effects, ,fixed effects parameters, , and a vector of &rsquo;s, . Thedimensions of the vectors and need not be the same.An individual&rsquo;s kinetic parameter may change with time. Asexplained in Section 1.6, with NONMEM-PREDPP changes canoccur only at discrete time points. Therefore, theparameter actually can be regarded as being a number ofparameters, each one applying to a different time period.The parameter in (4.13), being a vector of all thekinetic parameters for the individual, can be regardedas encompassing these time-interval-specific parameters.An example utilizing this generality is provided by a modelfor observations of both plasma and urine drugconcentrations, similar to the one presented previously.Ignoring the details of the structural part of the model,consider the following modelIn this model, ; the parameters andare regarded as intermediate parameters. We have, where both and influence both(linearly) and (nonlinearly).4.2. Statistical Models for an Individual&rsquo;s ObservationsModel (4.1) can be generalized by incorporating a model likethose given in Chapter 3 for the residual errors, i.e. forthe differences between the and , rather thanusing just the simple Additive model. A particular instanceof such a model may have several types of &rsquo;s, and asmentioned in Section 2, the variances of these &rsquo;s aredenoted by &rsquo;s. With a population model these variancescould change from individual to individual. With NONMEM,they are considered as constants over individuals. The &rsquo;scan co-vary. A covariance matrix , like the matrix givenin Section 4.1, gives the variances and covariances of the&rsquo;s, as already discussed at the end of Chapter 3. Thisdoes not preclude the magnitudes of the errors from beingaffected by fixed effects. A model such as (3.8) can stillbe used. This is shown explicitly by the general modelgiven in the next section.5. The Population Mixed Effects ModelWe have now presented all of the parts needed to fullydefine a population model. It may be useful to recap thisinformation by stating the entire general model here:, independent for, independent for, independent for all ,where here, is a vector, along with , , and ,and and are square matrices with dimensions equal tothose of and .To try to represent the relationship between all the fixedand random effects of a population model graphically,consider figure 4.2. The model corresponding to this figureiswhere the are all equal to a constant , i.e. there is norandom interindividual variability in the volume ofdistribution, so that for the sake of this example, isjust a scalar.Figure 4.2. Random and fixed effects influence observation,, from the population point of view. Open circle, lowerleft, is population parameter predicted clearance, closedcircle is true clearance for individual which differsfrom population prediction by , chosen randomly from adistribution (upper left) with mean 0 and SD .Similarly, lower right, the observed at time (opensquare) differs by from the true value (closed circle)by an error , chosen independently from a distributionwith mean 0 and SD . The corresponding to thepopulation-based prediction is also shown (upper curve, opencircle).
<a name="1. What This Chapter is AboutIn this chapter, models for data from (animal or human)populations will be discussed. These models describeobservations from a number of individuals sampled from thepopulation. The distinguishing feature of the data to whichsuch models apply is that there is more than one observationfrom some (usually most) individuals. A population modelincludes the structural model of Chapter 3, but also a newmodel, which shall be called the paramete_________ model______ for eachindividual&rsquo;s kinetic parameters. The parameter model canhave both fixed and random effects. A population model alsoincludes the error model of Chapter 3.2. GeneralIndividuals differ, and the types, degrees and causes ofthese differences are often what we want to learn. NONMEMwas designed to help us learn these things. Theseindividual differences can be due to fixed and/or randomeffects, but they all manifest themselves by affecting thevalue of an individual&rsquo;s parameters, . That is, first,each individual is regarded as having his own particularvalue of . If the data come from individuals,then we may rewrite the (not completely) general mixedeffects model, (3.4) for , the observation from theindividual, asEq (4.1) is now (part of) a population model because itexplicitly recognizes, through the subscript, , that thedata come from distinct individuals. Note too that we havewritten , rather than . According to NONMEM conventions,when modeling data from a population, the random effects inthe residual errors are denoted by , their individualvariances by , and the collection of the variances by thematrix , denoted SIGMA in NONMEM input and output. We alsoadopt the same convention here as we did for : thediagonal element of is interchangeably denoted or .When dealing with population data, the symbol is reservedfor random effects influencing the vectors , as is nowexplained. We can write a general model (but not yet asgeneral a model as we will present later) for :It is called the paramete_________ model______ Here, is a structural(though non-kinetic) type model (of which examples will begiven shortly), which is a function of fixed effects, ,and fixed effects parameters, . Note that since, ingeneral, is a vector, must be a vector-valued function,and for the same reason, is usually a vector. This willbe discussed further later. All fixed effects, whether theyare part of the kinetic structural model, or are part of theparameter model, are input to NONMEM in a uniform way. Forthe purposes of this discussion, the symbol is used forthe particular fixed effects in , such as the individual&rsquo;sheight, weight, and so forth (this will be discussed furtherin a moment). Even though most often is regarded as timeinvariant, as is done in most of the discussion in thisdocument, fixed effects can change with time, and thuskinetic parameters within can change with time. This willbe discussed further in Section 3.4.2.3. Structural Parameter ModelsThe symbol in (4.2) for the fixed effects parameter vectoris , not . As mentioned in Chapter 3, we reserve thesymbol , in this document, for an individual&rsquo;s fixed effectparameters and use the symbol for a vector of population(fixed effects and possibly random effects) parameters.Recall the phenobarbital example of Chapter 2. For thesecond run, the input contained the line of codeTVCL = THETA(1) + THETA(3)*WTTranslated into the symbols we are using here, this isIn (4.3), and are the first and third elements of theparameter vector , and is an element of (recall thatthis value of weight appears as a data item). The tildeover is meant to distinguish this typical populationvalue of clearance from the individual&rsquo;s actual value ofclearance. According to this model, will be the samefor any two individuals both of whom have the same value ofweight. Equation (4.3) defines an element (the oneassociated with clearance) of the vector-valued function .Note that in (4.3), we use the subscript to stress thatthis equation applies to the individual, but there is noconfusion when, as in the NM-TRAN input, and in thefollowing, the subscript is omitted. It should always beunderstood that all variables and data items used in theparameter model definition refer to the same individual.Many different models are possible to describe thedependence of individual parameters on fixed effects.However, certain model forms are simple, easy to use, andcover most cases. An assortment of these will be discussedbriefly next.3.1. Linear ModelsThe simplest form that can take, and the most common, isone that is linear in . An example is (4.3): all elementsof appear as linear coefficients of terms involving dataitems. The data items themselves can appear nonlinearly,without affecting the linearity with respect to . Forexample, if clearance is the sum of renal and non-renalcomponents, and renal clearance is believed to beproportional to renal function as described according to astandard formula involving the elements of : age ( ),serum creatinine ( ), and weight ( ), then one mightwriteClearly, is a nonlinear function of , for example,and so, therefore, is , but is linear in , and (4.4 -4.6) is still considered a linear model. (Do not worry aboutthe non-consecutive numbering of the elements of ; a modelfor is being developed (an alternative to 4.3), and themissing elements and will appear presently.)3.2. Multiplicative ModelsMultiplicative models are linear models, but on alogarithmic scale. For example, if patients covering a verywide range of weights are studied, metabolic clearance mightvary with weight, but not linearly, and a substitute for(4.4) might beNote that the logarithm of ( ) is linear in ,but itself is not. Of course, (4.4.1) can also bewrittenModels (4.4.1) and (4.4.2) are equivalent so far as isconcerned, but of (4.4.2) corresponds to of(4.4.1).3.3. Saturation ModelsA useful model for processes reaching a maximum is ahyperbolic model. For example, if a second drug, (whosesteady-state plasma concentration, is known andavailable in the data set), is present in some individualsand it is believed that this second drug is an inhibitor ofthe metabolism of the study drug, one might wish to useThis model is shown in figure 4.1. The inhibition isexpressed by the ratio occurring within the brackets and isa concave hyperbola, asymptoting to a maximum value equal to. It is identical in form to the familiarMichaelis-Menten model.Figure 4.1. A hyperbolic model for metabolic clearance ofdrug on the ordinate, as inhibited by another drug atsteady-state concentration on the abscissa.3.4. Models with Indicator VariablesIndicator variables were discussed in Chapter 3 inconnection with the error model. They can be quite usefulwhen modelling individual parameters. They are usually usedin a linear model. For example, if the clinical condition,heart failure, is noted as &quot;present&quot; or &quot;absent&quot;, one candefine an indicator variable, which equals 0 if heartfailure is absent, and 1 if it is present. If metabolicclearance is thought to be affected by heart failure, onemight chooseHere, the non-heart-failure cases will have , while the heart-failure cases will have &dagger;.<cite>&dagger; Heart failure is expected to decrease metabolicclearance. If it does, using a minus sign in (4.4.4) allows themore pleasing result that will be estimatedas positive. The model is identical to one with a positive sign,but then would probably be negative.If were constrained to be non-negative,then the sign chosen in the model statement would, of course, beimportant.</cite>3.4.1. CombinationsGiven the basic building blocks of linear, multiplicativeand saturation models, these can be combined in the usualalgebraic ways (usually by addition) to make more complexmodels. For example, one could use (4.4.3), (4.5), and(4.6) as a model for . A non-additive example arises ifplasma and urine concentrations are both observed and(kinetic) model (3.6) is to be used for the latter. Theparameter , the fraction of drug excreted unchanged intothe urine might be modeled aswhere is given by (4.5) and by(4.6) (using any of the (4.4) variants).3.4.2. Time VaryingAs mentioned in Section 2, although most of the time thedata items affecting an individual&rsquo;s do not change overthe course of his data, they occasionally do, and PREDPP canhandle this. For example, if an individual had heartfailure for part of his observation period, but not therest, , according to (4.4.4) should change. Or, ifacute renal failure occurred during a patient&rsquo;s observationperiod, would change, according to model (4.5).PREDPP implements its kinetic model recursively: given thestate of the system at time (by state we mean the amountsof drug in all the compartments), it updates (i.e. advances)the state to that at time , using the value of (and ingeneral, the value of ) at time to compute a value ofholding between times and . The value of used tocompute this is that value found on the data record withtime . So, in order to have change appropriately asdoes, one places a value of which is typical for the timeperiod to on the data record associated with thetime point . This will not always be easy since therelevant element(s) of may not be measured at, forexample, the midpoint of the time interval (the value at theof the time interval is a good choice for thevalue for the interval). If not, one will have touse some interpolation method to arrive at the typicalvalue. The important point is that the values of theindependent variables at time determine the values ofthe individual&rsquo;s parameters applying to the entire periodto .3.5. Structural Kinetic ModelsThe kinetic models (i.e., the models for responses such asdrug concentrations) used when performing a populationanalysis do not differ at all from those used for anindividual analysis. One still needs a model for therelationship of to and , and this relationship does notdepend on whether changes from individual to individual orwith time within an individual.4. Population Random Effects ModelsUnder NONMEM conventions, there are two levels of randomeffects, and and are the symbols used for the vectors offirst and second level random effects, respectively. Withdata from a single individual, only first-level randomeffects are needed. However, with data from a population ofindividuals, both first- and second-level random effects areneeded. First-level effects are needed in the parametermodel to help model unexplainable interindividualdifferences in , and second-level effects are needed in the(intraindividual) error model. For example, in (4.2) thereis an element of , , that is the difference between theindividual value (an element of ) and , the typicalvalue of . This is a first-level random effect. In (4.1)is the error between and . This is asecond-level random effect.4.1. Models for Interindividual ErrorsThe difference between and is called aninterindividua_______________ error______ It arises from a few sources: thefunction may be only approximate, and/or may be measuredwith error. It is regarded as a random quantity, and it maybe modeled in terms of variables. As usual, each of thesevariables is assumed to have mean 0 and a variance denotedby which may be estimated. This variance describesbiological population variability.The difference between and is called anintraindividua_______________ error______ It has been discussed at some lengthin Chapter 3. Although in that discussion about individualdata, this difference was modeled in terms of variables,in this discussion about population data, it is modeled interms of variables. Each variable is assumed to havemean 0 and a variance denoted by which also may beestimated.Each pair of elements in has a covariance, and NONMEM canalso estimate this, although often we choose to assume thatthe covariance is zero (we made this same assumption for the &#9474;different elements of in Chapter 3, Section 3.5.1).A covariance between two elements of , and , say, is ameasure of statistical association between these two randomvariables. Their covariance is related to theircorrelation, ( ) by(Note that now that we are suppressingthe subscript on, we may, without confusion, use the subscript positionto designate elements of .)The variances and covariances among the elements of arelaid out in a covarianc__________ matrix_______ called , and labeled OMEGAin NONMEM input and output. This matrix was defined in &#9474;Chapter 3, Section 3.8, but some additional comment here may &#9474;be helpful. If has, for example, 3 elements, has thefollowing form:Here, as previously, is another way of writing thevariance , and ( ) is the covariance between and.The elements , , are called the diagona________ element________of the matrix. If the nondiagonal elements (thecovariances) are all zero, i.e. the correlation among allpairs of elements is zero, the matrix is called a diagonalmatrix. The lowe_____ triangula__________ element________ of the matrix are theelementsTo specify the matrix only its lower triangular elementsneed be given (and these are all NONMEM does give), sincefrom (4.8) it is clear that for all , . &#9474;4.1.1. Additive/Multiplicative Models and the Exponential &#9474;ModelFrequently, the model for an interindividual error is thesimple additive one (as in (4.2)), such asA feature of (4.9) is that the resulting units for dependon the units of the parameter ( in this case). Forexample, this model was used in the theophylline problem ofChapter 2 (Figure 2.6). The final estimate of is .286(Figure 2.8). Assuming that the units of V are liters, weinterpret this to mean that the standard deviation of Vbetween individuals is .53 Liters ( .53 = ).Perhaps even more often, a multiplicative model equivalentto the Constant Coefficient of Variation (CCV) error model(3.5) is used, such asThis model is also referred to as the proportional error &#9474;model.A feature of (4.10) is that the resulting units for areindependent of the units of the parameter ( in this case).When this model is used in the theophylline problem insteadof the additive model, so that Figure 2.6 contains the codeV=TVVD*(1+ETA(2)) instead of V=TVVD+ETA(2), then NONMEMestimates to be .146. We interpret this to mean that thecoefficient of variation of V in the population is 38% (.38= ).The exponential model is &#9474;During simulation, the exponential and proportional modelsgive different results. During estimation by thefirst-order method, the exponential model andproportional models give identical results, i.e., NONMEMcannot distinguish between them. During estimation by aconditional estimation method, the exponential andproportional models for inter-individual variability givedifferent results. The exponential model is preferred forconditional estimation methods. (See NONMEM User&rsquo;s GuidePart VII, Conditional Estimation Methods.)4.1.2. Other ModelsOccasionally, a model for an individual&rsquo;s pharmacokineticparameter might involve scaling an , as in (3.6), or two ormore &rsquo;s as in (3.10). For example, a study might involvepatients in the intensive care unit (ICU) and others onnon-acute care units. It might be reasonable to supposethat some aspects of the kinetics of ICU patients (e.g.,metabolic clearance of drug) are more variable, due tounmeasured factors (e.g., hepatic function) that varygreatly among acutely ill patients. Even though thevariation is, in reality, due to a potentially measurablefixed effect (hepatic function), if information on thisfixed effect is not available, differences caused by it mustbe assigned to random factors ( ). In this case, one mightwish to use an indicator variable, (which equals 1 ifthe patient is in the ICU, and 0, otherwise), and a modelsuch asIn addition to model (4.11) we might have, for example,Models (4.11) and (4.12) together, along with suitablemodels for and , form a complete model for anindividual&rsquo;s parameter, and involve 3 &rsquo;s.4.1.3. General Form for the Parameter ModelAs we have just seen in (4.10) and in (4.11)-(4.12), anelement of need not act in a simple additive way and mayact solely on an intermediate variable (e.g. ).Indeed, there may be more or fewer elements in than in ,the elements in may act in nonlinear ways to influence ,and one element of may influence more than a singleelement of . We now give a more general form for theparameter model than (4.2) and then an example illustratingit.The general form of the parameter model isHere, is a very general function of fixed effects, ,fixed effects parameters, , and a vector of &rsquo;s, . Thedimensions of the vectors and need not be the same.An individual&rsquo;s kinetic parameter may change with time. Asexplained in Section 1.6, with NONMEM-PREDPP changes canoccur only at discrete time points. Therefore, theparameter actually can be regarded as being a number ofparameters, each one applying to a different time period.The parameter in (4.13), being a vector of all thekinetic parameters for the individual, can be regardedas encompassing these time-interval-specific parameters.An example utilizing this generality is provided by a modelfor observations of both plasma and urine drugconcentrations, similar to the one presented previously.Ignoring the details of the structural part of the model,consider the following modelIn this model, ; the parameters andare regarded as intermediate parameters. We have, where both and influence both(linearly) and (nonlinearly).4.2. Statistical Models for an Individual&rsquo;s ObservationsModel (4.1) can be generalized by incorporating a model likethose given in Chapter 3 for the residual errors, i.e. forthe differences between the and , rather thanusing just the simple Additive model. A particular instanceof such a model may have several types of &rsquo;s, and asmentioned in Section 2, the variances of these &rsquo;s aredenoted by &rsquo;s. With a population model these variancescould change from individual to individual. With NONMEM,they are considered as constants over individuals. The &rsquo;scan co-vary. A covariance matrix , like the matrix givenin Section 4.1, gives the variances and covariances of the&rsquo;s, as already discussed at the end of Chapter 3. Thisdoes not preclude the magnitudes of the errors from beingaffected by fixed effects. A model such as (3.8) can stillbe used. This is shown explicitly by the general modelgiven in the next section.5. The Population Mixed Effects ModelWe have now presented all of the parts needed to fullydefine a population model. It may be useful to recap thisinformation by stating the entire general model here:, independent for, independent for, independent for all ,where here, is a vector, along with , , and ,and and are square matrices with dimensions equal tothose of and .To try to represent the relationship between all the fixedand random effects of a population model graphically,consider figure 4.2. The model corresponding to this figureiswhere the are all equal to a constant , i.e. there is norandom interindividual variability in the volume ofdistribution, so that for the sake of this example, isjust a scalar.Figure 4.2. Random and fixed effects influence observation,, from the population point of view. Open circle, lowerleft, is population parameter predicted clearance, closedcircle is true clearance for individual which differsfrom population prediction by , chosen randomly from adistribution (upper left) with mean 0 and SD .Similarly, lower right, the observed at time (opensquare) differs by from the true value (closed circle)by an error , chosen independently from a distributionwith mean 0 and SD . The corresponding to thepopulation-based prediction is also shown (upper curve, opencircle)."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 5 -
Estimates, Confidence Intervals, and Hypothesis
Tests</b></p>

<h2>1. What This Chapter is AboutIn this chapter, we discuss the fitting criterion thatNONMEM uses, parameter estimates, and standard errorestimates. We then discuss how to form confidence intervalsfor parameters and do hypothesis tests with NONMEM.2. Model Fitting CriterionIn principle, all fitting procedures attempt to adjust thevalues of the parameters of the model to give a &quot;best fit&quot;of the predictions to the actual observations. The set ofparameters that accomplish this are called the parameterestimates, and are denoted here as , , and . Methodsdiffer in how they define &quot;best&quot;. The criterion that NONMEMuses is a Least Squares (LS) type criterion. The form ofthis criterion varies as the error model varies, and aspopulation models with multiple random effects must beconsidered. We briefly discuss these various criteria next,to give the reader a feel for what NONMEM is doing. Adetailed knowledge of the statistical basis for the choiceof fitting criterion is not necessary either to use orinterpret NONMEM fits. In this chapter, a fixed effectsparameter will be denoted by a ; the distinction betweenindividual fixed effects parameters ( ) and population fixedeffects parameters will not be important here.2.1. Least Squares for Individual Data with an AdditiveError ModelFor the Additive error model (3.4), the Ordinary LeastSquares criterion (OLS) chooses the estimate so as to makethe sum of squared (estimated) errors as small as possible.These estimates cause the prediction, here denoted , to bean estimate of the mean value of , which is intuitivelyappealing. The prediction is obtained by computing thevalue for y under the model with parameters set to theirestimated values and set to zero&dagger;.<cite>&dagger; , not , since we follow the NONMEM convention and, whendiscussing individual type data as here, use to denote therandom effects of a single level that appear in the model,those in the residual error model. </cite>2.2. Least Squares for Individual Data with Other Types ofError ModelsThe simple OLS criterion just defined becomes inefficientand is no longer the &quot;best&quot; one to use when the error modelis other than the Additive error model. It treats allestimated errors as equally important (i.e. a reduction inthe magnitude of either of two estimated errors that are ofthe same magnitude is equally valuable in that eitherreduction decreases the sum of squared errors by the sameamount), and this results in parameter estimates that causeall errors to have about the same typical magnitude, asassumed under the Additive model. The CCV error model,though, says that the typical magnitude of an error variesmonotonically with the magnitude of the (true) prediction ofy. In principle, Weighted Least Squares (WLS) gives a fitmore commensurate with the CCV or other non-Additive errormodel. WLS chooses as that value of minimizingEach is a weight which, ideally, is set proportional to the inverse ofthe variance of . In the CCV model this variance isproportional to (evaluated at the true valueof ). Use of such weights willdown-weight the importance of estimated squared errors associated with largevalues of and promote the relative contribution of those associatedwith small values of .In many cases, users can supply approximate weights, and theWLS objective function can be used as stated in (5.1).When, as with the CCV model for example, the ideal weightsdepend on the true values of parameters, these true valuescan be replaced by initial estimates, and then the WLSobjective function as given in (5.1) can be minimized.Alternatively, instead of viewing as a function ofonly through the estimated error&rsquo;s dependence on , it canbe viewed as a function of through both that dependenceand also through the ideal weights&rsquo; dependence on . Theentire function can then be minimized with respect to .That this creates a problem is most easily seen when theerror model contains a parameter which is not itself aparameter of the structural model, but which, nonetheless,must be regarded as an element of . Such an error model isthe Power Function model of (3.7), and the &quot;extra&quot; parameteris . The WLS objective function with the reciprocalvariance of substituted for is&dagger;<cite>&dagger; Again, we call attention to the symbols used for therandom effects parameter: the term appears in theobjective function, (5.2), not , because we are discussingindividual type data, not population type data. </cite>In this caseif were setto a very large number, while the other parameters in were only such asto make all , thenall would be very large, and the summation wouldattain a very small value. (The value ofis irrelevant to the minimization with respect to.)Thus, all elements in other thanwould be indeterminate (as long as they were such thatall were greater than 1); a most unsatisfactory state ofaffairs.There is a way to deal with this problem that preserves thespirit of least-squares fitting, and NONMEM uses it. Inessence, it adds to the WLS objective function a termproportional to the sum of the logarithms of the errorvariances. Thus a penalty is paid for increasing the errorvariances without a concomitant decrease in the estimatederrors themselves. This modified objective function iscalled the Extended Least Squares (ELS) objective function.It is minimized with respect to all parameters of thestructural and error models simultaneously (in the currentexample, and , as can be considered an element of ). &#9474;Note that the objective function may be negative. This has &#9474;no particular significance.2.3. Least Squares for Population DataThe complications arising from a population model are dueentirely to the random interindividual effects occurring inthe parameter model. To deal with this, NONMEM uses anapproximation to the true model. The approximate model islinear in all the random effects. For this linearizedmodel, the vector of mean values for the observations fromthe individual is the vector of true predictions forthese observations. These predictions are obtained from themodel by setting the parameters to their true values and bysetting all the elements of both and to zero. In otherwords, these are the true predictions for the meanindividual with fixed effects equal to those of theindividual. For this linearized model it is also possibleto write a formula for the variance-covariance matrix of theobservations from the individual. This matrix is afunction of the individual&rsquo;s fixed effects and thepopulation parameters , , and . Finally, the ELSobjective function discussed above is generalized to be asum over individuals, rather than observations, and wherethe term of the sum involves a squared error between avector of observations and an associated vector ofpredictions, weighted by the reciprocal of the associatedvariance-covariance matrix for the individual.3. Parameter EstimatesIt is useful to consider how to estimate parameters that donot appear in the model we use to fit the data, but are,instead, functions of them (e.g. the half-life parameter, when the rate constant of elimination is themodel parameter).It is always possible, of course, to parameterize the modelin the function of interest. For example, we have alreadyseen (Chapters 2 &amp; 3) that we may use the function(parameter) in the one-compartment model instead of .However, we may be interested in the values of severalalternative parameterizations (e.g., we may want to know k,clearance, and half-life). Rather than rerun the sameproblem with several alternative parameterizations, we canuse the fact that the LS estimate of a function of theparameters is given by the same function of the LS parameterestimates. Formally, if is the function ofinterest, then . E.g. Letting , , and, then .4. Precision of Parameter EstimatesClearly, it is almost impossible for the estimates toactually be the true values. The question is: how far arethe true values from the estimates? To discuss thisquestion, imagine replicating the entire experiment(gathering new data, but keeping fixed) multiple times.Also, for simplicity, imagine that the model has only onescalar parameter, , and that its true value, is known.If, after each replication, the estimate of is recorded,and a histogram of these values is plotted, one might seesomething like figure 5.1A or 5.1B.Figure 5.1. Two hypothetical histograms of estimates of asingle parameter upon replication of a given experiment.Left panel (A): The estimates have small variance (spread)but are biased (the mean of the estimates differs from thetrue value, ); Right panel: The estimates have largevariance but are relatively unbiased.The difference between the estimate and the true value, ,obviously differs from replication to replication. Let thisdifference be called the estimatio__________ error______ We cannot knowthe estimation error of any particular estimate (if wecould, we could know the true value itself, by subtraction),but we can hope to estimate the mean error magnitude. Sinceerrors can be positive or negative, a measure of magnitudethat is unaffected by sign is desirable. This istraditionally the Mean Squared Error ( ). The MSE can befactored into two parts:where is the bias of the estimates (mean (signed) difference between theestimates and the true value) and is the standard error ofthe estimates ( is the variance of the estimates). Asillustrated in figure 5.1, the can be about the same fortwo types of estimates while both their bias anddiffer. It is very hard to estimate the bias of anestimator unless the true parameter value is, in fact, known.This is not true of the : the standard deviation ofthe distribution of estimates of a parameter on replication isthe ; noknowledge of the true value of the parameter is required.In many situations,LS estimators of fixed effects parametersare unbiased, although in nonlinear problems,such as most pharmacokinetic ones, this cannot be assured.4.1. Distribution of Parameters vs Distribution ofParameter EstimatesFigure 5.1 illustrates the distribution of parameterestimates that might result if an experiment werereplicated. The bias and spread depend on the estimationmethod, the design of the experiment ( , which implicitlyincludes ) and on the true parameter values, including thevariances (and covariances) of the random effectsinfluencing . If, for example, more observations wereobtained in each experiment (more individuals in apopulation study), the spread of the estimates (one fromeach experiment) would decrease until, in the limit, if aninfinite number of observations were obtained in eachexperiment, every estimate would be the same (equal to thetrue value plus the bias of the estimator). Thus, thedistribution of the estimate tells us nothing about biologyor measurement error, but only about the of theestimate itself.In contrast, and tell us about unexplained (or random)interindividual variability (biology) or error magnitude(biology plus measurement error), not about how precisely weknow these things. No matter how many observations we make,interindividual variability will remain the same size (butthe variability of our estimate of its size will decrease),as will the measurement error variability of a particularinstrument.It is very important not to confuse variability (e.g.,between individuals) in a model parameter with variabilityin the estimate of that parameter, despite the fact that theterms we use to describe both variabilities are similar.Thus an element of , say has a , , while theestimate of , , also has a given by thesquare of the standard error for . Indeed, the use ofthe term &quot;standard error&quot; rather than &quot;standard deviation&quot;to name a measure of the spread in the distribution of theparameter rather than in the parameter helps callattention to the distinction between these two types ofthings.4.2. Confidence Interval for a Single ParameterAcknowledging that any particular estimate from anyparticular experiment is unlikely to equal the trueparameter value implies that we should be interested in&quot;interval&quot; estimates of parameters as well as (instead of?)point estimates. An interval estimate of a parameter isusually a range of values for the parameter, often centeredat the point estimate, such that the range contains the trueparameter value with a specified probability. Theprobability chosen is often 95%, in which case the intervalestimate is called the 95% Confidence Interval (CI).A CI is often based only on the parameter estimate and its. In the next sections we discuss three questions aboutsuch CIs a little further. (i) How to estimate the froma single set of data (we cannot replicate our experimentmany times and construct a histogram as in figure 5.1).(ii) Given an estimate of , how to use that number tocompute a (95% confidence) interval with 95% chance ofcontaining the true parameter value. (iii) Given anestimate of , how to compute a confidence interval for afunction of the parameter.4.2.1. Estimating a Parameter&rsquo;s Standard ErrorRemarkably, the of a parameter estimate can be estimatedusing only the data from a single experiment. The idea isthat the data give us estimates of the variances of allrandom effects in our model, from which we can estimate thevariability in future data (if we were to replicate theexperiment). That is, the SE of the estimates onreplication depends only on quantities we either know orhave estimates of: the , the number of observed ( ), andthe variances of all random effects.It is a little beyond the scope of this discussion to givethe method by which NONMEM actually estimates the of aparameter estimate; however, examples of how this can bedone are found in any statistical textbook on regression.NONMEM presents the estimated standard error for eachparameter of the model (including the random effectsparameters, and ) as part of its output.4.2.2. Relating the Confidence Interval to theStatistical theory tells us not only how to compute theof a parameter estimate, but also that for a LS estimate(and many other kinds of estimates), the shape of thedistribution of the estimates is approximately Normal if thedata set is large enough. This means that we may usepercentiles of the Normal distribution, to computeconfidence interval bounds (when is small, thedistribution is often used instead; this is discussed instatistics texts). In general, a 100(1- )% confidenceinterval for a single parameter, say, is computed as. Here denotes the percentile of theNormal distribution. As previously noted, is often chosento be .05, in which case is approximately 2.4.2.3. A Confidence Interval for a Function of a SingleParameterAs discussed above, one can reparameterize the model interms of the new parameter, and NONMEM will then estimateits standard error. If re-running the fit presents aproblem, there is a simple way to compute a confidenceinterval for a function of a single parameter. If thelower and upper bounds of a 100(1- )% confidence intervalfor are denoted and , respectively, then a 100(1- )%confidence interval for has lower and upper boundsand , respectively. This confidence interval,however, is not necessarily centered at .4.3. Multiple Parameters4.3.1. Correlation of Parameter EstimatesA truly new feature introduced by multiple parameters is thephenomenon of correlation among parameter estimates. NONMEMoutputs a correlation matrix for the parameter estimates.The element of the matrix is the correlation betweenthe ith and jth parameter estimates. A large correlation(e.g. ) means that the conditional distribution of theith estimate, given a fixed value of the jth estimate,depends considerably on this fixed value. Sometimes eachparameter estimate of a pair that is highly correlated has alarge standard error, meaning that neither parameter can bewell-estimated. This problem may be caused by data that donot distinguish among the parameters very well, while asimpler model, or a different design, or more data mightpermit more precise estimates of each.As a simple example, imagine a straight line fit to just twopoints, both at the same value of : neither slope norintercept can be estimated at all as long as the other isunknown, but fixing either one (simplifying the model)determines the other. Both parameters could be estimated byobserving another point at some other value of (moredata), or, still using just 2 points, by placing thesepoints at two different values of (modifying the design).Thus, when standard errors are large, it is useful toexamine the correlation matrix of parameter estimates tosee, in particular, if some simplification of the model mayhelp.4.3.2. Confidence Intervals for a Function of SeveralParametersThere is an approximate formula for computing a standarderror, and hence a confidence interval for a function ofseveral parameters (e.g., a confidence interval forhalf-life when the estimated parameters are and ). Ituses the standard errors of the parameter estimates and thecorrelations between the parameter estimates. However,discussion of this formula is beyond the scope of thisintroduction. If a confidence interval for a function ofseveral parameters is desired, it is often more convenientto re-fit the data with the model reparameterized to includethe function as an explicit parameter.5. Hypothesis TestingBefore going into details, a note of caution is in orderabout hypothesis testing in general. The logic ofhypothesis testing is that one sets up a hypothesis about aparameter&rsquo;s value, called the nul____ hypothesis___________ and asks ifthe data are sufficiently in conflict with it to call itinto question. If they are, one rejects the nullhypothesis. However, logically, if they are not, one hassimply failed to reject the null hypothesis; one does notnecessarily have sufficient data to accept it. An extremeexample will make this clear. Let the null hypothesis beany assertion at all about the state of nature. Gather noevidence bearing on the question. Clearly, the evidence(which is void) is insufficient to reject the nullhypothesis, but just as clearly, in this case the evidenceprovides no support for it either.In less extreme cases there is a way to view failure toreject as lending some support to the null hypothesis, butthe matter is problematic. It is somewhat less problematicto use a confidence interval to quantify support for a nullhypothesis. A null hypothesis is an assertion that aparameter&rsquo;s true value is found among a set of nul____ values_______A confidence interval puts reasonable bounds on the possiblevalues of a parameter. One can then say that the evidence(the data from which the parameter estimate is derived) doessupport a null hypothesis (about the value of the parameter)if the null values are included in the interval and that theevidence fully support the null hypothesis if all nonnullvalues lie outside. An example will help make this clear.Consider that mean drug clearance in adults varies linearlywith the weight of the individual to a clinicallysignificant degree. Formally, this can be put as astatement about a regression coefficient in a model such asThe null hypothesis might be that is close to zero, i.e.that it is not so different from zero as to be clinically significant. To make this precise, suppose that we know that mean clearancefor a 70 kg person (i.e., ) is about 100 ml/min. Ifwere .20 ml/min/kg or less, a 50 kg increment(decrement) in weight from 70 kg would be associated with less than a 10%change in total clearance. This is clinically insignificant, sothe appropriate null values for might be 0.0 to .20,assuming, of course, that a physical lower bound for theparameter is zero.(More usually in statistical discussions a set of null values consists ofa single number, e.g. 0.)If the confidence interval for only includes nullvalues (e.g., it is .10 to .15),one might then safely conclude that weight, if it has any effectat all, has no significant effect, and thatthe data fully support the null hypothesis.If the confidence interval includes null values and others(e.g., it is 0.0 to .60),one would conclude that there is some support for the null hypothesis,but that there is also some support for rejecting it.In this case the data are insufficient to allow outright acceptance orrejection.If the confidence interval includes no null values (e.g., it is .80 to 1.3),one would reject the null hypothesis and conclude that weight has aclinically significant (linear) effect on clearance.For these reasons, we urge caution when performinghypothesis tests and suggest that confidence intervals areoften more useful. None the less, the popularity ofhypothesis tests requires that they be done, and we nowdescribe two methods for so doing, the first somewhat moreapproximate and less general than the second, but easier todo.5.1. Hypothesis Testing Using theA straight-forward way to test a null hypothesis about thevalue of a parameter is to use a confidence interval forthis purpose. In other words, if the confidence intervalexcludes the null values, then the null hypothesis isrejected. As described in Section 4.2.2, such a confidenceinterval is based on the estimated standard error. Thismethod generalizes to a hypothesis about the values ofseveral parameters simultaneously, but this is beyond thescope of this introduction.5.2. Hypothesis Testing Using the Likelihood RatioAn approach that involves the extra effort of re-fitting thedata has the advantage of being less approximate than theone that uses a confidence interval based on the SE. Thismethod is the so-called Likelihood Ratio Test.The basic idea is to compare directly the goodness of fit(as indicated by the minimum value of the extended leastsquares objective function) obtained between using a modelin which the parameter is fixed to the hypothesized value(the reduced model) and a model in which the parameter mustbe estimated (the full model).5.2.1. Definition &mdash; Full/Reduced ModelsA model is a reduced model of a full model if it isidentical to the full model except that one or moreparameters of the latter have been fixed to hypothesizedvalues (usually 0). Consider the examples:E.g. #1. Valid Full/Reduced Pair:Full model:Reduced model:E.g. #2. Invalid Full/Reduced Pair:Full model:Reduced model:In example #1, fixing to 0 produces the reduced model,while in example #2, no parameter of the full model can befixed to a particular value to yield the &quot;reduced&quot; model.It will always be true that if the models are set upcorrectly, the number of parameters that must be estimatedwill be greater in the full model than in the reduced model.Note that this is not so for example #2.5.2.2. Reduced/Full Models Express the Null/AlternativeHypothesesThe reduced model expresses the null hypothesis; the fullmodel expresses an alternative hypothesis. In example #1above, the null hypothesis is &quot;typical value of clearance isindependent of weight&quot;, and the alternative is &quot;typicalvalue of clearance depends linearly on weight.&quot;Note an important point here: the alternative hypothesisrepresents a particular alternative, and the likelihoodratio test using it will most sensitively reject the nullhypothesis only when this particular alternative holds. Ifthe full model were that &quot;the typical value of clearance isinversely proportional to weight&quot; (so that as weightincreases, the typical value of clearance decreases, asituation which rarely holds), the likelihood ratio testusing the alternative we have stated would not beparticularly sensitive to rejecting the null hypothesis, andwe might fail to do so. In contrast, we might succeed inrejecting the null hypothesis if we used some otheralternative model closer to the truth.5.2.3. The Likelihood Ratio TestPart of the NONMEM output is the &quot;Minimum Value of theObjective Function&quot; (see Chapter 2). Denote this by . IfNONMEM&rsquo;s approximate model were the true model, then wouldbe minus twice the maximum logarithm of the likelihood ofthe data (for those readers unfamiliar with likelihoods, andcurious as to what they are, we suggest consulting astatistics textbook). Statistical theory tells us that thedifference in minus twice the maximum log likelihoodsbetween a full and reduced model can be referenced to aknown distribution. Thus, to perform the Likelihood RatioTest, one proceeds as follows.Let be the minimum value of the objective function fromthe fit to the full model, and let be the correspondingquantity from the fit to the reduced model. Fit both modelsseparately yielding and , and form the statistic,This statistic is approximately distributed chi-square ( )withdegree of freedom, where is the number of parameters whose values arefixed in the reduced model. For an -level test,compare to , the 100(1- )percentile of the distribution.In particular, when exactly one parameter of the full modelis fixed in the reduced model, a decrease of 3.84 in theminimum value of the objective function is significant at.If NONMEM&rsquo;s approximate model (linear in the random effects)were the true model, and in addition, were linear in thefixed effects, then would be (approximately)distributed according to the distribution with , anddegrees of freedom ( ). Since is equal toonly when is &quot;large&quot;, and is greater otherwise, itis more conservative to reference to in allinstances, even when is nonlinear.6. Choosing Among ModelsAn idea related to hypothesis testing is this: when facedwith alternative explanations (models) for some data, howdoes one use the data to determine which model(s) is (are)most plausible? When one of the models is a reducedsub-model of the other, and there is some reason toprefer the reduced model to the alternative, then theLikelihood Ratio test can be used to test whether this apriori preference must be rejected (at the level).However, when one gives the matter some thought, there isusually little objective reason to prefer one model overanother on a priori grounds. For example, although possiblymore convenient, a monoexponential model is, if anything,less likely on biological grounds than a biexponential.Not only may there not be a clear probabilityfavoring one contending model over another, but the twomodels may not form a full and reduced model pair. In suchcircumstances, one must rely on some goodness-of-fitcriterion to distinguish between the models. Considerchoosing between just two models (the ideas to be discussedreadily generalize to more than two), denoted model andmodel . If the number of free parameters in model ( )is the same as that of ( ), then here is a reasonablecriterion: favor the model with the better fit. Note thatthere is no value associated with this statement; nohypothesis is being tested.Unfortunately, if one cannot simply compare andand choose the one with the smaller value. The reason isbest understood when and are a full and reduced modelpair. The full model will always fit the data better (i.e.,have a smaller ) as it has more free parameters to adjustits shape to the data. While the same is not always truefor any pair of non-linear models with different numbers ofparameters, it is often true: the model with the greaternumber of parameters will fit a given data set better thanthe model with fewer parameters. Yet the larger (moreparameters) model may not really be better; it may, in fact,fit an entirely new data set worse than the simpler model ifits better fit to the original data was simply because itexploited the flexibility of its extra parameter(s) tobetter fit some random aspect of that data.Based on the above intuitive argument, it seems that oneshould penalize the larger model in some way beforecomparing the likelihoods. This intuition is formallyrealized in the Akaike Information Criterion (AIC) whichsays that one should compute + , andchoose model if is &gt;0, and model if is &lt;0. Thesecond term penalizes model if , and vice versa.When , the reduces to the comparison of anddescribed previously.
<a name="1. What This Chapter is AboutIn this chapter, we discuss the fitting criterion thatNONMEM uses, parameter estimates, and standard errorestimates. We then discuss how to form confidence intervalsfor parameters and do hypothesis tests with NONMEM.2. Model Fitting CriterionIn principle, all fitting procedures attempt to adjust thevalues of the parameters of the model to give a &quot;best fit&quot;of the predictions to the actual observations. The set ofparameters that accomplish this are called the parameterestimates, and are denoted here as , , and . Methodsdiffer in how they define &quot;best&quot;. The criterion that NONMEMuses is a Least Squares (LS) type criterion. The form ofthis criterion varies as the error model varies, and aspopulation models with multiple random effects must beconsidered. We briefly discuss these various criteria next,to give the reader a feel for what NONMEM is doing. Adetailed knowledge of the statistical basis for the choiceof fitting criterion is not necessary either to use orinterpret NONMEM fits. In this chapter, a fixed effectsparameter will be denoted by a ; the distinction betweenindividual fixed effects parameters ( ) and population fixedeffects parameters will not be important here.2.1. Least Squares for Individual Data with an AdditiveError ModelFor the Additive error model (3.4), the Ordinary LeastSquares criterion (OLS) chooses the estimate so as to makethe sum of squared (estimated) errors as small as possible.These estimates cause the prediction, here denoted , to bean estimate of the mean value of , which is intuitivelyappealing. The prediction is obtained by computing thevalue for y under the model with parameters set to theirestimated values and set to zero&dagger;.<cite>&dagger; , not , since we follow the NONMEM convention and, whendiscussing individual type data as here, use to denote therandom effects of a single level that appear in the model,those in the residual error model. </cite>2.2. Least Squares for Individual Data with Other Types ofError ModelsThe simple OLS criterion just defined becomes inefficientand is no longer the &quot;best&quot; one to use when the error modelis other than the Additive error model. It treats allestimated errors as equally important (i.e. a reduction inthe magnitude of either of two estimated errors that are ofthe same magnitude is equally valuable in that eitherreduction decreases the sum of squared errors by the sameamount), and this results in parameter estimates that causeall errors to have about the same typical magnitude, asassumed under the Additive model. The CCV error model,though, says that the typical magnitude of an error variesmonotonically with the magnitude of the (true) prediction ofy. In principle, Weighted Least Squares (WLS) gives a fitmore commensurate with the CCV or other non-Additive errormodel. WLS chooses as that value of minimizingEach is a weight which, ideally, is set proportional to the inverse ofthe variance of . In the CCV model this variance isproportional to (evaluated at the true valueof ). Use of such weights willdown-weight the importance of estimated squared errors associated with largevalues of and promote the relative contribution of those associatedwith small values of .In many cases, users can supply approximate weights, and theWLS objective function can be used as stated in (5.1).When, as with the CCV model for example, the ideal weightsdepend on the true values of parameters, these true valuescan be replaced by initial estimates, and then the WLSobjective function as given in (5.1) can be minimized.Alternatively, instead of viewing as a function ofonly through the estimated error&rsquo;s dependence on , it canbe viewed as a function of through both that dependenceand also through the ideal weights&rsquo; dependence on . Theentire function can then be minimized with respect to .That this creates a problem is most easily seen when theerror model contains a parameter which is not itself aparameter of the structural model, but which, nonetheless,must be regarded as an element of . Such an error model isthe Power Function model of (3.7), and the &quot;extra&quot; parameteris . The WLS objective function with the reciprocalvariance of substituted for is&dagger;<cite>&dagger; Again, we call attention to the symbols used for therandom effects parameter: the term appears in theobjective function, (5.2), not , because we are discussingindividual type data, not population type data. </cite>In this caseif were setto a very large number, while the other parameters in were only such asto make all , thenall would be very large, and the summation wouldattain a very small value. (The value ofis irrelevant to the minimization with respect to.)Thus, all elements in other thanwould be indeterminate (as long as they were such thatall were greater than 1); a most unsatisfactory state ofaffairs.There is a way to deal with this problem that preserves thespirit of least-squares fitting, and NONMEM uses it. Inessence, it adds to the WLS objective function a termproportional to the sum of the logarithms of the errorvariances. Thus a penalty is paid for increasing the errorvariances without a concomitant decrease in the estimatederrors themselves. This modified objective function iscalled the Extended Least Squares (ELS) objective function.It is minimized with respect to all parameters of thestructural and error models simultaneously (in the currentexample, and , as can be considered an element of ). &#9474;Note that the objective function may be negative. This has &#9474;no particular significance.2.3. Least Squares for Population DataThe complications arising from a population model are dueentirely to the random interindividual effects occurring inthe parameter model. To deal with this, NONMEM uses anapproximation to the true model. The approximate model islinear in all the random effects. For this linearizedmodel, the vector of mean values for the observations fromthe individual is the vector of true predictions forthese observations. These predictions are obtained from themodel by setting the parameters to their true values and bysetting all the elements of both and to zero. In otherwords, these are the true predictions for the meanindividual with fixed effects equal to those of theindividual. For this linearized model it is also possibleto write a formula for the variance-covariance matrix of theobservations from the individual. This matrix is afunction of the individual&rsquo;s fixed effects and thepopulation parameters , , and . Finally, the ELSobjective function discussed above is generalized to be asum over individuals, rather than observations, and wherethe term of the sum involves a squared error between avector of observations and an associated vector ofpredictions, weighted by the reciprocal of the associatedvariance-covariance matrix for the individual.3. Parameter EstimatesIt is useful to consider how to estimate parameters that donot appear in the model we use to fit the data, but are,instead, functions of them (e.g. the half-life parameter, when the rate constant of elimination is themodel parameter).It is always possible, of course, to parameterize the modelin the function of interest. For example, we have alreadyseen (Chapters 2 &amp; 3) that we may use the function(parameter) in the one-compartment model instead of .However, we may be interested in the values of severalalternative parameterizations (e.g., we may want to know k,clearance, and half-life). Rather than rerun the sameproblem with several alternative parameterizations, we canuse the fact that the LS estimate of a function of theparameters is given by the same function of the LS parameterestimates. Formally, if is the function ofinterest, then . E.g. Letting , , and, then .4. Precision of Parameter EstimatesClearly, it is almost impossible for the estimates toactually be the true values. The question is: how far arethe true values from the estimates? To discuss thisquestion, imagine replicating the entire experiment(gathering new data, but keeping fixed) multiple times.Also, for simplicity, imagine that the model has only onescalar parameter, , and that its true value, is known.If, after each replication, the estimate of is recorded,and a histogram of these values is plotted, one might seesomething like figure 5.1A or 5.1B.Figure 5.1. Two hypothetical histograms of estimates of asingle parameter upon replication of a given experiment.Left panel (A): The estimates have small variance (spread)but are biased (the mean of the estimates differs from thetrue value, ); Right panel: The estimates have largevariance but are relatively unbiased.The difference between the estimate and the true value, ,obviously differs from replication to replication. Let thisdifference be called the estimatio__________ error______ We cannot knowthe estimation error of any particular estimate (if wecould, we could know the true value itself, by subtraction),but we can hope to estimate the mean error magnitude. Sinceerrors can be positive or negative, a measure of magnitudethat is unaffected by sign is desirable. This istraditionally the Mean Squared Error ( ). The MSE can befactored into two parts:where is the bias of the estimates (mean (signed) difference between theestimates and the true value) and is the standard error ofthe estimates ( is the variance of the estimates). Asillustrated in figure 5.1, the can be about the same fortwo types of estimates while both their bias anddiffer. It is very hard to estimate the bias of anestimator unless the true parameter value is, in fact, known.This is not true of the : the standard deviation ofthe distribution of estimates of a parameter on replication isthe ; noknowledge of the true value of the parameter is required.In many situations,LS estimators of fixed effects parametersare unbiased, although in nonlinear problems,such as most pharmacokinetic ones, this cannot be assured.4.1. Distribution of Parameters vs Distribution ofParameter EstimatesFigure 5.1 illustrates the distribution of parameterestimates that might result if an experiment werereplicated. The bias and spread depend on the estimationmethod, the design of the experiment ( , which implicitlyincludes ) and on the true parameter values, including thevariances (and covariances) of the random effectsinfluencing . If, for example, more observations wereobtained in each experiment (more individuals in apopulation study), the spread of the estimates (one fromeach experiment) would decrease until, in the limit, if aninfinite number of observations were obtained in eachexperiment, every estimate would be the same (equal to thetrue value plus the bias of the estimator). Thus, thedistribution of the estimate tells us nothing about biologyor measurement error, but only about the of theestimate itself.In contrast, and tell us about unexplained (or random)interindividual variability (biology) or error magnitude(biology plus measurement error), not about how precisely weknow these things. No matter how many observations we make,interindividual variability will remain the same size (butthe variability of our estimate of its size will decrease),as will the measurement error variability of a particularinstrument.It is very important not to confuse variability (e.g.,between individuals) in a model parameter with variabilityin the estimate of that parameter, despite the fact that theterms we use to describe both variabilities are similar.Thus an element of , say has a , , while theestimate of , , also has a given by thesquare of the standard error for . Indeed, the use ofthe term &quot;standard error&quot; rather than &quot;standard deviation&quot;to name a measure of the spread in the distribution of theparameter rather than in the parameter helps callattention to the distinction between these two types ofthings.4.2. Confidence Interval for a Single ParameterAcknowledging that any particular estimate from anyparticular experiment is unlikely to equal the trueparameter value implies that we should be interested in&quot;interval&quot; estimates of parameters as well as (instead of?)point estimates. An interval estimate of a parameter isusually a range of values for the parameter, often centeredat the point estimate, such that the range contains the trueparameter value with a specified probability. Theprobability chosen is often 95%, in which case the intervalestimate is called the 95% Confidence Interval (CI).A CI is often based only on the parameter estimate and its. In the next sections we discuss three questions aboutsuch CIs a little further. (i) How to estimate the froma single set of data (we cannot replicate our experimentmany times and construct a histogram as in figure 5.1).(ii) Given an estimate of , how to use that number tocompute a (95% confidence) interval with 95% chance ofcontaining the true parameter value. (iii) Given anestimate of , how to compute a confidence interval for afunction of the parameter.4.2.1. Estimating a Parameter&rsquo;s Standard ErrorRemarkably, the of a parameter estimate can be estimatedusing only the data from a single experiment. The idea isthat the data give us estimates of the variances of allrandom effects in our model, from which we can estimate thevariability in future data (if we were to replicate theexperiment). That is, the SE of the estimates onreplication depends only on quantities we either know orhave estimates of: the , the number of observed ( ), andthe variances of all random effects.It is a little beyond the scope of this discussion to givethe method by which NONMEM actually estimates the of aparameter estimate; however, examples of how this can bedone are found in any statistical textbook on regression.NONMEM presents the estimated standard error for eachparameter of the model (including the random effectsparameters, and ) as part of its output.4.2.2. Relating the Confidence Interval to theStatistical theory tells us not only how to compute theof a parameter estimate, but also that for a LS estimate(and many other kinds of estimates), the shape of thedistribution of the estimates is approximately Normal if thedata set is large enough. This means that we may usepercentiles of the Normal distribution, to computeconfidence interval bounds (when is small, thedistribution is often used instead; this is discussed instatistics texts). In general, a 100(1- )% confidenceinterval for a single parameter, say, is computed as. Here denotes the percentile of theNormal distribution. As previously noted, is often chosento be .05, in which case is approximately 2.4.2.3. A Confidence Interval for a Function of a SingleParameterAs discussed above, one can reparameterize the model interms of the new parameter, and NONMEM will then estimateits standard error. If re-running the fit presents aproblem, there is a simple way to compute a confidenceinterval for a function of a single parameter. If thelower and upper bounds of a 100(1- )% confidence intervalfor are denoted and , respectively, then a 100(1- )%confidence interval for has lower and upper boundsand , respectively. This confidence interval,however, is not necessarily centered at .4.3. Multiple Parameters4.3.1. Correlation of Parameter EstimatesA truly new feature introduced by multiple parameters is thephenomenon of correlation among parameter estimates. NONMEMoutputs a correlation matrix for the parameter estimates.The element of the matrix is the correlation betweenthe ith and jth parameter estimates. A large correlation(e.g. ) means that the conditional distribution of theith estimate, given a fixed value of the jth estimate,depends considerably on this fixed value. Sometimes eachparameter estimate of a pair that is highly correlated has alarge standard error, meaning that neither parameter can bewell-estimated. This problem may be caused by data that donot distinguish among the parameters very well, while asimpler model, or a different design, or more data mightpermit more precise estimates of each.As a simple example, imagine a straight line fit to just twopoints, both at the same value of : neither slope norintercept can be estimated at all as long as the other isunknown, but fixing either one (simplifying the model)determines the other. Both parameters could be estimated byobserving another point at some other value of (moredata), or, still using just 2 points, by placing thesepoints at two different values of (modifying the design).Thus, when standard errors are large, it is useful toexamine the correlation matrix of parameter estimates tosee, in particular, if some simplification of the model mayhelp.4.3.2. Confidence Intervals for a Function of SeveralParametersThere is an approximate formula for computing a standarderror, and hence a confidence interval for a function ofseveral parameters (e.g., a confidence interval forhalf-life when the estimated parameters are and ). Ituses the standard errors of the parameter estimates and thecorrelations between the parameter estimates. However,discussion of this formula is beyond the scope of thisintroduction. If a confidence interval for a function ofseveral parameters is desired, it is often more convenientto re-fit the data with the model reparameterized to includethe function as an explicit parameter.5. Hypothesis TestingBefore going into details, a note of caution is in orderabout hypothesis testing in general. The logic ofhypothesis testing is that one sets up a hypothesis about aparameter&rsquo;s value, called the nul____ hypothesis___________ and asks ifthe data are sufficiently in conflict with it to call itinto question. If they are, one rejects the nullhypothesis. However, logically, if they are not, one hassimply failed to reject the null hypothesis; one does notnecessarily have sufficient data to accept it. An extremeexample will make this clear. Let the null hypothesis beany assertion at all about the state of nature. Gather noevidence bearing on the question. Clearly, the evidence(which is void) is insufficient to reject the nullhypothesis, but just as clearly, in this case the evidenceprovides no support for it either.In less extreme cases there is a way to view failure toreject as lending some support to the null hypothesis, butthe matter is problematic. It is somewhat less problematicto use a confidence interval to quantify support for a nullhypothesis. A null hypothesis is an assertion that aparameter&rsquo;s true value is found among a set of nul____ values_______A confidence interval puts reasonable bounds on the possiblevalues of a parameter. One can then say that the evidence(the data from which the parameter estimate is derived) doessupport a null hypothesis (about the value of the parameter)if the null values are included in the interval and that theevidence fully support the null hypothesis if all nonnullvalues lie outside. An example will help make this clear.Consider that mean drug clearance in adults varies linearlywith the weight of the individual to a clinicallysignificant degree. Formally, this can be put as astatement about a regression coefficient in a model such asThe null hypothesis might be that is close to zero, i.e.that it is not so different from zero as to be clinically significant. To make this precise, suppose that we know that mean clearancefor a 70 kg person (i.e., ) is about 100 ml/min. Ifwere .20 ml/min/kg or less, a 50 kg increment(decrement) in weight from 70 kg would be associated with less than a 10%change in total clearance. This is clinically insignificant, sothe appropriate null values for might be 0.0 to .20,assuming, of course, that a physical lower bound for theparameter is zero.(More usually in statistical discussions a set of null values consists ofa single number, e.g. 0.)If the confidence interval for only includes nullvalues (e.g., it is .10 to .15),one might then safely conclude that weight, if it has any effectat all, has no significant effect, and thatthe data fully support the null hypothesis.If the confidence interval includes null values and others(e.g., it is 0.0 to .60),one would conclude that there is some support for the null hypothesis,but that there is also some support for rejecting it.In this case the data are insufficient to allow outright acceptance orrejection.If the confidence interval includes no null values (e.g., it is .80 to 1.3),one would reject the null hypothesis and conclude that weight has aclinically significant (linear) effect on clearance.For these reasons, we urge caution when performinghypothesis tests and suggest that confidence intervals areoften more useful. None the less, the popularity ofhypothesis tests requires that they be done, and we nowdescribe two methods for so doing, the first somewhat moreapproximate and less general than the second, but easier todo.5.1. Hypothesis Testing Using theA straight-forward way to test a null hypothesis about thevalue of a parameter is to use a confidence interval forthis purpose. In other words, if the confidence intervalexcludes the null values, then the null hypothesis isrejected. As described in Section 4.2.2, such a confidenceinterval is based on the estimated standard error. Thismethod generalizes to a hypothesis about the values ofseveral parameters simultaneously, but this is beyond thescope of this introduction.5.2. Hypothesis Testing Using the Likelihood RatioAn approach that involves the extra effort of re-fitting thedata has the advantage of being less approximate than theone that uses a confidence interval based on the SE. Thismethod is the so-called Likelihood Ratio Test.The basic idea is to compare directly the goodness of fit(as indicated by the minimum value of the extended leastsquares objective function) obtained between using a modelin which the parameter is fixed to the hypothesized value(the reduced model) and a model in which the parameter mustbe estimated (the full model).5.2.1. Definition &mdash; Full/Reduced ModelsA model is a reduced model of a full model if it isidentical to the full model except that one or moreparameters of the latter have been fixed to hypothesizedvalues (usually 0). Consider the examples:E.g. #1. Valid Full/Reduced Pair:Full model:Reduced model:E.g. #2. Invalid Full/Reduced Pair:Full model:Reduced model:In example #1, fixing to 0 produces the reduced model,while in example #2, no parameter of the full model can befixed to a particular value to yield the &quot;reduced&quot; model.It will always be true that if the models are set upcorrectly, the number of parameters that must be estimatedwill be greater in the full model than in the reduced model.Note that this is not so for example #2.5.2.2. Reduced/Full Models Express the Null/AlternativeHypothesesThe reduced model expresses the null hypothesis; the fullmodel expresses an alternative hypothesis. In example #1above, the null hypothesis is &quot;typical value of clearance isindependent of weight&quot;, and the alternative is &quot;typicalvalue of clearance depends linearly on weight.&quot;Note an important point here: the alternative hypothesisrepresents a particular alternative, and the likelihoodratio test using it will most sensitively reject the nullhypothesis only when this particular alternative holds. Ifthe full model were that &quot;the typical value of clearance isinversely proportional to weight&quot; (so that as weightincreases, the typical value of clearance decreases, asituation which rarely holds), the likelihood ratio testusing the alternative we have stated would not beparticularly sensitive to rejecting the null hypothesis, andwe might fail to do so. In contrast, we might succeed inrejecting the null hypothesis if we used some otheralternative model closer to the truth.5.2.3. The Likelihood Ratio TestPart of the NONMEM output is the &quot;Minimum Value of theObjective Function&quot; (see Chapter 2). Denote this by . IfNONMEM&rsquo;s approximate model were the true model, then wouldbe minus twice the maximum logarithm of the likelihood ofthe data (for those readers unfamiliar with likelihoods, andcurious as to what they are, we suggest consulting astatistics textbook). Statistical theory tells us that thedifference in minus twice the maximum log likelihoodsbetween a full and reduced model can be referenced to aknown distribution. Thus, to perform the Likelihood RatioTest, one proceeds as follows.Let be the minimum value of the objective function fromthe fit to the full model, and let be the correspondingquantity from the fit to the reduced model. Fit both modelsseparately yielding and , and form the statistic,This statistic is approximately distributed chi-square ( )withdegree of freedom, where is the number of parameters whose values arefixed in the reduced model. For an -level test,compare to , the 100(1- )percentile of the distribution.In particular, when exactly one parameter of the full modelis fixed in the reduced model, a decrease of 3.84 in theminimum value of the objective function is significant at.If NONMEM&rsquo;s approximate model (linear in the random effects)were the true model, and in addition, were linear in thefixed effects, then would be (approximately)distributed according to the distribution with , anddegrees of freedom ( ). Since is equal toonly when is &quot;large&quot;, and is greater otherwise, itis more conservative to reference to in allinstances, even when is nonlinear.6. Choosing Among ModelsAn idea related to hypothesis testing is this: when facedwith alternative explanations (models) for some data, howdoes one use the data to determine which model(s) is (are)most plausible? When one of the models is a reducedsub-model of the other, and there is some reason toprefer the reduced model to the alternative, then theLikelihood Ratio test can be used to test whether this apriori preference must be rejected (at the level).However, when one gives the matter some thought, there isusually little objective reason to prefer one model overanother on a priori grounds. For example, although possiblymore convenient, a monoexponential model is, if anything,less likely on biological grounds than a biexponential.Not only may there not be a clear probabilityfavoring one contending model over another, but the twomodels may not form a full and reduced model pair. In suchcircumstances, one must rely on some goodness-of-fitcriterion to distinguish between the models. Considerchoosing between just two models (the ideas to be discussedreadily generalize to more than two), denoted model andmodel . If the number of free parameters in model ( )is the same as that of ( ), then here is a reasonablecriterion: favor the model with the better fit. Note thatthere is no value associated with this statement; nohypothesis is being tested.Unfortunately, if one cannot simply compare andand choose the one with the smaller value. The reason isbest understood when and are a full and reduced modelpair. The full model will always fit the data better (i.e.,have a smaller ) as it has more free parameters to adjustits shape to the data. While the same is not always truefor any pair of non-linear models with different numbers ofparameters, it is often true: the model with the greaternumber of parameters will fit a given data set better thanthe model with fewer parameters. Yet the larger (moreparameters) model may not really be better; it may, in fact,fit an entirely new data set worse than the simpler model ifits better fit to the original data was simply because itexploited the flexibility of its extra parameter(s) tobetter fit some random aspect of that data.Based on the above intuitive argument, it seems that oneshould penalize the larger model in some way beforecomparing the likelihoods. This intuition is formallyrealized in the Akaike Information Criterion (AIC) whichsays that one should compute + , andchoose model if is &gt;0, and model if is &lt;0. Thesecond term penalizes model if , and vice versa.When , the reduces to the comparison of anddescribed previously."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 6 -
Data Sets, $DATA and $INPUT Records, and the Data
Preprocessor</b></p>

<h2>1. What This Chapter is AboutThis chapter tells how to create data for analysis byNONMEM-PREDPP. It tells how to describe the data using$DATA and $INPUT records. The requirements for formattingthe data for NONMEM-PREDPP are somewhat more stringent thanare the requirements for formatting the data for NM-TRAN.The Data Preprocessor is a component of NM-TRAN whichmodifies the data so that it becomes formatted appropriatelyfor NONMEM-PREDPP.2. Data Sets for NONMEM2.1. Data RecordsA data set for NONMEM analysis consists of a series ofrecords (&quot;lines&quot; in the terminology of editing programs).Each record must consist of a fixed number of data items andeach must have the same format. Figure 6.1 shows how such adata set may be pictured. In data base terminology, this isa &quot;flat&quot; structure.Figure 6.1. A NONMEM input data set. Each data record is arow; each type of data item is in a different column.NONMEM imposes no limit on the number of records in the dataset. It does not (nor does PREDPP or NM-TRAN) sort the datarecords before processing them, so the data records mustalready be in the correct sequence. NONMEM itself cannot beinstructed to delete or drop records from the data set, but &#9474;see the DROP and IGNORE options of the $DATA record, below.2.2. Data ItemsNONMEM reads records from the data set with a FORTRAN FORMATspecification, and so each data item must occupy a fixednumber of character positions. Data items are alwaysnumbers. However, if no particular number is appropriatefor a given data item on a given record, the data item iscalled a nul____ dat____ item_____ it may be given the numerical value0 or the nonnumerical value &quot;.&quot;, or left blank. Zero&rsquo;s wereused in the first two lines of the Theophylline example ofChapter 2, which appeared as follows:2 320. 0. 0.2 0. .27 1.71The Data Preprocessor allows each value in the data set tooccupy only as many character positions as it needs, so longas the data items are separated by blanks (spaces) orcommas. Tab characters may also be used as separators if &#9474;they are stored as explicit characters, e.g., ASCII 011, &#9474;although this is platform-dependent and should be tested &#9474;carefully. When there are no commas or tabs, the value &quot;.&quot;or 0 must be used to hold the place of a null data item.The two lines above could have been entered as follows:2 320. 0. 0.2,,.27,1.71(Note the use in the second line of adjacent commas &quot;,,&quot; todenote a null data item.)The contents of the data items must be purely numeric; i.e.,character values such as Y, N, M or F may not be recorded.Instead, numeric codes such as 0 or 1 must be used.With NONMEM VI, the number of data items per data record isgiven by constant PD in file SIZES. The default value is20. With NONMEM 7.1, the default value is 50. With NONMEM7.2, there is no limit on the number of data items per datarecord.2.3. Clinical Data and Data ConversionClinical data often has a &quot;hierarchical&quot; file structure,with (say) two record formats: a patient record, containingfixed information about a patient (ID number, sex, age,prior history of smoking or drug use, etc), followed by oneor more visit records, containing doses and physicalobservations during the course of the study. Visit recordsmay not even contain the same number of items as patientrecords, nor have the same format. The hierarchy is shownschematically in figure 6.2.Patient recordVisit recordVisit record...Patient recordVisit recordVisit record...Figure 6.2. A hierarchical data file. Patient and visitrecords have different formats.NONMEM cannot accept such data. For NONMEM, the (fixed)information on the &quot;patient&quot; record must be copied ontoevery &quot;visit&quot; record, and the &quot;patient&quot; records must beeliminated. This is the user&rsquo;s responsibility and istypically done in a one-time data conversion step using thesystem editor and/or a specially written computer program.If an individual&rsquo;s data is to be deleted because he did notcomplete the study or had an adverse outcome, it should bedone at this time. In addition, numeric codes should besubstituted for alphabetic codes. Clinical data sometimesincludes multi-digit, non-consecutive patient identificationnumbers drawn from some patient identification system. Suchpatient identification numbers can be used with NONMEM asthe identification data item described in Section 6.2.However, it is preferable to append to each patient&rsquo;s datarecords numbers from the sequence 1, 2, 3, ..., for use asthe ID data item. This will make it easier to read ascatterplot which includes ID along one of the axes (e.g.,residual vs ID).When there is a large amount of data, we strongly suggestthat a small amount of data (from one or two individuals) beprepared for NONMEM-PREDPP analysis and a run in which onlytables and scatterplots are output be made to check that thedata is correctly prepared before a great deal of labor isexpended on the remainder.3. Data Sets for PREDPPWhen PREDPP is used with NONMEM, the data must meetadditional requirements. First, PREDPP is concerned withtime-ordered events such as dose events, which introducedrug into the system at particular times, and observationevents, which report observations taken at particular times.PREDPP insists that these events be recorded on separaterecords. That is, dosing information cannot be recorded onthe same record as an observed value. Second, PREDPPrequires that the time of each event be recorded on eachdata record, and that the physical sequence of the datarecords be the same as their sequence in time. (E.g., if adose event immediately precedes an observation event intime, then the dose event record must immediately precedethe observation event record.) Again, neither PREDPP northe Data Preprocessor will physically sort or resequence thedata records.4. The $DATA RecordThe $DATA record describes the characteristics of theexternal data file to be processed by NONMEM. NONMEM is nota data base management system and does not store a data setbetween runs; once a file has been prepared for NONMEM, itmust be re-read each time it is to be analyzed. The firstcharacter string appearing after $DATA is the name of thefile containing the data. Since it is to be used in aFORTRAN OPEN statement, this name may not include embedded &#9474;special characters such as slashes (/ or \), commas, &#9474;semi-colons, parentheses, equal signs or spaces unless it is &#9474;surrounded by single quotes &rsquo; or double quotes &quot;. The &#9474;filename may contain 80 characters. (If a file is to be &#9474;opened by NONMEM rather than by NM-TRAN, the filename may &#9474;not contain embedded spaces, and may contain at most 71 &#9474;characters.) A FORTRAN format specification suitable toread the data may follow the file name; this is optional andcan be supplied by the Data Preprocessor. The choice isdiscussed more fully in Section 10.4 of this chapter.Certain options may be specified if desired. Among theseare:RECORDS=nThis tells the number of records to be read from thedata file. If omitted, the records are read to theend-of-file or to a NONMEM FINISH record (Users GuideII). The RECORDS option may be used to limit NONMEMprocessing to the initial portion of the file and isuseful during the early stages of debugging. &#9474;RECORDS=label &#9474;&quot;Label&quot; is a data item label. The data records for the &#9474;problem will start at the place where the file is &#9474;positioned before data records are read and include all &#9474;contiguous data records having the same value for the &#9474;data item. In particular, the ID label may be used (or &#9474;alternatively, the option may be coded RECORDS=IR, &#9474;RECORDS=INDREC, or RECORDS=INDIVIDUALRECORD) to obtain &#9474;the data for a single individual. &#9474;IR,INDREC,INDIVIDUALRECORD. &#9474;NOREWIND|REWIND &#9474;With the first problem specification in a control &#9474;stream, the file is positioned at its initial point so &#9474;that the first record in the file is used. The options &#9474;REWIND and NOREWIND apply only with a $DATA record in a &#9474;subsequent problem specification. &#9474;REWIND: Reposition the file at the start. &#9474;NOREWIND: Leave the file at its current position so &#9474;that the next record in the file is read. Used when &#9474;the $DATA record with the previous problem &#9474;specification included the RECORDS option so that &#9474;NM-TRAN did not read to a physical end-of-file. This &#9474;is the default.LRECL=nThis tells the length of the physical data records. Itis required if the operating system associates a fixedphysical record length with every disk file andconsiders it a fatal I/O error if a READ commandrequests more characters than the records contain. Ifthis is true of your operating system, the operatingsystem will issue an error message when you first runNM-TRAN without the LRECL option in the $DATA record.WIDE This requests that the NONMEM data set produced byNM-TRAN always contain single-line records, and thatthese records always include at least one space betweendata items. Such a data set can be further processedby other programs. (The default is NOWIDE, in whichcase NM-TRAN limits the records to 80 characters bycreating multi-line records and/or eliminating spacesbetween data items if necessary.) It may not be usedif a FORTRAN format specification is present. It also &#9474;provides an extra character for relative times computed &#9474;by the Data Preprocessor.NULL=cThis requests that the NONMEM data set produced byNM-TRAN contain the character c in place of null dataitems. For example, NULL=0 requests that all null dataitems be replaced by 0. The syntax NULL=&rsquo;c&rsquo; andNULL=&quot;c&quot; is also permitted. The default is NULL=&rsquo; &rsquo;.It may not be used if a FORTRAN format specification ispresent.IGNORE=cThis instructs NM-TRAN to ignore data records havingcharacter c in the first character position (&quot;column1&quot;) of the record. This allows the use of &quot;comment&quot;records in the NM-TRAN data set. The syntax IGNORE=&rsquo;c&rsquo;and IGNORE=&quot;c&quot; is also permitted. It may be used evenif a FORTRAN format specification is present. &#9474;The character @ has a special meaning. It signifies &#9474;that any data record containing an alphabetic character &#9474;(or special characters @ or #) as its first non-blank &#9474;character (not just in column 1) should be ignored. &#9474;Alphabetic characters are the letters A-Z and a-z. &#9474;Thus, a table file produced by NONMEM in an earlier run &#9474;can be used as an NM-TRAN data set. Any header lines &#9474;included in this table can be dropped by specifying &#9474;IGNORE=@. &#9474;When the IGNORE option is omitted, any records &#9474;containing the character # in column 1 are ignored. &#9474;IGNORE=(list), ACCEPT=(list) &#9474;This form of the IGNORE option allows records to be &#9474;dropped based on the values of data items. For example, &#9474;IGNORE=(GEN.EQ.1,AGE.GT.60). &#9474;Records having GEN equal to 1 or AGE greater than 60 &#9474;are dropped. All others are accepted. The ACCEPT &#9474;option allows records to be accepted based on the &#9474;values of data items. See Guide VIII for more &#9474;information. &#9474;&#9474;LAST20=nn &#9474;&quot;nn&quot; is a 2 digit number that specifies the highest &#9474;2-digit year that is assumed to be in the 21st. &#9474;century, i.e., that represents 20nn rather than 19nn. &#9474;See Section 10.1.5 below. &#9474;TRANSLATE &#9474;The translate option must be followed by parentheses &#9474;enclosing a list of one or more translate &#9474;specifications. For example, &#9474;$DATA filename TRANSLATE(TIME/24,II/24) &#9474;Translate specification TIME/24 causes the value of &#9474;TIME to be divided by 24, whether or not day-time &#9474;translation occurs (i.e., whether or not relative times &#9474;are being computed). This has the effect of changing &#9474;the unit of TIME from hours to days. Similarly, &#9474;translate specification II/24 causes the value of II &#9474;(interdose interval) to be divided by 24 whether or not &#9474;&quot;:&quot; appears in any II value. See Section 10.1.4 below.5. The $INPUT RecordThis record describes how many data items there are on eachdata record, the order of the data items, and tells what thelabels of the data items are.5.1. Data Item LabelsA data item label is one to four letters (A-Z) or numerals(0-9). With NONMEM 7 a label consists of 1-24 letters &#9474;(A-Z), numerals (0-9), and the character &rsquo;_&rsquo;. (The length &#9474;24 is specified by constant SDF in SIZES) &#9474;The first character must be a letter. These labels are theones which will be used in other records (such as $PK or$SCATTERPLOT), and will appear in NONMEM&rsquo;s output. Theorder of the data items on the data records is notimportant, but must be the same on all data records in thedata set. In both the examples of Chapter 2, the ID dataitems happened to be the first ones in the data records, andthe DV data items happened to be the last ones. This orderwas arbitrary.5.2. Reserved Labels and SynonymsCertain data item labels are reserved in that they identifydata items which are recognized specifically by NONMEM,PREDPP, or NM-TRAN. The data items they label arethemselves called NONMEM, PREDPP, or NM-TRAN data items,respectively.&bull; Reserved NONMEM data item labels are: ID, L2, DV, andMDV. They are discussed in Section 6 of this chapterand in Section 4.2 of Chapter 12. Additional reservedNONMEM data item labels are: MRG_, RAW_, and RPT_. See &#9474;Guide VIII for a discussion of these items.&bull; Reserved PREDPP data item labels are: TIME, EVID, AMT,RATE, SS, II, ADDL, CMT, PCMT, CALL, and CONT. Theyare discussed in Section 7 of this chapter and inSection 2.4 of Chapter 12. Additional reserved PREDPP &#9474;data items are the extra EVID labels, XVID1, XVID2, &#9474;XVID3, XVID4, and XVID5. See Guide VIII for a &#9474;discussion of these items.&bull; Reserved NM-TRAN data item labels are: DATE, DAT1,DAT2, DAT3, and L1. DATE, DAT1, DAT2, and DAT3 arediscussed in Section 10.1 of this chapter; L1 isdiscussed in Section 4.2 of Chapter 12.If you do not want to use the reserved label, you can supplytwo labels: the reserved label and a &quot;synonym&quot;. Eitherlabel can be used in subsequent records, but only thesynonym will appear in NONMEM output. For example,$INPUT PNO=ID,CONC=DV,DOSE=AMT,WT,....The first three data items are given the labels PNO, CONC,and DOSE. These labels are synonyms for the NONMEM dataitems ID and DV and for the PREDPP data item AMT. The lastdata item is given the label WT and is not a reserved dataitem; it is an example of fixed effect (&quot;concomitant&quot;) dataWhen $PK and $ERROR records are present, certain labels maynot be used at all as data item labels. These are: thelabels for the basic and additional PK parameters for thepharmacokinetic model, as listed in Appendices 1 and 2(e.g., for ADVAN1 and TRANS2: CL, V, S1, S2, F1, F0), andspecific labels for the arguments of the PK and ERRORsubroutines: IDEF, IREV, N, GG, IRGG, HH, and G.5.3. Dropping Data Items via DROPIf no format specification is included on the $INPUT record,then another synonym, DROP, may be used with any data item.DROP may be used as a synonym more than once. It identifiesdata items to be dropped (i.e. eliminated) from the NM-TRANdata set by the Data Preprocessor while constructing theNONMEM data set. This provides a way to limit the number ofdata items in the NONMEM data set and to eliminatenon-numeric data items.6. NONMEM Data Items6.1. DV Data ItemThere must always be a Dependen_________ Variabl________ dat____ ite____ labeledDV. This is a value of an observation. There can be onlyone DV data item per data record. The position of the DVdata item (and the ones described below) is not important.However, its position must be the same on all records.6.2. ID Data Item for Population DataWhen the data is from a population, NONMEM expects theIdentificatio______________ dat____ item_____ labeled ID, and expects the datato be organized into two or more &quot;individual records&quot;. Anindividua__________ recor______ is a group of contiguous data recordshaving the same value for the ID data item and presumablycontaining data from the same individual. ID data itemvalues need not be consecutive, increasing, unique, norbegin with 1. E.g., 3, 5, 6, 10, 3, etc. is a possiblesequence of ID values. Note the two instances of 3 as IDdata item values. As long as these two instances areseparated by different ID data item values (e.g. 5, 6, 10),they represent different individuals.6.3. MDV data itemIf there are records in an input data set which do notcontain values of observations, then NONMEM needs to beinformed of this fact. This is done using the Missin_______Dependen_________ Variabl________ dat____ ite____ labeled MDV. The values of MDVare:0 The DV data item of the data record contains a value ofan observation. The record is referred to as anobservatio___________ record_______1 The DV data item of the data record does not contain avalue of an observation.NONMEM limits the number of observation records per &#9474;individual record to 250. To change this limit, see UsersGuide III.When PREDPP is used, the Data Preprocessor is able torecognize which records contain observed values and which donot, and it can supply the MDV data item if it is notalready present in the data set, i.e. if the label MDV doesnot occur in the $INPUT record. (When PREDPP is not used,the Data Preprocessor cannot do this.)7. PREDPP Data Items7.1. TIME Data ItemPREDPP will in general need theTim____ dat____ item_____ labeled TIME. The value of TIME must benon-negative. Within an individual record, values of TIMEmay not decrease. (Exceptions exist for reset andreset-dose events; see Section 7.3.) The units are optional(e.g., minutes or hours), but should be consistent withother units used in the problem. The TIME of the firstevent record may be zero or non-zero. (If non-zero, thenPREDPP in effect subtracts this value from all other TIMEvalues within the same individual record, so that PREDPPalways works with relative time values.) The DataPreprocessor permits TIME to be expressed as clock time(e.g., 8:30, representing the time, half-past 8 o&rsquo;clock).Such times are converted by the Data Preprocessor intorelative times. Details are given in Section 10.1 below.7.2. AMT, RATE, SS, II: Dose-related Data ItemsDoses are described using one or more of these four dataitems, depending on the kind of dose. A detailed discussionof these data items and of dose records in general isdeferred to Section 8 below.7.3. EVID Data ItemWhen PREDPP is used, all data records are also called even_____records________ Every event record must contain an Even_____Identificatio______________ dat____ ite____ identifying the kind of eventdescribed by the record, and labeled EVID. The values ofEVID and the five kinds of event records are:0 Observation event. This record contains an observedvalue (in the DV data item). Dose-related data itemssuch as RATE and AMT must be 0.1 Dose event. This record describes a dose. Thecontents of the DV data item are ignored.2 Other event. This record is used for a variety ofpurposes. It can be used to obtain a predicted valueat a point in time at which no actual observation ordose event took place; it can be used to turn acompartment off or on at a point in time; it can beused to mark a time at which a change in aphysiological data item (e.g. weight) occurs (as wellas give the new value of the data item). Dose-relateddata items must be 0. The contents of the DV data itemare ignored.3 Reset event. This record is used to reset the kineticsystem at some point in time, without actually startinga new individual record: time is set to whatever timeappears in the event record, the amounts in eachcompartment are set to zero, prior doses are cancelled,and the on/off status of each compartment is set to itsinitial status. It is in all other respects identicalto an other event type record. It is typically usedwithin an individual record, when the individual had acourse of drug treatment, followed by a wash-outperiod, followed by another course of drug treatment.It should appear prior to the start of the secondcourse.4 Reset-dose event. This record combines EVID types 3(reset) and 1 (dose). First the system is reset, andthen a dose is introduced. It is in all other respectsidentical to an ordinary dose event type record.If only dose and observation event records are present inthe NM-TRAN data set, and if EVID is not already present inthe data set (i.e. EVID does not appear in the INPUTrecord), then EVID will be supplied automatically by theData Preprocessor. This is what was done in the examples ofChapter 2. If other or reset type event records are presentin the data set, then the $INPUT record must include theEVID data item, and the data set must include theappropriate values for EVID on all the data records.7.4. CMT and PCMT Data ItemsThe Compartmen___________ dat____ ite____ (CMT) and Predictio__________ Compartmen___________dat____ ite____ (PCMT) are similar. Both contain the number of acompartment in the model. (Compartments and compartmentnumbers are discussed in Chapter 7 and Appendix 1, as aredefault compartments. It may help to look at Chapter 7 andAppendix 1 at this time.) If CMT or PCMT is not defined inthe data set (i.e., not listed in the $INPUT record), or hasthe value 0 on a given event record, the appropriate defaultcompartment is used, except as noted below. This is whatwas done in the examples of Chapter 2. The meaning of thetwo data items depends on the particular kind of eventrecord.&bull; Observation event: CMT specifies the compartment fromwhich the predicted value of the observation isobtained. PCMT is ignored. When CMT specifies theoutput compartment, it is allowed to have a negativesign (e.g., with the One-compartment model, CMT may be-2). This signals that after the prediction iscomputed the output compartment is to be turned off,i.e. the amount in the compartment is to be set tozero. The amount remains zero until the compartment issubsequently turned on. This is quite useful withurine observations; see Section 9 below.&bull; Dose event: CMT specifies the compartment into whichthe dose is introduced. The compartment is turned onif it was previously off. PCMT specifies thecompartment for which a predicted observation iscomputed. This predicted value is not associated withan observation, but it can be useful because it willappear in tables or scatterplots.&bull; Other event: A positive value of CMT specifies that thecompartment is to be turned on if it is off. Anegative value of CMT specifies that the compartment isto be turned off if it is on. (If CMT is 0, nocompartment is turned on or off.) PCMT is the same asfor dose events.&bull; Reset event: CMT is ignored. PCMT is the same as fordose events.&bull; Reset-dose event: CMT and PCMT are the same as for doseevents.7.5. CALL Data ItemThe Cal____ dat____ ite____ (CALL) is used to force a call to eitheror both of the PK and ERROR subroutines with the eventrecord when such a call would not normally occur. A call tothe PK or ERROR subroutine causes the code specified by the$PK or $ERROR records, respectively, to be executed with theevent record. This is discussed in Chapters 7 ($PK) and 8($ERROR).) When not defined in the data set, CALL isassumed to be 0 always. The values are:0 No forced call; PREDPP takes its normal action.1 Force a call to ERROR.2 Force a call to PK.3 Force a call to both PK and ERROR.10 Force a call to ADVAN9. May be combined with other &#9474;values. E.g., the value 12 means &quot;Force a call to PK &#9474;and to ADVAN9&quot;.8. Describing Doses to PREDPPDoses are described using one or more of the data itemsdiscussed below. A detailed discussion of the actual kindsof doses that PREDPP recognizes follows in Section 8.2,including a precise definition of what is meant by the term&quot;steady-state dose&quot; (Section 8.2.3). A data item that isnot needed to describe the kinds of doses used in the studyneed not be defined in the data set; it will in effectalways have the value 0. Only AMT (Dose amount) was used inthe examples of Chapter 2, for example. The values ofdose-related data items should be 0 for non-dose events andfor those dose events to which they are not relevant.8.1. Dose-related Data ItemsAMT data itemThe Amoun______ dat____ ite____ (AMT) gives the amount of a bolus doseor of an infusion of finite duration. This amount should bea positive number.RATE data itemThe Rat____ dat____ ite____ (RATE) gives the rate of an infusion.This rate should be a positive number. (Negative values arediscussed in Chapter 12, Section 2.3.)SS data itemThe Steady-stat____________ dat____ ite____ (SS) can take four values. &#9474;0 This record does not describe a steady-state dose.1 This record describes a steady-state dose. If this isnot the first event record for the individual, then thesystem is first reset as if by a reset event record(except that the on/off status of the compartments isunchanged from what it was prior to the event recordand the time on the event record must not be less thanthe time on the previous event record). Thecompartment amounts are then computed usingsteady-state kinetic formulas.2 This record describes a steady-state dose. No reset ofthe kinetic system occurs. Compartment amounts arecomputed using steady-state kinetic formulas and arethen added to the amounts already present at the eventtime. The use of SS=2 will be discussed further inSection 8.2.7, below. &#9474;3 This record describes a steady-state dose. It is &#9474;exactly like a steady-state dose with SS data item = 1, &#9474;except that existing compartment amounts and &#9474;derivatives are retained and used as initial estimates. &#9474;The computed steady-state levels replace these &#9474;compartment amounts and derivatives. This value of SS &#9474;may be specified only with SS6 and SS9 (the General &#9474;Nonlinear Models).II data itemThe Interdos_________ Interva________ dat____ ite____ labeled II gives the timebetween implied doses (see Section 8.2.3 and Chapter 12,Section 2.4). For a steady-state infusion, it should be 0.For other steady-state doses, it should be a positive numberwhose units are the same as the TIME data item.8.2. Different Kinds of DosesAny of the doses described here may be introduced into anycompartment of the model except the output compartment.Examples are given below that are fragments of data records,identifying the data items of interest and showing theircontents on the dose record. The units of various dataitems are presumed to be appropriate for some actual data.8.2.1. Instantaneous Bolus DosesAll the examples in Chapter 2 involve instantaneous bolusdoses, which we shall refer to simply as bolus doses.(There is also such a thing as a &quot;zero-order bolus dose&quot;,see Chapter 12, Section 2.3.) These are dose records havingAMT&gt;0, RATE=0 and SS=0. (Recall that if RATE and SS arenot defined on the $INPUT record, they are effectively 0.)If the $PK record computes a bioavailability fractionparameter for the compartment into which the dose isintroduced, then the contents of the AMT data item ismultiplied by the current value of this parameter before theamount is added to the compartment. A bolus dose enters thedose compartment immediately; the predicted (scaled) amountin the dose compartment, if displayed in a table orscatterplot, will include the dose.Example:TIME AMT4. 10.This is a dose of 10 to be added to the default dosecompartment at time 4.A bolus dose to the central compartment might be interpretedas an IV bolus dose; to the depot it might be an oraltablet; to a peripheral compartment it might be anintra-muscular injection.8.2.2. InfusionsInfusions are doses having AMT&gt;0 and RATE&gt;0. The durationof the infusion is computed by PREDPP by dividing the AMT bythe RATE. As with bolus doses, AMT is first multiplied bythe bioavailability parameter for the dose compartment, ifany. There is no explicit &quot;end of infusion&quot; record. Drugamounts in the system cannot be affected in a detectable wayat the time an infusion begins by any drug introduced by theinfusion; the predicted (scaled) amount in the dosecompartment, if displayed in a table or scatterplot, willnot include the dose. Infusions may overlap. That is,subsequent dose records may start new infusions before oldones have finished. It is not an error if an infusion&rsquo;sduration is so large as to extend beyond the time of thelast event record for the individual; the remainder of thedrug is ignored. A reset or reset-dose event, or asteady-state dose event with SS=1, will also terminate anyinfusions in progress.Example:TIME AMT RATE4. 10. 2.The duration of the infusion will be computed as 10./2., andso the infusion, which begins at time 4, will terminate attime 9. (=4.+5.).An infusion to the central compartment might be interpretedas an IV infusion; to the depot it might be a sustainedrelease tablet; to a peripheral compartment it might be animplant or skin patch which releases drug at a knownconstant rate. It is possible for NONMEM-PREDPP to estimatethe input rate of a constant-rate drug delivery system (seeChapter 12, Section 2.3).8.2.3. Steady-State DosesA steady-state dose can be regarded as the last one of aseries of doses just like the one specified in the doseevent record, which have been given at a regular interdoseinterval since time , and such that they have led to asteady-state periodic pattern of drug amounts in the systemby the time this last dose has been administered. The dosesof similar kind that precede it are called implie_______ doses______because their existence is not described by separate doserecords in the data set, but rather is implied by thedescription of the single steady-state dose. By stipulatingthat a dose is a steady-state dose, the user instructsPREDPP to update the drug amounts in the system at the timethe dose is given by using steady-state kinetic formulas.This can take less computational time than using separatedose records to describe the implied doses and usingtransient kinetic formulas to advance the system from onedose time to the next (as well as requiring fewer doserecords). The formulas used to compute the steady-stateamounts at the time the steady-state dose is introduced usethe values of the basic and additional pharmacokineticparameters in effect at this time; any values in effect atearlier times are ignored. Moreover, when using asteady-state dose, the user is assuming that underreasonable values of the pharmacokinetic parameters,steady-state is in fact effectively reached by the time thedose is introduced; PREDPP does not check this assumption.The output compartment must be off when a steady state doserecord is encountered in the data set.8.2.4. Steady-State with Multiple Bolus DosesThese are dose events having AMT&gt;0, RATE=0, SS=1, and II&gt;0.The II data item (interdose interval) tells how many timeunits apart the doses were given. As with non-steady-statebolus doses, AMT is first multiplied by the bioavailabilityparameter for the dose compartment, if any.Figure 6.3 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.3. Steady-state with multiple bolus doses. Thedose is given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT SS II8 10. 1 12Here, an infinite number of bolus doses, 10 units each, areassumed to have been given 12 hours apart, with the last ofthese given at time 8AM, at which time steady-state isreached. The fact that TIME is 8 has no effect on thecomputed amounts, but is important in relation to therecords that follow. Steady-state levels can be predictedat any time between the time on the dose record (8) and theend of the succeeding interdose interval (12) (providedthere are no further doses introduced during this interval).If another (steady-state or non-steady-state) dose just likethe steady-state one is introduced at time 20, thenpredictions in the interdose interval following this timewill also be steady-state levels.8.2.5. Steady-State with Multiple InfusionsThese are dose events having AMT&gt;0, RATE&gt;0, SS=1, and II&gt;0.Each such event describes the last of a series of regularlyspaced infusions, all of the same amount and rate. As witha non-steady-state infusion, the duration of each infusionis given by AMT/RATE. The bioavailability fraction appliesto each infusion of the series.Figure 6.4 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.4. Steady-state with multiple infusions. The doseis given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT RATE SS II16 10. 5. 1 6Here, infusions, each 10 units and of duration 2 (=10/5),are assumed to have been given 6 hours apart, with the lastof these started at time 4PM, at which time steady-state isreached. The daily dose times were 4 AM, 10 AM, 4 PM, and10 PM. Again, the value of TIME has no effect on thecomputed amounts but is important in relation to the recordsthat follow. Steady-state levels can be predicted betweentimes 16 (4 PM) and 22 (10 PM) (provided there are nofurther doses introduced during this interval).8.2.6. Steady-State with Constant InfusionThese are dose events having AMT=0, RATE&gt;0, SS=1, and II=0.Such an event consists of infusion with the stated rate,starting at time , and ending at the time on the doseevent record. Bioavailability fractions do not apply tothese doses.Figure 6.5 shows how drug levels vary with time.Figure 6.5. Steady-state with constant infusion.Steady-state level can be predicted only at time t.Example:TIME RATE SS16 2. 1Here, a steady-state infusion at rate 2 is specified asending at 4 PM. A steady-state level can be predicted onlyat this time.8.2.7. Multiple Steady-State DosesDoses with SS=2 are exactly like doses with SS=1. Doseswith SS=2 are similar to non-steady-state doses in thatcompartment amounts are computed in two steps. First,compartment amounts are computed at the time on the doseevent record based on the prior dosing history of thesystem. Second, steady-state amounts are computed from thedosing information on the record and added to the existingcompartment amounts. Thus, if the kinetics are linear, thisresults in an application of the superposition principlewherein the amounts in the system resulting from dosesdescribed by dose event records preceding the time of thesteady-state dose are superposed on the (steady-state)amounts in the system resulting from the steady-state doseand the implied doses.As with any steady-state dose, the steady-state amounts areobtained using the values of the pharmacokinetic parameterscomputed from the information on the steady-state doserecord. In the case that SS=2, though, if these valuesdiffer from those computed from the information on theprevious dose record(s), then the compartment amounts at thetime in the steady-state dose record are not trulysteady-state amounts, and the computed steady-state levelsare not valid predictions. PREDPP will not detect thiserror. We emphasize that superposition is only valid withlinear kinetic systems; all the kinetic systems (ADVANs)discussed in this text are linear.SS=2 records can be used to achieve the specification ofcomplicated dosing regimens. For example, Figure 6.6 showshow drug levels vary with time when two different doses arealternated. In this illustration, two steady-state dosesare specified, each with interdose interval I and with timebetween the two steady-state doses equal to I/2. Even morecomplex patterns are possible.Figure 6.6. Multiple steady-state doses. Two separatesteady-state doses are given. As pictured, they are eachbolus doses, but they do not have to be. The first doseevent record is at time t. The second dose event record isat time t+I/2. They each have interdose interval I.Steady-state levels can be predicted between times t+I/2 andand t+I.Example:TIME AMT SS II8 10. 1 2420 15. 2 24This describes the following dosing regimen: a dose of 10units every morning at 8 AM and a dose of 15 units everyevening at 8 PM (20 hours is 12 hours past 8). Note thatsteady-state is not truly established until after the seconddose record; any observation events interposed between thetwo dose records will reflect only the first steady-statedosage (i.e., 10 units every 8 AM). Another way to achievethe same steady-state is by the following:Example:TIME AMT SS II20 10. 1 1220 5. 2 24This describes doses of 10 units every 12 hours, the last ofwhich is given at 8 PM (i.e. at 8 AM and 8 PM daily), plusadditional doses of 5 units at 8 PM daily. In bothexamples, the steady-state levels can be predicted from time20 hours to time 32 hours.8.2.8. Combining Non-Steady-State Doses with Steady-StateDosesNon-steady-state dose records may appear before, among, orafter steady-state dose records. Such a dose record mayoccur before a steady-state dose record to reflect atransient dose given among a series of regular doses leadingto steady-state, but which is not a part of this series.E.g., a patient who has been maintained at steady-statetakes an extra dose by mistake shortly before hisappointment. A non-steady-state dose record may occur aftera steady-state dose record in order to continue the patternof doses beyond the steady-state dose. Ordinarily,steady-state levels can only be predicted between , thetime on the steady-state dose record, and , the sum ofand the interdose interval. If it is not only necessary tocompute a steady-state prediction between and , butalso after , then there must also occur one or morenon-steady-state dose records at , , etc. with dosesjust like the steady-state dose. (The &quot;additional doses&quot;data item, labeled ADDL, is especially useful for thispurpose; see Chapter 12, Section 2.4.)Example:TIME AMT SS II8 10. 1 2420 15. 2 2432 10. 0 044 15. 0 0Here, the last two records continue the steady-state patternof the first two. Steady-state levels may be predictedbetween times 20 and 56.Similarly, a steady-state constant infusion may be extendedwith a non-steady-state infusion. In the example below,steady-state levels can be predicted from time 0 to time100.TIME RATE AMT SS0 30 0. 10 30 3000. 09. The Output Compartment: Urine Collections andObservationsIn this section we show how urine collections andobservations of urine concentration, , can be described.The first-time reader may prefer to return to this sectionafter reading Section 4.3.3 of Chapter 7. As an example,consider the one-compartment model with first-orderabsorption (ADVAN2). The sequence of events is:6:00 AM A bolus dose of 100 is given.8:00 AM A urine collection is started.9:30 AM and urine volume (UVOL) are measured and anew collection is started.11:45 AM , , and urine volume are measured.The $INPUT record is:$INPUT ID TIME EVID UVOL DV CMT AMTThe data records appear as follows:ID TIME EVID UVOL DV CMT AMT1 6.00 1 0 0 1 1001 8.00 2 0 0 3 01 9.50 0 75 .058 -3 01 9.50 2 0 0 3 01 11.75 0 100 .067 -3 01 11.75 0 100 5.80 2 0Notice that urine collections start with an other type eventrecord (EVID=2) whose CMT contains the number of the outputcompartment, the effect of which is to turn this compartmenton at 8AM, i.e. to begin accounting for the amount of drugappearing in this compartment from 8AM. Because other typeevent records are included, the EVID data item must bepresent in the data. The CMT data item must be present inall event records since it is needed to refer to the outputcompartment in at least one record. Care must be taken touse correct values for the CMT data item; default valuesused when this data item is not present are not relevant inthis case. The DV value on the observation record at 9:30is the measured . Because the value of CMT is negative,the output compartment is also turned off at 9:30. Sincethe collection is to continue, the compartment must beexplicitly turned on again (the fourth record). Note thatUVOL is recorded on both observation records at time 11:45.Strictly speaking, it need only be recorded on the second( observation). This point is discussed further inChapter 7, Section 4.3.3.10. The Data PreprocessorThis section discusses in more detail the ways in which theData Preprocessor can modify data, and discusses when aformat specification should be included in the $DATA record.10.1. Day-time Translation10.1.1. TIME Data ItemSometimes the data contains clock times hh:mm (e.g., thetime 1:30 PM is recorded as 13:30). These times must beconverted to decimal-valued times (e.g., 13.5). The DataPreprocessor can perform this task when it is processingunformatted data. Within an individual record, the DataPreprocessor replaces the TIME value in the first datarecord with 0, and then replaces subsequent records&rsquo; TIMEvalues with the relative time (i.e., the number of hourselapsed since the first record). (The TIME value is alsoreset to 0 on a reset (EVID=3) or reset-dose (EVID=4)record.) Here is an example of relative time calculation:Contents of original file: Contents of new file:ID TIME ID TIME1 9:15 1 0.001 9:30 1 0.251 10 1 0.751 14:40 1 5.421 32.5 1 23.252 8 2 0.002 8.0 2 0.002 44:50 2 36.832 58 2 50.00The presence of the colon &quot;:&quot; in the TIME data item of atleast one record of the data causes the Data Preprocessor toconvert all the TIME values to elapsed values. Elapsedtimes are also called relativ________ times______ Note that recordeddata (lines 5, 8, and 9 of the original file) spanned morethan one day. The user had to add 24 to the TIME values oneach day subsequent to the first to communicate the correcttimes to the Data Preprocessor.10.1.2. DATE Data ItemHere is another way the above data could have been recorded,using a data item called DATE whose value is 1 for the firstday, 2 for the second day, and so on. This allows TIMEvalues to be recorded more naturally using values in therange 0-24.Contents of original file: Contents of new file:ID DATE TIME ID DATE TIME1 1 9:15 1 1 0.001 1 9:30 1 1 0.251 1 10 1 1 0.751 1 14:40 1 1 5.421 2 8.5 1 2 23.252 1 8 2 1 0.002 1 8.0 2 1 0.002 2 20:50 2 2 36.832 3 10 2 3 50.00The DATE data item is of significance only to the DataPreprocessor; NONMEM-PREDPP will not make use of it. Evenif there are no &quot;:&quot; characters among the TIME values, theexistence of a DATE data item will cause the DataPreprocessor to replace TIME values by relative times.10.1.3. Calendar DatesThe Dat____ dat____ ite____ (DATE) can also be used to recordcalendar dates in month-day-year format. Any alphabeticcharacter (e.g., / or -) can be used to separate thecomponents. Here is a third way the same example could berecorded:Contents of original file: Contents of new file:ID DATE=DROP TIME ID TIME1 10-1-86 9:15 1 0.001 10-1-86 9:30 1 0.251 10-1-86 10 1 0.751 10-1-86 14:40 1 5.421 10-2-86 8.5 1 23.252 10-12 8 2 0.002 10-12 8.0 2 0.002 10-13 20:50 2 36.832 10-14 10 2 50.00This example illustrates two features. First, when calendardates are used, the DATE item should be specified as&quot;DATE=DROP&quot;, so that the data item is omitted from the newdata file (see Section 5.3). Otherwise, the alphabeticcharacters which separate the components will cause readerrors when NONMEM reads the data. Second, the year valueis optional; only month and date were actually needed.(Within a single individual record, however, either alldates should specify a year, or none should.)Data labels DAT1, DAT2, and DAT3 are also recognized by theData Preprocessor and can be used instead of DATE. Thelabel given to the Date data item describes its format:DATE month day yearDAT1 day month yearDAT2 year month dayDAT3 year day monthIf only one of the three components is present, it isassumed to be the day&dagger;.<cite>&dagger; In this case only, the Date data item may be zero ornegative. Day -1 means one day prior to day 0. </cite>If only two components are present, they are assumed to bemonth and day (with DATE and DAT2) or day and month (withDAT1 and DAT3). The year may be omitted or given as 1, 2,3, or 4 digits. &#9474;10.1.4. Converting Hours to Days &#9474;The units of the relative TIME values resulting from the &#9474;Data Preprocessor&rsquo;s day-time translation are hours. If the &#9474;correct units for relative time should be days, then the &#9474;TRANSLATE option of the $DATA record may be used to request &#9474;that hours to be converted to days. For example, &#9474;$DATA filename TRANSLATE(TIME/24) &#9474;or &#9474;$DATA filename TRANSLATE(TIME/24.000) &#9474;With the former, values of TIME have two significant digits, &#9474;e.g., xxxx.xx. With the latter, they have three &#9474;significant digits, e.g., xxxx.xxx. &#9474;10.1.5. The Year 2000 - LAST20 &#9474;The user may supply 4 digit years starting (e.g.) &quot;19&quot; and &#9474;&quot;20&quot;, and such dates are processed correctly. (Three digit &#9474;years &quot;000&quot;-&quot;999&quot; are permitted, but would represent exactly &#9474;those years, and should not normally be used.) If the year &#9474;is omitted, it is assumed to be a non-leap year. A problem &#9474;arises when the year supplied, but has only 1 or 2 digits. &#9474;Such years are assumed by default to be in the 1900&rsquo;s. If &#9474;this is not a correct assumption, two errors may be made by &#9474;the Data Preprocessor when computing relative times. First, &#9474;1900 was not a leap year, but 2000 is a leap year. Hence, &#9474;if consecutive dates in a data file are 02-28-00 and &#9474;03-01-00 (signifying February 28 and March 1, 2000), an &#9474;elapsed time of 24 hours, rather than 48 hours, is computed. &#9474;Second, if consecutive dates have years 99 and 00, the &#9474;computed elapsed time is negative and an error message is &#9474;generated. &#9474;With NONMEM V and later versions there is a constant LAST20. &#9474;The value of LAST20 is a 2 digit number nn that specifies &#9474;the highest 2-digit year that is assumed to be in the 21st. &#9474;century, i.e., to represent 20nn rather than 19nn. For &#9474;example, with LAST20=50, then 1 and 2 digit years are &#9474;interpreted as follows: &#9474;00-50 represents 2000-2050 &#9474;51-99 represents 1951-1999 &#9474;The elapsed time between 02-28-00 and 03-01-00 is calculated &#9474;to be 48 hours, and the elapsed time calculated between the &#9474;years 99 (1999) and 00 (2000) is positive. &#9474;There are two ways that a value for LAST20 can be specified. &#9474;First, when NM-TRAN is installed, a value is given to &#9474;constant LAST20 in TrGlobal.f90 (in the resource directory): &#9474;DATA LAST20 &#9474;The default value of this constant in the distribution &#9474;medium is 50. Please ask your system support department if &#9474;they modified the LAST20 constant when NM-TRAN was &#9474;installed. &#9474;Regardless of what value was assigned to the LAST20 constant &#9474;in TrGlobal.f90, there is an option LAST20 of the $DATA &#9474;record that may be used to specify the value of the constant &#9474;for the current run. For example: &#9474;$DATA filename LAST20=50 &#9474;This insures that all 1 and 2 digit years are interpreted as &#9474;above (2000-2050; 1951-1999). &#9474;10.1.6. Leap Year Warning - LYWARN &#9474;There may be two circumstances such that 1 or 2 digit years &#9474;are recorded as 00, 01, ... (equivalently, 0, 1, ...). &#9474;First, these may represent the years 2000, 2001, etc. Or, &#9474;they may represent years 0, 1, etc., of a study. Suppose &#9474;the latter is the case, and that none of the years of the &#9474;study was a leap year. Then if LAST20 is set to a value &#9474;greater than -1, the year 0 is assumed incorrectly to be the &#9474;leap year 2000, and elapsed times may be computed &#9474;incorrectly. The Data Preprocessor issues a warning message &#9474;under the following circumstances: &#9474;1) The year is recorded as &quot;00&quot; or &quot;0&quot;, &#9474;2) The value of LAST20 is greater than -1 by default (so &#9474;that the year is understood to be 2000), and &#9474;3) The LAST20 option of the $DATA record was not used to &#9474;modify LAST20 for this run. &#9474;The warning message is as follows: &#9474;(DATA WARNING 3) RECORD 3, DATA ITEM 3: 01-01-00 &#9474;THE YEAR IS ASSUMED TO BE 2000 (A LEAP YEAR). IF THIS IS INCORRECT, USE&#9474;$DATA&rsquo;S LAST20 OPTION TO OVERRIDE THE DEFAULT VALUE OF LAST20 IN NMTRAN&rsquo;S&#9474;ABLOCK, OR CHANGE THE DEFAULT: 50 &#9474;Suppose these warning messages are appropriate, that is, &#9474;year &quot;00&quot; (or &quot;0&quot;) should not be a leap year. The LAST20 &#9474;option of the $DATA record may be used to specify that such &#9474;years are in the 1900&rsquo;s for the current data set: &#9474;$DATA filename LAST20=-1 &#9474;A constant LYWARN is defined in NM-TRAN&rsquo;s ABLOCK module. &#9474;The default value of LYWARN is 1 (&quot;data warning message 3 &#9474;enabled&quot;). If the value of LYWARN is set to 0 (&quot;data &#9474;warning message 3 disabled&quot;) and NM-TRAN is recompiled, then &#9474;the warning message is suppressed for all runs.10.2. Interdose Interval (II) ConversionWhen the input data is unformatted and PREDPP is being used,the Interdose Interval (II) data item is checked for valuescontaining a colon (:). Any such value is assumed to signala clock time hh:mm. The minutes portion is converted to adecimal number containing as many decimal places as digitsin the original. E.g., the value &quot;:30&quot; is replaced by&quot;.50&quot;. This conversion is performed whether or not day-timetranslation is also being done.10.3. Data Items Generated by the Data PreprocessorWhen the data is from a single individual, the DataPreprocessor will almost always generate an ID data item&Dagger;.<cite>&Dagger; Section 4.2 of Chapter 12 discusses the L1 data item,which is used to prevent NM-TRAN from generating anIdentification data item for individual data. </cite>It does this whether or not PREDPP is used. This is donebecause, when the data is from a single individual, the IDdata item must take on very special non-constant values forNONMEM. The generated ID data item is given the label&quot;.ID.&quot; (i.e., ID surrounded by dots). If this data item isto be shown in any NONMEM output (e.g., in a table), it mustbe referred to on subsequent NM-TRAN records by this label.When PREDPP is used, the Data Preprocessor will alwaysgenerate the required EVID data item if it is not alreadylisted on the $INPUT record. (This was discussed in Section7.3 above.)When PREDPP is used, the Data Preprocessor will alwaysgenerate the MDV (Missing Dependent Variable) data item ifit is not already listed on the $INPUT record.These data items are generated by the Data Preprocessorwhether or not a format specification was coded on the$INPUT record. They are appended to the end of each datarecord.10.4. When Must a Format Specification be Included orOmitted?When coding the $DATA record, you will need to decidewhether to include a FORTRAN format specification describingthe data file or to omit it and let the Data Preprocessorconstruct it. Here are some guidelines in making thisdecision.A format specification is required when:Some data values are left blank on some data records,without having the value 0 or . (or a pair of commas)to hold the place of the missing value.Some data values are adjacent on some data records;they are not separated by a space or a comma.The data records span multiple physical records; thatis, the character / is needed in the formatspecification. (The Data Preprocessor may generatesuch a format specification for the NONMEM data set; weare speaking here of the NM-TRAN data set.)A format specification should not be present when:The $INPUT record includes DROP as a data item label orsynonym.Day-time translation is desired.II conversion is desired.Commas are used to separate the data items.The data values are not lined up into columns withuniform width, so that no format specification can bewritten to describe the file.Many data files do not fall in either category. A formatspecification is optional for such files.10.5. Skipping Data ItemsIt is always possible to omit (skip) data items that are notof interest for a given NONMEM run. When a formatspecification is coded, two things must be done: first,replace the data item&rsquo;s specification by an &quot;X&quot;specification (e.g., replace F8.0 by 8X) and second, deletethe data item&rsquo;s label from the $INPUT record. When noformat specification is coded, all that need be done is toreplace the data item&rsquo;s label in the $INPUT record by DROP(or include DROP as a synonym).
<a name="1. What This Chapter is AboutThis chapter tells how to create data for analysis byNONMEM-PREDPP. It tells how to describe the data using$DATA and $INPUT records. The requirements for formattingthe data for NONMEM-PREDPP are somewhat more stringent thanare the requirements for formatting the data for NM-TRAN.The Data Preprocessor is a component of NM-TRAN whichmodifies the data so that it becomes formatted appropriatelyfor NONMEM-PREDPP.2. Data Sets for NONMEM2.1. Data RecordsA data set for NONMEM analysis consists of a series ofrecords (&quot;lines&quot; in the terminology of editing programs).Each record must consist of a fixed number of data items andeach must have the same format. Figure 6.1 shows how such adata set may be pictured. In data base terminology, this isa &quot;flat&quot; structure.Figure 6.1. A NONMEM input data set. Each data record is arow; each type of data item is in a different column.NONMEM imposes no limit on the number of records in the dataset. It does not (nor does PREDPP or NM-TRAN) sort the datarecords before processing them, so the data records mustalready be in the correct sequence. NONMEM itself cannot beinstructed to delete or drop records from the data set, but &#9474;see the DROP and IGNORE options of the $DATA record, below.2.2. Data ItemsNONMEM reads records from the data set with a FORTRAN FORMATspecification, and so each data item must occupy a fixednumber of character positions. Data items are alwaysnumbers. However, if no particular number is appropriatefor a given data item on a given record, the data item iscalled a nul____ dat____ item_____ it may be given the numerical value0 or the nonnumerical value &quot;.&quot;, or left blank. Zero&rsquo;s wereused in the first two lines of the Theophylline example ofChapter 2, which appeared as follows:2 320. 0. 0.2 0. .27 1.71The Data Preprocessor allows each value in the data set tooccupy only as many character positions as it needs, so longas the data items are separated by blanks (spaces) orcommas. Tab characters may also be used as separators if &#9474;they are stored as explicit characters, e.g., ASCII 011, &#9474;although this is platform-dependent and should be tested &#9474;carefully. When there are no commas or tabs, the value &quot;.&quot;or 0 must be used to hold the place of a null data item.The two lines above could have been entered as follows:2 320. 0. 0.2,,.27,1.71(Note the use in the second line of adjacent commas &quot;,,&quot; todenote a null data item.)The contents of the data items must be purely numeric; i.e.,character values such as Y, N, M or F may not be recorded.Instead, numeric codes such as 0 or 1 must be used.With NONMEM VI, the number of data items per data record isgiven by constant PD in file SIZES. The default value is20. With NONMEM 7.1, the default value is 50. With NONMEM7.2, there is no limit on the number of data items per datarecord.2.3. Clinical Data and Data ConversionClinical data often has a &quot;hierarchical&quot; file structure,with (say) two record formats: a patient record, containingfixed information about a patient (ID number, sex, age,prior history of smoking or drug use, etc), followed by oneor more visit records, containing doses and physicalobservations during the course of the study. Visit recordsmay not even contain the same number of items as patientrecords, nor have the same format. The hierarchy is shownschematically in figure 6.2.Patient recordVisit recordVisit record...Patient recordVisit recordVisit record...Figure 6.2. A hierarchical data file. Patient and visitrecords have different formats.NONMEM cannot accept such data. For NONMEM, the (fixed)information on the &quot;patient&quot; record must be copied ontoevery &quot;visit&quot; record, and the &quot;patient&quot; records must beeliminated. This is the user&rsquo;s responsibility and istypically done in a one-time data conversion step using thesystem editor and/or a specially written computer program.If an individual&rsquo;s data is to be deleted because he did notcomplete the study or had an adverse outcome, it should bedone at this time. In addition, numeric codes should besubstituted for alphabetic codes. Clinical data sometimesincludes multi-digit, non-consecutive patient identificationnumbers drawn from some patient identification system. Suchpatient identification numbers can be used with NONMEM asthe identification data item described in Section 6.2.However, it is preferable to append to each patient&rsquo;s datarecords numbers from the sequence 1, 2, 3, ..., for use asthe ID data item. This will make it easier to read ascatterplot which includes ID along one of the axes (e.g.,residual vs ID).When there is a large amount of data, we strongly suggestthat a small amount of data (from one or two individuals) beprepared for NONMEM-PREDPP analysis and a run in which onlytables and scatterplots are output be made to check that thedata is correctly prepared before a great deal of labor isexpended on the remainder.3. Data Sets for PREDPPWhen PREDPP is used with NONMEM, the data must meetadditional requirements. First, PREDPP is concerned withtime-ordered events such as dose events, which introducedrug into the system at particular times, and observationevents, which report observations taken at particular times.PREDPP insists that these events be recorded on separaterecords. That is, dosing information cannot be recorded onthe same record as an observed value. Second, PREDPPrequires that the time of each event be recorded on eachdata record, and that the physical sequence of the datarecords be the same as their sequence in time. (E.g., if adose event immediately precedes an observation event intime, then the dose event record must immediately precedethe observation event record.) Again, neither PREDPP northe Data Preprocessor will physically sort or resequence thedata records.4. The $DATA RecordThe $DATA record describes the characteristics of theexternal data file to be processed by NONMEM. NONMEM is nota data base management system and does not store a data setbetween runs; once a file has been prepared for NONMEM, itmust be re-read each time it is to be analyzed. The firstcharacter string appearing after $DATA is the name of thefile containing the data. Since it is to be used in aFORTRAN OPEN statement, this name may not include embedded &#9474;special characters such as slashes (/ or \), commas, &#9474;semi-colons, parentheses, equal signs or spaces unless it is &#9474;surrounded by single quotes &rsquo; or double quotes &quot;. The &#9474;filename may contain 80 characters. (If a file is to be &#9474;opened by NONMEM rather than by NM-TRAN, the filename may &#9474;not contain embedded spaces, and may contain at most 71 &#9474;characters.) A FORTRAN format specification suitable toread the data may follow the file name; this is optional andcan be supplied by the Data Preprocessor. The choice isdiscussed more fully in Section 10.4 of this chapter.Certain options may be specified if desired. Among theseare:RECORDS=nThis tells the number of records to be read from thedata file. If omitted, the records are read to theend-of-file or to a NONMEM FINISH record (Users GuideII). The RECORDS option may be used to limit NONMEMprocessing to the initial portion of the file and isuseful during the early stages of debugging. &#9474;RECORDS=label &#9474;&quot;Label&quot; is a data item label. The data records for the &#9474;problem will start at the place where the file is &#9474;positioned before data records are read and include all &#9474;contiguous data records having the same value for the &#9474;data item. In particular, the ID label may be used (or &#9474;alternatively, the option may be coded RECORDS=IR, &#9474;RECORDS=INDREC, or RECORDS=INDIVIDUALRECORD) to obtain &#9474;the data for a single individual. &#9474;IR,INDREC,INDIVIDUALRECORD. &#9474;NOREWIND|REWIND &#9474;With the first problem specification in a control &#9474;stream, the file is positioned at its initial point so &#9474;that the first record in the file is used. The options &#9474;REWIND and NOREWIND apply only with a $DATA record in a &#9474;subsequent problem specification. &#9474;REWIND: Reposition the file at the start. &#9474;NOREWIND: Leave the file at its current position so &#9474;that the next record in the file is read. Used when &#9474;the $DATA record with the previous problem &#9474;specification included the RECORDS option so that &#9474;NM-TRAN did not read to a physical end-of-file. This &#9474;is the default.LRECL=nThis tells the length of the physical data records. Itis required if the operating system associates a fixedphysical record length with every disk file andconsiders it a fatal I/O error if a READ commandrequests more characters than the records contain. Ifthis is true of your operating system, the operatingsystem will issue an error message when you first runNM-TRAN without the LRECL option in the $DATA record.WIDE This requests that the NONMEM data set produced byNM-TRAN always contain single-line records, and thatthese records always include at least one space betweendata items. Such a data set can be further processedby other programs. (The default is NOWIDE, in whichcase NM-TRAN limits the records to 80 characters bycreating multi-line records and/or eliminating spacesbetween data items if necessary.) It may not be usedif a FORTRAN format specification is present. It also &#9474;provides an extra character for relative times computed &#9474;by the Data Preprocessor.NULL=cThis requests that the NONMEM data set produced byNM-TRAN contain the character c in place of null dataitems. For example, NULL=0 requests that all null dataitems be replaced by 0. The syntax NULL=&rsquo;c&rsquo; andNULL=&quot;c&quot; is also permitted. The default is NULL=&rsquo; &rsquo;.It may not be used if a FORTRAN format specification ispresent.IGNORE=cThis instructs NM-TRAN to ignore data records havingcharacter c in the first character position (&quot;column1&quot;) of the record. This allows the use of &quot;comment&quot;records in the NM-TRAN data set. The syntax IGNORE=&rsquo;c&rsquo;and IGNORE=&quot;c&quot; is also permitted. It may be used evenif a FORTRAN format specification is present. &#9474;The character @ has a special meaning. It signifies &#9474;that any data record containing an alphabetic character &#9474;(or special characters @ or #) as its first non-blank &#9474;character (not just in column 1) should be ignored. &#9474;Alphabetic characters are the letters A-Z and a-z. &#9474;Thus, a table file produced by NONMEM in an earlier run &#9474;can be used as an NM-TRAN data set. Any header lines &#9474;included in this table can be dropped by specifying &#9474;IGNORE=@. &#9474;When the IGNORE option is omitted, any records &#9474;containing the character # in column 1 are ignored. &#9474;IGNORE=(list), ACCEPT=(list) &#9474;This form of the IGNORE option allows records to be &#9474;dropped based on the values of data items. For example, &#9474;IGNORE=(GEN.EQ.1,AGE.GT.60). &#9474;Records having GEN equal to 1 or AGE greater than 60 &#9474;are dropped. All others are accepted. The ACCEPT &#9474;option allows records to be accepted based on the &#9474;values of data items. See Guide VIII for more &#9474;information. &#9474;&#9474;LAST20=nn &#9474;&quot;nn&quot; is a 2 digit number that specifies the highest &#9474;2-digit year that is assumed to be in the 21st. &#9474;century, i.e., that represents 20nn rather than 19nn. &#9474;See Section 10.1.5 below. &#9474;TRANSLATE &#9474;The translate option must be followed by parentheses &#9474;enclosing a list of one or more translate &#9474;specifications. For example, &#9474;$DATA filename TRANSLATE(TIME/24,II/24) &#9474;Translate specification TIME/24 causes the value of &#9474;TIME to be divided by 24, whether or not day-time &#9474;translation occurs (i.e., whether or not relative times &#9474;are being computed). This has the effect of changing &#9474;the unit of TIME from hours to days. Similarly, &#9474;translate specification II/24 causes the value of II &#9474;(interdose interval) to be divided by 24 whether or not &#9474;&quot;:&quot; appears in any II value. See Section 10.1.4 below.5. The $INPUT RecordThis record describes how many data items there are on eachdata record, the order of the data items, and tells what thelabels of the data items are.5.1. Data Item LabelsA data item label is one to four letters (A-Z) or numerals(0-9). With NONMEM 7 a label consists of 1-24 letters &#9474;(A-Z), numerals (0-9), and the character &rsquo;_&rsquo;. (The length &#9474;24 is specified by constant SDF in SIZES) &#9474;The first character must be a letter. These labels are theones which will be used in other records (such as $PK or$SCATTERPLOT), and will appear in NONMEM&rsquo;s output. Theorder of the data items on the data records is notimportant, but must be the same on all data records in thedata set. In both the examples of Chapter 2, the ID dataitems happened to be the first ones in the data records, andthe DV data items happened to be the last ones. This orderwas arbitrary.5.2. Reserved Labels and SynonymsCertain data item labels are reserved in that they identifydata items which are recognized specifically by NONMEM,PREDPP, or NM-TRAN. The data items they label arethemselves called NONMEM, PREDPP, or NM-TRAN data items,respectively.&bull; Reserved NONMEM data item labels are: ID, L2, DV, andMDV. They are discussed in Section 6 of this chapterand in Section 4.2 of Chapter 12. Additional reservedNONMEM data item labels are: MRG_, RAW_, and RPT_. See &#9474;Guide VIII for a discussion of these items.&bull; Reserved PREDPP data item labels are: TIME, EVID, AMT,RATE, SS, II, ADDL, CMT, PCMT, CALL, and CONT. Theyare discussed in Section 7 of this chapter and inSection 2.4 of Chapter 12. Additional reserved PREDPP &#9474;data items are the extra EVID labels, XVID1, XVID2, &#9474;XVID3, XVID4, and XVID5. See Guide VIII for a &#9474;discussion of these items.&bull; Reserved NM-TRAN data item labels are: DATE, DAT1,DAT2, DAT3, and L1. DATE, DAT1, DAT2, and DAT3 arediscussed in Section 10.1 of this chapter; L1 isdiscussed in Section 4.2 of Chapter 12.If you do not want to use the reserved label, you can supplytwo labels: the reserved label and a &quot;synonym&quot;. Eitherlabel can be used in subsequent records, but only thesynonym will appear in NONMEM output. For example,$INPUT PNO=ID,CONC=DV,DOSE=AMT,WT,....The first three data items are given the labels PNO, CONC,and DOSE. These labels are synonyms for the NONMEM dataitems ID and DV and for the PREDPP data item AMT. The lastdata item is given the label WT and is not a reserved dataitem; it is an example of fixed effect (&quot;concomitant&quot;) dataWhen $PK and $ERROR records are present, certain labels maynot be used at all as data item labels. These are: thelabels for the basic and additional PK parameters for thepharmacokinetic model, as listed in Appendices 1 and 2(e.g., for ADVAN1 and TRANS2: CL, V, S1, S2, F1, F0), andspecific labels for the arguments of the PK and ERRORsubroutines: IDEF, IREV, N, GG, IRGG, HH, and G.5.3. Dropping Data Items via DROPIf no format specification is included on the $INPUT record,then another synonym, DROP, may be used with any data item.DROP may be used as a synonym more than once. It identifiesdata items to be dropped (i.e. eliminated) from the NM-TRANdata set by the Data Preprocessor while constructing theNONMEM data set. This provides a way to limit the number ofdata items in the NONMEM data set and to eliminatenon-numeric data items.6. NONMEM Data Items6.1. DV Data ItemThere must always be a Dependen_________ Variabl________ dat____ ite____ labeledDV. This is a value of an observation. There can be onlyone DV data item per data record. The position of the DVdata item (and the ones described below) is not important.However, its position must be the same on all records.6.2. ID Data Item for Population DataWhen the data is from a population, NONMEM expects theIdentificatio______________ dat____ item_____ labeled ID, and expects the datato be organized into two or more &quot;individual records&quot;. Anindividua__________ recor______ is a group of contiguous data recordshaving the same value for the ID data item and presumablycontaining data from the same individual. ID data itemvalues need not be consecutive, increasing, unique, norbegin with 1. E.g., 3, 5, 6, 10, 3, etc. is a possiblesequence of ID values. Note the two instances of 3 as IDdata item values. As long as these two instances areseparated by different ID data item values (e.g. 5, 6, 10),they represent different individuals.6.3. MDV data itemIf there are records in an input data set which do notcontain values of observations, then NONMEM needs to beinformed of this fact. This is done using the Missin_______Dependen_________ Variabl________ dat____ ite____ labeled MDV. The values of MDVare:0 The DV data item of the data record contains a value ofan observation. The record is referred to as anobservatio___________ record_______1 The DV data item of the data record does not contain avalue of an observation.NONMEM limits the number of observation records per &#9474;individual record to 250. To change this limit, see UsersGuide III.When PREDPP is used, the Data Preprocessor is able torecognize which records contain observed values and which donot, and it can supply the MDV data item if it is notalready present in the data set, i.e. if the label MDV doesnot occur in the $INPUT record. (When PREDPP is not used,the Data Preprocessor cannot do this.)7. PREDPP Data Items7.1. TIME Data ItemPREDPP will in general need theTim____ dat____ item_____ labeled TIME. The value of TIME must benon-negative. Within an individual record, values of TIMEmay not decrease. (Exceptions exist for reset andreset-dose events; see Section 7.3.) The units are optional(e.g., minutes or hours), but should be consistent withother units used in the problem. The TIME of the firstevent record may be zero or non-zero. (If non-zero, thenPREDPP in effect subtracts this value from all other TIMEvalues within the same individual record, so that PREDPPalways works with relative time values.) The DataPreprocessor permits TIME to be expressed as clock time(e.g., 8:30, representing the time, half-past 8 o&rsquo;clock).Such times are converted by the Data Preprocessor intorelative times. Details are given in Section 10.1 below.7.2. AMT, RATE, SS, II: Dose-related Data ItemsDoses are described using one or more of these four dataitems, depending on the kind of dose. A detailed discussionof these data items and of dose records in general isdeferred to Section 8 below.7.3. EVID Data ItemWhen PREDPP is used, all data records are also called even_____records________ Every event record must contain an Even_____Identificatio______________ dat____ ite____ identifying the kind of eventdescribed by the record, and labeled EVID. The values ofEVID and the five kinds of event records are:0 Observation event. This record contains an observedvalue (in the DV data item). Dose-related data itemssuch as RATE and AMT must be 0.1 Dose event. This record describes a dose. Thecontents of the DV data item are ignored.2 Other event. This record is used for a variety ofpurposes. It can be used to obtain a predicted valueat a point in time at which no actual observation ordose event took place; it can be used to turn acompartment off or on at a point in time; it can beused to mark a time at which a change in aphysiological data item (e.g. weight) occurs (as wellas give the new value of the data item). Dose-relateddata items must be 0. The contents of the DV data itemare ignored.3 Reset event. This record is used to reset the kineticsystem at some point in time, without actually startinga new individual record: time is set to whatever timeappears in the event record, the amounts in eachcompartment are set to zero, prior doses are cancelled,and the on/off status of each compartment is set to itsinitial status. It is in all other respects identicalto an other event type record. It is typically usedwithin an individual record, when the individual had acourse of drug treatment, followed by a wash-outperiod, followed by another course of drug treatment.It should appear prior to the start of the secondcourse.4 Reset-dose event. This record combines EVID types 3(reset) and 1 (dose). First the system is reset, andthen a dose is introduced. It is in all other respectsidentical to an ordinary dose event type record.If only dose and observation event records are present inthe NM-TRAN data set, and if EVID is not already present inthe data set (i.e. EVID does not appear in the INPUTrecord), then EVID will be supplied automatically by theData Preprocessor. This is what was done in the examples ofChapter 2. If other or reset type event records are presentin the data set, then the $INPUT record must include theEVID data item, and the data set must include theappropriate values for EVID on all the data records.7.4. CMT and PCMT Data ItemsThe Compartmen___________ dat____ ite____ (CMT) and Predictio__________ Compartmen___________dat____ ite____ (PCMT) are similar. Both contain the number of acompartment in the model. (Compartments and compartmentnumbers are discussed in Chapter 7 and Appendix 1, as aredefault compartments. It may help to look at Chapter 7 andAppendix 1 at this time.) If CMT or PCMT is not defined inthe data set (i.e., not listed in the $INPUT record), or hasthe value 0 on a given event record, the appropriate defaultcompartment is used, except as noted below. This is whatwas done in the examples of Chapter 2. The meaning of thetwo data items depends on the particular kind of eventrecord.&bull; Observation event: CMT specifies the compartment fromwhich the predicted value of the observation isobtained. PCMT is ignored. When CMT specifies theoutput compartment, it is allowed to have a negativesign (e.g., with the One-compartment model, CMT may be-2). This signals that after the prediction iscomputed the output compartment is to be turned off,i.e. the amount in the compartment is to be set tozero. The amount remains zero until the compartment issubsequently turned on. This is quite useful withurine observations; see Section 9 below.&bull; Dose event: CMT specifies the compartment into whichthe dose is introduced. The compartment is turned onif it was previously off. PCMT specifies thecompartment for which a predicted observation iscomputed. This predicted value is not associated withan observation, but it can be useful because it willappear in tables or scatterplots.&bull; Other event: A positive value of CMT specifies that thecompartment is to be turned on if it is off. Anegative value of CMT specifies that the compartment isto be turned off if it is on. (If CMT is 0, nocompartment is turned on or off.) PCMT is the same asfor dose events.&bull; Reset event: CMT is ignored. PCMT is the same as fordose events.&bull; Reset-dose event: CMT and PCMT are the same as for doseevents.7.5. CALL Data ItemThe Cal____ dat____ ite____ (CALL) is used to force a call to eitheror both of the PK and ERROR subroutines with the eventrecord when such a call would not normally occur. A call tothe PK or ERROR subroutine causes the code specified by the$PK or $ERROR records, respectively, to be executed with theevent record. This is discussed in Chapters 7 ($PK) and 8($ERROR).) When not defined in the data set, CALL isassumed to be 0 always. The values are:0 No forced call; PREDPP takes its normal action.1 Force a call to ERROR.2 Force a call to PK.3 Force a call to both PK and ERROR.10 Force a call to ADVAN9. May be combined with other &#9474;values. E.g., the value 12 means &quot;Force a call to PK &#9474;and to ADVAN9&quot;.8. Describing Doses to PREDPPDoses are described using one or more of the data itemsdiscussed below. A detailed discussion of the actual kindsof doses that PREDPP recognizes follows in Section 8.2,including a precise definition of what is meant by the term&quot;steady-state dose&quot; (Section 8.2.3). A data item that isnot needed to describe the kinds of doses used in the studyneed not be defined in the data set; it will in effectalways have the value 0. Only AMT (Dose amount) was used inthe examples of Chapter 2, for example. The values ofdose-related data items should be 0 for non-dose events andfor those dose events to which they are not relevant.8.1. Dose-related Data ItemsAMT data itemThe Amoun______ dat____ ite____ (AMT) gives the amount of a bolus doseor of an infusion of finite duration. This amount should bea positive number.RATE data itemThe Rat____ dat____ ite____ (RATE) gives the rate of an infusion.This rate should be a positive number. (Negative values arediscussed in Chapter 12, Section 2.3.)SS data itemThe Steady-stat____________ dat____ ite____ (SS) can take four values. &#9474;0 This record does not describe a steady-state dose.1 This record describes a steady-state dose. If this isnot the first event record for the individual, then thesystem is first reset as if by a reset event record(except that the on/off status of the compartments isunchanged from what it was prior to the event recordand the time on the event record must not be less thanthe time on the previous event record). Thecompartment amounts are then computed usingsteady-state kinetic formulas.2 This record describes a steady-state dose. No reset ofthe kinetic system occurs. Compartment amounts arecomputed using steady-state kinetic formulas and arethen added to the amounts already present at the eventtime. The use of SS=2 will be discussed further inSection 8.2.7, below. &#9474;3 This record describes a steady-state dose. It is &#9474;exactly like a steady-state dose with SS data item = 1, &#9474;except that existing compartment amounts and &#9474;derivatives are retained and used as initial estimates. &#9474;The computed steady-state levels replace these &#9474;compartment amounts and derivatives. This value of SS &#9474;may be specified only with SS6 and SS9 (the General &#9474;Nonlinear Models).II data itemThe Interdos_________ Interva________ dat____ ite____ labeled II gives the timebetween implied doses (see Section 8.2.3 and Chapter 12,Section 2.4). For a steady-state infusion, it should be 0.For other steady-state doses, it should be a positive numberwhose units are the same as the TIME data item.8.2. Different Kinds of DosesAny of the doses described here may be introduced into anycompartment of the model except the output compartment.Examples are given below that are fragments of data records,identifying the data items of interest and showing theircontents on the dose record. The units of various dataitems are presumed to be appropriate for some actual data.8.2.1. Instantaneous Bolus DosesAll the examples in Chapter 2 involve instantaneous bolusdoses, which we shall refer to simply as bolus doses.(There is also such a thing as a &quot;zero-order bolus dose&quot;,see Chapter 12, Section 2.3.) These are dose records havingAMT&gt;0, RATE=0 and SS=0. (Recall that if RATE and SS arenot defined on the $INPUT record, they are effectively 0.)If the $PK record computes a bioavailability fractionparameter for the compartment into which the dose isintroduced, then the contents of the AMT data item ismultiplied by the current value of this parameter before theamount is added to the compartment. A bolus dose enters thedose compartment immediately; the predicted (scaled) amountin the dose compartment, if displayed in a table orscatterplot, will include the dose.Example:TIME AMT4. 10.This is a dose of 10 to be added to the default dosecompartment at time 4.A bolus dose to the central compartment might be interpretedas an IV bolus dose; to the depot it might be an oraltablet; to a peripheral compartment it might be anintra-muscular injection.8.2.2. InfusionsInfusions are doses having AMT&gt;0 and RATE&gt;0. The durationof the infusion is computed by PREDPP by dividing the AMT bythe RATE. As with bolus doses, AMT is first multiplied bythe bioavailability parameter for the dose compartment, ifany. There is no explicit &quot;end of infusion&quot; record. Drugamounts in the system cannot be affected in a detectable wayat the time an infusion begins by any drug introduced by theinfusion; the predicted (scaled) amount in the dosecompartment, if displayed in a table or scatterplot, willnot include the dose. Infusions may overlap. That is,subsequent dose records may start new infusions before oldones have finished. It is not an error if an infusion&rsquo;sduration is so large as to extend beyond the time of thelast event record for the individual; the remainder of thedrug is ignored. A reset or reset-dose event, or asteady-state dose event with SS=1, will also terminate anyinfusions in progress.Example:TIME AMT RATE4. 10. 2.The duration of the infusion will be computed as 10./2., andso the infusion, which begins at time 4, will terminate attime 9. (=4.+5.).An infusion to the central compartment might be interpretedas an IV infusion; to the depot it might be a sustainedrelease tablet; to a peripheral compartment it might be animplant or skin patch which releases drug at a knownconstant rate. It is possible for NONMEM-PREDPP to estimatethe input rate of a constant-rate drug delivery system (seeChapter 12, Section 2.3).8.2.3. Steady-State DosesA steady-state dose can be regarded as the last one of aseries of doses just like the one specified in the doseevent record, which have been given at a regular interdoseinterval since time , and such that they have led to asteady-state periodic pattern of drug amounts in the systemby the time this last dose has been administered. The dosesof similar kind that precede it are called implie_______ doses______because their existence is not described by separate doserecords in the data set, but rather is implied by thedescription of the single steady-state dose. By stipulatingthat a dose is a steady-state dose, the user instructsPREDPP to update the drug amounts in the system at the timethe dose is given by using steady-state kinetic formulas.This can take less computational time than using separatedose records to describe the implied doses and usingtransient kinetic formulas to advance the system from onedose time to the next (as well as requiring fewer doserecords). The formulas used to compute the steady-stateamounts at the time the steady-state dose is introduced usethe values of the basic and additional pharmacokineticparameters in effect at this time; any values in effect atearlier times are ignored. Moreover, when using asteady-state dose, the user is assuming that underreasonable values of the pharmacokinetic parameters,steady-state is in fact effectively reached by the time thedose is introduced; PREDPP does not check this assumption.The output compartment must be off when a steady state doserecord is encountered in the data set.8.2.4. Steady-State with Multiple Bolus DosesThese are dose events having AMT&gt;0, RATE=0, SS=1, and II&gt;0.The II data item (interdose interval) tells how many timeunits apart the doses were given. As with non-steady-statebolus doses, AMT is first multiplied by the bioavailabilityparameter for the dose compartment, if any.Figure 6.3 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.3. Steady-state with multiple bolus doses. Thedose is given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT SS II8 10. 1 12Here, an infinite number of bolus doses, 10 units each, areassumed to have been given 12 hours apart, with the last ofthese given at time 8AM, at which time steady-state isreached. The fact that TIME is 8 has no effect on thecomputed amounts, but is important in relation to therecords that follow. Steady-state levels can be predictedat any time between the time on the dose record (8) and theend of the succeeding interdose interval (12) (providedthere are no further doses introduced during this interval).If another (steady-state or non-steady-state) dose just likethe steady-state one is introduced at time 20, thenpredictions in the interdose interval following this timewill also be steady-state levels.8.2.5. Steady-State with Multiple InfusionsThese are dose events having AMT&gt;0, RATE&gt;0, SS=1, and II&gt;0.Each such event describes the last of a series of regularlyspaced infusions, all of the same amount and rate. As witha non-steady-state infusion, the duration of each infusionis given by AMT/RATE. The bioavailability fraction appliesto each infusion of the series.Figure 6.4 shows how drug levels vary with time. Theconcentration-time profiles over each interdose intervallook the same since, in principle, there is an infinitenumber of implied doses.Figure 6.4. Steady-state with multiple infusions. The doseis given at time t. The interdose interval is I.Steady-state levels can be predicted between times t andt+I.Example:TIME AMT RATE SS II16 10. 5. 1 6Here, infusions, each 10 units and of duration 2 (=10/5),are assumed to have been given 6 hours apart, with the lastof these started at time 4PM, at which time steady-state isreached. The daily dose times were 4 AM, 10 AM, 4 PM, and10 PM. Again, the value of TIME has no effect on thecomputed amounts but is important in relation to the recordsthat follow. Steady-state levels can be predicted betweentimes 16 (4 PM) and 22 (10 PM) (provided there are nofurther doses introduced during this interval).8.2.6. Steady-State with Constant InfusionThese are dose events having AMT=0, RATE&gt;0, SS=1, and II=0.Such an event consists of infusion with the stated rate,starting at time , and ending at the time on the doseevent record. Bioavailability fractions do not apply tothese doses.Figure 6.5 shows how drug levels vary with time.Figure 6.5. Steady-state with constant infusion.Steady-state level can be predicted only at time t.Example:TIME RATE SS16 2. 1Here, a steady-state infusion at rate 2 is specified asending at 4 PM. A steady-state level can be predicted onlyat this time.8.2.7. Multiple Steady-State DosesDoses with SS=2 are exactly like doses with SS=1. Doseswith SS=2 are similar to non-steady-state doses in thatcompartment amounts are computed in two steps. First,compartment amounts are computed at the time on the doseevent record based on the prior dosing history of thesystem. Second, steady-state amounts are computed from thedosing information on the record and added to the existingcompartment amounts. Thus, if the kinetics are linear, thisresults in an application of the superposition principlewherein the amounts in the system resulting from dosesdescribed by dose event records preceding the time of thesteady-state dose are superposed on the (steady-state)amounts in the system resulting from the steady-state doseand the implied doses.As with any steady-state dose, the steady-state amounts areobtained using the values of the pharmacokinetic parameterscomputed from the information on the steady-state doserecord. In the case that SS=2, though, if these valuesdiffer from those computed from the information on theprevious dose record(s), then the compartment amounts at thetime in the steady-state dose record are not trulysteady-state amounts, and the computed steady-state levelsare not valid predictions. PREDPP will not detect thiserror. We emphasize that superposition is only valid withlinear kinetic systems; all the kinetic systems (ADVANs)discussed in this text are linear.SS=2 records can be used to achieve the specification ofcomplicated dosing regimens. For example, Figure 6.6 showshow drug levels vary with time when two different doses arealternated. In this illustration, two steady-state dosesare specified, each with interdose interval I and with timebetween the two steady-state doses equal to I/2. Even morecomplex patterns are possible.Figure 6.6. Multiple steady-state doses. Two separatesteady-state doses are given. As pictured, they are eachbolus doses, but they do not have to be. The first doseevent record is at time t. The second dose event record isat time t+I/2. They each have interdose interval I.Steady-state levels can be predicted between times t+I/2 andand t+I.Example:TIME AMT SS II8 10. 1 2420 15. 2 24This describes the following dosing regimen: a dose of 10units every morning at 8 AM and a dose of 15 units everyevening at 8 PM (20 hours is 12 hours past 8). Note thatsteady-state is not truly established until after the seconddose record; any observation events interposed between thetwo dose records will reflect only the first steady-statedosage (i.e., 10 units every 8 AM). Another way to achievethe same steady-state is by the following:Example:TIME AMT SS II20 10. 1 1220 5. 2 24This describes doses of 10 units every 12 hours, the last ofwhich is given at 8 PM (i.e. at 8 AM and 8 PM daily), plusadditional doses of 5 units at 8 PM daily. In bothexamples, the steady-state levels can be predicted from time20 hours to time 32 hours.8.2.8. Combining Non-Steady-State Doses with Steady-StateDosesNon-steady-state dose records may appear before, among, orafter steady-state dose records. Such a dose record mayoccur before a steady-state dose record to reflect atransient dose given among a series of regular doses leadingto steady-state, but which is not a part of this series.E.g., a patient who has been maintained at steady-statetakes an extra dose by mistake shortly before hisappointment. A non-steady-state dose record may occur aftera steady-state dose record in order to continue the patternof doses beyond the steady-state dose. Ordinarily,steady-state levels can only be predicted between , thetime on the steady-state dose record, and , the sum ofand the interdose interval. If it is not only necessary tocompute a steady-state prediction between and , butalso after , then there must also occur one or morenon-steady-state dose records at , , etc. with dosesjust like the steady-state dose. (The &quot;additional doses&quot;data item, labeled ADDL, is especially useful for thispurpose; see Chapter 12, Section 2.4.)Example:TIME AMT SS II8 10. 1 2420 15. 2 2432 10. 0 044 15. 0 0Here, the last two records continue the steady-state patternof the first two. Steady-state levels may be predictedbetween times 20 and 56.Similarly, a steady-state constant infusion may be extendedwith a non-steady-state infusion. In the example below,steady-state levels can be predicted from time 0 to time100.TIME RATE AMT SS0 30 0. 10 30 3000. 09. The Output Compartment: Urine Collections andObservationsIn this section we show how urine collections andobservations of urine concentration, , can be described.The first-time reader may prefer to return to this sectionafter reading Section 4.3.3 of Chapter 7. As an example,consider the one-compartment model with first-orderabsorption (ADVAN2). The sequence of events is:6:00 AM A bolus dose of 100 is given.8:00 AM A urine collection is started.9:30 AM and urine volume (UVOL) are measured and anew collection is started.11:45 AM , , and urine volume are measured.The $INPUT record is:$INPUT ID TIME EVID UVOL DV CMT AMTThe data records appear as follows:ID TIME EVID UVOL DV CMT AMT1 6.00 1 0 0 1 1001 8.00 2 0 0 3 01 9.50 0 75 .058 -3 01 9.50 2 0 0 3 01 11.75 0 100 .067 -3 01 11.75 0 100 5.80 2 0Notice that urine collections start with an other type eventrecord (EVID=2) whose CMT contains the number of the outputcompartment, the effect of which is to turn this compartmenton at 8AM, i.e. to begin accounting for the amount of drugappearing in this compartment from 8AM. Because other typeevent records are included, the EVID data item must bepresent in the data. The CMT data item must be present inall event records since it is needed to refer to the outputcompartment in at least one record. Care must be taken touse correct values for the CMT data item; default valuesused when this data item is not present are not relevant inthis case. The DV value on the observation record at 9:30is the measured . Because the value of CMT is negative,the output compartment is also turned off at 9:30. Sincethe collection is to continue, the compartment must beexplicitly turned on again (the fourth record). Note thatUVOL is recorded on both observation records at time 11:45.Strictly speaking, it need only be recorded on the second( observation). This point is discussed further inChapter 7, Section 4.3.3.10. The Data PreprocessorThis section discusses in more detail the ways in which theData Preprocessor can modify data, and discusses when aformat specification should be included in the $DATA record.10.1. Day-time Translation10.1.1. TIME Data ItemSometimes the data contains clock times hh:mm (e.g., thetime 1:30 PM is recorded as 13:30). These times must beconverted to decimal-valued times (e.g., 13.5). The DataPreprocessor can perform this task when it is processingunformatted data. Within an individual record, the DataPreprocessor replaces the TIME value in the first datarecord with 0, and then replaces subsequent records&rsquo; TIMEvalues with the relative time (i.e., the number of hourselapsed since the first record). (The TIME value is alsoreset to 0 on a reset (EVID=3) or reset-dose (EVID=4)record.) Here is an example of relative time calculation:Contents of original file: Contents of new file:ID TIME ID TIME1 9:15 1 0.001 9:30 1 0.251 10 1 0.751 14:40 1 5.421 32.5 1 23.252 8 2 0.002 8.0 2 0.002 44:50 2 36.832 58 2 50.00The presence of the colon &quot;:&quot; in the TIME data item of atleast one record of the data causes the Data Preprocessor toconvert all the TIME values to elapsed values. Elapsedtimes are also called relativ________ times______ Note that recordeddata (lines 5, 8, and 9 of the original file) spanned morethan one day. The user had to add 24 to the TIME values oneach day subsequent to the first to communicate the correcttimes to the Data Preprocessor.10.1.2. DATE Data ItemHere is another way the above data could have been recorded,using a data item called DATE whose value is 1 for the firstday, 2 for the second day, and so on. This allows TIMEvalues to be recorded more naturally using values in therange 0-24.Contents of original file: Contents of new file:ID DATE TIME ID DATE TIME1 1 9:15 1 1 0.001 1 9:30 1 1 0.251 1 10 1 1 0.751 1 14:40 1 1 5.421 2 8.5 1 2 23.252 1 8 2 1 0.002 1 8.0 2 1 0.002 2 20:50 2 2 36.832 3 10 2 3 50.00The DATE data item is of significance only to the DataPreprocessor; NONMEM-PREDPP will not make use of it. Evenif there are no &quot;:&quot; characters among the TIME values, theexistence of a DATE data item will cause the DataPreprocessor to replace TIME values by relative times.10.1.3. Calendar DatesThe Dat____ dat____ ite____ (DATE) can also be used to recordcalendar dates in month-day-year format. Any alphabeticcharacter (e.g., / or -) can be used to separate thecomponents. Here is a third way the same example could berecorded:Contents of original file: Contents of new file:ID DATE=DROP TIME ID TIME1 10-1-86 9:15 1 0.001 10-1-86 9:30 1 0.251 10-1-86 10 1 0.751 10-1-86 14:40 1 5.421 10-2-86 8.5 1 23.252 10-12 8 2 0.002 10-12 8.0 2 0.002 10-13 20:50 2 36.832 10-14 10 2 50.00This example illustrates two features. First, when calendardates are used, the DATE item should be specified as&quot;DATE=DROP&quot;, so that the data item is omitted from the newdata file (see Section 5.3). Otherwise, the alphabeticcharacters which separate the components will cause readerrors when NONMEM reads the data. Second, the year valueis optional; only month and date were actually needed.(Within a single individual record, however, either alldates should specify a year, or none should.)Data labels DAT1, DAT2, and DAT3 are also recognized by theData Preprocessor and can be used instead of DATE. Thelabel given to the Date data item describes its format:DATE month day yearDAT1 day month yearDAT2 year month dayDAT3 year day monthIf only one of the three components is present, it isassumed to be the day&dagger;.<cite>&dagger; In this case only, the Date data item may be zero ornegative. Day -1 means one day prior to day 0. </cite>If only two components are present, they are assumed to bemonth and day (with DATE and DAT2) or day and month (withDAT1 and DAT3). The year may be omitted or given as 1, 2,3, or 4 digits. &#9474;10.1.4. Converting Hours to Days &#9474;The units of the relative TIME values resulting from the &#9474;Data Preprocessor&rsquo;s day-time translation are hours. If the &#9474;correct units for relative time should be days, then the &#9474;TRANSLATE option of the $DATA record may be used to request &#9474;that hours to be converted to days. For example, &#9474;$DATA filename TRANSLATE(TIME/24) &#9474;or &#9474;$DATA filename TRANSLATE(TIME/24.000) &#9474;With the former, values of TIME have two significant digits, &#9474;e.g., xxxx.xx. With the latter, they have three &#9474;significant digits, e.g., xxxx.xxx. &#9474;10.1.5. The Year 2000 - LAST20 &#9474;The user may supply 4 digit years starting (e.g.) &quot;19&quot; and &#9474;&quot;20&quot;, and such dates are processed correctly. (Three digit &#9474;years &quot;000&quot;-&quot;999&quot; are permitted, but would represent exactly &#9474;those years, and should not normally be used.) If the year &#9474;is omitted, it is assumed to be a non-leap year. A problem &#9474;arises when the year supplied, but has only 1 or 2 digits. &#9474;Such years are assumed by default to be in the 1900&rsquo;s. If &#9474;this is not a correct assumption, two errors may be made by &#9474;the Data Preprocessor when computing relative times. First, &#9474;1900 was not a leap year, but 2000 is a leap year. Hence, &#9474;if consecutive dates in a data file are 02-28-00 and &#9474;03-01-00 (signifying February 28 and March 1, 2000), an &#9474;elapsed time of 24 hours, rather than 48 hours, is computed. &#9474;Second, if consecutive dates have years 99 and 00, the &#9474;computed elapsed time is negative and an error message is &#9474;generated. &#9474;With NONMEM V and later versions there is a constant LAST20. &#9474;The value of LAST20 is a 2 digit number nn that specifies &#9474;the highest 2-digit year that is assumed to be in the 21st. &#9474;century, i.e., to represent 20nn rather than 19nn. For &#9474;example, with LAST20=50, then 1 and 2 digit years are &#9474;interpreted as follows: &#9474;00-50 represents 2000-2050 &#9474;51-99 represents 1951-1999 &#9474;The elapsed time between 02-28-00 and 03-01-00 is calculated &#9474;to be 48 hours, and the elapsed time calculated between the &#9474;years 99 (1999) and 00 (2000) is positive. &#9474;There are two ways that a value for LAST20 can be specified. &#9474;First, when NM-TRAN is installed, a value is given to &#9474;constant LAST20 in TrGlobal.f90 (in the resource directory): &#9474;DATA LAST20 &#9474;The default value of this constant in the distribution &#9474;medium is 50. Please ask your system support department if &#9474;they modified the LAST20 constant when NM-TRAN was &#9474;installed. &#9474;Regardless of what value was assigned to the LAST20 constant &#9474;in TrGlobal.f90, there is an option LAST20 of the $DATA &#9474;record that may be used to specify the value of the constant &#9474;for the current run. For example: &#9474;$DATA filename LAST20=50 &#9474;This insures that all 1 and 2 digit years are interpreted as &#9474;above (2000-2050; 1951-1999). &#9474;10.1.6. Leap Year Warning - LYWARN &#9474;There may be two circumstances such that 1 or 2 digit years &#9474;are recorded as 00, 01, ... (equivalently, 0, 1, ...). &#9474;First, these may represent the years 2000, 2001, etc. Or, &#9474;they may represent years 0, 1, etc., of a study. Suppose &#9474;the latter is the case, and that none of the years of the &#9474;study was a leap year. Then if LAST20 is set to a value &#9474;greater than -1, the year 0 is assumed incorrectly to be the &#9474;leap year 2000, and elapsed times may be computed &#9474;incorrectly. The Data Preprocessor issues a warning message &#9474;under the following circumstances: &#9474;1) The year is recorded as &quot;00&quot; or &quot;0&quot;, &#9474;2) The value of LAST20 is greater than -1 by default (so &#9474;that the year is understood to be 2000), and &#9474;3) The LAST20 option of the $DATA record was not used to &#9474;modify LAST20 for this run. &#9474;The warning message is as follows: &#9474;(DATA WARNING 3) RECORD 3, DATA ITEM 3: 01-01-00 &#9474;THE YEAR IS ASSUMED TO BE 2000 (A LEAP YEAR). IF THIS IS INCORRECT, USE&#9474;$DATA&rsquo;S LAST20 OPTION TO OVERRIDE THE DEFAULT VALUE OF LAST20 IN NMTRAN&rsquo;S&#9474;ABLOCK, OR CHANGE THE DEFAULT: 50 &#9474;Suppose these warning messages are appropriate, that is, &#9474;year &quot;00&quot; (or &quot;0&quot;) should not be a leap year. The LAST20 &#9474;option of the $DATA record may be used to specify that such &#9474;years are in the 1900&rsquo;s for the current data set: &#9474;$DATA filename LAST20=-1 &#9474;A constant LYWARN is defined in NM-TRAN&rsquo;s ABLOCK module. &#9474;The default value of LYWARN is 1 (&quot;data warning message 3 &#9474;enabled&quot;). If the value of LYWARN is set to 0 (&quot;data &#9474;warning message 3 disabled&quot;) and NM-TRAN is recompiled, then &#9474;the warning message is suppressed for all runs.10.2. Interdose Interval (II) ConversionWhen the input data is unformatted and PREDPP is being used,the Interdose Interval (II) data item is checked for valuescontaining a colon (:). Any such value is assumed to signala clock time hh:mm. The minutes portion is converted to adecimal number containing as many decimal places as digitsin the original. E.g., the value &quot;:30&quot; is replaced by&quot;.50&quot;. This conversion is performed whether or not day-timetranslation is also being done.10.3. Data Items Generated by the Data PreprocessorWhen the data is from a single individual, the DataPreprocessor will almost always generate an ID data item&Dagger;.<cite>&Dagger; Section 4.2 of Chapter 12 discusses the L1 data item,which is used to prevent NM-TRAN from generating anIdentification data item for individual data. </cite>It does this whether or not PREDPP is used. This is donebecause, when the data is from a single individual, the IDdata item must take on very special non-constant values forNONMEM. The generated ID data item is given the label&quot;.ID.&quot; (i.e., ID surrounded by dots). If this data item isto be shown in any NONMEM output (e.g., in a table), it mustbe referred to on subsequent NM-TRAN records by this label.When PREDPP is used, the Data Preprocessor will alwaysgenerate the required EVID data item if it is not alreadylisted on the $INPUT record. (This was discussed in Section7.3 above.)When PREDPP is used, the Data Preprocessor will alwaysgenerate the MDV (Missing Dependent Variable) data item ifit is not already listed on the $INPUT record.These data items are generated by the Data Preprocessorwhether or not a format specification was coded on the$INPUT record. They are appended to the end of each datarecord.10.4. When Must a Format Specification be Included orOmitted?When coding the $DATA record, you will need to decidewhether to include a FORTRAN format specification describingthe data file or to omit it and let the Data Preprocessorconstruct it. Here are some guidelines in making thisdecision.A format specification is required when:Some data values are left blank on some data records,without having the value 0 or . (or a pair of commas)to hold the place of the missing value.Some data values are adjacent on some data records;they are not separated by a space or a comma.The data records span multiple physical records; thatis, the character / is needed in the formatspecification. (The Data Preprocessor may generatesuch a format specification for the NONMEM data set; weare speaking here of the NM-TRAN data set.)A format specification should not be present when:The $INPUT record includes DROP as a data item label orsynonym.Day-time translation is desired.II conversion is desired.Commas are used to separate the data items.The data values are not lined up into columns withuniform width, so that no format specification can bewritten to describe the file.Many data files do not fall in either category. A formatspecification is optional for such files.10.5. Skipping Data ItemsIt is always possible to omit (skip) data items that are notof interest for a given NONMEM run. When a formatspecification is coded, two things must be done: first,replace the data item&rsquo;s specification by an &quot;X&quot;specification (e.g., replace F8.0 by 8X) and second, deletethe data item&rsquo;s label from the $INPUT record. When noformat specification is coded, all that need be done is toreplace the data item&rsquo;s label in the $INPUT record by DROP(or include DROP as a synonym)."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 7 -
$SUBROUTINE Record and $PK Record</b></p>

<h2>1. What This Chapter is AboutThis chapter tells how to write a $SUBROUTINE record and howto write a simple $PK record for both individual andpopulation data. This chapter is meant to be read inparallel with Chapters 3 and 4.2. The $SUBROUTINE RecordThe $SUBROUTINE record describes which pharmacokinetic modelis to be used. Recall that NONMEM calls a subroutine namedPRED to compute the predicted value. The user must chooseto use his own PRED subroutine or to use the PREDPP package.In this text it is assumed that the PREDPP package ischosen.2.1. Choosing an ADVAN Subroutine: Standard PharmacokineticModelsThe PREDPP Library includes subroutines which are &#9474;pre-preprogrammed, each for a specific pharmacokineticmodel. They are:ADVAN1 (One Compartment Linear Model)ADVAN2 (One Compartment Linear Model with First OrderAbsorption)ADVAN3 (Two Compartment Linear Model)ADVAN4 (Two Compartment Linear Model with First OrderAbsorption)ADVAN10 (One Compartment Model with Michaelis-MentenElimination) &#9474;ADVAN11 (Three Compartment Linear Model) &#9474;ADVAN12 (Three Compartment Linear Model with First Order &#9474;Absorption)PREDPP calls only one subroutine, ADVAN; the different namesabove are external names distinguishing different instancesof the ADVAN routine in the PREDPP Library. The name&rsquo;ADVAN&rsquo; is used because the routine advances (i.e. updatesthe state of) the kinetic system from one point in time tothe next. There are additional ADVAN routines in theLibrary which implement more general types ofpharmacokinetic models; see Chapter 12, Section 2.2. Eachof the ADVAN&rsquo;s can be used for either individual orpopulation data. The (external) name of the ADVAN to beused is coded on the $SUBROUTINE record; this also impliesthat PREDPP is to be used. As an example, the followingrecord specifies the One Compartment Linear Model:$SUBROUTINE ADVAN1The ADVAN&rsquo;s are described in Appendix 1. They share certainfeatures.1. The compartments are numbered. These numbers are usedin two places. First, they are used in the CMT andPCMT data items to describe specific compartments.Second, the compartment number n is part of the name ofPK parameters such as compartment scale (Sn), asdiscussed below.2. Each model has a defaul_______ observatio___________ compartment____________ whichfor each of the above ADVAN&rsquo;s happens to be the centralcompartment. If an event record contains anobservation (i.e. is an observation event record), theprediction associated with that record will be thescaled drug amount in this compartment, unless the CMTdata item on the record specifies differently. Theprediction associated with a non-observational eventrecord will again be the scaled drug amount in thiscompartment, unless the PCMT data item on the recordspecifies differently.3. Each model has a defaul_______ dos____ compartment____________ Unlessspecified differently by the CMT data item, it isunderstood that a dose is input into this compartment.With ADVAN1, ADVAN3, and ADVAN10, this is the centralcompartment. With ADVAN2 and ADVAN4, a drug depotcompartment is part of the model and is the defaultdose compartment. In these cases, if a dose is to godirectly into the central compartment, its compartmentnumber (2) must be present in the CMT data item of thedose record. Note that it is never required that therebe doses into the depot compartment. In a studyinvolving mixed oral and IV doses, for example, somepatients may receive only IV doses. All dose eventrecords for such patients will have the value 2 in theCMT data item.4. Each model has an output compartment. The amount ofdrug in this compartment is the accumulated amount ofdrug eliminated from the system and typicallyrepresents the amount of drug which accumulates in theurine. This compartment is special. It may notreceive a dose. It is initially off, and it remainsoff (so that the amount therein remains zero) until itis explicitly turned on by an other type event recordwhich has the output compartment&rsquo;s number in the CMTdata item. It is computed by &quot;mass balance&quot;, asfollows. Between any two points in time, it increasesby an amount equal to the amount of drug in the othercompartments at the first point in time, plus theamount added via doses between the two time points,less the amount remaining in the other compartments atthe second point in time. (This difference ismultiplied by an output fraction (F0) parameter, if F0is computed by the PK routine.) The output compartmentcan be turned off (i.e. its amount reset to zero). Ifthe compartment is interpreted as a urine compartment,this is equivalent to &quot;emptying&quot; the compartment. Thisis done by putting the negative of its number in theCMT data item of an other type or observation eventrecord.On event records, the output compartment is referred toby the compartment number given in Appendix 1. A PKparameter which refers to the output compartment mayuse either this number or 0 (zero). Thus, F0 and F2both denote the output fraction for ADVAN1; similarly,S0 and S4 both denote the scale for ADVAN4&rsquo;s outputcompartment. SC denotes the scale for any ADVAN&rsquo;s &#9474;central compartment.5. Each model has a set of basic (required)pharmacokinetic (PK) parameters, which are themicroconstants used to compute the amounts of drug viathe kinetic equations for the model. Each one also hasa set of additional (optional) PK parameters, includingcompartment scales (Sn), bioavailability fractions(Fn), and output fraction (F0). Compartment scales aretypically used to convert amounts to concentrations,but they also can be used for other purposes.Bioavailability fractions multiply dose amounts. Theoutput fraction is described above.6. Each model&rsquo;s basic and additional pharmacokineticparameters must be computed for it by a subroutinenamed PK. The error model must be described by asubroutine named ERROR. $PK and $ERROR abbreviatedcode provide an easy way to specify the essentialcomputations that must occur in these subroutines.2.2. Choosing a TRANS Subroutine: AlternativeParameterizationsAs discussed in Chapter 3, we may prefer to usepharmacokinetic parameters in our PK routine other than themicroconstants used by PREDPP. Appendix 2 shows severalcommonly-used parameterizations. The PREDPP packageincludes a family of subroutines called TRANS routines whichare pre-programmed to translate (reparameterize) from thesecommonly used parameterizations to the ones expected byPREDPP. Appendix 2 also gives the TRANS routine for eachalternative parameterization. As with ADVAN, TRANS is thename of the routine. The names given in Appendix 2 areinstances of external subroutine names used in the PREDPPLibrary. The first member of the family, TRANS1, simplytranslates a set of microconstants into these samemicroconstants and must be included in the NONMEM loadmodule in lieu of the others when the $PK abbreviated codecomputes the microconstants.The user must describe on the $SUBROUTINE record which TRANSroutine is to be used. For example, the following recordrequests the One Compartment Linear Model parameterized (inthe PK routine) in terms of clearance and volume.$SUBROUTINE ADVAN1,TRANS2When a TRANS other than TRANS1 is used, only the alternativeparameters listed in column 1 need be assigned values in the$PK abbreviated code. In this example, these are CL, V, andKA.Note that TRANS1 is the default. That is, if no TRANSroutine is listed on the $SUBROUTINE record, it is assumedthat TRANS1 is intended. This is the case in the examplesof Chapter 2. Alternative parameterizations using TRANS1are discussed later in this chapter in Section 4.2.3. $PK Abbreviated Code &#9474;$PK abbreviated code consists of a block of $P___ statements___________one per line, which look much like FORTRAN statements. Infact, they are a subset of FORTRAN: simple assignment &#9474;statements, certain kinds of conditional (IF) statements, &#9474;and certain kinds of CALL, WRITE, PRINT, RETURN, OPEN, &#9474;CLOSE, REWIND statements. The $PK abbreviated code must bepreceded by a record containing the characters &quot;$PK&quot;. Thisrecord and the abbreviated code constitute the $P___ record_______$PK statements must include assignment statements giving avalue to every basic PK parameter for the given ADVAN andTRANS combination, as listed in Appendix 1 (when TRANS1 isused) or column 1 of Appendix 2 (when a different TRANS isused). They may also include assignment statements givingvalues to one or more of the additional PK parameters.3.1. SyntaxWe assume the readers of this document are familiar withwriting FORTRAN assignment and conditional statements. Ifnot, the examples in this and the following chapter shouldgive adequate guidance. FORTRAN statement numbers are notused, and the statements may start in any column. As withall NM-TRAN records, blank lines are permitted, and all textfollowing a semi-colon (;) is ignored and may be used forcomments. FORTRAN continuation lines are not permitted.The statements are built using the following: elements ofthe THETA array (e.g., THETA(1)); constants; names of inputdata items appearing on the $INPUT record; names ofpreviously-assigned variables; FORTRAN library functionsSQRT, LOG, LOG10, EXP, SIN, COS, ABS, TAN, ASIN, ACOS, ATAN &#9474;and INT. arithmetic operators +, -, *, /, **; andarithmetical and logical expressions using all of the above.In addition, statements may include representations forrandom variables such as ETA(1) and EPS(3). Input dataitems have the values appearing on the current event record,and thus these values may change from one event record tothe next. A user-defined variable name follows the usualFORTRAN rules (1-6 letters and digits, starting with aletter) and may not be subscripted. It is defined(&quot;declared&quot;) by being assigned a value (i.e., by appearingto the left of = in an assignment statement).Nested parentheses and nested IF statements are allowed. A &#9474;pair of parentheses enclosing a subscript may be nestedwithin another pair of parentheses. All subscripts must beconstants (e.g. THETA(1)). The statements are evaluatedsequentially, in the order in which they appear.All variables, constants, and expressions are evaluatedusing floating-point (not integer) arithmetic. Single ordouble precision function names and constants may be usedinterchangeably.3.2. When are $PK Statements Evaluated?$PK statements are normally evaluated with every eventrecord for both population and individual data. Thisenables the amounts in the compartments to be updated fromevent time to event time using current values of the dataitems. This may be more frequent than is necessary. In thetheophylline example of Chapter 2, no data item is used inthe $PK statements. In the phenobarbital example, the dataitem used, WT, is constant within any individual&rsquo;s data. Inthese cases, it is sufficient, and it can save noticeableamounts of run time, to evaluate the $PK statements once perindividual record. PREDPP can be instructed that the set ofevent records with which the $PK statements are evaluatedare to be limited in some way (see Chapter 12, Section 2.7).The CALL data item can be used to force the statements to beevaluated with any event records.Certain advanced forms of dosing (additional and laggeddoses; see Chapter 12, Sections 2.4 and 2.5) introduce dosesat times which do not necessarily coincide with any eventrecord. PREDPP does not normally evaluate the $PKstatements at such times, but can be instructed to do so(Chapter 12, Section 2.7). Model event time parameters can &#9474;be used to instruct PREDPP to evaluate the $PK statements at &#9474;specified times (Chapter 12, Section Section 2.7)3.3. Time Varying PK parametersThe state of the kinetic system at a given event time isobtained using PK parameter values computed with the dataitems on the event record. Using these parameter values thesystem is advanced to the event time from the last eventtime. Population models sometimes use data items whichchange value within individual records and thus give rise toPK parameters whose values change within individual records.In Chapter 4, Section 3.1.6, it is pointed out that it isdesirable for the value of such a data item on the eventrecord to be that value holding at the midpoint of theinterval between the current event time and the lastprevious event time, since the system is advanced over thisinterval using the PK parameters determined with this value.If the data item changes too rapidly for this value tofairly represent the data item over the entire time period,it is possible to subdivide the interval into smallerintervals. Event records with EVID=2 (other type eventrecords) can be introduced for this purpose. For example,between two consecutive event records rj and rj+1, withevent times tj and tj+1, one might introduce two new othertype event records R1 and R2, with event times T1 and T2,into the data set. The value of the data item in R1 will beused to compute the PK parameters used to advance the systemover the interval tj to T1 and should be the value of thedata item holding at the midpoint of this interval.Similarly, the value of the data item in R2 will be used tocompute the PK parameters used to advance the system overthe interval T1 to T2 and should be the value of the dataitem holding at the midpoint of this interval, and so on.4. $PK Statements for Individual Data4.1. Basic and Additional ParametersWith individual data, the parameters to be estimated are(usually) the individual&rsquo;s PK parameters, and therefore,elements of &theta; should be associated with these PK parameters.(NONMEM estimates the elements of the &theta; vector.) By anindividual&rsquo;s PK parameters, we mean here the basic PKparameters and, possibly, some additional PK parameters(e.g. a bioavailability fraction, or volume of distributionwhen the latter is not a basic PK parameter). Toillustrate, in the theophylline example of Chapter 1 thereoccur these $PK statements$PKKA=THETA(1)K=THETA(2)The parameters KA and K are the basic PK parameters forADVAN2 and TRANS1 (the default TRANS routine). They areused to compute the amounts in the compartments. Typically,however, the observations are concentrations. A scaleparameter is used to convert the amount into aconcentration. Thus, in the theophylline example we see twoadditional $PK statements:V=THETA(3)S2=VHere, V is a user-defined variable standing for the volumeof distribution of the central compartment. It is neither abasic nor additional parameter. The parameter S2 is thescale parameter for the central compartment; upon dividingthe amount in that compartment by S2, the concentrationresults. (An observation is usually predicted by an amountfor a compartment divided by that compartment&rsquo;s scaleparameter). In fact, these two statements could be replacedby the single statementS2=THETA(3)However, it may be helpful to the user to distinguish in hiscode between the calculation of the central volume itselfand the calculation of the scale parameter.There is no particular need for certain elements of &theta; to beassociated with certain PK parameters. In the aboveexample, the roles of &theta;1 and &theta;2 could have been reversed.NONMEM&rsquo;s &theta; vector may contain more or fewer elements thanthere are PK parameters, depending on how these parametersare modeled.PK parameters must be explicitly modeled, usually in termsof parameters to be estimated and user-defined data items;the user communicates this model with the $PK statements.If a certain parameter&rsquo;s value is known _ prior______ (say, S2has the known value 500), there are several ways the valuecan be incorporated into the $PK statements. The followingexamples show how it can be done via a constant, via a fixedelement of &theta;, and via a (differently-named) data item:1. S2=5002. $THETA .6 9. (500 FIXED)$PKS2=THETA(3)Here, rather than be estimated, &theta;3 is constrained tothe value 500. This is discussed in Chapter 9.3. $INPUT ... VOL ..$PKS2=VOLHere, VOL is assumed to have the value 500 on the datarecords. When the data is from a population, thisthird technique allows a unique value of VOL to besupplied for each individual.4.2. Alternative Parameterizations using $PK StatementsIt is possible to use an alternative parameterization whilestill using TRANS1. The reparameterization is performedwithin the $PK statements by explicitly computing themicroconstants from the alternative parameters. Such&quot;reparameterization&quot; statements are given in column 2 ofAppendix 2. They must follow the assignment statements thatgive the alternative parameters their values, as in thephenobarbital example of Chapter 2.The advantage of using $PK statements to reparameterize,rather than using a TRANS subroutine, is that theNONMEM-PREDPP load module will then always consist of thesame set of subroutines for a given choice of ADVAN, whichsimplifies the job of creating and running it. It will alsorun slightly faster. We assume in this document that thisapproach is taken.Other parameterizations are possible besides the ones inAppendix 2. For example, with ADVAN1 and TRANS1, one mightcode:CL=THETA(1)K=THETA(2)V=CL/KS1=VThe ability to express a large variety of modelingpossibilities with NONMEM-PREDPP provides great freedom andflexibility, but as always with flexible modelingcapability, certain pitfalls arise. Suppose, for example,that with a one compartment system the compartment amount,rather than the concentration is observed. With ADVAN1 andTRANS1 the statementsCL=THETA(1)V=THETA(2)K=CL/Vwill lead to difficulty because only the ratio of &theta;1 to &theta;2affects the amount in the compartment, and therefore, thedata do not allow &theta;1 and &theta;2 to be separately estimated. Thestatements should read:K=THETA(1)It is important to remember that only those elements of &theta;which affect the predictions of observations will beestimated by NONMEM. Here is some problematic code usingADVAN1 with TRANS1:K=THETA(1)V=THETA(2)CL=THETA(3)S1=VOnce again, NONMEM will be unable to produce separateestimates of all elements of &theta;. The kinetics of a simpleone compartment system cannot be determined by threeindependent parameters. With TRANS1, PREDPP itself does not&quot;know&quot; about the relationship K=CL/V which defines adependency among the parameters. Indeed, the parameters CLand V are both regarded as user-defined variables. Thevalue of &theta;3 has no effect on the prediction. Were it notfor the fact that S1 is set equal to V, the value of &theta;2would have no effect on the prediction either. With TRANS2this code is also incorrect for essentially the same reason.Here, K is regarded as a user-defined variable, and therelationship CL=K*V is not &quot;known&quot; to PREDPP. (PREDPP doesknow that CL/V is the rate constant of elimination, but itdoes not recognize the variable K as denoting this rateconstant, and &theta;1 has no effect on the prediction.)4.3. Scale ParametersScale parameters are mentioned in Section 2.1. Predictedcompartment amounts are divided by them and are thusconverted to predicted concentrations. They are only neededfor those compartments whose concentrations are directlyobserved. With ADVAN3, for example, the peripheralcompartment&rsquo;s scale S2 does need to be computed explicitlyif there are no observation events giving measured values ofconcentrations in the peripheral compartment. Predictedvalues for this compartment may still be plotted againsttime, for example, but these values need not be scaled drugamounts; the (unscaled) amount alone is sufficient to showthe shape of the curve. (The various volume parametersshown in Appendix 2 must be modeled when they are used asbasic parameters, but they need not be assigned as values tocompartment scale parameters.) Any scale parameter which isnot modeled by $PK statements is assumed to be 1 (i.e.,predicted values are always amounts).4.3.1. Scaling by a Known ConstantIn Chapter 3, Section 2.2.1, the units of V were changedfrom kiloliters to liters using the model:S=V/1000This can be coded in a $PK statementsimilar to the way it appears here,except that the compartment number mustbe specified:S1=V/1000Basic PK parameters may also be rescaled in thismanner.4.3.2. Scaling by a Parameter: Conditional Statements andIndicator VariablesIn Chapter 3, Section 2.2.2, the following model appeared:V, ifassayis1S=&#9129;hV,ifassayis2There are two ways this can be coded in $PK statements.The assay data item can be tested directly,or anindicator variablecan be used.Anindicator variableis a variable whose value is 0 or 1.It may be identified with an input data item, or it may be a user-definedvariable in the $PK statements.For example, suppose variable ASY is to beused as an indicator variable.If some input data item isgiven value 1 when assay 1 was used and value 0 when assay2 was used, then this data item could simply be named ASY on the$INPUT record.Suppose, however, that the assay number itself (1 or 2)was recorded in the dataand that we have named the data itemANUM on the $INPUT record.We must compute the user-defined variable ASY for use asan indicator variable.There are two ways this can be done: using a logical IFand using a block IF.1. ASY=1IF (ANUM.EQ.2) ASY=0Here, ASY is &quot;provisionally&quot; given the value 1. Thevalue is changed to 0 if the data indicates assay 2.2. IF (ANUM.EQ.1) THENASY=1ELSEASY=0ENDIFThe choice between these forms of IF is purely a matter ofstyle. Now let us assume that the compartment to be scaledis compartment 2, and that h is to be identified with &theta;5.The parameter S2 can now be coded unconditionally:S2=ASY*V+(1-ASY)*THETA(5)*VAlternatively, ANUM can be tested and ASY avoidedaltogether:1. S2=VIF (ANUM.EQ.2) S2=THETA(5)*V2. IF (ANUM.EQ.1) THENS2=VELSES2=THETA(5)*VENDIF4.3.3. Scaling by a Data ItemIf observations of urine concentration Cu are included inthe data (see e.g. Chapter 6, Section 9), it is necessary toprovide urine volume as a scale for the output compartment.Presumably, this volume varies between urine observationsand is recorded in the data records. Suppose this data itemis called UVOL in the $INPUT record. (The name given to thedata item has no special significance; any name could bechosen.) An additional $PK statement is necessary:S0=UVOLUVOL need be recorded on only those observation events towhich it applies, although it does no harm to record it onother event records. For example, it may well happen thatboth plasma and urine responses are measured at the sametime, so that there are two observation event records withthe same value of TIME, one for each compartment observed atthat time. As described in Section 3.2 above, $PKstatements are normally evaluated with every event record.Consider, for example, the sample data below. Assume thatthe Central compartment is compartment 2 and the outputcompartment is compartment 3. (Note the use of -3 tosignify that compartment 3 is to be turned off after theobservation time. The compartment will remain off until thetime another urine collection begins, as indicated with another type record; see Chapter 6, Section 7.4). Either 1.or 2. will produce the correct value of S0:1. Record UVOL on the event record to which it applies.The order of the records does not matter.TIME UVOL DV CMT10. 0 5.80 210. 100 .067 -32. Record UVOL on all event records having the same valueof TIME. The order of the records does not matter.TIME UVOL DV CMT10. 100 5.80 210. 100 .067 -3The following will not produce the correct value of S0unless PREDPP is instructed to evaluate the $PK statementsonly once for each distinct value of TIME:TIME UVOL DV CMT10. 100 5.80 210. 0 .067 -34.4. Bioavailability Fraction ParametersPK parameters of the form Fn, where n is the number of acompartment into which a dose may be introduced, arebioavailability fractions. If a dose record specifies adose for compartment n, the dose amount given on the eventrecord is multiplied by the value of Fn computed from the$PK statements evaluated with this record, and this productis the dose amount introduced into the system. For example,F1 multiplies the amount of dose which is to be added tocompartment 1. Any Fn which is not computed by $PKstatements is assumed to be 1 (i.e., the dose is 100%available).As an example, suppose two different preparations of thesame drug are administered, and it is assumed that theydiffer only in their bioavailability. The indicatorvariable (or data item) PREP has value 1 for the firstpreparation and 0 for the second. The ratio of thebioavailability of the second preparation to that of thefirst preparation is identified with &theta;6. Usually, themethod of drug administration permits this ratio to beestimated, but not the separate bioavailabilities. Withoutloss of generality, the bioavailability of the firstpreparation can be taken to be 1. Assuming the drug enterscompartment 1 of the model, there are three ways this can becoded:1. F1=PREP+(1-PREP)*THETA(6)2. F1=1IF (PREP.EQ.0) F1=THETA(6)3. IF (PREP.EQ.0) THENF1=THETA(6)ELSEF1=1ENDIFAgain, the choice is a matter of style.Once a dose is introduced into the dose compartment, itbegins to distribute into the other compartments. Whetheror not the original dose was 100% available, it is assumedthat none of the dose appearing in the dose compartment, andin other compartments after the dose is introduced, isfurther reduced due to bioavailability effects. PREDPPcannot model &quot;bioavailability effects&quot; between compartments.4.5. Output FractionThe Output Fraction parameter, F0, is an optional additionalPK parameter of every model. As discussed in Section 2above, every model contains an output compartment. If thiscompartment has been turned on prior to the advance fromtime tj&minus;1 to time tj, then the amount of drug lost from thesystem during this interval via elimination is multiplied byF0 and added to the prior contents of the outputcompartment. If the $PK statements do not include anassignment statement giving a value to F0, it is taken to be1 (i.e., 100% of the drug excreted goes to the outputcompartment). In model (4.7), an example of the use of F0is given. Assuming that the variables CLREN (renalclearance) and CL (total clearance) have been calculatedwith earlier $PK statements, the statementF0=CLREN/CLcan be used to compute F0.5. $PK Statements for Population DataWith population data, the structural models for the PKparameters tend to be more complicated than with individualdata. In addition, the influence of interindividual randomeffects needs to be described. These will involvedifferences in the $PK statements, but the same $SUBROUTINErecord and the same ADVAN and TRANS subroutines are used,and the same general requirements and examples of theearlier sections of this chapter still mostly apply. Inthis section, the models of Chapter 4 are implemented via$PK statements. Many of these models could be implementedin a variety of ways; an experienced programmer may preferto code them differently.With population data, we must distinguish between thetypical value of a PK parameter in the population and thevalue of that parameter for a given individual, theindividual&rsquo;s value. The typical value is computed by astructural model involving only fixed effects. We havechosen to denote it with the use of a tilde: e.g. Cl. Theindividual&rsquo;s value is computed by a model including randominterindividual effects (represented by random variables)and is denoted without a tilde: e.g., Cl. There is no tildecharacter in the FORTRAN character set, and with NM-TRAN wedo not need to distinguish typical and individual values.However, for purposes of clarity, in all the examples whichfollow we will include the letters TV (Typical Value) at thestart of those variable names which we think of as having atilde (e.g., TVCL). This is a matter of style.5.1. Structural Part of Parameter ModelsIn models such as (4.3), the subscript i indicates that themodel applies to the ith individual. As noted in Chapter 4,the subscript is not needed and, indeed, is not used in $PKstatements.5.1.1. Linear ModelsModels (4.4), (4.5a), (4.5b) and (4.6) can be coded as theyappear. Assuming that WT, AGE, and SECR are input dataitems or have been calculated with earlier $PK statements,the code is:TVCLM=THETA(1)*WTRF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFTVCL=TVCLM+TVCLR5.1.2. Multiplicative ModelsModel (4.4.1) can be coded as follows:TVLCLM=THETA(1)+THETA(2)*LOG(WT)TVCLM=EXP(TVLCLM)Model (4.4.2) can also be coded as it appears:TVCLM=THETA(1)*WT**THETA(2)5.1.3. Saturation ModelsModel (4.4.3) presents a problem. Subscripted variablesthat can appear in $PK statements are few; naturally, theyinclude THETA and (as seen below) ETA. The variable CPSScannot be subscripted, and a variable name such as CPSS2(rather than CPSS(2)) must be used for Cpss2. The model can &#9474;be coded exactly as it appears:TVCLM=WT*(THETA(1)-THETA(2)*CPSS2/(THETA(3)+CPSS2))5.1.4. Models with Indicator VariablesWhen dealing with typical values, indicator variables (0/1variables) can be used interchangeably with conditional (IF)statements, as we have already seen. Model (4.4.4) can becoded in a variety of ways, two of which are:1. TVCLM=(THETA(1)-THETA(2)*HF)*WT2. IF (HF.EQ.0) THENTVCLM=THETA(1)*WTELSETVCLM=(THETA(1)-THETA(2))*WTENDIF5.2. Population Random Effect ModelsRandom variables &eta; are used in the models forinterindividual errors. (With population models, randomvariables &epsilon; are used in the models for intraindividualerrors; see Chapter 4, Section 2.) In $PK statements theyare denoted by ETA(1), ETA(2), etc. Even if there is onlyonce such variable it must still be subscripted. It is thepresence of one or more such variables that indicates toNM-TRAN that the data is from a population. Just as thereis no particular need for certain &theta; elements to beidentified with certain PK parameters, there is noparticular need for certain &theta; elements to be associated withcertain &eta; variables, and any association need not beone-to-one. The following models are both valid:1. CL=THETA(1)+ETA(1)V=THETA(2)+ETA(2)2. CL=THETA(1)+ETA(2)V=THETA(2)+ETA(1)However, it will be easier to keep things straight if thefirst model is used.Here are three different ways of coding a model for anindividual&rsquo;s value of clearance:1. TVCL=THETA(1)CL=TVCL+ETA(1)2. CL=THETA(1)CL=CL+ETA(1)3. CL=THETA(1)+ETA(1)We prefer the first way because it clearly distinguishes themodel for the typical value from the model for theindividual&rsquo;s value. With any of the three ways for codingthe model the typical value of the parameter can be computedas follows: The &eta; variables are set to 0, and the parameteris computed. Any variable whose value depends on &eta;variables is called a rando______ variable_________Random variables are called true-value variables in the &#9474;first edition of this guide. This is because, in principle, &#9474;a random variable can assume an individual&rsquo;s true value &#9474;under the model. Such a variable is in contrast to a &#9474;variable which assumes only a typical value for the &#9474;population.An individual&rsquo;s true value is never actually known, althoughan estimate of it can be obtained. See Chapter 12, Sections4.11-4.13.5.3. Models for Interindividual ErrorsHere we show how to express the most commonly used modelsfor interindividual errors with $PK statements. Inaddition, all the error models described in Chapter 8 mayalso be used in $PK statements.5.3.1. Additive/Multiplicative ModelsThis is the error model of (4.9):K=TVK+ETA(1)This is the error model of (4.10):K=TVK*(1+ETA(1))This model can also be coded as:K=TVK+TVK*ETA(1)Here, the variable TVK has been &quot;multiplied through&quot;. Thechoice is a matter of style.5.3.2. Other ModelsThe model (4.11) may be coded as written.CLM=TVCLM+(1-ICU)*ETA(1)+ICU*ETA(2)It may also be coded with an IF statement. &#9474;IF (ICU.EQ.0) THENCLM=TVCLM+ETA(1)ELSECLM=TVCLM+ETA(2)ENDIFThe choice is a matter of style.Note that, under the parameterizations given in Appendices 1and 2, CLM is neither a basic nor an additional PKparameter, yet its model involves an &eta; variable. This islegitimate: any variable can be defined in terms of an &eta;variable. However, just as with &theta;&rsquo;s, the values assigned tothe &eta; variables must somehow affect the predictions ofobservations. Otherwise, the variance of some &eta; variablecannot be estimated, and consequently, none of the variancesof these variables can be estimated. Presumably, within the$PK statements, CLM is used to compute CL, and (eitherwithin the $PK statements or within the TRANS routine) CL isused to compute K.5.4. Restrictions on Random Variables &#9474;This section discusses the use of random variables in somedepth and may be skipped by the casual reader. The remarkshere apply to all random variables: both the ETA variablesof this chapter and the ERR/EPS variables of Chapter 8.In general, ETA variables can be used like any othervariables.Any variable whose value is affected by an ETA variable is arandom variable, whether the ETA variable occurs explicitlyin the defining expression for the random variable orwhether another random variable occurs in this expression.For example, consider the following:TVCLM=THETA(2)*WTCLM=TVCLM+ETA(2)RF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFCLR=TVCLR+ETA(1)CL=CLM+CLRCL is a random variable, because it is computed from randomvariables. It depends on both &eta;1 and &eta;2.Random variables may be changed and may be assigned &#9474;conditionally, subject to the following restrictions. &#9474;A random variable may not appear anywhere within a &#9474;nested if structure. &#9474;A random variable defined in the $PK block may not be &#9474;redefined in the $ERROR block.As an example of the first restriction, suppose in the model(4.11) it is also believed that, for ICU patients, ageaffects CLM. The following code expresses the model, but isnot permitted:IF (ICU.EQ.1) THENIF (AGE.GE.50) THENTVCLM=THETA(1)ELSETVCLM=THETA(2)ENDIFCLM=TVCLM+ETA(1)ELSETVCLM=THETA(3)CLM=TVCLM+ETA(2)ENDIFAn alternate code follows, in which the calculation of TVCLM(which involves a nested IF) precedes the calculation of CLM(which does not require a nested IF). This code ispermitted.IF (ICU.EQ.1) THENIF (AGE.GT.50) THENTVCL=THETA(1)ELSETVCL=THETA(2)ENDIFELSETVCL=THETA(3)ENDIFIF (ICU.EQ.1) THENCL=TVCL+ETA(1)ELSECL=TVCL+ETA(2)ENDIFIndentations are used in the above code for clarity, buthave no affect on NM-TRAN&rsquo;s processing of the abbreviatedcode.
<a name="1. What This Chapter is AboutThis chapter tells how to write a $SUBROUTINE record and howto write a simple $PK record for both individual andpopulation data. This chapter is meant to be read inparallel with Chapters 3 and 4.2. The $SUBROUTINE RecordThe $SUBROUTINE record describes which pharmacokinetic modelis to be used. Recall that NONMEM calls a subroutine namedPRED to compute the predicted value. The user must chooseto use his own PRED subroutine or to use the PREDPP package.In this text it is assumed that the PREDPP package ischosen.2.1. Choosing an ADVAN Subroutine: Standard PharmacokineticModelsThe PREDPP Library includes subroutines which are &#9474;pre-preprogrammed, each for a specific pharmacokineticmodel. They are:ADVAN1 (One Compartment Linear Model)ADVAN2 (One Compartment Linear Model with First OrderAbsorption)ADVAN3 (Two Compartment Linear Model)ADVAN4 (Two Compartment Linear Model with First OrderAbsorption)ADVAN10 (One Compartment Model with Michaelis-MentenElimination) &#9474;ADVAN11 (Three Compartment Linear Model) &#9474;ADVAN12 (Three Compartment Linear Model with First Order &#9474;Absorption)PREDPP calls only one subroutine, ADVAN; the different namesabove are external names distinguishing different instancesof the ADVAN routine in the PREDPP Library. The name&rsquo;ADVAN&rsquo; is used because the routine advances (i.e. updatesthe state of) the kinetic system from one point in time tothe next. There are additional ADVAN routines in theLibrary which implement more general types ofpharmacokinetic models; see Chapter 12, Section 2.2. Eachof the ADVAN&rsquo;s can be used for either individual orpopulation data. The (external) name of the ADVAN to beused is coded on the $SUBROUTINE record; this also impliesthat PREDPP is to be used. As an example, the followingrecord specifies the One Compartment Linear Model:$SUBROUTINE ADVAN1The ADVAN&rsquo;s are described in Appendix 1. They share certainfeatures.1. The compartments are numbered. These numbers are usedin two places. First, they are used in the CMT andPCMT data items to describe specific compartments.Second, the compartment number n is part of the name ofPK parameters such as compartment scale (Sn), asdiscussed below.2. Each model has a defaul_______ observatio___________ compartment____________ whichfor each of the above ADVAN&rsquo;s happens to be the centralcompartment. If an event record contains anobservation (i.e. is an observation event record), theprediction associated with that record will be thescaled drug amount in this compartment, unless the CMTdata item on the record specifies differently. Theprediction associated with a non-observational eventrecord will again be the scaled drug amount in thiscompartment, unless the PCMT data item on the recordspecifies differently.3. Each model has a defaul_______ dos____ compartment____________ Unlessspecified differently by the CMT data item, it isunderstood that a dose is input into this compartment.With ADVAN1, ADVAN3, and ADVAN10, this is the centralcompartment. With ADVAN2 and ADVAN4, a drug depotcompartment is part of the model and is the defaultdose compartment. In these cases, if a dose is to godirectly into the central compartment, its compartmentnumber (2) must be present in the CMT data item of thedose record. Note that it is never required that therebe doses into the depot compartment. In a studyinvolving mixed oral and IV doses, for example, somepatients may receive only IV doses. All dose eventrecords for such patients will have the value 2 in theCMT data item.4. Each model has an output compartment. The amount ofdrug in this compartment is the accumulated amount ofdrug eliminated from the system and typicallyrepresents the amount of drug which accumulates in theurine. This compartment is special. It may notreceive a dose. It is initially off, and it remainsoff (so that the amount therein remains zero) until itis explicitly turned on by an other type event recordwhich has the output compartment&rsquo;s number in the CMTdata item. It is computed by &quot;mass balance&quot;, asfollows. Between any two points in time, it increasesby an amount equal to the amount of drug in the othercompartments at the first point in time, plus theamount added via doses between the two time points,less the amount remaining in the other compartments atthe second point in time. (This difference ismultiplied by an output fraction (F0) parameter, if F0is computed by the PK routine.) The output compartmentcan be turned off (i.e. its amount reset to zero). Ifthe compartment is interpreted as a urine compartment,this is equivalent to &quot;emptying&quot; the compartment. Thisis done by putting the negative of its number in theCMT data item of an other type or observation eventrecord.On event records, the output compartment is referred toby the compartment number given in Appendix 1. A PKparameter which refers to the output compartment mayuse either this number or 0 (zero). Thus, F0 and F2both denote the output fraction for ADVAN1; similarly,S0 and S4 both denote the scale for ADVAN4&rsquo;s outputcompartment. SC denotes the scale for any ADVAN&rsquo;s &#9474;central compartment.5. Each model has a set of basic (required)pharmacokinetic (PK) parameters, which are themicroconstants used to compute the amounts of drug viathe kinetic equations for the model. Each one also hasa set of additional (optional) PK parameters, includingcompartment scales (Sn), bioavailability fractions(Fn), and output fraction (F0). Compartment scales aretypically used to convert amounts to concentrations,but they also can be used for other purposes.Bioavailability fractions multiply dose amounts. Theoutput fraction is described above.6. Each model&rsquo;s basic and additional pharmacokineticparameters must be computed for it by a subroutinenamed PK. The error model must be described by asubroutine named ERROR. $PK and $ERROR abbreviatedcode provide an easy way to specify the essentialcomputations that must occur in these subroutines.2.2. Choosing a TRANS Subroutine: AlternativeParameterizationsAs discussed in Chapter 3, we may prefer to usepharmacokinetic parameters in our PK routine other than themicroconstants used by PREDPP. Appendix 2 shows severalcommonly-used parameterizations. The PREDPP packageincludes a family of subroutines called TRANS routines whichare pre-programmed to translate (reparameterize) from thesecommonly used parameterizations to the ones expected byPREDPP. Appendix 2 also gives the TRANS routine for eachalternative parameterization. As with ADVAN, TRANS is thename of the routine. The names given in Appendix 2 areinstances of external subroutine names used in the PREDPPLibrary. The first member of the family, TRANS1, simplytranslates a set of microconstants into these samemicroconstants and must be included in the NONMEM loadmodule in lieu of the others when the $PK abbreviated codecomputes the microconstants.The user must describe on the $SUBROUTINE record which TRANSroutine is to be used. For example, the following recordrequests the One Compartment Linear Model parameterized (inthe PK routine) in terms of clearance and volume.$SUBROUTINE ADVAN1,TRANS2When a TRANS other than TRANS1 is used, only the alternativeparameters listed in column 1 need be assigned values in the$PK abbreviated code. In this example, these are CL, V, andKA.Note that TRANS1 is the default. That is, if no TRANSroutine is listed on the $SUBROUTINE record, it is assumedthat TRANS1 is intended. This is the case in the examplesof Chapter 2. Alternative parameterizations using TRANS1are discussed later in this chapter in Section 4.2.3. $PK Abbreviated Code &#9474;$PK abbreviated code consists of a block of $P___ statements___________one per line, which look much like FORTRAN statements. Infact, they are a subset of FORTRAN: simple assignment &#9474;statements, certain kinds of conditional (IF) statements, &#9474;and certain kinds of CALL, WRITE, PRINT, RETURN, OPEN, &#9474;CLOSE, REWIND statements. The $PK abbreviated code must bepreceded by a record containing the characters &quot;$PK&quot;. Thisrecord and the abbreviated code constitute the $P___ record_______$PK statements must include assignment statements giving avalue to every basic PK parameter for the given ADVAN andTRANS combination, as listed in Appendix 1 (when TRANS1 isused) or column 1 of Appendix 2 (when a different TRANS isused). They may also include assignment statements givingvalues to one or more of the additional PK parameters.3.1. SyntaxWe assume the readers of this document are familiar withwriting FORTRAN assignment and conditional statements. Ifnot, the examples in this and the following chapter shouldgive adequate guidance. FORTRAN statement numbers are notused, and the statements may start in any column. As withall NM-TRAN records, blank lines are permitted, and all textfollowing a semi-colon (;) is ignored and may be used forcomments. FORTRAN continuation lines are not permitted.The statements are built using the following: elements ofthe THETA array (e.g., THETA(1)); constants; names of inputdata items appearing on the $INPUT record; names ofpreviously-assigned variables; FORTRAN library functionsSQRT, LOG, LOG10, EXP, SIN, COS, ABS, TAN, ASIN, ACOS, ATAN &#9474;and INT. arithmetic operators +, -, *, /, **; andarithmetical and logical expressions using all of the above.In addition, statements may include representations forrandom variables such as ETA(1) and EPS(3). Input dataitems have the values appearing on the current event record,and thus these values may change from one event record tothe next. A user-defined variable name follows the usualFORTRAN rules (1-6 letters and digits, starting with aletter) and may not be subscripted. It is defined(&quot;declared&quot;) by being assigned a value (i.e., by appearingto the left of = in an assignment statement).Nested parentheses and nested IF statements are allowed. A &#9474;pair of parentheses enclosing a subscript may be nestedwithin another pair of parentheses. All subscripts must beconstants (e.g. THETA(1)). The statements are evaluatedsequentially, in the order in which they appear.All variables, constants, and expressions are evaluatedusing floating-point (not integer) arithmetic. Single ordouble precision function names and constants may be usedinterchangeably.3.2. When are $PK Statements Evaluated?$PK statements are normally evaluated with every eventrecord for both population and individual data. Thisenables the amounts in the compartments to be updated fromevent time to event time using current values of the dataitems. This may be more frequent than is necessary. In thetheophylline example of Chapter 2, no data item is used inthe $PK statements. In the phenobarbital example, the dataitem used, WT, is constant within any individual&rsquo;s data. Inthese cases, it is sufficient, and it can save noticeableamounts of run time, to evaluate the $PK statements once perindividual record. PREDPP can be instructed that the set ofevent records with which the $PK statements are evaluatedare to be limited in some way (see Chapter 12, Section 2.7).The CALL data item can be used to force the statements to beevaluated with any event records.Certain advanced forms of dosing (additional and laggeddoses; see Chapter 12, Sections 2.4 and 2.5) introduce dosesat times which do not necessarily coincide with any eventrecord. PREDPP does not normally evaluate the $PKstatements at such times, but can be instructed to do so(Chapter 12, Section 2.7). Model event time parameters can &#9474;be used to instruct PREDPP to evaluate the $PK statements at &#9474;specified times (Chapter 12, Section Section 2.7)3.3. Time Varying PK parametersThe state of the kinetic system at a given event time isobtained using PK parameter values computed with the dataitems on the event record. Using these parameter values thesystem is advanced to the event time from the last eventtime. Population models sometimes use data items whichchange value within individual records and thus give rise toPK parameters whose values change within individual records.In Chapter 4, Section 3.1.6, it is pointed out that it isdesirable for the value of such a data item on the eventrecord to be that value holding at the midpoint of theinterval between the current event time and the lastprevious event time, since the system is advanced over thisinterval using the PK parameters determined with this value.If the data item changes too rapidly for this value tofairly represent the data item over the entire time period,it is possible to subdivide the interval into smallerintervals. Event records with EVID=2 (other type eventrecords) can be introduced for this purpose. For example,between two consecutive event records rj and rj+1, withevent times tj and tj+1, one might introduce two new othertype event records R1 and R2, with event times T1 and T2,into the data set. The value of the data item in R1 will beused to compute the PK parameters used to advance the systemover the interval tj to T1 and should be the value of thedata item holding at the midpoint of this interval.Similarly, the value of the data item in R2 will be used tocompute the PK parameters used to advance the system overthe interval T1 to T2 and should be the value of the dataitem holding at the midpoint of this interval, and so on.4. $PK Statements for Individual Data4.1. Basic and Additional ParametersWith individual data, the parameters to be estimated are(usually) the individual&rsquo;s PK parameters, and therefore,elements of &theta; should be associated with these PK parameters.(NONMEM estimates the elements of the &theta; vector.) By anindividual&rsquo;s PK parameters, we mean here the basic PKparameters and, possibly, some additional PK parameters(e.g. a bioavailability fraction, or volume of distributionwhen the latter is not a basic PK parameter). Toillustrate, in the theophylline example of Chapter 1 thereoccur these $PK statements$PKKA=THETA(1)K=THETA(2)The parameters KA and K are the basic PK parameters forADVAN2 and TRANS1 (the default TRANS routine). They areused to compute the amounts in the compartments. Typically,however, the observations are concentrations. A scaleparameter is used to convert the amount into aconcentration. Thus, in the theophylline example we see twoadditional $PK statements:V=THETA(3)S2=VHere, V is a user-defined variable standing for the volumeof distribution of the central compartment. It is neither abasic nor additional parameter. The parameter S2 is thescale parameter for the central compartment; upon dividingthe amount in that compartment by S2, the concentrationresults. (An observation is usually predicted by an amountfor a compartment divided by that compartment&rsquo;s scaleparameter). In fact, these two statements could be replacedby the single statementS2=THETA(3)However, it may be helpful to the user to distinguish in hiscode between the calculation of the central volume itselfand the calculation of the scale parameter.There is no particular need for certain elements of &theta; to beassociated with certain PK parameters. In the aboveexample, the roles of &theta;1 and &theta;2 could have been reversed.NONMEM&rsquo;s &theta; vector may contain more or fewer elements thanthere are PK parameters, depending on how these parametersare modeled.PK parameters must be explicitly modeled, usually in termsof parameters to be estimated and user-defined data items;the user communicates this model with the $PK statements.If a certain parameter&rsquo;s value is known _ prior______ (say, S2has the known value 500), there are several ways the valuecan be incorporated into the $PK statements. The followingexamples show how it can be done via a constant, via a fixedelement of &theta;, and via a (differently-named) data item:1. S2=5002. $THETA .6 9. (500 FIXED)$PKS2=THETA(3)Here, rather than be estimated, &theta;3 is constrained tothe value 500. This is discussed in Chapter 9.3. $INPUT ... VOL ..$PKS2=VOLHere, VOL is assumed to have the value 500 on the datarecords. When the data is from a population, thisthird technique allows a unique value of VOL to besupplied for each individual.4.2. Alternative Parameterizations using $PK StatementsIt is possible to use an alternative parameterization whilestill using TRANS1. The reparameterization is performedwithin the $PK statements by explicitly computing themicroconstants from the alternative parameters. Such&quot;reparameterization&quot; statements are given in column 2 ofAppendix 2. They must follow the assignment statements thatgive the alternative parameters their values, as in thephenobarbital example of Chapter 2.The advantage of using $PK statements to reparameterize,rather than using a TRANS subroutine, is that theNONMEM-PREDPP load module will then always consist of thesame set of subroutines for a given choice of ADVAN, whichsimplifies the job of creating and running it. It will alsorun slightly faster. We assume in this document that thisapproach is taken.Other parameterizations are possible besides the ones inAppendix 2. For example, with ADVAN1 and TRANS1, one mightcode:CL=THETA(1)K=THETA(2)V=CL/KS1=VThe ability to express a large variety of modelingpossibilities with NONMEM-PREDPP provides great freedom andflexibility, but as always with flexible modelingcapability, certain pitfalls arise. Suppose, for example,that with a one compartment system the compartment amount,rather than the concentration is observed. With ADVAN1 andTRANS1 the statementsCL=THETA(1)V=THETA(2)K=CL/Vwill lead to difficulty because only the ratio of &theta;1 to &theta;2affects the amount in the compartment, and therefore, thedata do not allow &theta;1 and &theta;2 to be separately estimated. Thestatements should read:K=THETA(1)It is important to remember that only those elements of &theta;which affect the predictions of observations will beestimated by NONMEM. Here is some problematic code usingADVAN1 with TRANS1:K=THETA(1)V=THETA(2)CL=THETA(3)S1=VOnce again, NONMEM will be unable to produce separateestimates of all elements of &theta;. The kinetics of a simpleone compartment system cannot be determined by threeindependent parameters. With TRANS1, PREDPP itself does not&quot;know&quot; about the relationship K=CL/V which defines adependency among the parameters. Indeed, the parameters CLand V are both regarded as user-defined variables. Thevalue of &theta;3 has no effect on the prediction. Were it notfor the fact that S1 is set equal to V, the value of &theta;2would have no effect on the prediction either. With TRANS2this code is also incorrect for essentially the same reason.Here, K is regarded as a user-defined variable, and therelationship CL=K*V is not &quot;known&quot; to PREDPP. (PREDPP doesknow that CL/V is the rate constant of elimination, but itdoes not recognize the variable K as denoting this rateconstant, and &theta;1 has no effect on the prediction.)4.3. Scale ParametersScale parameters are mentioned in Section 2.1. Predictedcompartment amounts are divided by them and are thusconverted to predicted concentrations. They are only neededfor those compartments whose concentrations are directlyobserved. With ADVAN3, for example, the peripheralcompartment&rsquo;s scale S2 does need to be computed explicitlyif there are no observation events giving measured values ofconcentrations in the peripheral compartment. Predictedvalues for this compartment may still be plotted againsttime, for example, but these values need not be scaled drugamounts; the (unscaled) amount alone is sufficient to showthe shape of the curve. (The various volume parametersshown in Appendix 2 must be modeled when they are used asbasic parameters, but they need not be assigned as values tocompartment scale parameters.) Any scale parameter which isnot modeled by $PK statements is assumed to be 1 (i.e.,predicted values are always amounts).4.3.1. Scaling by a Known ConstantIn Chapter 3, Section 2.2.1, the units of V were changedfrom kiloliters to liters using the model:S=V/1000This can be coded in a $PK statementsimilar to the way it appears here,except that the compartment number mustbe specified:S1=V/1000Basic PK parameters may also be rescaled in thismanner.4.3.2. Scaling by a Parameter: Conditional Statements andIndicator VariablesIn Chapter 3, Section 2.2.2, the following model appeared:V, ifassayis1S=&#9129;hV,ifassayis2There are two ways this can be coded in $PK statements.The assay data item can be tested directly,or anindicator variablecan be used.Anindicator variableis a variable whose value is 0 or 1.It may be identified with an input data item, or it may be a user-definedvariable in the $PK statements.For example, suppose variable ASY is to beused as an indicator variable.If some input data item isgiven value 1 when assay 1 was used and value 0 when assay2 was used, then this data item could simply be named ASY on the$INPUT record.Suppose, however, that the assay number itself (1 or 2)was recorded in the dataand that we have named the data itemANUM on the $INPUT record.We must compute the user-defined variable ASY for use asan indicator variable.There are two ways this can be done: using a logical IFand using a block IF.1. ASY=1IF (ANUM.EQ.2) ASY=0Here, ASY is &quot;provisionally&quot; given the value 1. Thevalue is changed to 0 if the data indicates assay 2.2. IF (ANUM.EQ.1) THENASY=1ELSEASY=0ENDIFThe choice between these forms of IF is purely a matter ofstyle. Now let us assume that the compartment to be scaledis compartment 2, and that h is to be identified with &theta;5.The parameter S2 can now be coded unconditionally:S2=ASY*V+(1-ASY)*THETA(5)*VAlternatively, ANUM can be tested and ASY avoidedaltogether:1. S2=VIF (ANUM.EQ.2) S2=THETA(5)*V2. IF (ANUM.EQ.1) THENS2=VELSES2=THETA(5)*VENDIF4.3.3. Scaling by a Data ItemIf observations of urine concentration Cu are included inthe data (see e.g. Chapter 6, Section 9), it is necessary toprovide urine volume as a scale for the output compartment.Presumably, this volume varies between urine observationsand is recorded in the data records. Suppose this data itemis called UVOL in the $INPUT record. (The name given to thedata item has no special significance; any name could bechosen.) An additional $PK statement is necessary:S0=UVOLUVOL need be recorded on only those observation events towhich it applies, although it does no harm to record it onother event records. For example, it may well happen thatboth plasma and urine responses are measured at the sametime, so that there are two observation event records withthe same value of TIME, one for each compartment observed atthat time. As described in Section 3.2 above, $PKstatements are normally evaluated with every event record.Consider, for example, the sample data below. Assume thatthe Central compartment is compartment 2 and the outputcompartment is compartment 3. (Note the use of -3 tosignify that compartment 3 is to be turned off after theobservation time. The compartment will remain off until thetime another urine collection begins, as indicated with another type record; see Chapter 6, Section 7.4). Either 1.or 2. will produce the correct value of S0:1. Record UVOL on the event record to which it applies.The order of the records does not matter.TIME UVOL DV CMT10. 0 5.80 210. 100 .067 -32. Record UVOL on all event records having the same valueof TIME. The order of the records does not matter.TIME UVOL DV CMT10. 100 5.80 210. 100 .067 -3The following will not produce the correct value of S0unless PREDPP is instructed to evaluate the $PK statementsonly once for each distinct value of TIME:TIME UVOL DV CMT10. 100 5.80 210. 0 .067 -34.4. Bioavailability Fraction ParametersPK parameters of the form Fn, where n is the number of acompartment into which a dose may be introduced, arebioavailability fractions. If a dose record specifies adose for compartment n, the dose amount given on the eventrecord is multiplied by the value of Fn computed from the$PK statements evaluated with this record, and this productis the dose amount introduced into the system. For example,F1 multiplies the amount of dose which is to be added tocompartment 1. Any Fn which is not computed by $PKstatements is assumed to be 1 (i.e., the dose is 100%available).As an example, suppose two different preparations of thesame drug are administered, and it is assumed that theydiffer only in their bioavailability. The indicatorvariable (or data item) PREP has value 1 for the firstpreparation and 0 for the second. The ratio of thebioavailability of the second preparation to that of thefirst preparation is identified with &theta;6. Usually, themethod of drug administration permits this ratio to beestimated, but not the separate bioavailabilities. Withoutloss of generality, the bioavailability of the firstpreparation can be taken to be 1. Assuming the drug enterscompartment 1 of the model, there are three ways this can becoded:1. F1=PREP+(1-PREP)*THETA(6)2. F1=1IF (PREP.EQ.0) F1=THETA(6)3. IF (PREP.EQ.0) THENF1=THETA(6)ELSEF1=1ENDIFAgain, the choice is a matter of style.Once a dose is introduced into the dose compartment, itbegins to distribute into the other compartments. Whetheror not the original dose was 100% available, it is assumedthat none of the dose appearing in the dose compartment, andin other compartments after the dose is introduced, isfurther reduced due to bioavailability effects. PREDPPcannot model &quot;bioavailability effects&quot; between compartments.4.5. Output FractionThe Output Fraction parameter, F0, is an optional additionalPK parameter of every model. As discussed in Section 2above, every model contains an output compartment. If thiscompartment has been turned on prior to the advance fromtime tj&minus;1 to time tj, then the amount of drug lost from thesystem during this interval via elimination is multiplied byF0 and added to the prior contents of the outputcompartment. If the $PK statements do not include anassignment statement giving a value to F0, it is taken to be1 (i.e., 100% of the drug excreted goes to the outputcompartment). In model (4.7), an example of the use of F0is given. Assuming that the variables CLREN (renalclearance) and CL (total clearance) have been calculatedwith earlier $PK statements, the statementF0=CLREN/CLcan be used to compute F0.5. $PK Statements for Population DataWith population data, the structural models for the PKparameters tend to be more complicated than with individualdata. In addition, the influence of interindividual randomeffects needs to be described. These will involvedifferences in the $PK statements, but the same $SUBROUTINErecord and the same ADVAN and TRANS subroutines are used,and the same general requirements and examples of theearlier sections of this chapter still mostly apply. Inthis section, the models of Chapter 4 are implemented via$PK statements. Many of these models could be implementedin a variety of ways; an experienced programmer may preferto code them differently.With population data, we must distinguish between thetypical value of a PK parameter in the population and thevalue of that parameter for a given individual, theindividual&rsquo;s value. The typical value is computed by astructural model involving only fixed effects. We havechosen to denote it with the use of a tilde: e.g. Cl. Theindividual&rsquo;s value is computed by a model including randominterindividual effects (represented by random variables)and is denoted without a tilde: e.g., Cl. There is no tildecharacter in the FORTRAN character set, and with NM-TRAN wedo not need to distinguish typical and individual values.However, for purposes of clarity, in all the examples whichfollow we will include the letters TV (Typical Value) at thestart of those variable names which we think of as having atilde (e.g., TVCL). This is a matter of style.5.1. Structural Part of Parameter ModelsIn models such as (4.3), the subscript i indicates that themodel applies to the ith individual. As noted in Chapter 4,the subscript is not needed and, indeed, is not used in $PKstatements.5.1.1. Linear ModelsModels (4.4), (4.5a), (4.5b) and (4.6) can be coded as theyappear. Assuming that WT, AGE, and SECR are input dataitems or have been calculated with earlier $PK statements,the code is:TVCLM=THETA(1)*WTRF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFTVCL=TVCLM+TVCLR5.1.2. Multiplicative ModelsModel (4.4.1) can be coded as follows:TVLCLM=THETA(1)+THETA(2)*LOG(WT)TVCLM=EXP(TVLCLM)Model (4.4.2) can also be coded as it appears:TVCLM=THETA(1)*WT**THETA(2)5.1.3. Saturation ModelsModel (4.4.3) presents a problem. Subscripted variablesthat can appear in $PK statements are few; naturally, theyinclude THETA and (as seen below) ETA. The variable CPSScannot be subscripted, and a variable name such as CPSS2(rather than CPSS(2)) must be used for Cpss2. The model can &#9474;be coded exactly as it appears:TVCLM=WT*(THETA(1)-THETA(2)*CPSS2/(THETA(3)+CPSS2))5.1.4. Models with Indicator VariablesWhen dealing with typical values, indicator variables (0/1variables) can be used interchangeably with conditional (IF)statements, as we have already seen. Model (4.4.4) can becoded in a variety of ways, two of which are:1. TVCLM=(THETA(1)-THETA(2)*HF)*WT2. IF (HF.EQ.0) THENTVCLM=THETA(1)*WTELSETVCLM=(THETA(1)-THETA(2))*WTENDIF5.2. Population Random Effect ModelsRandom variables &eta; are used in the models forinterindividual errors. (With population models, randomvariables &epsilon; are used in the models for intraindividualerrors; see Chapter 4, Section 2.) In $PK statements theyare denoted by ETA(1), ETA(2), etc. Even if there is onlyonce such variable it must still be subscripted. It is thepresence of one or more such variables that indicates toNM-TRAN that the data is from a population. Just as thereis no particular need for certain &theta; elements to beidentified with certain PK parameters, there is noparticular need for certain &theta; elements to be associated withcertain &eta; variables, and any association need not beone-to-one. The following models are both valid:1. CL=THETA(1)+ETA(1)V=THETA(2)+ETA(2)2. CL=THETA(1)+ETA(2)V=THETA(2)+ETA(1)However, it will be easier to keep things straight if thefirst model is used.Here are three different ways of coding a model for anindividual&rsquo;s value of clearance:1. TVCL=THETA(1)CL=TVCL+ETA(1)2. CL=THETA(1)CL=CL+ETA(1)3. CL=THETA(1)+ETA(1)We prefer the first way because it clearly distinguishes themodel for the typical value from the model for theindividual&rsquo;s value. With any of the three ways for codingthe model the typical value of the parameter can be computedas follows: The &eta; variables are set to 0, and the parameteris computed. Any variable whose value depends on &eta;variables is called a rando______ variable_________Random variables are called true-value variables in the &#9474;first edition of this guide. This is because, in principle, &#9474;a random variable can assume an individual&rsquo;s true value &#9474;under the model. Such a variable is in contrast to a &#9474;variable which assumes only a typical value for the &#9474;population.An individual&rsquo;s true value is never actually known, althoughan estimate of it can be obtained. See Chapter 12, Sections4.11-4.13.5.3. Models for Interindividual ErrorsHere we show how to express the most commonly used modelsfor interindividual errors with $PK statements. Inaddition, all the error models described in Chapter 8 mayalso be used in $PK statements.5.3.1. Additive/Multiplicative ModelsThis is the error model of (4.9):K=TVK+ETA(1)This is the error model of (4.10):K=TVK*(1+ETA(1))This model can also be coded as:K=TVK+TVK*ETA(1)Here, the variable TVK has been &quot;multiplied through&quot;. Thechoice is a matter of style.5.3.2. Other ModelsThe model (4.11) may be coded as written.CLM=TVCLM+(1-ICU)*ETA(1)+ICU*ETA(2)It may also be coded with an IF statement. &#9474;IF (ICU.EQ.0) THENCLM=TVCLM+ETA(1)ELSECLM=TVCLM+ETA(2)ENDIFThe choice is a matter of style.Note that, under the parameterizations given in Appendices 1and 2, CLM is neither a basic nor an additional PKparameter, yet its model involves an &eta; variable. This islegitimate: any variable can be defined in terms of an &eta;variable. However, just as with &theta;&rsquo;s, the values assigned tothe &eta; variables must somehow affect the predictions ofobservations. Otherwise, the variance of some &eta; variablecannot be estimated, and consequently, none of the variancesof these variables can be estimated. Presumably, within the$PK statements, CLM is used to compute CL, and (eitherwithin the $PK statements or within the TRANS routine) CL isused to compute K.5.4. Restrictions on Random Variables &#9474;This section discusses the use of random variables in somedepth and may be skipped by the casual reader. The remarkshere apply to all random variables: both the ETA variablesof this chapter and the ERR/EPS variables of Chapter 8.In general, ETA variables can be used like any othervariables.Any variable whose value is affected by an ETA variable is arandom variable, whether the ETA variable occurs explicitlyin the defining expression for the random variable orwhether another random variable occurs in this expression.For example, consider the following:TVCLM=THETA(2)*WTCLM=TVCLM+ETA(2)RF=WT*(1.66-.011*AGE)/SECRTVCLR=THETA(4)*RFCLR=TVCLR+ETA(1)CL=CLM+CLRCL is a random variable, because it is computed from randomvariables. It depends on both &eta;1 and &eta;2.Random variables may be changed and may be assigned &#9474;conditionally, subject to the following restrictions. &#9474;A random variable may not appear anywhere within a &#9474;nested if structure. &#9474;A random variable defined in the $PK block may not be &#9474;redefined in the $ERROR block.As an example of the first restriction, suppose in the model(4.11) it is also believed that, for ICU patients, ageaffects CLM. The following code expresses the model, but isnot permitted:IF (ICU.EQ.1) THENIF (AGE.GE.50) THENTVCLM=THETA(1)ELSETVCLM=THETA(2)ENDIFCLM=TVCLM+ETA(1)ELSETVCLM=THETA(3)CLM=TVCLM+ETA(2)ENDIFAn alternate code follows, in which the calculation of TVCLM(which involves a nested IF) precedes the calculation of CLM(which does not require a nested IF). This code ispermitted.IF (ICU.EQ.1) THENIF (AGE.GT.50) THENTVCL=THETA(1)ELSETVCL=THETA(2)ENDIFELSETVCL=THETA(3)ENDIFIF (ICU.EQ.1) THENCL=TVCL+ETA(1)ELSECL=TVCL+ETA(2)ENDIFIndentations are used in the above code for clarity, buthave no affect on NM-TRAN&rsquo;s processing of the abbreviatedcode."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 8 -
$ERROR Record</b></p>

<h2>1. What This Chapter is AboutThis chapter tells how to write a simple $ERROR record forPREDPP. This chapter is meant to be read in parallel withChapters 3 and 4.2. $ERROR Abbreviated Code$ERROR abbreviated code consists of a block of $ERRO______statements___________ one per line. The $ERROR abbreviated code mustbe preceded by a record containing the characters &quot;$ERROR&quot;.This record and the abbreviated code constitute the $ERRO______record_______$ERROR statements describe the error model for PREDPP.These statements are very similar for individual data andfor population data. In fact, by making use of variablescalled ERR variables, the $ERROR statements are identicalfor both kinds of data.2.1. SyntaxThe syntax of a $ERROR record is very similar to that of a$PK record. Certain differences will be mentioned here.There must be an assignment statement giving a value to aspecial (reserved) variable Y. Y is a random variable &#9474;representing the random variable y (the modeledobservation). Y is usually defined in terms of a special(reserved) variable F, which represents the prediction forY. When the data are from a population, F is a random &#9474;variable. With individual data, ETA variables may be usedin the definition of Y. With population data, EPS variablesmay be used in the definition of Y. There are also specialrandom variables called ERR variables. The variable ERR(I)is the same as ETA(I) or EPS(I), depending on whether thedata are individual or population, respectively. For thepurpose of giving a general discussion, applying equally toboth individual and population data, ERR will be used in allthe examples in this chapter. (It is also useful to use ERRin $ERROR statements as a practical matter. Sometimes thesame data is analyzed from both the population and theindividual point of view. By using ERR variables, changes tothe NM-TRAN input file are minimized.) An ERR variable (aswith ETA and EPS variables) must always include a subscript(e.g., ERR(1)), even when there is only one such variable inthe model.Variables computed within $PK statements may be used in$ERROR statements, but not vice versa.2.2. When are $ERROR Statements Evaluated?$ERROR statements are normally evaluated with every event &#9474;record. This may be more frequent than is necessary.PREDPP can be instructed that the set of event records withwhich the $ERROR statements are evaluated is to be limitedto only observation events, once per individual record, oronce per problem. Such limitation does not apply to theSimulation Step (Chapter 12, Section 4.8). With theadditive (3.4) and constant coefficient of variation (3.5)error models, and with the exponential error model, NM-TRAN &#9474;instructs PREDPP to evaluate the $ERROR statements only onceper problem. Again, the CALL data item can be used to forceevaluation of the $ERROR statements with any event records.3. Error ModelsThe following sections show how the error models of Chapter3 are expressed using $ERROR statements.3.1. The Additive Error ModelThis is the error model (3.4):Y=F+ERR(1)Both examples in Chapter 2 use this error model. &#9474;3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsThis is the CCV error model (3.5):Y=F*(1+ERR(1))This error model can also be coded as:Y=F+F*ERR(1)Here, the variable F has been &quot;multiplied through&quot;. Thechoice is a matter of style.This is the exponential error model (3.5a): &#9474;Y=F*EXP(ERR(1))When the $ERROR statements consist solely of one of thesestatements (in any of the forms), the output from PREDPPwill include the message:ERROR IN LOG Y IS MODELEDThis is done because during data analysis NONMEM cannotdistinguish between the CCV error model y=f+f&epsilon; and theexponential error model y=fexp(&epsilon;), for whichlog(y)=log(f)+&epsilon;&dagger;. By using the latter model and modellingthe error in log(y) rather than in y, NM-TRAN enables PREDPPto achieve an improvement in run time.<cite>&dagger; During Simulation, NONMEM does distinguish between the CCVand exponential error models. </cite>3.3. Combined Additive and CCV Error ModelThis is the error model (3.6):Y=F+F*ERR(1)+ERR(2)3.4. The Power ModelThis is the error model (3.7):Y=F+F**P*ERR(1)The variable P must be assigned a value before its useabove. P is typically identified with an element of &theta; sothat it can be estimated in the fitting process. Let usassume that &theta;4 is chosen for this purpose. Then analternative coding is:Y=F+F**THETA(4)*ERR(1)3.5. Two Different Types of MeasurementsWe have already seen how an indicator variable, e.g., ASY,can be used in $PK statements for a variety of purposes.The same technique is used in $ERROR statements. Considermodel (3.8) where the variable ASY has the value 1 or 0,corresponding to assay 1 or assay 2. ASY is a data recorditem. Then the error model (3.8) is coded:Y=F+ASY*ERR(1)+(1-ASY)*ERR(2)This model can also be coded in several ways, the choice of &#9474;which is a matter of style.1) IF (ASY.EQ.1) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF2) IF (ASY.EQ.1) Y=F+ERR(1)IF (ASY.NE.1) Y=F+ERR(2)3) Y=F+ERR(2)IF (ASY.EQ.1) Y=F+ERR(1)3.6. Two Different Types of ObservationsIn Chapter 3, Section 3.6, an example is given in whichthere are two kinds of observations, plasma (C) and urine(Cu). With PREDPP, measurements from different compartmentsof the model are recorded in the DV data item of differentobservation event records. The CMT data item identifies thecompartment from which the prediction associated with theevent record is to be obtained. When the $ERROR statementsare evaluated for a given event record, the variable Fcontains the prediction from the compartment specified forthat event record. All that need be done is to select thecorrect error model, depending on the compartment. Suppose,for example, that ADVAN2 is used, so that the centralcompartment is compartment 2 and the output (urine)compartment is compartment 3. Then the error model (3.10)can be coded:TYP=0IF (CMT.EQ.2) TYP=1Y=F+TYP*ERR(1)+(1-TYP)*ERR(2)This model can also be coded in several ways, one of whichis shown here:IF (CMT.EQ.2) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF3.7. More than One Indicator VariableIn Chapter 3, Section 3.7, an example is given in whichthere are three kinds of observations. Suppose that thereare two data items, ASY1 and ASY2. ASY1 is 1 if assay 1 isused and 0 otherwise. ASY2 is 1 if assay 2 is used and 0otherwise. This is the error model (3.11):Y=F+ASY1*ERR(1)+ASY2*ERR(2)+(1-ASY1)*(1-ASY2)*ERR(3)This model can also be coded in several ways, one of whichis shown here:Y=F+ERR(3)IF (ASY1.EQ.1) Y=F+ERR(1)IF (ASY2.EQ.1) Y=F+ERR(2)
<a name="1. What This Chapter is AboutThis chapter tells how to write a simple $ERROR record forPREDPP. This chapter is meant to be read in parallel withChapters 3 and 4.2. $ERROR Abbreviated Code$ERROR abbreviated code consists of a block of $ERRO______statements___________ one per line. The $ERROR abbreviated code mustbe preceded by a record containing the characters &quot;$ERROR&quot;.This record and the abbreviated code constitute the $ERRO______record_______$ERROR statements describe the error model for PREDPP.These statements are very similar for individual data andfor population data. In fact, by making use of variablescalled ERR variables, the $ERROR statements are identicalfor both kinds of data.2.1. SyntaxThe syntax of a $ERROR record is very similar to that of a$PK record. Certain differences will be mentioned here.There must be an assignment statement giving a value to aspecial (reserved) variable Y. Y is a random variable &#9474;representing the random variable y (the modeledobservation). Y is usually defined in terms of a special(reserved) variable F, which represents the prediction forY. When the data are from a population, F is a random &#9474;variable. With individual data, ETA variables may be usedin the definition of Y. With population data, EPS variablesmay be used in the definition of Y. There are also specialrandom variables called ERR variables. The variable ERR(I)is the same as ETA(I) or EPS(I), depending on whether thedata are individual or population, respectively. For thepurpose of giving a general discussion, applying equally toboth individual and population data, ERR will be used in allthe examples in this chapter. (It is also useful to use ERRin $ERROR statements as a practical matter. Sometimes thesame data is analyzed from both the population and theindividual point of view. By using ERR variables, changes tothe NM-TRAN input file are minimized.) An ERR variable (aswith ETA and EPS variables) must always include a subscript(e.g., ERR(1)), even when there is only one such variable inthe model.Variables computed within $PK statements may be used in$ERROR statements, but not vice versa.2.2. When are $ERROR Statements Evaluated?$ERROR statements are normally evaluated with every event &#9474;record. This may be more frequent than is necessary.PREDPP can be instructed that the set of event records withwhich the $ERROR statements are evaluated is to be limitedto only observation events, once per individual record, oronce per problem. Such limitation does not apply to theSimulation Step (Chapter 12, Section 4.8). With theadditive (3.4) and constant coefficient of variation (3.5)error models, and with the exponential error model, NM-TRAN &#9474;instructs PREDPP to evaluate the $ERROR statements only onceper problem. Again, the CALL data item can be used to forceevaluation of the $ERROR statements with any event records.3. Error ModelsThe following sections show how the error models of Chapter3 are expressed using $ERROR statements.3.1. The Additive Error ModelThis is the error model (3.4):Y=F+ERR(1)Both examples in Chapter 2 use this error model. &#9474;3.2. The Constant Coefficient of Variation and Exponential &#9474;ModelsThis is the CCV error model (3.5):Y=F*(1+ERR(1))This error model can also be coded as:Y=F+F*ERR(1)Here, the variable F has been &quot;multiplied through&quot;. Thechoice is a matter of style.This is the exponential error model (3.5a): &#9474;Y=F*EXP(ERR(1))When the $ERROR statements consist solely of one of thesestatements (in any of the forms), the output from PREDPPwill include the message:ERROR IN LOG Y IS MODELEDThis is done because during data analysis NONMEM cannotdistinguish between the CCV error model y=f+f&epsilon; and theexponential error model y=fexp(&epsilon;), for whichlog(y)=log(f)+&epsilon;&dagger;. By using the latter model and modellingthe error in log(y) rather than in y, NM-TRAN enables PREDPPto achieve an improvement in run time.<cite>&dagger; During Simulation, NONMEM does distinguish between the CCVand exponential error models. </cite>3.3. Combined Additive and CCV Error ModelThis is the error model (3.6):Y=F+F*ERR(1)+ERR(2)3.4. The Power ModelThis is the error model (3.7):Y=F+F**P*ERR(1)The variable P must be assigned a value before its useabove. P is typically identified with an element of &theta; sothat it can be estimated in the fitting process. Let usassume that &theta;4 is chosen for this purpose. Then analternative coding is:Y=F+F**THETA(4)*ERR(1)3.5. Two Different Types of MeasurementsWe have already seen how an indicator variable, e.g., ASY,can be used in $PK statements for a variety of purposes.The same technique is used in $ERROR statements. Considermodel (3.8) where the variable ASY has the value 1 or 0,corresponding to assay 1 or assay 2. ASY is a data recorditem. Then the error model (3.8) is coded:Y=F+ASY*ERR(1)+(1-ASY)*ERR(2)This model can also be coded in several ways, the choice of &#9474;which is a matter of style.1) IF (ASY.EQ.1) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF2) IF (ASY.EQ.1) Y=F+ERR(1)IF (ASY.NE.1) Y=F+ERR(2)3) Y=F+ERR(2)IF (ASY.EQ.1) Y=F+ERR(1)3.6. Two Different Types of ObservationsIn Chapter 3, Section 3.6, an example is given in whichthere are two kinds of observations, plasma (C) and urine(Cu). With PREDPP, measurements from different compartmentsof the model are recorded in the DV data item of differentobservation event records. The CMT data item identifies thecompartment from which the prediction associated with theevent record is to be obtained. When the $ERROR statementsare evaluated for a given event record, the variable Fcontains the prediction from the compartment specified forthat event record. All that need be done is to select thecorrect error model, depending on the compartment. Suppose,for example, that ADVAN2 is used, so that the centralcompartment is compartment 2 and the output (urine)compartment is compartment 3. Then the error model (3.10)can be coded:TYP=0IF (CMT.EQ.2) TYP=1Y=F+TYP*ERR(1)+(1-TYP)*ERR(2)This model can also be coded in several ways, one of whichis shown here:IF (CMT.EQ.2) THENY=F+ERR(1)ELSEY=F+ERR(2)ENDIF3.7. More than One Indicator VariableIn Chapter 3, Section 3.7, an example is given in whichthere are three kinds of observations. Suppose that thereare two data items, ASY1 and ASY2. ASY1 is 1 if assay 1 isused and 0 otherwise. ASY2 is 1 if assay 2 is used and 0otherwise. This is the error model (3.11):Y=F+ASY1*ERR(1)+ASY2*ERR(2)+(1-ASY1)*(1-ASY2)*ERR(3)This model can also be coded in several ways, one of whichis shown here:Y=F+ERR(3)IF (ASY1.EQ.1) Y=F+ERR(1)IF (ASY2.EQ.1) Y=F+ERR(2)"></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 9 -
Additional NM-TRAN Records</b></p>

<h2>1. What This Chapter is AboutThis chapter tells how to give initial estimates to NONMEM&rsquo;sparameters ($THETA, $OMEGA, $SIGMA records); how to tellNONMEM what tasks to perform ($ESTIMATION, $COVARIANCErecords); and how to tell NONMEM what additional output toproduce ($TABLE, $SCATTERPLOT records).2. Providing Initial Estimates For &theta;: The $THETA RecordThis record provides an initial estimate (and, optionally,provides lower and upper bounds) for every element ofNONMEM&rsquo;s &theta; vector.2.1. Providing Initial Estimates For Elements Of &theta;The $THETA record contains a list of values, separated byspaces or commas, which are the initial estimates for the&theta;&rsquo;s used in the $PK and $ERROR statements. The position ofa value in the list corresponds to its position (subscript)in the &theta; vector. For example, consider the followingstatement:$THETA 1.7 .102 29.This says that the initial estimate for &theta;1 is 1.7, theinitial estimate for &theta;2 is .102, and the initial estimatefor &theta;3 is 29. Some users of NONMEM prefer to code eachvalue on a separate line so that they can include commentsto themselves describing the significance of the &theta;&rsquo;s. Theabove record could have been coded as follows:$THETA 1.7 ; RATE CONSTANT OF ABSORPTION.102 ; RATE CONSTANT OF ELIMINATION19. ; VOLUME OF DISTRIBUTIONThis is a matter of style.2.2. Providing Constraints for Elements of &theta;When NONMEM is told to estimate the parameters (Section 4.1,the Estimation Step, below), it varies the elements of &theta; tofind values which cause the model to fit the observationsbest. The values on the $THETA record are the initialestimates of &theta; for this search. When only an initialestimate is provided, NONMEM is free to chose any positiveor negative value for that element of &theta;. We then say thatthe &theta; element is unconstrained, which means that its lowerbound (lower limit) is &minus;&infin; and its upper bound (upper limit)is +&infin;. When finite bounds are desired, the initial estimateand its bounds must be enclosed in parentheses and specifiedin the order (lower, initial, upper). When the upper boundneedn&rsquo;t be finite, the initial estimate and its lower boundare enclosed in parentheses and specified in the order(lower, initial). Note that when no estimation isperformed, upper and lower bounds have no effect.In the theophylline example of Chapter 2, for example,negative &theta; values are physiologically impossible. Each &theta;element was given a lower bound of 0, which constrained itto be non-negative:$THETA (0, 1.7) (0, .102) (0, 29.)It is possible to mix constrained and unconstrained &theta;s; thiswas done in Chapter 2, figure 2.12:$THETA (0,.0027) (0,.70) .0018 .5An upper bound of +&infin; may be stated explicitly using thevalue 1000000 or the word INFINITY. Similarly, a lowerbound of &minus;&infin; may be stated explicitly as -1000000 or-INFINITY.2.3. Fixing Elements of &theta;When estimation is performed, it is sometimes desirable tohold one or more elements of &theta; to a constant value. Oneexample is when a full model is reduced to a simpler model,as discussed in Chapter 5, Section 2.1; usually this is doneby holding some &theta; element to 0. In fact, the value 0 maynot be used as an initial estimate for an element of &theta;unless this element is fixed to this value. A &theta; element isheld constant by inserting the word FIXED after the initialestimate. For example, the following statement allows &theta;1and &theta;3 to vary, but holds &theta;2 to the value .102:$THETA 1.7 .102 FIXED 29.Parentheses may be used to make the statement easier toread:$THETA 1.7 (.102 FIXED) 29.If the lower, initial, and upper values for an element of &theta;are identical, the element of &theta; is understood to be fixed,even if the word FIXED does not appear.2.4. How to Obtain Initial Estimates for &theta;When estimating parameters, good initial estimates for &theta; aresometimes important. Poor initial estimates mayoccasionally cause the NONMEM run to take excessive amountsof computer time, to produce parameter estimates that arenot physiologically reasonable, or to fail to produce anyparameter estimates at all. For some drugs and models,initial estimates for &theta; can be obtained from publishedliterature describing prior studies with the drug. For somestudies, very accurate values may have been obtained byprior runs with NONMEM or other regression programs. Highlyaccurate values should be perturbed (modified) by about 10%before being used as initial estimates in a NONMEM run.(Initial estimates that are too close to what may be theactual final estimates will cause problems in a NONMEM run;see Chapter 13.) Sometimes, however, there is littleguidance in choosing initial estimates for some elements of&theta;.One approach with population data, where there is areasonable amount of data for each individual, is asfollows. It is often easier to guess at appropriateparameter values for individual data than for populationdata. So, first estimate each individual&rsquo;s parameter valuesusing only the data from the individual. The mean values ofthe individuals&rsquo; parameter estimates can then be used as theinitial parameter estimates in the population analysis.Results from individual runs can also be used to obtaininitial estimates for elements of &Omega; and &Sigma;; see below.Another approach is simply to let NONMEM find an initialestimate. NONMEM has an automatic strategy for so doing;see Chapter 12, Section 4.4.3. Providing Initial Estimates for &Omega; and &Sigma;: the $OMEGA and$SIGMA RecordsRecall that &Omega; and &Sigma; are variance/covariance matrices for thefollowing random variables:Individual Model&Omega; (OMEGA) for &eta; (Random Intraindividual Variability)Population Model&Omega; (OMEGA) for &eta; (Random Interindividual Variability)&Sigma; (SIGMA) for &epsilon; (Random Intraindividual Variability)In all the examples in this document, &Omega; and &Sigma; are diagonalmatrices, in which covariance elements such as &omega;12 (which iscov(&eta;1,&eta;2)) are assumed to be zero. NONMEM also allows fullvariance/covariance matrices; this is beyond the scope ofthis text, but see Chapter 12, Section 4.1.Initial estimates for the variances must be provided toNONMEM via the $OMEGA and $SIGMA records. Initial estimatesof all model parameters (&theta;, &Omega;, and &Sigma;) must be provided evenif estimation is not requested. $OMEGA and $SIGMA recordseach contain a list of values, separated by spaces orcommas, which are the estimates for the correspondingvariances. As in the $THETA record, the position of a valuein the list corresponds to the position (subscript) of thecorresponding variance (along the diagonal) in the matrix.3.1. $OMEGA Record With Individual DataWith individual data, &eta; variables are used in $ERRORrecords, where they are called either ERR or ETA. Forexample, in the theophylline problem of Chapter 2 (figure2.1) there appear the records:$ERRORY=F+ERR(1)$OMEGA 1.2Here, ERR(1) corresponds to &eta;1, and the initial estimate forits variance is 1.2: i.e., &Omega;11=&omega;1=var(&eta;1)=1.2.3.2. $OMEGA Record With Population DataWith population data, &eta; variables are used in $PKstatements. For example, in the phenobarbital problem ofChapter 2 (figure 2.6) there appear the lines:CL=TVCL+ETA(1)V=TVVD+ETA(2)$OMEGA .0000055, .04The $OMEGA record says that the initial estimate for thevariance of &eta;1 is 5.5x10&minus;6, and of &eta;2 is .04: i.e.,&Omega;11=&omega;1=var(&eta;1)=5.5x10&minus;6 and &Omega;22=&omega;2=var(&eta;2)=.04. Some usersof NONMEM prefer to code each value on a separate line sothat they can include comments:$OMEGA .0000005 ; VARIANCE IN CL.04 ; VARIANCE IN V3.3. The $SIGMA RecordThis record is used only with population data, and issimilar to the $OMEGA record. It gives the initialestimates of the variances of the &epsilon; variables used in the$ERROR statements, where they are called either ERR or EPS.For example, in Figure 2.6, there also appears the records:$ERRORY=F+ERR(1)$SIGMA 25Here, ERR(1) corresponds to &epsilon;1, and the initial estimate forits variance is 25: i.e., &Sigma;11=&sigma;1=var(&epsilon;1)=25.3.4. Fixing Elements of &Omega; or &Sigma;It is sometimes desirable to hold one or more elements of &Omega;or &Sigma; to constant value(s). In the population example ofChapter 2 it is possible to ignore interindividualvariability in CL by fixing &eta;1 to 0&dagger;.<cite>&dagger; One could also re-write the $PK statements to eliminateETA(1) in the model for CL, which also requires that ETA(2)in the model for V be re-numbered as ETA(1). It is easierto modify only $OMEGA. </cite>The variance of an &eta; or &epsilon; variable is held constant byinserting the word FIXED after the initial estimate:$OMEGA 0 FIXED .0225Parentheses may be used to make the statement easier toread:$OMEGA (0 FIXED) .0225As with &theta;, the value 0 may not be used as an initialestimate for any element of &Omega; or &Sigma; unless the element isfixed to this value.3.5. How to Obtain Initial Estimates for &Omega; and &Sigma;The initial estimates for the variances will depend on theparticular (interindividual and/or intraindividual) errormodels chosen. The estimates do not have to be particularlyaccurate, although values which are much too small can causedifficulties for NONMEM. In general, it is better toover-estimate the variances rather than to under-estimatethem. As with initial estimates for &theta;, initial estimatescan sometimes be obtained from published literature or fromprior runs with NONMEM or other regression programs.Initial estimates can also be obtained by an approach whichwe illustrate with examples for both intraindividual andinterindividual error models. The standard deviation of aphysiological quantity is generally some fraction r of itstypical value t: &sigma;y=rt.For the additive model:y=f+&epsilon;&sigma;y=&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=(rt)2=r2t2Some ambiguity exists about what we mean by &quot;the typicalvalue&quot; of y. For the purpose of obtaining an initialestimate of the variance, we need not be too particularabout this. For the theophylline example (Figure 2.1), wemay choose the mean of the observed values as the typicalvalue. This value is approximately 5.4. Assuming 20%error, i.e. r=.2, then &sigma;&epsilon;=(.2x5.4)2=1.2. Similarly, in thefirst phenobarbital example (Figure 2.6), the mean of theobservations is approximately 25. Again assuming 20% error,then r=.2, and &sigma;&epsilon;=(.2x25)2=25. For that same example, thetypical value of CL was estimated according to the model forthe parameter: TVCL=THETA(1). We used the initial estimateof &theta;1, .0047, as the typical value of CL, and assumed 50%error: &Omega;11=(.5x.0047)2=5.5x10&minus;6. The model for V isTVVD=THETA(2). Again, we used the initial estimate of &theta;2,.99, as the typical value of V, but assumed 20% error:&Omega;22=(.2x.99)2=.04. Note finally that in the secondphenobarbital example (Figure 2.12), we used as initialestimates of variance the final estimates obtained from thefirst example (understanding that these estimates could besomewhat large due to some of the variability beingexplained in this example by a systematic influence ofweight).For the constant coefficient of variation model:y=f+f&epsilon;&sigma;y=f&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=r2ft22If we identify t with the value of f (whatever it may be),we have: var&epsilon;=r2In other words, using the CCV model, we do not need toestimate the typical value of the variable. For example,assuming 20% error, var&epsilon;=.22=.04.As with &theta;, it is possible for NONMEM itself to obtaininitial estimates of &Omega; and &Sigma; automatically; see Chapter 12,Section 4.4.4. Specifying Optional TasksTwo main tasks of NONMEM, the Estimation Step and theCovariance Step, are optional and must be specificallyrequested by including the $ESTIMATION and $COVARIANCErecords. To skip the Estimation Step, simply omit the$ESTIMATION record. To skip the Covariance Step, simplyomit the $COVARIANCE record.In every run NONMEM computes and prints the value of theobjective function and the final parameter estimates. Thevalues printed are based on the final parameter estimates ifthe Estimation Step is requested, and are based on theinitial estimates if it is not.4.1. Requesting the Estimation Step: the $ESTIMATION RecordIn the Estimation Step, NONMEM performs a search to obtainthose values of &theta;, &Omega;, and (for population studies) &Sigma; whichgive the lowest value of the objective function. The outputof this step is the pages whose titles are &quot;MONITORING OFSEARCH:&quot;, &quot;MINIMUM VALUE OF OBJECTIVE FUNCTION&quot;, and &quot;FINALPARAMETER ESTIMATE&quot;. This step is requested by the presenceof the following statement:$ESTIMATIONThere are several options, which are described in the NONMEMUsers Guide, Part IV. The most frequently used ones are asfollows.METHOD=0NONMEM always sets etas to 0 during the computation of &#9474;the objective function. Also called the &quot;first order &#9474;(FO) method.&quot; This is the default. It may also be &#9474;coded as METHOD=ZERO. &#9474;METHOD=1 &#9474;NONMEM uses conditional estimates for the etas during &#9474;the computation of the objective function. &#9474;METHOD=1 is also called the &quot;first order &#9474;conditional estimation (FOCE) method.&quot; It may also be &#9474;coded as METHOD=CONDITIONAL. When the option &#9474;INTERACTION is also present, the method is called the &#9474;&quot;FOCE with INTERACTION method&quot;. It is recommended for &#9474;continuous variables unless the data are very sparse. &#9474;These methods are discussed in Guide VII, Conditional &#9474;Estimation Methods.SIGDIGITS=nBy default, the search continues until the estimates ofall elements of &theta;, &Omega;, and &Sigma; have been determined to atleast 3 significant figures. Because only 3significant digits are used to print parameterestimates in the output, and for other reasons as well,this amount of accuracy is often sufficient. However,the SIGDIGITS option can be used to request a differentnumber (n) of significant digits.MAXEVAL=nThe Estimation Step always runs with a specific limiton the number of objective function evaluations allowedduring the search, as a protection against infiniteloops and excessively long runs. The default maximumis computed according to the number of parameters beingestimated. The MAXEVALS option can be used to requesta different number (n) for the maximum number offunction evaluations.PRINT=nAs the Estimation Step progresses, by default it printsintermediate output summarizing the progress of thesearch. The search proceeds in stages, callediterations. At the end of certain iterations asummarization is printed which consists of the valuesof the objective function, its gradient vector withrespect to the parameters, and the parameter valuesthemselves. By default, this summarization is onlyprinted for the first and last iterations. The PRINToption can be used to request a number (n) such thatstarting from the first iteration, only n-1 iterationsare skipped before another summarization is printed&dagger;.<cite>&dagger; The PRINT option can also be used to suppressintermediate printout altogether, but this shouldusually not be done because the information is often ofvalue. See Chapter 10, Section 4. </cite>An example of the use of these options is:$EST SIG=6,MAX=900,PRI=5In addition to the first and last iterations, summarizationsare printed every 5th iteration. Notice that abbreviationsof the record and option names were used; this is a matterof style.4.2. Requesting the Covariance Step: the $COVARIANCE RecordIn the Covariance Step, NONMEM obtains information on theprecision of the parameter estimates obtained in theEstimation Step. The output of this step are pages withtitles &quot;STANDARD ERROR OF ESTIMATE&quot;, &quot;COVARIANCE MATRIX OFESTIMATE&quot;, &quot;CORRELATION MATRIX OF ESTIMATE&quot;, and &quot;INVERSECOVARIANCE MATRIX OF ESTIMATE&quot;. This step is requested bythe presence of the following record:$COVARIANCEThere are several options, which are discussed in NONMEMUsers Guide, Part IV. The Covariance Step cannot berequested by itself; the Estimation Step must precede it&Dagger;.<cite>&Dagger; The Estimation Step may be omitted when the run iscontinued from a prior run using a Model Specification inputfile; see Chapter 12, Section 4.3, and Chapter 13, Section3.2. </cite>5. Specifying Optional Output$TABLE and $SCATTERPLOT records are used to request NONMEMsteps which generate additional output. If one of theserecords is omitted, NONMEM does not produce thecorresponding additional output. Tables and scatterplotsare generated after all other tasks have been performed.This affects the values displayed for PRED, RES, and WRES.If the Estimation Step is not run, then the initialestimates of the parameters are used to compute thesequantities. If the Estimation Step is run, then the finalparameter estimates are used. Residuals (RES) and weightedresiduals (WRES) are defined in Chapter 11, Section 4.4.2.The UNCONDITIONAL option of the $TABLE and $SCATTERPLOTrecords requests that output of this type be generated evenif the Estimation Step terminates unsuccessfully, and is thedefault. The CONDITIONAL option of these records requeststhat output of this type be generated only if the EstimationStep terminates successfully.5.1. Requesting the Table Step: the $TABLE RecordThe values of DV, PRED, RES, and WRES are always printed inevery table. Other data items to be printed should belisted on the record. The data items are printed in theorder in which they are listed. This does not have to bethe same order as in the data file, nor does every data itemhave to be listed. For example, the following recordappears in Chapter 2, figure 2.12:$TABLE ID TIME AMT WT APGRFigure 10.10 in Chapter 10 shows a portion of the resultingoutput.It is possible for the lines of a table to be sorted into adifferent order than that of the original input file; thisis discussed in the NONMEM Users Guide, Part IV.More than one table can be printed. A separate $TABLErecord is used to request each one.5.2. Requesting Scatterplots: the $SCATTERPLOT RecordChapter 2 contained many examples of $SCATTERPLOT recordsand the resulting output. Here, for example, are therecords from figure 2.6:$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS WTThe word UNIT requests a unit-slope line, which is the linePRED=DV. Figures 2.10 and 2.11 show the resulting output.Similarly, the word ORD0 can be used to request a zero lineon the ordinate axis.It is possible to generate several scatterplots with asingle record, by using a list of data item names:$SCATTERPLOT (PRED,RES,WRES) VS WTThis produces three scatterplots, and has the same effect asthe three records:$SCATTERPLOT PRED VS WT$SCATTERPLOT RES VS WT$SCATTERPLOT WRES VS WTSometimes it is desirable to partition a scatterplot into anumber of separate scatterplots. For example, if the datacontain both plasma and urine observations, it would bebetter to separate the scatterplot of PRED vs. DV into onescatterplot where the DV values are the plasma observations,and another one where the DV values are the urineobservations. To do this, it is necessary to specify apartitioning data item, in this case, the CMT data item,which gives the compartment number of the observation. Thefollowing record could be used.$SCATTERPLOT PRED VS DV BY CMT UNITThis will produce separate scatterplots: one with plasmaobservations (CMT=1 if ADVAN1 is used), and one with urineobservations (CMT=2 if ADVAN1 is used).Two partitioning items can also be specified:$SCATTERPLOT PRED VS DV BY CMT SEX UNITOne scatterplot is produced for each unique combination ofvalues of the two partitioning data items.6. Placement and Order of RecordsTwo main rules control the placement and order of recordswithin a NM-TRAN control file:The $INPUT record must appear before any records whichcontain data item names ($PK, $ERROR, $TABLE,$SCATTERPLOT)The $SUBROUTINE, $PK, and $ERROR records should appearin the indicated order, but do not have to beconsecutive.The records $DATA, $THETA, $OMEGA, $SIGMA, $ESTIMATION,$COVARIANCE, $TABLE, and $SCATTERPLOT can be placed anywhereamong the control records, in any order. However, NONMEMalways performs its tasks in a fixed order:Estimation StepCovariance StepTable StepScatterplot StepThus, even if the $TABLE record precedes the $ESTIMATIONrecord, the values of PRED, RES, and WRES in the table willbe based on the final parameter estimates. &#9474;7. INCLUDE records &#9474;One or more records of the form &#9474;INCLUDE filename n &#9474;may appear anywhere among the NM-TRAN control records. The &#9474;characters INCLUDE may be upper- or lower-case. &quot;n&quot; is an &#9474;optional integer, and gives the number of copies (default is &#9474;1). &#9474;NMTRAN opens the named file and reads it to end-of-file. &#9474;The contents of the named file may be any portion of an &#9474;NM-TRAN control stream, e.g., NM-TRAN control records and/or &#9474;abbreviated code. After reaching end-of-file, if the &#9474;number of copies is greater than 1, NM-TRAN rewinds the &#9474;file and re-reads it the specified number of times. After &#9474;reaching end-of-file on the final (or only) copy, NMTRAN &#9474;resumes reading the original control stream after the &#9474;include record. &#9474;There may be more than one INCLUDE record, but they may not &#9474;be nested. That is, an included file may not contain &#9474;INCLUDE records. &#9474;For example, &#9474;$PROBLEM Model &quot;a&quot; with data set 27, proportional error &#9474;INCLUDE data27.def &#9474;INCLUDE modela.def &#9474;$ERROR Y=F+F*ERR(1) &#9474;$THETA 1.3 4 &#9474;$OMEGA .04 &#9474;$SIGMA 1 &#9474;$ESTIMATION &#9474;The file data27.def contains the $INPUT and $DATA records. &#9474;The file modela.def contains the $SUBROUTINE record and $PK &#9474;block.
<a name="1. What This Chapter is AboutThis chapter tells how to give initial estimates to NONMEM&rsquo;sparameters ($THETA, $OMEGA, $SIGMA records); how to tellNONMEM what tasks to perform ($ESTIMATION, $COVARIANCErecords); and how to tell NONMEM what additional output toproduce ($TABLE, $SCATTERPLOT records).2. Providing Initial Estimates For &theta;: The $THETA RecordThis record provides an initial estimate (and, optionally,provides lower and upper bounds) for every element ofNONMEM&rsquo;s &theta; vector.2.1. Providing Initial Estimates For Elements Of &theta;The $THETA record contains a list of values, separated byspaces or commas, which are the initial estimates for the&theta;&rsquo;s used in the $PK and $ERROR statements. The position ofa value in the list corresponds to its position (subscript)in the &theta; vector. For example, consider the followingstatement:$THETA 1.7 .102 29.This says that the initial estimate for &theta;1 is 1.7, theinitial estimate for &theta;2 is .102, and the initial estimatefor &theta;3 is 29. Some users of NONMEM prefer to code eachvalue on a separate line so that they can include commentsto themselves describing the significance of the &theta;&rsquo;s. Theabove record could have been coded as follows:$THETA 1.7 ; RATE CONSTANT OF ABSORPTION.102 ; RATE CONSTANT OF ELIMINATION19. ; VOLUME OF DISTRIBUTIONThis is a matter of style.2.2. Providing Constraints for Elements of &theta;When NONMEM is told to estimate the parameters (Section 4.1,the Estimation Step, below), it varies the elements of &theta; tofind values which cause the model to fit the observationsbest. The values on the $THETA record are the initialestimates of &theta; for this search. When only an initialestimate is provided, NONMEM is free to chose any positiveor negative value for that element of &theta;. We then say thatthe &theta; element is unconstrained, which means that its lowerbound (lower limit) is &minus;&infin; and its upper bound (upper limit)is +&infin;. When finite bounds are desired, the initial estimateand its bounds must be enclosed in parentheses and specifiedin the order (lower, initial, upper). When the upper boundneedn&rsquo;t be finite, the initial estimate and its lower boundare enclosed in parentheses and specified in the order(lower, initial). Note that when no estimation isperformed, upper and lower bounds have no effect.In the theophylline example of Chapter 2, for example,negative &theta; values are physiologically impossible. Each &theta;element was given a lower bound of 0, which constrained itto be non-negative:$THETA (0, 1.7) (0, .102) (0, 29.)It is possible to mix constrained and unconstrained &theta;s; thiswas done in Chapter 2, figure 2.12:$THETA (0,.0027) (0,.70) .0018 .5An upper bound of +&infin; may be stated explicitly using thevalue 1000000 or the word INFINITY. Similarly, a lowerbound of &minus;&infin; may be stated explicitly as -1000000 or-INFINITY.2.3. Fixing Elements of &theta;When estimation is performed, it is sometimes desirable tohold one or more elements of &theta; to a constant value. Oneexample is when a full model is reduced to a simpler model,as discussed in Chapter 5, Section 2.1; usually this is doneby holding some &theta; element to 0. In fact, the value 0 maynot be used as an initial estimate for an element of &theta;unless this element is fixed to this value. A &theta; element isheld constant by inserting the word FIXED after the initialestimate. For example, the following statement allows &theta;1and &theta;3 to vary, but holds &theta;2 to the value .102:$THETA 1.7 .102 FIXED 29.Parentheses may be used to make the statement easier toread:$THETA 1.7 (.102 FIXED) 29.If the lower, initial, and upper values for an element of &theta;are identical, the element of &theta; is understood to be fixed,even if the word FIXED does not appear.2.4. How to Obtain Initial Estimates for &theta;When estimating parameters, good initial estimates for &theta; aresometimes important. Poor initial estimates mayoccasionally cause the NONMEM run to take excessive amountsof computer time, to produce parameter estimates that arenot physiologically reasonable, or to fail to produce anyparameter estimates at all. For some drugs and models,initial estimates for &theta; can be obtained from publishedliterature describing prior studies with the drug. For somestudies, very accurate values may have been obtained byprior runs with NONMEM or other regression programs. Highlyaccurate values should be perturbed (modified) by about 10%before being used as initial estimates in a NONMEM run.(Initial estimates that are too close to what may be theactual final estimates will cause problems in a NONMEM run;see Chapter 13.) Sometimes, however, there is littleguidance in choosing initial estimates for some elements of&theta;.One approach with population data, where there is areasonable amount of data for each individual, is asfollows. It is often easier to guess at appropriateparameter values for individual data than for populationdata. So, first estimate each individual&rsquo;s parameter valuesusing only the data from the individual. The mean values ofthe individuals&rsquo; parameter estimates can then be used as theinitial parameter estimates in the population analysis.Results from individual runs can also be used to obtaininitial estimates for elements of &Omega; and &Sigma;; see below.Another approach is simply to let NONMEM find an initialestimate. NONMEM has an automatic strategy for so doing;see Chapter 12, Section 4.4.3. Providing Initial Estimates for &Omega; and &Sigma;: the $OMEGA and$SIGMA RecordsRecall that &Omega; and &Sigma; are variance/covariance matrices for thefollowing random variables:Individual Model&Omega; (OMEGA) for &eta; (Random Intraindividual Variability)Population Model&Omega; (OMEGA) for &eta; (Random Interindividual Variability)&Sigma; (SIGMA) for &epsilon; (Random Intraindividual Variability)In all the examples in this document, &Omega; and &Sigma; are diagonalmatrices, in which covariance elements such as &omega;12 (which iscov(&eta;1,&eta;2)) are assumed to be zero. NONMEM also allows fullvariance/covariance matrices; this is beyond the scope ofthis text, but see Chapter 12, Section 4.1.Initial estimates for the variances must be provided toNONMEM via the $OMEGA and $SIGMA records. Initial estimatesof all model parameters (&theta;, &Omega;, and &Sigma;) must be provided evenif estimation is not requested. $OMEGA and $SIGMA recordseach contain a list of values, separated by spaces orcommas, which are the estimates for the correspondingvariances. As in the $THETA record, the position of a valuein the list corresponds to the position (subscript) of thecorresponding variance (along the diagonal) in the matrix.3.1. $OMEGA Record With Individual DataWith individual data, &eta; variables are used in $ERRORrecords, where they are called either ERR or ETA. Forexample, in the theophylline problem of Chapter 2 (figure2.1) there appear the records:$ERRORY=F+ERR(1)$OMEGA 1.2Here, ERR(1) corresponds to &eta;1, and the initial estimate forits variance is 1.2: i.e., &Omega;11=&omega;1=var(&eta;1)=1.2.3.2. $OMEGA Record With Population DataWith population data, &eta; variables are used in $PKstatements. For example, in the phenobarbital problem ofChapter 2 (figure 2.6) there appear the lines:CL=TVCL+ETA(1)V=TVVD+ETA(2)$OMEGA .0000055, .04The $OMEGA record says that the initial estimate for thevariance of &eta;1 is 5.5x10&minus;6, and of &eta;2 is .04: i.e.,&Omega;11=&omega;1=var(&eta;1)=5.5x10&minus;6 and &Omega;22=&omega;2=var(&eta;2)=.04. Some usersof NONMEM prefer to code each value on a separate line sothat they can include comments:$OMEGA .0000005 ; VARIANCE IN CL.04 ; VARIANCE IN V3.3. The $SIGMA RecordThis record is used only with population data, and issimilar to the $OMEGA record. It gives the initialestimates of the variances of the &epsilon; variables used in the$ERROR statements, where they are called either ERR or EPS.For example, in Figure 2.6, there also appears the records:$ERRORY=F+ERR(1)$SIGMA 25Here, ERR(1) corresponds to &epsilon;1, and the initial estimate forits variance is 25: i.e., &Sigma;11=&sigma;1=var(&epsilon;1)=25.3.4. Fixing Elements of &Omega; or &Sigma;It is sometimes desirable to hold one or more elements of &Omega;or &Sigma; to constant value(s). In the population example ofChapter 2 it is possible to ignore interindividualvariability in CL by fixing &eta;1 to 0&dagger;.<cite>&dagger; One could also re-write the $PK statements to eliminateETA(1) in the model for CL, which also requires that ETA(2)in the model for V be re-numbered as ETA(1). It is easierto modify only $OMEGA. </cite>The variance of an &eta; or &epsilon; variable is held constant byinserting the word FIXED after the initial estimate:$OMEGA 0 FIXED .0225Parentheses may be used to make the statement easier toread:$OMEGA (0 FIXED) .0225As with &theta;, the value 0 may not be used as an initialestimate for any element of &Omega; or &Sigma; unless the element isfixed to this value.3.5. How to Obtain Initial Estimates for &Omega; and &Sigma;The initial estimates for the variances will depend on theparticular (interindividual and/or intraindividual) errormodels chosen. The estimates do not have to be particularlyaccurate, although values which are much too small can causedifficulties for NONMEM. In general, it is better toover-estimate the variances rather than to under-estimatethem. As with initial estimates for &theta;, initial estimatescan sometimes be obtained from published literature or fromprior runs with NONMEM or other regression programs.Initial estimates can also be obtained by an approach whichwe illustrate with examples for both intraindividual andinterindividual error models. The standard deviation of aphysiological quantity is generally some fraction r of itstypical value t: &sigma;y=rt.For the additive model:y=f+&epsilon;&sigma;y=&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=(rt)2=r2t2Some ambiguity exists about what we mean by &quot;the typicalvalue&quot; of y. For the purpose of obtaining an initialestimate of the variance, we need not be too particularabout this. For the theophylline example (Figure 2.1), wemay choose the mean of the observed values as the typicalvalue. This value is approximately 5.4. Assuming 20%error, i.e. r=.2, then &sigma;&epsilon;=(.2x5.4)2=1.2. Similarly, in thefirst phenobarbital example (Figure 2.6), the mean of theobservations is approximately 25. Again assuming 20% error,then r=.2, and &sigma;&epsilon;=(.2x25)2=25. For that same example, thetypical value of CL was estimated according to the model forthe parameter: TVCL=THETA(1). We used the initial estimateof &theta;1, .0047, as the typical value of CL, and assumed 50%error: &Omega;11=(.5x.0047)2=5.5x10&minus;6. The model for V isTVVD=THETA(2). Again, we used the initial estimate of &theta;2,.99, as the typical value of V, but assumed 20% error:&Omega;22=(.2x.99)2=.04. Note finally that in the secondphenobarbital example (Figure 2.12), we used as initialestimates of variance the final estimates obtained from thefirst example (understanding that these estimates could besomewhat large due to some of the variability beingexplained in this example by a systematic influence ofweight).For the constant coefficient of variation model:y=f+f&epsilon;&sigma;y=f&sigma;&epsilon;=rtvar&epsilon;=&sigma;&epsilon;=r2ft22If we identify t with the value of f (whatever it may be),we have: var&epsilon;=r2In other words, using the CCV model, we do not need toestimate the typical value of the variable. For example,assuming 20% error, var&epsilon;=.22=.04.As with &theta;, it is possible for NONMEM itself to obtaininitial estimates of &Omega; and &Sigma; automatically; see Chapter 12,Section 4.4.4. Specifying Optional TasksTwo main tasks of NONMEM, the Estimation Step and theCovariance Step, are optional and must be specificallyrequested by including the $ESTIMATION and $COVARIANCErecords. To skip the Estimation Step, simply omit the$ESTIMATION record. To skip the Covariance Step, simplyomit the $COVARIANCE record.In every run NONMEM computes and prints the value of theobjective function and the final parameter estimates. Thevalues printed are based on the final parameter estimates ifthe Estimation Step is requested, and are based on theinitial estimates if it is not.4.1. Requesting the Estimation Step: the $ESTIMATION RecordIn the Estimation Step, NONMEM performs a search to obtainthose values of &theta;, &Omega;, and (for population studies) &Sigma; whichgive the lowest value of the objective function. The outputof this step is the pages whose titles are &quot;MONITORING OFSEARCH:&quot;, &quot;MINIMUM VALUE OF OBJECTIVE FUNCTION&quot;, and &quot;FINALPARAMETER ESTIMATE&quot;. This step is requested by the presenceof the following statement:$ESTIMATIONThere are several options, which are described in the NONMEMUsers Guide, Part IV. The most frequently used ones are asfollows.METHOD=0NONMEM always sets etas to 0 during the computation of &#9474;the objective function. Also called the &quot;first order &#9474;(FO) method.&quot; This is the default. It may also be &#9474;coded as METHOD=ZERO. &#9474;METHOD=1 &#9474;NONMEM uses conditional estimates for the etas during &#9474;the computation of the objective function. &#9474;METHOD=1 is also called the &quot;first order &#9474;conditional estimation (FOCE) method.&quot; It may also be &#9474;coded as METHOD=CONDITIONAL. When the option &#9474;INTERACTION is also present, the method is called the &#9474;&quot;FOCE with INTERACTION method&quot;. It is recommended for &#9474;continuous variables unless the data are very sparse. &#9474;These methods are discussed in Guide VII, Conditional &#9474;Estimation Methods.SIGDIGITS=nBy default, the search continues until the estimates ofall elements of &theta;, &Omega;, and &Sigma; have been determined to atleast 3 significant figures. Because only 3significant digits are used to print parameterestimates in the output, and for other reasons as well,this amount of accuracy is often sufficient. However,the SIGDIGITS option can be used to request a differentnumber (n) of significant digits.MAXEVAL=nThe Estimation Step always runs with a specific limiton the number of objective function evaluations allowedduring the search, as a protection against infiniteloops and excessively long runs. The default maximumis computed according to the number of parameters beingestimated. The MAXEVALS option can be used to requesta different number (n) for the maximum number offunction evaluations.PRINT=nAs the Estimation Step progresses, by default it printsintermediate output summarizing the progress of thesearch. The search proceeds in stages, callediterations. At the end of certain iterations asummarization is printed which consists of the valuesof the objective function, its gradient vector withrespect to the parameters, and the parameter valuesthemselves. By default, this summarization is onlyprinted for the first and last iterations. The PRINToption can be used to request a number (n) such thatstarting from the first iteration, only n-1 iterationsare skipped before another summarization is printed&dagger;.<cite>&dagger; The PRINT option can also be used to suppressintermediate printout altogether, but this shouldusually not be done because the information is often ofvalue. See Chapter 10, Section 4. </cite>An example of the use of these options is:$EST SIG=6,MAX=900,PRI=5In addition to the first and last iterations, summarizationsare printed every 5th iteration. Notice that abbreviationsof the record and option names were used; this is a matterof style.4.2. Requesting the Covariance Step: the $COVARIANCE RecordIn the Covariance Step, NONMEM obtains information on theprecision of the parameter estimates obtained in theEstimation Step. The output of this step are pages withtitles &quot;STANDARD ERROR OF ESTIMATE&quot;, &quot;COVARIANCE MATRIX OFESTIMATE&quot;, &quot;CORRELATION MATRIX OF ESTIMATE&quot;, and &quot;INVERSECOVARIANCE MATRIX OF ESTIMATE&quot;. This step is requested bythe presence of the following record:$COVARIANCEThere are several options, which are discussed in NONMEMUsers Guide, Part IV. The Covariance Step cannot berequested by itself; the Estimation Step must precede it&Dagger;.<cite>&Dagger; The Estimation Step may be omitted when the run iscontinued from a prior run using a Model Specification inputfile; see Chapter 12, Section 4.3, and Chapter 13, Section3.2. </cite>5. Specifying Optional Output$TABLE and $SCATTERPLOT records are used to request NONMEMsteps which generate additional output. If one of theserecords is omitted, NONMEM does not produce thecorresponding additional output. Tables and scatterplotsare generated after all other tasks have been performed.This affects the values displayed for PRED, RES, and WRES.If the Estimation Step is not run, then the initialestimates of the parameters are used to compute thesequantities. If the Estimation Step is run, then the finalparameter estimates are used. Residuals (RES) and weightedresiduals (WRES) are defined in Chapter 11, Section 4.4.2.The UNCONDITIONAL option of the $TABLE and $SCATTERPLOTrecords requests that output of this type be generated evenif the Estimation Step terminates unsuccessfully, and is thedefault. The CONDITIONAL option of these records requeststhat output of this type be generated only if the EstimationStep terminates successfully.5.1. Requesting the Table Step: the $TABLE RecordThe values of DV, PRED, RES, and WRES are always printed inevery table. Other data items to be printed should belisted on the record. The data items are printed in theorder in which they are listed. This does not have to bethe same order as in the data file, nor does every data itemhave to be listed. For example, the following recordappears in Chapter 2, figure 2.12:$TABLE ID TIME AMT WT APGRFigure 10.10 in Chapter 10 shows a portion of the resultingoutput.It is possible for the lines of a table to be sorted into adifferent order than that of the original input file; thisis discussed in the NONMEM Users Guide, Part IV.More than one table can be printed. A separate $TABLErecord is used to request each one.5.2. Requesting Scatterplots: the $SCATTERPLOT RecordChapter 2 contained many examples of $SCATTERPLOT recordsand the resulting output. Here, for example, are therecords from figure 2.6:$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS WTThe word UNIT requests a unit-slope line, which is the linePRED=DV. Figures 2.10 and 2.11 show the resulting output.Similarly, the word ORD0 can be used to request a zero lineon the ordinate axis.It is possible to generate several scatterplots with asingle record, by using a list of data item names:$SCATTERPLOT (PRED,RES,WRES) VS WTThis produces three scatterplots, and has the same effect asthe three records:$SCATTERPLOT PRED VS WT$SCATTERPLOT RES VS WT$SCATTERPLOT WRES VS WTSometimes it is desirable to partition a scatterplot into anumber of separate scatterplots. For example, if the datacontain both plasma and urine observations, it would bebetter to separate the scatterplot of PRED vs. DV into onescatterplot where the DV values are the plasma observations,and another one where the DV values are the urineobservations. To do this, it is necessary to specify apartitioning data item, in this case, the CMT data item,which gives the compartment number of the observation. Thefollowing record could be used.$SCATTERPLOT PRED VS DV BY CMT UNITThis will produce separate scatterplots: one with plasmaobservations (CMT=1 if ADVAN1 is used), and one with urineobservations (CMT=2 if ADVAN1 is used).Two partitioning items can also be specified:$SCATTERPLOT PRED VS DV BY CMT SEX UNITOne scatterplot is produced for each unique combination ofvalues of the two partitioning data items.6. Placement and Order of RecordsTwo main rules control the placement and order of recordswithin a NM-TRAN control file:The $INPUT record must appear before any records whichcontain data item names ($PK, $ERROR, $TABLE,$SCATTERPLOT)The $SUBROUTINE, $PK, and $ERROR records should appearin the indicated order, but do not have to beconsecutive.The records $DATA, $THETA, $OMEGA, $SIGMA, $ESTIMATION,$COVARIANCE, $TABLE, and $SCATTERPLOT can be placed anywhereamong the control records, in any order. However, NONMEMalways performs its tasks in a fixed order:Estimation StepCovariance StepTable StepScatterplot StepThus, even if the $TABLE record precedes the $ESTIMATIONrecord, the values of PRED, RES, and WRES in the table willbe based on the final parameter estimates. &#9474;7. INCLUDE records &#9474;One or more records of the form &#9474;INCLUDE filename n &#9474;may appear anywhere among the NM-TRAN control records. The &#9474;characters INCLUDE may be upper- or lower-case. &quot;n&quot; is an &#9474;optional integer, and gives the number of copies (default is &#9474;1). &#9474;NMTRAN opens the named file and reads it to end-of-file. &#9474;The contents of the named file may be any portion of an &#9474;NM-TRAN control stream, e.g., NM-TRAN control records and/or &#9474;abbreviated code. After reaching end-of-file, if the &#9474;number of copies is greater than 1, NM-TRAN rewinds the &#9474;file and re-reads it the specified number of times. After &#9474;reaching end-of-file on the final (or only) copy, NMTRAN &#9474;resumes reading the original control stream after the &#9474;include record. &#9474;There may be more than one INCLUDE record, but they may not &#9474;be nested. That is, an included file may not contain &#9474;INCLUDE records. &#9474;For example, &#9474;$PROBLEM Model &quot;a&quot; with data set 27, proportional error &#9474;INCLUDE data27.def &#9474;INCLUDE modela.def &#9474;$ERROR Y=F+F*ERR(1) &#9474;$THETA 1.3 4 &#9474;$OMEGA .04 &#9474;$SIGMA 1 &#9474;$ESTIMATION &#9474;The file data27.def contains the $INPUT and $DATA records. &#9474;The file modela.def contains the $SUBROUTINE record and $PK &#9474;block."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 10 -
Reading the Output</b></p>

<h2>1. What This Chapter is AboutThis chapter describes NONMEM&rsquo;s output in detail. Each pageof a NONMEM-PREDPP output file is shown and discussed.The input file to NM-TRAN is that of figure 2.12, which isreproduced here as figure 10.1 for convenience.1 $PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V2 $INPUT ID TIME AMT WT APGR DV3 $DATA INDATA4 $SUBROUTINE ADVAN15 $PK6 TVCL=THETA(1)+THETA(3)*WT7 CL=TVCL+ETA(1)8 TVVD=THETA(2)+THETA(4)*WT9 V=TVVD+ETA(2)10 ; THE FOLLOWING ARE REQUIRED BY PREDPP11 K=CL/V12 S1=V13 $ERROR14 Y=F+ERR(1)15 $THETA (0,.0027) (0,.70) .0018 .516 $OMEGA .000007, .317 $SIGMA 818 $ESTIMATION PRINT=519 $COVARIANCE20 $TABLE ID TIME AMT WT APGR DV21 $SCATTER PRED VS DV UNIT22 $SCATTER RES VS WTFigure 10.1. The NM-TRAN input file (same as figure 2.12).The line numbers on the left are not actually part of thefile.2. NONMEM Describes its InputsThe first page of NONMEM&rsquo;s output is shown in figure 10.2.In this page, NONMEM repeats (&quot;echos&quot;) the instructions itwas given in the control file and describes the data file.The first page of the output should be checked carefully.Problems in a NONMEM run can often be traced to errors inthe problem specification. For example, always check thatthe initial parameter estimates were entered correctly.1 NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) DOUBLE PRECISION NONMEM VERSION IV LEVEL 1.02 DEVELOPED AND PROGRAMMED BY STUART BEAL AND LEWIS SHEINER34 PROBLEM NO. 15 PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V67 DATA CHECKOUT RUN: NO8 DATA SET LOCATED ON UNIT NO.: 29 THIS UNIT TO BE REWOUND: NO10 NO. OF DATA RECS IN DATA SET: 74411 NO. OF DATA ITEMS IN DATA SET: 812 ID DATA ITEM IS DATA ITEM NO.: 113 DEP VARIABLE IS DATA ITEM NO.: 614 MDV DATA ITEM IS DATA ITEM NO.: 81516 INDICES PASSED TO SUBROUTINE PRED ARE:17 7 2 3 0 0 0 0 0 018 0 01920 LABELS FOR DATA ITEMS ARE:21 ID TIME AMT WT APGR DV EVID MDV2223 FORMAT FOR DATA IS:24 (6E6.0,2F2.0)2526 TOT. NO. OF OBS RECS: 15527 TOT. NO. OF INDIVIDUALS: 592829 LENGTH OF THETA: 43031 OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 23233 SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 13435 INITIAL ESTIMATE OF THETA:36 LOWER BOUND INITIAL EST UPPER BOUND37 0.0000E+00 0.2700E-02 0.1000E+0738 0.0000E+00 0.7000E+00 0.1000E+0739 -0.1000E+07 0.1800E-02 0.1000E+0740 -0.1000E+07 0.5000E+00 0.1000E+074142 INITIAL ESTIMATE OF OMEGA:43 0.7000E-0544 0.0000E+00 0.3000E+004546 INITIAL ESTIMATE OF SIGMA:47 0.8000E+014849 ESTIMATION STEP OMITTED: NO50 NO. OF FUNCT. EVALS. ALLOWED: 36051 NO. OF SIG. FIGURES REQUIRED: 352 INTERMEDIATE PRINTOUT: YES53 MSF OUTPUT: NO5455 COVARIANCE STEP OMITTED: NO56 EIGENVLS. PRINTED: NO57 SPECIAL COMPUTATION: NO5859 TABLES STEP OMITTED: NO60 NO. OF TABLES: 161 TABLES PRINTED: YES6263 USER-CHOSEN DATA ITEMS FOR TABLE 1,64 IN THE ORDER THEY WILL APPEAR IN THE TABLE, ARE:65 ID TIME AMT WT APGR6667 SCATTERPLOT STEP OMITTED: NO68 NO. OF PAIRS OF ITEMS GENERATING69 FAMILIES OF SCATTERPLOTS: 27071 ITEMS TO BE SCATTERED ARE: DV PRED72 UNIT SLOPE LINE INCLUDED73 ITEMS TO BE SCATTERED ARE: WT RESFigure 10.2. The first page of the output report. The linenumbers on the left are not actually part of the report.Line 5 is an identification line for the output report. Thecontents of the $PROBLEM record are shown here.Line 7 indicates that this is not a data checkout run. (Datacheckout mode is discussed in Chapter 12 Section 4.10.)Lines 8 through 27 describe the input data file. Lines 10and 11 describe the numbers of rows and columns in the inputfile, as shown in figure 6.1. Specifically, line 10 showshow many data records were read according to the FORTRANformat specification given in line 24. Line 11 describesthe number of data items per record, which is the number ofdata items listed in the $INPUT record, less any that weredropped by the Data Preprocessor, plus any that it added(see Chapter 6). Lines 12, 13, and 14 describe thelocations of those data items of interest to NONMEM itself(i.e. NONMEM data items). Lines 16 through 18 are discussedin Section 3. Line 21 gives the labels for all the dataitems. The first six labels are those of the data itemsspecified in the $INPUT record and the next two (EVID, MDV)are those of two data items added to the data set by theData Preprocessor. (NONMEM itself supplies labels PRED,RES, and WRES for the prediction, residual, and weightedresidual data items.) In the terminology of Chapter 4 (e.g.(4.15a)), ID, TIME, AMT, WT, and APGR are the elements of x;DV is y; PRED is f (evaluated for the typical individual inthe population). Line 24 shows the format used to read eachdata record. In this example, the format was generated bythe Data Preprocessor and describes the data file afterprocessing by the Data Preprocessor.&dagger;<cite>&dagger; When a format specification is supplied on the $DATArecord, and no data items are dropped or added by the DataPreprocessor, the original format specification is usedunchanged and appears here. </cite>Line 26 gives the number of observation records. Line 27gives the number of individual records; that is, one lessthan the number of times that the ID data item changedvalue.Lines 29 through 47 describe the contents of the $THETA,$OMEGA and $SIGMA records. First, the number of elements of&theta;, &Omega; and &Sigma; are given (lines 29, 31 and 33), then theirinitial estimates are displayed. In lines 38-41, notice thevalues 0.1000e+07 and -0.1000e+07. These are NONMEM&rsquo;s wayof expressing the values +&infin; and &minus;&infin;; i.e., of describing &theta;swhich are unbounded on one or both sides. Another FORTRANsystem may display these numbers differently (e.g.,1.0000e+06), but the absolute value will always be1,000,000. In lines 43 and 44, notice that the variancesfrom the $OMEGA record appear along the diagonal of the &Omega;matrix, and that the off-diagonal element cov(&eta;1,&eta;2) iszero. Line 31 states that NONMEM understands &Omega; to bediagonal; the off-diagonal element(s) are automaticallyfixed at zero.The remaining lines of figure 10.2 describe the tasks thatNONMEM will perform. Lines 49 through 53 describe the$ESTIMATION record. Lines 50 through 53 show the defaults(set by NM-TRAN) for various options, all of which couldhave been specified explicitly on the $ESTIMATION record.In line 50 for example, NONMEM displays the maximum numberof times it will evaluate the objective function during theEstimation Step (this number can be slightly exceeded). Thevalue 360 was supplied by NM-TRAN. It is a function of thesizes of &theta;, &Omega;, and &Sigma;. Line 51 displays the desired numberof significant digits in the final parameter estimate; thevalue 3 is the default number requested by NM-TRAN.Lines 55 through 59 describe the $COVARIANCE record, givingthe default options chosen by NM-TRAN.Lines 59 through 61 describe the $TABLE record. Lines 67through 73 describe the $SCATTERPLOT records.3. PREDPP Describes Its InputsThe next two pages are produced by PREDPP and will notappear if $PRED statements (or a user-written PREDsubroutine) are used. PREDPP uses these pages to repeat(&quot;echo&quot;) the instructions it was given in the control file,and to identify the ADVAN and TRANS routines chosen by theuser. The first page of PREDPP&rsquo;s output is shown in figure10.3. 1 DOUBLE PRECISION PRED VERSION III LEVEL 1.023 ONE COMPARTMENT MODEL (ADVAN1)45 MAXIMUM NO. OF BASIC PK PARAMETERS: 267 BASIC PK PARAMETERS (AFTER TRANSLATION):8 ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 191011 COMPARTMENT ATTRIBUTES12 COMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULT13 STATUS ALLOWED ALLOWED FOR DOSE FOR OBS.14 1 CENTRAL ON NO YES YES YES15 2 OUTPUT OFF YES NO NO NOFigure 10.3. The first page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.In its first page of output, PREDPP describes the featuresof the pharmacokinetic model and its parameterizationencoded into the ADVAN and TRANS routines specified on the$SUBROUTINE record. The information displayed here includesthe kind of information summarized in Appendices 1 and 2.In the particular output of Figure 10.3 no informationconcerning an alternate parameterization appears becauseTRANS1 was specified. The information concerning basicparameters and compartments is displayed in a format similarto that used in NONMEM Users Guide, Part VI, which is thecomplete reference for PREDPP.Lines 5 and 8 describe the basic PK parameters, which inthis example is the single microconstant K. If a translatorother than TRANS1 had been requested, an additional linewould appear describing the translation. E.g., with TRANS2,this line would read:TRANSLATOR WILL CONVERT PARAMETERS CLEARANCE (CL) AND VOLUME(V) to KLines 10 through 14 describe the compartment attributes.Even though the output compartment is never turned on by thedata of this example, its attributes are described herebecause it is part of the model.The information presented so far describes the model forcomputing drug amounts. For a given choice of ADVAN andTRANS, the contents of this page are completely fixed.PREDPP&rsquo;s second page of output describes user choicesrelated to the given ADVAN routine, including choices forthe scale parameters (and thus, to the model for computingconcentrations). This page is shown in figure 10.4.1 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG2 COMPT. NO. INDICES3 SCALE BIOAVAIL. ZERO-ORDER ZERO-ORDER ABSORB4 FRACTION RATE DURATION LAG5 1 3 * * * *6 2 * - - - -7 - PARAMETER IS NOT ALLOWED FOR THIS MODEL8 * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;9 WILL DEFAULT TO ONE IF APPLICABLE1011 DATA ITEM INDICES USED BY PRED ARE:12 EVENT ID DATA ITEM IS DATA ITEM NO.: 713 TIME DATA ITEM IS DATA ITEM NO.: 214 DOSE AMOUNT DATA ITEM IS DATA ITEM NO.: 3151617 PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.18 PK SUBROUTINE NOT CALLED AT ADDITIONAL DOSE OR LAGGED DOSE TIMES.1920 DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.21 OTHERWISE, ERROR SUBROUTINE CALLED ONCE IN THIS PROBLEM.Figure 10.4. The second page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.Lines 2 through 9 describe the additional PK parameters thatare computed by the $PK statements (or PK subroutine). Inline 5, the position marked with &quot;3&quot; corresponds to thescale parameter for compartment number 1. Thus, we knowthat the $PK statements contained an assignment statementfor S1. From the prior page we can see that compartmentnumber 1 is the central compartment. The value &quot;3&quot; is a rownumber within GG, an array used for communication betweenPREDPP and the PK subroutine. With the use of NM-TRAN and$PK statements, row numbers are of no interest to the user.With a user-written PK subroutine, it is important to checktheir correctness. Positions marked with &quot;*&quot; correspond toadditional PK parameters that are allowed by the model butthat are not assigned a value by $PK statements; an exampleis F1, the bioavailability fraction for compartment 1.Positions marked with &quot;-&quot; correspond to additionalparameters that may not be computed; for instance,dose-related parameters are not allowed for the outputcompartment, because (as shown on the preceding page) thiscompartment cannot receive doses.Lines 11 through 14 describe the locations in the input datarecord of those data items of interest to PREDPP (PREDPPdata items). (NM-TRAN causes the locations of these dataitems in the data set to be passed by NONMEM to PREDPP, asindicated in lines 15 through 17 of figure 10.2. NONMEM isnot concerned with the significance of these data items.)Note that data item 7, Event ID, was appended by the DataPreprocessor.Line 17 reflects the fact that, by default, $PK statementsare evaluated with every event record&dagger;. Lagged andadditional doses are discussed in Chapter 12, Sections 2.4and 2.5. They are not used in this example.<cite>&dagger; In this example, the $PK statements (lines 5 through 12 ofthe input file, figure 10.1) involve only WT, which isconstant for each individual. It is possible to limit theevent records with which the $PK statements are evaluated tothe first event record of each individual, in order toreduce run time. This decision is left to the user. </cite> &#9474;Line 21 reflects the fact that the $ERROR statementsdescribe the simple error model (3.4). This model uses nodata items and no elements of &theta; whatsoever (directly orindirectly). NM-TRAN has instructed PREDPP that the $ERRORstatements need be evaluated only once at the beginning ofthe problem. Line 20 indicates that, should the SimulationStep be implemented, PREDPP will disregard this limitationand evaluate the $ERROR statements with every event record,so that randomly-generated values of intra-individual errorcan be applied at every observation event. (This exampledoes not involve simulation, but the PK and ERROR routineswhich implement the $PK and $ERROR statements are capable ofsupporting all NONMEM tasks, including simulation.)Finally, note that the $PK and $ERROR models (figure 10.1,lines 5-14) are not documented in the NONMEM-PREDPP output.It is a good idea to attach a printed copy of the NM-TRANinput records to the corresponding NONMEM output. MS/DOS &#9474;batch file nmfe72.bat and Unix C-shell script nmfe72 &#9474;(supplied with NONMEM) do this automatically.4. Diagnostic Output from the Estimation StepThe next page of output, figure 10.5, is produced during therunning of the Estimation Step.1 MONITORING OF SEARCH:234 ITERATION NO.: 0 OBJECTIVE VALUE: 0.6757E+03 NO. OF FUNC. EVALS.: 85 CUMULATIVE NO. OF FUNC. EVALS.: 86 PARAMETER: 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+007 GRADIENT: -0.7986E+03 -0.1594E+04 -0.4294E+03 -0.1000E+04 0.1542E+03 0.5269E+03 0.9128E+0289 ITERATION NO.: 5 OBJECTIVE VALUE: 0.6502E+03 NO. OF FUNC. EVALS.:1010 CUMULATIVE NO. OF FUNC. EVALS.: 5811 PARAMETER: 0.8878E-01 0.1003E+00 0.2055E+00 0.1296E+00 0.6695E-01 0.7822E-01 0.1071E+0012 GRADIENT: 0.1060E+04 0.2567E+04 0.3675E+03 0.8472E+03 -0.1807E+03 -0.5093E+03 0.9841E+021314 ITERATION NO.: 10 OBJECTIVE VALUE: 0.6153E+03 NO. OF FUNC. EVALS.: 915 CUMULATIVE NO. OF FUNC. EVALS.: 10716 PARAMETER: 0.5008E-01 0.6626E-01 0.2425E+00 0.1663E+00 -0.6718E-01 0.6382E-01 0.1004E+0017 GRADIENT: 0.9732E+02 0.3034E+03 0.3185E+02 0.1228E+03 -0.1162E+03 0.1252E+03 0.6450E+021819 ITERATION NO.: 15 OBJECTIVE VALUE: 0.6108E+03 NO. OF FUNC. EVALS.: 920 CUMULATIVE NO. OF FUNC. EVALS.: 15221 PARAMETER: 0.4235E-01 0.4508E-01 0.2462E+00 0.1831E+00 -0.5721E-01 0.5237E-01 0.1008E+0022 GRADIENT: 0.3989E+02 0.7394E+02 -0.1782E+01 0.8527E+02 -0.9309E+02 0.1867E+02 -0.1773E+022324 ITERATION NO.: 20 OBJECTIVE VALUE: 0.6095E+03 NO. OF FUNC. EVALS.: 925 CUMULATIVE NO. OF FUNC. EVALS.: 19726 PARAMETER: 0.1927E-01 0.3153E-01 0.2615E+00 0.1898E+00 -0.4458E-01 0.4904E-01 0.1047E+0027 GRADIENT: 0.1609E+02 -0.3621E+02 0.5228E+01 0.9614E+00 -0.1740E+02 0.1329E+02 0.3111E+012829 ITERATION NO.: 25 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 930 CUMULATIVE NO. OF FUNC. EVALS.: 24231 PARAMETER: 0.2389E-02 0.4171E-01 0.2652E+00 0.1833E+00 -0.4413E-01 0.4998E-01 0.1043E+0032 GRADIENT: 0.2273E+01 -0.5333E+01 0.3914E+01 -0.5397E+01 0.1271E+01 0.2610E+01 0.3584E+003334 ITERATION NO.: 30 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.:1635 CUMULATIVE NO. OF FUNC. EVALS.: 29936 PARAMETER: -0.1278E-03 0.4166E-01 0.2650E+00 0.1835E+00 -0.4414E-01 0.5003E-01 0.1043E+0037 GRADIENT: -0.1120E+00 -0.9411E+00 -0.3719E+00 -0.2540E+01 -0.5135E-01 0.1420E+00 -0.9524E-013839 ITERATION NO.: 32 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 040 CUMULATIVE NO. OF FUNC. EVALS.: 31541 PARAMETER: -0.7284E-05 0.4150E-01 0.2650E+00 0.1836E+00 -0.4411E-01 0.5003E-01 0.1043E+0042 GRADIENT: -0.6416E-02 0.9336E-01 0.4548E-01 0.4826E-01 0.1263E-02 0.9652E-01 0.4629E-014344 MINIMIZATION SUCCESSFUL45 NO. OF FUNCTION EVALUATIONS USED: 31546 NO. OF SIG. DIGITS IN FINAL EST.: 3.9Figure 10.5. The output from the Estimation Step. The linenumbers on the left are not actually part of the report.4.1. Intermediate Output from the Estimation StepLines 1 through 42 are referred to as the intermediateoutput. Lines 4 through 7 give numbers summarizing the 0-thiteration, which are based on the initial parameterestimates. Line 4 shows the initial value of the objectivefunction. The value following &quot;NO. OF FUNC. EVALS.&quot; is thenumber of objective function evaluations which were neededduring the iteration. Line 5 gives the cumulative number offunction evaluations including this and all prior iterationsummaries.Line 6 gives the unconstraine_____________ paramete_________ (UCP_____ estimates. &#9474;The search is carried out in a different parameter space. &#9474;The parameters are transformed to unconstrained parameters &#9474;(UCP). In the transformation process a scaling occurs so &#9474;that the initial estimate of each of the UCP is 0.1.Thus, in line 6, all parameters are .1 at the 0-thiteration. Parameters are printed in the following order:elements of &theta;, elements of &Omega;, elements of &Sigma;. In thisexample, reading from left to right, the parameters are &theta;1,&theta;2, &theta;3, &theta;4, &Omega;11, &Omega;22, and &Sigma;11.Two points should be noted. First, fixed parameters do notappear in the list. Therefore, the off-diagonal element&Omega;12, which is effectively fixed to 0, does not appear.Second, when off-diagonal elements of &Omega; are being estimated,then as many additional UCP&rsquo;s appear as there areoff-diagonal elements of &Omega; being estimated. However, a 1-1correspondence between each of the elements of &Omega; and an UCPdoes not exist. The same is true for elements of &Sigma; and theUCP&rsquo;s for &Sigma; when off-diagonal elements of &Sigma; are estimated. &#9474;With NONMEM 7, the parameter estimates are also &#9474;displayed in their natural (unscaled) space. These lines &#9474;are identified as NPARAMETR and precede the PARAMETER &#9474;lines, which display the UCP values.Line 7 shows the gradient for each parameter, which may bethought of as the partial derivative of the objectivefunction with respect to that parameter.The Estimation Step proceeds in a series of stages callediterations. In this example, intermediate printout isproduced for each of every 5 iterations, as well as for the0-th and final iterations, for which intermediate printoutis always printed by default. This printout consists of thesame four lines as for the 0-th iteration, but using theparameters estimates obtained at the end of the iteration.In lines 4, 9, 14, 19, 24, 29, 34, and 39, observe that theobjective function drops quickly at first, and then moreslowly. After iteration number 25, there is no change abovethe fourth significant digit.In lines 6, 11, 16, 21, 26, 31, 36, and 41, observe thateach parameter also changes rapidly at first and then moreslowly as it converges to its final value. (The firstparameter, &theta;1, is an exception. It is clearly approaching avery small value close to its lower bound, 0. In Chapter12, we shall see that both &theta;1 and &theta;2 are best fixed at 0.)Finally, in lines 7, 12, 17, 22, 27, 32, 37, and 42, observethat the gradients also approach 0, another sign that aminimum of the objective function has been located.The values computed for the gradients are very sensitive todifferences in computer arithmetic and precision. If agiven NONMEM run is repeated on a different computer, or onthe same computer with different machine precision or adifferent FORTRAN compiler, it is likely that the gradientswill be different. This will cause the search to follow adifferent path to the minimum, so that lines 4 through 42may be quite different. However, each final estimate of aUCP should always be the same to the number of requestedsignificant digits. (Minor differences may also be observedin the output of the Covariance Step, below; this output isalso sensitive to computational differences.)4.2. Summary Output from the Estimation StepLines 44, 45 and 46 are always printed, even whenintermediate printout is suppressed. Line 44, &quot;MINIMIZATIONSUCCESSFUL&quot;, signifies that the search appears to havelocated a minimum of the objective function. Before one canbe certain that a minimum has been located, or one whichcorresponds to a reasonable parameter estimate (there can bea number of &quot;local minima&quot;), the final parameter estimatesmust be examined in their (untransformed) state; see Section5 below. The Estimation Step is not always successful.Chapter 13 discusses two other messages that sometimesappear instead of line 44.In line 45, note that the number of function evaluationsused, 315, is a total value and includes all iterations (notjust those for which intermediate printout was displayed).This is under the limit of 360 supplied by NM-TRAN (figure10.2, line 57).The number of significant digits in the final estimate isgiven in line 34 as 3.9. This can be interpreted as meaningthat no (transformed) parameter estimate is actuallydetermined to less than 3.9 significant digits. Morespecifically, when the UCP estimates were compared betweenthe last two iterations, none differed in the first (almost)4 significant figures including leading zeros after thedecimal point. Note that the final &theta;1 UCP estimate is-0.7284E-05, and so the 7284 are not significant digits atall! Because NONMEM displays only 3 significant digits inthe printed parameter estimates, and for other reasons aswell, by default NM-TRAN requests only 3 significant digits.However, more significance can be requested, as wasdiscussed in Chapter 9, Section 4.1. &#9474;5. Minimum Value of the Objective Function and Final &#9474;Parameter EstimatesThe next two pages in the NONMEM output are produced whetheror not the Estimation Step was implemented and, if it was,whether or not the search terminated successfully. Theygive the values of the objective function and the parameterestimates, using the final parameter estimates if theEstimation Step was implemented (whether or not the searchterminated successfully), and using the initial parameterestimates otherwise. These pages have already been shown inChapter 2, figure 2.13. Even when the minimization routineis successful in locating a minimum of the objectivefunction, the final (untransformed) parameter estimates mustbe carefully checked. Is any parameter&rsquo;s final estimatephysiologically unreasonable? Is any parameter&rsquo;s finalestimate near its upper or lower constraint? If eitheranswer is yes, the model, the constraints on &theta;&rsquo;s, or thedata may be incorrect; see Chapter 11.Sometimes the final estimates do not match anticipatedvalues, e.g., values obtained by some other system ofanalysis. Additional refinement of the model may be needed,as discussed in Chapter 11. However, the discrepancy maywell be traceable to an error in model specification, suchas an error in specifying a compartment&rsquo;s scale. Along withthe Estimation Step, it is important to obtain a scatterplotof PRED vs DV and make sure the unit slope line is visible.See Chapter 13, Section 4.4.6. Output from the Covariance StepFigures 10.6 through 10.7 show the output of the CovarianceStep, which was requested via the $COVARIANCE record.Figure 10.6 has already been displayed as figure 2.14, butis included here for completeness. This page displays thestandard errors of the parameter estimates. Standard errorsare discussed extensively in Chapters 5 and 11. A detaileddiscussion of the remaining three pages, containing thecovariance, correlation, and inverse covariance matrices, isbeyond the scope of this text. Note, however, the use ofthe notation &quot;........&quot;. Each sequence of dots denotes avalue (such as the standard error in the estimate of &Omega;12)that is 0 by definition, rather than due to a computation.1 ************************************************************************************************************************2 ******************** ********************3 ******************** STANDARD ERROR OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************6789 THETA - VECTOR OF FIXED EFFECTS *********************101112 TH 1 TH 2 TH 3 TH 41314 9.49E-11 1.46E-01 2.24E-04 1.13E-0115161718 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********192021 ETA1 ETA22223 ETA1 7.24E-072425 ETA2 ......... 3.63E-0226272829 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****303132 EPS13334 EPS1 1.71E+00Figure 10.6. Standard error of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 9.02E-211112 TH 2 3.93E-12 2.14E-021314 TH 3 -5.23E-15 -1.45E-05 5.00E-081516 TH 4 -3.69E-12 -1.57E-02 1.04E-05 1.27E-021718 OM11 -1.11E-17 2.13E-08 -6.39E-12 -1.52E-08 5.24E-131920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.79E-14 4.40E-04 -5.30E-07 5.58E-04 6.27E-10 ......... 1.32E-032324 SG11 1.04E-11 -5.69E-02 1.12E-04 4.45E-02 -3.74E-07 ......... -1.03E-02 2.92E+00Figure 10.7. Covariance matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** CORRELATION MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.00E+001112 TH 2 2.83E-01 1.00E+001314 TH 3 -2.46E-01 -4.44E-01 1.00E+001516 TH 4 -3.45E-01 -9.53E-01 4.13E-01 1.00E+001718 OM11 -1.61E-01 2.01E-01 -3.95E-02 -1.86E-01 1.00E+001920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -5.21E-03 8.29E-02 -6.53E-02 1.37E-01 2.39E-02 ......... 1.00E+002324 SG11 6.44E-02 -2.28E-01 2.94E-01 2.31E-01 -3.02E-01 ......... -1.66E-01 1.00E+00Figure 10.8. Correlation matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** INVERSE COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.56E+201112 TH 2 1.46E+11 1.25E+031314 TH 3 1.35E+13 4.42E+04 2.80E+071516 TH 4 2.32E+11 1.63E+03 3.98E+04 2.23E+031718 OM11 3.04E+15 -3.96E+06 -7.46E+08 -1.76E+06 2.26E+121920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.56E+11 -1.14E+03 -2.82E+04 -1.55E+03 2.82E+06 ......... 1.86E+032324 SG11 -1.93E+09 -7.14E+00 -1.06E+03 -1.03E+01 2.67E+05 ......... 9.91E+00 4.78E-01Figure 10.9. Inverse covariance matrix of the estimate.The line numbers on the left are not actually part of thereport.7. Additional Output: Tables and ScatterplotsThe use of $TABLE and $SCATTERPLOT records to request tablesand scatterplots is discussed in Chapter 9.7.1. Output from the Table StepThe first 12 lines of the table produced by the $TABLErecord are shown in figure 10.10. This is the data for thefirst individual.1 TABLE NO. 12345 LINE NO. ID TIME AMT WT APGR DV PRED RES WRES67 1 1.00E+00 0.00E+00 2.50E+01 1.40E+00 7.00E+00 0.00E+00 1.78E+01 0.00E+00 0.00E+0089 2 1.00E+00 2.00E+00 0.00E+00 1.40E+00 7.00E+00 1.73E+01 1.76E+01 -3.14E-01 -2.92E-011011 3 1.00E+00 1.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 1.92E+01 0.00E+00 0.00E+001213 4 1.00E+00 2.45E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.07E+01 0.00E+00 0.00E+001415 5 1.00E+00 3.70E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.20E+01 0.00E+00 0.00E+001617 6 1.00E+00 4.80E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.33E+01 0.00E+00 0.00E+001819 7 1.00E+00 6.05E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.45E+01 0.00E+00 0.00E+002021 8 1.00E+00 7.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.56E+01 0.00E+00 0.00E+002223 9 1.00E+00 8.53E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.66E+01 0.00E+00 0.00E+002425 10 1.00E+00 9.65E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.77E+01 0.00E+00 0.00E+002627 11 1.00E+00 1.08E+02 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.87E+01 0.00E+00 0.00E+002829 12 1.00E+00 1.12E+02 0.00E+00 1.40E+00 7.00E+00 3.10E+01 2.81E+01 2.88E+00 6.88E-01Figure 10.10. A portion of a NONMEM table. The linenumbers on the left are not actually part of the report.Each row in the table corresponds to a record of the inputfile, and the rows appear in the same order as do thecorresponding records of the input data file. Note that thevalues of RES and WRES are always shown as zero fornon-observation records&dagger;, whereas a (possibly) nonzero valueof PRED is printed for every record.<cite>&dagger; Strictly speaking, RES and WRES are always zero forrecords having MDV=1. With PREDPP, this is the same thing.</cite>If there are more than 900 data records, separate tables areproduced for groups of 900 records. The last table containsthe remaining records. If the rows of the table are sorted,each group of records is sorted separately. When the inputdata file is large, the table will require many pages toprint. Therefore, the $TABLE record should be omittedunless needed for diagnostic purposes (such as wheninitially checking a new data set or model).7.2. Output from the Scatterplot StepMany examples of scatterplots are present in Chapters 2 and11. They are not reproduced here. Whereas all the recordsin the input data file correspond to rows of a table, thisis not true of a scatterplot that includes one or more ofthe items RES, WRES, and DV. When one of these three isbeing plotted, then only observation records contributepoints to the scatterplot&dagger;.<cite>&dagger; Strictly speaking, it is only the records having MDV=0that contribute points. With PREDPP, this is the samething. </cite>In figure 2.5, there are exactly 10 points &quot;*&quot;,corresponding to the 10 observation records in figure 2.2;the dose record does not contribute a point.NONMEM displays only the first 900 records of theappropriate type in a scatterplot. This limit appliesbefore any partitioning. For example, in a plot of DV VSID, the first 900 observation records are displayed; in aplot of WT vs ID, the first 900 records of the data file aredisplayed. Additional scatterplots can be requested,showing additional points, using options &quot;FROM=&quot; and &quot;TO=&quot;of the $SCATTERPLOT record. See NONMEM Users Guide, PartIV.
<a name="1. What This Chapter is AboutThis chapter describes NONMEM&rsquo;s output in detail. Each pageof a NONMEM-PREDPP output file is shown and discussed.The input file to NM-TRAN is that of figure 2.12, which isreproduced here as figure 10.1 for convenience.1 $PROBLEM PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V2 $INPUT ID TIME AMT WT APGR DV3 $DATA INDATA4 $SUBROUTINE ADVAN15 $PK6 TVCL=THETA(1)+THETA(3)*WT7 CL=TVCL+ETA(1)8 TVVD=THETA(2)+THETA(4)*WT9 V=TVVD+ETA(2)10 ; THE FOLLOWING ARE REQUIRED BY PREDPP11 K=CL/V12 S1=V13 $ERROR14 Y=F+ERR(1)15 $THETA (0,.0027) (0,.70) .0018 .516 $OMEGA .000007, .317 $SIGMA 818 $ESTIMATION PRINT=519 $COVARIANCE20 $TABLE ID TIME AMT WT APGR DV21 $SCATTER PRED VS DV UNIT22 $SCATTER RES VS WTFigure 10.1. The NM-TRAN input file (same as figure 2.12).The line numbers on the left are not actually part of thefile.2. NONMEM Describes its InputsThe first page of NONMEM&rsquo;s output is shown in figure 10.2.In this page, NONMEM repeats (&quot;echos&quot;) the instructions itwas given in the control file and describes the data file.The first page of the output should be checked carefully.Problems in a NONMEM run can often be traced to errors inthe problem specification. For example, always check thatthe initial parameter estimates were entered correctly.1 NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) DOUBLE PRECISION NONMEM VERSION IV LEVEL 1.02 DEVELOPED AND PROGRAMMED BY STUART BEAL AND LEWIS SHEINER34 PROBLEM NO. 15 PHENOBARB WITH WEIGHT IN MODELS FOR CL AND V67 DATA CHECKOUT RUN: NO8 DATA SET LOCATED ON UNIT NO.: 29 THIS UNIT TO BE REWOUND: NO10 NO. OF DATA RECS IN DATA SET: 74411 NO. OF DATA ITEMS IN DATA SET: 812 ID DATA ITEM IS DATA ITEM NO.: 113 DEP VARIABLE IS DATA ITEM NO.: 614 MDV DATA ITEM IS DATA ITEM NO.: 81516 INDICES PASSED TO SUBROUTINE PRED ARE:17 7 2 3 0 0 0 0 0 018 0 01920 LABELS FOR DATA ITEMS ARE:21 ID TIME AMT WT APGR DV EVID MDV2223 FORMAT FOR DATA IS:24 (6E6.0,2F2.0)2526 TOT. NO. OF OBS RECS: 15527 TOT. NO. OF INDIVIDUALS: 592829 LENGTH OF THETA: 43031 OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 23233 SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION: 13435 INITIAL ESTIMATE OF THETA:36 LOWER BOUND INITIAL EST UPPER BOUND37 0.0000E+00 0.2700E-02 0.1000E+0738 0.0000E+00 0.7000E+00 0.1000E+0739 -0.1000E+07 0.1800E-02 0.1000E+0740 -0.1000E+07 0.5000E+00 0.1000E+074142 INITIAL ESTIMATE OF OMEGA:43 0.7000E-0544 0.0000E+00 0.3000E+004546 INITIAL ESTIMATE OF SIGMA:47 0.8000E+014849 ESTIMATION STEP OMITTED: NO50 NO. OF FUNCT. EVALS. ALLOWED: 36051 NO. OF SIG. FIGURES REQUIRED: 352 INTERMEDIATE PRINTOUT: YES53 MSF OUTPUT: NO5455 COVARIANCE STEP OMITTED: NO56 EIGENVLS. PRINTED: NO57 SPECIAL COMPUTATION: NO5859 TABLES STEP OMITTED: NO60 NO. OF TABLES: 161 TABLES PRINTED: YES6263 USER-CHOSEN DATA ITEMS FOR TABLE 1,64 IN THE ORDER THEY WILL APPEAR IN THE TABLE, ARE:65 ID TIME AMT WT APGR6667 SCATTERPLOT STEP OMITTED: NO68 NO. OF PAIRS OF ITEMS GENERATING69 FAMILIES OF SCATTERPLOTS: 27071 ITEMS TO BE SCATTERED ARE: DV PRED72 UNIT SLOPE LINE INCLUDED73 ITEMS TO BE SCATTERED ARE: WT RESFigure 10.2. The first page of the output report. The linenumbers on the left are not actually part of the report.Line 5 is an identification line for the output report. Thecontents of the $PROBLEM record are shown here.Line 7 indicates that this is not a data checkout run. (Datacheckout mode is discussed in Chapter 12 Section 4.10.)Lines 8 through 27 describe the input data file. Lines 10and 11 describe the numbers of rows and columns in the inputfile, as shown in figure 6.1. Specifically, line 10 showshow many data records were read according to the FORTRANformat specification given in line 24. Line 11 describesthe number of data items per record, which is the number ofdata items listed in the $INPUT record, less any that weredropped by the Data Preprocessor, plus any that it added(see Chapter 6). Lines 12, 13, and 14 describe thelocations of those data items of interest to NONMEM itself(i.e. NONMEM data items). Lines 16 through 18 are discussedin Section 3. Line 21 gives the labels for all the dataitems. The first six labels are those of the data itemsspecified in the $INPUT record and the next two (EVID, MDV)are those of two data items added to the data set by theData Preprocessor. (NONMEM itself supplies labels PRED,RES, and WRES for the prediction, residual, and weightedresidual data items.) In the terminology of Chapter 4 (e.g.(4.15a)), ID, TIME, AMT, WT, and APGR are the elements of x;DV is y; PRED is f (evaluated for the typical individual inthe population). Line 24 shows the format used to read eachdata record. In this example, the format was generated bythe Data Preprocessor and describes the data file afterprocessing by the Data Preprocessor.&dagger;<cite>&dagger; When a format specification is supplied on the $DATArecord, and no data items are dropped or added by the DataPreprocessor, the original format specification is usedunchanged and appears here. </cite>Line 26 gives the number of observation records. Line 27gives the number of individual records; that is, one lessthan the number of times that the ID data item changedvalue.Lines 29 through 47 describe the contents of the $THETA,$OMEGA and $SIGMA records. First, the number of elements of&theta;, &Omega; and &Sigma; are given (lines 29, 31 and 33), then theirinitial estimates are displayed. In lines 38-41, notice thevalues 0.1000e+07 and -0.1000e+07. These are NONMEM&rsquo;s wayof expressing the values +&infin; and &minus;&infin;; i.e., of describing &theta;swhich are unbounded on one or both sides. Another FORTRANsystem may display these numbers differently (e.g.,1.0000e+06), but the absolute value will always be1,000,000. In lines 43 and 44, notice that the variancesfrom the $OMEGA record appear along the diagonal of the &Omega;matrix, and that the off-diagonal element cov(&eta;1,&eta;2) iszero. Line 31 states that NONMEM understands &Omega; to bediagonal; the off-diagonal element(s) are automaticallyfixed at zero.The remaining lines of figure 10.2 describe the tasks thatNONMEM will perform. Lines 49 through 53 describe the$ESTIMATION record. Lines 50 through 53 show the defaults(set by NM-TRAN) for various options, all of which couldhave been specified explicitly on the $ESTIMATION record.In line 50 for example, NONMEM displays the maximum numberof times it will evaluate the objective function during theEstimation Step (this number can be slightly exceeded). Thevalue 360 was supplied by NM-TRAN. It is a function of thesizes of &theta;, &Omega;, and &Sigma;. Line 51 displays the desired numberof significant digits in the final parameter estimate; thevalue 3 is the default number requested by NM-TRAN.Lines 55 through 59 describe the $COVARIANCE record, givingthe default options chosen by NM-TRAN.Lines 59 through 61 describe the $TABLE record. Lines 67through 73 describe the $SCATTERPLOT records.3. PREDPP Describes Its InputsThe next two pages are produced by PREDPP and will notappear if $PRED statements (or a user-written PREDsubroutine) are used. PREDPP uses these pages to repeat(&quot;echo&quot;) the instructions it was given in the control file,and to identify the ADVAN and TRANS routines chosen by theuser. The first page of PREDPP&rsquo;s output is shown in figure10.3. 1 DOUBLE PRECISION PRED VERSION III LEVEL 1.023 ONE COMPARTMENT MODEL (ADVAN1)45 MAXIMUM NO. OF BASIC PK PARAMETERS: 267 BASIC PK PARAMETERS (AFTER TRANSLATION):8 ELIMINATION RATE (K) IS BASIC PK PARAMETER NO.: 191011 COMPARTMENT ATTRIBUTES12 COMPT. NO. FUNCTION INITIAL ON/OFF DOSE DEFAULT DEFAULT13 STATUS ALLOWED ALLOWED FOR DOSE FOR OBS.14 1 CENTRAL ON NO YES YES YES15 2 OUTPUT OFF YES NO NO NOFigure 10.3. The first page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.In its first page of output, PREDPP describes the featuresof the pharmacokinetic model and its parameterizationencoded into the ADVAN and TRANS routines specified on the$SUBROUTINE record. The information displayed here includesthe kind of information summarized in Appendices 1 and 2.In the particular output of Figure 10.3 no informationconcerning an alternate parameterization appears becauseTRANS1 was specified. The information concerning basicparameters and compartments is displayed in a format similarto that used in NONMEM Users Guide, Part VI, which is thecomplete reference for PREDPP.Lines 5 and 8 describe the basic PK parameters, which inthis example is the single microconstant K. If a translatorother than TRANS1 had been requested, an additional linewould appear describing the translation. E.g., with TRANS2,this line would read:TRANSLATOR WILL CONVERT PARAMETERS CLEARANCE (CL) AND VOLUME(V) to KLines 10 through 14 describe the compartment attributes.Even though the output compartment is never turned on by thedata of this example, its attributes are described herebecause it is part of the model.The information presented so far describes the model forcomputing drug amounts. For a given choice of ADVAN andTRANS, the contents of this page are completely fixed.PREDPP&rsquo;s second page of output describes user choicesrelated to the given ADVAN routine, including choices forthe scale parameters (and thus, to the model for computingconcentrations). This page is shown in figure 10.4.1 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG2 COMPT. NO. INDICES3 SCALE BIOAVAIL. ZERO-ORDER ZERO-ORDER ABSORB4 FRACTION RATE DURATION LAG5 1 3 * * * *6 2 * - - - -7 - PARAMETER IS NOT ALLOWED FOR THIS MODEL8 * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;9 WILL DEFAULT TO ONE IF APPLICABLE1011 DATA ITEM INDICES USED BY PRED ARE:12 EVENT ID DATA ITEM IS DATA ITEM NO.: 713 TIME DATA ITEM IS DATA ITEM NO.: 214 DOSE AMOUNT DATA ITEM IS DATA ITEM NO.: 3151617 PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.18 PK SUBROUTINE NOT CALLED AT ADDITIONAL DOSE OR LAGGED DOSE TIMES.1920 DURING SIMULATION, ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.21 OTHERWISE, ERROR SUBROUTINE CALLED ONCE IN THIS PROBLEM.Figure 10.4. The second page of PREDPP&rsquo;s output. The linenumbers on the left are not actually part of the report.Lines 2 through 9 describe the additional PK parameters thatare computed by the $PK statements (or PK subroutine). Inline 5, the position marked with &quot;3&quot; corresponds to thescale parameter for compartment number 1. Thus, we knowthat the $PK statements contained an assignment statementfor S1. From the prior page we can see that compartmentnumber 1 is the central compartment. The value &quot;3&quot; is a rownumber within GG, an array used for communication betweenPREDPP and the PK subroutine. With the use of NM-TRAN and$PK statements, row numbers are of no interest to the user.With a user-written PK subroutine, it is important to checktheir correctness. Positions marked with &quot;*&quot; correspond toadditional PK parameters that are allowed by the model butthat are not assigned a value by $PK statements; an exampleis F1, the bioavailability fraction for compartment 1.Positions marked with &quot;-&quot; correspond to additionalparameters that may not be computed; for instance,dose-related parameters are not allowed for the outputcompartment, because (as shown on the preceding page) thiscompartment cannot receive doses.Lines 11 through 14 describe the locations in the input datarecord of those data items of interest to PREDPP (PREDPPdata items). (NM-TRAN causes the locations of these dataitems in the data set to be passed by NONMEM to PREDPP, asindicated in lines 15 through 17 of figure 10.2. NONMEM isnot concerned with the significance of these data items.)Note that data item 7, Event ID, was appended by the DataPreprocessor.Line 17 reflects the fact that, by default, $PK statementsare evaluated with every event record&dagger;. Lagged andadditional doses are discussed in Chapter 12, Sections 2.4and 2.5. They are not used in this example.<cite>&dagger; In this example, the $PK statements (lines 5 through 12 ofthe input file, figure 10.1) involve only WT, which isconstant for each individual. It is possible to limit theevent records with which the $PK statements are evaluated tothe first event record of each individual, in order toreduce run time. This decision is left to the user. </cite> &#9474;Line 21 reflects the fact that the $ERROR statementsdescribe the simple error model (3.4). This model uses nodata items and no elements of &theta; whatsoever (directly orindirectly). NM-TRAN has instructed PREDPP that the $ERRORstatements need be evaluated only once at the beginning ofthe problem. Line 20 indicates that, should the SimulationStep be implemented, PREDPP will disregard this limitationand evaluate the $ERROR statements with every event record,so that randomly-generated values of intra-individual errorcan be applied at every observation event. (This exampledoes not involve simulation, but the PK and ERROR routineswhich implement the $PK and $ERROR statements are capable ofsupporting all NONMEM tasks, including simulation.)Finally, note that the $PK and $ERROR models (figure 10.1,lines 5-14) are not documented in the NONMEM-PREDPP output.It is a good idea to attach a printed copy of the NM-TRANinput records to the corresponding NONMEM output. MS/DOS &#9474;batch file nmfe72.bat and Unix C-shell script nmfe72 &#9474;(supplied with NONMEM) do this automatically.4. Diagnostic Output from the Estimation StepThe next page of output, figure 10.5, is produced during therunning of the Estimation Step.1 MONITORING OF SEARCH:234 ITERATION NO.: 0 OBJECTIVE VALUE: 0.6757E+03 NO. OF FUNC. EVALS.: 85 CUMULATIVE NO. OF FUNC. EVALS.: 86 PARAMETER: 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+00 0.1000E+007 GRADIENT: -0.7986E+03 -0.1594E+04 -0.4294E+03 -0.1000E+04 0.1542E+03 0.5269E+03 0.9128E+0289 ITERATION NO.: 5 OBJECTIVE VALUE: 0.6502E+03 NO. OF FUNC. EVALS.:1010 CUMULATIVE NO. OF FUNC. EVALS.: 5811 PARAMETER: 0.8878E-01 0.1003E+00 0.2055E+00 0.1296E+00 0.6695E-01 0.7822E-01 0.1071E+0012 GRADIENT: 0.1060E+04 0.2567E+04 0.3675E+03 0.8472E+03 -0.1807E+03 -0.5093E+03 0.9841E+021314 ITERATION NO.: 10 OBJECTIVE VALUE: 0.6153E+03 NO. OF FUNC. EVALS.: 915 CUMULATIVE NO. OF FUNC. EVALS.: 10716 PARAMETER: 0.5008E-01 0.6626E-01 0.2425E+00 0.1663E+00 -0.6718E-01 0.6382E-01 0.1004E+0017 GRADIENT: 0.9732E+02 0.3034E+03 0.3185E+02 0.1228E+03 -0.1162E+03 0.1252E+03 0.6450E+021819 ITERATION NO.: 15 OBJECTIVE VALUE: 0.6108E+03 NO. OF FUNC. EVALS.: 920 CUMULATIVE NO. OF FUNC. EVALS.: 15221 PARAMETER: 0.4235E-01 0.4508E-01 0.2462E+00 0.1831E+00 -0.5721E-01 0.5237E-01 0.1008E+0022 GRADIENT: 0.3989E+02 0.7394E+02 -0.1782E+01 0.8527E+02 -0.9309E+02 0.1867E+02 -0.1773E+022324 ITERATION NO.: 20 OBJECTIVE VALUE: 0.6095E+03 NO. OF FUNC. EVALS.: 925 CUMULATIVE NO. OF FUNC. EVALS.: 19726 PARAMETER: 0.1927E-01 0.3153E-01 0.2615E+00 0.1898E+00 -0.4458E-01 0.4904E-01 0.1047E+0027 GRADIENT: 0.1609E+02 -0.3621E+02 0.5228E+01 0.9614E+00 -0.1740E+02 0.1329E+02 0.3111E+012829 ITERATION NO.: 25 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 930 CUMULATIVE NO. OF FUNC. EVALS.: 24231 PARAMETER: 0.2389E-02 0.4171E-01 0.2652E+00 0.1833E+00 -0.4413E-01 0.4998E-01 0.1043E+0032 GRADIENT: 0.2273E+01 -0.5333E+01 0.3914E+01 -0.5397E+01 0.1271E+01 0.2610E+01 0.3584E+003334 ITERATION NO.: 30 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.:1635 CUMULATIVE NO. OF FUNC. EVALS.: 29936 PARAMETER: -0.1278E-03 0.4166E-01 0.2650E+00 0.1835E+00 -0.4414E-01 0.5003E-01 0.1043E+0037 GRADIENT: -0.1120E+00 -0.9411E+00 -0.3719E+00 -0.2540E+01 -0.5135E-01 0.1420E+00 -0.9524E-013839 ITERATION NO.: 32 OBJECTIVE VALUE: 0.6091E+03 NO. OF FUNC. EVALS.: 040 CUMULATIVE NO. OF FUNC. EVALS.: 31541 PARAMETER: -0.7284E-05 0.4150E-01 0.2650E+00 0.1836E+00 -0.4411E-01 0.5003E-01 0.1043E+0042 GRADIENT: -0.6416E-02 0.9336E-01 0.4548E-01 0.4826E-01 0.1263E-02 0.9652E-01 0.4629E-014344 MINIMIZATION SUCCESSFUL45 NO. OF FUNCTION EVALUATIONS USED: 31546 NO. OF SIG. DIGITS IN FINAL EST.: 3.9Figure 10.5. The output from the Estimation Step. The linenumbers on the left are not actually part of the report.4.1. Intermediate Output from the Estimation StepLines 1 through 42 are referred to as the intermediateoutput. Lines 4 through 7 give numbers summarizing the 0-thiteration, which are based on the initial parameterestimates. Line 4 shows the initial value of the objectivefunction. The value following &quot;NO. OF FUNC. EVALS.&quot; is thenumber of objective function evaluations which were neededduring the iteration. Line 5 gives the cumulative number offunction evaluations including this and all prior iterationsummaries.Line 6 gives the unconstraine_____________ paramete_________ (UCP_____ estimates. &#9474;The search is carried out in a different parameter space. &#9474;The parameters are transformed to unconstrained parameters &#9474;(UCP). In the transformation process a scaling occurs so &#9474;that the initial estimate of each of the UCP is 0.1.Thus, in line 6, all parameters are .1 at the 0-thiteration. Parameters are printed in the following order:elements of &theta;, elements of &Omega;, elements of &Sigma;. In thisexample, reading from left to right, the parameters are &theta;1,&theta;2, &theta;3, &theta;4, &Omega;11, &Omega;22, and &Sigma;11.Two points should be noted. First, fixed parameters do notappear in the list. Therefore, the off-diagonal element&Omega;12, which is effectively fixed to 0, does not appear.Second, when off-diagonal elements of &Omega; are being estimated,then as many additional UCP&rsquo;s appear as there areoff-diagonal elements of &Omega; being estimated. However, a 1-1correspondence between each of the elements of &Omega; and an UCPdoes not exist. The same is true for elements of &Sigma; and theUCP&rsquo;s for &Sigma; when off-diagonal elements of &Sigma; are estimated. &#9474;With NONMEM 7, the parameter estimates are also &#9474;displayed in their natural (unscaled) space. These lines &#9474;are identified as NPARAMETR and precede the PARAMETER &#9474;lines, which display the UCP values.Line 7 shows the gradient for each parameter, which may bethought of as the partial derivative of the objectivefunction with respect to that parameter.The Estimation Step proceeds in a series of stages callediterations. In this example, intermediate printout isproduced for each of every 5 iterations, as well as for the0-th and final iterations, for which intermediate printoutis always printed by default. This printout consists of thesame four lines as for the 0-th iteration, but using theparameters estimates obtained at the end of the iteration.In lines 4, 9, 14, 19, 24, 29, 34, and 39, observe that theobjective function drops quickly at first, and then moreslowly. After iteration number 25, there is no change abovethe fourth significant digit.In lines 6, 11, 16, 21, 26, 31, 36, and 41, observe thateach parameter also changes rapidly at first and then moreslowly as it converges to its final value. (The firstparameter, &theta;1, is an exception. It is clearly approaching avery small value close to its lower bound, 0. In Chapter12, we shall see that both &theta;1 and &theta;2 are best fixed at 0.)Finally, in lines 7, 12, 17, 22, 27, 32, 37, and 42, observethat the gradients also approach 0, another sign that aminimum of the objective function has been located.The values computed for the gradients are very sensitive todifferences in computer arithmetic and precision. If agiven NONMEM run is repeated on a different computer, or onthe same computer with different machine precision or adifferent FORTRAN compiler, it is likely that the gradientswill be different. This will cause the search to follow adifferent path to the minimum, so that lines 4 through 42may be quite different. However, each final estimate of aUCP should always be the same to the number of requestedsignificant digits. (Minor differences may also be observedin the output of the Covariance Step, below; this output isalso sensitive to computational differences.)4.2. Summary Output from the Estimation StepLines 44, 45 and 46 are always printed, even whenintermediate printout is suppressed. Line 44, &quot;MINIMIZATIONSUCCESSFUL&quot;, signifies that the search appears to havelocated a minimum of the objective function. Before one canbe certain that a minimum has been located, or one whichcorresponds to a reasonable parameter estimate (there can bea number of &quot;local minima&quot;), the final parameter estimatesmust be examined in their (untransformed) state; see Section5 below. The Estimation Step is not always successful.Chapter 13 discusses two other messages that sometimesappear instead of line 44.In line 45, note that the number of function evaluationsused, 315, is a total value and includes all iterations (notjust those for which intermediate printout was displayed).This is under the limit of 360 supplied by NM-TRAN (figure10.2, line 57).The number of significant digits in the final estimate isgiven in line 34 as 3.9. This can be interpreted as meaningthat no (transformed) parameter estimate is actuallydetermined to less than 3.9 significant digits. Morespecifically, when the UCP estimates were compared betweenthe last two iterations, none differed in the first (almost)4 significant figures including leading zeros after thedecimal point. Note that the final &theta;1 UCP estimate is-0.7284E-05, and so the 7284 are not significant digits atall! Because NONMEM displays only 3 significant digits inthe printed parameter estimates, and for other reasons aswell, by default NM-TRAN requests only 3 significant digits.However, more significance can be requested, as wasdiscussed in Chapter 9, Section 4.1. &#9474;5. Minimum Value of the Objective Function and Final &#9474;Parameter EstimatesThe next two pages in the NONMEM output are produced whetheror not the Estimation Step was implemented and, if it was,whether or not the search terminated successfully. Theygive the values of the objective function and the parameterestimates, using the final parameter estimates if theEstimation Step was implemented (whether or not the searchterminated successfully), and using the initial parameterestimates otherwise. These pages have already been shown inChapter 2, figure 2.13. Even when the minimization routineis successful in locating a minimum of the objectivefunction, the final (untransformed) parameter estimates mustbe carefully checked. Is any parameter&rsquo;s final estimatephysiologically unreasonable? Is any parameter&rsquo;s finalestimate near its upper or lower constraint? If eitheranswer is yes, the model, the constraints on &theta;&rsquo;s, or thedata may be incorrect; see Chapter 11.Sometimes the final estimates do not match anticipatedvalues, e.g., values obtained by some other system ofanalysis. Additional refinement of the model may be needed,as discussed in Chapter 11. However, the discrepancy maywell be traceable to an error in model specification, suchas an error in specifying a compartment&rsquo;s scale. Along withthe Estimation Step, it is important to obtain a scatterplotof PRED vs DV and make sure the unit slope line is visible.See Chapter 13, Section 4.4.6. Output from the Covariance StepFigures 10.6 through 10.7 show the output of the CovarianceStep, which was requested via the $COVARIANCE record.Figure 10.6 has already been displayed as figure 2.14, butis included here for completeness. This page displays thestandard errors of the parameter estimates. Standard errorsare discussed extensively in Chapters 5 and 11. A detaileddiscussion of the remaining three pages, containing thecovariance, correlation, and inverse covariance matrices, isbeyond the scope of this text. Note, however, the use ofthe notation &quot;........&quot;. Each sequence of dots denotes avalue (such as the standard error in the estimate of &Omega;12)that is 0 by definition, rather than due to a computation.1 ************************************************************************************************************************2 ******************** ********************3 ******************** STANDARD ERROR OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************6789 THETA - VECTOR OF FIXED EFFECTS *********************101112 TH 1 TH 2 TH 3 TH 41314 9.49E-11 1.46E-01 2.24E-04 1.13E-0115161718 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********192021 ETA1 ETA22223 ETA1 7.24E-072425 ETA2 ......... 3.63E-0226272829 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****303132 EPS13334 EPS1 1.71E+00Figure 10.6. Standard error of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 9.02E-211112 TH 2 3.93E-12 2.14E-021314 TH 3 -5.23E-15 -1.45E-05 5.00E-081516 TH 4 -3.69E-12 -1.57E-02 1.04E-05 1.27E-021718 OM11 -1.11E-17 2.13E-08 -6.39E-12 -1.52E-08 5.24E-131920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.79E-14 4.40E-04 -5.30E-07 5.58E-04 6.27E-10 ......... 1.32E-032324 SG11 1.04E-11 -5.69E-02 1.12E-04 4.45E-02 -3.74E-07 ......... -1.03E-02 2.92E+00Figure 10.7. Covariance matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** CORRELATION MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.00E+001112 TH 2 2.83E-01 1.00E+001314 TH 3 -2.46E-01 -4.44E-01 1.00E+001516 TH 4 -3.45E-01 -9.53E-01 4.13E-01 1.00E+001718 OM11 -1.61E-01 2.01E-01 -3.95E-02 -1.86E-01 1.00E+001920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -5.21E-03 8.29E-02 -6.53E-02 1.37E-01 2.39E-02 ......... 1.00E+002324 SG11 6.44E-02 -2.28E-01 2.94E-01 2.31E-01 -3.02E-01 ......... -1.66E-01 1.00E+00Figure 10.8. Correlation matrix of the estimate. The linenumbers on the left are not actually part of the report.1 ************************************************************************************************************************2 ******************** ********************3 ******************** INVERSE COVARIANCE MATRIX OF ESTIMATE ********************4 ******************** ********************5 ************************************************************************************************************************678 TH 1 TH 2 TH 3 TH 4 OM11 OM12 OM22 SG11910 TH 1 1.56E+201112 TH 2 1.46E+11 1.25E+031314 TH 3 1.35E+13 4.42E+04 2.80E+071516 TH 4 2.32E+11 1.63E+03 3.98E+04 2.23E+031718 OM11 3.04E+15 -3.96E+06 -7.46E+08 -1.76E+06 2.26E+121920 OM12 ......... ......... ......... ......... ......... .........2122 OM22 -1.56E+11 -1.14E+03 -2.82E+04 -1.55E+03 2.82E+06 ......... 1.86E+032324 SG11 -1.93E+09 -7.14E+00 -1.06E+03 -1.03E+01 2.67E+05 ......... 9.91E+00 4.78E-01Figure 10.9. Inverse covariance matrix of the estimate.The line numbers on the left are not actually part of thereport.7. Additional Output: Tables and ScatterplotsThe use of $TABLE and $SCATTERPLOT records to request tablesand scatterplots is discussed in Chapter 9.7.1. Output from the Table StepThe first 12 lines of the table produced by the $TABLErecord are shown in figure 10.10. This is the data for thefirst individual.1 TABLE NO. 12345 LINE NO. ID TIME AMT WT APGR DV PRED RES WRES67 1 1.00E+00 0.00E+00 2.50E+01 1.40E+00 7.00E+00 0.00E+00 1.78E+01 0.00E+00 0.00E+0089 2 1.00E+00 2.00E+00 0.00E+00 1.40E+00 7.00E+00 1.73E+01 1.76E+01 -3.14E-01 -2.92E-011011 3 1.00E+00 1.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 1.92E+01 0.00E+00 0.00E+001213 4 1.00E+00 2.45E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.07E+01 0.00E+00 0.00E+001415 5 1.00E+00 3.70E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.20E+01 0.00E+00 0.00E+001617 6 1.00E+00 4.80E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.33E+01 0.00E+00 0.00E+001819 7 1.00E+00 6.05E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.45E+01 0.00E+00 0.00E+002021 8 1.00E+00 7.25E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.56E+01 0.00E+00 0.00E+002223 9 1.00E+00 8.53E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.66E+01 0.00E+00 0.00E+002425 10 1.00E+00 9.65E+01 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.77E+01 0.00E+00 0.00E+002627 11 1.00E+00 1.08E+02 3.50E+00 1.40E+00 7.00E+00 0.00E+00 2.87E+01 0.00E+00 0.00E+002829 12 1.00E+00 1.12E+02 0.00E+00 1.40E+00 7.00E+00 3.10E+01 2.81E+01 2.88E+00 6.88E-01Figure 10.10. A portion of a NONMEM table. The linenumbers on the left are not actually part of the report.Each row in the table corresponds to a record of the inputfile, and the rows appear in the same order as do thecorresponding records of the input data file. Note that thevalues of RES and WRES are always shown as zero fornon-observation records&dagger;, whereas a (possibly) nonzero valueof PRED is printed for every record.<cite>&dagger; Strictly speaking, RES and WRES are always zero forrecords having MDV=1. With PREDPP, this is the same thing.</cite>If there are more than 900 data records, separate tables areproduced for groups of 900 records. The last table containsthe remaining records. If the rows of the table are sorted,each group of records is sorted separately. When the inputdata file is large, the table will require many pages toprint. Therefore, the $TABLE record should be omittedunless needed for diagnostic purposes (such as wheninitially checking a new data set or model).7.2. Output from the Scatterplot StepMany examples of scatterplots are present in Chapters 2 and11. They are not reproduced here. Whereas all the recordsin the input data file correspond to rows of a table, thisis not true of a scatterplot that includes one or more ofthe items RES, WRES, and DV. When one of these three isbeing plotted, then only observation records contributepoints to the scatterplot&dagger;.<cite>&dagger; Strictly speaking, it is only the records having MDV=0that contribute points. With PREDPP, this is the samething. </cite>In figure 2.5, there are exactly 10 points &quot;*&quot;,corresponding to the 10 observation records in figure 2.2;the dose record does not contribute a point.NONMEM displays only the first 900 records of theappropriate type in a scatterplot. This limit appliesbefore any partitioning. For example, in a plot of DV VSID, the first 900 observation records are displayed; in aplot of WT vs ID, the first 900 records of the data file aredisplayed. Additional scatterplots can be requested,showing additional points, using options &quot;FROM=&quot; and &quot;TO=&quot;of the $SCATTERPLOT record. See NONMEM Users Guide, PartIV."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 11 -
Model Building</b></p>

<h2>1. What This Chapter is AboutIn this chapter, the simple phenobarbital example begun inChapter 2 will be continued to illustrate how NONMEM is usedto build a model for population data. The topic of modelbuilding, diagnosis and verification is a large one. Thischapter can only give a very abbreviated example.2. The Stages of Model BuildingTo analyze a population data set and build a model for it,one must proceed in logical stages. There are five stages,and their relationship to one another is presenteddiagrammatically in figure 11.1. One begins by checking thedata. One then tries to find an adequate modelincorporating the fixed effects; then an adequate modelincorporating the random effects and describing randominter- and intra-individual variability. After a reasonablycomplete model is found, attempts are made to refine it, andfinally, if desired, the various parts of the models (whichoften, in effect, simply assert the existence of certainrelationships between independent variables and thedependent variable) can be subject to formal hypothesistests, as described in Chapter 5. (However, it is wellknown by statisticians that formal hypothesis testingundertaken after model building is just an approximation forthe type of hypothesis testing described in textbooks, whichassumes that the model is the correct model).+chapt11/fig11.1.ubuntu.epsiFigure 11.1. Stages in model building.3. Check-out &mdash; Index PlotsThe goal of this stage is to assure that the data arecorrect. There is no point to trying to model the data whengross errors are present. Most gross errors are encodingerrors that cause certain values to be different from theintended value by a considerable amount (for example, amisplaced decimal point changes a value by a factor of 10),so that graphical display of the data is usually adequate todetect these. No numerical or statistical approaches areneeded. Indeed, they are not usually useful, even for moresubtle errors, as such errors cannot easily be detected byany means (how is a 10% error to be distinguished frominter- or intra-individual variability?).To detect gross errors, then, one makes scatterplots ofdifferent data item types vs individuals&rsquo; identificationnumbers (i.e. the ID data item, or, if the values of thisdata item are arbitrary, another data item that identifiespatients using sequential integer values; call this thesequence data item: SEQ). Such plots (of one data itemversus ID or SEQ) are called here inde_____ plots______ and are quiteuseful for revealing the structure of the data, as will benoted below, as well as for finding gross errors.If NONMEM is used to make index plots, it will also beuseful to implement the Tables Step, so that if a problem isnoted in a scatterplot, one can refer to the table to try tofind the datum that might account for the problem. To runNONMEM some model must be specified, even if all that isdesired is an index plot. In such case, it makes littledifference what model is used. It is easiest and useful to(i) start with a simple ADVAN that is likely to provide atleast a roughly satisfactory fit, (ii) set each PK parameterto a (different) element of &theta;, (iii) use only one &eta;variable, modifying the scale parameter only, and one &epsilon;variable, and (iv) use roughly reasonable fixed initialestimates.For the phenobarbital example, one might use ADVAN1 withK=&theta;1, V=&theta;2+&theta;2&eta;1, and y=f+f&epsilon;1. Initial estimates might be: K= .0057 hr &minus;1 (half-life = 5 days, a typical value foradults); V= 1.44 L. (the first patient has a concentrationof 17.3 mg/L some few hours after an initial loading dose of25 mg; 1.44 times 17.3 = 25); &omega; = .25 (50% variability); &sigma;2= .04 (20% variability).Figures 11.2 and 11.3 show index plots that might be seen ina check-out run (gross errors have been added). In figure11.2, DV is plotted vs ID (here ID and SEQ are the same),and a gross error occurring at about patient #13 is seen (anobservation of about 24 mcg/ml was erroneously recorded as240 mcg/ml). In figure 11.3, AMT is plotted vs ID, andpatient #3 appears to have a grossly erroneous value (again,a decimal point error; a dose of 18 was misrecorded as 180).DV VS. ID0.00E+00 5.00E+01 1.00E+02 DV 1.50E+02 2.00E+02 2.50E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. * * * ** .. * 2 .. * * * .. *** .. 2*** * .. * 2 .. ** * * .. ** * .1.14E+01. ** * * ... * * .. * 3 .. * * .. * * * .. * 2* 2 * .. ** * .. * * * .. 2 * .. 2*2 .2.38E+01. 2 * ... * * * ** * .. * * .. * * * .. * .ID . 2 .. * .. * 2* * .. * * .. * * .3.62E+01. * * * ... * *** ** .. * * * .. * * .. ** * .. ** * .. * * * .. ** * .. * .. * .4.86E+01. * * * *22 ... * * * * .. * ** .. * * * .. * * 2* * .. * .. * .. * * .. 2 ** * * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.2. A scatterplot of the dependent variable, DV,vs the patient&rsquo;s ID number (a type of index plot). Note theoutlier at about ID = 13.Actually, figure 11.3 reveals a considerable amount aboutthe data structure (this will be seen better in figure 11.4,below, when the outlier has been removed). Many points liealong the line AMT = 0, where one sees integers 5, 3, 3, 6,etc, as one proceeds along the ID axis, each integerindicating the corresponding number of points over-plottedat that location. They correspond to the observationrecords, since the doses on these records are all zero.Thus one can see how many observations each individualcontributes (other type records would also plot at AMT=0,however). Proceeding to the next highest &quot;line&quot; of doses(where many points over-plot for each patient), one &quot;sees&quot;the event records giving the maintenance dose amount sincethis amount stays constant within a individual (manymaintenance doses were given per individual), and thisamount is approximately the same across individuals. Last,at the highest doses (except for the outlier), one hasmostly single points. These are the loading doses. Thereis occasional over-plotting of loading-dose points. Thesepoints represent overlapping patient ID numbers (at theresolution of the NONMEM plot ), not multiple loading dosesto the same patient.AMT VS. ID-1.00E+01 3.00E+01 7.00E+01 AMT 1.10E+02 1.50E+02 1.90E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. 5 K * * .. 3 B * .. 3A * .. 3 A * .. 6CB * * .. 3 C * .. 4 C * .. 3 B * .1.14E+01. 4 E* 2* ... 2C 2 .. 4C * .. 2 B * .. 3 D 2 .. 7M 2* .. 32A 2 .. 3 B * .. 3 C 2 .. 5 3 B 2 * .2.38E+01. 3 C * 2 ... 6B ** * .. 2 9 * .. 3 6 * * .. *3 * .ID . 2 B 2 .. * * .. 5 4 6 2 * * .. 2 6 * .. 2 7 2 .3.62E+01. 3 B * ... 6 R ** .. 3 B * .. 2 * * * .. 3 6 * .. 3 6 * 2 .. 3 A 2 .. 38 * .. * 2 .. * 4 * .4.86E+01. 86C * * * ... 494 * * .. 3A * * .. 3A 3 .. 6 B * 4 .. * 6 * .. ** * .. 2 8 2 .. 6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.3. An index plot of the independent variable,dose amount (AMT). Note the outlier at about ID = 3.Figure 11.4 replots the same data as figure 11.3 but withthe misrecorded values of the data items corrected. Figures11.5 and 11.6 show the index plots for the other two dataitems of interest to this data analysis: weight (WT) andApgar score (APGR).AMT VS. ID-1.00E+00 1.34E+01 2.78E+01 AMT 4.22E+01 5.66E+01 7.10E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. ..5 9B * * ..3 B * ..3 A * ..3 A * ..6 CB * * ..3 C * ..4 C * ..3 B * .1.14E+01.4 E * 2 * ...2 C 2 ..4 C * ..2 B * ..3 C* 2 ..7 M 2 * ..3 2A 2 ..3 B * ..3 C 2 ..5 3 B 2 * .2.38E+01.3 C * 2 ...6 47 * * * ..2 9 *..3 6 * * ..* 3 * .ID .2 B 2 ..* * ..5 4 6 2 * *..2 6 * ..2 7 2 .3.62E+01.3 B * ...6 R * * ..3 B * ..2 * * * ..3 6 * ..3 6 * 2 ..3 A 2 ..3 8 * ..* 2 ..* 4 * .4.86E+01.8 6 C * * * ...4 94 * * ..3 A * * ..3 A *2 ..6 38 * 22 ..* 6 * ..* * * ..2 5 3 2 ..6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.4. See figure 11.3; the outlier has beencorrected. WT VS. ID5.00E-01 1.14E+00 1.78E+00 WT 2.42E+00 3.06E+00 3.70E+00. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. G F .. G .. H .. F .1.14E+01. 6 G ... G .. H .. E .. I .. G G .. H .. F .. H .. 7 F .2.38E+01. I ... K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... G J .. F .. 5 .. A .. 2 A .. F .. C .. 3 .. 6 .4.86E+01. D G ... J .. F .. G .. 8 E .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.5. Index plot for weight (WT)APGR VS. ID9.00E-01 2.74E+00 4.58E+00 APGR 6.42E+00 8.26E+00 1.01E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. V .. G .. H .. F .1.14E+01. G 6 ... G .. H .. E .. I .. W ..H .. F .. H .. F 7 .2.38E+01. I ...K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... J G .. F.. 5 .. A ..2 A .. F .. C .. 3 .. 6 .4.86E+01. T ... J .. F .. G .. M .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.6. Index plot for Apgar score (APGR)These plots will be useful in the next stage of modelbuilding.4. Building the Structural Part of the ModelOne must first consider the choice of the structural kineticmodel. For the phenobarbital data, a monoexponentialkinetic model has been chosen. Presumably, the basicstructural kinetics are already known well enough for thiswell studied drug, and it is not necessary to explore thefits of other possible structural kinetic models to the dataat hand. Rather, in this section we focus on the newer taskto most users of NONMEM, the task of building the structuralpart of the model for the PK parameters.4.1. A General ApproachIt is generally advisable to start from the simplestreasonable model, and proceed toward greater complexity,stopping whenever further additions fail to improve themodel fit. Thus, one needs several types of tools: (i)those to choose a &quot;minimal&quot; model, (ii) those to indicatewhat part of a current model needs to be altered orelaborated (called model diagnosis or model criticism), and(iii) those to judge whether an alteration or elaborationhas led to an improved model.With such tools, one proceeds step by step from the minimalmodel, running NONMEM and using the diagnostic tools at eachstep to suggest a single addition for the next step. Theprocess will terminate when the judgement tools indicate noimprovement by any of the additions suggested by thediagnostic tools, or when the diagnostic tools fail tosuggest any more additions.The NONMEM runs at this stage, since there will be many ofthem, should be made as short as possible. To do so, onlythe estimation, table and scatterplot features need be used;the Covariance Step need not, in general, be run.4.2. The Minimal ModelAs suggested above, the minimal model involves the simplestpharmacokinetic model (ADVAN) likely to fit the data, andthe simplest possible structural PK parameter model: eachparameter is simply identified with a separate element of &theta;.At this stage, the statistical model should also be verysimple. Only one, or at most two &eta; variables should bedefined. These will usually affect (first) the scaleparameter (which itself, is often a volume of distributionparameter) and (second) some other parameter influencing theoverall kinetics. Since the overall kinetics exhibited inthe data will usually be dominated by elimination, thesecond &eta; should usually modify the rate constant ofelimination or clearance. However, some (kinetic) data setsare dominated by absorption or distribution, and in suchcases, the second &eta; should probably modify the parametermost affecting these processes. A single &epsilon; should usuallysuffice. Both inter- and intra-individual errors canconveniently be modeled as proportional, so that thedetermination of initial estimates of variances is madeeasier, and all such estimates are on the same scale, butthis is a matter of taste. The model for the phenobarbitaldata defined in Chapter 2 (figure 2.6) almost fulfills thespirit of these restrictions. However, the inter- andintra-individual error models there are additive, ratherthan proportional. The minimal model used on thephenobarbital data in this chapter is therefore a modifiedversion of that used in Chapter 2. It is:CL=&theta;1(1+&eta;1) (11.1a)V=&theta;2(1+&eta;2) (11.1b)y=F(1+&epsilon;1) (11.1c)In (11.1), it is understood that S=V, and that F is theprediction of y from ADVAN1 using CL and V. A control fileto NM-TRAN that specifies this model, and instructs NONMEMto produce the desired output is:$PROBLEM PHENOBARB SIMPLE MODEL (#1)$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PK TVCL=THETA(1)CL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0,.0105) (0,1.05)$OMEGAS .25 .25$SIGMAS .04$ESTIMATION$TABLE ID TIME AMT WT APGR$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS (PRED,WT,APGR)$SCATTERPLOT WRES VS (PRED,WT,APGR)4.3. Use of ConstraintsIt is important to realize that constraints on elements of &theta;or &Omega; may be part of a model.For example, constraining clearance to be positive isa modelling choice. One might implement this constraintin NONMEM using a lower bound on the $THETA record, and this wouldassure that the estimate of clearance will be positive.It may not be necessary to do this; even without the lower bound, the datamight clearly force the estimate to be positive.Often, however, analysts will constrain the range of aparameter in the belief that doing so will shorten computingtime or stabilize the search for the minimum of theobjective function. While this benefit may be gained, thedata may force the parameter estimate to the constraintboundary even though this boundary may not, in fact,represent a true modeling choice. In this case the properaction is to relax the constraint and rerun the problem. Todo otherwise, and leave the parameter estimate to be theboundary value, implies that at the outset the user assumesthat the parameter must be within the boundary and elevatesthe constraint to the status of a modeling choice. If anestimate lies on a boundary, NONMEM will print a warningmessage (along with the standard message regarding thestatus of the termination of the Estimation Step). Thereader is cautioned to look for such a message, and ingeneral, it is a good idea to check the values of the finalestimates against the boundary values. Alternatively, theimplementation of constraints that are not intended torepresent modeling choices might be used cautiously and onlyif they really seem necessary to stabilize a search.4.4. Diagnostic Tools4.4.1. Plot of DV vs PREDMost useful diagnostic tools are graphical. For an overallsense of the fit, a useful diagnostic plot is DV vs PRED.When there are substantial and systematic deviations fromthe line of identity, this plot suggests that there areproblems with the fit, but it does not suggest what exactlythese problems might be or what to do about them. This plotfor the fit of the phenobarbital data to model (11.1) isseen in figure 11.7.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. .* .. . .. * * ** * * .. * * 2 * * * .. .* .. * *2* * * * .1.80E+01. * .*** 2* * ... * * *23 * .. 2 * . *2 **** * .. *2 ***** * * * * .. 22 2. * * .. 3 * ** * ** * .. ** *2 3 * * * .. * . 2 * * .. * ** . * * * * * .. * * *** * * .3.10E+01. ** *2 22 ... * ** . .. * 22*.* * .. * * . * .. * * * . .DV . * * 2 * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.7. Predictions from fit of model (11.1) tophenobarbital data vs observations themselves. The line ofidentity (...) shows where the points should, ideally, fall.Figure 11.7 reveals that there is a group of points wherethe observation is much lower than the prediction. To beginto determine why this is so, it will be useful to look atresidual plots. Such plots are the basis of the mostimportant of the diagnostic tools.4.4.2. Residual PlotsAs mentioned in Chapter 2, a residual is the differencebetween an observation and its prediction. The predictionin this case (the same prediction as denoted by PRED) is thepopulation prediction, i.e. the prediction for the typicalindividual having the given values for all the concomitantvariables.With population data, weighted residuals are often moreinformative than (plain) residuals. The weighted residualsfor an individual are formed by transforming theindividual&rsquo;s residuals so that under the population model,and assuming the true values of the population parametersare given by the estimates of those parameters, all weightedresiduals have unit variance and are uncorrelated. Weightedresiduals are more informative for several reasons. First,since they have unit variance, or what is the same, unitstandard deviation, &quot;large&quot; weighted residuals are thosewith absolute values greater than 3 or so. Second, looselyspeaking, although plain residuals remove the structuralmodel from the data, allowing one to see what part of thedata is not (yet) modeled, they do not remove thestatistical model (formally, they are still correlated).Weighted residuals have both models &rsquo;removed&rsquo; so any patternin these is definitely not accounted for by the currentmodel. This provides a more secure basis for future modelbuilding choices.4.4.2.1. Index Plots of ResidualsFigure 11.8 is an index plot of residuals, which is a usefulplot when combined with index plots of other data items.One can look for an association between unusual residualsand values of another data item. E.g. Are the largestdiscrepancies between model and data associated with certain(possibly extreme) values of the data item?RES VS. ID-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. 2* 2 .. * ** . .. . 2 * .. * 2 . .. * .* 3* .. . * ** .. . 22 .. 2 * .1.14E+01. * **.* ... . * * .. 2 * * .. **. .. * * * .. *** . * 3 .. .* ** .. . *2 .. * * * . .. * * * ** .2.38E+01. * * * . ... * . * * 2 * .. * * . .. * * * .. . * .ID . ** . .. . * .. * * * 2 . .. ** . .. ** . .3.62E+01. * * .* ... ** **** .. * * * . .. 2 .. * * * . .. * * . * .. 2* . .. . *** .. . * .. * . .4.86E+01. * 2 * *2* ... . * * * * .. * * * .. . ** * .. * * 22 .. * . .. . * .. * * . .. *. ** * ** .. . .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 11.8. Index plot of residuals from fit of model(11.1) to phenobarbital data.In the phenobarbital example, this is clearly so: The largenegative residuals (i.e., predictions greater thanobservations), first noted in figure 11.7, are here seen tobe associated with patients 22 to 32 or thereabouts. Infigures 11.4 and 11.5 it is clear that these same patientsare those who received the highest doses and who weigh themost. An obvious explanation, then, of the over-predictionsis that they are in the patients who weigh the most, andbecause weight is not in the model, neither volume norclearance is adjusted to be larger in such individuals, sothat predictions are strictly proportional to dose alone andmay be too large for these heavier patients.4.4.2.2. Plot of WRES vs Independent VariableAnother way to see the association between weight (or dose)and the large residuals is to plot the residual againstweight, say. Figure 11.9 is this plot, but where, forreasons already discussed, weighted residuals, rather thanplain residuals, are used.WRES VS. WT-3.10E+00 -1.92E+00 -7.40E-01 WRES 4.40E-01 1.62E+00 2.80E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . .. . *.. * * . ** * * * * * 2 .. . .. . * * * .. * * . * * * * * * * * .. . .. * * * ** * * *2 * .. * * * * ** 2 ** ** * * **** * * .1.14E+00. . ... * * * ** 2* * ** **** .. * * ** * ** *. ** * * .. . .. * ****2*** .22**2 * .. . .. 2 * ** **.* * * * .. . .. . .. ** *** ** *. * .1.78E+00. * * * ** * *** ... . .. * *2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * * . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.9. Plot of weighted residuals vs weight for fitof minimal model to phenobarbital data.It is clear from figure 11.9, in a way that is particularlycompelling, that it is precisely those individuals with thelargest weight whose residuals are large and negative. Thistype of residual plot, where (weighted) residuals areplotted against some independent variable, is the singlemost useful diagnostic tool.Systematic patterns of weighted residuals, then, suggestpossible model improvements. For an independent variablethat already appears in the model, such a pattern maysuggest that the way in which it enters the model isincorrect; e.g., it might appear as having a linearinfluence on a PK parameter, and a curvilinear influencemight be better, or it might affect additional PKparameters, beyond those it affects in the current model.An example of this will be seen shortly. For a variablethat does not yet appear in the model, as in figure 11.9,such a pattern suggests that the element should appear.Before examining what happens if patient weight is added tothe model, a caution about residual plots is in order.Neither residuals, nor weighted residuals, should ever beplotted against the observations themselves. Such a plotwill always show a correlation, spuriously suggesting aproblem with the model. This is most easily appreciated byconsidering the simple model that gives rise to theconstant-valued prediction given by the the mean of theobservations. All positive residuals (observations greaterthan prediction) must then be associated with observationsgreater than the mean, while all negative residuals must beassociated with observations less than the mean. Clearly,then, the residuals plotted against the observations mustshow a line with positive slope. This same type ofassociation, although to a lesser degree, holds true, evenin less extreme cases. The phenomenon is illustrated infigure 11.10.+chapt11/fig11.10.ubuntu.epsiFigure 11.10. Residuals always correlate with theobservations themselves; the more so, the less the modelexplains the data!4.5. Judging Goodness of FitA more complex model is acceptable only if the complexitycan be justified by some significant improvement in the fit.To evaluate whether this has been accomplished, severalmeasures should be examined; no single measure suffices.In the phenobarbital example, based on the finding in figure11.9, a modified model is suggested. This model, (11.2),has (11.2b)=(11.1b), and (11.2c)=(11.1c), butCl=(&theta;1+&theta;3WT)(1+&eta;1) (11.2a)which is a full model relative to the reduced model (11.1a),whence (11.2) is a full model relative to the reduced model(11.1).Themodel-defining statements to NM-TRAN ($PK and $ERROR) now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))We now examine some measures of goodness of fit, and see how(11.2) fares relative to (11.1).4.5.1. A Global Measure &mdash; Change in the Objective FunctionA global measure of goodness of fit is, of course, theobjective function value based on the final parameterestimates, which, in the case of NONMEM, is minus twice thelog likelihood of the data (see Chapter 5, Section 5.2.3).As noted in Chapter 5, if the new model differs from theprevious model only by the addition of some new variable(s)(so that the two models form a full/reduced model pair),then the difference in objective function values has a known(approximate) statistical distribution. More informally,during model-building, a fall in objective function value of4 when a single new parameter is introduced (and no old onesare eliminated) indicates that the new model hassubstantially improved the overall goodness of fit. Model(11.2) shows a decrease in objective function of 35.2relative to (11.1), indicating considerable improvement.4.5.2. Decrease in Unexplained VariabilityThe purpose of adding independent variables to the model isusually to explain kinetic differences among individuals.This means that prior to adding a variable, such differenceswere not &quot;explained&quot; by the model, and hence were part ofrandom interindividual variability, although thesedifferences could also have been reflected as a part ofrandom intraindividual variability. Accordingly,elaboration of the model should be accompanied by a decreasein the estimates of the variances in &Omega; and/or &Sigma;.The estimates of &omega;2CL, &omega;2V, and &sigma;2 from the fit to Model(11.2) are .057, .12, and .0196, corresponding tocoefficients of variation of 24%, 35%, and 14%,respectively. The corresponding values from the fit to(11.1) are .25 (CV=50%), .14 (CV=37%), and .016 (CV=13%), sothat a considerable reduction in the variance of clearanceis seen.4.5.3. Improvement in PlotsThe last, and most useful, evidence confirming the value ofelaborating a model is to find that the pattern(s) in thePRED vs DV and weighted residual plot(s) that suggested theneed for the addition have now disappeared. Indeed, when amodel is relatively complete, all weighted residual plotsshould show no pattern: the &quot;unexplained&quot; part of the datashould have become featureless random noise.Figures 11.11 and 11.12 correspond to 11.7 and 11.9, but arefrom the fit to model (11.2).PRED VS. DV6.00E+00 2.40E+01 4.20E+01 PRED 6.00E+01 7.80E+01 9.60E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... * .. . .. . .. .* .. . .. * ** * * * ..* * *** * * .. * . .. * ***** * * .1.80E+01. * *.** ** ** ... * * * 2*2 * .. ** ** . 3 ** * * .. *2 ** 2 * ** * * .. 22 **. * * .. ** ** .2 * * * * .. * * * ** 2* * * * .. * .** ** .. * 2 .* * 2 * .. ** 2* * * .3.10E+01. * * 4*2. ... * 2 . .. * *******. .. * * . * .. ** * . .DV . * * * ** . * * *.. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.11. Predictions from fit of model (11.2) tophenobarbital data vs observations.Compared to figures 11.7 and 11.9, figures 11.11 and 11.12indicate an improvement in that the number of large negativeresiduals is clearly reduced in both plots.WRES VS. WT-3.50E+00 -2.22E+00 -9.40E-01 WRES 3.40E-01 1.62E+00 2.90E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . .. . * ..* * * ** * *** * * .. . .. . * * * .. * * * * 2 * * * *.. . .. * * * * * . 2 ** * * .. * * * * ** *2 * * 2* 2 * ** * .1.14E+00. . ... * * * * ** 2** ** *** .. * * 2 ** *.2 * * * .. . .. * *2** **3 *** *** * * .. . .. * * * * 3.* * * * .. . .. . .. ** * * 2 * * * .1.78E+00. * ***2* . * * ... . .. * * 2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * . * .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.12. Plot of weighted residuals vs weight for fitof model (11.2) to phenobarbital data.4.6. Using the Tools: Further Improvement4.6.1. An Additional Effect of WTWhile all of the above suggests that model (11.2) issuperior to model (11.1), figure 11.12 shows a persistentlinear relationship between weight and residuals. Thus, theaddition of weight to the model for clearance does not fullyexploit the information in the variable, weight. An obviousmodification to model (11.2) that might deal with this is tohave weight affect V as well as CL. Accordingly, definemodel (11.3) such that (11.3a)=(11.2a), (11.3c)=(11.2c), butV=(&theta;2+&theta;4WT)(1+&eta;2) (11.3b)The model-defining portion of the control stream nowbecomes:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTV=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When model (11.3) is fit to the data, the objective functiondecreases fully 126 relative to model (11.2). Moreover, theestimates of &omega;2CL, &omega;2V, and &sigma;2 are now .050 (CV=22%), .028(CV=17%), and .011 (CV=10%), indicating a furthersubstantial decrease in unexplained variation. The plotscorresponding to 11.7/11.11 and 11.9/11.12 are shown asfigures 11.13 and 11.14.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * *2* .. * *. * * * * * .. *. .. .2 *2* * * .1.80E+01. * *22 * * ... * **5 * .. *22* . * * * * * .. * *4** *. * * * .. 2* * *. * * * .. * * ** * . * 2 * * .. * *2 ** * . 2 * * .. * ** . * * .. * ** 2 * . * * .. * * * * *. * * .3.10E+01. * * *2 . * * * * ... ** . * .. ** 2 * ** * . .. * 2 . .. * * * . .DV . * * * 2 . * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. *.. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.13. Predictions from fit of model (11.3) tophenobarbital data vs observations.Now there are no obvious discrepancies, and the plot ofweighted residuals vs WT shows no pattern, so that it islikely that no further use of weight in the model isrequired. WRES VS. WT-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * . .. * * * * ** . * *** * .. . .. ** * . .. * * * * . * * * * * * .. . .. * ** 2 * ** ** * .. * * 2* 2* 2 * * * *** ** * * .1.14E+00. . ... * * * * .2* 2 * 2 * ** .. * * * * * *** * * * * .. . .. * * **** *** . 2 ***2 * * * .. . .. * * * ** *. * * * * * .. . .. . .. * * 2* * * * * .1.78E+00. * * .* *** * * * ... . .. * * . * * * .. . .. . .WT . * . * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * .. . .. . .. . .. . .. . * * .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.14. Plot of weighted residuals vs weight for fitof model (11.3) to phenobarbital data.4.6.2. The Effect of APGRThe structural model building stage is not over until allavailable independent variables have been examined forinfluence, and there is one additional variable, the Apgarscore, that has not yet been seriously considered. A plotof the weighted residuals from the fit to model (11.3) vsAPGR is shown in figure 11.15.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * * * * ** * * * * .. . .. . .. . .. . .. * * ** * * .. . .. . .. . .2.68E+00. . ... . .. * 2 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * 2 ** . * 2 * 2 ** 2 * .. . .. . .APGR . . .. . .. . .. * * * 2* **2* 2 2 2 *** ** * .. . .6.44E+00. . ... . .. . .. * 2* * * **** *** ***2*22 ** * ** * * * .. . .. . .. . .. . .. * * * * * ** * * *2 * 2*** 2*223 * * * * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* *** * * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.15. Plot of weighted residuals vs Apgar score forfit of model (11.3) to phenobarbital data.There is a weak suggestion from figure 11.15 that for APGRless than 3, the weighted residuals tend to be negative.Accordingly, a new model (11.4) can be proposed, which isidentical to (11.3) except that&theta;2+&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2(11.4b))(&theta;2+&theta;4WT)&theta;5,ifAPGR&le;2The relevant statements for NM-TRAN now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When this model is fit to the data, &theta;5 is estimated to be1.18, implying that indeed, the volumes of distribution forinfants with Apgar scores less than 3 are typically 18%higher than those of infants (of the same weight) withhigher Apgar scores. The measures of improvement are nowmarginal, however: the objective function decreases only3.7, and the decreases in the variances are all less than10% of their previous values, with the variance of &epsilon;actually increasing a few percent. Inspection of figure11.6 suggests a reason for this: note that only 5 distinctindividuals (separate symbols) have Apgar scores less than3. There is simply not very much information about babieswith low Apgar scores in this data set.For completeness, figure 11.16 corresponds to figure 11.5,but using model (11.4), and now shows no distinct pattern.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * 2 * 2 . * * * * .. . .. . .. . .. . .. * * * * . * * .. . .. . .. . .2.68E+00. . ... . .. 3 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * ** * * . 3 * 2 ** * * *.. . .. . .APGR . . .. . .. . .. * * * * 2**2* 22 *2 ** 2 * .. . .6.44E+00. . ... . .. . .. * *2 * * * 2* * * 2 3.*23 2 * * * * * * .. . .. . .. . .. . .. * * * * * ** * **2. ***2* 2*2*3* * ** * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* * *** * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.16. Plot of weighted residuals vs Apgar score forfit of model (11.4) to phenobarbital data.The stage of building the structural model is now complete.5. Building the Statistical Model5.1. Judging Among AlternativesNONMEM can provide estimates of the &eta; variables for eachindividual (see Chapter 12, Sections 4.11-4.13). Plots ofthe estimated interindividual differences, which can beregarded as interindividual residuals, can be obtained.Plots of these residuals (associated with a particular PKparameter) versus the values of an independent variableprovide further help in building the structural part of theparameter model. Moreover, a plot of these residuals versusthe typical values of the parameter (whose values depend oncovariates) also provides help in building the model forinterindividual differences themselves. For example, ifinterindividual differences are modeled with the additivemodel, but the plot shows a linear trend (in the boundariesenveloping the residuals), this suggests that a proportionalmodel be tried.Lastly, help can be provided in the selection of a model forintraindividual error. Predictions of concentrations, andhence residuals, based on estimates of individuals&rsquo; &eta;s, canbe computed, and the residuals can be plotted versus thepredictions. (This requires advanced techniques.) Again,if intraindividual errors are modeled with the additivemodel, but the plot shows a linear trend in the envelope,this suggests that a proportional model be tried.The statistical model is usually of less interest than thestructural model, so that frequently all that is sought isan adequate model, not necessarily the correct one, nor doesone care whether the estimates of the random effectsparameters (the elements of &Omega; and &Sigma;) are particularlyprecise. Sometimes, however, the variability in the randomeffects is of genuine primary interest. In such cases moreattention must be paid to building the random effects model.This, however, may not be easy because it is an unfortunate,but unavoidable fact, that a great deal more data is neededto estimate random effects parameters with a given precisionthan is needed to estimate fixed effect parameters withcomparable precision.The tools used to elaborate the statistical model aresimilar to those used for elaborating the structural model:alternative models are assessed using (available) residualplots, especially ones like those just discussed, andrelative changes in the objective function.5.1.1. Unexplained VariabilityWhen the statistical model is developed, a new &eta; variablemay be added, or an old &eta; variable used differently. Thendifferences in the &omega;s between models cannot really be usedto judge the benefit of the addition, and this evaluationtool becomes less useful. On the other hand, an addition ofan &eta; might be confirmed by a reduction in the estimates ofthe variances in &Sigma;, the variances of the random componentsin the model for residual error. However, there is one suresign that too many &eta;&rsquo;s are in the model: NONMEM mayestimate one or more of the &omega;s to be zero, or very nearlyzero. This can be disconcerting, particularly if the &eta;variable is the only such variable affecting Volume, forinstance, as then this estimate seems to suggest that withrespect to Volume, there is no interindividual variabilityin the population whatsoever! The result should not beinterpreted this way, however. Rather, assuming the &eta;affecting Volume is the one most recently added, itindicates that given the previous statistical model, noadditional variability needs to be ascribed to volume toexplain all the variability seen. The data cannot supportsuch an elaborate statistical model, and a simpler model,such as the previous one, must be used.5.1.2. Residual PlotsThe most important residual plot is now a plot of theweighted residuals against predictions, where a pattern inthe shape of the outer envelope of points can indicatedeficiencies in the statistical model (recall that adistinct pattern in the local &quot;average&quot; residual vs thepredictions would indicate a defect in the structuralmodel). This can be illustrated using the phenobarbitaldata. Figure 11.17 shows the plot of weighted residuals vspredictions for model (11.4), and figure 11.18 shows thesame plot for a modified model, (11.5), identical to (11.4)except fory=F+&epsilon;1 (11.5c)Only the $ERROR statements of the control stream change:$ERRORY=F+ERR(1)WRES VS. PRED-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. 2 . .. * . * .. * . * .. * * . * .1.82E+01. * ** . * * ... * * . 2 * * .. * * * 2 2* *2 2 *3. 2*2 *** *** ** * * .. * * * * * .. . * * .. * *. * .. * . * * 2 * .. * * * * . * * * * * * .. * . * * .. * * ** * * * *.2.74E+01. * . * * ... * * * *.* * * * .. * * . * * .. * * * 2 . * * * .. * * * * * . * * * .PRED . * * . ** * ** * .. .** * .. * . .. . * 2 .. . .3.66E+01. * . * ... * * . ** * .. * . .. * . .. * * . * .. . .. . .. . .. * . .. . .4.58E+01. * . ... . .. . .. . .. . .. . .. . .. . .. .* * .. . .5.50E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.17. Plot of weighted residuals vs predictions forfit of model (11.4) to phenobarbital data (proportionalintraindividual error).Although the plots do not differ greatly, there is a smallsuggestion in figure 11.18 that the envelope of weightedresiduals is somewhat V-shaped with the apex of the V atPRED=0 (but which does not show on the plot), while infigure 11.17 the weighted residuals seem more homogeneous,and their magnitude seems less dependent on that of thepredictions. That this impression is valid is suggestedalso by the increase in objective function of 7.6 in goingfrom model (11.4) to (11.5).WRES VS. PRED-3.20E+00 -2.04E+00 -8.80E-01 WRES 2.80E-01 1.44E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. **. .. * . * .. * .* * * .. * * . .1.80E+01. * * . * ... * * . * * * * .. * * ** * * * 2 **2* 3* *** * * ** .. ** 2 * ** 2* * * * .. .* * .. * .* .. * . 2 * * * .. * * * *. 2 * * .. * . * * ** * .. * .2 * * * .2.70E+01. * * . * ... * * .* * * * * .. * 2 * * * * ..* * * . * * .. * * * * * * . * * * * .PRED . * * . * * ** * .. * . * 2 .. * . * .. . * .. . * * * .3.60E+01. * * . * ... * . * .. * . * .. * * . * .. * . .. . .. . .. . .. . .. * . .4.50E+01. . ... . .. * . .. . .. . .. . .. . .. . .. * . .. . * .5.40E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.18. Plot of weighted residuals vs predictions forfit of model (11.5) to phenobarbital data (additiveintraindividual error).6. Refine ModelThe goal of this stage is to check whether the model is asparsimonious as reasonable, since if it is not, certainimportant parameters may not be estimated with as goodprecision as can be achieved. Although up to this stage,one tries to avoid adding parts to the model which are notwell supported by the data, it is nonetheless possible thata part added at one stage may seem unnecessary after addinganother part at a later stage. Perhaps, for example, weightaffects V, and V and CL are correlated in the population(independent of weight), but first the influence of weighton CL is examined, and later its influence on V is examined(this was the order illustrated above). Then initially,weight might appear to influence CL, although this influencemight only derive from the correlation between the two PKparameters. Later, after the influence of weight on V is apart of the model, the influence of weight on CL mightdisappear. One wants to check this possibility and, ifindicated, eliminate the influence of weight on CL from themodel at the stage now being described. The basic techniqueat this stage, is to run the Covariance Step with the bestmodel thus far, and look for parameters with confidenceintervals that include the parameter&rsquo;s null value, i.e., thevalue that causes the parameter to be effectively deletedfrom the model. A null value is usually zero (for aparameter quantifying an additive portion of the model), andsometimes unity (for a parameter quantifying amultiplicative part of the model). If such parameters arefound, then one at a time, each can be set to its null valueand the consequences examined as discussed above for theearlier model building stages.Figures 11.19 and 11.20 show two pages of NONMEM output froma run fitting model (11.4) to the phenobarbital data, andimplementing the Covariance Step. Figure 11.19 shows thefinal parameter estimates, and 11.20, their standard errors.******************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 57.50E-05 2.66E-02 4.62E-03 9.53E-01 1.18E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 4.59E-02ETA2 0.00E+00 2.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.10E-02Figure 11.19. Parameter estimates from fit of model (11.4)to phenobarbital data.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 59.59E-04 9.24E-02 7.33E-04 7.48E-02 8.36E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.25E-02ETA2 ......... 7.08E-03SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 2.01E-03Figure 11.20. Standard errors of parameter estimates fromfit of model (11.4) to phenobarbital data.6.1. Use of Standard Errors and Confidence IntervalsThe null values of &theta;1 through &theta;4 are zero, while the nullvalue of &theta;5 is unity. Using the numbers from the figures,it is easily seen that for &theta;1 and &theta;2, the parameterestimate minus the null value is a fraction of one standarderror, and hence &theta;1 and &theta;2 may not be different from theirnull values.As indicated in Chapter 5 (Section 4.2.2), an approximate(two-sided) 95% confidence interval for a parameter estimateis&theta;&plusmn;Z.975SEwhere Z.975 is the 97.5 percentile of the normaldistribution (&asymp;2) and SE is the standard error of theparameter estimate. Therefore, for &theta;5, a 95%confidence interval is given by 1.18&plusmn;(2)(.0836), whichis 1.01 - 1.35. This range only barely missesincluding the null value, unity,indicating, as did the marginal change in theobjective function associated with going from (11.3) to (11.4),that one cannot be very sure of the influence of Apgar score onvolume.Finally, note the magnitudes of the standard errors of theother parameters&rsquo; estimates. For &theta;3 it is 16% of theestimate (i.e., the CV of the estimation error is 16%), for&theta;4 it is 7.8%, while for the 2 elements of &Omega; it is 49% and27%. This pattern is typical: the precision of the fixedeffect parameter estimates is considerably greater than thatof the random effects parameter estimates, except when thenumber of individuals sampled is enormous.6.2. A Model RefinementBased on the observation that &theta;1 and &theta;2 may be equal totheir null values, these parameters are next set to theirnull values, defining a new (and final) model,Cl=&theta;3WT(1+&eta;1) (11.6a)&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2) (11.6b)(&theta;4WT)&theta;5,ifAPGR&le;2y=F(1+&epsilon;1) (11.6c)which is communicated to NM-TRAN without changing the$PK or $ERRORstatements, but simply by fixing the values of &theta;1 and &theta;2to 0, using the FIXED option in the $THETA record:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0 FIXED) (0 FIXED) (0,.0018) (0,.43) 1.0When this model is fit to the data, the objective functionincreases only .12 (a trivial change). However, now theCV&rsquo;s of the estimation errors in &theta;3 and &theta;4 are 4.4% and 2.5%respectively.This is the main point of this section on model refinement;deletion of imprecisely estimated parameters can improve theprecision of other parameter estimates. This is related tothe correlation between parameter estimation errors,mentioned in Chapter 5. With little data from patients whoweigh virtually nothing, &theta;1 and &theta;2, the values of CL and Vfor such patients, are not well estimated (regardless of thefact that one might rationally model the values of theseparameters to be 0), and so their parameter estimates arelargely dependent on the estimates of the slope parameters&theta;3, &theta;4, and &theta;5. The correlation between the estimates of &theta;1and &theta;3 is -.96, and that between &theta;2 and &theta;4 is -.95. Ofcourse, since slope itself can only be well determined whenthe intercept is well determined, the parameter estimates of&theta;3, &theta;4, and &theta;5 themselves largely depend on the estimates of&theta;1 and &theta;2; correlations are symmetric. In other words,neither type of parameter (intercept or slope) is veryprecisely estimated since the estimate of each depends onthe value assigned to the other. But if one of theparameters can be eliminated from the model (i.e.,rationally assigned a fixed value), then the other can bemore precisely determined.7. Testing the ModelThis step is undertaken when it is desirable to assignp-values to the hypothesis test of one or more parametervalues against null values. The procedure is as follows:Beginning with the final model resulting from all previoussteps, each parameter to be tested is set, in turn, to itsnull value, and the reduced model is fit to the data (onlythe Estimation Step need be run; no tables, graphs orcovariance output are necessary). A likelihood ratio testis done using the difference in minimum objective functionvalues obtained with both the full (original) and reducedmodels. In doing this one must be careful that in theEstimation Step with a reduced model, no parameter otherthan the one under test (and those which are alreadyconstrained to fixed values under the full model) beconstrained to a fixed value.
<a name="1. What This Chapter is AboutIn this chapter, the simple phenobarbital example begun inChapter 2 will be continued to illustrate how NONMEM is usedto build a model for population data. The topic of modelbuilding, diagnosis and verification is a large one. Thischapter can only give a very abbreviated example.2. The Stages of Model BuildingTo analyze a population data set and build a model for it,one must proceed in logical stages. There are five stages,and their relationship to one another is presenteddiagrammatically in figure 11.1. One begins by checking thedata. One then tries to find an adequate modelincorporating the fixed effects; then an adequate modelincorporating the random effects and describing randominter- and intra-individual variability. After a reasonablycomplete model is found, attempts are made to refine it, andfinally, if desired, the various parts of the models (whichoften, in effect, simply assert the existence of certainrelationships between independent variables and thedependent variable) can be subject to formal hypothesistests, as described in Chapter 5. (However, it is wellknown by statisticians that formal hypothesis testingundertaken after model building is just an approximation forthe type of hypothesis testing described in textbooks, whichassumes that the model is the correct model).+chapt11/fig11.1.ubuntu.epsiFigure 11.1. Stages in model building.3. Check-out &mdash; Index PlotsThe goal of this stage is to assure that the data arecorrect. There is no point to trying to model the data whengross errors are present. Most gross errors are encodingerrors that cause certain values to be different from theintended value by a considerable amount (for example, amisplaced decimal point changes a value by a factor of 10),so that graphical display of the data is usually adequate todetect these. No numerical or statistical approaches areneeded. Indeed, they are not usually useful, even for moresubtle errors, as such errors cannot easily be detected byany means (how is a 10% error to be distinguished frominter- or intra-individual variability?).To detect gross errors, then, one makes scatterplots ofdifferent data item types vs individuals&rsquo; identificationnumbers (i.e. the ID data item, or, if the values of thisdata item are arbitrary, another data item that identifiespatients using sequential integer values; call this thesequence data item: SEQ). Such plots (of one data itemversus ID or SEQ) are called here inde_____ plots______ and are quiteuseful for revealing the structure of the data, as will benoted below, as well as for finding gross errors.If NONMEM is used to make index plots, it will also beuseful to implement the Tables Step, so that if a problem isnoted in a scatterplot, one can refer to the table to try tofind the datum that might account for the problem. To runNONMEM some model must be specified, even if all that isdesired is an index plot. In such case, it makes littledifference what model is used. It is easiest and useful to(i) start with a simple ADVAN that is likely to provide atleast a roughly satisfactory fit, (ii) set each PK parameterto a (different) element of &theta;, (iii) use only one &eta;variable, modifying the scale parameter only, and one &epsilon;variable, and (iv) use roughly reasonable fixed initialestimates.For the phenobarbital example, one might use ADVAN1 withK=&theta;1, V=&theta;2+&theta;2&eta;1, and y=f+f&epsilon;1. Initial estimates might be: K= .0057 hr &minus;1 (half-life = 5 days, a typical value foradults); V= 1.44 L. (the first patient has a concentrationof 17.3 mg/L some few hours after an initial loading dose of25 mg; 1.44 times 17.3 = 25); &omega; = .25 (50% variability); &sigma;2= .04 (20% variability).Figures 11.2 and 11.3 show index plots that might be seen ina check-out run (gross errors have been added). In figure11.2, DV is plotted vs ID (here ID and SEQ are the same),and a gross error occurring at about patient #13 is seen (anobservation of about 24 mcg/ml was erroneously recorded as240 mcg/ml). In figure 11.3, AMT is plotted vs ID, andpatient #3 appears to have a grossly erroneous value (again,a decimal point error; a dose of 18 was misrecorded as 180).DV VS. ID0.00E+00 5.00E+01 1.00E+02 DV 1.50E+02 2.00E+02 2.50E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. * * * ** .. * 2 .. * * * .. *** .. 2*** * .. * 2 .. ** * * .. ** * .1.14E+01. ** * * ... * * .. * 3 .. * * .. * * * .. * 2* 2 * .. ** * .. * * * .. 2 * .. 2*2 .2.38E+01. 2 * ... * * * ** * .. * * .. * * * .. * .ID . 2 .. * .. * 2* * .. * * .. * * .3.62E+01. * * * ... * *** ** .. * * * .. * * .. ** * .. ** * .. * * * .. ** * .. * .. * .4.86E+01. * * * *22 ... * * * * .. * ** .. * * * .. * * 2* * .. * .. * .. * * .. 2 ** * * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.2. A scatterplot of the dependent variable, DV,vs the patient&rsquo;s ID number (a type of index plot). Note theoutlier at about ID = 13.Actually, figure 11.3 reveals a considerable amount aboutthe data structure (this will be seen better in figure 11.4,below, when the outlier has been removed). Many points liealong the line AMT = 0, where one sees integers 5, 3, 3, 6,etc, as one proceeds along the ID axis, each integerindicating the corresponding number of points over-plottedat that location. They correspond to the observationrecords, since the doses on these records are all zero.Thus one can see how many observations each individualcontributes (other type records would also plot at AMT=0,however). Proceeding to the next highest &quot;line&quot; of doses(where many points over-plot for each patient), one &quot;sees&quot;the event records giving the maintenance dose amount sincethis amount stays constant within a individual (manymaintenance doses were given per individual), and thisamount is approximately the same across individuals. Last,at the highest doses (except for the outlier), one hasmostly single points. These are the loading doses. Thereis occasional over-plotting of loading-dose points. Thesepoints represent overlapping patient ID numbers (at theresolution of the NONMEM plot ), not multiple loading dosesto the same patient.AMT VS. ID-1.00E+01 3.00E+01 7.00E+01 AMT 1.10E+02 1.50E+02 1.90E+02. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. 5 K * * .. 3 B * .. 3A * .. 3 A * .. 6CB * * .. 3 C * .. 4 C * .. 3 B * .1.14E+01. 4 E* 2* ... 2C 2 .. 4C * .. 2 B * .. 3 D 2 .. 7M 2* .. 32A 2 .. 3 B * .. 3 C 2 .. 5 3 B 2 * .2.38E+01. 3 C * 2 ... 6B ** * .. 2 9 * .. 3 6 * * .. *3 * .ID . 2 B 2 .. * * .. 5 4 6 2 * * .. 2 6 * .. 2 7 2 .3.62E+01. 3 B * ... 6 R ** .. 3 B * .. 2 * * * .. 3 6 * .. 3 6 * 2 .. 3 A 2 .. 38 * .. * 2 .. * 4 * .4.86E+01. 86C * * * ... 494 * * .. 3A * * .. 3A 3 .. 6 B * 4 .. * 6 * .. ** * .. 2 8 2 .. 6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.3. An index plot of the independent variable,dose amount (AMT). Note the outlier at about ID = 3.Figure 11.4 replots the same data as figure 11.3 but withthe misrecorded values of the data items corrected. Figures11.5 and 11.6 show the index plots for the other two dataitems of interest to this data analysis: weight (WT) andApgar score (APGR).AMT VS. ID-1.00E+00 1.34E+01 2.78E+01 AMT 4.22E+01 5.66E+01 7.10E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. ..5 9B * * ..3 B * ..3 A * ..3 A * ..6 CB * * ..3 C * ..4 C * ..3 B * .1.14E+01.4 E * 2 * ...2 C 2 ..4 C * ..2 B * ..3 C* 2 ..7 M 2 * ..3 2A 2 ..3 B * ..3 C 2 ..5 3 B 2 * .2.38E+01.3 C * 2 ...6 47 * * * ..2 9 *..3 6 * * ..* 3 * .ID .2 B 2 ..* * ..5 4 6 2 * *..2 6 * ..2 7 2 .3.62E+01.3 B * ...6 R * * ..3 B * ..2 * * * ..3 6 * ..3 6 * 2 ..3 A 2 ..3 8 * ..* 2 ..* 4 * .4.86E+01.8 6 C * * * ...4 94 * * ..3 A * * ..3 A *2 ..6 38 * 22 ..* 6 * ..* * * ..2 5 3 2 ..6 M 2 * .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.4. See figure 11.3; the outlier has beencorrected. WT VS. ID5.00E-01 1.14E+00 1.78E+00 WT 2.42E+00 3.06E+00 3.70E+00. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. G F .. G .. H .. F .1.14E+01. 6 G ... G .. H .. E .. I .. G G .. H .. F .. H .. 7 F .2.38E+01. I ... K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... G J .. F .. 5 .. A .. 2 A .. F .. C .. 3 .. 6 .4.86E+01. D G ... J .. F .. G .. 8 E .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.5. Index plot for weight (WT)APGR VS. ID9.00E-01 2.74E+00 4.58E+00 APGR 6.42E+00 8.26E+00 1.01E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. .. C F .. F .. E .. E .. V .. G .. H .. F .1.14E+01. G 6 ... G .. H .. E .. I .. W ..H .. F .. H .. F 7 .2.38E+01. I ...K .. C .. 9 2 .. 5 .ID . F .. 2 .. 8 B .. 9 .. B .3.62E+01. F ... J G .. F.. 5 .. A ..2 A .. F .. C .. 3 .. 6 .4.86E+01. T ... J .. F .. G .. M .. 8 .. 3 .. C .. G F .. .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.6. Index plot for Apgar score (APGR)These plots will be useful in the next stage of modelbuilding.4. Building the Structural Part of the ModelOne must first consider the choice of the structural kineticmodel. For the phenobarbital data, a monoexponentialkinetic model has been chosen. Presumably, the basicstructural kinetics are already known well enough for thiswell studied drug, and it is not necessary to explore thefits of other possible structural kinetic models to the dataat hand. Rather, in this section we focus on the newer taskto most users of NONMEM, the task of building the structuralpart of the model for the PK parameters.4.1. A General ApproachIt is generally advisable to start from the simplestreasonable model, and proceed toward greater complexity,stopping whenever further additions fail to improve themodel fit. Thus, one needs several types of tools: (i)those to choose a &quot;minimal&quot; model, (ii) those to indicatewhat part of a current model needs to be altered orelaborated (called model diagnosis or model criticism), and(iii) those to judge whether an alteration or elaborationhas led to an improved model.With such tools, one proceeds step by step from the minimalmodel, running NONMEM and using the diagnostic tools at eachstep to suggest a single addition for the next step. Theprocess will terminate when the judgement tools indicate noimprovement by any of the additions suggested by thediagnostic tools, or when the diagnostic tools fail tosuggest any more additions.The NONMEM runs at this stage, since there will be many ofthem, should be made as short as possible. To do so, onlythe estimation, table and scatterplot features need be used;the Covariance Step need not, in general, be run.4.2. The Minimal ModelAs suggested above, the minimal model involves the simplestpharmacokinetic model (ADVAN) likely to fit the data, andthe simplest possible structural PK parameter model: eachparameter is simply identified with a separate element of &theta;.At this stage, the statistical model should also be verysimple. Only one, or at most two &eta; variables should bedefined. These will usually affect (first) the scaleparameter (which itself, is often a volume of distributionparameter) and (second) some other parameter influencing theoverall kinetics. Since the overall kinetics exhibited inthe data will usually be dominated by elimination, thesecond &eta; should usually modify the rate constant ofelimination or clearance. However, some (kinetic) data setsare dominated by absorption or distribution, and in suchcases, the second &eta; should probably modify the parametermost affecting these processes. A single &epsilon; should usuallysuffice. Both inter- and intra-individual errors canconveniently be modeled as proportional, so that thedetermination of initial estimates of variances is madeeasier, and all such estimates are on the same scale, butthis is a matter of taste. The model for the phenobarbitaldata defined in Chapter 2 (figure 2.6) almost fulfills thespirit of these restrictions. However, the inter- andintra-individual error models there are additive, ratherthan proportional. The minimal model used on thephenobarbital data in this chapter is therefore a modifiedversion of that used in Chapter 2. It is:CL=&theta;1(1+&eta;1) (11.1a)V=&theta;2(1+&eta;2) (11.1b)y=F(1+&epsilon;1) (11.1c)In (11.1), it is understood that S=V, and that F is theprediction of y from ADVAN1 using CL and V. A control fileto NM-TRAN that specifies this model, and instructs NONMEMto produce the desired output is:$PROBLEM PHENOBARB SIMPLE MODEL (#1)$INPUT ID TIME AMT WT APGR DV$DATA PHENO$SUBROUTINE ADVAN1$PK TVCL=THETA(1)CL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0,.0105) (0,1.05)$OMEGAS .25 .25$SIGMAS .04$ESTIMATION$TABLE ID TIME AMT WT APGR$SCATTERPLOT PRED VS DV UNIT$SCATTERPLOT RES VS (PRED,WT,APGR)$SCATTERPLOT WRES VS (PRED,WT,APGR)4.3. Use of ConstraintsIt is important to realize that constraints on elements of &theta;or &Omega; may be part of a model.For example, constraining clearance to be positive isa modelling choice. One might implement this constraintin NONMEM using a lower bound on the $THETA record, and this wouldassure that the estimate of clearance will be positive.It may not be necessary to do this; even without the lower bound, the datamight clearly force the estimate to be positive.Often, however, analysts will constrain the range of aparameter in the belief that doing so will shorten computingtime or stabilize the search for the minimum of theobjective function. While this benefit may be gained, thedata may force the parameter estimate to the constraintboundary even though this boundary may not, in fact,represent a true modeling choice. In this case the properaction is to relax the constraint and rerun the problem. Todo otherwise, and leave the parameter estimate to be theboundary value, implies that at the outset the user assumesthat the parameter must be within the boundary and elevatesthe constraint to the status of a modeling choice. If anestimate lies on a boundary, NONMEM will print a warningmessage (along with the standard message regarding thestatus of the termination of the Estimation Step). Thereader is cautioned to look for such a message, and ingeneral, it is a good idea to check the values of the finalestimates against the boundary values. Alternatively, theimplementation of constraints that are not intended torepresent modeling choices might be used cautiously and onlyif they really seem necessary to stabilize a search.4.4. Diagnostic Tools4.4.1. Plot of DV vs PREDMost useful diagnostic tools are graphical. For an overallsense of the fit, a useful diagnostic plot is DV vs PRED.When there are substantial and systematic deviations fromthe line of identity, this plot suggests that there areproblems with the fit, but it does not suggest what exactlythese problems might be or what to do about them. This plotfor the fit of the phenobarbital data to model (11.1) isseen in figure 11.7.PRED VS. DV0.00E+00 2.60E+01 5.20E+01 PRED 7.80E+01 1.04E+02 1.30E+02. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . * .. . .. . .. .* .. . .. * * ** * * .. * * 2 * * * .. .* .. * *2* * * * .1.80E+01. * .*** 2* * ... * * *23 * .. 2 * . *2 **** * .. *2 ***** * * * * .. 22 2. * * .. 3 * ** * ** * .. ** *2 3 * * * .. * . 2 * * .. * ** . * * * * * .. * * *** * * .3.10E+01. ** *2 22 ... * ** . .. * 22*.* * .. * * . * .. * * * . .DV . * * 2 * * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.7. Predictions from fit of model (11.1) tophenobarbital data vs observations themselves. The line ofidentity (...) shows where the points should, ideally, fall.Figure 11.7 reveals that there is a group of points wherethe observation is much lower than the prediction. To beginto determine why this is so, it will be useful to look atresidual plots. Such plots are the basis of the mostimportant of the diagnostic tools.4.4.2. Residual PlotsAs mentioned in Chapter 2, a residual is the differencebetween an observation and its prediction. The predictionin this case (the same prediction as denoted by PRED) is thepopulation prediction, i.e. the prediction for the typicalindividual having the given values for all the concomitantvariables.With population data, weighted residuals are often moreinformative than (plain) residuals. The weighted residualsfor an individual are formed by transforming theindividual&rsquo;s residuals so that under the population model,and assuming the true values of the population parametersare given by the estimates of those parameters, all weightedresiduals have unit variance and are uncorrelated. Weightedresiduals are more informative for several reasons. First,since they have unit variance, or what is the same, unitstandard deviation, &quot;large&quot; weighted residuals are thosewith absolute values greater than 3 or so. Second, looselyspeaking, although plain residuals remove the structuralmodel from the data, allowing one to see what part of thedata is not (yet) modeled, they do not remove thestatistical model (formally, they are still correlated).Weighted residuals have both models &rsquo;removed&rsquo; so any patternin these is definitely not accounted for by the currentmodel. This provides a more secure basis for future modelbuilding choices.4.4.2.1. Index Plots of ResidualsFigure 11.8 is an index plot of residuals, which is a usefulplot when combined with index plots of other data items.One can look for an association between unusual residualsand values of another data item. E.g. Are the largestdiscrepancies between model and data associated with certain(possibly extreme) values of the data item?RES VS. ID-9.00E+01 -6.60E+01 -4.20E+01 RES -1.80E+01 6.00E+00 3.00E+01. . . . . .. . . . . . . . . . .-1.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . .. 2* 2 .. * ** . .. . 2 * .. * 2 . .. * .* 3* .. . * ** .. . 22 .. 2 * .1.14E+01. * **.* ... . * * .. 2 * * .. **. .. * * * .. *** . * 3 .. .* ** .. . *2 .. * * * . .. * * * ** .2.38E+01. * * * . ... * . * * 2 * .. * * . .. * * * .. . * .ID . ** . .. . * .. * * * 2 . .. ** . .. ** . .3.62E+01. * * .* ... ** **** .. * * * . .. 2 .. * * * . .. * * . * .. 2* . .. . *** .. . * .. * . .4.86E+01. * 2 * *2* ... . * * * * .. * * * .. . ** * .. * * 22 .. * . .. . * .. * * . .. *. ** * ** .. . .6.10E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . .. . . . . . . . . . .Figure 11.8. Index plot of residuals from fit of model(11.1) to phenobarbital data.In the phenobarbital example, this is clearly so: The largenegative residuals (i.e., predictions greater thanobservations), first noted in figure 11.7, are here seen tobe associated with patients 22 to 32 or thereabouts. Infigures 11.4 and 11.5 it is clear that these same patientsare those who received the highest doses and who weigh themost. An obvious explanation, then, of the over-predictionsis that they are in the patients who weigh the most, andbecause weight is not in the model, neither volume norclearance is adjusted to be larger in such individuals, sothat predictions are strictly proportional to dose alone andmay be too large for these heavier patients.4.4.2.2. Plot of WRES vs Independent VariableAnother way to see the association between weight (or dose)and the large residuals is to plot the residual againstweight, say. Figure 11.9 is this plot, but where, forreasons already discussed, weighted residuals, rather thanplain residuals, are used.WRES VS. WT-3.10E+00 -1.92E+00 -7.40E-01 WRES 4.40E-01 1.62E+00 2.80E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . .. . *.. * * . ** * * * * * 2 .. . .. . * * * .. * * . * * * * * * * * .. . .. * * * ** * * *2 * .. * * * * ** 2 ** ** * * **** * * .1.14E+00. . ... * * * ** 2* * ** **** .. * * ** * ** *. ** * * .. . .. * ****2*** .22**2 * .. . .. 2 * ** **.* * * * .. . .. . .. ** *** ** *. * .1.78E+00. * * * ** * *** ... . .. * *2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * * . .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.9. Plot of weighted residuals vs weight for fitof minimal model to phenobarbital data.It is clear from figure 11.9, in a way that is particularlycompelling, that it is precisely those individuals with thelargest weight whose residuals are large and negative. Thistype of residual plot, where (weighted) residuals areplotted against some independent variable, is the singlemost useful diagnostic tool.Systematic patterns of weighted residuals, then, suggestpossible model improvements. For an independent variablethat already appears in the model, such a pattern maysuggest that the way in which it enters the model isincorrect; e.g., it might appear as having a linearinfluence on a PK parameter, and a curvilinear influencemight be better, or it might affect additional PKparameters, beyond those it affects in the current model.An example of this will be seen shortly. For a variablethat does not yet appear in the model, as in figure 11.9,such a pattern suggests that the element should appear.Before examining what happens if patient weight is added tothe model, a caution about residual plots is in order.Neither residuals, nor weighted residuals, should ever beplotted against the observations themselves. Such a plotwill always show a correlation, spuriously suggesting aproblem with the model. This is most easily appreciated byconsidering the simple model that gives rise to theconstant-valued prediction given by the the mean of theobservations. All positive residuals (observations greaterthan prediction) must then be associated with observationsgreater than the mean, while all negative residuals must beassociated with observations less than the mean. Clearly,then, the residuals plotted against the observations mustshow a line with positive slope. This same type ofassociation, although to a lesser degree, holds true, evenin less extreme cases. The phenomenon is illustrated infigure 11.10.+chapt11/fig11.10.ubuntu.epsiFigure 11.10. Residuals always correlate with theobservations themselves; the more so, the less the modelexplains the data!4.5. Judging Goodness of FitA more complex model is acceptable only if the complexitycan be justified by some significant improvement in the fit.To evaluate whether this has been accomplished, severalmeasures should be examined; no single measure suffices.In the phenobarbital example, based on the finding in figure11.9, a modified model is suggested. This model, (11.2),has (11.2b)=(11.1b), and (11.2c)=(11.1c), butCl=(&theta;1+&theta;3WT)(1+&eta;1) (11.2a)which is a full model relative to the reduced model (11.1a),whence (11.2) is a full model relative to the reduced model(11.1).Themodel-defining statements to NM-TRAN ($PK and $ERROR) now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))We now examine some measures of goodness of fit, and see how(11.2) fares relative to (11.1).4.5.1. A Global Measure &mdash; Change in the Objective FunctionA global measure of goodness of fit is, of course, theobjective function value based on the final parameterestimates, which, in the case of NONMEM, is minus twice thelog likelihood of the data (see Chapter 5, Section 5.2.3).As noted in Chapter 5, if the new model differs from theprevious model only by the addition of some new variable(s)(so that the two models form a full/reduced model pair),then the difference in objective function values has a known(approximate) statistical distribution. More informally,during model-building, a fall in objective function value of4 when a single new parameter is introduced (and no old onesare eliminated) indicates that the new model hassubstantially improved the overall goodness of fit. Model(11.2) shows a decrease in objective function of 35.2relative to (11.1), indicating considerable improvement.4.5.2. Decrease in Unexplained VariabilityThe purpose of adding independent variables to the model isusually to explain kinetic differences among individuals.This means that prior to adding a variable, such differenceswere not &quot;explained&quot; by the model, and hence were part ofrandom interindividual variability, although thesedifferences could also have been reflected as a part ofrandom intraindividual variability. Accordingly,elaboration of the model should be accompanied by a decreasein the estimates of the variances in &Omega; and/or &Sigma;.The estimates of &omega;2CL, &omega;2V, and &sigma;2 from the fit to Model(11.2) are .057, .12, and .0196, corresponding tocoefficients of variation of 24%, 35%, and 14%,respectively. The corresponding values from the fit to(11.1) are .25 (CV=50%), .14 (CV=37%), and .016 (CV=13%), sothat a considerable reduction in the variance of clearanceis seen.4.5.3. Improvement in PlotsThe last, and most useful, evidence confirming the value ofelaborating a model is to find that the pattern(s) in thePRED vs DV and weighted residual plot(s) that suggested theneed for the addition have now disappeared. Indeed, when amodel is relatively complete, all weighted residual plotsshould show no pattern: the &quot;unexplained&quot; part of the datashould have become featureless random noise.Figures 11.11 and 11.12 correspond to 11.7 and 11.9, but arefrom the fit to model (11.2).PRED VS. DV6.00E+00 2.40E+01 4.20E+01 PRED 6.00E+01 7.80E+01 9.60E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... * .. . .. . .. .* .. . .. * ** * * * ..* * *** * * .. * . .. * ***** * * .1.80E+01. * *.** ** ** ... * * * 2*2 * .. ** ** . 3 ** * * .. *2 ** 2 * ** * * .. 22 **. * * .. ** ** .2 * * * * .. * * * ** 2* * * * .. * .** ** .. * 2 .* * 2 * .. ** 2* * * .3.10E+01. * * 4*2. ... * 2 . .. * *******. .. * * . * .. ** * . .DV . * * * ** . * * *.. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. . .. . .. . .. . .5.70E+01. . ... * . .. . .. . .. . .. . .. . .. . .. * . .. . .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.11. Predictions from fit of model (11.2) tophenobarbital data vs observations.Compared to figures 11.7 and 11.9, figures 11.11 and 11.12indicate an improvement in that the number of large negativeresiduals is clearly reduced in both plots.WRES VS. WT-3.50E+00 -2.22E+00 -9.40E-01 WRES 3.40E-01 1.62E+00 2.90E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . .. . * ..* * * ** * *** * * .. . .. . * * * .. * * * * 2 * * * *.. . .. * * * * * . 2 ** * * .. * * * * ** *2 * * 2* 2 * ** * .1.14E+00. . ... * * * * ** 2** ** *** .. * * 2 ** *.2 * * * .. . .. * *2** **3 *** *** * * .. . .. * * * * 3.* * * * .. . .. . .. ** * * 2 * * * .1.78E+00. * ***2* . * * ... . .. * * 2 . * .. . .. . .WT . * * . .. . .. . .. . .. . .2.42E+00. . ... * . * .. . .. * . .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * * * . .. * ** * . .. . .. . .. . .. . .. * * . .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.12. Plot of weighted residuals vs weight for fitof model (11.2) to phenobarbital data.4.6. Using the Tools: Further Improvement4.6.1. An Additional Effect of WTWhile all of the above suggests that model (11.2) issuperior to model (11.1), figure 11.12 shows a persistentlinear relationship between weight and residuals. Thus, theaddition of weight to the model for clearance does not fullyexploit the information in the variable, weight. An obviousmodification to model (11.2) that might deal with this is tohave weight affect V as well as CL. Accordingly, definemodel (11.3) such that (11.3a)=(11.2a), (11.3c)=(11.2c), butV=(&theta;2+&theta;4WT)(1+&eta;2) (11.3b)The model-defining portion of the control stream nowbecomes:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTV=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When model (11.3) is fit to the data, the objective functiondecreases fully 126 relative to model (11.2). Moreover, theestimates of &omega;2CL, &omega;2V, and &sigma;2 are now .050 (CV=22%), .028(CV=17%), and .011 (CV=10%), indicating a furthersubstantial decrease in unexplained variation. The plotscorresponding to 11.7/11.11 and 11.9/11.12 are shown asfigures 11.13 and 11.14.PRED VS. DV9.00E+00 1.78E+01 2.66E+01 PRED 3.54E+01 4.42E+01 5.30E+01. . . . . .. . . . . . . . . . .5.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * .. ... .. * . .. . .. . * * *2* .. * *. * * * * * .. *. .. .2 *2* * * .1.80E+01. * *22 * * ... * **5 * .. *22* . * * * * * .. * *4** *. * * * .. 2* * *. * * * .. * * ** * . * 2 * * .. * *2 ** * . 2 * * .. * ** . * * .. * ** 2 * . * * .. * * * * *. * * .3.10E+01. * * *2 . * * * * ... ** . * .. ** 2 * ** * . .. * 2 . .. * * * . .DV . * * * 2 . * * * .. * * . .. * * . .. * . * .. . .4.40E+01. . ... . .. . .. . .. . .. . .. ... .. .. .5.70E+01. ... * .. .. .. .. .. .. .. *.. .7.00E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.13. Predictions from fit of model (11.3) tophenobarbital data vs observations.Now there are no obvious discrepancies, and the plot ofweighted residuals vs WT shows no pattern, so that it islikely that no further use of weight in the model isrequired. WRES VS. WT-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .5.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . .. * . .. * * * * ** . * *** * .. . .. ** * . .. * * * * . * * * * * * .. . .. * ** 2 * ** ** * .. * * 2* 2* 2 * * * *** ** * * .1.14E+00. . ... * * * * .2* 2 * 2 * ** .. * * * * * *** * * * * .. . .. * * **** *** . 2 ***2 * * * .. . .. * * * ** *. * * * * * .. . .. . .. * * 2* * * * * .1.78E+00. * * .* *** * * * ... . .. * * . * * * .. . .. . .WT . * . * .. . .. . .. . .. . .2.42E+00. . ... . * * .. . .. . * .. . .. . .. * * . .. . .. . .. . .3.06E+00. . ... * . * * .. * * * * .. . .. . .. . .. . .. . * * .. * * * . .. . .3.70E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.14. Plot of weighted residuals vs weight for fitof model (11.3) to phenobarbital data.4.6.2. The Effect of APGRThe structural model building stage is not over until allavailable independent variables have been examined forinfluence, and there is one additional variable, the Apgarscore, that has not yet been seriously considered. A plotof the weighted residuals from the fit to model (11.3) vsAPGR is shown in figure 11.15.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * * * * ** * * * * .. . .. . .. . .. . .. * * ** * * .. . .. . .. . .2.68E+00. . ... . .. * 2 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * 2 ** . * 2 * 2 ** 2 * .. . .. . .APGR . . .. . .. . .. * * * 2* **2* 2 2 2 *** ** * .. . .6.44E+00. . ... . .. . .. * 2* * * **** *** ***2*22 ** * ** * * * .. . .. . .. . .. . .. * * * * * ** * * *2 * 2*** 2*223 * * * * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* *** * * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.15. Plot of weighted residuals vs Apgar score forfit of model (11.3) to phenobarbital data.There is a weak suggestion from figure 11.15 that for APGRless than 3, the weighted residuals tend to be negative.Accordingly, a new model (11.4) can be proposed, which isidentical to (11.3) except that&theta;2+&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2(11.4b))(&theta;2+&theta;4WT)&theta;5,ifAPGR&le;2The relevant statements for NM-TRAN now become:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))When this model is fit to the data, &theta;5 is estimated to be1.18, implying that indeed, the volumes of distribution forinfants with Apgar scores less than 3 are typically 18%higher than those of infants (of the same weight) withhigher Apgar scores. The measures of improvement are nowmarginal, however: the objective function decreases only3.7, and the decreases in the variances are all less than10% of their previous values, with the variance of &epsilon;actually increasing a few percent. Inspection of figure11.6 suggests a reason for this: note that only 5 distinctindividuals (separate symbols) have Apgar scores less than3. There is simply not very much information about babieswith low Apgar scores in this data set.For completeness, figure 11.16 corresponds to figure 11.5,but using model (11.4), and now shows no distinct pattern.WRES VS. APGR-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .8.00E-01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * 2 * 2 . * * * * .. . .. . .. . .. . .. * * * * . * * .. . .. . .. . .2.68E+00. . ... . .. 3 . * * .. . .. . .. . .. . .. * * . * * .. . .. . .4.56E+00. . ... . .. * * * * * ** * * . 3 * 2 ** * * *.. . .. . .APGR . . .. . .. . .. * * * * 2**2* 22 *2 ** 2 * .. . .6.44E+00. . ... . .. . .. * *2 * * * 2* * * 2 3.*23 2 * * * * * * .. . .. . .. . .. . .. * * * * * ** * **2. ***2* 2*2*3* * ** * * .. . .8.32E+00. . ... . .. . .. . .. * * ** * * * * ** * .* * *** * * * * .. . .. . .. . .. . .. * * . * .1.02E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.16. Plot of weighted residuals vs Apgar score forfit of model (11.4) to phenobarbital data.The stage of building the structural model is now complete.5. Building the Statistical Model5.1. Judging Among AlternativesNONMEM can provide estimates of the &eta; variables for eachindividual (see Chapter 12, Sections 4.11-4.13). Plots ofthe estimated interindividual differences, which can beregarded as interindividual residuals, can be obtained.Plots of these residuals (associated with a particular PKparameter) versus the values of an independent variableprovide further help in building the structural part of theparameter model. Moreover, a plot of these residuals versusthe typical values of the parameter (whose values depend oncovariates) also provides help in building the model forinterindividual differences themselves. For example, ifinterindividual differences are modeled with the additivemodel, but the plot shows a linear trend (in the boundariesenveloping the residuals), this suggests that a proportionalmodel be tried.Lastly, help can be provided in the selection of a model forintraindividual error. Predictions of concentrations, andhence residuals, based on estimates of individuals&rsquo; &eta;s, canbe computed, and the residuals can be plotted versus thepredictions. (This requires advanced techniques.) Again,if intraindividual errors are modeled with the additivemodel, but the plot shows a linear trend in the envelope,this suggests that a proportional model be tried.The statistical model is usually of less interest than thestructural model, so that frequently all that is sought isan adequate model, not necessarily the correct one, nor doesone care whether the estimates of the random effectsparameters (the elements of &Omega; and &Sigma;) are particularlyprecise. Sometimes, however, the variability in the randomeffects is of genuine primary interest. In such cases moreattention must be paid to building the random effects model.This, however, may not be easy because it is an unfortunate,but unavoidable fact, that a great deal more data is neededto estimate random effects parameters with a given precisionthan is needed to estimate fixed effect parameters withcomparable precision.The tools used to elaborate the statistical model aresimilar to those used for elaborating the structural model:alternative models are assessed using (available) residualplots, especially ones like those just discussed, andrelative changes in the objective function.5.1.1. Unexplained VariabilityWhen the statistical model is developed, a new &eta; variablemay be added, or an old &eta; variable used differently. Thendifferences in the &omega;s between models cannot really be usedto judge the benefit of the addition, and this evaluationtool becomes less useful. On the other hand, an addition ofan &eta; might be confirmed by a reduction in the estimates ofthe variances in &Sigma;, the variances of the random componentsin the model for residual error. However, there is one suresign that too many &eta;&rsquo;s are in the model: NONMEM mayestimate one or more of the &omega;s to be zero, or very nearlyzero. This can be disconcerting, particularly if the &eta;variable is the only such variable affecting Volume, forinstance, as then this estimate seems to suggest that withrespect to Volume, there is no interindividual variabilityin the population whatsoever! The result should not beinterpreted this way, however. Rather, assuming the &eta;affecting Volume is the one most recently added, itindicates that given the previous statistical model, noadditional variability needs to be ascribed to volume toexplain all the variability seen. The data cannot supportsuch an elaborate statistical model, and a simpler model,such as the previous one, must be used.5.1.2. Residual PlotsThe most important residual plot is now a plot of theweighted residuals against predictions, where a pattern inthe shape of the outer envelope of points can indicatedeficiencies in the statistical model (recall that adistinct pattern in the local &quot;average&quot; residual vs thepredictions would indicate a defect in the structuralmodel). This can be illustrated using the phenobarbitaldata. Figure 11.17 shows the plot of weighted residuals vspredictions for model (11.4), and figure 11.18 shows thesame plot for a modified model, (11.5), identical to (11.4)except fory=F+&epsilon;1 (11.5c)Only the $ERROR statements of the control stream change:$ERRORY=F+ERR(1)WRES VS. PRED-3.00E+00 -1.88E+00 -7.60E-01 WRES 3.60E-01 1.48E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. 2 . .. * . * .. * . * .. * * . * .1.82E+01. * ** . * * ... * * . 2 * * .. * * * 2 2* *2 2 *3. 2*2 *** *** ** * * .. * * * * * .. . * * .. * *. * .. * . * * 2 * .. * * * * . * * * * * * .. * . * * .. * * ** * * * *.2.74E+01. * . * * ... * * * *.* * * * .. * * . * * .. * * * 2 . * * * .. * * * * * . * * * .PRED . * * . ** * ** * .. .** * .. * . .. . * 2 .. . .3.66E+01. * . * ... * * . ** * .. * . .. * . .. * * . * .. . .. . .. . .. * . .. . .4.58E+01. * . ... . .. . .. . .. . .. . .. . .. . .. .* * .. . .5.50E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.17. Plot of weighted residuals vs predictions forfit of model (11.4) to phenobarbital data (proportionalintraindividual error).Although the plots do not differ greatly, there is a smallsuggestion in figure 11.18 that the envelope of weightedresiduals is somewhat V-shaped with the apex of the V atPRED=0 (but which does not show on the plot), while infigure 11.17 the weighted residuals seem more homogeneous,and their magnitude seems less dependent on that of thepredictions. That this impression is valid is suggestedalso by the increase in objective function of 7.6 in goingfrom model (11.4) to (11.5).WRES VS. PRED-3.20E+00 -2.04E+00 -8.80E-01 WRES 2.80E-01 1.44E+00 2.60E+00. . . . . .. . . . . . . . . . .9.00E+00. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. * . .. . * .. . .. * . .. . * .. **. .. * . * .. * .* * * .. * * . .1.80E+01. * * . * ... * * . * * * * .. * * ** * * * 2 **2* 3* *** * * ** .. ** 2 * ** 2* * * * .. .* * .. * .* .. * . 2 * * * .. * * * *. 2 * * .. * . * * ** * .. * .2 * * * .2.70E+01. * * . * ... * * .* * * * * .. * 2 * * * * ..* * * . * * .. * * * * * * . * * * * .PRED . * * . * * ** * .. * . * 2 .. * . * .. . * .. . * * * .3.60E+01. * * . * ... * . * .. * . * .. * * . * .. * . .. . .. . .. . .. . .. * . .4.50E+01. . ... . .. * . .. . .. . .. . .. . .. . .. * . .. . * .5.40E+01. . . . . . . . . . . . . . . . . . . . . . . . . . . ... . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . .Figure 11.18. Plot of weighted residuals vs predictions forfit of model (11.5) to phenobarbital data (additiveintraindividual error).6. Refine ModelThe goal of this stage is to check whether the model is asparsimonious as reasonable, since if it is not, certainimportant parameters may not be estimated with as goodprecision as can be achieved. Although up to this stage,one tries to avoid adding parts to the model which are notwell supported by the data, it is nonetheless possible thata part added at one stage may seem unnecessary after addinganother part at a later stage. Perhaps, for example, weightaffects V, and V and CL are correlated in the population(independent of weight), but first the influence of weighton CL is examined, and later its influence on V is examined(this was the order illustrated above). Then initially,weight might appear to influence CL, although this influencemight only derive from the correlation between the two PKparameters. Later, after the influence of weight on V is apart of the model, the influence of weight on CL mightdisappear. One wants to check this possibility and, ifindicated, eliminate the influence of weight on CL from themodel at the stage now being described. The basic techniqueat this stage, is to run the Covariance Step with the bestmodel thus far, and look for parameters with confidenceintervals that include the parameter&rsquo;s null value, i.e., thevalue that causes the parameter to be effectively deletedfrom the model. A null value is usually zero (for aparameter quantifying an additive portion of the model), andsometimes unity (for a parameter quantifying amultiplicative part of the model). If such parameters arefound, then one at a time, each can be set to its null valueand the consequences examined as discussed above for theearlier model building stages.Figures 11.19 and 11.20 show two pages of NONMEM output froma run fitting model (11.4) to the phenobarbital data, andimplementing the Covariance Step. Figure 11.19 shows thefinal parameter estimates, and 11.20, their standard errors.******************************************************************************************************************************************** **************************************** FINAL PARAMETER ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 57.50E-05 2.66E-02 4.62E-03 9.53E-01 1.18E+00OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 4.59E-02ETA2 0.00E+00 2.63E-02SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 1.10E-02Figure 11.19. Parameter estimates from fit of model (11.4)to phenobarbital data.******************************************************************************************************************************************** **************************************** STANDARD ERROR OF ESTIMATE **************************************** ********************************************************************************************************************************************THETA - VECTOR OF FIXED EFFECTS *********************TH 1 TH 2 TH 3 TH 4 TH 59.59E-04 9.24E-02 7.33E-04 7.48E-02 8.36E-02OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS ********ETA1 ETA2ETA1 2.25E-02ETA2 ......... 7.08E-03SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS ****EPS1EPS1 2.01E-03Figure 11.20. Standard errors of parameter estimates fromfit of model (11.4) to phenobarbital data.6.1. Use of Standard Errors and Confidence IntervalsThe null values of &theta;1 through &theta;4 are zero, while the nullvalue of &theta;5 is unity. Using the numbers from the figures,it is easily seen that for &theta;1 and &theta;2, the parameterestimate minus the null value is a fraction of one standarderror, and hence &theta;1 and &theta;2 may not be different from theirnull values.As indicated in Chapter 5 (Section 4.2.2), an approximate(two-sided) 95% confidence interval for a parameter estimateis&theta;&plusmn;Z.975SEwhere Z.975 is the 97.5 percentile of the normaldistribution (&asymp;2) and SE is the standard error of theparameter estimate. Therefore, for &theta;5, a 95%confidence interval is given by 1.18&plusmn;(2)(.0836), whichis 1.01 - 1.35. This range only barely missesincluding the null value, unity,indicating, as did the marginal change in theobjective function associated with going from (11.3) to (11.4),that one cannot be very sure of the influence of Apgar score onvolume.Finally, note the magnitudes of the standard errors of theother parameters&rsquo; estimates. For &theta;3 it is 16% of theestimate (i.e., the CV of the estimation error is 16%), for&theta;4 it is 7.8%, while for the 2 elements of &Omega; it is 49% and27%. This pattern is typical: the precision of the fixedeffect parameter estimates is considerably greater than thatof the random effects parameter estimates, except when thenumber of individuals sampled is enormous.6.2. A Model RefinementBased on the observation that &theta;1 and &theta;2 may be equal totheir null values, these parameters are next set to theirnull values, defining a new (and final) model,Cl=&theta;3WT(1+&eta;1) (11.6a)&theta;4WT, ifAPGR&gt;2V=&#9129; &#9133;(1+&eta;2) (11.6b)(&theta;4WT)&theta;5,ifAPGR&le;2y=F(1+&epsilon;1) (11.6c)which is communicated to NM-TRAN without changing the$PK or $ERRORstatements, but simply by fixing the values of &theta;1 and &theta;2to 0, using the FIXED option in the $THETA record:$PK TVCL=THETA(1)+THETA(3)*WTCL=TVCL*(1+ETA(1))TVVD=THETA(2)+THETA(4)*WTIF (APGR.LE.2) TVVD=TVVD*THETA(5)V=TVVD*(1+ETA(2))K=CL/VS1=V$ERRORY=F*(1+ERR(1))$THETAS (0 FIXED) (0 FIXED) (0,.0018) (0,.43) 1.0When this model is fit to the data, the objective functionincreases only .12 (a trivial change). However, now theCV&rsquo;s of the estimation errors in &theta;3 and &theta;4 are 4.4% and 2.5%respectively.This is the main point of this section on model refinement;deletion of imprecisely estimated parameters can improve theprecision of other parameter estimates. This is related tothe correlation between parameter estimation errors,mentioned in Chapter 5. With little data from patients whoweigh virtually nothing, &theta;1 and &theta;2, the values of CL and Vfor such patients, are not well estimated (regardless of thefact that one might rationally model the values of theseparameters to be 0), and so their parameter estimates arelargely dependent on the estimates of the slope parameters&theta;3, &theta;4, and &theta;5. The correlation between the estimates of &theta;1and &theta;3 is -.96, and that between &theta;2 and &theta;4 is -.95. Ofcourse, since slope itself can only be well determined whenthe intercept is well determined, the parameter estimates of&theta;3, &theta;4, and &theta;5 themselves largely depend on the estimates of&theta;1 and &theta;2; correlations are symmetric. In other words,neither type of parameter (intercept or slope) is veryprecisely estimated since the estimate of each depends onthe value assigned to the other. But if one of theparameters can be eliminated from the model (i.e.,rationally assigned a fixed value), then the other can bemore precisely determined.7. Testing the ModelThis step is undertaken when it is desirable to assignp-values to the hypothesis test of one or more parametervalues against null values. The procedure is as follows:Beginning with the final model resulting from all previoussteps, each parameter to be tested is set, in turn, to itsnull value, and the reduced model is fit to the data (onlythe Estimation Step need be run; no tables, graphs orcovariance output are necessary). A likelihood ratio testis done using the difference in minimum objective functionvalues obtained with both the full (original) and reducedmodels. In doing this one must be careful that in theEstimation Step with a reduced model, no parameter otherthan the one under test (and those which are alreadyconstrained to fixed values under the full model) beconstrained to a fixed value."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 12 -
Brief Descriptions of Other Features</b></p>

<h2>1. What This Chapter is AboutThis chapter briefly describes a variety of features ofPREDPP and NONMEM that are somewhat advanced for this textbut are of interest to most users of NONMEM. References aregiven to other documents where additional information can befound. Section 2 is concerned with PREDPP, Section 3 isconcerned with user-written PREDs, and Section 4 describesgeneral NONMEM features. Section 5 contains an example thatincludes several of the advanced features. Note that &#9474;wherever $PK, $ERROR, $DES, $AES, $MODEL, $MIX and $PREDstatements are referred to below, user-written subroutines &#9474;PK, ERROR, DES, AES, MODEL, MIX and PRED can be usedinstead.2. Advanced Features of PREDPP2.1. Pharmacodynamic Modeling Using the $ERROR Record$ERROR statements may modify the value of F, the scaled drugconcentration. They may also introduce new &theta; and &eta;variables. This allows pharmacodynamic modeling to beperformed using PREDPP. Such models occur when a studyinvolves measurement of a drug effect, such as bloodpressure. A proposed model might relate the predictedeffect to a pharmacokinetic quantity such as plasma level.PREDPP can be used to model Cp as is usual, and thepredicted effect can be computed in the $ERROR statements.For example, suppose that a modified version of thephenobarbital data of Chapter 2 includes observations ofsome drug effect (in this case, perhaps a measure of thedegree of sedation) but none of the concentrationobservations. The dose event records are the same as thoseof the earlier example. Suppose that the drugconcentrations from each individual have been used toestimate that individual&rsquo;s K and V parameters, and thatthese estimates are now included on every event record forthe individual. Finally, suppose that the proposedstructural model for the effect, E, is an &quot;E-max&quot; model:E=EmaxC50Cp+Cpwhere here Cp is understood to mean the prediction of an individual&rsquo;sdrug concentration in the plasma, andEmax and C50 are PD (pharmacodynamic parameters) modeled asEmax=&theta;1+&eta;1C50=&theta;2+&eta;2To fit this data we can use the control statements of figure12.1. To obtain initial parameter estimates, let us assumethat the following is observable in the data. The averagevalue of all effect measurements is about 50. Acrossindividuals, the average value of the largest effectmeasurement within each individual&rsquo;s data is about 100, andthe average value of the individual&rsquo;s observed concentrationat about half this largest measurement is about 20. (Thisis seen when concentration measurements and effectmeasurements are examined together.) Let us also assume 20%random interindividual variability in Emax and C50 and 4%intraindividual variability in the observation. From thiswe obtain initial estimates of 100 and 20 for &theta;1 and &theta;2,(100&times;.2)2 for &Omega;11, (20&times;.2)2 for &Omega;22, and (50&times;.04)2 for &Sigma;.This example is examined again in in Section 3.2, whichshows the use of $PRED statements, and in Section 5, whichshows how observed concentrations and effects can be fitsimultaneously.References: Users Guide VI (PREDPP) IV.B.2$PROBLEM PHARMACODYNAMIC MODEL USING $ERROR STATEMENTS$INPUT ID TIME AMT INDK INDV DV$DATA EFFDATA$SUBROUTINE ADVAN1$PKK=INDKV=INDVS1=V$ERROREMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*F/(C50+F)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.1. The input to NONMEM-PREDPP for analysis ofeffect observations.2.2. Other Pharmacokinetic Models: ADVAN5 through ADVAN9 &#9474;and ADVAN13Appendix 1 lists ADVAN routines for the most commonly-usedpharmacokinetic models. Other ADVAN routines are:ADVAN5 (General Linear)ADVAN6 (General Nonlinear)ADVAN7 (General Linear with Real Eigenvalues)ADVAN8 (General Nonlinear Kinetics with Stiff Equations)ADVAN9 (General Nonlinear Kinetics with EquilibriumCompartments) &#9474;ADVAN13 (General Nonlinear Kinetics using LSODA)With the general methods the user defines a model of up to &#9474;99 compartments using special options of the $MODEL record.For a linear model (ADVAN5 and ADVAN7), it is sufficient tospecify (directed) compartmental connections and to computetheir rate constant parameters with $PK statements. ADVAN 5and 7 make use of numerical approximations to the matrixexponential. For a nonlinear model (ADVAN6, ADVAN8, ADVAN9, &#9474;and ADVAN13), differential equations must be supplied togovern the kinetics, via $DES statements. It is possible to &#9474;specify initial conditions for the differential equations &#9474;using the I_SS (Initial Steady State) feature. For ADVAN9,algebraic equations may also be supplied via $AESstatements. The use of the term &rsquo;nonlinear&rsquo; with ADVAN 6,8, 9, and 13 only indicates that a system of any type offirst-order differential equations is allowed; suchequations could be linear or non-linear.In all cases, the basic features of PREDPP described inChapter 7 are still available, such as the ability tointroduce doses of any kind to any compartment of the model.It should be noted that the general ADVAN routines arerelatively slow. For example, when a general method is usedfor a model identical to that of an analytic method (ADVAN1 &#9474;through ADVAN4 or ADVAN10 through ADVAN12) the run timeincreases, usually by an order of magnitude.Some ADVAN and SS routines must be told the number ofaccurate digits that are required in the computation of drugamounts, i.e., the relative tolerance. This is specifiedeither by the TOL option of the $SUBROUTINES record or bythe $TOL record.References: Users Guide VI (PREDPP) VI, VIIReferences: Users Guide IV (NM-TRAN) V.C.3, 4, 7-102.3. Zero-Order Bolus DosesInstantaneous bolus doses, which have AMT&gt;0 and RATE=0, aredescribed in Chapter 6. Such doses appear instantaneouslyin the dose compartment. Zero-order bolus doses are dosesthat enter the dose compartment via a zero-order process (inthe same manner as do infusions) except that the rate orduration of the process is computed with $PK statements.When the RATE data item has the value -1, then the $PKstatements must include an assignment statement for anadditional PK parameter, Rn (the &quot;modeled rate forcompartment n&quot;), whose value gives the rate of entry of thedrug during the interval of time between the last eventrecord and the current one. There is a different suchparameter for every compartment receiving a zero-order bolusdose. When the RATE data item has the value -2, then the$PK statements must include an assignment statement for anadditional PK parameter, Dn (the &quot;modeled duration forcompartment n&quot;), whose value at the time of the dose eventgives the duration time of the dose. The rate and durationparameters can be modeled like any other PK parameters; inparticular, the assignment statements can involve &theta;&rsquo;s whichare to be estimated. These parameters can be used to modelthe drug release rate or dissolution time of a tablet orcapsule.Steady-state levels involving zero-order bolus doses can becomputed.Steady-state with constant infusion was described in Chapter6. Steady-state infusions may also have modeled rates(i.e., the RATE data item may be -1).References: Users Guide VI (PREDPP) III.F.3, F.42.4. The Additional Dose Data Item: ADDLADDL is a dose-related data item that is used to requestthat a given number of additional doses, just like the dosespecified on the event record, be added to the system at aregular time interval, starting from the time on the eventrecord. PREDPP itself adds these doses at the appropriatefuture times; no actual dose event record is generated bythe Data Preprocessor or by PREDPP. A positive integervalue in ADDL specifies how many additional doses (i.e., inaddition to that already specified in the event record) areto be given, and the value in the II (interdose interval)data item (which is required) specifies the time intervalbetween doses.ADDL may be non-zero on a steady-state dose event record(except for steady-state infusions), in which caseadditional doses are given, maintaining the dosing regimeninto the future. Non-steady-state kinetic formulas are usedto advance the system between each additional dose. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) V.K2.5. Lagged doses: the ALAG ParameterPREDPP permits an additional PK parameter called anabsorption lag time. One such parameter can be defined foreach compartment and applies to all doses to thatcompartment. It gives the amount of time that a dose isheld as a &quot;pending&quot; dose. When the absorption lag time hasexpired, the dose is input into the system. In effect, thevalue of the absorption lag time parameter is added to thevalue of the TIME data item on the dose event record. WithNM-TRAN, recognized names for absorption lag time parametershave the form ALAGn, where n is the compartment number. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) III.F.6References: Users Guide IV (NM-TRAN) V.C.5 &#9474;2.6. Model Event Times: MTIME &#9474;Model event times MTIME(i) are additional PK parameters &#9474;defined in the PK routine or $PK block. A model event time &#9474;is not associated with any compartment, but, like an &#9474;absorption lag time, defines a time to which the system is &#9474;advanced. When the time is reached, indicator variables are &#9474;set and a call to PK is made. At this call (and/or &#9474;subsequent to this call) PK or DES or AES or ERROR can use &#9474;the indicator variables to change some aspect of the &#9474;system, e.g., a term in a differential equation, or the rate &#9474;of an infusion.2.7. Controlling Calls to PK and ERRORIn order to evaluate the $PK and $ERROR statements, PREDPPcalls the PK and ERROR subroutines. By default, thesubroutines are called with every event record. PREDPP maybe instructed to limit calls to certain event records inorder to save the computing time involved with unnecessarycalls (e.g. when the PK parameters do not vary from eventrecord to event record within an individual). It is alsopossible to cause the PK subroutine to be called at timeswhich do not correspond to any actual event record.Using NM-TRAN, calls to PK are controlled by the presence ofone of the following pseudo-statements, at the start of the$PK block:CALLFL=-2:call with every event record, at additional and lagged &#9474;dose times, and at modeled event times.CALLFL=-1:call with every event record (default).CALLFL=0:call with the first event record of each individualrecord and with new values of TIME.CALLFL=1:call once per individual record.A callin_______ protoco________ phras______ may be used instead of a &#9474;pseudo-statement. A calling protocol phrase may use upper- &#9474;or lower-case characters. It must be enclosed in &#9474;parentheses. NM-TRAN can understand minor variations in the &#9474;wording. E.g., the word &quot;CALL&quot; and prepositions such as &#9474;WITH can be omitted. Here are calling protocol phrases &#9474;equivalent to the above four pseudo-statements, &#9474;respectively. &#9474;(CALL WITH NON-EVENT TIMES) &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH FIRST EVENT RECORD AND NEW TIME) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;The choice CALLFL=-2 (CALL WITH NON-EVENT TIMES) is intended &#9474;to be used when PK parameters Dn and/or Fn apply toadditional or lagged doses and the model for theseparameters depends on some time-varying concomitant variablesuch as type of drug preparation or patient weight. Bydefault, the values of the PK parameters which apply to thedose are those values computed by PK with the first eventrecord having a value of TIME greater than the time at whichthe dose actually enters the system (the additional orlagged dose time). However, if PREDPP is instructed to alsocall PK at the additional or lagged dose time, then thevalues of the PK parameters are those values computed atthese special calls. At such calls, PK has available to itinformation from the initiating dose event record itself,and information from the two event records whose TIME valuesbracket the additional or lagged dose time. Along withCALLFL=-2 in the $PK block, the NM-TRAN $BIND record may beuseful; see Users Guide IV.Using NM-TRAN, calls to ERROR are controlled by the presenceof one of the following pseudo-statements at the start ofthe $ERROR block:CALLFL=-1: call with every event record (default).CALLFL=0: call with observation events only.CALLFL=1: call once per individual record.A calling protocol phrase may be used instead of a &#9474;pseudo-statement. As in the $PK block, the calling protocol &#9474;phrase may use upper- or lower-case characters and must be &#9474;enclosed in parentheses. &#9474;Here are calling protocol phrases equivalent to the above &#9474;three pseudo-statements, respectively. &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH OBSERVATION EVENTS) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;NM-TRAN automatically instructs PREDPP to limit calls toERROR to once per problem for the simple error modelsdiscussed in Chapter 8, Sections 3.1 and 3.2:Y=F+ERR(1)Y=F+F*ERR(1)Y=F*(1+ERR(1))Y=F*EXP(ERR(1))During the Simulation Step, PREDPP ignores any limitationand calls the ERROR subroutine with every event record.Even when calls to PK and/or ERROR are limited, the CALLinput data item can be used to force additional calls forspecific event records as needed.References: Users Guide VI (PREDPP) III.B.2, III.H, IV.C,V.JReferences: Users Guide IV (NM-TRAN) V.C.5, C.62.8. Transgeneration of Input Data: the INFN SubroutineNONMEM may be used to modify the data records before anycomputations are performed and also after all computationshave been performed. This is referred to as transgeneratio_______________of the data. Transgeneration at the beginning of a problemcan be used, for example, to change weight-normalized dosesto unnormalized doses. PREDPP allows the user to supply asubroutine called INFN (&quot;initialization/finalization&quot;) inwhich transgeneration can be performed. (The PREDPP libraryincludes a default INFN subroutine which does nothing.)References: Users Guide VI (PREDPP) VI.A3. User-written PRED SubroutinesIt is not necessary to use PREDPP with NONMEM. Either $PREDstatements or a user-written PRED subroutine may be used inplace of PREDPP to supply NONMEM with predicted values forthe DV data item according to some (not necessarilypharmacokinetic) model. An example using $PRED statementsis given here. A special caveat applies to user-writtenPRED subroutines that are recursive: see 4.6 below.References: Users Guide I (Basic) C.23.1. Required Data ItemsThe only required data items when PREDPP is not used are theNONMEM data items DV, MDV, and ID. When PREDPP is used, theData Preprocessor is able to recognize which records containobserved values and which do not, and it supplies the MDVdata item if it is not already present in the data file.When PREDPP is not used, the Data Preprocessor cannot dothis. The input data file must already contain the MDV dataitem if it is needed, i.e., if the DV item of some datarecord does not contain a value of an actual observation.If $PRED statements are used, they must calculate a variablecalled Y, using input data items and NONMEM&rsquo;s &theta;, &eta;, and (forpopulation models) &epsilon; vectors in the calculation.References: Users Guide I (Basic) B.1References: Users Guide IV (NM-TRAN) III.B.83.2. An Example of $PRED Statements: PharmacodynamicModelingThe syntax of $PRED statements is essentially the same asdiscussed for $PK and $ERROR statements. $PRED statementscan be used for simple pharmacokinetic and pharmacodynamicmodels. In figure 12.1 above an example was given ofpharmacodynamic modeling using $ERROR statements. Supposethat in that example, drug concentration is always measuredat the same time as drug effect. Suppose too, that ratherthan input the individuals&rsquo; values of K and V and use themto compute a predicted drug concentration for theindividual, the observed drug concentration itself is usedin the Emax model. This means that the the observedconcentrations are again incorporated into the data, but nowas values of an independent variable, rather than as the DVdata item. This also means that a pharmacokinetic model isnot needed, and therefore, PREDPP is not needed either.Figure 12.2 shows the control stream for this new example.$PROBLEM A SIMPLE PHARMACODYNAMIC MODEL$INPUT ID TIME CP DV$DATA EFFDATA$PREDEMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*CP/(C50+CP)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.2. The input to NONMEM including $PRED statementsfor analysis of effect data.4. Advanced Features of NONMEM4.1. Full Covariance Matrices: $OMEGA BLOCK and $SIGMABLOCKIn the examples of Chapter 2 and 9, there appearedstatements such as:$OMEGA .0000055, .04This is an example of the specification of initial parameterestimates for a variance-covariance &Omega; matrix which isconstrained to be diagonal. Initial estimates are given forthe variances of &eta;1 and of &eta;2. The covariance between &eta;1and &eta;2 is constrained to be 0, i.e., &omega;12=cov(&eta;1,&eta;2)=0.Another way of writing this statement is:$OMEGA DIAGONAL(2) .0000055, .04The option DIAGONAL(2) states explicitly that the blockcontains two &eta;s and that it has diagonal form.If the data supports the possibility that &eta;1 and &eta;2 covarywith each other, it may be useful to model &Omega; as beingunconstrained and allow NONMEM to estimate the covariance.A special form of the $OMEGA record is used, in whichinitial values are supplied for both variances and thecovariance. For example:$OMEGA BLOCK(2) .0000055, .0000001, .04The option BLOCK(2) states that there are two &eta; variables inthe block, and that covariance is to be estimated. The newelement is &omega;12=&omega;21=cov(&eta;1,&eta;2)=cov(&eta;2,&eta;1)=1&times;10&minus;7.$OMEGA BLOCK is used for both population and individualstudies, i.e., it is the same whether &eta; is used in the firstcase in a model for residual error or is used in the secondcase in a model for random interindividual error. In apopulation study, if there is more than one &epsilon; variable, andthe model allows these variables to covary, then $SIGMABLOCK is used in a similar manner.The initial estimates of even more complicated &Omega; and &Sigma;matrices may be given using multiple $OMEGA and $SIGMArecords. For example, the initial estimates of a mixture ofcorrelated and uncorrelated random variables may given.Also, in this context (as with the simple form of the $OMEGAand $SIGMA records described in Chapter 9, Section 3)variances-covariances may be constrained to fixed values bymeans of the FIXED option. Finally, somevariances-covariances may be constrained to equal others bymeans of the BLOCK SAME option. The ability to fix allvariances-covariances in both &Omega; and &Sigma; allows Bayesianestimates to be obtained of the pharmacokinetic parametersof a single individual, based on the individual&rsquo;s data and aprior population distribution for the parameters.References: Users Guide IV (NM-TRAN) III.B.104.2. Grouping Related Observations: The L1 and L2 DataItemsThe $ERROR statements for a problem may sometimes involvemore than one random variable. For example, there may betwo types of observations. One type may be an observationfrom one compartment of a PK system, or with one assay orpreparation, and another type may be an observation from adifferent compartment or with a different assay orpreparation. The model for the two types of observationswould typically involve at least two &epsilon; variables (e.g.(3.8)). If all observations are made at sufficientlyseparated times, there may be little reason to be concernedabout correlation between the two random errors. However,if the two types of observations are taken at the same orvery close to the same time, it is possible that correlationwill exist; whatever circumstance has influenced oneobservation to be different from the predicted level mayalso have some influence on the other observation. In thiscase a covariance between the two &epsilon; variables should beallowed, as described above in Section 4.1. Then the twotypes of observations at the same time point are regarded astwo elements of a multivariat____________ observation____________In the case of population data, there exists a NONMEM dataitem, L2, which is used to identify the elements of amultivariate observation. In effect, L2 acts in a similarway as ID, but grouping observations within individualrecords.In the case of individual data, the ID data item alreadyserves this purpose: it forms groups of observations whose&eta; variables may be correlated. Thus, in the input datafile, the ID data item should be the same for thoseobservations which may have correlated &eta;s. However, forindividual data, the Data Preprocessor normally replaces theID data item with a new set of values which describe everyobservation as being independent of the others. To preventthe Data Preprocessor from doing this, L1 should be includedin the $INPUT record as the name or synonym for theuser-supplied ID data item.References: Users Guide IV (NM-TRAN) II.C.4, III.B.2References: Users Guide II (Supplemental) D.34.3. Continuing a NONMEM Run: MSFO and MSFI &#9474;The MSFO (Model Specification Output File) option of the$ESTIMATION record instructs NONMEM to write a Mode_____Specificatio_____________ Fil____ (MSF)______ It is created when NONMEM writes &#9474;the first iteration summary to the intermediate output file, &#9474;and is re-written when every subsequent iteration summary is &#9474;written. This file can then be read in a subsequent NONMEMrun using a $MSFI (Model Specification File Input) record.This file has much of the information about the model usedin the previous run, thus the name &quot;Model SpecificationFile&quot;. It also contains all the information that allows theEstimation Step from the previous run (which may haveterminated, for example, due to the number of functionevaluations exceeding its limit or a computer crash or some &#9474;other externally-caused interruption of the NONMEM run) tobe continued in the subsequent run. There are a number ofbenefits to using a MSF. First, what might be a longEstimation Step (due to a very lengthy search) can be splitover a series of runs, each with a limited number offunction evaluations. Any run which terminates prematurelydue to computer failure can be restarted from the MSF outputin the previous run. (This provides a &quot;checkpoint/restart&quot;capability.) The progress made in the Estimation Step canalso be evaluated between runs, and a decision made as towhether it is worth continuing a search which is consumingexcessive amounts of computer time. Second, the Covariance,Tables, and Scatterplot Steps can be performed in laterruns, each using the MSF from the final run with theEstimation Step. It is advisable to perform the CovarianceStep only after satisfactory results have been obtained fromthe Estimation Step.References: Users Guide I (Basic) C.4.4References: Users Guide IV (NM-TRAN) III.B.6, B.124.4. NONMEM Can Obtain Initial Estimates for &theta;, &Omega;, &Sigma;NONMEM can be directed to obtain initial estimates for oneor more elements of &theta;, &Omega;, or &Sigma;. This is done in a separateInitial Estimates Step. For an element of &theta;, omit theinitial estimate but include lower and upper bounds, e.g.,(1, ,50) in the $THETA record. (The NUMBERPOINTS option maybe used to control the number of points in &theta; space examinedby NONMEM during the search for initial estimates of &theta;.)For a block of &Omega; or &Sigma;, omit all initial estimates on the$OMEGA BLOCK (or DIAGONAL) record, or $SIGMA BLOCK (orDIAGONAL) record, respectively.Note that when $PK and $ERROR statements are present but the$OMEGA and/or $SIGMA records are absent, NONMEM will bedirected to obtain initial estimates for the variances ofthe random variables in question, assuming the diagonal formof the matrix.References: Users Guide IV (NM-TRAN) III.B.9-114.5. Improving Parameter Estimates: REPEAT and RESCALEThe Estimation Step can be immediately repeated after thesearch has terminated successfully, by including the REPEAToption on the $ESTIMATION record. This can improve theaccuracy of the parameter estimates when one or more initialestimates are wrong by a few orders of magnitude. The finalestimates from the first implementation of the EstimationStep are used as the initial estimates of the secondimplementation, and thus the scaling used with the STP isdifferent from that with the first implementation, allowingfewer leading zeros after the decimal point in the STP.When the Estimation Step is continued by means of a ModelSpecification File, similar rescaling can be requested usingthe RESCALE option of the $MSFI record.References: Users Guide IV (NM-TRAN) III.B.12, B.14References: Users Guide II (Supplemental) F4.6. The Covariance Step: R&minus;1, S&minus;1, Special ComputationThe Covariance Step, which computes standard errors of theparameter estimates, first computes a covariance matrix ofthe parameter estimates. (This is not the same as the &Omega; or&Sigma; matrix). It is possible to request that this covariancematrix be computed in one of three different ways: either asR&minus;1, S&minus;1, or R&minus;1SR&minus;1 (the default), where R and S are twomatrices from statistical theory, the Hessian andCross-Product Gradient matrices, respectively. OptionsMATRIX=R and MATRIX=S of the $COVARIANCE record are used torequest the R&minus;1 and S&minus;1 matrices, respectively. TheCovariance Step can produce additional output. When thedefault covariance matrix is used, R&minus;1 and/or S&minus;1 can beprinted. This is requested by options PRINT=R and/orPRINT=S. Eigenvalues are be printed if requested by optionPRINT=E. Multiple PRINT options can be specified.A special computation is required when the data are from asingle individual and a recursive PRED is used. A recursivePRED is one which stores the results of certain computationsusing the values from one event record, and uses theseresults in later computations with the values from a laterevent record. PREDPP advances the kinetic system from onetime point to the next and therefore is an example of arecursive PRED. When PREDPP is used and the data is from asingle individual, NM-TRAN automatically requests thespecial computation. When a recursive user-written PRED isused and the data are from a single individual, the SPECIALoption of the $COVARIANCE record must be used.The CONDITIONAL option of the $COVARIANCE record requeststhat the Covariance Step be implemented only if EstimationStep terminates successfully, and is the default. TheUNCONDITIONAL option can be used to request that it beimplemented no matter how the Estimation Step terminates.References: Users Guide IV (NM-TRAN) III.B.15References: Users Guide II (Supplemental) D.2.54.7. Multiple Problems in a Single NONMEM RunNONMEM can implement more than one problem in a single run.That is, the input control stream can contain more than one$PROBLEM record, each followed by its own set of problemspecification statements. This feature can be useful in avariety of situations. A series of what otherwise would beseparate runs, each analyzing a single individual&rsquo;s datawithin a population data file, can be performed convenientlywithout building separate data files for each individual.Also, more than one data set can be analyzed using the samemodel and the same problem specification. Multiple problemsare also useful with NONMEM&rsquo;s Simulation Step, describedbelow.Note that abbreviated code such as $PK and $ERROR statements &#9474;cannot appear after the first problem. If the $DATA recordis omitted or the filename is specified as * on a $DATArecord in a problem subsequent to the first, the previousdata set is re-used.A sequence of problems may be defined to be a superproble____________ &#9474;by means of the NM-TRAN $SUPER record, and NONMEM may also &#9474;be directed to repeat them a specific number of times.References: Users Guide IV (NM-TRAN) III.B.14.8. Simulation Using NONMEM: The $SIMULATION RecordThe term simulatio__________ refers to the generation of data pointsaccording to some model. A simple form of simulation isperformed when the Estimation Step is omitted but the TableStep is implemented. The PRED column of the table containspredictions based on the information in the data records andthe initial estimates of &theta;, under the model specified in thePRED (PREDPP) subroutine. Random variables &eta; and &epsilon; (if any)have no effect on the predictions and may be omitted. Ifthe only purpose of the run is to obtain simulated values,and these variables are present, it is best (but notrequired) that their variances be fixed to 0. NONMEM doesnot compute the objective function in this circumstance,which has certain advantages.NONMEM can also perform a Simulation Step, in which anothertype of simulation is performed. In the Simulation Step,each value of the DV data item of each record with MDV=0 isreplaced by a simulated observation generated from themodel, but including statistical variability&dagger;.<cite>&dagger; During the Simulation Step, values of F computed by PREDor PREDPP for records having MDV=1 are irrelevant and areignored by NONMEM. </cite>The PRED (PREDPP) routine uses &eta; and &epsilon; values that aresupplied by NONMEM according to user-specified randomdistributions (e.g., with variances given by the initialestimates of &Omega; and &Sigma;). If &Omega; and &Sigma; matrices are fixed tozero, for example, the simulated values are the same as thepredictions described above.If the data are then displayed by the Table Step, the DVcolumn for records with MDV=0 contains the simulatedobservations obtained from the Simulation Step. For recordshaving MDV=1, the DV column contains whatever was in theoriginal data record. The PRED column of the table containspredictions as described above. If the Estimation Step wasnot implemented, the values of &theta; used for these predictionsare the initial values. If the Estimation Step wasimplemented, the values of &theta; used for the predictions in thePRED column are the final parameter estimates. Note thatthe observations that are fit during the search are thesimulated values obtained by the Simulation Step.Often data are simulated using the Simulation Step, thenanalyzed using one or more other steps (e.g. Estimation andCovariance Steps), and this process is repeated a fixednumber of times, using the same model. The Simulation Stepaccommodates this easily with the notion of a NONME______subproblem___________ whereby these steps are repeated within the sameNONMEM problem. However, on occasion it can be useful tohave multiple problems (see Section 4.7), where one problemimplements the Simulation Step, and the subsequent problemimplements other steps. For example, this is one way toobtain different initial parameter estimates for theEstimation Step than for the Simulation Step.The ONLYSIMULATION option causes NONMEM to suppressevaluation of the objective function. With this option,PRED-defined variables displayed in tables and scatterplots(see Section 4.13) are simulated values, i.e., use simulated&eta;s and initial &theta;s, and weighted residual values in tablesand scatterplots are always 0.References: Users Guide IV (NM-TRAN) III.B.13References: Users Guide VI (PREDPP) III.E.2, L.1 , IV.B.1-2,C, G.14.9. Files for Subsequent Processing: the $TABLE RecordNONMEM can write the data for a table to an externalformatted file, as requested by the FILE option of the$TABLE record. Other computer programs can read thesefiles. Such programs can perform further analysis orprovide improved graphical displays. These files normallycontain header lines similar to those in a printed table,but the header lines can be suppressed entirely or in partby means of the NOHEADER or ONEHEADER options, respectively.Tables may be written to the same or to different table &#9474;files.References: Users Guide IV (NM-TRAN) III.B.164.10. Data Checkout ModeNONMEM&rsquo;s data checkout mode is intended for preliminarydisplay of data without the use of a model. In datacheckout mode, the PRED routine is not called. Predictions,the objective function, residuals, and weighted residualsare not computed. Only the Table and Scatterplot Steps canbe implemented in the problem. With NM-TRAN, this mode isrequested by coding the option CHECKOUT on the $DATA record.A $SUBROUTINES record and abbreviated code are required, butthey have no effect and need only be syntactically correct.References: Users Guide IV (NM-TRAN) III.B.64.11. Obtaining Individual Parameter Estimates -Conditional Estimates of &eta;sWith population data, NONMEM can obtain estimates ofindividual-specific true values of &eta; from any given set ofvalues of &theta;, &Omega;, &Sigma;, and the individual&rsquo;s data. These arecalled conditiona___________ estimates of &eta;. When the conditionalestimates are obtained after estimation is carried out bythe First-Order method, they are referred to as &quot;posthoc&quot;estimates. With NM-TRAN, they are requested by the optionPOSTHOC on the $ESTIMATION record.References: Users Guide IV (NM-TRAN) III.B.144.12. Population Conditional Estimation MethodsNONMEM can obtain conditional estimates of &eta; variables aspart of the computation of population parameter estimates.These are called conditiona___________ estimatio__________ methods________ WithNM-TRAN, such methods are requested by including the optionMETHOD=CONDITIONAL (or METHOD=1) on the $ESTIMATION record.(The option METHOD=ZERO, or METHOD=0, requests theconventional First-Order method and is the default.) Thereare two conditional estimation methods. If NONMEM uses onlyfirst-order approximations, this is the First-Orde___________Conditiona___________ Estimatio__________ Method_______ This has one variation,interaction____________ which takes into account &eta;-&epsilon; interaction and isrequested by the additional option INTERACTION on the$ESTIMATION record. If NONMEM uses a certain second-orderapproximation, this is the Laplacia_________ method, which isrequested by the additional option LAPLACIAN on the$ESTIMATION record. Interaction cannot be specified withthe Laplacian method.Note that this usage of the term CONDITIONAL is differentfrom the usage on the $SCATTERPLOT, $TABLE, and $COVARIANCErecords, in which it refers to the circumstances under whichthe step in question is implemented.References: Users Guide IV (NM-TRAN) III.B.144.13. Displaying PRED-Defined Variables and ConditionalEstimates of &eta;sNONMEM can display PRED-defined variables in table andscatterplots. With NM-TRAN, any variable appearing on theleft-hand side of an assignment statement in abbreviatedcode can be displayed by listing it in a $TABLE or $SCATTERrecord. If the data are population, NONMEM can also displayconditional estimates of &eta;. With NM-TRAN, variables ETA(1),ETA(2), etc., can be simply listed in $TABLE and $SCATTERrecords. When conditional estimation is not performed, thevalues displayed are zero. Displayed values of PRED-defined &#9474;random variables will use conditional estimates of &eta; if theyhave been obtained, otherwise they will be typical values.This feature is available with PREDPP, as well as withuser-written PRED routines. For example, the followingrecords could replace the $ESTIMATION record in Figure 12.2:$ESTIMATION POSTHOC$TABLE ETA(1) EMAXThe $ABBREVIATED record can be used to limit the number ofvariables available for display when the number isexcessive.References: Guide III (Installation) V.2.4References: Guide IV (NM-TRAN) III.B.16-17References: Guide VI (PREDPP) III.J, IV.E4.14. Mixture ModelsA mixtur_______ mode_____ is a model that explicitly assumes that thepopulation consists of two or more sub-populations, eachhaving its own model. For example, with twosub-populations, one might assume that some fraction p ofthe population has one set of typical values of the PKparameters, and the remaining fraction 1-p has another setof typical values. Both sets of typical values and themixing fraction p may be estimated. For each individual,NONMEM also computes an estimate of the number of thesubpopulation of which the individual is a member. The usermust supply a FORTRAN subroutine called MIX or a $MIX block &#9474;of abbreviated code to compute the fractions p and 1-p.References: Users Guide VI (PREDPP) III.L.24.15. PRED Error Return Codes and Error Messages in FilePRDERRA PRED routine can return a PRE____ erro_____ retur______ cod____ (1 or 2)to NONMEM, indicating that it is unable to compute aprediction for a given data record with the current valuesof &theta;&rsquo;s and &eta;&rsquo;s. For example, PREDPP returns error returncode 1 when a basic or additional PK parameter has a valuethat is physically impossible (e.g., a scale parameter whichis zero or negative). Error return codes can also bespecified by the user in user-written code or in abbreviatedcode using the EXIT statement. One reason for doing this isto constrain parameters in order to avoid floating pointmachine interrupts. The PRE____ erro_____ recover________ optio______determines what action NONMEM will take. With NM-TRAN, thePRED error recovery option is either ABORT (which is thedefault) or NOABORT, and is specified on the $ESTIMATION and$THETA records.If an error return code is returned during the Simulation,Covariance, Table or Scatterplot Step, or during computationof the initial value of the objective function, NONMEM willabort. If the error return code is returned during theEstimation or Initial Estimates Step, NONMEM will try toavoid those values of &theta; and &eta; for which the error occurs. Ifthey cannot be avoided, NONMEM&rsquo;s actions depend on the errorreturn code value, as follows:1 If NOABORT is specified on $ESTIM or $THETA, try toavoid the current values of &theta; and &eta;. If ABORT isspecified on $ESTIM or $THETA, then abort.2 Abort in all cases.PRED routines may optionally provide text accompanying theerror return code. NONMEM writes all text associated witherror return codes to a file, PRDERR. The contents of thisfile should always be carefully reviewed.References: Users Guide III (Installation) III.2.1.1References: Users Guide IV (NM-TRAN) IV.A, IV.C.5-6References: Users Guide VI (PREDPP) III.K, IV.F4.16. User-Written SubroutinesAlthough most NONMEM applications can be accomplished usingNM-TRAN abbreviated code, there are cases in whichuser-written FORTRAN subroutines are needed. The$SUBROUTINES record allows the user to specify the names ofuser-written routines that are needed in the NONMEM loadmodule. A user may choose to write his own PRED, PK, ERROR,MODEL, DES, or AES subroutine. Some subroutines that aredistributed with NONMEM are dummy, or &quot;stub&quot; routines, thatdo nothing. Of these, subroutines CCONTR, CONPAR, CONTR,and CRIT can be replaced to obtain an objective functiondifferent from the default. NONMEM subroutine MIX must bereplaced for mixture models. PREDPP subroutine INFN may bereplaced by user-written code. The names of all suchroutines are specified using the identically named optionsof the $SUBROUTINES record, e.g., PRED=subname,CONTR=subname, etc. User-written routines may call otherFORTRAN subroutines, which can be specified for inclusion inthe load module using the option OTHER=subname.With user-written CONTR routines, the NM-TRAN $CONTR recordmay be useful.References: Users Guide IV (NM-TRAN) III.B.4, B.6 &#9474;4.17. PRIOR &#9474;The PRIOR subroutine and $PRIOR record allows a Bayesian &#9474;penalty function to be added to the NONMEM objective &#9474;function. This serves as a constraint on the estimates of &#9474;THETA, OMEGA, and SIGMA and thus as a way for stable &#9474;estimates to be obtained with insufficient data. &#9474;References: Introduction to NONMEM Version VI5. Observations of Two Different TypesAn NM-TRAN control stream is shown in Figure 12.3, for theanalysis of a data set which contains observations of twodifferent types. A fragment of the data set, shown inFigure 12.4, contains the data for one individual. Thisexample illustrates how concentration and effect data can befit simultaneously, and includes many of the advancedfeatures described in this chapter, such as pharmacodynamicmodeling in the $ERROR statements, correlation betweenelements of &Sigma;, and the L2 data item.Suppose that the data set for the phenobarbital example ofChapter 2 is modified to include both concentration andeffect observations, and that a data item called TYPE isused to distinguish between them. When TYPE is 1, DVcontains an effect measurement. When TYPE is 2, DV containsa concentration. The $PK statements are the same as thoseof Figure 2.12. The $ERROR statements are the same as thoseof Figure 12.1, except that the elements of &theta; and &eta; arerenumbered to follow those used in the $PK statements. The &#9474;(random) variable Y1 is assigned the same value as Y in the &#9474;$ERROR statements of Figure 12.1 The (random) variable Y2 isassigned the same value as Y in the $ERROR statements ofFigure 2.12, except that &epsilon;2 is used rather than &epsilon;1.The input data file contains observations of both typeswhich were made at the same time value. The event recordstherefore include the L2 data item. Figure 12.4, likeFigure 2.7, shows the data for the first individual, butincludes TYPE and L2 data items and effect observations.Note that the L2 data item has a different value for eachmultivariate observation within the individual record. (Thevalues 1 and 2 are chosen arbitrarily and may be re-used forthe L2 data items in the next individual&rsquo;s data, ifdesired.)The $THETA, $OMEGA, and $SIGMA records contain the valuesshown in Figures 2.12 and 12.1 and one other value, 2.8, forthe covariance &Sigma;12=cov(&epsilon;1,&epsilon;2). The estimate 2.8 is chosenso that the correlation is, arbitrarily, .5(2.8=&Sigma;12=(&Sigma;11&Sigma;22)2corr=(8&times;4)2.5).$PROBLEM COMBINED PK/PD MODEL$INPUT ID TIME AMT WT APGR DV TYPE L2$DATA COMBDATA$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERROREMAX=THETA(5)+ETA(3)C50=THETA(6)+ETA(4)E=EMAX*F/(C50+F)Y1=E+ERR(1)Y2=F+ERR(2)Q=1IF (TYPE.EQ.2) Q=0Y=Q*Y1+(1-Q)*Y2$THETA (0,.0027) (0,.70) .0018 .5 100 20$OMEGA .000007 .3 400 16$SIGMA BLOCK(2) 4 2.8 8$ESTIMATIONFigure 12.3. The input to NONMEM-PREDPP for analysis of thepopulation phenobarbital data, including both concentrationand effect observations.1 0. 25.0 1.4 7 . 2 01 2.0 . 1.4 7 6.0 1 11 2.0 . 1.4 7 17.3 2 11 12.5 3.5 1.4 7 . 2 01 24.5 3.5 1.4 7 . 2 11 37.0 3.5 1.4 7 . 2 01 48.0 3.5 1.4 7 . 2 11 60.5 3.5 1.4 7 . 2 01 72.5 3.5 1.4 7 . 2 11 85.3 3.5 1.4 7 . 2 01 96.5 3.5 1.4 7 . 2 11 108.5 3.5 1.4 7 . 2 01 112.5 . 1.4 7 8.0 1 21 112.5 . 1.4 7 31.0 2 2Figure 12.4. The first individual&rsquo;s phenobarbital data,including both concentration and effect observations.The above $ERROR statements can be coded more simply. &#9474;$ERROR &#9474;EMAX=THETA(5)+ETA(3) &#9474;C50=THETA(6)+ETA(4) &#9474;E=EMAX*F/(C50+F) &#9474;IF (TYPE.EQ.2) THEN &#9474;Y=F+ERR(2) &#9474;ELSE &#9474;Y=E+ERR(1) &#9474;ENDIF &#9474;Figure 12.5. Alternate $ERROR statements &#9474;6. NONMEM 7 &#9474;With NONMEM 7 there are many new features, including new &#9474;Estimation Methods. A description is beyond the scope of &#9474;this guide. &#9474;References: Introduction to NONMEM 7
<a name="1. What This Chapter is AboutThis chapter briefly describes a variety of features ofPREDPP and NONMEM that are somewhat advanced for this textbut are of interest to most users of NONMEM. References aregiven to other documents where additional information can befound. Section 2 is concerned with PREDPP, Section 3 isconcerned with user-written PREDs, and Section 4 describesgeneral NONMEM features. Section 5 contains an example thatincludes several of the advanced features. Note that &#9474;wherever $PK, $ERROR, $DES, $AES, $MODEL, $MIX and $PREDstatements are referred to below, user-written subroutines &#9474;PK, ERROR, DES, AES, MODEL, MIX and PRED can be usedinstead.2. Advanced Features of PREDPP2.1. Pharmacodynamic Modeling Using the $ERROR Record$ERROR statements may modify the value of F, the scaled drugconcentration. They may also introduce new &theta; and &eta;variables. This allows pharmacodynamic modeling to beperformed using PREDPP. Such models occur when a studyinvolves measurement of a drug effect, such as bloodpressure. A proposed model might relate the predictedeffect to a pharmacokinetic quantity such as plasma level.PREDPP can be used to model Cp as is usual, and thepredicted effect can be computed in the $ERROR statements.For example, suppose that a modified version of thephenobarbital data of Chapter 2 includes observations ofsome drug effect (in this case, perhaps a measure of thedegree of sedation) but none of the concentrationobservations. The dose event records are the same as thoseof the earlier example. Suppose that the drugconcentrations from each individual have been used toestimate that individual&rsquo;s K and V parameters, and thatthese estimates are now included on every event record forthe individual. Finally, suppose that the proposedstructural model for the effect, E, is an &quot;E-max&quot; model:E=EmaxC50Cp+Cpwhere here Cp is understood to mean the prediction of an individual&rsquo;sdrug concentration in the plasma, andEmax and C50 are PD (pharmacodynamic parameters) modeled asEmax=&theta;1+&eta;1C50=&theta;2+&eta;2To fit this data we can use the control statements of figure12.1. To obtain initial parameter estimates, let us assumethat the following is observable in the data. The averagevalue of all effect measurements is about 50. Acrossindividuals, the average value of the largest effectmeasurement within each individual&rsquo;s data is about 100, andthe average value of the individual&rsquo;s observed concentrationat about half this largest measurement is about 20. (Thisis seen when concentration measurements and effectmeasurements are examined together.) Let us also assume 20%random interindividual variability in Emax and C50 and 4%intraindividual variability in the observation. From thiswe obtain initial estimates of 100 and 20 for &theta;1 and &theta;2,(100&times;.2)2 for &Omega;11, (20&times;.2)2 for &Omega;22, and (50&times;.04)2 for &Sigma;.This example is examined again in in Section 3.2, whichshows the use of $PRED statements, and in Section 5, whichshows how observed concentrations and effects can be fitsimultaneously.References: Users Guide VI (PREDPP) IV.B.2$PROBLEM PHARMACODYNAMIC MODEL USING $ERROR STATEMENTS$INPUT ID TIME AMT INDK INDV DV$DATA EFFDATA$SUBROUTINE ADVAN1$PKK=INDKV=INDVS1=V$ERROREMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*F/(C50+F)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.1. The input to NONMEM-PREDPP for analysis ofeffect observations.2.2. Other Pharmacokinetic Models: ADVAN5 through ADVAN9 &#9474;and ADVAN13Appendix 1 lists ADVAN routines for the most commonly-usedpharmacokinetic models. Other ADVAN routines are:ADVAN5 (General Linear)ADVAN6 (General Nonlinear)ADVAN7 (General Linear with Real Eigenvalues)ADVAN8 (General Nonlinear Kinetics with Stiff Equations)ADVAN9 (General Nonlinear Kinetics with EquilibriumCompartments) &#9474;ADVAN13 (General Nonlinear Kinetics using LSODA)With the general methods the user defines a model of up to &#9474;99 compartments using special options of the $MODEL record.For a linear model (ADVAN5 and ADVAN7), it is sufficient tospecify (directed) compartmental connections and to computetheir rate constant parameters with $PK statements. ADVAN 5and 7 make use of numerical approximations to the matrixexponential. For a nonlinear model (ADVAN6, ADVAN8, ADVAN9, &#9474;and ADVAN13), differential equations must be supplied togovern the kinetics, via $DES statements. It is possible to &#9474;specify initial conditions for the differential equations &#9474;using the I_SS (Initial Steady State) feature. For ADVAN9,algebraic equations may also be supplied via $AESstatements. The use of the term &rsquo;nonlinear&rsquo; with ADVAN 6,8, 9, and 13 only indicates that a system of any type offirst-order differential equations is allowed; suchequations could be linear or non-linear.In all cases, the basic features of PREDPP described inChapter 7 are still available, such as the ability tointroduce doses of any kind to any compartment of the model.It should be noted that the general ADVAN routines arerelatively slow. For example, when a general method is usedfor a model identical to that of an analytic method (ADVAN1 &#9474;through ADVAN4 or ADVAN10 through ADVAN12) the run timeincreases, usually by an order of magnitude.Some ADVAN and SS routines must be told the number ofaccurate digits that are required in the computation of drugamounts, i.e., the relative tolerance. This is specifiedeither by the TOL option of the $SUBROUTINES record or bythe $TOL record.References: Users Guide VI (PREDPP) VI, VIIReferences: Users Guide IV (NM-TRAN) V.C.3, 4, 7-102.3. Zero-Order Bolus DosesInstantaneous bolus doses, which have AMT&gt;0 and RATE=0, aredescribed in Chapter 6. Such doses appear instantaneouslyin the dose compartment. Zero-order bolus doses are dosesthat enter the dose compartment via a zero-order process (inthe same manner as do infusions) except that the rate orduration of the process is computed with $PK statements.When the RATE data item has the value -1, then the $PKstatements must include an assignment statement for anadditional PK parameter, Rn (the &quot;modeled rate forcompartment n&quot;), whose value gives the rate of entry of thedrug during the interval of time between the last eventrecord and the current one. There is a different suchparameter for every compartment receiving a zero-order bolusdose. When the RATE data item has the value -2, then the$PK statements must include an assignment statement for anadditional PK parameter, Dn (the &quot;modeled duration forcompartment n&quot;), whose value at the time of the dose eventgives the duration time of the dose. The rate and durationparameters can be modeled like any other PK parameters; inparticular, the assignment statements can involve &theta;&rsquo;s whichare to be estimated. These parameters can be used to modelthe drug release rate or dissolution time of a tablet orcapsule.Steady-state levels involving zero-order bolus doses can becomputed.Steady-state with constant infusion was described in Chapter6. Steady-state infusions may also have modeled rates(i.e., the RATE data item may be -1).References: Users Guide VI (PREDPP) III.F.3, F.42.4. The Additional Dose Data Item: ADDLADDL is a dose-related data item that is used to requestthat a given number of additional doses, just like the dosespecified on the event record, be added to the system at aregular time interval, starting from the time on the eventrecord. PREDPP itself adds these doses at the appropriatefuture times; no actual dose event record is generated bythe Data Preprocessor or by PREDPP. A positive integervalue in ADDL specifies how many additional doses (i.e., inaddition to that already specified in the event record) areto be given, and the value in the II (interdose interval)data item (which is required) specifies the time intervalbetween doses.ADDL may be non-zero on a steady-state dose event record(except for steady-state infusions), in which caseadditional doses are given, maintaining the dosing regimeninto the future. Non-steady-state kinetic formulas are usedto advance the system between each additional dose. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) V.K2.5. Lagged doses: the ALAG ParameterPREDPP permits an additional PK parameter called anabsorption lag time. One such parameter can be defined foreach compartment and applies to all doses to thatcompartment. It gives the amount of time that a dose isheld as a &quot;pending&quot; dose. When the absorption lag time hasexpired, the dose is input into the system. In effect, thevalue of the absorption lag time parameter is added to thevalue of the TIME data item on the dose event record. WithNM-TRAN, recognized names for absorption lag time parametershave the form ALAGn, where n is the compartment number. Seealso Section 2.6 below.References: Users Guide VI (PREDPP) III.F.6References: Users Guide IV (NM-TRAN) V.C.5 &#9474;2.6. Model Event Times: MTIME &#9474;Model event times MTIME(i) are additional PK parameters &#9474;defined in the PK routine or $PK block. A model event time &#9474;is not associated with any compartment, but, like an &#9474;absorption lag time, defines a time to which the system is &#9474;advanced. When the time is reached, indicator variables are &#9474;set and a call to PK is made. At this call (and/or &#9474;subsequent to this call) PK or DES or AES or ERROR can use &#9474;the indicator variables to change some aspect of the &#9474;system, e.g., a term in a differential equation, or the rate &#9474;of an infusion.2.7. Controlling Calls to PK and ERRORIn order to evaluate the $PK and $ERROR statements, PREDPPcalls the PK and ERROR subroutines. By default, thesubroutines are called with every event record. PREDPP maybe instructed to limit calls to certain event records inorder to save the computing time involved with unnecessarycalls (e.g. when the PK parameters do not vary from eventrecord to event record within an individual). It is alsopossible to cause the PK subroutine to be called at timeswhich do not correspond to any actual event record.Using NM-TRAN, calls to PK are controlled by the presence ofone of the following pseudo-statements, at the start of the$PK block:CALLFL=-2:call with every event record, at additional and lagged &#9474;dose times, and at modeled event times.CALLFL=-1:call with every event record (default).CALLFL=0:call with the first event record of each individualrecord and with new values of TIME.CALLFL=1:call once per individual record.A callin_______ protoco________ phras______ may be used instead of a &#9474;pseudo-statement. A calling protocol phrase may use upper- &#9474;or lower-case characters. It must be enclosed in &#9474;parentheses. NM-TRAN can understand minor variations in the &#9474;wording. E.g., the word &quot;CALL&quot; and prepositions such as &#9474;WITH can be omitted. Here are calling protocol phrases &#9474;equivalent to the above four pseudo-statements, &#9474;respectively. &#9474;(CALL WITH NON-EVENT TIMES) &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH FIRST EVENT RECORD AND NEW TIME) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;The choice CALLFL=-2 (CALL WITH NON-EVENT TIMES) is intended &#9474;to be used when PK parameters Dn and/or Fn apply toadditional or lagged doses and the model for theseparameters depends on some time-varying concomitant variablesuch as type of drug preparation or patient weight. Bydefault, the values of the PK parameters which apply to thedose are those values computed by PK with the first eventrecord having a value of TIME greater than the time at whichthe dose actually enters the system (the additional orlagged dose time). However, if PREDPP is instructed to alsocall PK at the additional or lagged dose time, then thevalues of the PK parameters are those values computed atthese special calls. At such calls, PK has available to itinformation from the initiating dose event record itself,and information from the two event records whose TIME valuesbracket the additional or lagged dose time. Along withCALLFL=-2 in the $PK block, the NM-TRAN $BIND record may beuseful; see Users Guide IV.Using NM-TRAN, calls to ERROR are controlled by the presenceof one of the following pseudo-statements at the start ofthe $ERROR block:CALLFL=-1: call with every event record (default).CALLFL=0: call with observation events only.CALLFL=1: call once per individual record.A calling protocol phrase may be used instead of a &#9474;pseudo-statement. As in the $PK block, the calling protocol &#9474;phrase may use upper- or lower-case characters and must be &#9474;enclosed in parentheses. &#9474;Here are calling protocol phrases equivalent to the above &#9474;three pseudo-statements, respectively. &#9474;(CALL WITH EVERY EVENT RECORD) &#9474;(CALL WITH OBSERVATION EVENTS) &#9474;(CALL ONCE PER INDIVIDUAL RECORD) &#9474;NM-TRAN automatically instructs PREDPP to limit calls toERROR to once per problem for the simple error modelsdiscussed in Chapter 8, Sections 3.1 and 3.2:Y=F+ERR(1)Y=F+F*ERR(1)Y=F*(1+ERR(1))Y=F*EXP(ERR(1))During the Simulation Step, PREDPP ignores any limitationand calls the ERROR subroutine with every event record.Even when calls to PK and/or ERROR are limited, the CALLinput data item can be used to force additional calls forspecific event records as needed.References: Users Guide VI (PREDPP) III.B.2, III.H, IV.C,V.JReferences: Users Guide IV (NM-TRAN) V.C.5, C.62.8. Transgeneration of Input Data: the INFN SubroutineNONMEM may be used to modify the data records before anycomputations are performed and also after all computationshave been performed. This is referred to as transgeneratio_______________of the data. Transgeneration at the beginning of a problemcan be used, for example, to change weight-normalized dosesto unnormalized doses. PREDPP allows the user to supply asubroutine called INFN (&quot;initialization/finalization&quot;) inwhich transgeneration can be performed. (The PREDPP libraryincludes a default INFN subroutine which does nothing.)References: Users Guide VI (PREDPP) VI.A3. User-written PRED SubroutinesIt is not necessary to use PREDPP with NONMEM. Either $PREDstatements or a user-written PRED subroutine may be used inplace of PREDPP to supply NONMEM with predicted values forthe DV data item according to some (not necessarilypharmacokinetic) model. An example using $PRED statementsis given here. A special caveat applies to user-writtenPRED subroutines that are recursive: see 4.6 below.References: Users Guide I (Basic) C.23.1. Required Data ItemsThe only required data items when PREDPP is not used are theNONMEM data items DV, MDV, and ID. When PREDPP is used, theData Preprocessor is able to recognize which records containobserved values and which do not, and it supplies the MDVdata item if it is not already present in the data file.When PREDPP is not used, the Data Preprocessor cannot dothis. The input data file must already contain the MDV dataitem if it is needed, i.e., if the DV item of some datarecord does not contain a value of an actual observation.If $PRED statements are used, they must calculate a variablecalled Y, using input data items and NONMEM&rsquo;s &theta;, &eta;, and (forpopulation models) &epsilon; vectors in the calculation.References: Users Guide I (Basic) B.1References: Users Guide IV (NM-TRAN) III.B.83.2. An Example of $PRED Statements: PharmacodynamicModelingThe syntax of $PRED statements is essentially the same asdiscussed for $PK and $ERROR statements. $PRED statementscan be used for simple pharmacokinetic and pharmacodynamicmodels. In figure 12.1 above an example was given ofpharmacodynamic modeling using $ERROR statements. Supposethat in that example, drug concentration is always measuredat the same time as drug effect. Suppose too, that ratherthan input the individuals&rsquo; values of K and V and use themto compute a predicted drug concentration for theindividual, the observed drug concentration itself is usedin the Emax model. This means that the the observedconcentrations are again incorporated into the data, but nowas values of an independent variable, rather than as the DVdata item. This also means that a pharmacokinetic model isnot needed, and therefore, PREDPP is not needed either.Figure 12.2 shows the control stream for this new example.$PROBLEM A SIMPLE PHARMACODYNAMIC MODEL$INPUT ID TIME CP DV$DATA EFFDATA$PREDEMAX=THETA(1)+ETA(1)C50=THETA(2)+ETA(2)E=EMAX*CP/(C50+CP)Y=E+ERR(1)$THETA 100 20$OMEGA 400 16$SIGMA 4$ESTIMATIONFigure 12.2. The input to NONMEM including $PRED statementsfor analysis of effect data.4. Advanced Features of NONMEM4.1. Full Covariance Matrices: $OMEGA BLOCK and $SIGMABLOCKIn the examples of Chapter 2 and 9, there appearedstatements such as:$OMEGA .0000055, .04This is an example of the specification of initial parameterestimates for a variance-covariance &Omega; matrix which isconstrained to be diagonal. Initial estimates are given forthe variances of &eta;1 and of &eta;2. The covariance between &eta;1and &eta;2 is constrained to be 0, i.e., &omega;12=cov(&eta;1,&eta;2)=0.Another way of writing this statement is:$OMEGA DIAGONAL(2) .0000055, .04The option DIAGONAL(2) states explicitly that the blockcontains two &eta;s and that it has diagonal form.If the data supports the possibility that &eta;1 and &eta;2 covarywith each other, it may be useful to model &Omega; as beingunconstrained and allow NONMEM to estimate the covariance.A special form of the $OMEGA record is used, in whichinitial values are supplied for both variances and thecovariance. For example:$OMEGA BLOCK(2) .0000055, .0000001, .04The option BLOCK(2) states that there are two &eta; variables inthe block, and that covariance is to be estimated. The newelement is &omega;12=&omega;21=cov(&eta;1,&eta;2)=cov(&eta;2,&eta;1)=1&times;10&minus;7.$OMEGA BLOCK is used for both population and individualstudies, i.e., it is the same whether &eta; is used in the firstcase in a model for residual error or is used in the secondcase in a model for random interindividual error. In apopulation study, if there is more than one &epsilon; variable, andthe model allows these variables to covary, then $SIGMABLOCK is used in a similar manner.The initial estimates of even more complicated &Omega; and &Sigma;matrices may be given using multiple $OMEGA and $SIGMArecords. For example, the initial estimates of a mixture ofcorrelated and uncorrelated random variables may given.Also, in this context (as with the simple form of the $OMEGAand $SIGMA records described in Chapter 9, Section 3)variances-covariances may be constrained to fixed values bymeans of the FIXED option. Finally, somevariances-covariances may be constrained to equal others bymeans of the BLOCK SAME option. The ability to fix allvariances-covariances in both &Omega; and &Sigma; allows Bayesianestimates to be obtained of the pharmacokinetic parametersof a single individual, based on the individual&rsquo;s data and aprior population distribution for the parameters.References: Users Guide IV (NM-TRAN) III.B.104.2. Grouping Related Observations: The L1 and L2 DataItemsThe $ERROR statements for a problem may sometimes involvemore than one random variable. For example, there may betwo types of observations. One type may be an observationfrom one compartment of a PK system, or with one assay orpreparation, and another type may be an observation from adifferent compartment or with a different assay orpreparation. The model for the two types of observationswould typically involve at least two &epsilon; variables (e.g.(3.8)). If all observations are made at sufficientlyseparated times, there may be little reason to be concernedabout correlation between the two random errors. However,if the two types of observations are taken at the same orvery close to the same time, it is possible that correlationwill exist; whatever circumstance has influenced oneobservation to be different from the predicted level mayalso have some influence on the other observation. In thiscase a covariance between the two &epsilon; variables should beallowed, as described above in Section 4.1. Then the twotypes of observations at the same time point are regarded astwo elements of a multivariat____________ observation____________In the case of population data, there exists a NONMEM dataitem, L2, which is used to identify the elements of amultivariate observation. In effect, L2 acts in a similarway as ID, but grouping observations within individualrecords.In the case of individual data, the ID data item alreadyserves this purpose: it forms groups of observations whose&eta; variables may be correlated. Thus, in the input datafile, the ID data item should be the same for thoseobservations which may have correlated &eta;s. However, forindividual data, the Data Preprocessor normally replaces theID data item with a new set of values which describe everyobservation as being independent of the others. To preventthe Data Preprocessor from doing this, L1 should be includedin the $INPUT record as the name or synonym for theuser-supplied ID data item.References: Users Guide IV (NM-TRAN) II.C.4, III.B.2References: Users Guide II (Supplemental) D.34.3. Continuing a NONMEM Run: MSFO and MSFI &#9474;The MSFO (Model Specification Output File) option of the$ESTIMATION record instructs NONMEM to write a Mode_____Specificatio_____________ Fil____ (MSF)______ It is created when NONMEM writes &#9474;the first iteration summary to the intermediate output file, &#9474;and is re-written when every subsequent iteration summary is &#9474;written. This file can then be read in a subsequent NONMEMrun using a $MSFI (Model Specification File Input) record.This file has much of the information about the model usedin the previous run, thus the name &quot;Model SpecificationFile&quot;. It also contains all the information that allows theEstimation Step from the previous run (which may haveterminated, for example, due to the number of functionevaluations exceeding its limit or a computer crash or some &#9474;other externally-caused interruption of the NONMEM run) tobe continued in the subsequent run. There are a number ofbenefits to using a MSF. First, what might be a longEstimation Step (due to a very lengthy search) can be splitover a series of runs, each with a limited number offunction evaluations. Any run which terminates prematurelydue to computer failure can be restarted from the MSF outputin the previous run. (This provides a &quot;checkpoint/restart&quot;capability.) The progress made in the Estimation Step canalso be evaluated between runs, and a decision made as towhether it is worth continuing a search which is consumingexcessive amounts of computer time. Second, the Covariance,Tables, and Scatterplot Steps can be performed in laterruns, each using the MSF from the final run with theEstimation Step. It is advisable to perform the CovarianceStep only after satisfactory results have been obtained fromthe Estimation Step.References: Users Guide I (Basic) C.4.4References: Users Guide IV (NM-TRAN) III.B.6, B.124.4. NONMEM Can Obtain Initial Estimates for &theta;, &Omega;, &Sigma;NONMEM can be directed to obtain initial estimates for oneor more elements of &theta;, &Omega;, or &Sigma;. This is done in a separateInitial Estimates Step. For an element of &theta;, omit theinitial estimate but include lower and upper bounds, e.g.,(1, ,50) in the $THETA record. (The NUMBERPOINTS option maybe used to control the number of points in &theta; space examinedby NONMEM during the search for initial estimates of &theta;.)For a block of &Omega; or &Sigma;, omit all initial estimates on the$OMEGA BLOCK (or DIAGONAL) record, or $SIGMA BLOCK (orDIAGONAL) record, respectively.Note that when $PK and $ERROR statements are present but the$OMEGA and/or $SIGMA records are absent, NONMEM will bedirected to obtain initial estimates for the variances ofthe random variables in question, assuming the diagonal formof the matrix.References: Users Guide IV (NM-TRAN) III.B.9-114.5. Improving Parameter Estimates: REPEAT and RESCALEThe Estimation Step can be immediately repeated after thesearch has terminated successfully, by including the REPEAToption on the $ESTIMATION record. This can improve theaccuracy of the parameter estimates when one or more initialestimates are wrong by a few orders of magnitude. The finalestimates from the first implementation of the EstimationStep are used as the initial estimates of the secondimplementation, and thus the scaling used with the STP isdifferent from that with the first implementation, allowingfewer leading zeros after the decimal point in the STP.When the Estimation Step is continued by means of a ModelSpecification File, similar rescaling can be requested usingthe RESCALE option of the $MSFI record.References: Users Guide IV (NM-TRAN) III.B.12, B.14References: Users Guide II (Supplemental) F4.6. The Covariance Step: R&minus;1, S&minus;1, Special ComputationThe Covariance Step, which computes standard errors of theparameter estimates, first computes a covariance matrix ofthe parameter estimates. (This is not the same as the &Omega; or&Sigma; matrix). It is possible to request that this covariancematrix be computed in one of three different ways: either asR&minus;1, S&minus;1, or R&minus;1SR&minus;1 (the default), where R and S are twomatrices from statistical theory, the Hessian andCross-Product Gradient matrices, respectively. OptionsMATRIX=R and MATRIX=S of the $COVARIANCE record are used torequest the R&minus;1 and S&minus;1 matrices, respectively. TheCovariance Step can produce additional output. When thedefault covariance matrix is used, R&minus;1 and/or S&minus;1 can beprinted. This is requested by options PRINT=R and/orPRINT=S. Eigenvalues are be printed if requested by optionPRINT=E. Multiple PRINT options can be specified.A special computation is required when the data are from asingle individual and a recursive PRED is used. A recursivePRED is one which stores the results of certain computationsusing the values from one event record, and uses theseresults in later computations with the values from a laterevent record. PREDPP advances the kinetic system from onetime point to the next and therefore is an example of arecursive PRED. When PREDPP is used and the data is from asingle individual, NM-TRAN automatically requests thespecial computation. When a recursive user-written PRED isused and the data are from a single individual, the SPECIALoption of the $COVARIANCE record must be used.The CONDITIONAL option of the $COVARIANCE record requeststhat the Covariance Step be implemented only if EstimationStep terminates successfully, and is the default. TheUNCONDITIONAL option can be used to request that it beimplemented no matter how the Estimation Step terminates.References: Users Guide IV (NM-TRAN) III.B.15References: Users Guide II (Supplemental) D.2.54.7. Multiple Problems in a Single NONMEM RunNONMEM can implement more than one problem in a single run.That is, the input control stream can contain more than one$PROBLEM record, each followed by its own set of problemspecification statements. This feature can be useful in avariety of situations. A series of what otherwise would beseparate runs, each analyzing a single individual&rsquo;s datawithin a population data file, can be performed convenientlywithout building separate data files for each individual.Also, more than one data set can be analyzed using the samemodel and the same problem specification. Multiple problemsare also useful with NONMEM&rsquo;s Simulation Step, describedbelow.Note that abbreviated code such as $PK and $ERROR statements &#9474;cannot appear after the first problem. If the $DATA recordis omitted or the filename is specified as * on a $DATArecord in a problem subsequent to the first, the previousdata set is re-used.A sequence of problems may be defined to be a superproble____________ &#9474;by means of the NM-TRAN $SUPER record, and NONMEM may also &#9474;be directed to repeat them a specific number of times.References: Users Guide IV (NM-TRAN) III.B.14.8. Simulation Using NONMEM: The $SIMULATION RecordThe term simulatio__________ refers to the generation of data pointsaccording to some model. A simple form of simulation isperformed when the Estimation Step is omitted but the TableStep is implemented. The PRED column of the table containspredictions based on the information in the data records andthe initial estimates of &theta;, under the model specified in thePRED (PREDPP) subroutine. Random variables &eta; and &epsilon; (if any)have no effect on the predictions and may be omitted. Ifthe only purpose of the run is to obtain simulated values,and these variables are present, it is best (but notrequired) that their variances be fixed to 0. NONMEM doesnot compute the objective function in this circumstance,which has certain advantages.NONMEM can also perform a Simulation Step, in which anothertype of simulation is performed. In the Simulation Step,each value of the DV data item of each record with MDV=0 isreplaced by a simulated observation generated from themodel, but including statistical variability&dagger;.<cite>&dagger; During the Simulation Step, values of F computed by PREDor PREDPP for records having MDV=1 are irrelevant and areignored by NONMEM. </cite>The PRED (PREDPP) routine uses &eta; and &epsilon; values that aresupplied by NONMEM according to user-specified randomdistributions (e.g., with variances given by the initialestimates of &Omega; and &Sigma;). If &Omega; and &Sigma; matrices are fixed tozero, for example, the simulated values are the same as thepredictions described above.If the data are then displayed by the Table Step, the DVcolumn for records with MDV=0 contains the simulatedobservations obtained from the Simulation Step. For recordshaving MDV=1, the DV column contains whatever was in theoriginal data record. The PRED column of the table containspredictions as described above. If the Estimation Step wasnot implemented, the values of &theta; used for these predictionsare the initial values. If the Estimation Step wasimplemented, the values of &theta; used for the predictions in thePRED column are the final parameter estimates. Note thatthe observations that are fit during the search are thesimulated values obtained by the Simulation Step.Often data are simulated using the Simulation Step, thenanalyzed using one or more other steps (e.g. Estimation andCovariance Steps), and this process is repeated a fixednumber of times, using the same model. The Simulation Stepaccommodates this easily with the notion of a NONME______subproblem___________ whereby these steps are repeated within the sameNONMEM problem. However, on occasion it can be useful tohave multiple problems (see Section 4.7), where one problemimplements the Simulation Step, and the subsequent problemimplements other steps. For example, this is one way toobtain different initial parameter estimates for theEstimation Step than for the Simulation Step.The ONLYSIMULATION option causes NONMEM to suppressevaluation of the objective function. With this option,PRED-defined variables displayed in tables and scatterplots(see Section 4.13) are simulated values, i.e., use simulated&eta;s and initial &theta;s, and weighted residual values in tablesand scatterplots are always 0.References: Users Guide IV (NM-TRAN) III.B.13References: Users Guide VI (PREDPP) III.E.2, L.1 , IV.B.1-2,C, G.14.9. Files for Subsequent Processing: the $TABLE RecordNONMEM can write the data for a table to an externalformatted file, as requested by the FILE option of the$TABLE record. Other computer programs can read thesefiles. Such programs can perform further analysis orprovide improved graphical displays. These files normallycontain header lines similar to those in a printed table,but the header lines can be suppressed entirely or in partby means of the NOHEADER or ONEHEADER options, respectively.Tables may be written to the same or to different table &#9474;files.References: Users Guide IV (NM-TRAN) III.B.164.10. Data Checkout ModeNONMEM&rsquo;s data checkout mode is intended for preliminarydisplay of data without the use of a model. In datacheckout mode, the PRED routine is not called. Predictions,the objective function, residuals, and weighted residualsare not computed. Only the Table and Scatterplot Steps canbe implemented in the problem. With NM-TRAN, this mode isrequested by coding the option CHECKOUT on the $DATA record.A $SUBROUTINES record and abbreviated code are required, butthey have no effect and need only be syntactically correct.References: Users Guide IV (NM-TRAN) III.B.64.11. Obtaining Individual Parameter Estimates -Conditional Estimates of &eta;sWith population data, NONMEM can obtain estimates ofindividual-specific true values of &eta; from any given set ofvalues of &theta;, &Omega;, &Sigma;, and the individual&rsquo;s data. These arecalled conditiona___________ estimates of &eta;. When the conditionalestimates are obtained after estimation is carried out bythe First-Order method, they are referred to as &quot;posthoc&quot;estimates. With NM-TRAN, they are requested by the optionPOSTHOC on the $ESTIMATION record.References: Users Guide IV (NM-TRAN) III.B.144.12. Population Conditional Estimation MethodsNONMEM can obtain conditional estimates of &eta; variables aspart of the computation of population parameter estimates.These are called conditiona___________ estimatio__________ methods________ WithNM-TRAN, such methods are requested by including the optionMETHOD=CONDITIONAL (or METHOD=1) on the $ESTIMATION record.(The option METHOD=ZERO, or METHOD=0, requests theconventional First-Order method and is the default.) Thereare two conditional estimation methods. If NONMEM uses onlyfirst-order approximations, this is the First-Orde___________Conditiona___________ Estimatio__________ Method_______ This has one variation,interaction____________ which takes into account &eta;-&epsilon; interaction and isrequested by the additional option INTERACTION on the$ESTIMATION record. If NONMEM uses a certain second-orderapproximation, this is the Laplacia_________ method, which isrequested by the additional option LAPLACIAN on the$ESTIMATION record. Interaction cannot be specified withthe Laplacian method.Note that this usage of the term CONDITIONAL is differentfrom the usage on the $SCATTERPLOT, $TABLE, and $COVARIANCErecords, in which it refers to the circumstances under whichthe step in question is implemented.References: Users Guide IV (NM-TRAN) III.B.144.13. Displaying PRED-Defined Variables and ConditionalEstimates of &eta;sNONMEM can display PRED-defined variables in table andscatterplots. With NM-TRAN, any variable appearing on theleft-hand side of an assignment statement in abbreviatedcode can be displayed by listing it in a $TABLE or $SCATTERrecord. If the data are population, NONMEM can also displayconditional estimates of &eta;. With NM-TRAN, variables ETA(1),ETA(2), etc., can be simply listed in $TABLE and $SCATTERrecords. When conditional estimation is not performed, thevalues displayed are zero. Displayed values of PRED-defined &#9474;random variables will use conditional estimates of &eta; if theyhave been obtained, otherwise they will be typical values.This feature is available with PREDPP, as well as withuser-written PRED routines. For example, the followingrecords could replace the $ESTIMATION record in Figure 12.2:$ESTIMATION POSTHOC$TABLE ETA(1) EMAXThe $ABBREVIATED record can be used to limit the number ofvariables available for display when the number isexcessive.References: Guide III (Installation) V.2.4References: Guide IV (NM-TRAN) III.B.16-17References: Guide VI (PREDPP) III.J, IV.E4.14. Mixture ModelsA mixtur_______ mode_____ is a model that explicitly assumes that thepopulation consists of two or more sub-populations, eachhaving its own model. For example, with twosub-populations, one might assume that some fraction p ofthe population has one set of typical values of the PKparameters, and the remaining fraction 1-p has another setof typical values. Both sets of typical values and themixing fraction p may be estimated. For each individual,NONMEM also computes an estimate of the number of thesubpopulation of which the individual is a member. The usermust supply a FORTRAN subroutine called MIX or a $MIX block &#9474;of abbreviated code to compute the fractions p and 1-p.References: Users Guide VI (PREDPP) III.L.24.15. PRED Error Return Codes and Error Messages in FilePRDERRA PRED routine can return a PRE____ erro_____ retur______ cod____ (1 or 2)to NONMEM, indicating that it is unable to compute aprediction for a given data record with the current valuesof &theta;&rsquo;s and &eta;&rsquo;s. For example, PREDPP returns error returncode 1 when a basic or additional PK parameter has a valuethat is physically impossible (e.g., a scale parameter whichis zero or negative). Error return codes can also bespecified by the user in user-written code or in abbreviatedcode using the EXIT statement. One reason for doing this isto constrain parameters in order to avoid floating pointmachine interrupts. The PRE____ erro_____ recover________ optio______determines what action NONMEM will take. With NM-TRAN, thePRED error recovery option is either ABORT (which is thedefault) or NOABORT, and is specified on the $ESTIMATION and$THETA records.If an error return code is returned during the Simulation,Covariance, Table or Scatterplot Step, or during computationof the initial value of the objective function, NONMEM willabort. If the error return code is returned during theEstimation or Initial Estimates Step, NONMEM will try toavoid those values of &theta; and &eta; for which the error occurs. Ifthey cannot be avoided, NONMEM&rsquo;s actions depend on the errorreturn code value, as follows:1 If NOABORT is specified on $ESTIM or $THETA, try toavoid the current values of &theta; and &eta;. If ABORT isspecified on $ESTIM or $THETA, then abort.2 Abort in all cases.PRED routines may optionally provide text accompanying theerror return code. NONMEM writes all text associated witherror return codes to a file, PRDERR. The contents of thisfile should always be carefully reviewed.References: Users Guide III (Installation) III.2.1.1References: Users Guide IV (NM-TRAN) IV.A, IV.C.5-6References: Users Guide VI (PREDPP) III.K, IV.F4.16. User-Written SubroutinesAlthough most NONMEM applications can be accomplished usingNM-TRAN abbreviated code, there are cases in whichuser-written FORTRAN subroutines are needed. The$SUBROUTINES record allows the user to specify the names ofuser-written routines that are needed in the NONMEM loadmodule. A user may choose to write his own PRED, PK, ERROR,MODEL, DES, or AES subroutine. Some subroutines that aredistributed with NONMEM are dummy, or &quot;stub&quot; routines, thatdo nothing. Of these, subroutines CCONTR, CONPAR, CONTR,and CRIT can be replaced to obtain an objective functiondifferent from the default. NONMEM subroutine MIX must bereplaced for mixture models. PREDPP subroutine INFN may bereplaced by user-written code. The names of all suchroutines are specified using the identically named optionsof the $SUBROUTINES record, e.g., PRED=subname,CONTR=subname, etc. User-written routines may call otherFORTRAN subroutines, which can be specified for inclusion inthe load module using the option OTHER=subname.With user-written CONTR routines, the NM-TRAN $CONTR recordmay be useful.References: Users Guide IV (NM-TRAN) III.B.4, B.6 &#9474;4.17. PRIOR &#9474;The PRIOR subroutine and $PRIOR record allows a Bayesian &#9474;penalty function to be added to the NONMEM objective &#9474;function. This serves as a constraint on the estimates of &#9474;THETA, OMEGA, and SIGMA and thus as a way for stable &#9474;estimates to be obtained with insufficient data. &#9474;References: Introduction to NONMEM Version VI5. Observations of Two Different TypesAn NM-TRAN control stream is shown in Figure 12.3, for theanalysis of a data set which contains observations of twodifferent types. A fragment of the data set, shown inFigure 12.4, contains the data for one individual. Thisexample illustrates how concentration and effect data can befit simultaneously, and includes many of the advancedfeatures described in this chapter, such as pharmacodynamicmodeling in the $ERROR statements, correlation betweenelements of &Sigma;, and the L2 data item.Suppose that the data set for the phenobarbital example ofChapter 2 is modified to include both concentration andeffect observations, and that a data item called TYPE isused to distinguish between them. When TYPE is 1, DVcontains an effect measurement. When TYPE is 2, DV containsa concentration. The $PK statements are the same as thoseof Figure 2.12. The $ERROR statements are the same as thoseof Figure 12.1, except that the elements of &theta; and &eta; arerenumbered to follow those used in the $PK statements. The &#9474;(random) variable Y1 is assigned the same value as Y in the &#9474;$ERROR statements of Figure 12.1 The (random) variable Y2 isassigned the same value as Y in the $ERROR statements ofFigure 2.12, except that &epsilon;2 is used rather than &epsilon;1.The input data file contains observations of both typeswhich were made at the same time value. The event recordstherefore include the L2 data item. Figure 12.4, likeFigure 2.7, shows the data for the first individual, butincludes TYPE and L2 data items and effect observations.Note that the L2 data item has a different value for eachmultivariate observation within the individual record. (Thevalues 1 and 2 are chosen arbitrarily and may be re-used forthe L2 data items in the next individual&rsquo;s data, ifdesired.)The $THETA, $OMEGA, and $SIGMA records contain the valuesshown in Figures 2.12 and 12.1 and one other value, 2.8, forthe covariance &Sigma;12=cov(&epsilon;1,&epsilon;2). The estimate 2.8 is chosenso that the correlation is, arbitrarily, .5(2.8=&Sigma;12=(&Sigma;11&Sigma;22)2corr=(8&times;4)2.5).$PROBLEM COMBINED PK/PD MODEL$INPUT ID TIME AMT WT APGR DV TYPE L2$DATA COMBDATA$SUBROUTINE ADVAN1$PKTVCL=THETA(1)+THETA(3)*WTCL=TVCL+ETA(1)TVVD=THETA(2)+THETA(4)*WTV=TVVD+ETA(2) ; THE FOLLOWING ARE REQUIRED BY PREDPPK=CL/VS1=V$ERROREMAX=THETA(5)+ETA(3)C50=THETA(6)+ETA(4)E=EMAX*F/(C50+F)Y1=E+ERR(1)Y2=F+ERR(2)Q=1IF (TYPE.EQ.2) Q=0Y=Q*Y1+(1-Q)*Y2$THETA (0,.0027) (0,.70) .0018 .5 100 20$OMEGA .000007 .3 400 16$SIGMA BLOCK(2) 4 2.8 8$ESTIMATIONFigure 12.3. The input to NONMEM-PREDPP for analysis of thepopulation phenobarbital data, including both concentrationand effect observations.1 0. 25.0 1.4 7 . 2 01 2.0 . 1.4 7 6.0 1 11 2.0 . 1.4 7 17.3 2 11 12.5 3.5 1.4 7 . 2 01 24.5 3.5 1.4 7 . 2 11 37.0 3.5 1.4 7 . 2 01 48.0 3.5 1.4 7 . 2 11 60.5 3.5 1.4 7 . 2 01 72.5 3.5 1.4 7 . 2 11 85.3 3.5 1.4 7 . 2 01 96.5 3.5 1.4 7 . 2 11 108.5 3.5 1.4 7 . 2 01 112.5 . 1.4 7 8.0 1 21 112.5 . 1.4 7 31.0 2 2Figure 12.4. The first individual&rsquo;s phenobarbital data,including both concentration and effect observations.The above $ERROR statements can be coded more simply. &#9474;$ERROR &#9474;EMAX=THETA(5)+ETA(3) &#9474;C50=THETA(6)+ETA(4) &#9474;E=EMAX*F/(C50+F) &#9474;IF (TYPE.EQ.2) THEN &#9474;Y=F+ERR(2) &#9474;ELSE &#9474;Y=E+ERR(1) &#9474;ENDIF &#9474;Figure 12.5. Alternate $ERROR statements &#9474;6. NONMEM 7 &#9474;With NONMEM 7 there are many new features, including new &#9474;Estimation Methods. A description is beyond the scope of &#9474;this guide. &#9474;References: Introduction to NONMEM 7"></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Chapter 13 -
Errors in NONMEM Runs</b></p>

<h2>1. What This Chapter is AboutThis chapter describes error messages that can appear inNONMEM&rsquo;s output and discusses some possible causes andremedies. It is not encyclopedic; only selected messagesare discussed. NM-TRAN messages are meant to beself-explanatory, as are many PREDPP messages, and importantNONMEM messages are documented in NONMEM Users Guide, PartI, Chapter G. Unlike certain other regression programs,NONMEM-PREDPP will not try to mask what is perceived as areal problem and to which attention must be given by theuser before the computation can proceed; an error messageresults and often, the program terminates.The Estimation and Covariance Steps do not always terminatesuccessfully. This is a normal part of the process of modelbuilding.2. Abnormal Termination of the Estimation StepNormal termination of the Estimation Step is indicated bythe message:MINIMIZATION SUCCESSFULEven when this message is seen, it is possible that theEstimation Step has not run correctly. Final estimatesshould be different from initial estimates. If the initialand final estimates are the same and the gradients for aparameter are zero at every iteration&dagger;, this is a sign of amodelling error. The parameter does not affect anypredictions, as discussed in Chapter 7, Section 4.2. Ifthere were bounds, estimates should be well away from thebounds. A final estimate which is close to a bound isdiscussed in Chapter 11, Section 4.3.<cite>&dagger; A gradient may reach zero at or near the final iteration;this is not an error. Note also that no gradient iscomputed or printed for a parameter whose value is fixed, soif a gradient is always zero, it is not for this reason. </cite>Abnormal termination of the Estimation Step is indicated bya message whose first line is:MINIMIZATION TERMINATEDOne of several messages will follow, indicating the type offailure. The messages are listed in Users Guide I.Two of the most common are discussed here separately.2.1. &quot;DUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED&quot;If after any iteration the total number of evaluations ofthe objective function (Chapter 10, figure 10.5, line 33) isequal to or greater than the maximum allowed (Chapter 10,figure 10.2, line 51), the minimization search is haltedwith this message. If the $ESTIMATION record requested thata Model Specification File be written, it is possible tocontinue the search from this point in a subsequent NONMEMrun. In Chapter 12, Section 4.3, a strategy is discussed bywhich the number of function evaluations is deliberately setto a low value in order to structure a lengthy run as aseries of shorter runs.Whenever this message is obtained, it is important toexamine the intermediate output and evaluate the progressmade so far. A poorly-specified model, for example, maycause very slow convergence of the minimization search.Raising the maximum number of function evaluations (usingthe MAXEVAL option of the $ESTIMATION record) may not beadvisable.2.2. &quot;DUE TO ROUNDING ERRORS (ERROR=134)&quot;This message will be accompanied in the intermediate outputby a message beginning: NUMSIGDIG: .... which gives theapproximate number of significant digits obtained in each ofthe parameters being estimated. At least one such numberwill be less than the number requested.The number of significant digits obtained should beexamined. If it is at least 2, and the gradient vectorappears stable throughout the last few iterations, asatisfactory minimum may well have been obtained. (It maybe desirable to re-run the problem with the print intervalfor iteration summarization set to 1 (PRINT=1 in the$ESTIMATION record) so that the progress made at everyiteration can be examined.) The final parameter estimatesshould be examined, and if they appear reasonable, theymight be accepted. Although the user may have requestedmore than 2 significant digits, the data may only supportabout 2 digits, given the precision of the arithmetic beingused. By examining the gradients carefully, it is oftenpossible to obtain further information about which parameterestimates are less-well determined.Even though the final parameter estimates may be adequate,it is unlikely that the minimum is sufficientlywell-determined to allow the Covariance Step to runsuccessfully, at least with the number of significantfigures requested in the Estimation Step. The EstimationStep may need to be rerun, requesting only 2 significantfigures, followed by the Covariance Step.If the number of significant digits is less than 2 (or evennegative), then the final estimates should not be trusted.The problem may be model misspecification or insufficientdata.Model misspecification is a very general problem involvingsome mismatch between the model and the data. This canresult in particularly large values of the objectivefunction or slow convergence of the minimization search.Sometimes the model is overparameterized. This means thatthe model has more parameters than can be well-enoughestimated from the data (e.g., a biexponential model is fitto monoexponential data). When model misspecificationoccurs due to over-parameterization, then the EstimationStep will usually proceed smoothly, but terminate with fewerthan 2 significant digits. It is best to start with simplemodels (see Chapter 11).A related problem arises when a covariance element, e.g.,&Omega;12 (or &Sigma;12), is being estimated. If the ID (or L2 dataitem) is not used correctly, it may appear as though thecovariance does not affect objective function values, andthen this parameter will not be well estimated. In otherwords, it may appear as though the model isoverparameterized due to the inclusion of this parameter.See Chapter 12, Section 4.2.3. Abnormal Termination of the Covariance StepIt is possible for the Estimation Step to terminatesuccessfully, and yet the Covariance Step generates an errormessage. Error messages from the Covariance Step areprinted immediately after line 46 of Figure 10.5. Themessages are listed in Users Guide I.When a message arises, often it is:R MATRIX ALGORITHMICALLY NON-POSITIVE-SEMIDEFINITEBUT NONSINGULARCOVARIANCE STEP ABORTEDIn order for the minimization routine to terminatesuccessfully, it needs to determine that the final gradientvector is sufficiently small, which is a necessary conditionfor a minimum to have been achieved. This condition,however, is not sufficient. A sufficient condition, thatthe R matrix be positive definite (and therefore, that theapparent minimum not be a saddle point) is only checked inthe Covariance Step. The message means that the sufficientcondition appears not to be satisfied. The final estimateis, therefore, in doubt.Sometimes the message is:R MATRIX ALGORITHMICALLY SINGULARCOVARIANCE STEP UNOBTAINABLES MATRIX ALGORITHMICALLY SINGULARThis arises when there exists a parameter whose values donot actually affect the predictions and whose gradient inthe intermediate output is always 0.In general, successful completion of the Covariance Steprequires a better defined minimum than does the successfulcompletion of the Estimation Step.4. Miscellaneous ProblemsThis section discusses a few simple errors which preventNONMEM-PREDPP from running successfully.4.1. Proportional Error ModelA common error is to use the proportional error model whilesome predicted values for actual observations are zero orclose to zero. (For example, if the first dose is aninfusion and there is a &quot;baseline&quot; observation at the startof the infusion, the predicted level will be zero.)With individual data this will lead to an error messagesimilar to the following (the individual number may bedifferent from 1):PROGRAM TERMINATED BY OBJ, ERROR IN ELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)VAR-COV OF DATA FROM INDIVIDUAL RECORD ESTIMATED TO BE SINGULARWith population data this will lead to an error messagesimilar to the following (the individual and record numbersmay be different than 1):PROGRAM TERMINATED BY OBJ, ERROR IN CELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)INTRAINDIVIDUAL VARIANCE OF DATA FROM OBS RECORD 1 ESTIMATED TO BE 04.2. Errors in the Pharmacokinetic ModelWhen using a new model, a run should done in which theEstimation Step is not run, and a scatterplot of PRED vs DVwith unit slope line is produced, to verify that the modeland the initial parameter estimates are reasonable. It ismuch harder to diagnose errors in the model or the initialestimates after the Estimation Step fails. Make sure thatthe initial value of the objective function is notexcessively large, and that the unit slope line shows on theplot: scaling errors can easily go undetected! E.g., if theunits are incorrect at some point in the model (L vs ml),the predictions may be wrong by a factor of 1000.Similarly, if no scale was specified for the compartmentbeing observed, the predictions for the observations arecompartment amounts rather than concentrations. In bothcases, the shape of the PRED vs DV plot may appear linear,but the axes may be labeled quite differently. Whenobservations from two different compartments are present inthe data (e.g., Cp and Cu), some of the observations may bescaled incorrectly. This is discussed in Chapter 6, Section9, and Chapter 7, Section 4.3.3.5. Errors with PREDPP5.1. Error Messages from a TRANS RoutineTRANS routines can produce error messages. Here is one fromTRANS2:ERROR IN TRANS2 ROUTINE: V IS ZEROAppendix 2 shows that TRANS2 normally computes K=CL/V. Theroutine checks that V is not zero, and upon finding that itis, it prints the informative message, and terminates therun (thus avoiding a machine &quot;division by zero&quot; interrupt bythe operating system). This error usually occurs with theinitial parameter estimates. E.g., suppose the relevant $PKstatement is:V=THETA(1)+WT*THETA(2)For some values of &theta;1, &theta;2, and WT, a value of zero is beingcomputed for V. The initial estimates of &theta;1 and &theta;2 shouldbe checked. The intercept &theta;1 might have been fixed to zero,in which case then, the values of WT should also be checked.If WT is recorded only on the first event record of eachindividual&rsquo;s data, careful coding is required to insure thata value of zero is not used when the $PK record is evaluatedwith subsequent event records.5.2. Error Messages from ADVAN RoutinesA similar error message can be generated in PREDPP, e.g.PK PARAMETER FOR OBSERVATION COMPARTMENT&rsquo;S SCALE IS ZEROSome scale parameter is modeled in such a way as to producea zero. Again, the code for that scale parameter, and theinitial estimates for the &theta;&rsquo;s used therein, should bechecked. Perhaps the scale parameter is being set equal toa volume parameter, and as described above, the volumeparameter is being set to zero. When TRANS1 is used, thevolume parameter is neither recognized nor checked.5.3. Numeric difficulties in PREDPPNumeric difficulties can occur with linear pharmacokineticmodels (e.g., ADVAN1-4) in the process of computing certainexponentials. They can occur from an error in the units ofeither a rate constant and/or the TIME data items. They canalso occur from inordinately large values for a rateconstant which arise during the minimization search. Thismight be avoided by placing appropriate constraints on &theta;&rsquo;s.They can also occur when the system is advanced over anexcessively long period of time. This can happen within anindividual record, when the individual had a course of drugtreatment, followed by a wash-out period, followed byanother course of drug treatment. The first dose record oftreatment courses other than the first should have EVID dataitem equal to 4 (reset-dose) rather than 1 (dose), to avoidcomputing excessively small compartment amounts (see Chapter6, Section 7.3), and to reduce computational cost.Difficulties can occur in the process of computingpredictions with ADVAN2 and ADVAN4 when values of KA and Karise during the minimization search that are very close toone another. The models encoded into the ADVAN routinesassume that KA and K have fairly distinct values, and theformulas for the predictions have the term KA-K in thedenominator. If, for example, the typical values of K andKA are associated with &theta;1 and &theta;2, respectively, then onemight try reparameterizing. The typical values of K and KA-Kcan be associated with &theta;1 and &theta;2, so that K=&theta;1 and KA=K+&theta;2.A lower bound of zero should be placed on &theta;2&dagger;.<cite>&dagger; This technique also prevents a &quot;flip-flop&quot; from occurring.(In the original parameterization, the final estimates of &theta;1and &theta;2 can be the final estimates of the typical values ofKA and K, respectively). </cite>A similar situation occurs with TRANS3, where VSS-V occursin the denominator of the expression for K21. As above,reparameterization and a constraint on an element of &theta; mayhelp.
<a name="1. What This Chapter is AboutThis chapter describes error messages that can appear inNONMEM&rsquo;s output and discusses some possible causes andremedies. It is not encyclopedic; only selected messagesare discussed. NM-TRAN messages are meant to beself-explanatory, as are many PREDPP messages, and importantNONMEM messages are documented in NONMEM Users Guide, PartI, Chapter G. Unlike certain other regression programs,NONMEM-PREDPP will not try to mask what is perceived as areal problem and to which attention must be given by theuser before the computation can proceed; an error messageresults and often, the program terminates.The Estimation and Covariance Steps do not always terminatesuccessfully. This is a normal part of the process of modelbuilding.2. Abnormal Termination of the Estimation StepNormal termination of the Estimation Step is indicated bythe message:MINIMIZATION SUCCESSFULEven when this message is seen, it is possible that theEstimation Step has not run correctly. Final estimatesshould be different from initial estimates. If the initialand final estimates are the same and the gradients for aparameter are zero at every iteration&dagger;, this is a sign of amodelling error. The parameter does not affect anypredictions, as discussed in Chapter 7, Section 4.2. Ifthere were bounds, estimates should be well away from thebounds. A final estimate which is close to a bound isdiscussed in Chapter 11, Section 4.3.<cite>&dagger; A gradient may reach zero at or near the final iteration;this is not an error. Note also that no gradient iscomputed or printed for a parameter whose value is fixed, soif a gradient is always zero, it is not for this reason. </cite>Abnormal termination of the Estimation Step is indicated bya message whose first line is:MINIMIZATION TERMINATEDOne of several messages will follow, indicating the type offailure. The messages are listed in Users Guide I.Two of the most common are discussed here separately.2.1. &quot;DUE TO MAX. NO. OF FUNCTION EVALUATIONS EXCEEDED&quot;If after any iteration the total number of evaluations ofthe objective function (Chapter 10, figure 10.5, line 33) isequal to or greater than the maximum allowed (Chapter 10,figure 10.2, line 51), the minimization search is haltedwith this message. If the $ESTIMATION record requested thata Model Specification File be written, it is possible tocontinue the search from this point in a subsequent NONMEMrun. In Chapter 12, Section 4.3, a strategy is discussed bywhich the number of function evaluations is deliberately setto a low value in order to structure a lengthy run as aseries of shorter runs.Whenever this message is obtained, it is important toexamine the intermediate output and evaluate the progressmade so far. A poorly-specified model, for example, maycause very slow convergence of the minimization search.Raising the maximum number of function evaluations (usingthe MAXEVAL option of the $ESTIMATION record) may not beadvisable.2.2. &quot;DUE TO ROUNDING ERRORS (ERROR=134)&quot;This message will be accompanied in the intermediate outputby a message beginning: NUMSIGDIG: .... which gives theapproximate number of significant digits obtained in each ofthe parameters being estimated. At least one such numberwill be less than the number requested.The number of significant digits obtained should beexamined. If it is at least 2, and the gradient vectorappears stable throughout the last few iterations, asatisfactory minimum may well have been obtained. (It maybe desirable to re-run the problem with the print intervalfor iteration summarization set to 1 (PRINT=1 in the$ESTIMATION record) so that the progress made at everyiteration can be examined.) The final parameter estimatesshould be examined, and if they appear reasonable, theymight be accepted. Although the user may have requestedmore than 2 significant digits, the data may only supportabout 2 digits, given the precision of the arithmetic beingused. By examining the gradients carefully, it is oftenpossible to obtain further information about which parameterestimates are less-well determined.Even though the final parameter estimates may be adequate,it is unlikely that the minimum is sufficientlywell-determined to allow the Covariance Step to runsuccessfully, at least with the number of significantfigures requested in the Estimation Step. The EstimationStep may need to be rerun, requesting only 2 significantfigures, followed by the Covariance Step.If the number of significant digits is less than 2 (or evennegative), then the final estimates should not be trusted.The problem may be model misspecification or insufficientdata.Model misspecification is a very general problem involvingsome mismatch between the model and the data. This canresult in particularly large values of the objectivefunction or slow convergence of the minimization search.Sometimes the model is overparameterized. This means thatthe model has more parameters than can be well-enoughestimated from the data (e.g., a biexponential model is fitto monoexponential data). When model misspecificationoccurs due to over-parameterization, then the EstimationStep will usually proceed smoothly, but terminate with fewerthan 2 significant digits. It is best to start with simplemodels (see Chapter 11).A related problem arises when a covariance element, e.g.,&Omega;12 (or &Sigma;12), is being estimated. If the ID (or L2 dataitem) is not used correctly, it may appear as though thecovariance does not affect objective function values, andthen this parameter will not be well estimated. In otherwords, it may appear as though the model isoverparameterized due to the inclusion of this parameter.See Chapter 12, Section 4.2.3. Abnormal Termination of the Covariance StepIt is possible for the Estimation Step to terminatesuccessfully, and yet the Covariance Step generates an errormessage. Error messages from the Covariance Step areprinted immediately after line 46 of Figure 10.5. Themessages are listed in Users Guide I.When a message arises, often it is:R MATRIX ALGORITHMICALLY NON-POSITIVE-SEMIDEFINITEBUT NONSINGULARCOVARIANCE STEP ABORTEDIn order for the minimization routine to terminatesuccessfully, it needs to determine that the final gradientvector is sufficiently small, which is a necessary conditionfor a minimum to have been achieved. This condition,however, is not sufficient. A sufficient condition, thatthe R matrix be positive definite (and therefore, that theapparent minimum not be a saddle point) is only checked inthe Covariance Step. The message means that the sufficientcondition appears not to be satisfied. The final estimateis, therefore, in doubt.Sometimes the message is:R MATRIX ALGORITHMICALLY SINGULARCOVARIANCE STEP UNOBTAINABLES MATRIX ALGORITHMICALLY SINGULARThis arises when there exists a parameter whose values donot actually affect the predictions and whose gradient inthe intermediate output is always 0.In general, successful completion of the Covariance Steprequires a better defined minimum than does the successfulcompletion of the Estimation Step.4. Miscellaneous ProblemsThis section discusses a few simple errors which preventNONMEM-PREDPP from running successfully.4.1. Proportional Error ModelA common error is to use the proportional error model whilesome predicted values for actual observations are zero orclose to zero. (For example, if the first dose is aninfusion and there is a &quot;baseline&quot; observation at the startof the infusion, the predicted level will be zero.)With individual data this will lead to an error messagesimilar to the following (the individual number may bedifferent from 1):PROGRAM TERMINATED BY OBJ, ERROR IN ELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)VAR-COV OF DATA FROM INDIVIDUAL RECORD ESTIMATED TO BE SINGULARWith population data this will lead to an error messagesimilar to the following (the individual and record numbersmay be different than 1):PROGRAM TERMINATED BY OBJ, ERROR IN CELSWITH INDIVIDUAL 1 (IN INDIVIDUAL RECORD ORDERING)INTRAINDIVIDUAL VARIANCE OF DATA FROM OBS RECORD 1 ESTIMATED TO BE 04.2. Errors in the Pharmacokinetic ModelWhen using a new model, a run should done in which theEstimation Step is not run, and a scatterplot of PRED vs DVwith unit slope line is produced, to verify that the modeland the initial parameter estimates are reasonable. It ismuch harder to diagnose errors in the model or the initialestimates after the Estimation Step fails. Make sure thatthe initial value of the objective function is notexcessively large, and that the unit slope line shows on theplot: scaling errors can easily go undetected! E.g., if theunits are incorrect at some point in the model (L vs ml),the predictions may be wrong by a factor of 1000.Similarly, if no scale was specified for the compartmentbeing observed, the predictions for the observations arecompartment amounts rather than concentrations. In bothcases, the shape of the PRED vs DV plot may appear linear,but the axes may be labeled quite differently. Whenobservations from two different compartments are present inthe data (e.g., Cp and Cu), some of the observations may bescaled incorrectly. This is discussed in Chapter 6, Section9, and Chapter 7, Section 4.3.3.5. Errors with PREDPP5.1. Error Messages from a TRANS RoutineTRANS routines can produce error messages. Here is one fromTRANS2:ERROR IN TRANS2 ROUTINE: V IS ZEROAppendix 2 shows that TRANS2 normally computes K=CL/V. Theroutine checks that V is not zero, and upon finding that itis, it prints the informative message, and terminates therun (thus avoiding a machine &quot;division by zero&quot; interrupt bythe operating system). This error usually occurs with theinitial parameter estimates. E.g., suppose the relevant $PKstatement is:V=THETA(1)+WT*THETA(2)For some values of &theta;1, &theta;2, and WT, a value of zero is beingcomputed for V. The initial estimates of &theta;1 and &theta;2 shouldbe checked. The intercept &theta;1 might have been fixed to zero,in which case then, the values of WT should also be checked.If WT is recorded only on the first event record of eachindividual&rsquo;s data, careful coding is required to insure thata value of zero is not used when the $PK record is evaluatedwith subsequent event records.5.2. Error Messages from ADVAN RoutinesA similar error message can be generated in PREDPP, e.g.PK PARAMETER FOR OBSERVATION COMPARTMENT&rsquo;S SCALE IS ZEROSome scale parameter is modeled in such a way as to producea zero. Again, the code for that scale parameter, and theinitial estimates for the &theta;&rsquo;s used therein, should bechecked. Perhaps the scale parameter is being set equal toa volume parameter, and as described above, the volumeparameter is being set to zero. When TRANS1 is used, thevolume parameter is neither recognized nor checked.5.3. Numeric difficulties in PREDPPNumeric difficulties can occur with linear pharmacokineticmodels (e.g., ADVAN1-4) in the process of computing certainexponentials. They can occur from an error in the units ofeither a rate constant and/or the TIME data items. They canalso occur from inordinately large values for a rateconstant which arise during the minimization search. Thismight be avoided by placing appropriate constraints on &theta;&rsquo;s.They can also occur when the system is advanced over anexcessively long period of time. This can happen within anindividual record, when the individual had a course of drugtreatment, followed by a wash-out period, followed byanother course of drug treatment. The first dose record oftreatment courses other than the first should have EVID dataitem equal to 4 (reset-dose) rather than 1 (dose), to avoidcomputing excessively small compartment amounts (see Chapter6, Section 7.3), and to reduce computational cost.Difficulties can occur in the process of computingpredictions with ADVAN2 and ADVAN4 when values of KA and Karise during the minimization search that are very close toone another. The models encoded into the ADVAN routinesassume that KA and K have fairly distinct values, and theformulas for the predictions have the term KA-K in thedenominator. If, for example, the typical values of K andKA are associated with &theta;1 and &theta;2, respectively, then onemight try reparameterizing. The typical values of K and KA-Kcan be associated with &theta;1 and &theta;2, so that K=&theta;1 and KA=K+&theta;2.A lower bound of zero should be placed on &theta;2&dagger;.<cite>&dagger; This technique also prevents a &quot;flip-flop&quot; from occurring.(In the original parameterization, the final estimates of &theta;1and &theta;2 can be the final estimates of the typical values ofKA and K, respectively). </cite>A similar situation occurs with TRANS3, where VSS-V occursin the denominator of the expression for K21. As above,reparameterization and a constraint on an element of &theta; mayhelp."></a>
</h2>


<p align="center" style="margin-top: 1em"><b>Appendix 1 -
Standard Pharmacokinetic Models and Parameters</b></p>

<p><small>ADVAN Compartments Basic and additional PK
parameters <br>
ADVAN1 1 = Central K Rate constant of elimination <br>
2 = Output S1 Scale for central compartment <br>
S2 Scale for output compartment <br>
F1 Bioavailability for central compartment <br>
F0 Output Fraction <br>
ADVAN2 1 = Depot KA Absorption rate constant <br>
2 = Central K Rate constant of elimination <br>
3 = Output S1 Scale for depot compartment <br>
S2 Scale for central compartment <br>
S3 Scale for output compartment <br>
F1 Bioavailability for depot compartment <br>
F2 Bioavailability for central compartment <br>
F0 Output Fraction <br>
ADVAN3 1 = Central K Rate constant of elimination <br>
2 = Peripheral K12 Rate constant from central to peripheral
<br>
3 = Output K21 Rate constant from peripheral to central <br>
S1 Scale for central compartment <br>
S2 Scale for peripheral compartment <br>
S3 Scale for output compartment <br>
F1 Bioavailability for central compartment <br>
F2 Bioavailability for peripheral compartment <br>
F0 Output Fraction <br>
ADVAN4 1 = Depot KA Absorption rate constant <br>
2 = Central K Rate constant of elimination <br>
3 = Peripheral K23 Rate constant from central to peripheral
<br>
4 = Output K32 Rate constant from peripheral to central <br>
S1 Scale for depot compartment <br>
S2 Scale for central compartment <br>
S3 Scale for peripheral compartment <br>
S4 Scale for output compartment <br>
F1 Bioavailability for depot compartment <br>
F2 Bioavailability for central compartment <br>
F3 Bioavailability for peripheral compartment <br>
F0 Output Fraction <br>
ADVAN10 1 = Central VM Maximum Rate <br>
2 = Output KM Michaelis Constant <br>
S1 Scale for central compartment <br>
S2 Scale for output compartment <br>
F1 Bioavailability for central compartment <br>
F0 Output Fraction</small></p>

<p>ADVAN Compartments Basic and additional PK parameters
<br>
ADVAN11 1 = Central K Rate constant of elimination <br>
2 = Peripheral 1 K12 Rate constant from central to periph. 1
<br>
3 = Peripheral 2 K21 Rate constant from periph. 1 to central
<br>
4 = Output K13 Rate constant from central to periph. 2 <br>
K31 Rate constant from periph. 2 to central <br>
S1 Scale for central compartment <br>
S2 Scale for peripheral 1 compartment <br>
S3 Scale for peripheral 2 compartment <br>
S4 Scale for output compartment <br>
F1 Bioavailability for central compartment <br>
F2 Bioavailability for periph. 1 compartment <br>
F3 Bioavailability for periph. 2 compartment <br>
F0 Output Fraction <br>
ADVAN12 1 = Depot KA Absorption rate constant <br>
2 = Central K Rate constant of elimination <br>
3 = Peripheral 1 K23 Rate constant from central to periph. 1
<br>
4 = Peripheral 2 K32 Rate constant from periph. 1 to central
<br>
5 = Output K24 Rate constant from central to periph. 2 <br>
K42 Rate constant from periph. 2 to central <br>
S1 Scale for depot compartment <br>
S2 Scale for central compartment <br>
S3 Scale for peripheral 1 compartment <br>
S4 Scale for peripheral 2 compartment <br>
S5 Scale for output compartment <br>
F1 Bioavailability for depot compartment <br>
F2 Bioavailability for central compartment <br>
F3 Bioavailability for periph. 1 compartment <br>
F4 Bioavailability for periph. 2 compartment <br>
F0 Output Fraction</p>

<p align="center"><b>Appendix 2 - Alternative
Parameterizations</b></p>

<p><small>Alternative Parameters Reparameterization Lines
<b><br>
ADVAN1 TRANS2</b> <br>
CL <small>Clearance <small>K=CL/V</small> <br>
V <small>Volume of distribution</small> <b><br>
ADVAN2 TRANS2</b> <br>
CL <small>Clearance <small>K=CL/V</small> <br>
V <small>Volume of distribution <small>KA=KA</small> <br>
KA <small>Absorption rate</small> <b><br>
ADVAN3 TRANS3</b> <br>
CL <small>Clearance <small>K=CL/V</small> <br>
V <small>Central Volume <small>K12=Q/V</small> <br>
Q <small>Intercompartmental clearance
<small>K21=Q/(VSS-V)</small> <br>
VSS <small>Volume of distribution at steady state</small>
<b><br>
ADVAN3 TRANS4</b> <br>
CL <small>Clearance <small>K=CL/V1</small> <br>
V1 <small>Central volume <small>K12=Q/V1</small> <br>
Q <small>Intercompartmental clearance
<small>K21=Q/V2</small> <br>
V2 <small>Peripheral volume</small> <b><br>
ADVAN3 TRANS5</b> <br>
AOB <small>A/B <small>K21=(AOB*BETA+ALPHA)/(AOB+1)</small>
<br>
ALPHA <small>alpha <small>K=ALPHA*BETA/K21</small> <br>
BETA <small>beta <small>K12=ALPHA+BETA-K21-K</small> <b><br>
ADVAN3 TRANS6</b> <br>
ALPHA <small>alpha <small>K=ALPHA*BETA/K21</small> <br>
BETA <small>beta <small>K12=ALPHA+BETA-K21-K</small> <br>
K21 <small>Rate constant from periph. to central
<small>K21=K21</small> <b><br>
ADVAN4 TRANS3</b> <br>
CL <small>Clearance <small>K=CL/V</small> <br>
V <small>Central Volume <small>K23=Q/V</small> <br>
Q <small>Intercompartmental clearance
<small>K32=Q/(VSS-V)</small> <br>
VSS <small>Volume of distribution at steady state
<small>KA=KA</small> <br>
KA <small>Absorption rate</small> <b><br>
ADVAN4 TRANS4</b> <br>
CL <small>Clearance <small>K=CL/V2</small> <br>
V2 <small>Central volume <small>K23=Q/V2</small> <br>
Q <small>Intercompartmental clearance
<small>K32=Q/V3</small> <br>
V3 <small>Peripheral volume <small>KA=KA</small> <br>
KA <small>Absorption
rate</small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></p>

<p><b>ADVAN4 TRANS5</b> <br>
AOB <small>A/B <small>K32=(AOB*BETA+ALPHA)/(AOB+1)</small>
<br>
ALPHA <small>alpha <small>K=ALPHA*BETA/K32</small> <br>
BETA <small>beta <small>K23=ALPHA+BETA-K32-K</small> <br>
KA <small>Absorption rate <small>KA=KA</small> <b><br>
ADVAN4 TRANS6</b> <br>
ALPHA <small>alpha <small>K=ALPHA*BETA/K32</small> <br>
BETA <small>beta <small>K23=ALPHA+BETA-K32-K</small> <br>
K32 <small>Rate constant from periph. to central
<small>K32=K32</small> <br>
KA <small>Absorption rate <small>KA=KA</small> <b><br>
ADVAN11 TRANS4</b> <br>
CL <small>Clearance <small>K=CL/V1</small> <br>
V1 <small>Central volume <small>K12=Q2/V1</small> <br>
Q2 <small>Intercompartmental clearance 1
<small>K21=Q2/V2</small> <br>
V2 <small>Peripheral volume 1 <small>K13=Q3/V1</small> <br>
Q3 <small>Intercompartmental clearance 2
<small>K31=Q3/V3</small> <br>
V3 <small>Peripheral volume 2 <small>V3=V3</small> <b><br>
ADVAN11 TRANS6</b> <br>
ALPHA <small>alpha
<small>K=ALPHA*BETA*GAMMA/(K21*K31)</small> <br>
BETA <small>beta <small>V1=ALPHA+BETA+GAMMA</small> <br>
GAMMA <small>gamma <small>V2=ALPHA*BETA+ALPHA*GAMMA</small>
<br>
K21 <small>Rate constant from periph. 1 to central
<small>+BETA*GAMMA</small> <br>
K31 <small>Rate constant from periph. 2 to central
<small>K13=(V2+K31*K31-K31*V1-K*K21)/(K21-K31) <br>
K12=V1-K-K13-K21-K31</small> <b><br>
ADVAN12 TRANS4</b> <br>
CL <small>Clearance <small>K=CL/V2</small> <br>
V2 <small>Central volume <small>K23=Q3/V2</small> <br>
Q3 <small>Intercompartmental clearance 1
<small>K32=Q3/V3</small> <br>
V3 <small>Peripheral volume 1 <small>K24=Q4/V2</small> <br>
Q4 <small>Intercompartmental clearance 2
<small>K42=Q4/V4</small> <br>
V4 <small>Peripheral volume 2 <small>V4=V4</small> <br>
KA <small>Absorption rate <small>KA=KA</small> <b><br>
ADVAN12 TRANS6</b> <br>
ALPHA <small>alpha
<small>K=ALPHA*BETA*GAMMA/(K32*K42)</small> <br>
BETA <small>beta <small>V2=ALPHA+BETA+GAMMA</small> <br>
GAMMA <small>gamma <small>V3=ALPHA*BETA+ALPHA*GAMMA</small>
<br>
K32 <small>Rate constant from periph. 1 to central
<small>+BETA*GAMMA</small> <br>
K42 <small>Rate constant from periph. 2 to central
<small>K24=(V3+K42*K42-K42*V2-K*K32)/(K32-K42) <br>
K23=V2-K-K24-K32-K42</small> <br>
KA <small>Absorption rate
<small>KA=KA</small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></small></p>

<p align="center"><b>Appendix 3 - NM-TRAN Control
Records</b></p>

<p><small><small>The following is an alphabetic list of
NM-TRAN control records. <br>
See Guide VIII, On-line Help, or On-line HTML for the
options and for more information.</small></small></p>

<pre style="margin-top: 1em"><b>$ABBREVIATED
$AES
$AESINIT
$BIND
$CHAIN
$CONTR
$COVARIANCE
$DATA
$DES
$ERROR
$ESTIMATION
$INDEX
$INFN
$INPUT
$MIX
$MODEL
$MSFI
$NONPARAMETRIC
$OMEGA
$OMIT
$PK
$PRED
$PRIOR
$PROBLEM
$SCATTER
$SIGMA
$SIMULATION
$SIZES
$SUBROUTINES
$SUPER
$TABLE
$THETA
$TOL
$WARNING</b></pre>



<p style="margin-top: 1em">/home/bauerr/DOCS.dir/makeindex2_home/index.head</p>

<h2>INDEX
<a name="INDEX"></a>
</h2>


<p style="margin-top: 1em"><small>2000 52</small></p>

<h2>- A -
<a name="- A -"></a>
</h2>


<p style="margin-top: 1em"><big>&alpha;</big> <small>-level
test 47 <br>
abbreviated code 5, 9 <br>
$ABBREVIATED record 138 <br>
ABORT 139 <br>
absorption, first-order 7 <br>
Absorption lag parameter 130 <br>
absorption rate KA 9 <br>
additional dose 71 <br>
additional PK parameter 53, 69 <br>
additive error model 25, 36, 40, 81, 86 <br>
ADDL data item 130 <br>
ADVAN13 129 <br>
ADVAN1 12 <br>
ADVAN2 8 <br>
ADVAN5-9 129 <br>
ADVAN 4, 68 <br>
advance 34, 68, 71 <br>
$AES record 129 <br>
AES subroutine 128 <br>
ALAGn 130 <br>
AMT data item 55-56 <br>
ANSI FORTRAN 3 <br>
assay 28 <br>
assay, bias of 24</small></p>

<h2>- B -
<a name="- B -"></a>
</h2>


<p style="margin-top: 1em"><small>basic PK parameter 53, 69
<br>
bias of assay 24 <br>
bias of estimate 42 <br>
$BIND record 131 <br>
bioavailability 57-60, 69, 75 <br>
BLOCK option of $OMEGA record 133 <br>
BLOCK option of $SIGMA record 133 <br>
bolus dose, instantaneous 57 <br>
bolus dose, multiple 58 <br>
bolus dose, zero-order 130</small></p>

<h2>- C -
<a name="- C -"></a>
</h2>


<p style="margin-top: 1em"><small>calendar date 64 <br>
CALL data item 56, 71, 80, 132 <br>
calling protocol phrase 131-132 <br>
call to ERROR subroutine 56, 131 <br>
call to PK subroutine 56, 131 <br>
CCONTR subroutine 139 <br>
CCV error model 26, 36, 40, 81, 86 <br>
central compartment 8, 68 <br>
CHECKOUT option of $DATA record 137 <br>
checkpoint-restart 135 <br>
chi-square 47 <br>
CI 43, 125 <br>
CL, clearance 12, 23 <br>
clearance CL 12, 23 <br>
clock time 55, 63, 66 <br>
CMT data item 55, 68 <br>
coefficient of variation 26 <br>
colon &quot;:&quot; in II data item 66 <br>
colon &quot;:&quot; in TIME data item 63 <br>
command, operating system 4 <br>
compartment, central 8, 68 <br>
compartment 8 <br>
compartment, default dose 8, 68-69 <br>
compartment, depot 8, 58, 69 <br>
compartment, dose 56-57 <br>
compartment, equilibrium 129 <br>
compartment number 55, 68, 89 <br>
compartment, output 24, 56, 58, 62, 69 <br>
compartment, prediction 56 <br>
compartment, zero-out a 69 <br>
concentration 22 <br>
concentration, plasma 7, 24, 29, 34 <br>
concentration, urine 24, 29, 34, 37, 62 <br>
concomitant data 53 <br>
conditional estimate 137 <br>
conditional estimation method 138 <br>
conditional estimation method, first-order 138 <br>
CONDITIONAL option of $COVARIANCE record 136 <br>
CONDITIONAL option of $SCATTERPLOT record 88 <br>
CONDITIONAL option of $TABLE record 88 <br>
conditional statement 74 <br>
confidence interval 43-44, 125 <br>
CONPAR subroutine 139 <br>
constant coefficient of variation (CCV) error model 26, 36,
40, 81, 86 <br>
constant infusion 60 <br>
constraint, parameter 9, 83, 110 <br>
control language, NONMEM 5 <br>
$CONTR record 139 <br>
CONTR subroutine 139 <br>
correlation 35 <br>
correlation matrix of estimate 88, 97 <br>
correlation of parameter estimate 44 <br>
correlation of residual vs</small> <big>y</big> <small>113
<br>
covariance 35, 84, 133 <br>
covariance matrix 35, 37, 98-99 <br>
covariance matrix, full 133 <br>
covariance matrix of estimate 88 <br>
$COVARIANCE record 9, 83, 87-88, 93, 97 <br>
covariance step 87-88, 97, 143 <br>
CRIT subroutine 139</small></p>

<h2>- D -
<a name="- D -"></a>
</h2>


<p style="margin-top: 1em"><small>DAT1,DAT2,DAT3 data item
64 <br>
data checkout 92, 137 <br>
data, effect 128, 140 <br>
data file name 51 <br>
data, individual 7, 22, 66 <br>
data item 7, 28, 49 <br>
data item, dropping 54, 64, 67 <br>
data item label 53 <br>
data item, null 49 <br>
data items, maximum number of 50, 54 <br>
data item, steady-state 57 <br>
data, population 54, 85 <br>
Data Preprocessor 63 <br>
data record 49 <br>
$DATA record 51, 63, 93, 136 <br>
data set 49 <br>
data set, deleting records from 49-50 <br>
data set, sequence of 49, 51 <br>
data set, size of 49 <br>
data, single-response population 22 <br>
date, calendar 64 <br>
DATE data item 64 <br>
days 52, 65 <br>
day-time translation 63, 66 <br>
default dose compartment 8, 68-69 <br>
degrees of freedom 47 <br>
deleting records from data set 49-50 <br>
dependent variable 7-8, 22 <br>
depot compartment 8, 58, 69 <br>
$DES record 129 <br>
DES subroutine 128 <br>
diagonal elements of OMEGA 35 <br>
DIAGONAL option of $OMEGA record 133 <br>
DIAGONAL option of $SIGMA record 133 <br>
diagonal variance-covariance matrix 84, 133 <br>
distribution of parameter estimate 43 <br>
dose, additional 71 <br>
dose amount 56 <br>
dose compartment, default 8, 68-69 <br>
dose compartment 56-57 <br>
dose event record 55-56 <br>
dose, implied 58 <br>
dose, infusion 58 <br>
dose, instantaneous bolus 57 <br>
dose, lagged 71 <br>
dose, multiple bolus 58 <br>
dose, multiple 11 <br>
dose-related data item 56 <br>
doses, multiple steady-state 61 <br>
dose, steady-state 58 <br>
dose, zero-order bolus 130 <br>
DROP option of $INPUT record 54, 64, 67, 92 <br>
dropping data item 54, 64, 67 <br>
drug level 59 <br>
duration, modeled 130 <br>
duration of infusion 58 <br>
DV data item 7, 54-55</small></p>

<h2>- E -
<a name="- E -"></a>
</h2>


<p style="margin-top: 1em"><small>effect data 128, 140 <br>
eigenvalue 129, 136 <br>
elimination rate K 9, 23 <br>
ELS, extended least squares 41 <br>
Emax model 128 <br>
end of infusion 58</small> <big><br>
&epsilon;</big> <small>31 <br>
EPS variable 80, 85 <br>
equilibrium compartment 129 <br>
error, estimation 42 <br>
error, interindividual 35 <br>
error, intraindividual 24, 35 <br>
error message, operating system 52 <br>
error message, PREDPP 146 <br>
error message, TRANSLATOR 145 <br>
error model, additive 25, 36, 40, 81, 86 <br>
error model, CCV 26, 36, 40, 81, 86 <br>
error model, constant coefficient of variation (CCV) 26, 36,
40, 81, 86 <br>
error model 24, 80, 86 <br>
error model, exponential 27, 36, 81 <br>
error model, log-normal 27, 36, 81 <br>
error model, power function 28, 41, 81 <br>
error model, proportional 26, 36 <br>
error model, statistical 22 <br>
error, MSE mean squared 42 <br>
$ERROR record 5, 13, 53, 140 <br>
$ERROR record 80, 82 <br>
error recovery option 139 <br>
error return code 139 <br>
ERROR subroutine, call to 56, 131 <br>
ERROR subroutine 4-5, 53, 69, 128 <br>
error variance 14, 24-25 <br>
ERR variable 24, 80, 85 <br>
estimate, bias of 42 <br>
estimate, conditional 137 <br>
estimate, initial 9, 128 <br>
estimate of ETA, individual 137 <br>
estimate of theta, initial 83 <br>
estimate of variance, initial 86, 135, 140 <br>
estimate, perturbed initial 84 <br>
estimation error 42 <br>
estimation method, first-order conditional with interaction
138 <br>
estimation method, first-order 138 <br>
estimation method, laplacian 138 <br>
$ESTIMATION record 9, 83, 87, 93 <br>
estimation step 87, 97, 135, 143</small> <big><br>
&eta;</big> <small>24 <br>
ETA, individual estimate of 137 <br>
ETA variable 13, 24, 80, 85 <br>
event record, dose 55-56 <br>
event record 55 <br>
event record, observation 54-55, 80 <br>
event record, other 55-56, 71 <br>
event record, reset-dose 55 <br>
event record, reset 55 <br>
EVID data item 55, 63 <br>
EVID data item, generated 66 <br>
exception, floating-point 139 <br>
EXIT statement 139 <br>
experiment, replication of 42 <br>
exponential error model 27, 36, 81 <br>
extended least squares ELS 41 <br>
external table file 137</small></p>

<h2>- F -
<a name="- F -"></a>
</h2>


<p style="margin-top: 1em"><big>F</big> <small>distribution
47 <br>
filename option of $DATA record 51 <br>
FILE option of $TABLE record 137 <br>
final parameter estimate 87 <br>
FINISH record 51 <br>
first-order absorption 7 <br>
first-order conditional estimation method 138 <br>
first-order conditional with interaction estimation method
138 <br>
first-order estimation method 138 <br>
fixed effects 22, 53 <br>
fixed effects parameter 22, 31 <br>
FIXED option of $OMEGA record 85, 95, 134 <br>
FIXED option of $SIGMA record 85, 95, 134 <br>
FIXED option of $THETA record 84, 95 <br>
flip-flop 146 <br>
floating-point exception 139 <br>
FOCE method 87 <br>
FO method 87 <br>
format specification 49, 51, 63, 67 <br>
FORTRAN 5, 49 <br>
FORTRAN OPEN statement 51 <br>
FORTRAN READ statement 52 <br>
fraction, output 69, 76 <br>
FROM option of $SCATTERPLOT record 100 <br>
FSUBS 5 <br>
full covariance matrix 133 <br>
full model 46, 114 <br>
function of parameters 41</small></p>

<h2>- G -
<a name="- G -"></a>
</h2>


<p style="margin-top: 1em"><small>general mixed effects
model 37 <br>
generated EVID data item 66 <br>
generated ID data item 66 <br>
generated MDV data item 66 <br>
generated subroutine 5 <br>
GG array 94 <br>
goodness of fit 9, 46, 114 <br>
gradient 96, 143</small></p>

<h2>- H -
<a name="- H -"></a>
</h2>


<p style="margin-top: 1em"><small>half-life 41, 44 <br>
hierarchical file 50 <br>
hours 52, 65 <br>
hyperbolic model 33 <br>
hypotheses, joint 46 <br>
hypothesis, null 45 <br>
hypothesis test 18, 45, 101</small></p>

<h2>- I -
<a name="- I -"></a>
</h2>


<p style="margin-top: 1em"><small>ID data item, generated
66 <br>
ID data item 50, 54, 134, 144 <br>
identification number, patient 50 <br>
IGNORE option of $DATA record 52 <br>
II/24 52 <br>
II data item, colon &quot;:&quot; in 66 <br>
II data item 55, 57, 66, 130 <br>
implied dose 58 <br>
INCLUDE record 89 <br>
index plot 103, 112 <br>
indicator variable 28, 33, 74, 77, 81-82 <br>
individual data 7, 22, 66 <br>
individual estimate of ETA 137 <br>
individual parameter estimate 137 <br>
individual record 54 <br>
infinite infusion 60 <br>
INFINITY 83, 93 <br>
INFN subroutine 132 <br>
infusion, constant 60 <br>
infusion dose 58 <br>
infusion, duration of 58 <br>
infusion, end of 58 <br>
infusion, infinite 60 <br>
infusion, multiple 59 <br>
infusion, rate of 57 <br>
Initial condition 129 <br>
initial estimate 9, 128 <br>
initial estimate of theta 83 <br>
initial estimate of variance 86, 135, 140 <br>
initial estimate, perturbed 84 <br>
initial estimate step 84, 86, 135 <br>
initialization/finalization 132 <br>
initial parameter estimate 135 <br>
$INPUT record 53, 57, 92 <br>
installation of NONMEM 2-3 <br>
instantaneous bolus dose 57 <br>
INTERACTION method 87 <br>
INTERACTION option of $ESTIMATION record 138 <br>
interdose interval 57, 66, 130 <br>
interindividual error 35 <br>
interindividual variability 35 <br>
interrupt 139 <br>
intraindividual error 24, 35 <br>
intraindividual variability 24, 35 <br>
inverse covariance matrix of estimate 88 <br>
I_SS 129 <br>
iteration 96, 143</small></p>

<h2>- J -
<a name="- J -"></a>
</h2>


<p style="margin-top: 1em"><small>joint hypotheses
46</small></p>

<h2>- K -
<a name="- K -"></a>
</h2>


<p style="margin-top: 1em"><small>KA, absorption rate 9
<br>
K, elimination rate 9, 23</small></p>

<h2>- L -
<a name="- L -"></a>
</h2>


<p style="margin-top: 1em"><small>L1 data item 134 <br>
L2 data item 134, 140, 144 <br>
labels, reserved 53 <br>
lagged dose 71 <br>
laplacian estimation method 138 <br>
LAPLACIAN option of $ESTIMATION record 138 <br>
LAST20 option of $DATA record 52 <br>
least squares criterion 40 <br>
least squares ELS, extended 41 <br>
least squares OLS, ordinary 40 <br>
least squares WLS, weighted 40 <br>
likelihood ratio test 46, 127 <br>
linear model 32 <br>
linear system 61 <br>
link editing 4 <br>
load module 4 <br>
log likelihood 46, 115 <br>
log-normal error model 27, 36, 81 <br>
lower triangular elements of OMEGA 35 <br>
LRECL option of $DATA record 52</small></p>

<h2>- M -
<a name="- M -"></a>
</h2>


<p style="margin-top: 1em"><small>mass balance 69 <br>
MATRIX option of $COVARIANCE record 135 <br>
MAXEVAL option of $ESTIMATION record 87, 143 <br>
maximum number of data items 50, 54 <br>
maximum number of observation records 54 <br>
MDV data item, generated 66 <br>
MDV data item 54, 132 <br>
mean squared error, MSE 42 <br>
METHOD option of $ESTIMATION record 87, 138 <br>
Michaelis-Menten model 33, 68 <br>
microconstant 69 <br>
minimal model 108 <br>
minimum value of objective function 9, 46, 87, 96-97 <br>
mixed effects model, general 37 <br>
mixed effects model 25, 30 <br>
$MIX record 138 <br>
MIX subroutine 128, 138-139 <br>
mixture model 138-139 <br>
model building 101 <br>
modeled duration 130 <br>
modeled rate 130 <br>
model, Emax 128 <br>
model, full 46, 114 <br>
model, general mixed effects 37 <br>
model, linear 32 <br>
model, Michaelis-Menten 33, 68 <br>
model, minimal 108 <br>
model misspecification 97 <br>
model, mixed effects 25, 30 <br>
model, mixture 138-139 <br>
model, multiplicative 32, 77 <br>
model, one-compartment 7, 12, 22 <br>
model, parameter 31 <br>
model, pharmacodynamic 128, 133, 140 <br>
model, pharmacokinetic 2, 68, 129 <br>
model, population 31 <br>
model, random effects 122 <br>
$MODEL record 129 <br>
model, reduced 46, 114 <br>
model specification file 88, 134-135 <br>
model, statistical 121-122 <br>
model, structural 22, 34, 93, 108 <br>
MODEL subroutine 128 <br>
model, user-defined 129 <br>
monitoring of search 87 <br>
MSE mean squared error 42 <br>
$MSFI record 88, 134 <br>
MSFO option of $ESTIMATION record 134, 143 <br>
MTIME 130 <br>
multiple bolus dose 58 <br>
multiple dose 11 <br>
multiple infusion 59 <br>
multiple steady-state doses 61 <br>
multiplicative model 32, 77 <br>
multivariate observation 134</small></p>

<h2>- N -
<a name="- N -"></a>
</h2>


<p style="margin-top: 1em"><small>negative objective
function 41 <br>
nested if 70 <br>
nested parentheses 70 <br>
nmfe72 4 <br>
nmfe 4 <br>
NM-TRAN defined 1 <br>
NOABORT 139 <br>
NOHEADER option of $TABLE record 137 <br>
NONMEM7 142 <br>
NONMEM control language 5 <br>
NONMEM 1 <br>
NOREWIND 51 <br>
null data item 49 <br>
null hypothesis 45 <br>
NULL option of $DATA record 52 <br>
null value 45 <br>
null value of parameter 124-125 <br>
number of significant digits 93 <br>
NUMBERPOINTS option of $THETA record 135</small></p>

<h2>- O -
<a name="- O -"></a>
</h2>


<p style="margin-top: 1em"><small>objective function,
minimum value of 9, 46, 87, 96-97 <br>
objective function 41, 87, 115 <br>
observation event record 54-55, 80 <br>
observation records, maximum number of 54 <br>
observed value 4, 54-55, 86 <br>
OLS, ordinary least squares 40 <br>
OMEGA, diagonal elements of 35</small> <big>&omega;</big>
<small><br>
40 <br>
OMEGA, lower triangular elements of 35</small> <big><br>
&Omega;</big> <small>35, 84 <br>
OMEGA 9, 25, 35 <br>
$OMEGA record 9, 13, 84-85, 93, 133 <br>
one-compartment model 7, 12, 22 <br>
ONEHEADER option of $TABLE record 137 <br>
ONLYSIMULATION option of $SIMULATION record 137 <br>
on/off status 55-56, 63, 75 <br>
operating system command 4 <br>
operating system error message 52 <br>
ORD0 option of $SCATTERPLOT record 89 <br>
ordinary least squares OLS 40 <br>
other event record 55-56, 71 <br>
OTHER option of $SUBROUTINE record 139 <br>
outlier 104 <br>
output compartment 24, 56, 58, 62, 69 <br>
output fraction 69, 76</small></p>

<h2>- P -
<a name="- P -"></a>
</h2>


<p style="margin-top: 1em"><small>parameter, Absorption lag
130 <br>
parameter, additional PK 53, 69 <br>
parameter, basic PK 53, 69 <br>
parameter constraint 9, 83, 110 <br>
parameter estimate, correlation of 44 <br>
parameter estimate, distribution of 43 <br>
parameter estimate, final 87 <br>
parameter estimate, individual 137 <br>
parameter estimate, initial 135 <br>
parameter estimate 40 <br>
parameter estimate, precision of 42, 88, 124, 126 <br>
parameter, fixed effects 22, 31 <br>
parameterization 23, 42, 45, 69, 72 <br>
parameter model 31 <br>
parameter, null value of 124-125 <br>
parameter, PK 9, 68 <br>
parameter, random effects 25, 122 <br>
parameter, scale 9, 23, 68, 73 <br>
parameters, function of 41 <br>
parameter, time varying 34 <br>
partial derivative 5 <br>
partitioned scatterplot 89, 100 <br>
patient identification number 50 <br>
PCMT data item 55, 68 <br>
perturbed initial estimate 84 <br>
pharmacodynamic model 128, 133, 140 <br>
pharmacokinetic model 2, 68, 129 <br>
phenobarbital example 11, 23, 85-86, 101, 128, 141</small>
<big><br>
&#981;</big> <small>22 <br>
PK parameter, additional 53, 69 <br>
PK parameter, basic 53, 69 <br>
PK parameter 9, 68 <br>
$PK record 5, 9, 53, 68 <br>
PK subroutine, call to 56, 131 <br>
PK subroutine 4-5, 53, 69, 128 <br>
plasma concentration 7, 24, 29, 34 <br>
plot, index 103, 112 <br>
population data 54, 85 <br>
population data, single-response 22 <br>
population model 31 <br>
POSTHOC option of $ESTIMATION record 137 <br>
power function error model 28, 41, 81 <br>
PRDERR 139 <br>
precision of parameter estimate 42, 88, 124, 126 <br>
PRED error recovery option 139 <br>
PRED error return code 139 <br>
predicted value 4, 55 <br>
predicted value PRED 10, 88 <br>
prediction compartment 56 <br>
PREDPP error message 146 <br>
PREDPP library 4 <br>
PREDPP 1, 68 <br>
PRED, predicted value 10, 88 <br>
$PRED record 5, 93 <br>
PRED subroutine 1, 68, 93, 128, 132 <br>
PRED subroutine, recursive 34, 136 <br>
PRINT option of $COVARIANCE record 135 <br>
PRINT option of $ESTIMATION record 87, 144 <br>
$PROBLEM record 7, 92, 136 <br>
proportional error model 26, 36 <br>
p-value 127</small></p>

<h2>- R -
<a name="- R -"></a>
</h2>


<p style="margin-top: 1em"><small>random effects model 122
<br>
random effects parameter 25, 122 <br>
random effects 25, 31, 76 <br>
random variable 5, 70, 77, 80 <br>
random variable 78 <br>
RATE data item 55, 57 <br>
rate, modeled 130 <br>
rate of infusion 57 <br>
record length 52 <br>
RECORDS option of $DATA record 51 <br>
recovery option, error 139 <br>
recursive PRED subroutine 34, 136 <br>
reduced model 46, 114 <br>
relative time 55, 63 <br>
REPEAT option of $ESTIMATION record 135 <br>
replication of experiment 42 <br>
RESCALE option of $MSFI record 135 <br>
reserved labels 53 <br>
reset-dose event record 55 <br>
reset event record 55 <br>
residual error 24, 31 <br>
residual RES 15, 88, 111 <br>
residual vs</small> <big>y</big> <small>, correlation of 113
<br>
RES, residual 15, 88, 111 <br>
return code, error 139 <br>
REWIND 51</small> <big><br>
R</big> <small>&minus;1 covariance matrix 135</small></p>

<h2>- S -
<a name="- S -"></a>
</h2>


<p style="margin-top: 1em"><small>SAME option of $SIGMA
record 134 <br>
saturation model 33, 77 <br>
scale parameter 9, 23, 68, 73 <br>
scatterplot, partitioned 89, 100 <br>
$SCATTERPLOT record 83, 88, 93 <br>
scatterplot 10, 50, 56-58, 88 <br>
scatterplot step 100 <br>
sdf 53 <br>
sequence of data set 49, 51 <br>
SE (standard error) 42 <br>
SIGDIGITS option of $ESTIMATION record 87</small>
<big>&sigma;</big> <small><br>
40 <br>
$SIGMA record 13, 83-85, 93, 133 <br>
SIGMA 14, 31</small> <big><br>
&Sigma;</big> <small>31, 84 <br>
significant digits, number of 93 <br>
$SIMULATION record 136 <br>
simulation step 95, 136 <br>
single-response population data 22 <br>
size of data set 49 <br>
sizes 53 <br>
SPECIAL option of $COVARIANCE record 136 <br>
SS data item 55, 57</small> <big><br>
S</big> <small>&minus;1 covariance matrix 135 <br>
standard deviation 26, 86, 111 <br>
standard error of estimate 88 <br>
standard error 7, 9, 42-43, 97, 125, 135 <br>
standard error vs. standard deviation 43 <br>
statistical error model 22 <br>
statistical model 121-122 <br>
steady-state data item 57 <br>
steady-state doses, multiple 61 <br>
steady-state dose 58 <br>
steady-state level 59-60, 62 <br>
steady-state 130 <br>
structural model 22, 34, 93, 108 <br>
SUBPROBLEM option of $SIMULATION record 136 <br>
subroutine, generated 5 <br>
$SUBROUTINE record 129 <br>
$SUBROUTINE record 68, 70, 93 <br>
$SUBOUTINES record 139 <br>
subroutine, user-supplied 5 <br>
subroutine, user-written 139 <br>
sum of squares 9, 40 <br>
superposition 61 <br>
superproblem 136 <br>
$SUPER record 136 <br>
synonym 53 <br>
system, linear 61</small></p>

<h2>- T -
<a name="- T -"></a>
</h2>


<p style="margin-top: 1em"><small>table file, external 137
<br>
$TABLE record 83, 88, 93 <br>
table step 99 <br>
table 56-58, 88 <br>
theophylline example 7</small> <big>&theta;</big>
<small><br>
40 <br>
theta, initial estimate of 83 <br>
$THETA record 9, 83, 93 <br>
THETA 9, 70 <br>
TIME/24 52, 65 <br>
TIME data item, colon &quot;:&quot; in 63 <br>
TIME data item 54 <br>
time, relative 55, 63 <br>
time varying parameter 34 <br>
TOL option of $SUBROUTINE record 129 <br>
$TOL record 129 <br>
TO option of $SCATTERPLOT record 100 <br>
TRANS1 69 <br>
transgeneration 132 <br>
TRANSLATE option of $DATA record 52, 65 <br>
translation 23, 69, 94 <br>
TRANSLATOR error message 145 <br>
TRANSLATOR warning message 4 <br>
TRANS 4, 23, 69 <br>
true-value variable 78 <br>
typical value 35, 76, 86</small></p>

<h2>- U -
<a name="- U -"></a>
</h2>


<p style="margin-top: 1em"><small>UNCONDITIONAL option of
$COVARIANCE record 136 <br>
UNCONDITIONAL option of $SCATTERPLOT record 88 <br>
UNCONDITIONAL option of $TABLE record 88 <br>
unexplained variability 115, 122 <br>
UNIT option of $SCATTERPLOT record 89 <br>
unit slope line 10, 89 <br>
units 23, 73 <br>
urine collection 29, 62 <br>
urine concentration 24, 29, 34, 37, 62 <br>
urine volume 24, 29, 62 <br>
user-defined model 129 <br>
user-supplied subroutine 5 <br>
user-written subroutine 139</small></p>

<h2>- V -
<a name="- V -"></a>
</h2>


<p style="margin-top: 1em"><small>value, null 45 <br>
value, observed 4, 54-55, 86 <br>
value, predicted 4, 55 <br>
value, typical 35, 76, 86 <br>
variability, interindividual 35 <br>
variability, intraindividual 24, 35 <br>
variability, unexplained 115, 122 <br>
variable, dependent 7-8, 22 <br>
variable, indicator 28, 33, 74, 77, 81-82 <br>
variable, random 5, 70, 77, 80 <br>
variance-covariance matrix, diagonal 84, 133 <br>
variance-covariance matrix 41 <br>
variance 9, 35 <br>
volume of distribution V 7, 23-24 <br>
V, volume of distribution 7, 23-24</small></p>

<h2>- W -
<a name="- W -"></a>
</h2>


<p style="margin-top: 1em"><small>warning message,
TRANSLATOR 4 <br>
weighted least squares WLS 40 <br>
weighted residual 88 <br>
weighted residual WRES 88, 111, 113 <br>
WIDE option of $DATA record 52 <br>
WLS, weighted least squares 40 <br>
WRES, weighted residual 88, 111, 113</small></p>

<h2>- Y -
<a name="- Y -"></a>
</h2>


<p style="margin-top: 1em"><small>year 2000 52</small>
<big>y</big> <small><br>
40</small> <big><br>
y</big> <small>22</small></p>

<h2>- Z -
<a name="- Z -"></a>
</h2>


<p style="margin-top: 1em"><small>zero-order bolus dose 130
<br>
zero-out a compartment 69</small></p>

<p align="center" style="margin-top: 1em"><b>Table of
Contents</b></p>

<p style="margin-top: 1em">Chapter 1 - Introduction to
NONMEM, PREDPP, and</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p>NM-TRAN</p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . .
.</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>What This Chapter is About</p></table>

<p><small>. . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Introducing NONMEM</p></table>

<p><small>. . . . . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>What is NONMEM?</p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>What is PREDPP?</p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>What is NM-TRAN?</p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Scope of this Introductory Guide</p></table>

<p><small>. . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Contents of this Introductory Guide</p></table>

<p><small>. . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>How to Read this Guide</p></table>

<p><small>. . . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>A Brief Technical Overview</p></table>

<p><small>. . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>NONMEM</p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>PREDPP and the PREDPP Library</p></table>

<p><small>. . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Subroutines PK and ERROR</p></table>

<p><small>. . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Building an Executable Module for NONMEM</p></table>

<p><small>. . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>NM-TRAN</p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Control Language Translation</p></table>

<p><small>. . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Model Specification via Abbreviated Code</p></table>

<p><small>. . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Partial Differentiation</p></table>

<p><small>. . . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Data Preprocessor</p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>Additional Documentation</p></table>

<p><small>. . . . . . . . . . . . . .</small> <br>
1</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p>Chapter 2 - NONMEM Examples</p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . .</small> <br>
2</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>What This Chapter is About</p></table>

<p><small>. . . . . . . . . . . . .</small> <br>
2</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p>An Individual&rsquo;s Theophylline Kinetics</p></table>

<p><small>. . . . . . . .</small> <br>
2</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The NM-TRAN Control Records</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Model</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Output</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .</small>
<big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>A Population Model for Phenobarbital</big></p></table>

<p><small>. . . . . . . .</small> <big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The NM-TRAN Control Records</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Model</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Output</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .</small>
<big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Overview</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
2</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 3 - Models for Individual Data</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . .</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
3 <br>
Pharmacokinetic Structural Models for Individual</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Data</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Alternative Parameterizations</big></p></table>

<p><small>. . . . . . . . . . . .</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Scale Parameter,</big></p></table>


<p align="center"><big><img src="html.dir/grohtml-10761-66.png" alt="Image html.dir/grohtml-10761-66.png"></big></p>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
3 <br>

<img src="html.dir/grohtml-10761-74.png" alt="Image html.dir/grohtml-10761-74.png"></big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Depends on a Known Constant</big></p></table>

<p><small>. . . . . . . . . . . .</small> <big><br>
3 <br>

<img src="html.dir/grohtml-10761-84.png" alt="Image html.dir/grohtml-10761-84.png"></big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Depends on a Parameter</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
3 <br>

<img src="html.dir/grohtml-10761-91.png" alt="Image html.dir/grohtml-10761-91.png"></big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Depends on an Element of</big></p></table>


<p><big><img src="html.dir/grohtml-10761-92.png" alt="Image html.dir/grohtml-10761-92.png"></big>
<small>. . . . . . . . . . . .</small> <big><br>
3 <br>
Statistical Model for an Individual&rsquo;s
Observa-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tions</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Additive Error Model</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
3 <br>
The Constant Coefficient of Variation and Expo-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>nential Models</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . .</small>
<big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Combined Additive and CCV Error Model</big></p></table>

<p><small>. . . . . . . .</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Power Function Model</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Two Different Types of Measurements</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Use of an Indicator Variable</big></p></table>

<p><small>. . . . . . . . . . . .</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Two Different Types of Observations</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>More Than One Indicator Variable</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
3 <br>
The General Mixed Effects Model for an Individual</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="114%"></td>
<td width="-14%">


<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
. . .</small></p></td></tr>
</table>

<p><big>3</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 4 - Models for Population Data</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . .</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>General</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Structural Parameter Models</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Linear Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Multiplicative Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Saturation Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Models with Indicator Variables</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Combinations</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Time Varying</big></p></table>


<p><big><img src="html.dir/grohtml-10761-349.png" alt="Image html.dir/grohtml-10761-349.png"></big>
<small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Structural Kinetic Models</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Population Random Effects Models</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Models for Interindividual Errors</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
4 <br>
Additive/Multiplicative Models and the Exponen-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tial Model</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Other Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>General Form for the Parameter Model</big></p></table>

<p><small>. . . . . . . .</small> <big><br>
4 <br>
Statistical Models for an Individual&rsquo;s
Observa-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tions</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
4</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Population Mixed Effects Model</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
4</big></p>

<p style="margin-top: 1em"><big>Chapter 5 - Estimates,
Confidence Intervals, and Hy-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>pothesis Tests</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . .</small>
<big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Model Fitting Criterion</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
5 <br>
Least Squares for Individual Data with an Addi-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tive Error Model</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
5 <br>
Least Squares for Individual Data with Other</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Types of Error Models</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Least Squares for Population Data</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Parameter Estimates</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Precision of Parameter Estimates</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
5 <br>
Distribution of Parameters vs Distribution of Pa-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>rameter Estimates</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Confidence Interval for a Single
Parameter</big></p> </table>

<p><small>. . . . .</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Estimating a Parameter&rsquo;s Standard
Error</big></p> </table>

<p><small>. . . . . . .</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Relating the Confidence Interval to the</big></p></table>


<p><big><img src="html.dir/grohtml-10761-674.png" alt="Image html.dir/grohtml-10761-674.png"></big>
<small>. . . . .</small> <big><br>
5 <br>
A Confidence Interval for a Function of a Single</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Parameter</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Multiple Parameters</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Correlation of Parameter Estimates</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
5 <br>
Confidence Intervals for a Function of Several</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Parameters</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Hypothesis Testing</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Hypothesis Testing Using the</big></p></table>


<p><big><img src="html.dir/grohtml-10761-710.png" alt="Image html.dir/grohtml-10761-710.png"></big>
<small>. . . . . . . . . . .</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Hypothesis Testing Using the Likelihood
Ratio</big></p> </table>

<p><small>. . . .</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Definition &mdash; Full/Reduced Models</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
5 <br>
Reduced/Full Models Express the Null/Alternative</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Hypotheses</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Likelihood Ratio Test</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
5</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Choosing Among Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
5</big></p>

<p style="margin-top: 1em"><big>Chapter 6 - Data Sets,
$DATA and $INPUT Records, and</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>the Data Preprocessor</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Data Sets for NONMEM</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Data Records</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Data Items</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Clinical Data and Data Conversion</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Data Sets for PREDPP</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The $DATA Record</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The $INPUT Record</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Data Item Labels</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Reserved Labels and Synonyms</big></p></table>

<p><small>. . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Dropping Data Items via DROP</big></p></table>

<p><small>. . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>NONMEM Data Items</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>DV Data Item</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>ID Data Item for Population Data</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>MDV data item</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>PREDPP Data Items</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>TIME Data Item</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>AMT, RATE, SS, II: Dose-related Data
Items</big></p> </table>

<p><small>. . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>EVID Data Item</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>CMT and PCMT Data Items</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>CALL Data Item</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Describing Doses to PREDPP</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Dose-related Data Items</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Different Kinds of Doses</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Instantaneous Bolus Doses</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Infusions</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Steady-State Doses</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Steady-State with Multiple Bolus Doses</big></p></table>

<p><small>. . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Steady-State with Multiple Infusions</big></p></table>

<p><small>. . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Steady-State with Constant Infusion</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Multiple Steady-State Doses</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
6 <br>
Combining Non-Steady-State Doses with</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Steady-State Doses</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
6 <br>
The Output Compartment: Urine Collections and Ob-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>servations</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Data Preprocessor</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Day-time Translation</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>TIME Data Item</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>DATE Data Item</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Calendar Dates</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Converting Hours to Days</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Year 2000 - LAST20</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Leap Year Warning - LYWARN</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Interdose Interval (II) Conversion</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Data Items Generated by the Data
Preprocessor</big></p> </table>

<p><small>. . . .</small> <big><br>
6 <br>
When Must a Format Specification be Included or</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Omitted?</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Skipping Data Items</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
6</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 7 - $SUBROUTINE Record and $PK
Record</big></p> </td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The $SUBROUTINE Record</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
7 <br>
Choosing an ADVAN Subroutine: Standard Pharma-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>cokinetic Models</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
7 <br>
Choosing a TRANS Subroutine: Alternative Parame-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>terizations</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>$PK Abbreviated Code</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Syntax</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>When are $PK Statements Evaluated?</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Time Varying PK parameters</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>$PK Statements for Individual Data</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Basic and Additional Parameters</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
7 <br>
Alternative Parameterizations using $PK State-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>ments</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Scale Parameters</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Scaling by a Known Constant</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
7 <br>
Scaling by a Parameter: Conditional Statements</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>and Indicator Variables</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Scaling by a Data Item</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Bioavailability Fraction Parameters</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Output Fraction</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>$PK Statements for Population Data</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Structural Part of Parameter Models</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Linear Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Multiplicative Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Saturation Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Models with Indicator Variables</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Population Random Effect Models</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Models for Interindividual Errors</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Additive/Multiplicative Models</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Other Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Restrictions on Random Variables</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
7</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 8 - $ERROR Record</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>$ERROR Abbreviated Code</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Syntax</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>When are $ERROR Statements Evaluated?</big></p></table>

<p><small>. . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Error Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Additive Error Model</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
8 <br>
The Constant Coefficient of Variation and Expo-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>nential Models</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . .</small>
<big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Combined Additive and CCV Error Model</big></p></table>

<p><small>. . . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Power Model</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Two Different Types of Measurements</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Two Different Types of Observations</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>More than One Indicator Variable</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
8</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 9 - Additional NM-TRAN Records</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
9 <br>
Providing Initial Estimates For &theta;: The
$THETA</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Record</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Providing Initial Estimates For Elements Of
&theta;</big></p> </table>

<p><small>. . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Providing Constraints for Elements of
&theta;</big></p> </table>

<p><small>. . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Fixing Elements of &theta;</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>How to Obtain Initial Estimates for
&theta;</big></p> </table>

<p><small>. . . . . . . .</small> <big><br>
9 <br>
Providing Initial Estimates for &Omega; and &Sigma;:
the</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>$OMEGA and $SIGMA Records</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>$OMEGA Record With Individual Data</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>$OMEGA Record With Population Data</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The $SIGMA Record</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Fixing Elements of &Omega; or &Sigma;</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>How to Obtain Initial Estimates for &Omega; and
&Sigma;</big></p> </table>

<p><small>. . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Specifying Optional Tasks</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
9 <br>
Requesting the Estimation Step: the $ESTIMATION</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Record</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
9 <br>
Requesting the Covariance Step: the $COVARIANCE</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Record</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Specifying Optional Output</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Requesting the Table Step: the $TABLE
Record</big></p> </table>

<p><small>. . . .</small> <big><br>
9 <br>
Requesting Scatterplots: the $SCATTERPLOT Record</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="114%"></td>
<td width="-14%">


<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
. . .</small></p></td></tr>
</table>

<p><big>9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Placement and Order of Records</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>INCLUDE records</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
9</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 10 - Reading the Output</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>NONMEM Describes its Inputs</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>PREDPP Describes Its Inputs</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Diagnostic Output from the Estimation
Step</big></p> </table>

<p><small>. . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Intermediate Output from the Estimation
Step</big></p> </table>

<p><small>. . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Summary Output from the Estimation Step</big></p></table>

<p><small>. . . . . . .</small> <big><br>
10 <br>
Minimum Value of the Objective Function and Final</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Parameter Estimates</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Output from the Covariance Step</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Additional Output: Tables and
Scatterplots</big></p> </table>

<p><small>. . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Output from the Table Step</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Output from the Scatterplot Step</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
10</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 11 - Model Building</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Stages of Model Building</big></p></table>

<p><small>. . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Check-out &mdash; Index Plots</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Building the Structural Part of the Model</big></p></table>

<p><small>. . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>A General Approach</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Minimal Model</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Use of Constraints</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Diagnostic Tools</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Plot of DV vs PRED</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Residual Plots</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Index Plots of Residuals</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Plot of WRES vs Independent Variable</big></p></table>

<p><small>. . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Judging Goodness of Fit</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
11 <br>
A Global Measure &mdash; Change in the Objective
Func-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tion</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Decrease in Unexplained Variability</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Improvement in Plots</big></p></table>

<p><small>. . . . . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Using the Tools: Further Improvement</big></p></table>

<p><small>. . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>An Additional Effect of WT</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Effect of APGR</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Building the Statistical Model</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Judging Among Alternatives</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Unexplained Variability</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Residual Plots</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Refine Model</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
11 <br>
Use of Standard Errors and Confidence Intervals</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="114%"></td>
<td width="-14%">


<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
. . .</small></p></td></tr>
</table>

<p><big>11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>A Model Refinement</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Testing the Model</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . .</small>
<big><br>
11</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 12 - Brief Descriptions of Other
Features</big></p> </td>
<td width="90%">
</td></tr>
</table>

<p><small>. . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Advanced Features of PREDPP</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
12 <br>
Pharmacodynamic Modeling Using the $ERROR Record</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="114%"></td>
<td width="-14%">


<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
. . .</small></p></td></tr>
</table>

<p><big>12 <br>
Other Pharmacokinetic Models: ADVAN5 through AD-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>VAN9 and ADVAN13</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Zero-Order Bolus Doses</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>The Additional Dose Data Item: ADDL</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Lagged doses: the ALAG Parameter</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Model Event Times: MTIME</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Controlling Calls to PK and ERROR</big></p></table>

<p><small>. . . . . . . . . .</small> <big><br>
12 <br>
Transgeneration of Input Data: the INFN Subrou-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tine</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>User-written PRED Subroutines</big></p></table>

<p><small>. . . . . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Required Data Items</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
12 <br>
An Example of $PRED Statements: Pharmacodynamic</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Modeling</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Advanced Features of NONMEM</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
12 <br>
Full Covariance Matrices: $OMEGA BLOCK and $SIGMA</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>BLOCK</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12 <br>
Grouping Related Observations: The L1 and L2 Data</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Items</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Continuing a NONMEM Run: MSFO and MSFI</big></p></table>

<p><small>. . . . . . .</small> <big><br>
12 <br>
NONMEM Can Obtain Initial Estimates for &theta;, &Omega;,
&Sigma;</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="114%"></td>
<td width="-14%">


<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
. . .</small></p></td></tr>
</table>

<p><big>12 <br>
Improving Parameter Estimates: REPEAT and RESCALE</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="114%"></td>
<td width="-14%">


<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
. . .</small></p></td></tr>
</table>

<p><big>12 <br>
The Covariance Step: <b>R</b></big>
<b><small>&minus;1</small></b> <big>, <b>S</b></big>
<b><small>&minus;1</small></b> <big>, Special
Computa-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tion</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Multiple Problems in a Single NONMEM Run</big></p></table>

<p><small>. . . . . .</small> <big><br>
12 <br>
Simulation Using NONMEM: The $SIMULATION Record</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="114%"></td>
<td width="-14%">


<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
. . .</small></p></td></tr>
</table>

<p><big>12 <br>
Files for Subsequent Processing: the $TABLE</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Record</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Data Checkout Mode</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
12 <br>
Obtaining Individual Parameter Estimates - Condi-</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>tional Estimates of &eta;s</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Population Conditional Estimation Methods</big></p></table>

<p><small>. . . . . .</small> <big><br>
12 <br>
Displaying PRED-Defined Variables and Conditional</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Estimates of &eta;s</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . .</small>
<big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Mixture Models</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . .</small>
<big><br>
12 <br>
PRED Error Return Codes and Error Messages in</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>File PRDERR</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>User-Written Subroutines</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>PRIOR</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Observations of Two Different Types</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>NONMEM 7</big></p></table>

<p><small>. . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
12</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p><big>Chapter 13 - Errors in NONMEM Runs</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>What This Chapter is About</big></p></table>

<p><small>. . . . . . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Abnormal Termination of the Estimation
Step</big></p> </table>

<p><small>. . . . .</small> <big><br>
13 <br>
&quot;</big> DUE TO MAX. NO. OF FUNCTION EVALUATIONS
EXCEED-</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p>ED <big>&quot;</big></p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . . .
.</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>&quot;</big> DUE TO ROUNDING ERRORS (ERROR=134)
<big>&quot;</big></p> </table>

<p><small>. . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Abnormal Termination of the Covariance
Step</big></p> </table>

<p><small>. . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Miscellaneous Problems</big></p></table>

<p><small>. . . . . . . . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Proportional Error Model</big></p></table>

<p><small>. . . . . . . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Errors in the Pharmacokinetic Model</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Errors with PREDPP</big></p></table>

<p><small>. . . . . . . . . . . . . . . . .</small>
<big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Error Messages from a TRANS Routine</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Error Messages from ADVAN Routines</big></p></table>

<p><small>. . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">


<p><big>Numeric difficulties in PREDPP</big></p></table>

<p><small>. . . . . . . . . . .</small> <big><br>
13</big></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="10%">


<p>Index</p></td>
<td width="90%">
</td></tr>
</table>

<p><small>. . . . . . . . . . . . . . . . . . . . . . . .
.</small> <br>
 19</p>
<hr>
</body>
</html>
