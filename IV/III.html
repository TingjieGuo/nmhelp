<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Fri Sep 18 22:02:35 2020 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<a href="#NONMEM Users Guide Part IV - NM-TRAN - Chapter III">NONMEM Users Guide Part IV - NM-TRAN - Chapter III</a><br>
<a href="#III. Control Records">III. Control Records</a><br>
<a href="#III.III.III.A. Record Syntax - General">III.III.III.A. Record Syntax - General</a><br>
<a href="#III.III.III.B. Record Syntax - Specific Records">III.III.III.B. Record Syntax - Specific Records</a><br>
<a href="#III.III.III.B.1. $PROBLEM Record">III.III.III.B.1. $PROBLEM Record</a><br>
<a href="#III.III.III.B.2. $INPUT Record">III.III.III.B.2. $INPUT Record</a><br>
<a href="#III.III.III.B.3. $INDEX Record">III.III.III.B.3. $INDEX Record</a><br>
<a href="#III.III.III.B.4. $CONTR Record">III.III.III.B.4. $CONTR Record</a><br>
<a href="#III.III.III.B.5. $DATA Record">III.III.III.B.5. $DATA Record</a><br>
<a href="#III.III.III.B.6. $SUBROUTINES Record">III.III.III.B.6. $SUBROUTINES Record</a><br>
<a href="#III.III.III.B.7. $ABBREVIATED Record">III.III.III.B.7. $ABBREVIATED Record</a><br>
<a href="#III.III.III.B.8. $PRED Record">III.III.III.B.8. $PRED Record</a><br>
<a href="#III.III.III.B.9. $THETA Record">III.III.III.B.9. $THETA Record</a><br>
<a href="#III.III.III.B.10. $OMEGA Record">III.III.III.B.10. $OMEGA Record</a><br>
<a href="#III.III.III.B.11. $SIGMA Record">III.III.III.B.11. $SIGMA Record</a><br>
<a href="#III.III.III.B.12. $MSFI Record">III.III.III.B.12. $MSFI Record</a><br>
<a href="#III.III.III.B.13. $SIMULATION Record">III.III.III.B.13. $SIMULATION Record</a><br>
<a href="#III.III.III.B.14. $ESTIMATION Record">III.III.III.B.14. $ESTIMATION Record</a><br>
<a href="#III.III.III.B.15. $COVARIANCE Record">III.III.III.B.15. $COVARIANCE Record</a><br>
<a href="#III.III.III.B.16. $TABLE Record">III.III.III.B.16. $TABLE Record</a><br>
<a href="#III.III.III.B.17. $SCATTERPLOT Record">III.III.III.B.17. $SCATTERPLOT Record</a><br>
<a href="#III.III.III.B.18. $SUPERPROBLEM Record (nmv)">III.III.III.B.18. $SUPERPROBLEM Record (nmv)</a><br>
<a href="#III.III.III.B.19. $WARNING Record (nmv)">III.III.III.B.19. $WARNING Record (nmv)</a><br>
<a href="#III.III.III.B.20. $INCLUDE Record (nmvi)">III.III.III.B.20. $INCLUDE Record (nmvi)</a><br>
<a href="#III.III.III.B.21. $NONPARAMETRIC Record (nmvi)">III.III.III.B.21. $NONPARAMETRIC Record (nmvi)</a><br>
<a href="#III.III.III.B.22. $OMIT Record (nmvi)">III.III.III.B.22. $OMIT Record (nmvi)</a><br>
<a href="#III.III.III.B.23. $PRIOR Record (nmvi)">III.III.III.B.23. $PRIOR Record (nmvi)</a><br>
<a href="#III.III.III.B.24. $THETAP, $THETAPV Record (nm73)">III.III.III.B.24. $THETAP, $THETAPV Record (nm73)</a><br>
<a href="#III.III.III.B.25. $OMEGAP, $OMEGAPD Record (nm73)">III.III.III.B.25. $OMEGAP, $OMEGAPD Record (nm73)</a><br>
<a href="#III.III.III.B.26. $SIGMAP, $SIGMAPD Record (nm73)">III.III.III.B.26. $SIGMAP, $SIGMAPD Record (nm73)</a><br>
<a href="#III.III.III.B.27. $CHAIN Record (nm72)">III.III.III.B.27. $CHAIN Record (nm72)</a><br>
<a href="#III.III.III.B.28. $SIZES Record (nm72)">III.III.III.B.28. $SIZES Record (nm72)</a><br>
<a href="#III.III.III.B.29. $ANNEAL Record (nm73)">III.III.III.B.29. $ANNEAL Record (nm73)</a><br>
<a href="#III.III.III.B.30. $ETAS Record (nm73)III.III.B.31. $PHIS Record (nm73)">III.III.III.B.30. $ETAS Record (nm73)III.III.B.31. $PHIS Record (nm73)</a><br>
<a href="#III.III.III.B.32. $LEVEL Record (nm73)">III.III.III.B.32. $LEVEL Record (nm73)</a><br>
<a href="#III.III.III.B.33. $DEFAULT Record (nm74)">III.III.III.B.33. $DEFAULT Record (nm74)</a><br>

<hr>


<h2>NONMEM Users Guide Part IV - NM-TRAN - Chapter III
<a name="NONMEM"></a>
<a name="NONMEM Users Guide Part IV - NM-TRAN - Chapter III"></a>
</h2>


<h2>III. Control Records
<a name="III."></a>
<a name="III. Control Records"></a>
</h2>


<h2>III.III.III.A. Record Syntax - General
<a name="III.III.III.A."></a>
<a name="III.III.III.A. Record Syntax - General"></a>
</h2>


<p style="margin-top: 1em">A partial listing of NM-TRAN
control record names and options is given in Appendix I. A
complete listing of all the control records can be found in
NONMEM Users Guide V Appendix 3. NONMEM Users Guide VIII and
on-line help describe all the options. General rules for
constructing these names and options are given in this
section. The reader may refer to the example of the control
records given in chapter I. It is not possible for NM-TRAN
to generate a NONMEM control stream which contains syntax
errors. Errors in an NM-TRAN control stream are reported in
a report file; see Chapter I (FMSG).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="3%">


<p style="margin-top: 1em">1.</p></td>
<td width="5%"></td>
<td width="92%">


<p style="margin-top: 1em">Record names begin with
<tt>$</tt>. With NONMEM 7.2 and higher, both lower and upper
case may be used for record names and all user-defined and
reserved words in the control stream. Upper-case is used in
this guide for clarity.</p></td></tr>
</table>

<p style="margin-left:8%; margin-top: 1em">E.g.
<tt>$OMEGA</tt></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="3%">


<p style="margin-top: 1em">2.</p></td>
<td width="5%"></td>
<td width="92%">


<p style="margin-top: 1em">Option names on records may also
be upper-case or lower-case.</p></td></tr>
</table>

<p style="margin-left:8%; margin-top: 1em">E.g.
<tt>SIGDIGITS</tt></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="3%">


<p style="margin-top: 1em">3.</p></td>
<td width="5%"></td>
<td width="92%">


<p style="margin-top: 1em">The order of the records and the
order of options within records is immaterial except where
noted in the particular discussion of the record or
option.</p> </td></tr>
<tr valign="top" align="left">
<td width="3%">


<p>4.</p></td>
<td width="5%"></td>
<td width="92%">


<p>With record names and options prior to NONMEM 7, initial
substrings of record or option names, and of length 3 or
more, are recognized as abbreviations.</p></td></tr>
</table>

<p style="margin-left:8%; margin-top: 1em">E.g.
<tt>$COVARIANCE</tt> or <tt>$COV</tt> or <tt>$COVAR</tt></p>

<p style="margin-left:8%; margin-top: 1em">An abbreviation
is a type of <b>alias</b> for the record or option name. For
any particular record or option, there may also be other
acceptable aliases; these are noted as part of the
description of the particular record or option. All aliases
may be abbreviated according to the convention just
described.</p>

<p style="margin-left:8%; margin-top: 1em">There are
exceptions such as the <tt>NOABORTFIRST</tt> option of
$THETA. With NONMEM 7, some new record names (e.g., $ANNEAL)
and options (e.g. $ESTIMATION record option ISAMPLE) cannot
be abbreviated.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="3%">


<p style="margin-top: 1em">5.</p></td>
<td width="5%"></td>
<td width="80%">


<p style="margin-top: 1em">Text after a semicolon is
regarded as a comment.</p></td>
<td width="12%">
</td></tr>
</table>

<p style="margin-left:8%; margin-top: 1em">E.g. <tt>$THETA
7 ;Mean Clearance</tt></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="3%">


<p style="margin-top: 1em">6.</p></td>
<td width="5%"></td>
<td width="92%">


<p style="margin-top: 1em">Blank-line records and records
containing only comments can be included for clarity or
readability.</p> </td></tr>
<tr valign="top" align="left">
<td width="3%">


<p>7.</p></td>
<td width="5%"></td>
<td width="92%">


<p>With NONMEM VI 2.0 and later versions, the length of a
single record of the NM-TRAN input file is at most 160
characters. (Previously, it was 80 characters.) With NONMEM
7.3, the maximum length is given by FSD in
resource/SIZES.f90 (FSD=67000 with NONMEM 7.3).</p></td></tr>
</table>

<p style="margin-left:8%; margin-top: 1em">For readability,
a record can be continued to form a <b>contiguous block of
records</b></p>

<p style="margin-left:8%; margin-top: 1em">E.g.</p>

<pre style="margin-left:8%;">$THETA   7   ;Mean Clearance        20   ;Mean Volume</pre>


<p style="margin-left:8%; margin-top: 1em">The record name,
or an alias for it, physically appears only in the first
record of a contiguous block. This name or alias is
&quot;understood&quot; to appear in each continuation record
of the block. Also, a record can be continued by a series of
contiguous blocks, no two of which need to be contiguous to
each other. In general, all the information from all records
which use (or are understood to use) the same name, or use
(or are understood to use) an alias for this name, is
regarded as coming from a single record with that name. If
this is ordered information, the ordering is determined by
the ordering of the separate records.</p>

<p style="margin-left:8%; margin-top: 1em">E.g.</p>
<pre style="margin-left:8%;">$THETA  7        20</pre>

<p style="margin-left:8%;">$OMEGA .5 4 $THETA .7 $OMEGA
.005</p>

<p style="margin-left:8%; margin-top: 1em">is equivalent
to</p>

<pre style="margin-left:8%; margin-top: 1em">$THETA 7 20 .7
$OMEGA .5 4 .005</pre>


<p style="margin-left:8%; margin-top: 1em">The $ESTIMATION
record, like the $TABLE and $SCATTER records, is an
exception, as noted in the descriptions of these
records.</p>

<p style="margin-left:8%; margin-top: 1em">With NONMEM 7.3
and higher, &amp; may be used at the end of any line of the
control stream to indicate that the line is to be continued,
including control records as well as abbreviated code. (This
is FORTRAN 90-style continuation.) If the ampersand at the
end of a line is not to be interpreted as a continuation
marker, but as a part of the record, then, place a ; after
it. For example, an option of the $TABLE record may
terminate with &amp;.</p>


<p style="margin-left:8%; margin-top: 1em"><tt>FORMAT=s1PE15.8:160&amp;
;</tt></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="3%">


<p style="margin-top: 1em">8.</p></td>
<td width="5%"></td>
<td width="92%">


<p style="margin-top: 1em">Options can be separated by
commas and/or any number of spaces.</p></td></tr>
</table>

<p style="margin-left:8%; margin-top: 1em">E.g.
<tt>MAXEVAL=400 SIGDIGITS=4, PRINT=5</tt></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="3%">


<p style="margin-top: 1em">9.</p></td>
<td width="5%"></td>
<td width="92%">


<p style="margin-top: 1em">An option of the form A=B must
be contained on a single record and may contain spaces
around =. A is called the <b>option name</b></p></td></tr>
</table>

<p style="margin-left:8%; margin-top: 1em">and B is called
the <b>option value</b></p>

<p style="margin-left:8%; margin-top: 1em">E.g. <tt>MAXEVAL
= 400</tt></p>

<p style="margin-left:8%; margin-top: 1em">With an option
of form A=B, the = can be omitted.</p>

<p style="margin-left:8%; margin-top: 1em"><tt>MAX =
300</tt> or <tt>MAX 300</tt></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="5%">


<p style="margin-top: 1em">10.</p></td>
<td width="3%"></td>
<td width="92%">


<p style="margin-top: 1em">Filenames on control records may
consist of as many characters as fit on a single line. A
filename may not contain embedded spaces. If it contains
commas, semicolons, or parentheses, or if it starts with an
equal sign, then it must be surrounded by single quotes
&rsquo; or double quotes &quot;. An option name may not be
used as a filename unless it is surrounded by quotes.</p></td></tr>
<tr valign="top" align="left">
<td width="5%">


<p style="margin-top: 1em">11.</p></td>
<td width="3%"></td>
<td width="92%">


<p style="margin-top: 1em">The numerical values in $THETA,
$OMEGA, and $SIGMA may be each up to 30 characters long, and
may be described in E field notation.</p></td></tr>
</table>

<p style="margin-top: 1em">In the descriptions of the
particular records, which follow in later sections, square
brackets are used to surround an option or group of options,
none of which need actually appear in the record. If they
surround a group of options, a vertical line is used to
separate these options in the description, and at most one
of the options may be selected to actually appear in the
record. If none are selected to appear, then <b>the default
option</b></p>

<p style="margin-top: 1em">indicated in boldface (if there
is an option so indicated), is understood to apply.</p>

<p style="margin-top: 1em">E.g.
[<tt><b>UNCONDITIONAL</b></tt>|<tt>CONDITIONAL</tt>]
indicates a choice between the options
<tt>UNCONDITIONAL</tt> and <tt>CONDITIONAL</tt>, and if
neither are selected to appear in the record, it is
understood that the first option applies.</p>

<h2>III.III.III.B. Record Syntax - Specific Records
<a name="III.III.III.B."></a>
<a name="III.III.III.B. Record Syntax - Specific Records"></a>
</h2>


<p style="margin-top: 1em">Specific NM-TRAN control records
are described in the next subsections. The first 17 records
($PROBLEM thru $SCATTERPLOT) were part of NONMEM IV, and are
discussed in detail. Options are listed as of NONMEM 7.4.
Options added with NONMEM V and later are not always
discussed in this document, but are discussed in the
help/Guide VIII documents. The remaining records (starting
with B.18. $SUPERPROBLEM Record) is a listing of record
types introduced with NONMEM V and later, with brief
descriptions. All of these records are optional. They are
listed in order in which they were added to NONMEM, with
some exceptions. For additional information, see Guide VIII
and on-line help.</p>

<h2>III.III.III.B.1. $PROBLEM Record
<a name="III.III.III.B.1."></a>
<a name="III.III.III.B.1. $PROBLEM Record"></a>
</h2>


<p style="margin-top: 1em"><tt>$PROBLEM</tt> text</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$PROB  THEOPHYLLINE   POPULATION DATA</pre>

<p style="margin-top: 1em">The text becomes a heading for
the NONMEM printout.</p>

<p style="margin-top: 1em">This record is required. Only
$SIZES and $SUPERPROBLEM may precede a $PROBLEM record. (See
III.B.28 and III.B.18 below.) A $PROBLEM record other than
the first one marks the beginning of another problem
specification.</p>

<p style="margin-top: 1em">The text must be contained on a
single record, and only the first 72 characters of text
(starting with the second character after the record name)
are used in the heading. Spaces <i>and</i> semicolons in the
text are included &quot;as is&quot;. The text is
optional.</p>

<h2>III.III.III.B.2. $INPUT Record
<a name="III.III.III.B.2."></a>
<a name="III.III.III.B.2. $INPUT Record"></a>
</h2>


<p style="margin-top: 1em"><tt>$INPUT</tt> @item sub 1 ~
item sub 2 ~ item sub 3 ~...@</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$INPUT      ID DOSE TIME CP=DV WT</pre>

<p style="margin-top: 1em">The items define the data item
types that appear in the NM-TRAN data records, as well as
the order of their appearance.</p>

<p style="margin-top: 1em">This record is required, and it
must precede any other NM-TRAN control record in the problem
specification that refers to specific data item types.</p>

<p style="margin-top: 1em">Each item has form B or A=B,
where A and B are data item labels. Each data item label
consists of letters (A-Z) and numerals (0-9), but it must
begin with a letter. Starting with NONMEM 7.1, the
underscore character _ may be used in a data item label.
Starting with NONMEM 7.1, the maximum number of characters
in a label is given by SD in resource/SIZES.f90. The default
value is 20. With previous versions, the maximum number of
characters is 4. The labels may be used in subsequent
NM-TRAN control records, and they will be used as labels for
data items in NONMEM output.</p>

<p style="margin-top: 1em">NM-TRAN recognizes certain
<b>reserved labels:</b> <tt><br>
ID</tt>, <tt>L1</tt>, <tt>L2</tt>, <tt>DV</tt>,
<tt>MDV</tt>, <tt>TIME</tt>, <tt>DATE</tt>, <tt>DAT1</tt>,
<tt>DAT2</tt>, <tt>DAT3</tt>, <tt>DROP <br>
RAW_</tt> (nmv), <tt>MRG_</tt> (nmv), <tt>RPT_</tt> (nmvi),
<tt>REPL_</tt> (nm75)</p>

<p style="margin-left:33%; margin-top: 1em">The RAW_ data
item identifies template records for which NONMEM computes
and displays raw-data averages. With this feature, the
TEMPLT variable may be used in abbreviated code, and the
$OMIT record may be used. <br>
The MRG_ data item identifies records for which NONMEM
computes and displays marginal quantities (expectations).
<br>
The RPT_ data item identifies NONMEM&rsquo;s repeat data
item. It is used to mark a data record as a repetition base.
(Another way of doing this is via global &quot;Repetition
Variables&quot; RPTI, RPTO, RPTON, PRDFL in abbreviated
code.) <br>
The REPL_ data item identifies NONMEM&rsquo;s replication
data item. NONMEM replicates subjects from the template data
set at the start of the problem. REPL_ may be used with the
$DATA ... REPL option.</p>

<p style="margin-left:33%; margin-top: 1em">By using
<tt>ID</tt>, <tt>L1</tt>, <tt>L2</tt>, <tt>DV</tt>,
<tt>MDV</tt>, <tt>RAW_</tt>, <tt>MRG_</tt>, <tt>RPT_</tt>,
or <tt>REPL_</tt> as B, the user defines the NONMEM data
item type whose name corresponds to the label. The NONMEM
data item type whose name corresponds to <tt>ID</tt> is the
same NONMEM data item type whose name corresponds to
<tt>L1</tt>, but <tt>L1</tt> has another special meaning.
Use of <tt>L1</tt> not only defines the <tt>ID</tt> data
item, it <i>also</i> supresses automatic generated ID data
items (see section II.C.4).</p>

<p style="margin-left:33%; margin-top: 1em">By using
<tt>TIME</tt> as B, the user defines a time data item type;
time data items can be recognized as clock times and
translated to relative times (see section II.C.2 and the
discussion below).</p>

<p style="margin-left:33%; margin-top: 1em">By using
<tt>DATE</tt>, <tt>DAT1</tt>, <tt>DAT2</tt>, or
<tt>DAT3</tt> as B, the user defines a date data item type
(see section II.C.2 and the discussion below). Usually, date
data items should not appear in the NONMEM data set (see
below).</p>

<p style="margin-left:33%; margin-top: 1em">By using
<tt>DROP</tt> as B, the user defines a data item type which
will not appear in the NONMEM data set, e.g.
<tt>DATE=DROP</tt>. This is the one label that can be used
more than once in the $INPUT record. Ignoring items with
this label, the total number of items in a NM-TRAN data
record cannot exceed a certain limit, and, if the data set
is single-subject, this limit includes generated ID data
items (which actually do not appear in the NM-TRAN data
set).</p>

<p style="margin-left:33%; margin-top: 1em">Starting with
NONMEM 7.2, this limit is given by PD in resource/SIZES.f90.
The default value is 50. PD may be changed using the $SIZES
record. PD also specifies the maximum number of data items
in the NONMEM data set. With previous versions, the maximum
number of items in both NM-TRAN and NONMEM data sets was
20.</p>

<p style="margin-top: 1em">If the user prefers to label a
NONMEM data item type or a time data item type with a label
(A) other than the reserved one (B), he may use the item
A=B. In this case A is called a <b>synonym</b> for B.
Alternatively, he may use the item B=A, i.e. the order of
the labels A and B are reversed in the item so that the
reserved label comes first. Either of the labels A and B may
be used in subsequent control records of the problem
specification. However, only the synonym is used as a label
in NONMEM output. Both A and B can be reserved labels. Thus
one type of data item can serve simultaneously as another
type, e.g. <tt>ID=TIME</tt>. Another example of this is
<tt>DATE=DROP</tt>.</p>

<p style="margin-top: 1em">The items <tt>DROP</tt>,
<tt>A=DROP</tt>, or <tt>DROP=A</tt> are all equivalent. The
label <tt>SKIP</tt> acts just as does the label
<tt>DROP</tt>. The label <tt>DROP</tt> may not be used when
the $DATA record contains a format specification (see
section B.5).</p>

<p style="margin-top: 1em">Time data items are translated
from clock times to relative times when at least one time
data item contains a colon (:). Time data items are also
translated from clock times to relative times when the
reserved label <tt>DATE</tt>, <tt>DAT1</tt>, <tt>DAT2</tt>,
or <tt>DAT3</tt> is used. In this case the order of the
fields (day, month, year) must be the same across all the
date data items. This order corresponds to which label is
used:</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-40680061.png" alt="Image grohtml-40680061.png"></p>

<p style="margin-top: 1em">If only one field is used, it is
assumed to be the day field. If two fields are used, they
are assumed to be month and day fields. When two or more
fields are used, the user should be careful to use, for
example, <tt>DATE=DROP</tt>; otherwise, use of the nonumeric
separator will raise an error during the NONMEM run.</p>

<p style="margin-top: 1em">If the data set is
single-subject, ID data items are automatically generated,
unless the reserved label <tt>L1</tt> is used. A=<tt>L1</tt>
or <tt>L1</tt>=A can also be used. Generated ID data items
are assigned the label <tt>.ID.</tt> (i.e. <tt>ID</tt>
surrounded by dots). This label can be used in subsequent
NM-TRAN control records of the problem specification.</p>

<p style="margin-top: 1em">Changes to the $INPUT record may
cause changes to generated codes. In this case care should
be taken in using the previous load module.</p>

<p style="margin-top: 1em"><tt>INPT</tt> is an alias for
<tt>INPUT</tt>.</p>

<h2>III.III.III.B.3. $INDEX Record
<a name="III.III.III.B.3."></a>
<a name="III.III.III.B.3. $INDEX Record"></a>
</h2>


<p style="margin-top: 1em"><tt>$INDEX</tt> [@label sub
1@|@value sub 1@] [@label sub 2@|@value sub 2@] [@label sub
3@|@value sub 3@] ...</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$INDEX   DOSE  1</pre>

<p style="margin-top: 1em">The labels are those of data
items, as established by the $INPUT record. The values are
integers no larger than the number of (non-<tt>DROP</tt>)
items in the $INPUT record. Either (i) the index of the data
items with label @label sub I@, or (ii) @value sub I@,
whichever is chosen, is stored in INDXS(I). (The index of a
data item is its position in the NONMEM data record.) For
the above example, and using the $INPUT record shown in
chapter I: INDXS(1)=2, and INDXS(2)=1.</p>

<p style="margin-top: 1em">This record is optional, and it
need not appear unless some complete FORTRAN-coded
subroutines are developed by the user, and at least one of
these subroutines makes explicit use of the INDXS array.</p>

<p style="margin-top: 1em">INDXS is an array which is one
of the arguments to certain user-supplied subroutines; see
Guide I, section C.4.1, or Guide VI, sections III.C, IV.B,
and VI.A. The array cannot be used with an abbreviated code.
Therefore, the $INDEX record is not of interest to users of
NM-TRAN who only use abbreviated codes.</p>

<p style="margin-top: 1em">In the above description
INDXS(I) should be understood to always mean the Ith element
of the INDXS array that is available to a user-written
routine. With PREDPP the routine actually has access to only
part of a larger INDXS array, only to elements 12-50 of the
larger array. NM-TRAN stores the indices of certain data
items of use to PREDPP in elements 1-11, but PREDPP
renumbers elements 12-50 to 1-39 before passing INDXS as an
argument to the routine.</p>

<p style="margin-top: 1em"><tt>$INDXS</tt> is an alias for
<tt>$INDEX</tt>.</p>

<p style="margin-top: 1em">Commas between labels and values
are optional.</p>

<h2>III.III.III.B.4. $CONTR Record
<a name="III.III.III.B.4."></a>
<a name="III.III.III.B.4. $CONTR Record"></a>
</h2>


<p style="margin-top: 1em"><tt>$CONTR DATA=(</tt>[@label
sub 1@|<tt>0</tt>] [@label sub 2@|<tt>0</tt>] [@label sub
3@|<tt>0</tt>]<tt>)</tt></p>

<p style="margin-top: 1em">E.g.</p>
<pre>$CONTR    DATA=(0,TYPE)</pre>

<p style="margin-top: 1em">This record defines one to three
types of data items defined in the $INPUT record to be made
available to subroutines CONTR, CCONTR, and MIX in the DATA
array.</p>

<p style="margin-top: 1em">This record is optional and need
only appear if the CONTR, CCONTR, or MIX subroutine is
user-supplied and uses data items stored in the DATA
array.</p>

<p style="margin-top: 1em">@label sub i@ is the label (or
synonym) given in the $INPUT record for the ith data item
type.</p>

<p style="margin-top: 1em">The CONTR and CCONTR subroutines
are used to define an objective function which differs from
the default (ELS) objective function. The MIX subroutine is
used to describe the mixing parameter of a mixture model;
see Guide VI, section III.L.2. See also $MIX in Chapter
IV.L. <br>
These routines are called with individual records. An array
DATA is available in a NONMEM MODULE and changes value with
each individual record. It contains up to three types of
data items occuring in each observation record of an
individual record. For any individual record, the data item
occuring in the Ith observation record of the individual
record, having the Jth label occuring in the DATA option of
the $CONTR record, is available in DATA(I,J). If a
<tt>0</tt> is used in the DATA option instead of a label,
then a 0 is found in DATA(I,J).</p>

<p style="margin-top: 1em">Commas between labels and
<tt>0</tt>&rsquo;s are optional.</p>

<h2>III.III.III.B.5. $DATA Record
<a name="III.III.III.B.5."></a>
<a name="III.III.III.B.5. $DATA Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$DATA</i></tt>
[filename|*] [(format)] [<tt><i>IGNORE=</i></tt>@c sub 1@]
[<tt><i>NULL=</i></tt>@c sub 2@] <br>

[<tt><i>IGNORE=(</i></tt>list<tt><i>)</i></tt>...|<tt><i>ACCEPT=(</i></tt>list<tt><i>)</i></tt>...]
<br>
[<tt><i>PRED_IGNORE_DATA</i></tt>] <br>
[<tt><b>NOWIDE</b></tt>|<tt><i>WIDE</i></tt>]
[<tt><i>CHECKOUT</i></tt>] <br>
[<tt><i>RECORDS=</i></tt>@n sub
1@|<tt><i>RECORDS=</i></tt>label] <br>
[<tt><i>LRECL=</i></tt>@n sub 2@]
[<tt><b>NOREWIND</b></tt>|<tt><i>REWIND</i></tt>] <br>
[<tt><i>NOOPEN</i></tt>] [<tt><i>LAST20=</i></tt>@n sub 3@]
[<tt><i>TRANSLATE=(</i></tt>list<tt><i>)</i></tt>] <br>
[<tt><i>BLANKOK</i></tt>] <br>
[<tt><i>MISDAT=@r@</i></tt>...] <br>
[<tt><i>REPL=@n@</i></tt>...]</p>

<p style="margin-top: 1em">E.g. <tt>$DATA DATAFILE</tt></p>

<p style="margin-top: 1em">This record gives the name of
the file containing the NM-TRAN data set.</p>

<p style="margin-top: 1em">This record is required with the
first problem specification, and with any problem
specification where the NM-TRAN data set differs from that
of the preceding problem specification.</p>

<p style="margin-top: 1em">The filename must be the first
option on the record.</p>

<p style="margin-top: 1em">If the $DATA record is missing
from the problem specification, the problem uses the same
NONMEM data set as that used in the previous problem. With
the previous problem the user might have modified data items
from those found in the NONMEM data set at the beginning of
that problem (e.g. the modification may have occurred in the
simulation step, or in the initialization/finalization step
- see Guide II, section D.2.2, Guide VI, section VI.A), and
then the data set used in the current problem
(NONMEM&rsquo;s internal copy of the data set) contains the
modified data items. Using an asterisk in the $DATA record,
in place of the file name, has the same effect as omitting
the $DATA record. However, when one wants to use the
<tt>CHECKOUT</tt> option, as well as use the NONMEM data set
from the previous problem, the asterisk must be used. In
this case no other options should be used.</p>

<p style="margin-top: 1em">The format refers to a FORTRAN
format specification to be used by NM-TRAN to read the
NM-TRAN data records. Note that this specification is to be
enclosed in parentheses. Format codes F, E, and X may be
used, but not I. The format will also be used by NONMEM to
read the NONMEM data records, after it had been modified to
account for generated data items. If a format is provided,
the label DROP cannot be used, and the WIDE and NULL options
may not be used. If a format is omitted, the NM-TRAN records
can still be read, and a format specification which is
appropriate for reading the NONMEM data records will be
generated. In this case a NONMEM data set is found in FDATA
(see section II.B).</p>

<p style="margin-top: 1em">The IGNORE option specifies
records to be dropped from the NONMEM data set.</p>

<p style="margin-left:33%; margin-top: 1em">When
<tt>IGNORE=</tt>@c sub 1@ is coded and the character @c sub
1@ appears in column one of a (FORTRAN) record of the data
set, this record does not appear in the NONMEM data set.
Such records can serve as comment records in the NM-TRAN
data set (see section II.C.3). The character @c sub 1@ can
be any character other than a blank or semicolon. In the
$DATA record it can be enclosed by single quotes or by
double quotes, in which case a semi-colon is permitted. The
default is <tt>IGNORE=#</tt>. That is, in the absence of
IGNORE option, any record whose first character is # is
treated as a comment record.</p>

<p style="margin-left:33%; margin-top: 1em">IGNORE=@
signifies that any data record having an alphabetic
character or @ as its first non-blank character (not just in
column 1) should be ignored. Alphabetic characters are the
letters A-Z and a-z. This permits a table file having header
lines to be used as an NM-TRAN data set.</p>


<p style="margin-left:33%; margin-top: 1em"><tt>IGNORE=(</tt>list<tt>)</tt>
is new with NONMEM 7.</p>


<p style="margin-left:33%; margin-top: 1em">&quot;List&quot;
is a list of one or more data item labels, with logical
operators and values, of the form &quot;label=value&quot;,
&quot;label.EQ.value&quot;, &quot;label.NE.value&quot;,
&quot;label.GT.value&quot;, &quot;label.GE.value&quot;,
&quot;label.LT.value&quot;, and &quot;label.LE.value&quot;.
(FORTRAN 90 logical operators such as &rsquo;==&rsquo;
&rsquo;/=&rsquo; &rsquo;&lt;&rsquo; &rsquo;&lt;=&rsquo;
&rsquo;&gt;&rsquo; &rsquo;&gt;=&rsquo; &quot; may also be
used.) With NONMEM 7.3, &quot;label.NEN.value&quot; and
&quot;label.EQN.value&quot; are permitted. (There is no
FORTRAN 90 operator for this comparison.) If the logical
operator is omitted, the default is &quot;=&quot;. With each
data record, the value of the data item with the given label
and the value in the list are compared according to the
logical operator, and if result is &quot;true&quot;, the
record is ignored, i.e. it is not included in the NONMEM
data set (see example below). Such records are called
&quot;dropped records&quot;. With &quot;=&quot;,
&quot;==&quot;, &quot;/=&rsquo;, &quot;.EQ.&quot; and
&quot;.NE.&quot;, the value in the data record and the value
in the list are compared as character strings. Otherwise,
they are converted to numeric and compared numerically.
(This is the case with .NEN. and .EQN.) This comparison is
made prior to time translation. Hence, the TIME item cannot
be compared numerically if it contains non-numeric
characters such as &quot;:&quot;.</p>

<p style="margin-left:33%; margin-top: 1em">Note: if the
data file is a table file from a previous NONMEM run, values
that had been integers (0,1,..) in the original data file
will be real values (0.000E+00, 1.000E+00, ...) in the table
file. A comparison for equality or inequality should now be
for the real value. E.g. <tt><br>
IGNORE=(OCC==1.000E+00)</tt>.</p>

<p style="margin-left:33%; margin-top: 1em">A data item
label along with a logical operator and value is called a
condition. A list may contain several conditions; these
should be separated by commas, and the list should be
enclosed in parentheses. Up to 100 different conditions
altogether can be specified. Multiple IGNORE options with
different lists may be used. A list may span one or more
NM-TRAN records. The use of &quot;=&quot; after IGNORE is
optional, but parentheses are required with this form of
IGNORE. Values may be alphabetic or numeric, and may
optionally be surrounded by single quotes &rsquo; or double
quotes &quot;. Quotes are required if a value contains
special characters such as =. However, a value may not
contain spaces or commas. No format specification is
permitted with this form of IGNORE.</p>

<p style="margin-left:33%; margin-top: 1em">A data item
type may be dropped from the NONMEM data set by means of the
DROP or SKIP synonym on the $INPUT record, after records are
dropped due to a condition based on the data item type.
E.g., &nbsp;&nbsp;</p>

<pre style="margin-left:33%;">  $INPUT ... GEN=SKIP ...&nbsp;&nbsp;
  $DATA file IGNORE=(GEN=&rsquo;M&rsquo;)</pre>


<p style="margin-left:33%;">Records having GEN equal to
&rsquo;M&rsquo; will be dropped, and the GEN data item type
will then be omitted from the NONMEM data set. A dropped
data item may be any alphanumeric string (without a data
item delimiter - a blank or a comma).</p>

<p style="margin-left:33%; margin-top: 1em">If there is
more than one condition, then records satisfying at least
one of these conditions will be dropped. In effect, the
conditions for dropping a record are connected by the
implied conjunction &quot;.OR.&quot;. E.g. &nbsp;&nbsp;
<tt><br>
IGNORE=(GEN.EQ.1,AGE.GT.60)</tt>. <br>
Records having GEN equal to 1 or AGE greater than 60 are
dropped. All others are accepted.</p>


<p style="margin-top: 1em"><tt>ACCEPT=(</tt>list<tt>)</tt></p>

<p style="margin-left:33%; margin-top: 1em">The ACCEPT list
option is identical to the IGNORE list option, except that
it specifies conditions for acceptance of records. An ACCEPT
list cannot be used together with an IGNORE list.</p>

<p style="margin-left:33%; margin-top: 1em">E.g.
&nbsp;&nbsp; <tt><br>
ACCEPT=(GEN.EQ.1,AGE.GT.60)</tt>. <br>
Records having GEN equal to 1 or AGE greater than 60 are
accepted. All others are dropped.</p>

<p style="margin-left:33%; margin-top: 1em">Suppose it is
desired that records be dropped that satisfy the logical
&quot;.AND.&quot; of several conditions. This can be
implemented by using an ACCEPT list with the negations of
the conditions. For example, suppose that records to be
ignored are those having GEN=1 .AND. AGE &gt; 60. This may
be done as follows: &nbsp;&nbsp; <tt><br>
ACCEPT=(GEN.NE.1,AGE.LE.60)</tt></p>

<p style="margin-left:33%; margin-top: 1em">It is possible
to implement more complicated expressions, e.g., with nested
parentheses. <br>
See Guide VIII Ignore_accept example.</p>

<p style="margin-top: 1em">The PRED_IGNORE_DATA option is
new to NONMEM 7.5. Data records may be dropped using by PRED
or PREDPP using the PRED_IGNORE_DATA block of abbreviated
code. See Chapter IV.E.6. This option informs NONMEM that a
PRED_IGNORE_DATA pass through the data set is required. If
the abbreviated code uses variables PRED_IGNORE_DATA or
PRED_IGNORE_DATA_TEST, this option is supplied. The explicit
option is needed if the use of the PRED_IGNORE_DATA
variables occurs in user-written or verbatim code, so that
NMTRAN is unaware of it. <br>
(See Guide Introduction_7 &quot;PRED_IGNORE_DATA Feature
(NM75)&quot;)</p>

<p style="margin-top: 1em">Option <tt>NULL=
<img src="grohtml-4068006-4.png" alt="Image grohtml-4068006-4.png"></tt>
specifies the character used for null data values in the
NONMEM data set. Every occurrence in the NM-TRAN data set of
a dot surrounded by blanks/commas/tab characters, or of
consecutive commas or consecutive tab characters, is
replaced by a null data item in the NONMEM data set. Null
data items are also supplied for data items that are missing
from the end of an NM-TRAN data record (there may be several
missing from the end of any given record) but that are
defined in the $INPUT record. This null data item consists
of the specified character
<img src="grohtml-4068006-5.png" alt="Image grohtml-4068006-5.png">
, and it occupies the last position in the field of the
NONMEM data set into which it is placed. The character
<img src="grohtml-4068006-6.png" alt="Image grohtml-4068006-6.png">
can be enclosed by single quotes or by double quotes. The
default for
<img src="grohtml-4068006-7.png" alt="Image grohtml-4068006-7.png">
is a blank.</p>

<p style="margin-top: 1em">The option <tt>NOWIDE</tt>
specifies that the FORTRAN records of the NONMEM data set,
generated by NM-TRAN, are to consist of up to 80 characters.
In order to accomplish this NM-TRAN may need to suppress
space between fields or generate multi-line NONMEM data
records. This is the default. The option <tt>WIDE</tt>
specifies that single-line NONMEM data records are to be
generated if possible. These records always include at least
one space between fields. With this option the records can
be up to 300 characters. (Note that they will be multi-line
if 300 characters is too few.) They comprise a NONMEM data
set which may be more legible than one obtained without
using <tt>WIDE</tt>, and which can be processed by a program
other than NONMEM. With this option, there will be no FINISH
(FIN) record in the NONMEM data set. (A FINISH record is
generated with there are more than 99999999 records in the
NONMEM data set.) <tt>WIDE</tt> also provides an extra
character for elapsed times, so that they can accommodate
the number of hours in (approximately) 4166 days with a
leading space. Six digits (xxxxxx.xx) are provided.</p>

<p style="margin-top: 1em">The option <tt>CHECKOUT</tt>
specifies that NONMEM is to run in data checkout mode. In
this mode, tables and scatterplots can be requested, so that
the data (as &quot;understood by NONMEM&quot;) can be
examined, but no computations involving the model are
performed, so that this examination cannot be hindered by
problems with the logic in user-written routines or
abbreviated codes. These routines and codes need only be
syntactically correct. The predictions, residuals, weighted
residuals, <tt>ETA</tt>&rsquo;s and PRED-defined items that
are displayed in tables and scatterplots (see sections B.16
and IV.F) are all 0. <tt>CHECKDATA</tt> can be used as an
alias.</p>

<p style="margin-top: 1em">When the <tt>RECORDS=
<img src="grohtml-4068006-8.png" alt="Image grohtml-4068006-8.png"></tt>
option is used, the number
<img src="grohtml-4068006-9.png" alt="Image grohtml-4068006-9.png">
is the number of data records to be read from the NM-TRAN
data set. Comment records are not counted. If NM-TRAN does
not drop any records from its data set (see IGNORE list and
ACCEPT list), then
<img src="grohtml-4068006-10.png" alt="Image grohtml-4068006-10.png">
is also the number of records written to the NONMEM data
set. If NM-TRAN drops records, then the total number of
records written to the NONMEM data set is
<img src="grohtml-4068006-11.png" alt="Image grohtml-4068006-11.png">
minus the number of dropped records. This number must be no
more than 99,999,999. When the option is omitted, then there
is no limit to the number of data records in the NM-TRAN
data set. In this case the file is read to a FINISH record
(see below), or to the physical end of file, whichever comes
first. However, if there are 100,000,000 or more records,
then it is suggested that a FINISH record be used since in
this case and when, moreover, the NONMEM data set happens to
coincide with the NM-TRAN data set, the NONMEM data set
needs a FINISH record.</p>

<p style="margin-top: 1em"><tt>RECORDS=</tt>label</p>

<p style="margin-left:33%; margin-top: 1em">If the option
is coded as <tt>RECORDS=</tt>label, where label is a data
item label, NM-TRAN understands the data records for the
problem to start with the first data record of the NM-TRAN
data set (at the place where the file is positioned before
data records are read; see the NOREWIND option), and to
include as well, those and only those subsequent contiguous
data records having the same value of the data item as does
the first record. It counts the total number of these data
records, minus any comment or dropped records, and puts this
number in the NONMEM control file.</p>

<p style="margin-left:33%; margin-top: 1em">In particular,
the ID label may be used (or alternatively, the option may
be coded <tt>RECORDS=IR</tt>, <tt>RECORDS=INDREC</tt>, or
<tt>RECORDS=INDIVIDUALRECORD</tt>). If a label other than ID
is used, the $INPUT record must precede the $DATA record. If
the data are single-subject data, the ID data items used to
determine the data records for the problem are those labeled
ID (not .ID.).</p>

<p style="margin-left:33%; margin-top: 1em">If there is
more than one problem specification with a $DATA record that
includes an option of the form <tt>RECORDS=</tt>label, then
either none of these $DATA records may also include a format
specification, or all of them must include the same format
specification.</p>

<p style="margin-top: 1em">The <tt>LRECL</tt> option is
only needed when the format is omitted, and when either (i)
the operating system (e.g. IBM/CMS) raises a fatal error
when a FORTRAN program tries to read more characters from a
logical record than the number of characters in the record,
or (ii) the operating system imposes a maximum record length
which is smaller than 999 characters (e.g. CRAY/CTSS). The
number
<img src="grohtml-4068006-12.png" alt="Image grohtml-4068006-12.png">
is the number of characters in the NM-TRAN data records.</p>

<p style="margin-top: 1em"><tt>NOREWIND</tt> specifies that
the file is not to be rewound before it is read, and
<tt>REWIND</tt> specifies that the file is to be rewound.
These options are ignored if used on the $DATA record
appearing in the first problem specification of the NM-TRAN
control stream, or on a $DATA record appearing in a
subsequent problem specification when this record contains a
file name different from that contained on the $DATA record
of the prior problem specification. In these cases the file
is automatically rewound. The <tt>REWIND</tt> and
<tt>NOREWIND</tt> options are significant only when there
are multiple problem specifications in the NM-TRAN control
stream, and when the $DATA records appearing in two
consecutive problem specifications, corresponding to two
problems A and B, contain the same file name. In this
situation:</p>

<p style="margin-left:33%; margin-top: 1em">When the
<tt>REWIND</tt> option is used on the the $DATA record for
problem B, the first NM-TRAN data set on the file is re-used
for problem B. If NM-TRAN does not modify this data set,
then an instruction to rewind the (same) file is also
contained in the NONMEM control stream problem specification
for problem B. If NM-TRAN does modify the data set, then the
NONMEM data set for problem B is placed on FDATA after the
last NONMEM data set already present on FDATA, and no
instruction to rewind FDATA is contained in the NONMEM
control stream problem specification for problem B.</p>

<p style="margin-left:33%; margin-top: 1em">If the
<tt>NOREWIND</tt> option is used on the $DATA record for
problem B, or neither option is used, then the file is not
rewound, and the NM-TRAN data set on this file that follows
the one used for problem A is used for problem B. In this
case note that the $DATA record with problem A must have
contained the <tt>RECORDS</tt> option or the NM-TRAN data
set used for problem A must end with a FINISH record. Also
in this case, no instruction to rewind the file containing
the NONMEM data set for problem B (whether this file is the
file named in the $DATA record or whether it is FDATA) is
contained in the NONMEM control stream problem specification
for problem B.</p>

<p style="margin-top: 1em"><tt>NOOPEN</tt> specifies that
the file is not to be opened by NM-TRAN. It permits a data
file to be created by one problem and used in a subsequent
problem of the same run.</p>

<p style="margin-top: 1em">Translation of NM-TRAN data
records is a slower process than is translation of NM-TRAN
control records. However, usually during a data analysis,
changes are made to the NM-TRAN control records between
runs, but not to the NM-TRAN data records. With large data
sets once translation of the data records has been performed
successfully, the output in FDATA can be stored (in a file
of a different name) and used with subsequent NM-TRAN runs.
In a subsequent run, use the format specification and value
for
<img src="grohtml-4068006-13.png" alt="Image grohtml-4068006-13.png">
found in the problem summary pages of the NONMEM output from
the first run. If data items were dropped or generated, then
use the list of &quot;LABELS FOR DATA ITEMS&quot;, found in
this earlier output, for the list of labels needed in the
$INPUT record. If the data set is single-subject, and ID
data items were generated, use L1 for the label of these
data items.</p>

<p style="margin-top: 1em"><tt>LAST20</tt>,
<tt>BLANKOK</tt>, <tt>TRANSLATE</tt></p>

<p style="margin-top: 1em">See Chapter II</p>

<p style="margin-top: 1em"><tt>MISDAT=
<img src="grohtml-4068006-14.png" alt="Image grohtml-4068006-14.png"></tt>
...(nm74) Defines one or more particular numerical values to
indicate a missing data value in the data set, which is
displayed on $TABLE outputs, but is safely interpreted as 0
by other steps of NONMEM.</p>

<p style="margin-top: 1em"><tt>REPL=n</tt> (NM75) When the
REPL=n option of $DATA is coded, the NONMEM data set is
considered to be a template data set. NONMEM itself
replicates the template data set n times at the start of the
problem to create an expanded NONMEM data set. The REPL
option may be used with the REPL_ data item. If both are
used the REPL_ data item applies first, and the REPL option
applies second. The REPL option and REPL_ data item are
meant to be used with $SIMULATION or $DESIGN. <br>
(See Guide Introduction_7 &quot;$DATA REPL (NM75)&quot;)</p>

<p style="margin-top: 1em">See Introduction to NONMEM 7 and
Guide VIII and on-line help.</p>

<p style="margin-top: 1em"><tt>$INFILE</tt> is an alias for
<tt>$DATA</tt>.</p>

<p style="margin-top: 1em">When a format is omitted, a
FINISH record consists of the characters FIN appearing
<i>anywhere</i> in the record (the other characters are all
blank). When a format is provided, a FINISH record must have
the form described in Guide II, section D.2.3.</p>

<h2>III.III.III.B.6. $SUBROUTINES Record
<a name="III.III.III.B.6."></a>
<a name="III.III.III.B.6. $SUBROUTINES Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$SUBROUTINES</i></tt>
[subname1 = name1] [subname2 = name2] ... <br>
[<tt><i>SUBROUTINES=</i></tt>kind]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$SUBROUTINES    PRED=mypred</pre>

<p style="margin-top: 1em">This record gives names
associated with any subroutines which are user-supplied,
i.e. for which abbreviated codes are not given.
User-supplied FORTRAN codes are copied to the FSUBS file.
The names and subnames are also listed in the FREPORT file.
This file is needed for documentation purposes, and it also
can be used as input to a program such as nmfe that creates
system commands for running NONMEM.</p>

<p style="margin-top: 1em">This record is only required
with the first problem specification, and then only if the
record contains some option. It applies to all problem
specifications in the control stream, and it must not appear
with a problem specification other than the first.</p>

<p style="margin-top: 1em">A subname may be chosen from the
list: <tt>PRED</tt>, <tt>CRIT</tt>, <tt>CONTR</tt>,
<tt>CCONTR</tt>, <tt>CONPAR</tt>, <tt>USMETA</tt>,
<tt>SPTWO</tt>, <tt>MIX</tt>, <tt>PRIOR</tt></p>

<p style="margin-top: 1em">The names on the right are the
names of files containing FORTRAN 90/95 code. These follow
the usual rules for filenames on control records; see A.10
above. An extension such as &quot;.f&quot; or
&quot;.f90&quot; may be part of the file name for
descriptive purposes, but the file itself should contain
FORTRAN 90/95 code. A file may contain more than one FORTRAN
subroutine. A name could be the same as the subname, but a
subname is generic, and a name which is more specifically
related to the actual code comprising the subroutine can be
more useful. One subname-name pair should be used for each
subroutine which is user-supplied.</p>

<p style="margin-top: 1em">If the PRED subroutine is not
user-supplied, so that <tt>PRED</tt> is not used as a
subname, then an abbreviated code must be given for $PRED
(unless PREDPP is used; see chapter V). Abbreviated code can
also be given for $MIX; see Chapter IV.L. The $PRIOR record
can be used to provide instructions for a generated PRIOR
subroutine in FSUBS; see B.23 below. FORTRAN code must be
provided if the remaining subnames are user-supplied.</p>

<p style="margin-top: 1em">There may exist one or more
&quot;other&quot; user-supplied subroutines used by one of
the subroutines listed above. The special subname
<tt>OTHER</tt> can be used in conjunction with such a
routine; it is set to a name of a file to be read by
NM-TRAN. (A subroutine B, called by subroutine A, can be
included in the file containing A. In this case
<tt>OTHER</tt> would not be set to a name for B.) Unlike the
other subnames, <tt>OTHER</tt> can appear up to forty times
in the $SUBROUTINES record, and used for up to forty unique
file names. Here are some examples.</p>

<p style="margin-top: 1em">The <tt>OTHER</tt> option is
used to supply the FORTRAN code for user-written functions,
e.g., the reserved functions FUNCA, FUNCB, FUNCC, etc., or,
with NONMEM 74, functions declared using the $ABBR FUNCTION
option. Suppose there is one such file and its name is
funcfile. (File funcfile may contain more than one
FUNCTION.) It should be listed on the $SUBROUTINES record.
E.g.,</p>
<pre>$SUBROUTINES ... OTHER=funcfile</pre>

<p style="margin-top: 1em">Another example of the use of
<tt>OTHER</tt> has to do with the NONMEM subroutine
CONSTRAINT. The default version found in NONMEM&rsquo;s
source directory (source/CONSTRAINT.f90) performs simulated
annealing, and uses information from the $ANNEAL record. See
section B.29. below. The OTHER option is not needed if the
default version is to be used. See anneal.ctl in
NONMEM&rsquo;s example directory.</p>

<p style="margin-top: 1em">A user-written subroutine
CONSTRAINT may be used instead to provide any kind of
constraint pattern on any parameters. Example9.ctl in
NONMEM&rsquo;s examples directory contains</p>
<pre>$SUBROUTINES ... OTHER=aneal.f90</pre>

<p>File aneal.f90 contains an alternative version of
subroutine CONSTRAINT and is discussed in Introduction to
NONMEM 7 &quot;Example 9: Simulated Annealing For Saem using
Constraint Subroutine.&quot;</p>

<p style="margin-top: 1em">If the <tt>SUBROUTINES</tt>
option is not used, it is understood to be present with the
option &quot;kind&quot; equal to <tt>DOUBLE</tt>.
<tt>DP</tt> and <tt>D</tt> are aliases for <tt>DOUBLE</tt>.
<tt>SUBS</tt> is an alias for <tt>SUBROUTINES</tt>. The
<tt>SUBROUTINES</tt> option may be coded with the part
<tt>SUBROUTINES=</tt> missing.</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$SUB  DP</pre>

<h2>III.III.III.B.7. $ABBREVIATED Record
<a name="III.III.III.B.7."></a>
<a name="III.III.III.B.7. $ABBREVIATED Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$ABBREVIATED</i></tt>
[<tt><i>COMRES=
<img src="grohtml-4068006-15.png" alt="Image grohtml-4068006-15.png"></i></tt>
] [<tt><i>COMSAV=
<img src="grohtml-4068006-16.png" alt="Image grohtml-4068006-16.png"></i></tt>
] <br>
[<tt><i>DERIV2=NO</i></tt>]
[<tt><i>DERIV2=NOCOMMON</i></tt>]
[<tt><i>DERIV1=NO</i></tt>] <br>
[<tt><i>FASTDER</i></tt> | <tt><i>NOFASTDER</i></tt>] <br>
[<tt><i>CHECKMU</i></tt> | <tt><i>NOCHECKMU</i></tt>] <br>
[<tt><i>DES=COMPACT</i></tt> | <tt><i>DES=FULL</i></tt>]
<br>
[<tt><i>REPLACE</i></tt> left_string = right_string ] ...
<br>
[<tt><i>DECLARE</i></tt> [type] [DOWHILE] name [(dimension
[,dimension])] ... <br>
[<tt><i>PROTECT</i></tt>] <br>
[<tt><i>FUNCTION
function_name(input_vector_name,dimension[,usage])</i></tt>]
<br>
[<tt><i>VECTOR input_vector_name(dimension)</i></tt>]</p>

<p style="margin-top: 1em">E.g. <tt>$ABBREVIATED
COMRES=2</tt></p>

<p style="margin-top: 1em">Optional. May be used when $PK,
$ERROR, or $PRED abbreviated code is present. Must precede
all blocks of abbreviated code. appear. Then it only should
appear with the first problem specification, and before any
abbreviated code. With NONMEM 7.4, may also be used when
there is no abbreviated code. For example, $ABBR REPLACE may
be used for label substitution in NONMEM report files.</p>

<p style="margin-top: 1em">Abbreviated code is described in
Chapters IV and V.</p>

<p style="margin-top: 1em"><tt>COMRES</tt> (&quot;common
reserve&quot;) and <tt>COMSAV</tt> (&quot;common
save&quot;)</p>

<p style="margin-top: 1em">One use of the option
<tt>COMRES</tt> involves the presence of both abbreviated
and user-supplied subroutines. Values for variables defined
in abbreviated codes may be displayed in tables and
scatterplots. These variables are listed (i.e. their values
are stored) in a NONMEM MODULE NMPRD4 in the generated
subroutine. (With versions of NONMEM prior to nm7, NMPRD4
was a named FORTRAN common, hence the use of options
&quot;COM...&quot;.) User-supplied FORTRAN routines may also
list variables whose values are to be displayed in NMPRD4.
The first
<img src="grohtml-4068006-17.png" alt="Image grohtml-4068006-17.png">
positions in NMPRD4 are reserved for the use of these
routines; generated subroutines will not list variables
defined in abbreviated codes in these positions. If there
are no abbreviated codes, not only is <tt>COMRES</tt> not
needed for this purpose, it may not be used. All variables
listed in NMPRD4 must be double precision. The number
<img src="grohtml-4068006-18.png" alt="Image grohtml-4068006-18.png">
can be nonnegative, and if the option is not used, it is
understood to be 0. It can also be -1, in which case no
variables defined in abbreviated codes are listed in NMPRD4.
In this regard, see also section IV.H.</p>

<p style="margin-top: 1em">All variables defined in an
abbreviated code are listed in NMPRD4, whether or not their
values are displayed. Thus with PREDPP, where there may be
more than one abbreviated code, each such variable is
recognized as the same variable in all abbreviated codes in
which it is used. If it desireable to avoid this type of
global definition, then the option value -1 can be used. See
also section IV.H.</p>

<p style="margin-top: 1em">The option <tt>COMSAV</tt> may
be used when the variable <tt>COMACT</tt> is used in
abbreviated code (see section IV.E.2). It defines the SAVE
region of NMPRD4. In this case the option <tt>COMRES</tt>
should also be used, and
<img src="grohtml-4068006-19.png" alt="Image grohtml-4068006-19.png">
must satisfy
<img src="grohtml-4068006-20.png" alt="Image grohtml-4068006-20.png">
.</p>

<p style="margin-top: 1em">The next two options primarily
concern ways to avoid changing and recompiling NM-TRAN or
NONMEM source code when NM-TRAN produces error messages
indicating that certain internal table sizes are found to be
too small for a given problem; see Guide III. In this
regard, the option <tt>COMRES=-1</tt> can also be useful
(see also section IV.H). With NONMEM 7, NM-TRAN allocates
most internal arrays dynamically as needed. The $SIZES
record can be used to make other arrays larger. Internal
table sizes are unlikely to be exceeded. However, when there
is a great deal of abbreviated code, the generated code and
the NONMEM load module may be very large, which can slow the
execution of NM-TRAN and NONMEM. The following options may
still be useful.</p>

<p style="margin-top: 1em"><tt>DERIV2=NO</tt> and
<tt>DERIV2=NOCOMMON</tt></p>

<p style="margin-top: 1em">When the option
<tt>DERIV2=NO</tt> is used, code to compute second-partial
derivatives with respect to
<img src="grohtml-4068006-21.png" alt="Image grohtml-4068006-21.png">
variables is not generated from abbreviated codes. These
derivatives are only needed when the Laplacian estimation
method is used (see section B.14). So in order to save CPU
time one might be tempted to use this option when the
Laplacian method is not used. However, when the Laplacian
method is not used, the code computing the second
derivatives is never executed. Therefore usually, there is
little reason to include the option. It is generally
recommended that the option not appear, so that with
generated subroutines, a load module that computes these
derivatives can also be used in a subsequent run which uses
the Laplacian method. If it does appear, if PREDPP is not
used, and if the Laplacian estimation method is requested in
a subsequent run using the same load module, then, in
effect, the first-order conditional estimation method is
used in that run, although using somewhat more computer time
than is necessary. However, care should be taken to avoid
this situation. If the option appears, and PREDPP is used,
then the Laplacian estimation method must not be requested
in a subsequent run using the same load module, even when
all second-partial derivatives that might be computed are
uniformly zero (in which case code computing these zeros is
actually not generated whether or not the option
appears).</p>

<p style="margin-top: 1em">Values of second-partial
derivatives of a variable defined in an abbreviated code are
stored in other variables defined in the generated routine.
Normally, these variables are listed are also listed in
NMPRD4 (see above). When the option <tt>DERIV2=NOCOMMON</tt>
is used, these variables are not listed in NMPRD4. In this
case these variables are not displayable. In this case also,
if PREDPP is used, <i>no variable defined in the abbreviated
code for PK</i>, may be referenced in the abbreviated code
for ERROR.</p>

<p style="margin-top: 1em">In the generated subroutine,
NM-TRAN collects (re-arranges) all code for second
derivative computation so that only a few tests (for
MSEC==1; see Chapter IV.E.4) are needed to compute them when
NONMEM indicates that it needs second-partial derivatives,
and skip them otherwise.</p>

<p style="margin-top: 1em"><tt>FASTDER</tt> and
<tt>NOFASTDER</tt> (nm72)</p>

<p style="margin-top: 1em">Code to compute first-partial
derivatives with respect to
<img src="grohtml-4068006-22.png" alt="Image grohtml-4068006-22.png">
variables is always generated from abbreviated codes. These
derivatives are almost always needed by classical NONMEM
methods with population data. However, NONMEM does not
always use these derivatives for the newer Bayesian methods.
Since NONMEM 7.2, NM-TRAN collects (re-arranges) all code
for first derivative computation so that only a few tests
(for FIRSTEM==1; see Chapter IV.E.4) are needed to compute
them when NONMEM indicates that it needs first-partial
derivatives, and skip them otherwise. This is explicitly
requested by option <tt>FASTDER</tt>, which is the default.
The collection (re-arrangement) of first derivative code can
be prevented with option <tt>NOFASTDER</tt>.</p>

<p style="margin-top: 1em"><tt>DERIV1=NO</tt> (nm74)</p>

<p style="margin-top: 1em">With NONMEM 7.4,
<tt>DERIV1=NO</tt> prevents the computation of first
derivatives.</p>

<p style="margin-top: 1em"><tt>CHECKMU</tt> and
<tt>NOCHECKMU</tt> (nm73)</p>

<p style="margin-top: 1em">Abbreviated code may contain
statements for the MU model, which is used in NONMEM 7 EM
(Expectation Maximization) methods and Gibbs sampling
methods. See Chapter IV K.3. With NONMEM 7.3, NM-TRAN checks
the MU model statements and issues warning messages if they
appear to contain mistakes. This can take a long time for
large control streams. For some models, NM-TRAN may be
unable to do so, or may issue inappropriate warnings. Option
<tt>NOCHECKMU</tt> can be used to prevent NM-TRAN from
attempting to check the MU model statements. Option
<tt>CHECKMU</tt> requests that MU model statements be
checked, and is the default. Neither option affects the
generated code.</p>

<p style="margin-top: 1em"><tt>DES=FULL</tt></p>

<p style="margin-top: 1em">Requests that arrays of the DES
routine are stored in non-compact form. With $ESTIMATION
METHOD=COND LAPLACIAN, the option NUMERICAL is also
required. <tt>DES=FULL</tt> is the default with ADVAN9 and
ADVAN15 and ADVAN17. (Prior to NONMEM 7.4, FULL was required
with ADVAN13.)</p>
<pre style="margin-top: 1em"> DES=COMPACT</pre>

<p style="margin-top: 1em">Arrays of the DES routine are
stored in compact form. Required with Laplacian method;
optional otherwise. This is the default, except with ADVAN9
and ADVAN15 and ADVAN17.</p>

<p style="margin-top: 1em"><tt>$ABBREVIATED REPLACE</tt>
option (nm73)</p>

<p style="margin-top: 1em">Any character string may be
replaced in abbreviated code. In particular, this allows for
symbolic labeling of thetas, etas, and epsilons. For
example,</p>

<pre style="margin-top: 1em">$ABBR REPLACE ETA(CL)=ETA(5)</pre>


<p>The characters <tt>ETA(CL)</tt> are replaced by
<tt>ETA(5)</tt> where ever they appear in abbreviated code.
<br>
See Guide VIII for more features of $ABBR REPLACE. <br>
See $OMEGA and $SIGMA record for an alternate way of naming
the ETA and EPS using NAMES and VALUES options.</p>

<p style="margin-top: 1em">With NONMEM 74, use of this
option may affect the NONMEM report file, even when there is
no abbreviated code.</p>

<p style="margin-top: 1em">Either ETA(CL) or ETA5 may be
listed in the $TABLE or $SCATTER records, and the label in
the NONMEM report file is &quot;<tt>ETA(CL)</tt>&quot;. This
is called <b>label substitution.</b></p>

<p style="margin-top: 1em">The $ESTIMATION, $TABLE,
$SCATTER, and $DEFAULT records all have an option
<tt>NOSUB</tt> that can be used to control label
substitution for that portion of the report. In general,
with <tt>NOSUB=0</tt>, label substitution occurs. E.g., the
label in the NONMEM report file is
&quot;<tt>ETA(CL)</tt>&quot;. This is the default. With
<tt>NOSUB=1</tt>, label substitution is turned off. E.g.,
the label is &quot;<tt>ETA5</tt>&quot;.</p>

<p style="margin-top: 1em">Label substitution is never made
in the additional output files *.ext, ,phi, etc., to
maintain their third party software readability.</p>

<p style="margin-top: 1em">Compartment names may be
explicitly replaced. For example,</p>

<pre>$ABBR REPLACE A(DEPOT)=A(1)
$ABBR REPLACE DADT(DEPOT)=DADT(1)&nbsp;
  ...
$DES DADT(DEPOT)=-KA*A(DEPOT)</pre>


<p style="margin-top: 1em">This is called
&quot;explicit&quot; compartment name substitution. With
NONMEM 7.5, compare the &quot;implicit&quot; compartment
name substitution feature of the $MODEL record.</p>

<p style="margin-top: 1em">The REPLACE option also allows
replacement with selection. This provides a compact way of
writing complicated abbreviated code. Here is an example of
replacement with selection by data item. Suppose OCC is a
data item.</p>

<pre style="margin-top: 1em">$ABBR REPLACE THETA(OCC)=THETA(4,7)</pre>


<p style="margin-top: 1em">Supppose the abbreviated code
is:</p>

<p style="margin-top: 1em"><tt>TVCL=THETA(OCC)</tt></p>

<p style="margin-top: 1em">The generated code is:</p>

<pre style="margin-top: 1em">IF (OCC==1) TVCL=THETA(4)
IF (OCC==2) TVCL=THETA(7)</pre>


<p style="margin-top: 1em">Here is an example of
replacement with selection by data item and parameter:</p>

<pre style="margin-top: 1em">$ABBR REPLACE THETA(SID_KA)=THETA(4,6)
$ABBR REPLACE THETA(SID_CL)=THETA(5,7)&nbsp;
  ...
$PK
KA=THETA(SID_KA)
CL=THETA(SID_CL)</pre>


<p style="margin-top: 1em">The generated code is</p>

<pre>IF (SID==1) KA=THETA(4)
IF (SID==2) KA=THETA(6)
IF (SID==1) CL=THETA(5)
IF (SID==2) CL=THETA(7)</pre>


<p style="margin-top: 1em">A short-hand notation may be
used to describe a series of values, e.g.,</p>

<pre>$ABBR REPLACE THETA(SID_KA)=THETA(,4 to 13 by 3)
is equivalent to
$ABBR REPLACE THETA(SID_KA)=THETA(4,7,10,13)</pre>


<p style="margin-top: 1em">$ABBREVIATED DECLARE option
(nm73)</p>

<p style="margin-top: 1em">Integers and arrays may be
declared and used in abbreviated code:</p>

<pre style="margin-top: 1em">$ABBR DECLARE DOSE(100),DOSETIME(100)
$ABBR DECLARE INTEGER I
$ABBR DECLARE DOWHILE I</pre>


<p style="margin-top: 1em">One or names may be coded. They
are referred to as <b>declared variables.</b> If INTEGER or
DOWHILE is coded, the type of the variable is integer.
Otherwise, the type of the variable is double precision. If
one or two dimensions are declared, the variable being
declared is an array. Declared variables are global, i.e.,
are defined in all blocks of abbreviated code. Declared
variables that are not INTEGER or DOWHILE will be random
variables if they are assigned in a statement whose
right-side involves ETA&rsquo;s or EPS&rsquo;s. Declared
variables are not known to or used by NONMEM or PREDPP.</p>

<p style="margin-top: 1em">See IV.K.2 for an example.</p>

<p style="margin-top: 1em"><tt>$ABBREVIATED FUNCTION</tt>
option (nm74)</p>

<p style="margin-top: 1em">In NONMEM 7.4 the $ABBR FUNCTION
option allows user-defined function names and user-defined
argument vector names. The dimensions of the argument vector
and the maximum number of times a given function name may
appear in abbreviated code is user-specified.</p>

<p style="margin-top: 1em">See Chapter IV Section IV.J.7
$ABBR FUNCTION and $ABBR VECTOR</p>

<p style="margin-top: 1em"><tt>$ABBREVIATED VECTOR</tt>
option (nm74)</p>

<p style="margin-top: 1em">In NONMEM 7.4 the $ABBR VECTOR
option allows user-defined vector names to be defined
independently of any function.</p>

<p style="margin-top: 1em">See Chapter IV Section IV.J.7
$ABBR FUNCTION and $ABBR VECTOR</p>

<p style="margin-top: 1em"><tt>$ABBREVIATED PROTECT</tt>
option (nm74)</p>

<p style="margin-left:33%; margin-top: 1em">With NONMEM
7.4, a series of routines are available that protect against
domain violations, divide by zero, and floating point
overflows. Each of these routines start with the letter P,
followed by the name of the mathematical operation they are
to perform. For example, PLOG is the protective code routine
that performs the LOG operation. With $ABBR PROTECT, NMTRAN
will automatically replace all relevant function names with
the P name.</p>

<p style="margin-left:33%; margin-top: 1em">See Chapter IV
Section IV.J.6. PROTECT functions</p>

<h2>III.III.III.B.8. $PRED Record
<a name="III.III.III.B.8."></a>
<a name="III.III.III.B.8. $PRED Record"></a>
</h2>


<p style="margin-top: 1em"><tt>$PRED</tt> <br>
the abbreviated code</p>

<p style="margin-top: 1em">This record gives an abbreviated
code for the PRED routine. The syntax of an abbreviated code
is described in chapter IV.</p>

<p style="margin-top: 1em">This record is optional. If it
appears, it must be with the first problem specification,
and only with this problem specification.</p>

<h2>III.III.III.B.9. $THETA Record
<a name="III.III.III.B.9."></a>
<a name="III.III.III.B.9. $THETA Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$THETA
<img src="grohtml-4068006-23.png" alt="Image grohtml-4068006-23.png"></i></tt>
[
<img src="grohtml-4068006-24.png" alt="Image grohtml-4068006-24.png">
] [
<img src="grohtml-4068006-25.png" alt="Image grohtml-4068006-25.png">
] ... <br>
[(
<img src="grohtml-4068006-26.png" alt="Image grohtml-4068006-26.png">
)x
<img src="grohtml-4068006-27.png" alt="Image grohtml-4068006-27.png">
] <br>
[label=
<img src="grohtml-4068006-28.png" alt="Image grohtml-4068006-28.png">
... FIXED] <br>
[NAMES (label ...)value ...] <br>
[<tt><i>NUMBERPOINTS=</i></tt>n] <br>

[<tt><b>ABORT</b></tt>|<tt><i>NOABORT</i></tt>|<tt><i>NOABORTFIRST</i></tt>]</p>

<p style="margin-top: 1em">E.g. <tt>$THETA (.1,3.,5.)
(.008,.08,.5) (.004,.04,.9)</tt></p>

<p style="margin-top: 1em">This record gives initial
estimates for
<img src="grohtml-4068006-29.png" alt="Image grohtml-4068006-29.png">
&rsquo;s, as well as bounds on the final estimates.</p>

<p style="margin-top: 1em">This record is required only if
the statistical model contains
<img src="grohtml-4068006-30.png" alt="Image grohtml-4068006-30.png">
parameters (most models do). When a $MSFI record appears in
the problem specification, the $THETA record should not
appear.</p>

<p style="margin-top: 1em">A value has one of four
forms:</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-40680064.png" alt="Image grohtml-40680064.png"></p>

<p style="margin-top: 1em">where init is the initial
estimate, and low and up are lower and upper bounds
respectively. The lower bound can be <tt>-INF</tt>, i.e.
<img src="grohtml-4068006-34.png" alt="Image grohtml-4068006-34.png">
, and the upper bound can be <tt>INF</tt>, i.e.
<img src="grohtml-4068006-35.png" alt="Image grohtml-4068006-35.png">
, unless form 3 is used, in which case both bounds must be
finite numbers. Form 3 is used when the user requires some
help in obtaining an initial estimate for the parameter.
Usually, though, the user should be able to develop a
reasonable initial estimate, and when he can, there is some
savings in computation time. An initial estimate equal to 0
is not allowed, unless the <tt>FIXED</tt> option is used.
Use of this option indicates that the final parameter
estimate is to be constrained to equal the initial parameter
estimate. If this option is used with form 2, then low, init
and up must all be equal.</p>

<p style="margin-top: 1em">Another example:</p>

<pre style="margin-top: 1em">$THETA  3 FIXED  (-INF,.08,.5) (.004,,.9)</pre>


<p style="margin-top: 1em">where the three forms used are
1,2 and 3, in that order.</p>

<p style="margin-top: 1em">Parentheses around init with
form 1 are optional. The designation <tt>INF</tt> can also
be coded <tt>INFINITY</tt>, <tt>INFIN</tt>, or
<tt>1000000</tt>. The character <tt>+</tt>&rsquo; can
precede <tt>INF</tt>, as can the character
&rsquo;<tt>-</tt>&rsquo;. Integers need not have decimal
points.</p>

<p style="margin-top: 1em">With NONMEM 7.2, form 4 may be
used. Any initial value or group of initial values may be
enclosed in parentheses and followed by &quot;x
<img src="grohtml-4068006-36.png" alt="Image grohtml-4068006-36.png">
&quot;, which means to replicate the values within
parentheses n times (&quot;repeated value&quot;). The values
within the parenthesis may have any of the above forms. For
example, the following two are equivalent:</p>

<pre style="margin-top: 1em">$THETA 2 2 2 2 (0.001,0.1,1000) (0.001,0.1,1000) (0.001,0.1,1000)       (0.5 FIXED) (0.5 FIXED)</pre>


<p>$THETA (2)x4 (0.001,0.1,1000)x3 (0.5 FIXED)x2</p>

<p style="margin-top: 1em">If form 3 is used, a search for
an initial estimate is undertaken by NONMEM (not NM-TRAN). A
number of points in a subspace of the
<img src="grohtml-4068006-37.png" alt="Image grohtml-4068006-37.png">
parameter space will be examined. This subspace consists of
the multidimensional rectangle formed by the lower and upper
bounds for all parameters whose values are of form 3. The
number of points examined will be automatically determined
by NONMEM, or it can be specified by the number n with the
<tt>NUMBERPOINTS</tt> option. The options <tt>ABORT</tt> and
<tt>NOABORT</tt> and <tt>NOABORTFIRST</tt> apply during the
search. For information concerning these option, see section
IV.G.</p>

<p style="margin-top: 1em">Aliases for
<tt>NUMBERPOINTS</tt> are: <tt>NUM</tt>, <tt>NUMPTS</tt>,
<tt>NUMBERPTS</tt>. This option can occur at the end of the
record, or at the beginning, or between two values.
<tt>THTA</tt> is an alias for <tt>THETA</tt>.</p>

<p style="margin-top: 1em">With NONMEM 7.4, when initial
thetas are to be estimated, evaluations can now be done for
FOCE and LAPLACE, not just for FO.</p>

<p style="margin-top: 1em">Commas between values are
optional, except with form 3.</p>

<p style="margin-top: 1em">Records $THETAI and $THETAR may
be used to generate subroutines that transform the initial
and final values of THETA. See Chapter IV Sections M and
N.</p>

<p style="margin-top: 1em">With NONMEM 7.5, the $THETA
record may specify symbolic label substitution. For
example,</p>

<pre style="margin-top: 1em">$THETA CL=(0.0,7.0) V1=(5.0 fixed)
This is equivalent to$ABBR REPLACE THETA(CL)=THETA(1)
$ABBR REPLACE THETA(V1)=THETA(2)
$THETA (0.0,7.0) (5.0 fixed)</pre>


<p style="margin-top: 1em">The symbolic subscript may be
used for THETA in abbreviated code, and will also identify
this element of THETA in the NONMEM output. (Only the first
9 characters of the label will appear).</p>

<p style="margin-top: 1em">With NONMEM 7.5, the $THETA
record can define one or more thetas and initial values in a
compact way. For example,</p>

<pre style="margin-top: 1em">$THETA NAMES(V1,CL,Q,V2) (0.0,7.0) (0.0,7.0) (0.0,7.0) 7</pre>


<h2>III.III.III.B.10. $OMEGA Record
<a name="III.III.III.B.10."></a>
<a name="III.III.III.B.10. $OMEGA Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$OMEGA</i></tt>
[<tt><b>DIAGONAL(</b></tt>n<tt><b>)&nbsp;</b></tt>|&nbsp;<tt><i>BLOCK(</i></tt>n<tt><i>)&nbsp;</i></tt>|&nbsp;<tt><i>BLOCK(</i></tt>n<tt><i>)
SAME(</i></tt>m<tt><i>)&nbsp;|&nbsp;BLOCK SAME(m)] <br>
[[
<img src="grohtml-4068006-38.png" alt="Image grohtml-4068006-38.png">
] [
<img src="grohtml-4068006-39.png" alt="Image grohtml-4068006-39.png">
] [
<img src="grohtml-4068006-40.png" alt="Image grohtml-4068006-40.png">
] ... <br>
[(
<img src="grohtml-4068006-41.png" alt="Image grohtml-4068006-41.png">
,
<img src="grohtml-4068006-42.png" alt="Image grohtml-4068006-42.png">
...)&nbsp;x
<img src="grohtml-4068006-43.png" alt="Image grohtml-4068006-43.png">
] <br>
[BLOCK(n)&nbsp;VALUES(diag,odiag)] <br>
[label=
<img src="grohtml-4068006-44.png" alt="Image grohtml-4068006-44.png">
] ... <br>
[BLOCK(n)&nbsp;[NAMES (
<img src="grohtml-4068006-45.png" alt="Image grohtml-4068006-45.png">
,...,
<img src="grohtml-4068006-46.png" alt="Image grohtml-4068006-46.png">
)]&nbsp;[VALUES (diag,odiag)] <br>
[FIXED] [UNINT] <br>

[</i></tt><tt><b>VARIANCE</b></tt><tt><i>|STANDARD]&nbsp;[</i></tt><tt><b>COVARIANCE</b></tt><tt><i>|CORRELATON]&nbsp;[CHOLESKY]</i></tt></p>

<p style="margin-top: 1em"><tt><i>E.g.</i></tt></p>
<pre>$OMEGA BLOCK(3)  6. .005 .3 .0002 .006 .4</pre>

<p style="margin-top: 1em">This record gives initial
estimates for elements of the
<img src="grohtml-4068006-47.png" alt="Image grohtml-4068006-47.png">
matrix, i.e. the variances and covariances of the
<img src="grohtml-4068006-48.png" alt="Image grohtml-4068006-48.png">
variables in the statistical model. Constraints on
<img src="grohtml-4068006-49.png" alt="Image grohtml-4068006-49.png">
are also indicated.</p>

<p style="margin-top: 1em">This record should appear only
if the statistical model contains
<img src="grohtml-4068006-50.png" alt="Image grohtml-4068006-50.png">
variables. If it appears, then there must be one such record
corresponding to each block of
<img src="grohtml-4068006-51.png" alt="Image grohtml-4068006-51.png">
, and the order of these records in the control stream must
correspond to the order of the blocks. The values in an
$OMEGA record are the initial estimates for the elements of
the corresponding block. Under some circumstances $OMEGA
records may or may not appear, and the equivalent effect is
achieved in either case (see below). When a $MSFI record
appears, no $OMEGA records should appear. When PREDPP is
used, and a $PK record does not appear, while a $ERROR
record does appear, certain care must be taken with the
$OMEGA record; see section V.6.</p>


<p style="margin-top: 1em"><img src="grohtml-4068006-52.png" alt="Image grohtml-4068006-52.png">
can be considered to be in block diagonal form with blocks
<img src="grohtml-4068006-53.png" alt="Image grohtml-4068006-53.png">
,
<img src="grohtml-4068006-54.png" alt="Image grohtml-4068006-54.png">
, ...,
<img src="grohtml-4068006-55.png" alt="Image grohtml-4068006-55.png">
(submatrices of
<img src="grohtml-4068006-56.png" alt="Image grohtml-4068006-56.png">
):</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-40680065.png" alt="Image grohtml-40680065.png"></p>

<p style="margin-top: 1em">This form need not be unique,
and there may be only one block (which is most usual). The
following description applies to the
<img src="grohtml-4068006-58.png" alt="Image grohtml-4068006-58.png">
th block,
<img src="grohtml-4068006-59.png" alt="Image grohtml-4068006-59.png">
.</p>

<p style="margin-top: 1em">If the <tt>DIAGONAL</tt> option
is used, it must precede the values. In this case
<img src="grohtml-4068006-60.png" alt="Image grohtml-4068006-60.png">
is constrained to be diagonal, and the values are the
initial estimates of its diagonal elements given in the
diagonal order. The number n is the dimension of
<img src="grohtml-4068006-61.png" alt="Image grohtml-4068006-61.png">
. In addition, a final estimate of an individual element of
a diagonal block can be constrained to be equal to the
initial estimate of the element by using the <tt>FIXED</tt>
option. The value giving the initial estimate should be
coded with any one of the forms: <br>
init <tt>FIXED <br>
(</tt>init <tt>FIXED) <br>
(FIXED</tt> init<tt>)</tt></p>

<p style="margin-top: 1em">If the <tt>BLOCK</tt> option is
used, it must precede the values. In this case the form of
<img src="grohtml-4068006-62.png" alt="Image grohtml-4068006-62.png">
is unconstrained, and the values are the initial estimates
of its lower triangle elements given in row-wise order. The
number n is the dimension of
<img src="grohtml-4068006-63.png" alt="Image grohtml-4068006-63.png">
. If <tt>FIXED</tt> option is used, <i>all</i> the final
estimates of the elements of
<img src="grohtml-4068006-64.png" alt="Image grohtml-4068006-64.png">
are constrained to be equal to the initial estimates of
these elements.</p>

<p style="margin-top: 1em">If the <tt>BLOCK(</tt>n<tt>)
SAME</tt> or <tt>BLOCK SAME</tt> option is used,
<img src="grohtml-4068006-65.png" alt="Image grohtml-4068006-65.png">
is constrained to be equal to
<img src="grohtml-4068006-66.png" alt="Image grohtml-4068006-66.png">
. In this case
<img src="grohtml-4068006-67.png" alt="Image grohtml-4068006-67.png">
must be greater than 1, the number n (if it is given) must
be the dimension of
<img src="grohtml-4068006-68.png" alt="Image grohtml-4068006-68.png">
, and values are not given.</p>

<p style="margin-top: 1em">With NONMEM 7.3, SAME(m) is
permitted . If m is present, then this record is equivalent
to m identical records without (m). E.g., <tt><br>
$OMEGA BLOCK(2) SAME(3)</tt> <br>
is equivalent to</p>

<pre>$OMEGA BLOCK(2) SAME
$OMEGA BLOCK(2) SAME
$OMEGA BLOCK(2) SAME</pre>


<p style="margin-top: 1em">If some of the values in a
record are omitted (other than a record with the
<tt>BLOCK(</tt>n<tt>) SAME</tt> or <tt>BLOCK SAME</tt>
option), then <i>all</i> values in the record must be
omitted, and NONMEM will try to obtain initial estimates for
the elements of the block. In this case, if the
<tt>DIAGONAL</tt> option is used, it must appear explicitly
in the record. Often, though, the user should be able to
develop reasonable initial estimates, and when he can, there
may be a little savings in computation time.</p>

<p style="margin-top: 1em">If no $OMEGA records appear, if
no $MSFI record appears, but
<img src="grohtml-4068006-69.png" alt="Image grohtml-4068006-69.png">
variables are used in an abbreviated code, then it is
assumed that a record</p>

<p style="margin-top: 1em"><tt>$OMEGA
DIAGONAL(</tt>n<tt>)</tt></p>

<p style="margin-top: 1em">where n is the largest index
used with an
<img src="grohtml-4068006-70.png" alt="Image grohtml-4068006-70.png">
variable in all abbreviated codes, might have equivalently
been used. (If, though, with PREDPP an abbreviated code for
PK is not used, while an abbreviated code for ERROR is used,
see section V.6.)</p>

<p style="margin-top: 1em">With the <tt>BLOCK</tt> option,
the <tt>FIXED</tt> option can occur anywhere among the list
of values. These values (of the lower triangle) are given in
row-wise order, i.e.
<img src="grohtml-4068006-71.png" alt="Image grohtml-4068006-71.png">
,
<img src="grohtml-4068006-72.png" alt="Image grohtml-4068006-72.png">
,
<img src="grohtml-4068006-73.png" alt="Image grohtml-4068006-73.png">
, ...,
<img src="grohtml-4068006-74.png" alt="Image grohtml-4068006-74.png">
,
<img src="grohtml-4068006-75.png" alt="Image grohtml-4068006-75.png">
, ...,
<img src="grohtml-4068006-76.png" alt="Image grohtml-4068006-76.png">
.</p>

<p style="margin-top: 1em">Commas between values are
optional.</p>

<p style="margin-top: 1em">An initial estimate of an
element of a diagonal block must be &gt;0, or it can be 0 if
the <tt>FIXED</tt> option is used with it. An initial
estimate of a non-diagonally-constrained block must be
positive definite, or it can be (uniformly) 0 if the
<tt>FIXED</tt> option is used with it. (In any case the
initial estimates of
<img src="grohtml-4068006-77.png" alt="Image grohtml-4068006-77.png">
and
<img src="grohtml-4068006-78.png" alt="Image grohtml-4068006-78.png">
cannot both be 0 unless the Simulation Step is the only step
implemented.)</p>

<p style="margin-top: 1em">The NM-TRAN translation of
$OMEGA records is such that new blocks in addition to
<img src="grohtml-4068006-79.png" alt="Image grohtml-4068006-79.png">
,
<img src="grohtml-4068006-80.png" alt="Image grohtml-4068006-80.png">
, etc. may be created. This should be transparent to the
user, except that he will see additional blocks listed in
the problem summary output by NONMEM.</p>

<p style="margin-top: 1em">With NONMEM V, an initial
estimate of a diagonal block of either the OMEGA or SIGMA
matrices may have a band symmetric form, in which case the
final estimate has the same form. That is, given the
diagonal and a group of contiguous subdiagonals
symmetrically ocurring across the diagonal, the elements off
both the diagonal and the subdiagonals are constrained to be
zero. To specify the initial estimates of such a block, the
initial estimates of those elements that are to be
constrained to 0 should be given as 0, while all other
initial estimates should be given as nonzero. E.g., with
these structures for $OMEGA BLOCK(3), the 0&rsquo;s are
preserved: <br>
x <br>
0x <br>
00x</p>

<p style="margin-top: 1em">x <br>
xx <br>
0xx</p>

<p style="margin-top: 1em">With NONMEM 7.3 if the initial
estimate of a block is not positive definite because of
rounding errors, a value will be added to the diagonal
elements to make it positive definite. A message in the
NONMEM report file will indicate that this was done. E.g.,
<tt><br>
DIAGONAL SHIFT OF 1.1000E-03 WAS IMPOSED TO ENSURE POSITIVE
DEFINITENESS</tt></p>

<p style="margin-top: 1em">With NONMEM 7.3, (
<img src="grohtml-4068006-81.png" alt="Image grohtml-4068006-81.png">
)x
<img src="grohtml-4068006-82.png" alt="Image grohtml-4068006-82.png">
is permitted, so that repeated inputs of $OMEGA may be
entered easily. Any initial value or group of initial values
may be enclosed in parentheses and followed by
&quot;xn&quot; which means to replicate the items n times
(&quot;repeated values&quot;). The item to be repeated must
always be in parentheses, and the xn must always be
immediately after the item, not before it (4x(0.2) is not
permitted). Here is an example:</p>

<pre style="margin-top: 1em">$OMEGA BLOCK(6)
0.1
0.01 0.1
(0.01)x2 0.1
(0.01)x3 0.1
(0.01)x4 0.1
(0.01)x5 0.1</pre>


<p style="margin-top: 1em">With NONMEM 7.3, new options are
available.</p>

<p style="margin-top: 1em"><tt>$OMEGA BLOCK(n)
VALUES</tt>(diag,odiag)</p>

<p style="margin-top: 1em">This supplies initial values for
a block such that the initial estimates of the diagonal
elements are all the same, specified by &quot;diag&quot;,
and the initial estimates of the off-diagonal elements are
all the same, specified by &quot;odiag&quot;. If present,
<tt>VALUES</tt> must follow <tt>BLOCK</tt>.</p>

<p style="margin-top: 1em">The above example could be
coded</p>
<pre>$OMEGA BLOCK(6) VALUES(0.1,0.01)</pre>

<p style="margin-top: 1em">For fixed block (such as for
omega priors):</p>
<pre>$OMEGA BLOCK(6) FIX VALUES(0.15,0.0)</pre>

<p style="margin-top: 1em">The following options may follow
<tt>VALUES</tt> or be placed between <tt>BLOCK</tt> and
<tt>VALUES</tt>.</p>

<p style="margin-top: 1em"><tt>VARIANCE</tt> indicates that
all initial estimates given for diagonal elements are
understood to be initial estimates of variances of etas.
This is the default.</p>

<p style="margin-top: 1em"><tt>STANDARD</tt> indicates that
all initial estimates given for diagonal elements are
understood to be initial estimates of standard deviations of
etas. May also be coded <tt>SD</tt>.</p>

<p style="margin-top: 1em"><tt>COVARIANCE</tt> indicates
that all initial estmates given for off-diagonal elements
are understood to be initial estimates of covariances of
etas. This is the default.</p>

<p style="margin-top: 1em"><tt>CORRELATON</tt> indicates
that all initial estmates given for off-diagonal elements
are understood to be initial estimates of correlations of
etas.</p>

<p style="margin-top: 1em"><tt>CHOLESKY</tt> indicates that
the block is specified in its Cholesky form.</p>

<p style="margin-top: 1em">Options <tt>VARIANCE</tt> or
<tt>STANDARD</tt> may be combined with <tt>COVARIANCE</tt>
or <tt>CORRELATON</tt>.</p>

<p style="margin-top: 1em">Note that NONMEM converts all
initial estimates to variance and covariances. The values
desplayed in the NONMEM report and in the raw and additional
output files are always variances and covariances.</p>

<p style="margin-top: 1em">With NONMEM 7.5, the $OMEGA
record may specify symbolic label substitution. For
example,</p>

<p style="margin-top: 1em"><tt>$OMEGA label=
<img src="grohtml-4068006-83.png" alt="Image grohtml-4068006-83.png">
(NM75)</tt></p>

<p style="margin-top: 1em">This is a compact method of
defining an ETA (an element of OMEGA) specifying its initial
estimate, and specifying a label for the subscript for this
element of OMEGA. The label may be used as a subscript for
ETA in abbreviated code, and will also identify this element
of OMEGA in the NONMEM output. If new $OMEGA records change
the ordering, the abbreviated code does not have to be
changed. For example, suppose the first element of OMEGA
that is defined happens to be</p>
<pre>$OMEGA ECL=.4</pre>

<p>The NONMEM report will describe the relationship,
e.g.,</p>
<pre>LABELS FOR ETAS
ETA(1)=ETA(ECL)</pre>

<p>and ETA(CL) rather than ETA1 will appear in the NONMEM
report. The abbreviated code can use this symbolic subscript
instead of the numeric subscript. Then, these take effect on
both ETA&rsquo;s and MU_&rsquo;s.</p>

<p style="margin-top: 1em">For example, suppose the
following code is present for the first elements of THETA
and ETA. Note that $OMEGA and $THETA records must be placed
ahead of any records that use the symbolic label.</p>

<pre style="margin-top: 1em">$THETA CL=(0.0,7.0)
$OMEGA ECL= 0.3
$PK
MU_ECL=THETA(CL)
CL=EXP(MU_ECL+ETA(ECL))</pre>


<p style="margin-top: 1em">This is equivalent to</p>

<pre style="margin-top: 1em">$THETA (0.0,7.0)
$OMEGA .3
$PK
MU_1+THETA(1)
CL=EXP(MU_1+ETA(1))</pre>


<p style="margin-top: 1em">Another example defines symbolic
labels for a block of OMEGA:</p>

<pre style="margin-top: 1em">$OMEGA BLOCK(4)
ECL=  0.3
EV1=  0.01 0.35
EQ=   0.01 0.01 0.54
EV2=  0.01 0.01 0.01 0.67</pre>


<p style="margin-top: 1em">Or, for diagonals,</p>

<pre style="margin-top: 1em">$OMEGA
ECL= 0.3
EV1= 0.35
EQ=  0.54
EV2= 0.67</pre>


<p style="margin-top: 1em">With NONMEM 7.5, Symbolic label
substitution may be specified for an entire block using the
NAMES option.</p>

<p style="margin-top: 1em">$OMEGA
<tt><i>BLOCK(</i></tt>n<tt><i>)&nbsp;NAMES</i></tt> (
<img src="grohtml-4068006-84.png" alt="Image grohtml-4068006-84.png">
,...,
<img src="grohtml-4068006-85.png" alt="Image grohtml-4068006-85.png">
) <tt><i>VALUES</i></tt> (odiag,diag) (NM75)</p>

<p style="margin-top: 1em">This is a compact way of
defining one or more etas with labels and, when combined
with VALUES, with initial values. For example</p>

<pre style="margin-top: 1em">$OMEGA BLOCK(4) NAMES(ECL,EV1,EQ,EV2) VALUES(0.03,0.01)</pre>


<p style="margin-top: 1em">This is equivalent to</p>

<pre style="margin-top: 1em">$OMEGA BLOCK(4)
ECL=  0.03
EV1=  0.01 0.03
EQ=   0.01 0.01 0.03
EV2=  0.01 0.01 0.01 0.03</pre>


<p style="margin-top: 1em">If both are present, VALUES()
must come after NAMES().</p>

<p style="margin-top: 1em">SPECIAL CASE (NONMEM 7.3)</p>

<p style="margin-top: 1em">If all diagonal elements of
$OMEGA are &quot;1.0E+06 FIXED&quot;, then NONMEM describes
the data as <tt><i><br>
ANALYSIS TYPE: POPULATION WITH UNCONSTRAINED
ETAS</i></tt></p>

<p style="margin-top: 1em">Structurally NONMEM sees the
analysis as population, but mathematically, the population
density portion of the total likelihood is not included.
This allows a population data set to be analyzed as if the
data from each individual were single-subject data.
Furthermore, some theta parameters could be shared across
subjects (&quot;pooled fit parameters&quot;), whereas etas
are free to fit each individual without any population
constraint. Parallelization is possible.</p>

<h2>III.III.III.B.11. $SIGMA Record
<a name="III.III.III.B.11."></a>
<a name="III.III.III.B.11. $SIGMA Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$SIGMA</i></tt>
[<tt><b>DIAGONAL(</b></tt>n<tt><b>)&nbsp;</b></tt>|&nbsp;<tt><i>BLOCK(</i></tt>n<tt><i>)&nbsp;</i></tt>|&nbsp;<tt><i>BLOCK(</i></tt>n<tt><i>)
SAME(</i></tt>m<tt><i>)&nbsp;|&nbsp;BLOCK SAME(m)] <br>
[[
<img src="grohtml-4068006-86.png" alt="Image grohtml-4068006-86.png">
] [
<img src="grohtml-4068006-87.png" alt="Image grohtml-4068006-87.png">
] [
<img src="grohtml-4068006-88.png" alt="Image grohtml-4068006-88.png">
] ... <br>
[(
<img src="grohtml-4068006-89.png" alt="Image grohtml-4068006-89.png">
,
<img src="grohtml-4068006-90.png" alt="Image grohtml-4068006-90.png">
...)&nbsp;x
<img src="grohtml-4068006-91.png" alt="Image grohtml-4068006-91.png">
] <br>
[BLOCK(n)&nbsp;VALUES(diag,odiag)] <br>
[label=
<img src="grohtml-4068006-92.png" alt="Image grohtml-4068006-92.png">
] ... <br>
[BLOCK(n)&nbsp;[NAMES (
<img src="grohtml-4068006-93.png" alt="Image grohtml-4068006-93.png">
,...,
<img src="grohtml-4068006-94.png" alt="Image grohtml-4068006-94.png">
)]&nbsp;[VALUES (diag,odiag)] <br>
[FIXED] [UNINT] <br>

[</i></tt><tt><b>VARIANCE</b></tt><tt><i>|STANDARD]&nbsp;[</i></tt><tt><b>COVARIANCE</b></tt><tt><i>|CORRELATON]&nbsp;[CHOLESKY]</i></tt></p>

<p style="margin-top: 1em"><tt><i>E.g.</i></tt></p>
<pre>$SIGMA BLOCK(3)  6. .005 .3 .0002 .006 .4</pre>

<p style="margin-top: 1em">This record gives initial
estimates for elements of the
<img src="grohtml-4068006-95.png" alt="Image grohtml-4068006-95.png">
matrix, i.e. the variances and covariances of the
<img src="grohtml-4068006-96.png" alt="Image grohtml-4068006-96.png">
variables in the statistical model. Constraints on
<img src="grohtml-4068006-97.png" alt="Image grohtml-4068006-97.png">
are also indicated.</p>

<p style="margin-top: 1em">This record should appear only
if the statistical model contains
<img src="grohtml-4068006-98.png" alt="Image grohtml-4068006-98.png">
variables. If it appears, then there must be one such record
corresponding to each block of
<img src="grohtml-4068006-99.png" alt="Image grohtml-4068006-99.png">
, and the order of these records in the control stream must
correspond to the order of the blocks. The values in an
$SIGMA record are the initial estimates for the elements of
the corresponding block. Under some circumstances $SIGMA
records may or may not appear, and the equivalent effect is
achieved in either case (see below). When a $MSFI record
appears, no $SIGMA records should appear.</p>


<p style="margin-top: 1em"><img src="grohtml-4068006-100.png" alt="Image grohtml-4068006-100.png">
can be considered to be in block diagonal form with blocks
<img src="grohtml-4068006-101.png" alt="Image grohtml-4068006-101.png">
,
<img src="grohtml-4068006-102.png" alt="Image grohtml-4068006-102.png">
, ...,
<img src="grohtml-4068006-103.png" alt="Image grohtml-4068006-103.png">
(submatrices of
<img src="grohtml-4068006-104.png" alt="Image grohtml-4068006-104.png">
):</p>


<p align="center" style="margin-top: 1em"><img src="grohtml-40680066.png" alt="Image grohtml-40680066.png"></p>

<p style="margin-top: 1em">This form need not be unique,
and there may be only one block (which is most usual). The
following description applies to the
<img src="grohtml-4068006-106.png" alt="Image grohtml-4068006-106.png">
th block,
<img src="grohtml-4068006-107.png" alt="Image grohtml-4068006-107.png">
.</p>

<p style="margin-top: 1em">If the <tt>DIAGONAL</tt> option
is used, it must precede the values. In this case
<img src="grohtml-4068006-108.png" alt="Image grohtml-4068006-108.png">
is constrained to be diagonal, and the values are the
initial estimates of its diagonal elements given in the
diagonal order. The number n is the dimension of
<img src="grohtml-4068006-109.png" alt="Image grohtml-4068006-109.png">
. In addition, a final estimate of an individual element of
a diagonal block can be constrained to be equal to the
initial estimate of the element by using the <tt>FIXED</tt>
option. The value giving the initial estimate should be
coded with any one of the forms: <br>
init <tt>FIXED <br>
(</tt>init <tt>FIXED) <br>
(FIXED</tt> init<tt>)</tt></p>

<p style="margin-top: 1em">If the <tt>BLOCK</tt> option is
used, it must precede the values. In this case the form of
<img src="grohtml-4068006-110.png" alt="Image grohtml-4068006-110.png">
is unconstrained, and the values are the initial estimates
of its lower triangle elements given in row-wise order. The
number n is the dimension of
<img src="grohtml-4068006-111.png" alt="Image grohtml-4068006-111.png">
. If <tt>FIXED</tt> option is used, <i>all</i> the final
estimates of the elements of
<img src="grohtml-4068006-112.png" alt="Image grohtml-4068006-112.png">
are constrained to be equal to the initial estimates of
these elements.</p>

<p style="margin-top: 1em">If the <tt>BLOCK(</tt>n<tt>)
SAME</tt> or <tt>BLOCK SAME</tt> option is used,
<img src="grohtml-4068006-113.png" alt="Image grohtml-4068006-113.png">
is constrained to be equal to
<img src="grohtml-4068006-114.png" alt="Image grohtml-4068006-114.png">
. In this case
<img src="grohtml-4068006-115.png" alt="Image grohtml-4068006-115.png">
must be greater than 1, the number n (if it is given) must
be the dimension of
<img src="grohtml-4068006-116.png" alt="Image grohtml-4068006-116.png">
, and values are not given.</p>

<p style="margin-top: 1em">With NONMEM 7.3, SAME(m) is
permitted . If m is present, then this record is equivalent
to m identical records without (m). E.g., <tt><br>
$SIGMA BLOCK(2) SAME(3)</tt> <br>
is equivalent to</p>

<pre>$SIGMA BLOCK(2) SAME
$SIGMA BLOCK(2) SAME
$SIGMA BLOCK(2) SAME</pre>


<p style="margin-top: 1em">If some of the values in a
record are omitted (other than a record with the
<tt>BLOCK(</tt>n<tt>) SAME</tt> or <tt>BLOCK SAME</tt>
option), then <i>all</i> values in the record must be
omitted, and NONMEM will try to obtain initial estimates for
the elements of the block. In this case, if the
<tt>DIAGONAL</tt> option is used, it must appear explicitly
in the record. Often, though, the user should be able to
develop reasonable initial estimates, and when he can, there
may be a little savings in computation time.</p>

<p style="margin-top: 1em">If no $SIGMA records appear, if
no $MSFI record appears, but
<img src="grohtml-4068006-117.png" alt="Image grohtml-4068006-117.png">
variables are used in an abbreviated code, then it is
assumed that a record</p>

<p style="margin-top: 1em"><tt>$SIGMA
DIAGONAL(</tt>n<tt>)</tt></p>

<p style="margin-top: 1em">where n is the largest index
used with an
<img src="grohtml-4068006-118.png" alt="Image grohtml-4068006-118.png">
variable in all abbreviated codes, might have equivalently
been used. (If, though, with PREDPP an abbreviated code for
PK is not used, while an abbreviated code for ERROR is used,
see section V.6.)</p>

<p style="margin-top: 1em">With the <tt>BLOCK</tt> option,
the <tt>FIXED</tt> option can occur anywhere among the list
of values. These values (of the lower triangle) are given in
row-wise order, i.e.
<img src="grohtml-4068006-119.png" alt="Image grohtml-4068006-119.png">
,
<img src="grohtml-4068006-120.png" alt="Image grohtml-4068006-120.png">
,
<img src="grohtml-4068006-121.png" alt="Image grohtml-4068006-121.png">
, ...,
<img src="grohtml-4068006-122.png" alt="Image grohtml-4068006-122.png">
,
<img src="grohtml-4068006-123.png" alt="Image grohtml-4068006-123.png">
, ...,
<img src="grohtml-4068006-124.png" alt="Image grohtml-4068006-124.png">
.</p>

<p style="margin-top: 1em">Commas between values are
optional.</p>

<p style="margin-top: 1em">An initial estimate of an
element of a diagonal block must be &gt;0, or it can be 0 if
the <tt>FIXED</tt> option is used with it. An initial
estimate of a non-diagonally-constrained block must be
positive definite, or it can be (uniformly) 0 if the
<tt>FIXED</tt> option is used with it. (In any case the
initial estimates of
<img src="grohtml-4068006-125.png" alt="Image grohtml-4068006-125.png">
and
<img src="grohtml-4068006-126.png" alt="Image grohtml-4068006-126.png">
cannot both be 0 unless the Simulation Step is the only step
implemented.)</p>

<p style="margin-top: 1em">The NM-TRAN translation of
$SIGMA records is such that new blocks in addition to
<img src="grohtml-4068006-127.png" alt="Image grohtml-4068006-127.png">
,
<img src="grohtml-4068006-128.png" alt="Image grohtml-4068006-128.png">
, etc. may be created. This should be transparent to the
user, except that he will see additional blocks listed in
the problem summary output by NONMEM.</p>

<p style="margin-top: 1em">With NONMEM V, an initial
estimate of a diagonal block of either the OMEGA or SIGMA
matrices may have a band symmetric form, in which case the
final estimate has the same form. That is, given the
diagonal and a group of contiguous subdiagonals
symmetrically ocurring across the diagonal, the elements off
both the diagonal and the subdiagonals are constrained to be
zero. To specify the initial estimates of such a block, the
initial estimates of those elements that are to be
constrained to 0 should be given as 0, while all other
initial estimates should be given as nonzero. E.g., with
these structures for $SIGMA BLOCK(3), the 0&rsquo;s are
preserved: <br>
x <br>
0x <br>
00x</p>

<p style="margin-top: 1em">x <br>
xx <br>
0xx</p>

<p style="margin-top: 1em">With NONMEM 7.3 if the initial
estimate of a block is not positive definite because of
rounding errors, a value will be added to the diagonal
elements to make it positive definite. A message in the
NONMEM report file will indicate that this was done. E.g.,
<tt><br>
DIAGONAL SHIFT OF 1.1000E-03 WAS IMPOSED TO ENSURE POSITIVE
DEFINITENESS</tt></p>

<p style="margin-top: 1em">With NONMEM 7.3, (
<img src="grohtml-4068006-129.png" alt="Image grohtml-4068006-129.png">
)x
<img src="grohtml-4068006-130.png" alt="Image grohtml-4068006-130.png">
is permitted, so that repeated inputs of $SIGMA may be
entered easily. Any initial value or group of initial values
may be enclosed in parentheses and followed by
&quot;xn&quot; which means to replicate the items n times
(&quot;repeated values&quot;). The item to be repeated must
always be in parentheses, and the xn must always be
immediately after the item, not before it (4x(0.2) is not
permitted). Here is an example:</p>

<pre style="margin-top: 1em">$SIGMA BLOCK(6)
0.1
0.01 0.1
(0.01)x2 0.1
(0.01)x3 0.1
(0.01)x4 0.1
(0.01)x5 0.1</pre>


<p style="margin-top: 1em">With NONMEM 7.3, new options are
available.</p>

<p style="margin-top: 1em"><tt>$SIGMA BLOCK(n)
VALUES</tt>(diag,odiag)</p>

<p style="margin-top: 1em">This supplies initial values for
a block such that the initial estimates of the diagonal
elements are all the same, specified by &quot;diag&quot;,
and the initial estimates of the off-diagonal elements are
all the same, specified by &quot;odiag&quot;. If present,
<tt>VALUES</tt> must follow <tt>BLOCK</tt>.</p>

<p style="margin-top: 1em">The above example could be
coded</p>
<pre>$SIGMA BLOCK(6) VALUES(0.1,0.01)</pre>

<p style="margin-top: 1em">For fixed block (such as for
SIGMA priors):</p>
<pre>$SIGMA BLOCK(6) FIX VALUES(0.15,0.0)</pre>

<p style="margin-top: 1em">The following options may follow
<tt>VALUES</tt> or be placed between <tt>BLOCK</tt> and
<tt>VALUES</tt>.</p>

<p style="margin-top: 1em"><tt>VARIANCE</tt> indicates that
all initial estimates given for diagonal elements are
understood to be initial estimates of variances of etas.
This is the default.</p>

<p style="margin-top: 1em"><tt>STANDARD</tt> indicates that
all initial estimates given for diagonal elements are
understood to be initial estimates of standard deviations of
etas. May also be coded <tt>SD</tt>.</p>

<p style="margin-top: 1em"><tt>COVARIANCE</tt> indicates
that all initial estmates given for off-diagonal elements
are understood to be initial estimates of covariances of
etas. This is the default.</p>

<p style="margin-top: 1em"><tt>CORRELATON</tt> indicates
that all initial estmates given for off-diagonal elements
are understood to be initial estimates of correlations of
etas.</p>

<p style="margin-top: 1em"><tt>CHOLESKY</tt> indicates that
the block is specified in its Cholesky form.</p>

<p style="margin-top: 1em">Options <tt>VARIANCE</tt> or
<tt>STANDARD</tt> may be combined with <tt>COVARIANCE</tt>
or <tt>CORRELATON</tt>.</p>

<p style="margin-top: 1em">Note that NONMEM converts all
initial estimates to variance and covariances. The values
desplayed in the NONMEM report and in the raw and additional
output files are always variances and covariances.</p>

<p style="margin-top: 1em">The symbolic label substitution
feature is new with NONMEM 7.5.</p>

<p style="margin-top: 1em"><tt>$SIGMA label=
<img src="grohtml-4068006-131.png" alt="Image grohtml-4068006-131.png">
(NM75)</tt></p>

<p style="margin-top: 1em">It is similar to the symbolic
label substitution feature for $OMEGA. It is a compact
method of defining an EPS (an element of SIGMA) specifying
its initial estimate, and specifying a label for the
subscript for this element of SIGMA. The label may be used
as a subscript for EPS in abbreviated code, and will also
identify this element of SIGMA in the NONMEM output. If new
$SIGMA records change the ordering, the abbreviated code
does not have to be changed. For example, suppose the first
element of SIGMA that is defined happens to be</p>
<pre>$SIGMA RSW=0.6</pre>

<p>The NONMEM report will describe the relationship,
e.g.,</p>
<pre>LABELS FOR EPS
EPS(1)=EPS(RSW)</pre>

<p>and EPS(RSW) rather than EPS1 will appear in the NONMEM
report. The abbreviated code can use this symbolic subscript
instead of the numeric subscript.</p>

<p style="margin-top: 1em">As with $OMEGA, $SIGMA and
$THETA records (if elements of THETA are used) must be
placed ahead of any records that use the symbolic label.</p>

<p style="margin-top: 1em">Another example defines symbolic
labels for a block of SIGMA:</p>

<pre style="margin-top: 1em">$SIGMA BLOCK(2)
RSW=  0.3
EX=   0.01 0.35</pre>


<p style="margin-top: 1em">Or, for diagonals,</p>
<pre style="margin-top: 1em">$SIGMA
RSW= 0.3
EX= 0.35</pre>

<p style="margin-top: 1em">With NONMEM 7.5, Symbolic label
substitution may be specified for an entire block using the
NAMES option.</p>

<p style="margin-top: 1em">$SIGMA
<tt><i>BLOCK(</i></tt>n<tt><i>)&nbsp;NAMES</i></tt> (
<img src="grohtml-4068006-132.png" alt="Image grohtml-4068006-132.png">
,...,
<img src="grohtml-4068006-133.png" alt="Image grohtml-4068006-133.png">
) <tt><i>VALUES</i></tt> (odiag,diag) (NM75)</p>

<p style="margin-top: 1em">This is a compact way of
defining one or more
<img src="grohtml-4068006-134.png" alt="Image grohtml-4068006-134.png">
s with labels and, when combined with VALUES, with initial
values. For example</p>

<pre style="margin-top: 1em">$SIGMA BLOCK(2) NAMES(RSW,EX) VALUES(0.03,0.01)</pre>


<p style="margin-top: 1em">This is equivalent to</p>

<pre style="margin-top: 1em">$SIGMA BLOCK(2)
RSW=  0.03
EX=   0.01 0.03</pre>


<p style="margin-top: 1em">If both are present, VALUES()
must come after NAMES().</p>

<h2>III.III.III.B.12. $MSFI Record
<a name="III.III.III.B.12."></a>
<a name="III.III.III.B.12. $MSFI Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$MSFI</i></tt> filename
[<tt><b>NORESCALE</b></tt>|<tt><i>RESCALE</i></tt>]
[<tt><i>NPOPETAS[=</i></tt>n]] <br>
[<tt><i>ONLYREAD</i></tt>]
[<tt><i>NOMSFTEST</i></tt>|<tt><b>MSFTEST</b></tt>] <br>
[<tt><i>VERSION=</i></tt>n] <br>
[<tt><i>NEW</i></tt>]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$MSFI   MSF13</pre>

<p style="margin-top: 1em">This record gives the name of a
Model Specification File to be input. Such a Model
Specification File is a file output by a previous NONMEM
run, which contains certain model information pertaining to
that run. It also contains other information which allows
(i) the minimization search in that run, if terminated
unsuccessfully because the limit on the allowable number of
objective function evaluations was attained, to be smoothly
continued in the current run, and (ii) Covariance, Table,
and Scatterplot Steps in the current run, which follow the
successful termination of that search (in the current run or
the previous run) to be implemented.</p>

<p style="margin-top: 1em">Starting with NONMEM V, a MSFI
may be used to repeat the Estimation Step using a method
other than the one used to write the MSF. This is possible
if the MSFI contains the results of a search that terminated
successfully.</p>

<p style="margin-top: 1em">This record is required only if
a Model Specification File is to be input. With PREDPP, if a
$PK record is not used, while a $ERROR record is used, the
$MSFI record must precede the $ERROR record.</p>

<p style="margin-top: 1em">The filename must be the first
option on the record.</p>

<p style="margin-top: 1em">If the search is continued in
the current run (see section B.14), use of the
<tt>NORESCALE</tt> option means that the search is continued
just as it would have been continued in the previous run had
the limit on the number of function evaluations not been
attained. Use of the <tt>RESCALE</tt> option means that
before the search is continued, the final estimates of the
UCP (Unconstrained Parameters) from the previous run are
rescaled so that they are all 0.1. (See Guide I, section
C.3.5.1, where the UCP are referred to as STP. For repeating
and rescaling, see Guide II, section F, where the UCP are
referred to as RCP).</p>

<p style="margin-top: 1em">When the $MSFI record is used in
a problem specification, $THETA, $OMEGA, and $SIGMA records
should not appear for that specification.</p>

<p style="margin-top: 1em">The number n with the
<tt>NPOPETAS</tt> option is the number of
<img src="grohtml-4068006-135.png" alt="Image grohtml-4068006-135.png">
variables used with population data. When n is 0, then the
data are regarded as single-subject data (see section
II.C.4). It is a good practice to include the
<tt>NPOPETAS</tt> option; it is a simple thing to do.
However, the <tt>NPOPETAS</tt> option is only needed when
the data should be regarded as population data and: (i) a
$PRED record is not used and the label L1 is not used in the
$INPUT record (or if PREDPP is used, (ii) $PK and $ERROR
records are not used and the label L1 is not used in the
$INPUT record, or (iii) a $PK record is not used, while a
$ERROR record is used).</p>

<p style="margin-top: 1em"><tt>POPETAS</tt> or any of its
abbreviations are aliases for <tt>NPOPETAS</tt>.</p>

<p style="margin-top: 1em">With NONMEM VI and 7.x, other
options are available.</p>

<p style="margin-top: 1em"><tt>ONLYREAD NOMSFTEST MSFTEST
VERSION NEW</tt></p>

<p style="margin-top: 1em">These are described in Guide
VIII On-line help</p>

<h2>III.III.III.B.13. $SIMULATION Record
<a name="III.III.III.B.13."></a>
<a name="III.III.III.B.13. $SIMULATION Record"></a>
</h2>


<pre style="margin-top: 1em"><i>$SIMULATION</i>  (seed1 [seed2] [<b>NORMAL</b>|<i>UNIFORM</i>|<i>NONPARAMETRIC</i>] [<i>NEW</i>]) ...
             [<i>SUBPROBLEMS=</i>n] [<i>ONLYSIMULATION</i>] [<i>OMITTED</i>]
             [<i>REQUESTFIRST</i>] [<i>REQUESTSECOND</i>] [<b>PREDICTION</b>|<i>NOPREDICTION</i>]
             [<i>TRUE=</i><b>INITIAL</b>|<i>FINAL</i>|<i>PRIOR</i>]
             [<i>BOOTSTRAP=</i>n&nbsp;[<b>REPLACE</b>|<i>NOREPLACE</i>] [<i>STRAT=label</i>] [<i>STRATF=label</i>]]
             [<b>NOREWIND</b>|<i>REWIND</i>] [<b>SUPRESET</b>|<i>NOSUPRESET</i>]
             [<i>RANMETHOD=[n|S|m|P]</i> ]
             [<i>PARAFILE=</i>[filename|<i>ON</i>|<i>OFF</i>]</pre>


<p style="margin-top: 1em"><tt><i>E.g.</i></tt>
<tt>$SIMULATION (889215690) (2239177789 UNIFORM)</tt></p>

<p style="margin-top: 1em"><tt><i>This record requests that
the Simulation Step be implemented.</i></tt></p>

<p style="margin-top: 1em">This record is optional.</p>

<p style="margin-top: 1em">Data are generated according to
a statistical model. The DV data items of (NONMEM&rsquo;s
internal copy of) the data set are replaced by generated DV
items. The model is that specified in the code for PRED (for
PK, ERROR, etc. if PREDPP is used). The data are simulated
using the parameter values given as initial estimates; see
sections B.9-11. Initial estimates must be given for all
parameters of the model.</p>

<p style="margin-top: 1em">The model used for data
simulation may be complicated. It may involve covariables
and random interindividual and intraindividual random
effects. It may be the very model used for data analysis.
One reason to simulate with such a model is to explore the
information content of data obtained according to some
particular design. The design is encoded into the data set.
The Simulation and Estimation Steps, and possibly the
Covariance Step too, are implemented, so that one can assess
how well the true parameter values of the data analysis
model can be estimated. This technique can be used during
the course of a data analysis when the adequacy of the
design has become suspect. However, it can also be used
before the data are actually obtained to explore design
choices.</p>

<p style="margin-top: 1em">If only a simulation of the
structural part of the model is desired, i.e. the model
without statistical components, the model need not involve
random effects. In this case the $SIMULATION record need not
even appear. If it does appear, the DV items are replaced
with generated DV items based only on the structural model.
If it does not appear, the DV items are not replaced, but
prediction items, i.e. predictions returned by PRED, may
still be displayed. To simulate only the structural part of
the model when a full statistical model has already been
specified, <i>fix</i> the initial estimates of the variances
of the random effects, i.e. the initial estimates of
<img src="grohtml-4068006-136.png" alt="Image grohtml-4068006-136.png">
and
<img src="grohtml-4068006-137.png" alt="Image grohtml-4068006-137.png">
, to zero.</p>

<p style="margin-top: 1em">Data can be simulated with one
model and analyzed with another. There are two approaches.
With the first approach, data are simulated in the
Simulation Step and output in the Table Step (see section
B.16). The table serves as the data set for a subsequent
NONMEM run. (The DROP label can be used with the prediction,
residual, and weighted residual data items of the table; see
section B.2.) In the subsequent run the data are analyzed
using the analysis model. With the second approach, codes
for both models are given in PRED, but with any particular
call to PRED, one or the other code is executed according to
the value of a special variable (<tt>ICALL</tt>) that
signals whether PRED is being called during the Simulation
Step or a data analysis step (see section IV.D). The
advantage of the first approach is that it is a bit more
flexible. The advantage of the second is that data sets and
the analyses performed on them can be more easily
replicated; see the discussion below concerning the option
<tt>SUBPROBLEMS</tt>.</p>

<p style="margin-top: 1em">A random source is an infinite
sequence of pseudo-random numbers. At most 10 random sources
can be defined for a single problem. The sources are
numbered according to the ordering of their definitions in
the record. The information coded within each set of
parentheses defines the attributes of a single random
source. A random source can be used with the problem for
which it is defined. The same source can be defined for
different problems. A source defined for one problem can be
continued in a subsequent problem; see below. Unless a
random source is explicitly defined for a given problem, it
cannot be used with that problem.</p>

<p style="margin-top: 1em">When the model, i.e.
<i>either</i> the simulation model or the data analytic
model, uses
<img src="grohtml-4068006-138.png" alt="Image grohtml-4068006-138.png">
variables, or both
<img src="grohtml-4068006-139.png" alt="Image grohtml-4068006-139.png">
and
<img src="grohtml-4068006-140.png" alt="Image grohtml-4068006-140.png">
variables, and the Simulation Step is implemented, at least
one random source must be defined (unless the variances of
these variables are 0; see below). When the model is a
mixture model and the Simulation Step is implemented, at
least one random source must be defined. The first source is
used by NONMEM to generate realizations of the
<img src="grohtml-4068006-141.png" alt="Image grohtml-4068006-141.png">
and
<img src="grohtml-4068006-142.png" alt="Image grohtml-4068006-142.png">
variables and/or to randomly mix individuals into different
subpopulations according to the mixing parameter. Only the
<tt>NORMAL</tt> attribute can be used with this source, i.e.
during simulation the
<img src="grohtml-4068006-143.png" alt="Image grohtml-4068006-143.png">
and
<img src="grohtml-4068006-144.png" alt="Image grohtml-4068006-144.png">
variables are understood to be normally-distributed.
(Mixing, though, does not involve normal pseudo-random
numbers.) The <tt>NEW</tt> attribute cannot be used with any
source other than this first source (see below).</p>

<p style="margin-top: 1em">The remaining defined random
sources are used exclusively by the PRED subroutine (by the
PK and ERROR subroutines if PREDPP is used). If no
<img src="grohtml-4068006-145.png" alt="Image grohtml-4068006-145.png">
variables appear in the model and a mixture model is not
used, then <i>all</i> defined random sources can be used by
PRED. On the other hand, in this case, no sources need even
be defined. If
<img src="grohtml-4068006-146.png" alt="Image grohtml-4068006-146.png">
(and possibly
<img src="grohtml-4068006-147.png" alt="Image grohtml-4068006-147.png">
) variables appear in the simulation model, but the initial
estimates of
<img src="grohtml-4068006-148.png" alt="Image grohtml-4068006-148.png">
(and
<img src="grohtml-4068006-149.png" alt="Image grohtml-4068006-149.png">
) are 0, and if a mixture model is not used, then again, no
sources need be defined. A random source not used by NONMEM
per se is called a <b>user random source</b> Such a source
can use either the <tt>NORMAL</tt> or <tt>UNIFORM</tt>
attribute (see below).</p>

<p style="margin-top: 1em">Numbers from user random sources
are obtained via the NONMEM utility RANDOM. An abbreviated
code or a user-supplied FORTRAN code can use RANDOM by
executing the FORTRAN statement</p>
<pre style="margin-top: 1em">CALL RANDOM (K,R)</pre>

<p style="margin-top: 1em">Each time RANDOM is called with
<tt>K</tt> set to the index of a given user source, the
routine returns the next number from that source. This
number is returned in <tt>R</tt>, and is always a
single-precision number.</p>

<p style="margin-top: 1em">Seed1 and seed2 together
initiate the random source. Seed2 is used only seldomly (see
below), and each seed is an integer between 0 and
21474836447. Two sources are the same if they are initiated
with the same seeds.</p>

<p style="margin-top: 1em">Suppose that the current problem
specification is not the first problem specification in the
control stream, that the source is the ith source,
<img src="grohtml-4068006-150.png" alt="Image grohtml-4068006-150.png">
, and that the last problem to use as many as i sources was
problem number m. Then seed1 can be -1, indicating that
<img src="grohtml-4068006-151.png" alt="Image grohtml-4068006-151.png">
is the <b>continuation</b> of the ith source,
<img src="grohtml-4068006-152.png" alt="Image grohtml-4068006-152.png">
, defined with problem m. That is, if the last number used
from
<img src="grohtml-4068006-153.png" alt="Image grohtml-4068006-153.png">
was
<img src="grohtml-4068006-154.png" alt="Image grohtml-4068006-154.png">
, then
<img src="grohtml-4068006-155.png" alt="Image grohtml-4068006-155.png">
is the infinite tail sequence of
<img src="grohtml-4068006-156.png" alt="Image grohtml-4068006-156.png">
starting with
<img src="grohtml-4068006-157.png" alt="Image grohtml-4068006-157.png">
.</p>

<p style="margin-top: 1em">Seed2 is used when it is desired
that the current problem make use of a continuation of a
random source defined in a preceding NONMEM run. Examine the
NONMEM output from the Simulation Step of the last problem
in the earlier run using this source. Two ending seeds are
printed in this output; often the second seed is 0. The
continuation in the current problem is defined using these
two seeds as seed1 and seed2. When the second seed is 0, it
need not be given.</p>

<p style="margin-top: 1em">Use of the <tt>NORMAL</tt>
option means that the numbers of the source are to be
pseudo-normal with mean 0 and variance 1 (unless the source
is the first and used to generate
<img src="grohtml-4068006-158.png" alt="Image grohtml-4068006-158.png">
and
<img src="grohtml-4068006-159.png" alt="Image grohtml-4068006-159.png">
realizations, in which case the variance-covariance of these
variables is that specified in the $OMEGA and $SIGMA
records). Use of the <tt>UNIFORM</tt> option means that the
numbers of the source are to be pseudo-uniform on the
interval [0,1].</p>

<p style="margin-top: 1em">During the Simulation Step PRED
has access to simulated values for the
<img src="grohtml-4068006-160.png" alt="Image grohtml-4068006-160.png">
variables via the NONMEM utility routine SIMETA. When PRED
is called with a data record from a given individual record,
PRED can execute the abbreviated code or FORTRAN
statement</p>
<pre style="margin-top: 1em">CALL SIMETA (ETA)</pre>

<p style="margin-top: 1em">which results in appropriate
values being stored in the one-dimensional ETA array; see
section IV.A. These values will arise from a multivariate
normal pseudo-random distribution with mean 0 and
variance-covariance as specified with the $OMEGA record. By
default, no matter how many times this statement is
executed, as long as the individual record is the same, the
same values are stored. If, though, the <tt>NEW</tt> option
is used, each time the statement is executed, new values are
stored. Thus, for example, when PRED is called with the
first data record of an individual record, PRED can in turn
call SIMETA multiple times until values are obtained such
that none are larger than 5 in absolute value, i.e. values
can be obtained from a truncated distribution. (To pursue
this example, see section IV.I.)</p>

<p style="margin-top: 1em">During the Simulation Step PRED
has access to simulated values for the
<img src="grohtml-4068006-161.png" alt="Image grohtml-4068006-161.png">
variables via the NONMEM utility routine SIMEPS. When PRED
is called, it can execute the abbreviated code or FORTRAN
statement</p>
<pre style="margin-top: 1em">CALL SIMEPS (EPS)</pre>

<p style="margin-top: 1em">which results in appropriate
values being stored in the one-dimensional EPS array; see
section IV.A. These values will arise from a multivariate
normal pseudo-random distribution with mean 0 and
variance-covariance as specified with the $SIGMA record. By
default, no matter how many times this statement is executed
within the same call to PRED (or more precisely, as long as
PRED is being called with a data record from the same
level-two record; see Guide I, section B.1), the same values
are stored. If, though, the <tt>NEW</tt> option is used,
each time the statement is executed, new values are
stored.</p>

<p style="margin-top: 1em">Values of
<img src="grohtml-4068006-162.png" alt="Image grohtml-4068006-162.png">
&rsquo;s and
<img src="grohtml-4068006-163.png" alt="Image grohtml-4068006-163.png">
&rsquo;s are obtained by calls to SIMETA and SIMEPS occuring
in the generated subroutine. When the data are population
data and the Simulation Step is implemented, SIMETA is
called once per individual record, and SIMEPS is called once
every call to PRED (once every call to ERROR if PREDPP is
used). When the data are single-subject data and the
Simulation Step is implemented, SIMETA is called once every
call to PRED (once every call to ERROR if PREDPP is used).
These calls are implemented so that even if the Simulation
Step is not implemented, the load module resulting from
using an abbreviated code for PRED (for PK or ERROR if
PREDPP is used) can be reused with a run implementing the
Simulation Step. For multiple calls to SIMETA or SIMEPS
making use of the <tt>NEW</tt> option, additional calls can
be used either in PRED (or PK or ERROR) or in the
abbreviated code.</p>

<p style="margin-top: 1em">If the <tt>SUBPROBLEMS</tt>
option is used, the entire problem is repeated n times in
succession. Each repetition of the problem is called a
<b>subproblem</b></p>

<p style="margin-top: 1em">Each subproblem includes the
Simulation Step, and any other steps requested in the
problem specification, but each of the random sources <i>are
continued</i> from subproblem to subproblem. This allows the
effects of sampling variability to be directly assessed. If
<img src="grohtml-4068006-164.png" alt="Image grohtml-4068006-164.png">
, the result is the same as if the <tt>SUBPROBLEMS</tt>
option is omitted.</p>

<p style="margin-top: 1em">By default, when the Simulation
Step is implemented, various statistics used for data
analysis are always computed from the simulated data. These
are the value of the objective function at the initial
parameter estimates and if a table is requested, the
weighted residuals based on these estimates. The data may be
simulated in a way that gives rise to a problem with
computing these statistics. For example, perhaps the
simulation model is not appropriate for data analysis using
the NONMEM default objective function. For this reason, or
for some other, the Simulation Step can be implemented so
that these statistics are not computed. This is accomplished
by including the option <tt>ONLYSIMULATION</tt>. In this
case the Estimation and Covariance Steps are not
implementable in the problem.</p>

<p style="margin-top: 1em">If the option
<tt>ONLYSIMULATION</tt> is used, a PRED-defined item (see
section IV.F) that depends on values of
<img src="grohtml-4068006-165.png" alt="Image grohtml-4068006-165.png">
&rsquo;s and/or
<img src="grohtml-4068006-166.png" alt="Image grohtml-4068006-166.png">
&rsquo;s is displayed in tables and scatterplots using
simulated values for the
<img src="grohtml-4068006-167.png" alt="Image grohtml-4068006-167.png">
&rsquo;s and
<img src="grohtml-4068006-168.png" alt="Image grohtml-4068006-168.png">
&rsquo;s. See sections B.16 and IV.F for a description of
the appropriate label to use. Starting with NONMEM VI,
simulated values of an
<img src="grohtml-4068006-169.png" alt="Image grohtml-4068006-169.png">
variable are displayable by using <tt>ETA</tt> labels in
$TABLE or $SCATTERPLOT records. <br>
Otherwise, the item is displayed either using zero values,
or if it depends on
<img src="grohtml-4068006-170.png" alt="Image grohtml-4068006-170.png">
&rsquo;s and conditional estimates are available, it is
displayed using conditional estimates for the
<img src="grohtml-4068006-171.png" alt="Image grohtml-4068006-171.png">
&rsquo;s (see section B.14).</p>

<p style="margin-top: 1em">Another way to display a
quantity computed in PRED that uses simulated values of
<img src="grohtml-4068006-172.png" alt="Image grohtml-4068006-172.png">
&rsquo;s and/or
<img src="grohtml-4068006-173.png" alt="Image grohtml-4068006-173.png">
&rsquo;s is to store the quantity in the data array; data
items are always displayable. <br>
Transgeneration of data items is allowed during the
Simulation Step. (Transgenerated items are stored in the
internal copy of NONMEM&rsquo;s data set.) This is a way,
therefore, to display the quantity even when
<tt>ONLYSIMULATION</tt> is not used. Starting with NONMEM V,
one can store quantities in the data array using abbreviated
code (see section IV.A). For earlier versions, either a
user-supplied PRED must be used (for an example with a
user-supplied PK, see Guide VI, Figure 2 and the
accompanying discussion in section III.L.1), or verbatim
code must be used (for an example of transgeneration using
verbatim code, see section IV.I). These examples are still
of interest.</p>

<p style="margin-top: 1em">If the <tt>OMITTED</tt> option
is used, the Simulation Step is not implemented, even though
the $SIMULATION record appears. When used, no other option
should be used.</p>

<p style="margin-top: 1em">When the Simulation Step is
implemented, initial estimates must explicitly appear for
all parameters of the statistical model.</p>

<p style="margin-top: 1em">Seed1 must occur first among the
attributes of a random source. All the other attributes can
occur in any order. Any two attributes can be separated by
spaces or a comma.</p>

<p style="margin-top: 1em"><tt>SIML</tt> is an alias for
<tt>SIMULATION</tt>.</p>

<p style="margin-top: 1em"><tt>REQUESTFIRST</tt> and
<tt>REQUESTSECOND</tt></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="27%">


<p style="margin-top: 1em"><tt>REQUESTFIRST</tt></p></td>
<td width="73%">
</td></tr>
</table>

<p style="margin-left:33%;">NONMEM sets a variable IFIRSTEM
in Module ROCM_INT (referenced as FIRSTEM in abbreviated
code) informing PRED whether or not PRED needs to compute
first-partial derivatives with respect to eta. Normally,
during the Simulation Step, these derivatives are not
needed, either by NONMEM or by the user. However, the user
may want the first-partial eta derivatives of a PRED-defined
item and may want FIRSTEM to reflect this. With the
<tt>REQUESTFIRST</tt> option, the FIRSTEM variable is set so
to inform PRED that the derivatives need to be computed. In
this case, if an abbreviated code is used to compute the
PRED-defined item, the item should not be computed within a
simulation block, because NM-TRAN does not provide
derivatives for PRED-defined items in a simulation
block.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="29%">

<pre style="margin-top: 1em">REQUESTSECOND</td>
<td width="71%">
</td></tr>
</table></pre>

<p style="margin-left:33%;">NONMEM sets a variable ISECDER
in Module ROCM_INT (referenced as MSEC in abbreviated code)
informing PRED whether or not PRED needs to compute
second-partial derivatives with respect to eta. Normally,
during the Simulation Step, these derivatives are not
needed, either by NONMEM or by the user. However, the user
may want the second-partial eta derivatives of a
PRED-defined item and may want the MSEC variable to reflect
this. With the <tt>REQUESTSECOND</tt> option, the MSEC
variable is set so to inform PRED that the derivatives need
to be computed. In this case, if an abbreviated code is used
to compute the PRED-defined item, the item should not be
computed within a simulation block, because NM-TRAN does not
provide derivatives for PRED-defined items in a simulation
block. <tt>REQUESTSECOND</tt> implies
<tt>REQUESTFIRST</tt>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="23%">

<pre style="margin-top: 1em">PREDICTION</td>
<td width="77%">
</td></tr>
</table></pre>

<p style="margin-left:33%;">Permitted only with
<tt>ONLYSIM</tt>, and is the default. <br>
With or without <tt>ONLYSIM</tt>, unless the
<tt>NOPREDICTION</tt> is used, the simulated observation is
taken to be the quantity to which the Y variable (with
NM-TRAN abbreviated code) or F variable (with a
user-supplied PRED or ERROR routine) is set. In a simulation
block, the DV variable may be directly set to the simulated
observation, but the Y (or F) variable should also be set to
this observation. E.g., if a line of code <tt>DV=...</tt> is
used in a simulation block, be sure to follow this line with
the additional line <tt>Y=DV</tt>.</p>

<p style="margin-top: 1em">With the Simulation Step, PRED
may return the simulated observation as the DV data item,
rather than in the argument F. With odd-type data the
simulated observation must be returned as the DV data
item.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="27%">

<pre style="margin-top: 1em">NOPREDICTION</td>
<td width="73%">
</td></tr>
</table></pre>

<p style="margin-left:33%;">Permitted only with
<tt>ONLYSIM</tt>. <br>
Indicates that the simulated observation will be taken to be
the value to which the DV variable is set. The code
<tt>Y=...</tt> is permitted inside or outside a simulation
block, but if such code appears in a simulation block, be
sure to also include e.g. <tt>DV=Y</tt>. Also, etas (if any)
are understood to be population etas, even if epsilons do
not appear.</p>

<p style="margin-top: 1em">With NONMEM VI and 7, other
options are available.</p>

<h2>III.III.III.B.14. $ESTIMATION Record
<a name="III.III.III.B.14."></a>
<a name="III.III.III.B.14. $ESTIMATION Record"></a>
</h2>


<p style="margin-top: 1em"><tt>$ESTIMATION</tt>
[<tt>METHOD=</tt>kind]
[<tt><b>NOINTERACTION</b></tt>|<tt>INTERACTION</tt>]
[<tt><b>NOLAPLACIAN</b></tt>|<tt>LAPLACIAN</tt>] <br>
[<tt><b>NOPOSTHOC</b></tt>|<tt>POSTHOC</tt>] [<tt>SIGDIGITS=
<img src="grohtml-4068006-174.png" alt="Image grohtml-4068006-174.png"></tt>
] [<tt>MAXEVALS=
<img src="grohtml-4068006-175.png" alt="Image grohtml-4068006-175.png"></tt>
] [<tt>PRINT=
<img src="grohtml-4068006-176.png" alt="Image grohtml-4068006-176.png"></tt>
] <br>
[<tt><b>ABORT</b></tt>|<tt>NOABORT</tt>]
[<tt>MSFO=</tt>filename]
[<tt><b>NOREPEAT</b></tt>|<tt>REPEAT</tt>]
[<tt>OMITTED</tt>] <br>

[<tt><b>PREDICTION</b></tt>|<tt>LIKELIHOOD</tt>|<tt>-2LOGLIKELIHOOD</tt>]
<br>
[<tt><b>NOSUB=0</b></tt> | <tt>NOSUB=1</tt>]</p>

<p style="margin-top: 1em">E.g. <tt>$ESTIMATION MAXEVAL=450
PRINT=5</tt></p>

<p style="margin-top: 1em">This record requests that the
Estimation Step be implemented.</p>

<p style="margin-top: 1em">This record is optional.</p>

<p style="margin-top: 1em">With versions of NONMEM through
VI, multiple $ESTIMATION records in the same problem were
considered to continue a single $ESTIMATION record. With
NONMEM 7, a sequence of two or more $ESTIMATION records
within a given problem will result in the sequential
execution of separate NONMEM Estimation Steps. (A given
$ESTIMATION record may still be continued if
&rsquo;$ESTIMATION&rsquo; is omitted from subsequent records
in the block.) If $TABLE statements succeed multiple $EST
statements within a run, the table results (as well as
scatter plots if requested via $SCATTER) will pertain to the
last analysis.</p>

<p style="margin-top: 1em">The following section describes
the classical methods. All estimation methods obtain
parameter estimates by minimizing an objective function
whose arguments are the parameters of the model. The methods
differ from each other because they use different types of
objective functions (see Guide VII).</p>

<p style="margin-top: 1em">If the <tt>METHOD</tt> option is
omitted, then the first-order estimation method is used.
With single-subject data, and when a CONTR routine is not
supplied by the user, this particular method is simply the
extended least squares method. If the option is used, then
the option value (kind) can be <tt>ZERO</tt>, in which case
the first-order estimation method is used, or it can be
<tt>CONDITIONAL</tt>, in which case a conditional estimation
is used.</p>

<p style="margin-top: 1em">The <tt>INTERACTION</tt> option
can be used when the statistical model includes
<img src="grohtml-4068006-177.png" alt="Image grohtml-4068006-177.png">
variables (see end of chapter II for a discussion about
where it does not) and where the variance of some
observation, conditional on the values of the
<img src="grohtml-4068006-178.png" alt="Image grohtml-4068006-178.png">
variables, depends on these values. In this case the
first-order conditional estimation method with interaction
is used.</p>

<p style="margin-top: 1em">If the <tt>LAPLACIAN</tt> option
is used, the Laplacian (conditional) estimation method is
used. This option cannot also be used with the
<tt>INTERACTION</tt> option.</p>

<p style="margin-top: 1em">Conditional estimates of
individual-specific
<img src="grohtml-4068006-179.png" alt="Image grohtml-4068006-179.png">
values may be obtained and displayed. These estimates are
empirical Bayesian estimates, conditional not only on the
data, but, importantly, also on values for the population
parameters. If the first-order estimation method is used,
they may be obtained <i>after</i> the population parameter
estimates have themselves been obtained. To obtain them,
include the option <tt>POSTHOC</tt>. The term &rsquo;posthoc
estimates&rsquo; is commonly applied to these particular
conditional estimates. When the first-order estimation
method is used, and a mean-variance intraindividual model is
used, the posthoc estimates are computed under the
assumption that the variance model is that of the mean
individual; see Guide VII. To obtain posthoc estimates
without this assumption use the final estimates as initial
estimates and the options <tt>MAXEVALS=0</tt>,
<tt>METHOD=CONDITIONAL</tt>, <tt>INTERACTION</tt> (see
below).</p>

<p style="margin-top: 1em">If a conditional estimation
method is used, the conditional estimates are obtained
<i>simultaneously</i> with the population parameter
estimates. In this case the option <tt>POSTHOC</tt> is
superfluous, but it may be used. The term &rsquo;conditional
estimates&rsquo; applies when empirical Bayesian estimates
are obtained, whether or not a conditional estimation method
is used, and no matter what values are used for population
parameters. For example, the term can apply to the
conditional estimates associated with using the first-order
conditional estimation method and using the initial
estimates of the population parameters (to see how to obtain
these; see below).</p>

<p style="margin-top: 1em">The number
<img src="grohtml-4068006-180.png" alt="Image grohtml-4068006-180.png">
is the number of significant digits required in the final
parameter estimate. If the <tt>SIGDIGITS</tt> option is
omitted,
<img src="grohtml-4068006-181.png" alt="Image grohtml-4068006-181.png">
defaults to 3. If the option is used,
<img src="grohtml-4068006-182.png" alt="Image grohtml-4068006-182.png">
must be a positive integer less than 9.</p>

<p style="margin-top: 1em">The number
<img src="grohtml-4068006-183.png" alt="Image grohtml-4068006-183.png">
is the maximum allowable number of evaluations of the
objective function which can occur during the minimization
search. If the <tt>MAXEVALS</tt> option is omitted,
<img src="grohtml-4068006-184.png" alt="Image grohtml-4068006-184.png">
defaults to a generous number.</p>

<p style="margin-top: 1em">The number
<img src="grohtml-4068006-185.png" alt="Image grohtml-4068006-185.png">
can be 0. In this case the Estimation Step is not
implemented. However, a number of statistics can be
obtained:</p>

<p style="margin-left:33%; margin-top: 1em">The value of
the objective function is obtained using the initial
parameter estimates, unless an $MSFI record is used, in
which case the function is computed using the final
parameter estimates from the earlier problem producing the
Model Specification File. The options <tt>METHOD</tt>,
<tt>INTERACTION</tt> and <tt>LAPLACIAN</tt> can be used to
specify the objective function to be used (unless an $MSFI
record is used, in which case these options are ignored, and
the objective function specified by these options, <i>as
they were used with the problem generating the Model
Specification File</i>, is the one that is used). The rules
governing the use of these options are as given above.</p>

<p style="margin-left:33%; margin-top: 1em">The output from
the Covariance Step is obtained if requested. A $MSFI record
must be used, and the computations are based on the final
parameter estimates from the earlier problem. The options
<tt>METHOD</tt>, <tt>INTERACTION</tt> and <tt>LAPLACIAN</tt>
are ignored; the objective function specified by these
options, <i>as they were used with the problem generating
the Model Specification File</i>, is the one that is used.
The <tt>SIGDIGITS</tt> option may be omitted, in which case
the usual default value for
<img src="grohtml-4068006-186.png" alt="Image grohtml-4068006-186.png">
(i.e. 3) is used in these computations. The value used with
the current problem must be no greater than the number of
digits actually obtained in the final estimate from the
earlier problem. If the value 4, say, was used in the
earlier problem, and 4.4 digits were actually obtained, then
although the value 3 could be used in the current problem,
it would be much better to again use 4. The
<tt>SIGDIGITS</tt> option can be used, and
<img src="grohtml-4068006-187.png" alt="Image grohtml-4068006-187.png">
can be any positive integer less than 9.</p>

<p style="margin-left:33%; margin-top: 1em">Conditional
estimates may be obtained and may be displayed. These
estimates are based on the initial population parameter
estimates, unless a $MSFI record is used, in which case they
are based on the final parameter estimates from the earlier
problem. If posthoc estimates are desired, use the option
<tt>POSTHOC</tt>. If conditional estimates associated with
some particular conditional estimation methods are desired,
use <tt>METHOD=CONDITIONAL</tt> along with
<tt>INTERACTION</tt> or <tt>LAPLACIAN</tt> if necessary
(unless a $MSFI record is used, in which case these options
are ignored, and the effects of these options on conditional
estimates, <i>as these options were used with the problem
generating the Model Specification File</i>, are the ones
that result). The rules governing the use of these options
are as given above. Variables defined in PRED (in PK or
ERROR if PREDPP is used) that depend on
<img src="grohtml-4068006-188.png" alt="Image grohtml-4068006-188.png">
&rsquo;s are displayed using the conditional estimates.</p>

<p style="margin-top: 1em">The number
<img src="grohtml-4068006-189.png" alt="Image grohtml-4068006-189.png">
can be -1 if a $MSFI record is used. Then the maximum
allowable number of objective function evaluations is the
same as that used in the problem that produced the Model
Specification File.</p>

<p style="margin-top: 1em">The number
<img src="grohtml-4068006-190.png" alt="Image grohtml-4068006-190.png">
is the number of iterations skipped between iteration
summaries. When
<img src="grohtml-4068006-191.png" alt="Image grohtml-4068006-191.png">
, no iteration summaries are printed. If the <tt>PRINT</tt>
option is omitted,
<img src="grohtml-4068006-192.png" alt="Image grohtml-4068006-192.png">
defaults to 9999 so that iteration summaries for only the
0th and last iterations are printed.</p>

<p style="margin-top: 1em"><tt>NOSUB</tt> is a new option
with NONMEM 7.4 that controls a new feature, label
substitution.</p>

<p style="margin-top: 1em">For information concerning the
options <tt>ABORT</tt> and <tt>NOABORT</tt>, see section
IV.G.</p>

<p style="margin-top: 1em">If the <tt>MSFO</tt> option is
used, a Model Specification File is output. The name of the
file is given. This name should not include embedded spaces,
commas, semicolons, or parentheses. The file contains
certain model information pertaining to the problem, and it
contains other information which allows the minimization
search in this problem, if terminated prematurely and
unsuccessfully because the limit
<img src="grohtml-4068006-193.png" alt="Image grohtml-4068006-193.png">
is attained, to be smoothly continued in a succeeding run.
It also contains information which allows the Covariance,
Table, and Scatterplot Steps which follow the successful
termination of the search in this run to be implemented in a
succeeding run. A Model Specification File should not be
output when a $SIMULATION record appears and the number of
subproblems exceeds 1.</p>

<p style="margin-top: 1em">If the <tt>NOREPEAT</tt> option
is used, the estimate obtained at the end of the
minimization search is taken to be the final parameter
estimate. If the <tt>REPEAT</tt> option is used, then upon
successful termination of the search, the search is repeated
after the UCP are first rescaled so that they are all 0.1.
(See Guide I, section C.3.5.1, where the UCP are referred to
as STP. For repeating and rescaling, see Guide II, section
F, where the UCP are referred to as RCP). In this case
<img src="grohtml-4068006-194.png" alt="Image grohtml-4068006-194.png">
is used to limit the number of objective function
evaluations over both searches combined, and a Model
Specification File, if output, contains the information
holding at the termination of the second search.</p>

<p style="margin-top: 1em">The <tt>LIKELIHOOD</tt> and
<tt>-2LOGLIKELIHOOD</tt>] options are used with odd-type
data, discussed in Chapter II.D. <tt>PREDICTION</tt> is the
default.</p>

<p style="margin-top: 1em">If the <tt>OMITTED</tt> option
is used, the Estimation Step is not implemented, even though
the $ESTIMATION record appears. When used, no other option
should be used.</p>

<p style="margin-top: 1em"><tt>ESTM</tt> is an alias for
<tt>ESTIMATION</tt>. The numbers <tt>0</tt> and <tt>1</tt>
can be used with the <tt>METHOD</tt> option instead of
<tt>ZERO</tt> and <tt>CONDITIONAL</tt>, respectively.
<tt>LAPLACEAN</tt> (and hence its abbreviation
<tt>LAPLACE</tt>) is an alias for <tt>LAPLACIAN</tt>.</p>

<p style="margin-top: 1em">Many additional methods and
options are available. These are described in Guide VIII and
On-line help. <br>
(See Guide Introduction_7 &quot;$ESTIMATION Record
(NM75)&quot;)</p>

<h2>III.III.III.B.15. $COVARIANCE Record
<a name="III.III.III.B.15."></a>
<a name="III.III.III.B.15. $COVARIANCE Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$COVARIANCE</i></tt>
[<tt><i>SPECIAL</i></tt>] [<tt><i>MATRIX=</i></tt>]
[<tt><i>PRINT=</i></tt>[<tt><i>E</i></tt>][<tt><i>R</i></tt>][<tt><i>S</i></tt>]
<br>
[<tt><i>COMPRESS</i></tt>] <br>

[<tt><i>SLOW</i></tt>|<tt><b>NOSLOW</b></tt>|<tt><i>FAST</i></tt>]
<br>
[<tt><i>SIGL=
<img src="grohtml-4068006-195.png" alt="Image grohtml-4068006-195.png"></i></tt>
] [<tt><i>SIGLO=
<img src="grohtml-4068006-196.png" alt="Image grohtml-4068006-196.png"></i></tt>
] <br>
[<tt><i>NOFCOV</i></tt>] <br>

[<tt><i>PARAFILE=</i></tt>[filename|<tt><i>ON</i></tt>|<tt><i>OFF</i></tt>]
<br>
[<tt><i>RESUME</i></tt>] <br>
[<tt><i>CONDITIONAL</i></tt>|<tt><i>UNCONDITIONAL</i></tt>]
<br>
[<tt><i>OMITTED</i></tt>]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$COVARIANCE</pre>

<p style="margin-top: 1em">This record requests that the
Covariance Step be implemented.</p>

<p style="margin-top: 1em">This record is optional.</p>

<p style="margin-top: 1em">The <tt>SPECIAL</tt> option
should be used if the data are single-subject and a
recursive PRED subroutine (such as PREDPP) is used. A
recursive PRED subroutine is such that the PRED computation
with a data record depends on the PRED computation(s) with
previous data records. With PREDPP and single-subject data,
this option is the default.</p>

<p style="margin-top: 1em">The character c is either
<tt>R</tt> or <tt>S</tt>. Use of <tt>R</tt> or <tt>S</tt>
means that the covariance matrix is taken to be the inverse
of the R or S matrix, respectively. The R and S matrices are
two matrices from statistical theory, the Hessian and
Cross-Product Gradient matrices respectively. See Guide II,
section D.2.5. If <tt>R</tt> is used, the <tt>SPECIAL</tt>
option need not (and best not) be used. If the
<tt>MATRIX</tt> option is omitted, the covariance matrix is
taken to be
<img src="grohtml-4068006-197.png" alt="Image grohtml-4068006-197.png">
.</p>

<p style="margin-top: 1em">When the Covariance Step is
implemented, standard error estimates are always printed,
along with the covariance matrix (upon which the standard
error estimates are based), the inverse covariance matrix,
and the correlation form of the covariance matrix. When the
<tt>PRINT</tt> option is used, other outputs are also
available. The characters <tt>E</tt>, <tt>R</tt>, and
<tt>S</tt>, represent the eigenvalues of the covariance
matrix, the R matrix, and the S matrix, respectively. When
the <tt>PRINT</tt> option is used, one or more of these
characters should be chosen. The chosen characters need not
be separated, but a comma or spaces can separate two
characters: e.g. <tt>PRINT=ER</tt>, or <tt>=E R</tt>, or
<tt>=E,R</tt>. If the character c is chosen to be <tt>R</tt>
(<tt>S</tt>) with the <tt>MATRIX</tt> option, then this
character need not be chosen with the <tt>PRINT</tt> option;
in this case the covariance matrix is the R (S) matrix.</p>

<p style="margin-top: 1em">If the <tt>CONDITIONAL</tt>
option is used, the Covariance Step is implemented only when
either the Estimation Step terminates successfully, or a
Model Specification File is input and the Estimation Step is
not implemented. If the <tt>UNCONDITIONAL</tt> option is
used, then the Covariance Step is implemented when either
the Estimation Step is implemented or a Model Specification
File is input.</p>

<p style="margin-top: 1em">If the <tt>OMITTED</tt> option
is used, the Covariance Step is not implemented, even though
the $COVARIANCE record appears. When used, no other option
should be used.</p>

<p style="margin-top: 1em">Many additional methods and
options are available. These are described in Guide VIII and
On-line help.</p>

<h2>III.III.III.B.16. $TABLE Record
<a name="III.III.III.B.16."></a>
<a name="III.III.III.B.16. $TABLE Record"></a>
</h2>


<p style="margin-top: 1em"><tt><i>$TABLE</i></tt> [list1]
[<tt><i>BY</i></tt> list2] <br>
[<tt><b>PRINT</b></tt>|<tt><i>NOPRINT</i></tt>]
[<tt><i>FILE=</i></tt>filename] <br>
[<tt><i>NOHEADER</i></tt>|<tt><i>ONEHEADER</i></tt>]
[<tt><i>ONEHEADERALL</i></tt>] <br>
[<tt><i>NOTITLE</i></tt>|<tt><i>NOLABEL</i></tt>] <br>

[<tt><i>FIRSTONLY</i></tt>|<tt><i>LASTONLY</i></tt>|<tt><i>FIRSTLASTONLY</i></tt>]
<br>
[<tt><b>NOFORWARD</b></tt>|<tt><i>FORWARD</i></tt>] <br>
[<tt><b>APPEND</b></tt>|<tt><i>NOAPPEND</i></tt>] <br>
[<tt><i>FORMAT=
<img src="grohtml-4068006-198.png" alt="Image grohtml-4068006-198.png"></i></tt>
] [<tt><i>LFORMAT=
<img src="grohtml-4068006-199.png" alt="Image grohtml-4068006-199.png"></i></tt>
] [<tt><i>RFORMAT=
<img src="grohtml-4068006-200.png" alt="Image grohtml-4068006-200.png"></i></tt>
] <br>
[<tt><i>IDFORMAT=
<img src="grohtml-4068006-201.png" alt="Image grohtml-4068006-201.png"></i></tt>
] <br>
[<tt><i>NOSUB=[0|1]</i></tt>] <br>
[<tt><i>EXCLUDE_BY</i></tt> list3] <br>

[<tt><i>PARAFILE=</i></tt>[filename|<tt><i>ON</i></tt>|<tt><i>OFF</i></tt>]
<br>
[<tt><i>ESAMPLE=
<img src="grohtml-4068006-202.png" alt="Image grohtml-4068006-202.png"></i></tt>
][<tt><i>WRESCHOL</i></tt>] <br>
[<tt><i>SEED=
<img src="grohtml-4068006-203.png" alt="Image grohtml-4068006-203.png"></i></tt>
][<tt><i>CLOCKSEED=[0|1]</i></tt>] <br>
[<tt><i>RANMETHOD=[n|S|m]</i></tt> ] <br>
[<tt><i>VARCALC=[0|1|2]</i></tt>] <br>
[<tt><i>FIXEDETAS=(</i></tt>list<tt><i>)</i></tt>] <br>
[<tt><b>UNCONDITIONAL</b></tt>|<tt><i>CONDITIONAL</i></tt>]
[<tt><i>OMITTED</i></tt>]</p>

<p style="margin-top: 1em">E.g. <tt>$TABLE ID DOSE WT
TIME</tt></p>

<p style="margin-top: 1em">This record requests that the
Table Step be implemented.</p>

<p style="margin-top: 1em">This record is optional. There
should be one $TABLE record per table, up to ten $TABLE
records per problem (not counting continuation records). A
$TABLE record cannot be continued by series of contiguous
blocks; each contiguous block defines a different table.</p>

<p style="margin-top: 1em">A table is a two-dimensional
array. There is a one-to-one correspondence between the rows
of a table and the data records of the data set. The
elements of a row, the <b>row items</b> are items associated
with the corresponding data record. With NONMEM 7.4, some
data records may be excluded from the table; see
<tt>EXCLUDE_BY</tt> below.</p>

<p style="margin-top: 1em">List1 is a list of up to eight
labels (and synonyms), unless the <tt>NOAPPEND</tt> option
is used (see below), in which case the list may be up to 12
labels, or the the <tt>NOPRINT</tt> option is used (see
below), in which case <br>
the list can be as long as <br>
the value of constant PDT in resource/SIZES (default is
500). The list may include labels used in the $INPUT record
for different data item types. It may include labels chosen
from the list <tt>ETA1</tt>, <tt>ETA2</tt>, ...,
<tt>ETA9</tt>, <tt>ETA10</tt>,...,
<tt>ETA99</tt>,<tt>ETA100</tt>,..., <tt>ETA999</tt> which
label conditional estimates of the
<img src="grohtml-4068006-204.png" alt="Image grohtml-4068006-204.png">
&rsquo;s (called
<img src="grohtml-4068006-205.png" alt="Image grohtml-4068006-205.png">
<b>items</b> ). (There can be at most LVR
<img src="grohtml-4068006-206.png" alt="Image grohtml-4068006-206.png">
&rsquo;s in the model, where LVR is a constant in
resource/SIZES)</p>

<p style="margin-top: 1em">The list may include labels for
PRED-defined items; for a description of these labels see
below and also section IV.F.</p>

<p style="margin-top: 1em">The row items of a given row are
those with labels specified in list1, along with the the
dependent variable (<tt>DV</tt>), prediction
(<tt>PRED</tt>), residual (<tt>RES</tt>), and weighted
residual (<tt>WRES</tt>) row items. These last four items
always appear as the last four row items. If list1 is
omitted, only these four types of items appear in the table.
With NONMEM V, option <tt>NOAPPEND</tt> may be used to
request that these four items not be appended to the list,
in which case each of them may be listed individually
anywhere in list1 and will appear where it is listed. All
four may also be explicitly appended to the list using
option <tt>APPEND</tt>, which is the default. With NONMEM 7,
related special diagnostic items may also be listed; these
are described in the Guide Introduction to NONMEM 7 and
Guide VIII and on-line help for $TABLE.&dagger; <br>
----------</p>

<p style="margin-top: 1em"><cite>&dagger; The special
diagnostic items are: <tt><br>
NPRED</tt>, <tt>NRES</tt>, <tt>NWRES</tt>, <tt>PREDI</tt>,
<tt>RESI</tt>, <tt>WRESI</tt>, <tt>CPRED</tt>,
<tt>CRES</tt>, <tt>CWRES</tt>, <tt>CPREDI</tt>,
<tt>CRESI</tt>, <tt>CWRESI <br>
CIPRED</tt>, <tt>CIRES</tt>,<tt>CIWRES</tt>,
<tt>CIPREDI</tt>, <tt>CIRESI</tt>,<tt>CIWRESI</tt>,
<tt>NIPRED</tt>, <tt>NIRES</tt>, <tt>NIWRES</tt>, <tt><br>
IPREDI</tt>, <tt>IRESI</tt>,<tt>IWRESI</tt>,<tt>IPRD</tt>,
<tt>IRS</tt>,<tt>IWRS</tt>, <tt>EPRED</tt>, <tt>ERES</tt>,
<tt>EWRES</tt>, <tt>ECWRES</tt>, <tt><br>
EIPRED</tt>, <tt>EIRES</tt>,<tt>EIWRES</tt>, <tt>NPDE</tt>,
<tt>NPD</tt>, <tt>OBJI</tt> <br>
---------- <br>
</cite></p>

<p style="margin-top: 1em">With NONMEM 7.3, <tt>MDVRES</tt>
(&quot;missing dependent variable MDV for residual
RES&quot;) is a reserved variable in abbreviated code. When
<tt>MDVRES</tt> is set to 1 in abbreviated code for a
particular record, the values of <tt>RES</tt>, and
<tt>WRES</tt> and related special diagnostic items are 0 in
tables and scatterplots. See Chapter IV J.2.</p>

<p style="margin-top: 1em">If the <tt>BY</tt> option is
omitted, the order of the labels in list1 determines the
order in which the items with these labels appear in the
rows.</p>

<p style="margin-top: 1em">Prediction items are always
population predictions, i.e. they are computed at the mean
value of
<img src="grohtml-4068006-207.png" alt="Image grohtml-4068006-207.png">
(0). Residual items are always based on these predictions,
as are weighted residual items, and with the latter the
weights are also computed at
<img src="grohtml-4068006-208.png" alt="Image grohtml-4068006-208.png">
. With a mixture model, each individual is classified into
one of the subpopulations of the mixture according to an
empirical Bayesian computation, conditional on the
individual&rsquo;s data and on the final estimates of the
population parameters. For a data record from the individual
record, the prediction, residual, weighted residual, and
<img src="grohtml-4068006-209.png" alt="Image grohtml-4068006-209.png">
items in the corresponding row are based on the submodel
defining the subpopulation into which the individual is
classified.</p>

<p style="margin-top: 1em">List2 is a list comprised of
labels from list1. The <tt>BY</tt> option should be used
only if the rows of the table are to be sorted on the items
of particular types. The rows of the table are sorted on the
items corresponding to the 1st label in list2, then
secondarily sorted on the items corresponding to the 2nd
label in list2, etc. The items corresponding to the labels
in list2, appear in the first consecutive columns of the
table, and the order of the labels in list2 determines the
order of these columns. The items corresponding to the
labels in list1 which are not in list2 appear in the next
consecutive columns of the table, and the order of these
labels in list1 determines the order of these columns.</p>

<p style="margin-top: 1em">If the <tt>PRINT</tt> option is
used, the table is printed in the NONMEM report. This is the
default. If the <tt>NOPRINT</tt> option is used, the table
is not printed; it is written to a formatted file and can be
used as NM-TRAN or NONMEM data sets, or can be used with
other computer programs. If this option is used the
<tt>FILE</tt> option (see below) must also be used. To
obtain both printed copies and the formatted file, use the
<tt>PRINT</tt> option along with the <tt>FILE</tt> option.
If the <tt>NOPRINT</tt> option is used, the maximum number
of labels in list1 is given by constant PDT in
resource/SIZES.f90; default is 500. However, if the number
of labels exceeds 8 with a particular table, the rows of
that table cannot be sorted.</p>

<p style="margin-top: 1em">The <tt>FILE</tt> option gives
the name of a formatted file to which tables may be written.
The name may not include embedded spaces, commas,
semicolons, or parentheses. The file is called a <b>table
file.</b></p>

<p style="margin-top: 1em">Options <tt>FORMAT</tt>,
<tt>LFORMAT</tt>, <tt>RFORMAT</tt>, and <tt>IDFORMAT</tt>
can be used to override the default format for the table
file, which is s1PE11.4. <br>
See Introduction to NONMEM 7 and Guide VIII and on-line
help.</p>

<p style="margin-top: 1em">Options <tt>NOFORWARD</tt> and
<tt>FORWARD</tt> affect the positioning of the file. With
<tt>NOFORWARD</tt>, when the table file is opened during a
given problem, it is positioned at the start of the file.
This is the default. With <tt>FORWARD</tt>, when the table
file is opened during a given problem, it is forwarded to
the end of the file. This allows a table file to accumulate
tables from multiple problems. <br>
See Introduction to NONMEM 7 and Guide VIII and on-line
help.</p>

<p style="margin-top: 1em">Tables are split into segments
of 900 rows each. Of course, a table may need only one
segment. Segments usually have headers comprised of two
records. Text in the first record identifies the table and
segment, and text in the second record gives the labels for
the tabled items. If the <tt>NOHEADER</tt> option is used,
the headers do not appear. This may be useful when a table
is to be read by another computer program. If the
<tt>ONEHEADER</tt> option is used, only the first segment of
each table has a header. This may be useful in order to
separate tables from each other. <tt><br>
ONEHEADERALL</tt> (nm74) is used only with the FILE option
and FORWARD. Only the first line of the table file is a
header line. May also be coded ONEHEADERPERFILE.</p>

<p style="margin-top: 1em">Similar options are
<tt>NOTITLE</tt> and <tt>NOLABEL</tt> which suppress table
titles and column labels respectively. With
<tt>FIRSTONLY</tt>, only information corresponding to the
first data record from each individual record appears in the
table. <br>
With <tt>LASTONLY</tt> and <tt>FIRSTLASTONLY</tt> (nm74)
only information corresponding to the last data record from
each individual record, or from the first and last records,
appear in the table.</p>

<p style="margin-top: 1em">If the <tt>UNCONDITIONAL</tt>
option is used, the Table Step is always implemented. If the
<tt>CONDITIONAL</tt> option is used, the Table Step is
implemented only when either the Estimation Step terminates
successfully, or the Estimation Step is not implemented.</p>

<p style="margin-top: 1em">If the <tt>OMITTED</tt> option
is used, the Table Step is not implemented, even though the
$TABLE record appears. When used, no other option should be
used.</p>

<p style="margin-top: 1em">Parentheses surounding a list
are optional. However, they should be used when a label can
be confused with an alias for an option, e.g. when a label
<tt>COND</tt> is used. Two list items may be separated by a
comma or spaces. Options cannot be coded among the labels of
either list1 or list2.</p>

<p style="margin-top: 1em">Synonyms for the prediction,
residual, and weighted residual item types can be defined
with the $TABLE record in the same manner as synonyms for
data item types can be defined with the $INPUT record. The
reserved labels for these item types are <tt>PRED</tt>,
<tt>RES</tt>, and <tt>WRES</tt>. If for example, the synonym
<tt>PR</tt> is to be defined for the prediction item type,
then <tt>PR=PRED</tt> should occur among the labels in
list1. The synonym will be used in <i>all</i> tables and
scatterplots, and control records following the $TABLE
record defining the synonym can use the synonym. Synonyms
may also be used for the special diagnostic items.</p>

<p style="margin-top: 1em">Options <tt>PRINT</tt>,
<tt>NOPRINT</tt>, <tt>HEADER</tt>, <tt>NOHEADER</tt>,
<tt>NOLABEL</tt>, <tt>FILE</tt>, <tt>FIRSTONLY</tt>,
<tt>FORWARD</tt>, <tt>NOFORWARD</tt>, <tt>APPEND</tt>,
<tt>NOAPPEND</tt>, <tt>FORMAT</tt> apply to the individual
$TABLE record. They must be specified for each table to
which they apply.</p>

<p style="margin-top: 1em">For
<img src="grohtml-4068006-210.png" alt="Image grohtml-4068006-210.png">
items, the label <tt>ETA(</tt>n<tt>)</tt> can be used
instead of <tt>ETA</tt>n. However, the labels in the table
will be ETA1 through ETA9 followed by ET10 through
ET999.</p>

<p style="margin-top: 1em">With NONMEM 7.3, instead of
requesting each ETA specifically a range of etas may be
requested: <tt><br>
ETAS(k:n)</tt> is equivalent to <tt>ETA</tt>k, ...,
<tt>ETA</tt>n (where n &gt; k).</p>

<p style="margin-top: 1em"><tt>LAST</tt> can be used in
place of n, and requests the last (highest numbered)
<img src="grohtml-4068006-211.png" alt="Image grohtml-4068006-211.png">
in the problem , e.g. <tt>ETAS(1:LAST)</tt>. If
<tt>:LAST</tt> is omitted, it is assumed, so that
<tt>ETAS(1)</tt> is equivalent to <tt>ETAS(1:LAST)</tt>.
Note that <tt>ETA(1)</tt> requests a single
<img src="grohtml-4068006-212.png" alt="Image grohtml-4068006-212.png">
, but <tt>ETAS(1)</tt> requests all the
<img src="grohtml-4068006-213.png" alt="Image grohtml-4068006-213.png">
&rsquo;s.</p>

<p style="margin-top: 1em">With NONMEM 7.4, a more flexible
syntax is available: <br>
The word TO may be used in place of &quot;:&quot;. <br>
The BY expression may be used: <br>
ETAS(1 TO 10 by 3) prints out etas 1,4,7,10 <br>
ETAS(LAST TO 1 by -3) prints out etas 10,7,4,1 (assuming
LAST=10)</p>

<p style="margin-top: 1em">With NONMEM 7.4, a symbolic
label specified in $ABBR REPLACE may be listed in $TABLE.
For example:</p>

<pre> $ABBR REPLACE ETA(CL)=ETA(1)
   ...
 $TABLE ETA(CL)</pre>


<p style="margin-top: 1em">A PRED-defined item is a value
stored in some variable defined in PRED (in PK, ERROR, etc.
if PREDPP is used); see section IV.F. It may be displayed
provided the variable is listed in MODULE NMPRD4. If the
variable is defined in abbreviated code, it is normally
listed in NMPRD4 (for exceptions see sections III.B.7 and
IV.H). The label used in the $TABLE record for the values of
the variable can be the variable name. However, if the name
is longer than 9 characters, the label used in the table
itself is comprised of the first nine characters only.
Alternatively, a synonym for the label in the $TABLE record
can be defined in the same manner as synonyms for labels of
data item types can be defined with the $INPUT record. E.g.,
suppose there is a user-defined variable
<tt>CLEARANCE_M</tt>. The $TABLE record may list
<tt>CLEARANCE_M=CLM</tt>, in which case the label in all
tables is <tt>CLM</tt> rather than truncated as
<tt>CLEARANCE</tt>.</p>

<p style="margin-top: 1em">Pred-defined elements in a list
may include elements of vectors used in abbreviated code:
<tt>VECTRA(1)</tt>, <tt>VECTRA(2)</tt>, ...
,<tt>VECTRA(9)</tt>, or alternatively, labels <tt>VA_1</tt>,
<tt>VA_2</tt>, ... ,<tt>VA_9</tt>, corresponding to
VECTRA(1), VECTRA(2), ..., VECTRA(9). The labels in the
output will be VA_1, VA_2, ... , VA_9. Similarly, for
<tt>VECTRB</tt> and <tt>VECTRC</tt>. See Chapter IV, and
Introduction to NONMEM 7 and Guide VIII and on-line help.
Pred-defined elements in a list may include elements of G
and H. E.g., <tt><br>
$TABLE G11 G21 G31 H11 H21</tt>. <br>
See Guide VIII $TABLE.ctl</p>

<p style="margin-top: 1em">The definition of a variable in
an abbreviated code can generate additional definitions of
other variables, called <b>generated variables</b> appearing
in the generated code, but not appearing in the abbreviated
code. The names of generated variables are all six
characters long. Certain generated variables symbolize the
values of partial derivatives and are normally listed in
NMPRD4 so that their values can be displayed like other
PRED-defined items. The names of these variables, and the
four character labels used in the tables for the values of
these generated variables, are described in section IV.F.
They can look strange and uninformative, e.g.
<tt>A00004</tt> and <tt>0004</tt>. Either the six or four
character label can be used in the $TABLE record. A synonym
for the label used in the $TABLE record can be defined in
the same manner as synonyms for labels of data item types
can be defined with the $INPUT record. E.g.
<tt>DCL2=A00004</tt>, in which case the label in the table
is <tt>DCL2</tt> rather than <tt>0004</tt>. Use of a synonym
in this case can be particularly helpful.</p>

<p style="margin-top: 1em">If a variable is defined in a
user-supplied code, its values may be displayed provided the
variable is listed in MODULE NMPRD4. Its name is not known
to NM-TRAN. Instead, it is identified by its position in the
MODULE. If it is the Ith variable listed in the MODULE, then
the label used in the $TABLE record for its values can be
either <tt>COM(I)</tt> or the four character label
<tt>:..I</tt>, where the dots indicate leading <tt>0</tt>
digits if needed. The latter label is the one used in the
table. If I exceeds 999, then the label in the $TABLE record
must be <tt>COM(I)</tt>, and the label used in the table is
<tt>:..K</tt>, where K is I (mod 1000). A synonym for a
label used in the table can be defined with the $TABLE
record in the same manner as synonyms for labels of data
item types can be defined with the $INPUT record. E.g.
<tt>SIZE=COM(20)</tt>, in which case the label <tt>SIZE</tt>
is used in the table rather than <tt>:020</tt>. Use of a
synonym in this case too can be particularly helpful.</p>

<p style="margin-top: 1em">If no abbreviated code is
present, then all the variables listed in NMPRD4 may be
labeled in the $TABLE record and in the tables themselves in
the manner just described. The <tt>COMRES</tt> option in the
$ABBREVIATED record is set equal to the length of NMPRD4,
and the option is unnecessary and, in fact, must not be
used.</p>

<p style="margin-top: 1em">If any abbreviated code is also
used, the <tt>COMRES</tt> option in the $ABBREVIATED record
must be used to reserve n positions in NMPRD4 for the
variables defined in user-supplied code; see section B.7. On
the $TABLE record, labels for variables defined in
abbreviated code and labels for variables defined in
user-supplied code may both be used. However, labels of the
form <tt>COM(I)</tt> for variables defined in user-supplied
code must refer only to the reserved portion of the MODULE,
i.e. it must be true that
<img src="grohtml-4068006-214.png" alt="Image grohtml-4068006-214.png">
.</p>

<p style="margin-top: 1em">A label for a PRED-defined item
defined in an abbreviated code may be given in a $TABLE (or
$SCATTERPLOT) record of a problem specification beyond the
first problem specification.</p>

<p style="margin-top: 1em">The number of different types of
PRED-defined items that may be displayed in all tables and
scatterplots is given by constant PDT in resource/SIZES.f90;
default is 500.</p>

<p style="margin-top: 1em">If a synonym is defined for an
item type, a different synonym for the same item type cannot
be defined on another $TABLE or $SCATTERPLOT record for the
same problem.</p>

<p style="margin-top: 1em">With NONMEM 7.4, it is possible
to exclude data records (i.e., rows) from a table file,
using the <tt>EXCLUDE_BY</tt> option. List3 is comprised of
one or more items that are permitted in list1, e.g., data
item labels and labels of PRED-defined items in MODULE
NMPRD4. Labels in list3 are called exclusion variables. If
one or more of them have a non-zero value for a given data
record, the row of the table corresponding to that data
record will be excluded from the table file. Exclusion
variables are not listed in the table file. They have no
effect on the printed table and scatters in the NONMEM
output, e.g., they do not cause any rows to be deleted from
the printed table and are displayed in the printed
table.</p>

<p style="margin-top: 1em">For example,</p>
<pre>$PK ...</pre>

<p>EXCL=0 IF(ID.GE.45.AND.ID.LE.53) EXCL=1 <br>
... <br>
$TABLE ID TIME DV IPRED CL V1 Q V2 ETAS(1:LAST) EXLUDE_BY
EXCL <br>
NOAPPEND FILE=exctable.par NOPRINT</p>

<p style="margin-top: 1em">The table file exctable.par will
not contain records from subjects 45 to 53.</p>

<p style="margin-top: 1em">See Guide Introduction to NONMEM
7 and Guide VIII and on-line help for $TABLE.</p>

<p style="margin-top: 1em"><tt>NOSUB</tt> is an option of
$TABLE that is similar to the same option of
$ESTIMATION.</p>

<p style="margin-top: 1em">Options <tt>ESAMPLE</tt>,
<tt>WRESCHOL</tt>, <tt>SEED</tt>, <tt>CLOCKSEED</tt>,
<tt>RANMETHOD</tt>, <tt>PARAFILE</tt>, <tt>VARCALC</tt>,
<tt>FIXEDETAS</tt> are beyond the scope of this guide. See
Guide Introduction to NONMEM 7 and Guide VIII and on-line
help for $TABLE</p>

<h2>III.III.III.B.17. $SCATTERPLOT Record
<a name="III.III.III.B.17."></a>
<a name="III.III.III.B.17. $SCATTERPLOT Record"></a>
</h2>


<p style="margin-top: 1em"><tt>$SCATTERPLOT</tt> list1
<tt>VS</tt> list2 [<tt>BY</tt> list3] <br>
[<tt>FROM
<img src="grohtml-4068006-215.png" alt="Image grohtml-4068006-215.png"></tt>
] [<tt>TO
<img src="grohtml-4068006-216.png" alt="Image grohtml-4068006-216.png"></tt>
] [<tt>UNIT</tt>] <br>
[<tt>ORD0</tt>|<tt>NOORD0</tt>]
[<tt>ABS0</tt>|<tt>NOABS0</tt>] [<tt>FIRSTONLY</tt>]
[<tt>OBSONLY</tt>] <br>
[<tt><b>NOSUB=0</b></tt> | <tt>NOSUB=1</tt>] <br>
[<tt><b>UNCONDITIONAL</b></tt>|<tt>CONDITIONAL</tt>]
[<tt>OMITTED</tt>]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$SCATTERPLOT      (RES WRES) VS TIME BY ID</pre>

<p style="margin-top: 1em">This record requests that the
Scatterplot Step be implemented. Each such record defines
families of scatterplots. At most 20 families can be defined
by all $SCATTERPLOT records in a single problem
specification.</p>

<p style="margin-top: 1em">This record is optional.</p>

<p style="margin-top: 1em">List1, list2, and list3 are each
lists of item labels. The same labels that may be used in a
$TABLE record (see section B.16) may be used in any list of
the $SCATTERPLOT record. Synonyms may be defined in these
lists. If a synonym is defined for an item type, a different
synonym for the same item type cannot be defined on another
$TABLE or $SCATTERPLOT record for the same problem.</p>

<p style="margin-top: 1em">A <b>base plot</b> is defined by
each pair of labels, (A,B), where A is from list1 and B is
from list2. Each data record has associated with it a pair
of items (a,b), where a and b have the labels A and B,
respectively. The items are also refered to as the
<b>values</b> of A and B. The base plot consists of all such
pairs of values, except that if A or B is <tt>DV</tt>,
<tt>RES</tt>, or <tt>WRES</tt> (see section B.16), or a
synonym of one of these labels, and if the MDV data item of
the data record is 1, then the pair is excluded from the
plot. Unless the base plot is partitioned (see below), the
values a are plotted on the ordinate axis of the base
scatterplot (the long axis on the printed output), and the
values b are plotted on the abscissa axis of the base
scatterplot (the short axis on the printed output). The
values that are plotted are the same ones that would appear
in a table were the values tabled; see section B.16.</p>

<p style="margin-top: 1em">List3 is a list of at most two
item labels. If list3 is empty, i.e. if the <tt>BY</tt>
option is not used, as many scatterplot families are defined
by a $SCATTERPLOT record as are the number of base plots;
each family consists of a single base plot. If list3
contains one label, C, this label is used as a
<b>separator</b> with each of the base plots. The base plot
is not actually output; rather, each base plot is separated
into a <b>one-way partitioned family</b> of scatterplots,
each of which is output. A different scatterplot of the
family is defined for each distinct value c of C. It
consists of all pairs (a,b) of the base plot such that the
value of C for the data record associated with (a,b) equals
c. For example, if C is <tt>ID</tt>, the base plot A vs B is
partitioned into different scatterplots, where all the
points of a given scatterplot are all those associated with
a particular individual. If there are many individuals in
the data set, it may not be wise to output a one-way
partitioned family using <tt>ID</tt> as a separator. If
list3 contains two labels, these labels are used as a pair
of separators with each of the base plots; each base plot is
separated into a two-way partitioned family of
scatterplots.</p>

<p style="margin-top: 1em">If the <tt>UNIT</tt> option is
used, a 45 degree line (i.e. a line of unit slope) is
superimposed on the families of scatterplots. If the
<tt>ORD0</tt> option is used, a horizontal line through the
zero value on the ordinate axis is superimposed on the
families of scatterplots. If the <tt>ABS0</tt> option is
used, a vertical line through the zero value on the abscissa
axis is superimposed on the families of scatterplots. If the
<tt>FIRSTONLY</tt> option is used, only the first data
record from each individual record may contribute a point to
the scatterplot. If the <tt>OBSONLY</tt> option is used, the
scatterplot will only use data records with MDV=0. This
option applies independently of FIRSTONLY. It is not
necessary when either DV, RES, or WRES is plotted.</p>

<p style="margin-top: 1em">All scatterplots resulting from
a $SCATTERPLOT record usually use only the data records
<i>from
<img src="grohtml-4068006-217.png" alt="Image grohtml-4068006-217.png">
to
<img src="grohtml-4068006-218.png" alt="Image grohtml-4068006-218.png"></i>
, where
<img src="grohtml-4068006-219.png" alt="Image grohtml-4068006-219.png">
and
<img src="grohtml-4068006-220.png" alt="Image grohtml-4068006-220.png">
may be as large as the total number of data records.&dagger;
<br>
----------</p>

<p style="margin-top: 1em"><cite>&dagger; To restore the
NONMEM VI behavior, use TO n1+899. <br>
---------- <br>
</cite></p>

<p style="margin-top: 1em">That is, only points
corresponding to these data records are included in a
scatterplot. The number of points in the scatterplot may be
fewer than
<img src="grohtml-4068006-221.png" alt="Image grohtml-4068006-221.png">
if any point is excluded as described above, or if the
scatterplot is partitioned. Points from records beyond
<img src="grohtml-4068006-222.png" alt="Image grohtml-4068006-222.png">
, if any, may be displayed by using options <tt>FROM</tt>
and <tt>TO</tt>.</p>

<p style="margin-top: 1em">If the <tt>FROM</tt> option is
used,
<img src="grohtml-4068006-223.png" alt="Image grohtml-4068006-223.png">
is set to
<img src="grohtml-4068006-224.png" alt="Image grohtml-4068006-224.png">
. If the <tt>TO</tt> option is used,
<img src="grohtml-4068006-225.png" alt="Image grohtml-4068006-225.png">
is set to
<img src="grohtml-4068006-226.png" alt="Image grohtml-4068006-226.png">
. Of course,
<img src="grohtml-4068006-227.png" alt="Image grohtml-4068006-227.png">
must not be less than
<img src="grohtml-4068006-228.png" alt="Image grohtml-4068006-228.png">
.</p>

<p style="margin-top: 1em">The <tt>NOSUB</tt> option is the
same as the <tt>NOSUB</tt> option of the $ESTIMATION and
$TABLE records.</p>

<p style="margin-top: 1em">If the <tt>UNCONDITIONAL</tt>
option is used, the Scatterplot Step is always implemented.
If the <tt>CONDITIONAL</tt> option is used, the Scatterplot
Step is implemented only when either the Estimation Step
terminates successfully, or the Estimation Step is not
implemented.</p>

<p style="margin-top: 1em">If the <tt>OMITTED</tt> option
is used, the Scatterplot Step is not implemented, even
though the $SCATTERPLOT record appears. When used, no other
option should be used.</p>

<p style="margin-top: 1em">Parentheses surounding a list
are optional. However, they should be used when a label can
be confused with an alias for an option, e.g. when a label
<tt>COND</tt> is used. Two list items may be separated by a
comma or spaces. Options cannot be coded among the labels of
either list1, list2, or list3.</p>

<p style="margin-top: 1em">Synonyms for the prediction,
residual, and weighted residual item types can be defined
with the $SCATTERPLOT record in the same manner as synonyms
for data item types can be defined with the $INPUT record.
The reserved labels for these data item types are
<tt>PRED</tt>, <tt>RES</tt>, and <tt>WRES</tt>. If for
example, the synonym <tt>PR</tt> is to be defined for the
prediction item type, then <tt>PR=PRED</tt> should occur
among the labels in list1 or list2. The synonym will be used
in <i>all</i> tables and scatterplots, and control records
following the $SCATTERPLOT record defining the synonym can
use the synonym.</p>

<p style="margin-top: 1em">Each of the options
<tt>UNCONDITIONAL</tt>, <tt>CONDITIONAL</tt>, and
<tt>OMITTED</tt> applies to the Scatterplot Step as a whole,
and if one of these is used, an option contradicting it
cannot be used in another $SCATTERPLOT record for the same
problem. If a synonym is defined for an item type, a
different synonym for the same item type cannot be defined
on another $SCATTERPLOT or $TABLE record for the same
problem.</p>

<p style="margin-top: 1em">List1 and list2 may be separated
by an asterisk rather than by <tt>VS</tt>. If either list is
enclosed by parentheses, or if both lists contain only one
item, then the asterisk or <tt>VS</tt> may be omitted,
e.g.</p>
<pre style="margin-top: 1em">$SCAT CP TIME</pre>

<p style="margin-top: 1em">Options cannot be coded between
list2 and the <tt>BY</tt> option, but they can precede list1
or follow the last list.</p>

<p style="margin-top: 1em">The number of different types of
PRED-defined items that may be displayed in all tables and
scatterplots is 20.</p>

<p style="margin-top: 1em"><tt>ORDZERO</tt> is an alias for
<tt>ORD0</tt>. <tt>FIRSTRECORDONLY</tt> and
<tt>FIRSTRECONLY</tt> are aliases for <tt>FIRSTONLY</tt>.
The <tt>UNIT</tt> and <tt>FROM</tt> option names cannot be
abbreviated.</p>

<h2>III.III.III.B.18. $SUPERPROBLEM Record (nmv)
<a name="III.III.III.B.18."></a>
<a name="III.III.III.B.18. $SUPERPROBLEM Record (nmv)"></a>
</h2>


<p style="margin-top: 1em"><tt>$SUPER</tt> [<tt>SCOPE=
<img src="grohtml-4068006-229.png" alt="Image grohtml-4068006-229.png"></tt>
] [<tt>ITERATIONS=
<img src="grohtml-4068006-230.png" alt="Image grohtml-4068006-230.png"></tt>
] <br>
[<tt><b>NOPRINT</b></tt>|<tt>PRINT</tt>]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$SUPER     SCOPE=2 ITERATIONS=10</pre>

<p style="margin-top: 1em">A superproblem is specified by
including the <tt>$SUERPROBLEM</tt> record before the first
$PROBLEM record of the superproblem.</p>

<p style="margin-top: 1em">A superproblem is a sequence of
problems within a NONMEM run that can be iterated. With
every iteration each problem is run exactly as was specified
for the first iteration. Differences in the results from a
given problem between iterations are due to differences to
input files that have been made by later problems within the
superproblem or, when the problem involves simulation, to
different random numbers being used. There can be a
one-level nesting of superproblems, one superproblem within
another.</p>

<h2>III.III.III.B.19. $WARNING Record (nmv)
<a name="III.III.III.B.19."></a>
<a name="III.III.III.B.19. $WARNING Record (nmv)"></a>
</h2>


<p style="margin-top: 1em"><tt>$WARNINGS</tt>
[<tt>NONE</tt>] [
<img src="grohtml-4068006-231.png" alt="Image grohtml-4068006-231.png">
] [<tt><b>RESET</b></tt> | <tt>NORESET</tt> ] <br>
[<tt>WARNINGMAXIMUM=</tt> [ <tt>NONE</tt> |
<img src="grohtml-4068006-232.png" alt="Image grohtml-4068006-232.png">
| <tt>(</tt>list<tt>)</tt>] ] <br>
[<tt>DATAMAXIMUM=</tt> [ <tt>NONE</tt> |
<img src="grohtml-4068006-233.png" alt="Image grohtml-4068006-233.png">
| <tt>(</tt>list<tt>)</tt>] ] <br>
[<tt>ERRORMAXIMUM=
<img src="grohtml-4068006-234.png" alt="Image grohtml-4068006-234.png"></tt>
]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$WARNING     WMAX=1,EMAX=9999</pre>

<p style="margin-top: 1em">Limits warning messages from
NM-TRAN.</p>

<p style="margin-top: 1em">NM-TRAN generates various
informational and warning messages. These messages are not
fatal (NONMEM may still be run) and may be ignored. Warning
messages can be suppressed or their numbers limited for a
given run by use of the NM-TRAN control record
$WARNINGS.</p>

<h2>III.III.III.B.20. $INCLUDE Record (nmvi)
<a name="III.III.III.B.20."></a>
<a name="III.III.III.B.20. $INCLUDE Record (nmvi)"></a>
</h2>


<p style="margin-top: 1em"><tt>$INCLUDE</tt> filename [
<img src="grohtml-4068006-235.png" alt="Image grohtml-4068006-235.png">
]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$INCLUDE ctlfile2 11</pre>

<p style="margin-top: 1em">The INCLUDE statement was added
to NONMEM V. (See Chapter IV K.4). The $INCLUDE record was
added to NONMEM VI.</p>

<p style="margin-top: 1em">This record causes NM-TRAN to
read control stream records from a different file. The
character &quot;$&quot; is optional. (This is the only
control record for which $ is optional.) The filename must
be the first option on the record</p>


<p style="margin-top: 1em"><img src="grohtml-4068006-236.png" alt="Image grohtml-4068006-236.png">
is optional. It gives the number of copies of the file to be
read. Default is 1.</p>

<h2>III.III.III.B.21. $NONPARAMETRIC Record (nmvi)
<a name="III.III.III.B.21."></a>
<a name="III.III.III.B.21. $NONPARAMETRIC Record (nmvi)"></a>
</h2>


<p style="margin-top: 1em"><tt>$NONPARAMETRIC</tt>
[<tt><b>MARGINALS</b></tt>|<tt>ETAS</tt>]
[<tt>MSFO=filename</tt>] [<tt>RECOMPUTE</tt>] <br>
[<tt>EXPAND</tt>] [<tt>NPSUPP=</tt>n | <tt>NPSUPPE=</tt>n]
<br>
[<tt>BOOTSTRAP&nbsp;</tt>[<tt>STRAT=label</tt>]
[<tt>STRATF=label</tt>]] <br>

[<tt><i>PARAFILE=</i></tt>[filename|<tt><i>ON</i></tt>|<tt><i>OFF</i></tt>]
<br>
[<tt><b>UNCONDITIONAL</b></tt>|<tt>CONDITIONAL</tt>]
[<tt>OMITTED</tt>]</p>
<pre style="margin-top: 1em">$NONPARAMETRIC    ETAS</pre>

<p style="margin-top: 1em">Requests that the NONMEM
Nonparametric Step be implemented.</p>

<p style="margin-top: 1em">NONMEM obtains either marginal
cumulatives or conditional (non-parametric) estimates of
etas. When present, the $ESTIMATION record must also be
present and must specify METHOD=1 or POSTHOC.</p>

<h2>III.III.III.B.22. $OMIT Record (nmvi)
<a name="III.III.III.B.22."></a>
<a name="III.III.III.B.22. $OMIT Record (nmvi)"></a>
</h2>


<p style="margin-top: 1em"><tt>$OMIT</tt> item1 item2 item3
...</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$OMIT   TIME</pre>

<p style="margin-top: 1em">Defines data item types to be
excluded from template matching when raw data averages are
computed. Raw data averages are computed when the NONMEM
RAW_ data item is used.</p>

<h2>III.III.III.B.23. $PRIOR Record (nmvi)
<a name="III.III.III.B.23."></a>
<a name="III.III.III.B.23. $PRIOR Record (nmvi)"></a>
</h2>


<p style="margin-top: 1em"><tt>$PRIOR</tt> subroutine [(
<img src="grohtml-4068006-237.png" alt="Image grohtml-4068006-237.png">
),&nbsp;(
<img src="grohtml-4068006-238.png" alt="Image grohtml-4068006-238.png">
) ... ] <br>

[<tt>DISPLAY[=</tt><tt><b>ALL</b></tt><tt>|CNT]]&nbsp;&nbsp;
[ICMAX=n] <br>
[
<img src="grohtml-4068006-239.png" alt="Image grohtml-4068006-239.png">
,
<img src="grohtml-4068006-240.png" alt="Image grohtml-4068006-240.png">
...]</tt></p>

<p style="margin-top: 1em"><tt>E.g. <br>
$PRIOR TNPRI (PROBLEM 2) PLEV=.9999 ISS=0 IVAR=1</tt></p>

<p style="margin-top: 1em">Starting with NONMEM VI, a
frequency-prior may be specified for data-analytic purposes,
or to simulate parameter values (in a Simulation Step). Two
NONMEM utility routines help in this regard. NWPRI allows
the THETA vector to be constrained by a &quot;normal shaped
prior&quot;, and/or the OMEGA matrix to be constrained by an
&quot;inverse-Wishart shaped prior&quot;, where both priors
are specified by the user. TNPRI allows all parameters to be
constrained by a prior that arises automatically from a
NONMEM analysis of a prior data set. (See the PRIOR and
NWPRI and TNPRI Help Items and the NWPRI and TNPRI
examples.) Implementing PRIOR routines has been made easier
by control record, $PRIOR, which may be used instead of a
user-written PRIOR routine.</p>

<p style="margin-top: 1em">The $PRIOR record provides
instructions for a generated PRIOR subroutine in FSUBS.
There may be at most 10 $PRIOR records per problem. $PRIOR
may not be present if a user-written PRIOR routine is listed
on the $SUBROUTINES record. $PRIOR must follow the
$SUBROUTINES or $PRED record. $PRIOR is a control record,
not a block of abbreviated code. Therefore, only options of
the $PRIOR record may be used. E.g., verbatim code may not
be used. NONMEM Users Guide VIII and on-line help for $PRIOR
describe all the options.</p>

<p style="margin-top: 1em">When NWPRI is used, $THETA,
$OMEGA, and $SIGMA records are used to provide prior
information, in addition to the usual $THETA, $OMEGA, and
$SIGMA records. These additional records must be in a
specific order, and the record names describe the structure
of the information rather than the kind of information. This
is described in the on-line help entry for NWPRI. With
NONMEM 7.3, there is an easier way to provide this
information, using informative record names $THETAP, etc.,
as described in the following section.</p>

<h2>III.III.III.B.24. $THETAP, $THETAPV Record (nm73)
<a name="III.III.III.B.24."></a>
<a name="III.III.III.B.24. $THETAP, $THETAPV Record (nm73)"></a>
</h2>


<h2>III.III.III.B.25. $OMEGAP, $OMEGAPD Record (nm73)
<a name="III.III.III.B.25."></a>
<a name="III.III.III.B.25. $OMEGAP, $OMEGAPD Record (nm73)"></a>
</h2>


<h2>III.III.III.B.26. $SIGMAP, $SIGMAPD Record (nm73)
<a name="III.III.III.B.26."></a>
<a name="III.III.III.B.26. $SIGMAP, $SIGMAPD Record (nm73)"></a>
</h2>


<p style="margin-top: 1em"><tt>$THETAP
<img src="grohtml-4068006-241.png" alt="Image grohtml-4068006-241.png"></tt>
[
<img src="grohtml-4068006-242.png" alt="Image grohtml-4068006-242.png">
] [
<img src="grohtml-4068006-243.png" alt="Image grohtml-4068006-243.png">
] ... <tt><br>
$THETAPV
<img src="grohtml-4068006-244.png" alt="Image grohtml-4068006-244.png"></tt>
[
<img src="grohtml-4068006-245.png" alt="Image grohtml-4068006-245.png">
] [
<img src="grohtml-4068006-246.png" alt="Image grohtml-4068006-246.png">
] ... <tt><br>
$OMEGAP
<img src="grohtml-4068006-247.png" alt="Image grohtml-4068006-247.png"></tt>
[
<img src="grohtml-4068006-248.png" alt="Image grohtml-4068006-248.png">
] [
<img src="grohtml-4068006-249.png" alt="Image grohtml-4068006-249.png">
] ... <tt><br>
$OMEGAPD
<img src="grohtml-4068006-250.png" alt="Image grohtml-4068006-250.png"></tt>
[
<img src="grohtml-4068006-251.png" alt="Image grohtml-4068006-251.png">
] [
<img src="grohtml-4068006-252.png" alt="Image grohtml-4068006-252.png">
] ... <tt><br>
$SIGMAP
<img src="grohtml-4068006-253.png" alt="Image grohtml-4068006-253.png"></tt>
[
<img src="grohtml-4068006-254.png" alt="Image grohtml-4068006-254.png">
] [
<img src="grohtml-4068006-255.png" alt="Image grohtml-4068006-255.png">
] ... <tt><br>
$SIGMAPD
<img src="grohtml-4068006-256.png" alt="Image grohtml-4068006-256.png"></tt>
[
<img src="grohtml-4068006-257.png" alt="Image grohtml-4068006-257.png">
] [
<img src="grohtml-4068006-258.png" alt="Image grohtml-4068006-258.png">
] ...</p>

<p style="margin-top: 1em">E.g.</p>

<pre>; Prior information of THETAS (NTHP=4 of them)
$THETAP (2.0 FIX) (2.0 FIX) (2.0 FIX) (2.0 FIX)
; Variance to prior information of THETAS (NTHPxNTHP=4x4 of them).
$THETAPV BLOCK(4)
10000 FIX
0.00 10000
0.00  0.00 10000
0.00  0.00 0.0 10000</pre>


<p style="margin-top: 1em">The records may be in any order,
and the options of $PRIOR need not be specified. The name of
the record describes the kind of information it gives to
NWPRI, rather than the structure of the information, as
follows:</p>

<p style="margin-top: 1em"><tt>$THETAP</tt> for THETA
priors <tt><br>
$THETAPV</tt> for variance-covariance matrix for
THETA&rsquo;s <tt><br>
$OMEGAP</tt> for OMEGA prior <tt><br>
$OMEGAPD</tt> for degrees of freedom (or dispersion factor)
for OMEGA prior <tt><br>
$SIGMAP</tt> for SIGMA prior <tt><br>
$SIGMAPD</tt> for degrees of freedom (or dispersion factor)
for SIGMA prior</p>

<h2>III.III.III.B.27. $CHAIN Record (nm72)
<a name="III.III.III.B.27."></a>
<a name="III.III.III.B.27. $CHAIN Record (nm72)"></a>
</h2>


<p style="margin-top: 1em"><tt>$CHAIN</tt>
[<tt>FILE=</tt>filename] <br>
[<tt>FORMAT=
<img src="grohtml-4068006-259.png" alt="Image grohtml-4068006-259.png"></tt>
] [<tt>ORDER=</tt>xxxf] <br>
[<tt>NOTITLE=[0|1]</tt>] [<tt>NOLABEL=[0|1]</tt>] <br>
[<tt>ISAMPLE=
<img src="grohtml-4068006-260.png" alt="Image grohtml-4068006-260.png"></tt>
][<tt>NSAMPLE=
<img src="grohtml-4068006-261.png" alt="Image grohtml-4068006-261.png"></tt>
] <br>
[<tt>SEED=
<img src="grohtml-4068006-262.png" alt="Image grohtml-4068006-262.png"></tt>
] [<tt>SELECT=
<img src="grohtml-4068006-263.png" alt="Image grohtml-4068006-263.png"></tt>
] <br>
[<tt>RANMETHOD=[n|S|m]</tt> ] <br>
[<tt>CTYPE=[0|1|2|3|4]</tt>] <br>
[<tt>DF=
<img src="grohtml-4068006-264.png" alt="Image grohtml-4068006-264.png"></tt>
] [<tt>DFS=
<img src="grohtml-4068006-265.png" alt="Image grohtml-4068006-265.png"></tt>
] [<tt>IACCEPT=
<img src="grohtml-4068006-266.png" alt="Image grohtml-4068006-266.png"></tt>
]</p>

<p style="margin-top: 1em">E.g.</p>

<pre>$CHAIN FILE=example1_previous.txt NSAMPLE=0 ISAMPLE=-1000000000</pre>


<p style="margin-top: 1em">Supplies initial estimates for
an entire problem. Option METHOD=CHAIN of the $ESTIMATION
record will only set thetas, omegas, and sigmas for initial
values of the estimation process. Its scope is therefore
limited in that it will not impact the parameters used in
simulating data for the Simulation step. To introduce
initial thetas, omegas, and sigmas that will cover the
entire scope of a given problem, use the $CHAIN record.</p>

<h2>III.III.III.B.28. $SIZES Record (nm72)
<a name="III.III.III.B.28."></a>
<a name="III.III.III.B.28. $SIZES Record (nm72)"></a>
</h2>


<p style="margin-top: 1em"><tt>$SIZES</tt> [constant=value]
[constant=value] ...</p>

<p style="margin-top: 1em">E.g.</p>
<pre> $SIZES LIM1=30000 MAXFCN=2000000 NO=500</pre>

<p style="margin-top: 1em">$SIZES is optional. If present,
it must precede the first $PROBLEM or $SUPER record. by the
$ANNEAL record.</p>

<p style="margin-top: 1em">Certain constants are used in
NM-TRAN, NONMEM and PREDPP. These are in file
resource/sizes.f90. The user may override many of the
constants with the $SIZES record. Any non-zero value
specified on the $SIZES record overrides both the default
and the value that NM-TRAN would have specified. (A value of
0 is ignored.) As of NONMEM 7.3, as an alternative to
modifying sizes.f90 to very large maximum sizes, you can
tell NMTRAN the maximum size that may be needed by
specifying a $SIZES constant as a negative value. Thus, a
user can give NMTRAN permission to deal with all problems
that have data input files that have up to 1000 data items,
and up to 150 etas and epsilons, and up to 200 thetas, by
the following:</p>

<pre style="margin-top: 1em"> $SIZES PD=-1000 LVR=-150 LTH=-200</pre>


<p style="margin-top: 1em">but the values of these
constants when the NONMEM executable is constructed will be
only what is needed for the particular problem.</p>

<h2>III.III.III.B.29. $ANNEAL Record (nm73)
<a name="III.III.III.B.29."></a>
<a name="III.III.III.B.29. $ANNEAL Record (nm73)"></a>
</h2>


<p style="margin-top: 1em"><tt>$ANNEAL</tt>
number-list1:value1 number-list2:value2 ...</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$ANNEAL 1-3,5:0.3 6,7:1.0</pre>

<p>Sets starting diagonal Omega values for purposes of
simulated annealing by NONMEM subroutine CONSTRAINT. This
facilitates EM (Expectation Maximization) search
methods.</p>

<p style="margin-top: 1em">In the above example, initial
values of OMEGA(1,1), OMEGA(2,2), OMEGA(3,3), and OMEGA(5,5)
are set to 0.3, while initial OMEGA(6,6) and OMEGA(7,7) are
set to 1.0.</p>

<h2>III.III.III.B.30. $ETAS Record (nm73)III.III.B.31. $PHIS Record (nm73)
<a name="III.III.III.B.30."></a>
<a name="III.III.III.B.30. $ETAS Record (nm73)III.III.B.31. $PHIS Record (nm73)"></a>
</h2>


<p style="margin-top: 1em"><tt>$ETAS</tt> [[
<img src="grohtml-4068006-267.png" alt="Image grohtml-4068006-267.png">
[
<img src="grohtml-4068006-268.png" alt="Image grohtml-4068006-268.png">
] [
<img src="grohtml-4068006-269.png" alt="Image grohtml-4068006-269.png">
] ... [
<img src="grohtml-4068006-270.png" alt="Image grohtml-4068006-270.png">
]] <br>
[<tt>FILE=</tt>filename <tt>FORMAT=
<img src="grohtml-4068006-271.png" alt="Image grohtml-4068006-271.png"></tt>
[<tt>TBLN=
<img src="grohtml-4068006-272.png" alt="Image grohtml-4068006-272.png"></tt>
]] <tt><br>
$PHIS</tt> [[
<img src="grohtml-4068006-273.png" alt="Image grohtml-4068006-273.png">
[
<img src="grohtml-4068006-274.png" alt="Image grohtml-4068006-274.png">
] [
<img src="grohtml-4068006-275.png" alt="Image grohtml-4068006-275.png">
] ... [
<img src="grohtml-4068006-276.png" alt="Image grohtml-4068006-276.png">
]] <br>
[<tt>FILE=</tt>filename <tt>FORMAT=
<img src="grohtml-4068006-277.png" alt="Image grohtml-4068006-277.png"></tt>
[<tt>TBLN=
<img src="grohtml-4068006-278.png" alt="Image grohtml-4068006-278.png"></tt>
]]</p>

<p style="margin-top: 1em">E.g.</p>

<pre>$ETAS 0.4 3.0 3.0 5.0
$PHIS 0.4 3.0 3.0 5.0
$ETAS FILE=myprevious.phi FORMAT=s1pE15.8 TBLN=3
$PHIS FILE=myprevious.phi FORMAT=s1pE15.8 TBLN=3</pre>


<p>Specifies Initial Values for Etas or Phis</p>

<p style="margin-top: 1em">By default, the initial value
used for ETA&rsquo;s in the Estimation Step search is 0. The
$ETAS and $PHIS records provide different initial estimates.
When the record is $PHIS, values are entered as phi values,
convenient for EM methods. The eta values will then be
evaluated as
<img src="grohtml-4068006-279.png" alt="Image grohtml-4068006-279.png">
for each eta, where
<img src="grohtml-4068006-280.png" alt="Image grohtml-4068006-280.png">
is evaluated according to their definitions in the
abbreviated code.</p>

<h2>III.III.III.B.32. $LEVEL Record (nm73)
<a name="III.III.III.B.32."></a>
<a name="III.III.III.B.32. $LEVEL Record (nm73)"></a>
</h2>


<p style="margin-top: 1em"><tt>$LEVEL item=</tt>(
<img src="grohtml-4068006-281.png" alt="Image grohtml-4068006-281.png">
[
<img src="grohtml-4068006-282.png" alt="Image grohtml-4068006-282.png">
] ,
<img src="grohtml-4068006-283.png" alt="Image grohtml-4068006-283.png">
[
<img src="grohtml-4068006-284.png" alt="Image grohtml-4068006-284.png">
] ... ) ...</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$LEVEL SID=(4[1],5[2],6[3])</pre>

<p style="margin-top: 1em">Specifies nested random levels
above subject ID. Item is the name of a data item listed on
$INPUT. It defines an additional nested random level and is
referred to as a &quot;super ID&quot; data item. The
notation
<img src="grohtml-4068006-285.png" alt="Image grohtml-4068006-285.png">
[
<img src="grohtml-4068006-286.png" alt="Image grohtml-4068006-286.png">
] states that ETA(
<img src="grohtml-4068006-287.png" alt="Image grohtml-4068006-287.png">
) is associated with this super ID item, and ETA(
<img src="grohtml-4068006-288.png" alt="Image grohtml-4068006-288.png">
) is nested within ETA(
<img src="grohtml-4068006-289.png" alt="Image grohtml-4068006-289.png">
).</p>

<h2>III.III.III.B.33. $DEFAULT Record (nm74)
<a name="III.III.III.B.33."></a>
<a name="III.III.III.B.33. $DEFAULT Record (nm74)"></a>
</h2>


<p style="margin-top: 1em"><tt>$DEFAULT</tt>
[<tt>NOSUB=[-1|0|1]</tt>]</p>

<p style="margin-top: 1em">E.g.</p>
<pre>$DEFAULT NOSUB=1</pre>

<p style="margin-top: 1em">Specifies certain defaults for
NONMEM. If present, it must appear following $PROBLEM
record.</p>

<p style="margin-top: 1em">The <tt>NOSUB</tt> option is the
same as the <tt>NOSUB</tt> option of the $ESTIMATION and
$TABLE and $SCATTER records.</p>

<p style="margin-top: 1em"><a href="III.html">TOP</a> <br>
<a href="index.html">TABLE OF CONTENTS</a> <br>
 <a href="IV.html">NEXT CHAPTER ...</a></p>
<hr>
</body>
</html>
